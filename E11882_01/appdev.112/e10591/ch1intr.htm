<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Introducing Oracle COM Automation Feature</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1" />
<meta name="dcterms.created" content="2011-01-21T18:9:26Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="COM Automation Feature Developer's Guide" />
<meta name="dcterms.identifier" content="E10591-05" />
<meta name="dcterms.isVersionOf" content="COMDG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="preface.htm" title="Previous" type="text/html" />
<link rel="Next" href="ch2insta.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10591.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">6/13</span> <!-- End Header --><a id="g1007621"></a><a id="i1006171"></a>
<h1 class="chapter"><span class="secnum">1</span> <a id="COMDG002"></a>Introducing Oracle COM Automation Feature</h1>
<p>This chapter describes the Oracle COM Automation Feature Software Development Kit (SDK) and provides an overview of the product. Read this chapter before installing or using Oracle COM Automation Feature.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database 11<span class="italic">g</span> Release 2 (11.2) is the last database version that supports Oracle COM Automation feature. Oracle Database versions, which are released after Oracle Database 11<span class="italic">g</span> Release 2 (11.2), will not support Oracle COM Automation feature. You can continue to use Oracle COM Automation feature with existing Oracle Database versions that are covered under the lifetime support policy of Oracle.</div>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1006187">Overview of Oracle COM Automation Feature</a></p>
</li>
<li>
<p><a href="#i1006226">Benefits of Oracle COM Automation Feature</a></p>
</li>
<li>
<p><a href="#i1006244">Oracle COM Automation Feature Architecture</a></p>
</li>
</ul>
<a id="i1006187"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of Oracle COM Automation Feature<a id="sthref7"></a></h2>
<p>Oracle COM Automation Feature enables you to use <a href="glossary.htm#i996732"><span class="xrefglossterm">Component Object Model (COM)</span></a>-based components to customize and enhance the functionality of the Oracle database on Windows operating systems.</p>
<p>You can build your own custom components or use the thousands of prebuilt components that are available from third-party independent software vendors (ISVs).</p>
<a id="i1006195"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Oracle COM Automation Feature Functionality<a id="sthref8"></a><a id="sthref9"></a></h3>
<p>Oracle COM Automation Feature provides a mechanism to manipulate COM objects through either <a href="glossary.htm#i996768"><span class="xrefglossterm">PL/SQL</span></a> or Java.</p>
<ul>
<li>
<p>Oracle COM Automation Feature acts as a generic wrapper around the <code>IDispatch</code> interface.</p>
</li>
<li>
<p>Oracle COM Automation Feature externalizes all methods supported by the <code>IDispatch</code> interface.</p>
</li>
<li>
<p><span class="bold">COM</span> objects expose properties, data attributes, and methods (functions that perform an action) to the developer.</p>
</li>
<li>
<p>The <code>IDispatch</code> interface supports three basic operations for any COM object:</p>
<ul>
<li>
<p>Gets the value of an exposed property</p>
</li>
<li>
<p>Sets the value of an exposed property</p>
</li>
<li>
<p>Invokes a method on an object</p>
</li>
</ul>
</li>
</ul>
<p>When an Oracle COM Automation Feature application programming interface (API) is invoked from PL/SQL or Java stored procedures, Oracle COM Automation Feature converts the parameters to the appropriate COM Automation data types and then invokes the corresponding <code>IDispatch</code> API with the converted parameters.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a href="ch3core.htm#g1018297">Chapter 3, "Oracle COM Automation Feature Core Functionality"</a> for descriptions of the data types and APIs</div>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref10"></a>
<h4 class="sect3">Oracle COM Automation Feature for PL/SQL</h4>
<p>Oracle COM Automation Feature for PL/SQL provides a PL/SQL package and exposes a set of application programming interfaces (APIs) to instantiate COM objects. Developers can call these APIs from PL/SQL subprograms, stored procedures, stored functions, or triggers to manipulate COM objects.</p>
<p>There are no restrictions concerning where these COM objects reside. They can be local to the database or accessed remotely through the <a href="glossary.htm#i996735"><span class="xrefglossterm">Distributed Component Object Model (DCOM)</span></a>.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref11"></a>
<h4 class="sect3">Oracle COM Automation Feature for Java</h4>
<p>Oracle COM Automation Feature for Java provides a set of Java APIs to instantiate COM objects. Developers can call these APIs from Java stored procedures, Java functions, or Java triggers to manipulate COM objects.</p>
<p>Oracle COM Automation Feature for Java does not allow in-process COM Automation servers. Developers can use <code>dllhost</code> to support in-process servers.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006226"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Benefits of <a id="sthref12"></a><a id="sthref13"></a>Oracle COM Automation Feature</h2>
<p>Oracle COM Automation Feature is a powerful and enabling infrastructure technology for Oracle developers on Windows. It has the following advantages:</p>
<ul>
<li>
<p>Ease of Development</p>
<p>Oracle COM Automation Feature exposes a simple set of APIs to manipulate COM objects. If you are familiar with COM and Microsoft Visual Basic, you can easily incorporate these APIs into your PL/SQL subprograms or Java programs.</p>
</li>
<li>
<p>Reusability</p>
<p>Oracle COM Automation Feature enables you to leverage prebuilt COM components that have been developed in-house or by third-party independent software vendors (ISVs). In addition, there are thousands of existing COM components from which you can choose. The COM component market is expanding rapidly and offers solutions to many common programming problems.</p>
</li>
<li>
<p>Flexibility and Extensibility</p>
<p>You can use Oracle COM Automation Feature to customize and enhance the functionality of the database server. Through the use of COM components, the Oracle database can be customized to:</p>
<ul>
<li>
<p>Exchange data among productivity applications, such as Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.</p>
</li>
<li>
<p>Generate reports using Seagate Crystal Reports.</p>
</li>
<li>
<p>Send and receive e-mail with MAPI-compliant applications.</p>
</li>
</ul>
<p>The possibilities for customization and extensibility of the database server are limitless.</p>
</li>
<li>
<p>Enhanced Integration</p>
<p>Oracle COM Automation Feature enables you to deploy Oracle Database in a combined Oracle and Windows environment. You can be assured that Oracle COM Automation Feature integrates fully with and capitalizes on the services that are exposed by Windows, Microsoft BackOffice applications, and Microsoft Office applications.</p>
</li>
<li>
<p>Portability and Platform-Specific Requirements</p>
<p>Applications using Oracle COM Automation Feature are written in Java or PL/SQL, which are platform-independent. Only the database instance that needs to invoke COM components must be run on Windows.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i1006244"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Oracle COM Automation Feature Architecture<a id="sthref14"></a><a id="sthref15"></a></h2>
<p><a href="#i1006251">Figure 1-1</a> illustrates the interaction between an Oracle database with Oracle COM Automation Feature, client applications, and server applications.</p>
<div class="figure">
<p class="titleinfigure"><a id="i1006251"></a>Figure 1-1 Oracle COM Interaction</p>
<img width="434" height="287" src="img/comdg001.gif" alt="Description of Figure 1-1 follows" title="Description of Figure 1-1 follows" /><br />
<a id="sthref16" href="img_text/comdg001.htm">Description of "Figure 1-1 Oracle COM Interaction"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The architectural differences between Oracle COM Automation Feature for PL/SQL and for Java are described in the next two sections.</p>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref17"></a>
<h3 class="sect2"><a id="sthref18"></a>PL/SQL <a id="sthref19"></a>Architecture</h3>
<p>Oracle COM Automation Feature for PL/SQL provides a package of PL/SQL APIs for manipulating COM objects. These APIs are implemented as <a href="glossary.htm#i996741"><span class="xrefglossterm">external procedure</span></a>s in a <a href="glossary.htm#i996738"><span class="xrefglossterm">dynamic-link library (DLL)</span></a>.</p>
<p>Oracle supports external procedures that enable developers to call third-generation language (3GL) functions from server-based object type methods and stored procedures. External procedures are invoked exactly like standard PL/SQL stored procedures. However, unlike standard PL/SQL procedures where the body of the procedure is written in PL/SQL and stored in the database, external procedures are functions in the C programming language that reside within a DLL. You can invoke Oracle COM Automation Feature APIs in the same manner in which you call a standard PL/SQL stored procedure or function.</p>
<p><a href="#i1006273">Figure 1-2</a> shows an Oracle database invoking COM Automation external procedure APIs.</p>
<div class="figure">
<p class="titleinfigure"><a id="i1006273"></a>Figure 1-2 COM Automation Feature Architecture for PL/SQL</p>
<img width="592" height="320" src="img/comdg002.gif" alt="Description of Figure 1-2 follows" title="Description of Figure 1-2 follows" /><br />
<a id="sthref20" href="img_text/comdg002.htm">Description of "Figure 1-2 COM Automation Feature Architecture for PL/SQL"</a><br />
<br /></div>
<!-- class="figure" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref21"></a>
<h4 class="sect3">Invoking <a id="sthref22"></a>COM Automation External Procedure APIs</h4>
<p>The database server invokes any of the COM Automation <span class="bold">external procedure</span> APIs as follows:</p>
<ol>
<li>
<p>The PL/SQL interpreter looks up the path name to the Oracle COM Automation Feature DLL (<code><a id="sthref23"></a>orawpcom</code><code><span class="codeinlineitalic">VER</span></code><code><a id="sthref24"></a>.dll</code>) where <code><span class="codeinlineitalic">VER</span></code> is the release version.</p>
</li>
<li>
<p>The PL/SQL interpreter sends a message to the <a href="glossary.htm#i996752"><span class="xrefglossterm">listener</span></a> using <a href="glossary.htm#i996765"><span class="xrefglossterm">Oracle Net</span></a> to start <code><a id="sthref25"></a>extproc.exe</code>, if it has not already been started for the current user session.</p>
</li>
<li>
<p>The PL/SQL interpreter passes the procedure name, the parameters, and the path name of the DLL to <code>extproc.exe</code>.</p>
</li>
<li>
<p>The <code>extproc.exe</code> file loads the DLL and executes the external procedure. Each of the COM Automation external procedure APIs in turn calls Win32 APIs that instantiate a COM object, set or get properties of a COM object, or invoke a method of a COM object.</p>
</li>
<li>
<p><code>The extproc.exe</code> file acts as an intermediary and handles any interaction between Oracle COM Automation Feature and the database server.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref26"></a>
<h4 class="sect3">Architectural Impact on Availability Issues</h4>
<p>The dependence on external procedures by Oracle COM Automation Feature for PL/SQL has implications for the availability of the database server.</p>
<p>You do not jeopardize the availability of the database server by using Oracle COM Automation Feature and custom or third-party COM objects in a production environment. Oracle COM Automation Feature operates outside of the Oracle kernel's address space. This safeguards the Oracle database from COM objects that stop abruptly.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006298"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Java <a id="sthref27"></a>Architecture</h3>
<p>Oracle COM Automation Feature for Java is implemented by the Java Native Interface (JNI). The key components of this architecture are the <code>Automation</code> class and the Java COM Proxy DLL, <code>orawcom</code><code><span class="codeinlineitalic">VER</span></code><code><a id="sthref28"></a>.dll</code>, where <code><span class="codeinlineitalic">VER</span></code> is the release version.</p>
<p>The interface is the <code>Automation</code> class, a Java proxy to the COM Automation server. The <code>Automation</code> class provides the methods necessary for developers to manipulate COM objects through the <code>IDispatch</code> interface.</p>
<p>The Java-specific COM proxy, <code>orawcom</code><code><span class="codeinlineitalic">VER</span></code><code><a id="sthref29"></a>.dll</code>, enables Java functions to invoke their corresponding COM functions.</p>
<p><a href="#i1006309">Figure 1-3</a> illustrates implementation of Oracle COM Automation Feature for Java.</p>
<div class="figure">
<p class="titleinfigure"><a id="i1006309"></a>Figure 1-3 COM Automation Feature Architecture for Java</p>
<img width="600" height="272" src="img/comdg003.gif" alt="Description of Figure 1-3 follows" title="Description of Figure 1-3 follows" /><br />
<a id="sthref30" href="img_text/comdg003.htm">Description of "Figure 1-3 COM Automation Feature Architecture for Java"</a><br />
<br /></div>
<!-- class="figure" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref31"></a>
<h4 class="sect3">Reliability</h4>
<p>Oracle COM Automation Feature for Java invokes COM components from the database server. However, these COM components are run outside of the Oracle database process. This design prevents unstable COM components from interfering with the database process.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment703">
<tr>
<td class="cellalignment710">
<table class="cellalignment708">
<tr>
<td class="cellalignment707"><a href="preface.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment707"><a href="ch2insta.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment712">
<table class="cellalignment706">
<tr>
<td class="cellalignment707"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment707"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment707"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment707"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment707"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment707"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
