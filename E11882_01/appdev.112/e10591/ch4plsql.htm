<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Oracle COM Automation PL/SQL Demos</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1" />
<meta name="dcterms.created" content="2011-01-21T18:9:26Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="COM Automation Feature Developer's Guide" />
<meta name="dcterms.identifier" content="E10591-05" />
<meta name="dcterms.isVersionOf" content="COMDG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="ch3core.htm" title="Previous" type="text/html" />
<link rel="Next" href="ch5java.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10591.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">9/13</span> <!-- End Header --><a id="g1012247"></a>
<h1 class="chapter"><span class="secnum">4</span> <a id="COMDG005"></a>Oracle COM Automation PL/SQL Demos</h1>
<p>This chapter describes how to use Oracle COM Automation Feature demonstration programs for PL/SQL.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#BJEFEGAF">Overview of Oracle COM Automation Feature for PL/SQL Demos</a></p>
</li>
<li>
<p><a href="#i1006218">Microsoft Word Demo</a></p>
</li>
<li>
<p><a href="#i1006352">Microsoft Excel Demo</a></p>
</li>
<li>
<p><a href="#i1006495">Microsoft PowerPoint Demo</a></p>
</li>
<li>
<p><a href="#i1006578">MAPI Demo</a></p>
</li>
</ul>
<a id="BJEFEGAF"></a>
<div class="sect1">
<h2 class="sect1">Overview of Oracle COM Automation Feature for PL/SQL Demos <a id="sthref211"></a><a id="sthref212"></a><a id="sthref213"></a></h2>
<p>Oracle COM Automation Feature for PL/SQL includes examples that demonstrate how to use the feature to build solutions. These demos provide base functionality and can serve as a foundation on which to build more customized, complex applications that use COM Automation. The demos are based on the human resources schema available with the <a id="sthref214"></a>sample schema.</p>
<p>Each demo exposes a core set of APIs that enables you to do simple operations using COM Automation. Each COM Automation server, such as Word and Excel, provides more advanced capabilities than what is offered through the demo APIs. To take advantage of these advanced features, you must design and code your own PL/SQL procedures.</p>
<p>In this release, COM Automation has provided the following demos:</p>
<ul>
<li>
<p><a href="#i1006218">Microsoft Word Demo</a> - Exchanges data between Microsoft Word and Oracle Database</p>
</li>
<li>
<p><a href="#i1006352">Microsoft Excel Demo</a> - Exchanges data between Microsoft Excel and Oracle Database</p>
</li>
<li>
<p><a href="#i1006495">Microsoft PowerPoint Demo</a> - Exchanges data between Microsoft PowerPoint and Oracle Database</p>
</li>
<li>
<p><a href="#i1006578">MAPI Demo</a> - Exchanges data between Messaging Application Programming Interface (MAPI) compliant applications and Oracle Database</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i1006218"></a>
<div class="sect1">
<h2 class="sect1">Microsoft Word Demo<a id="sthref215"></a><a id="sthref216"></a><a id="sthref217"></a></h2>
<p>The following sections describe how to install the Microsoft Word demo and the APIs that it exposes. This demo is provided as an example of the types of solutions that can be built with Oracle Database and Microsoft Word.</p>
<p>The demo creates a Microsoft Word document containing the names of employees in the database.</p>
<p>The Microsoft Word demo provides the following:</p>
<ul>
<li>
<p><code>ORDWord</code>, a <a id="sthref218"></a><a id="sthref219"></a>PL/SQL package that exposes several APIs for manipulating Microsoft Word. This package is created by the <code>wordsol.sql</code> script.</p>
</li>
<li>
<p><code>worddem.sql</code><a id="sthref220"></a>, a script that displays the capabilities of exchanging data between Oracle Database and Microsoft Word. It exchanges data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables to a Microsoft Word document. These tables are available in the human resources schema in the sample schema.</p>
</li>
</ul>
<div class="sect2"><a id="sthref221"></a>
<h3 class="sect2">Installing the Microsoft Word Demo</h3>
<p><a id="sthref222"></a>Microsoft Word must be installed on the local computer before you install this demo.</p>
<p>To install Microsoft Word demos:</p>
<ol>
<li>
<p>Start SQL*Plus.</p>
<pre>
C:\&gt; sqlplus /NOLOG
</pre></li>
<li>
<p>Connect to the Oracle database instance as the user who will use the Microsoft Word demo. For example:</p>
<pre>
SQL&gt; connect hr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Run the <code>wordsol.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\wordsol.sql;
</pre>
<p>This script creates the <code>ORDWord</code> package in the current user's schema. You will receive the following error several times when you run this script for the first time:</p>
<pre>
ORA-04043: object <span class="italic">XXXX</span> does not exist. 
</pre>
<p>These messages are normal.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref223"></a>
<h3 class="sect2">Using the Microsoft Word Demo</h3>
<p>To use the Microsoft Word demo:</p>
<ol>
<li>
<p>Run the <code>worddem.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\worddem.sql;
</pre>
<p>This script creates a Microsoft Word document (<code>worddemo.doc</code>) in the <code>C:\</code> directory. The document contains data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables. These tables are available in the human resources schema in the sample schema.</p>
</li>
<li>
<p>Open the <code>worddemo.doc</code> file to see its contents.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref224"></a>
<h3 class="sect2">Core Functionality</h3>
<p>The following subsections describe the APIs that the Microsoft Word demo exposes. These APIs are primitive and do not expose all the functionalities that Microsoft Word exposes through COM Automation.</p>
<p class="subhead2"><a id="sthref225"></a><a id="sthref226"></a>CreateWordObject</p>
<p>This API instantiates a <code>Word.Basic</code> object in the Microsoft Word Automation server.</p>
<p class="subhead2"><a id="sthref227"></a>Syntax</p>
<pre>
FUNCTION CreateWordObject() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref228"></a>Remarks</p>
<p>This function must be called before any other operation can be performed. This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref229"></a><a id="sthref230"></a>FileNew</p>
<p>This API creates a new Microsoft Word document.</p>
<p class="subhead2"><a id="sthref231"></a>Syntax</p>
<pre>
FUNCTION FileNew() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref232"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref233"></a><a id="sthref234"></a>FileLoad</p>
<p>This API loads a document into Microsoft Word.</p>
<p class="subhead2"><a id="sthref235"></a>Syntax</p>
<pre>
FUNCTION FileLoad(filename VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FileLoad parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t2"><span class="bold">Where</span></th>
<th class="cellalignment716" id="r1c2-t2">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t2" headers="r1c1-t2"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t2 r1c2-t2">the fully qualified filename of the document.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref236"></a>Remarks</p>
<p>This function returns a <code>0</code> when successful or a nonzero <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref237"></a><a id="sthref238"></a>FileSave</p>
<p>This API saves the current Microsoft Word document to disk.</p>
<p class="subhead2"><a id="sthref239"></a>Syntax</p>
<pre>
FUNCTION FileSave() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref240"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref241"></a><a id="sthref242"></a>FileSaveAs</p>
<p>This API saves the current Microsoft Word document as a specific file.</p>
<p class="subhead2"><a id="sthref243"></a>Syntax</p>
<pre>
FUNCTION FileSaveAs(filename VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FileSaveAs parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t3">Where</th>
<th class="cellalignment716" id="r1c2-t3">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t3" headers="r1c1-t3"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t3 r1c2-t3">the fully qualified filename of the document.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref244"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref245"></a><a id="sthref246"></a>FileClose</p>
<p>This API closes the current Microsoft Word document.</p>
<p class="subhead2"><a id="sthref247"></a>Syntax</p>
<pre>
FUNCTION FileClose() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref248"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref249"></a><a id="sthref250"></a>InsertText</p>
<p>This API inserts a text string into the current Microsoft Word document.</p>
<p class="subhead2"><a id="sthref251"></a>Syntax</p>
<pre>
FUNCTION InsertText(textstr VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="InsertText parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t4">Where</th>
<th class="cellalignment716" id="r1c2-t4">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t4" headers="r1c1-t4"><code>textstr</code></td>
<td class="cellalignment710" headers="r2c1-t4 r1c2-t4">the text that will be inserted into the document.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref252"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref253"></a><a id="sthref254"></a>InsertNewLine</p>
<p>This API inserts a new line into the current Microsoft Word document.</p>
<p class="subhead2"><a id="sthref255"></a>Syntax</p>
<pre>
FUNCTION InsertNewLine() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref256"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref257"></a><a id="sthref258"></a>FormatFontSize</p>
<p>This API sets the font size for the current Microsoft Word document.</p>
<p class="subhead2"><a id="sthref259"></a>Syntax</p>
<pre>
FUNCTION FormatFontSize(fontsize BINARY_INTEGER) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FormatFontSize parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t5">Where</th>
<th class="cellalignment716" id="r1c2-t5">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t5" headers="r1c1-t5"><code>fontsize</code></td>
<td class="cellalignment710" headers="r2c1-t5 r1c2-t5">the point size of the font.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref260"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006352"></a>
<div class="sect1">
<h2 class="sect1">Microsoft Excel Demo<a id="sthref261"></a><a id="sthref262"></a><a id="sthref263"></a></h2>
<p>The following sections detail how to install the Microsoft Excel demo and describe the APIs that it exposes. This demo is provided as an example of the types of solutions that can be built with Oracle and Microsoft Excel.</p>
<p>The Microsoft Excel demo provides the following:</p>
<ul>
<li>
<p><code><a id="sthref264"></a><a id="sthref265"></a>ORDExcel</code>, a PL/SQL package that exposes several APIs for manipulating Microsoft Excel. This package is created by the <code>excelsol.sql</code> script.</p>
</li>
<li>
<p><a id="sthref266"></a><a id="sthref267"></a><a id="sthref268"></a><code>exceldem.sql</code>, a script that displays the capabilities of exchanging data between Oracle database instance and Microsoft Excel. It exchanges data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables in Oracle database instance to a Microsoft Excel spreadsheet and puts it in a graph. These tables are available in the human resources schema in the sample schema.</p>
</li>
</ul>
<div class="sect2"><a id="sthref269"></a>
<h3 class="sect2">Installing the Microsoft Excel Demo</h3>
<p><a id="sthref270"></a>Microsoft Excel must be installed on the local computer before you install this demo.</p>
<p>To install the Microsoft Excel demo:</p>
<ol>
<li>
<p>Start SQL*Plus.</p>
<pre>
C:\&gt; sqlplus /NOLOG
</pre></li>
<li>
<p>Connect to the Oracle Database instance as the user who will use the Microsoft Excel demo. For example:</p>
<pre>
SQL&gt; connect hr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Run the <code>excelsol.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\excelsol.sql;
</pre>
<p>This script creates the <code>ORDExcel</code> package in the schema of the current user. You will receive the following error several times when you run this script for the first time:</p>
<pre>
ORA-04043: object <span class="italic">XXXX</span> does not exist. 
</pre>
<p>These messages are normal.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref271"></a>
<h3 class="sect2">Using the Microsoft Excel Demo</h3>
<p>To use the Microsoft Excel demo:</p>
<ol>
<li>
<p>Run the <code>exceldem.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\exceldem.sql;
</pre>
<p>This script creates a Microsoft Excel spreadsheet (<code>excel</code><code><span class="codeinlineitalic">xxxxx</span></code><code>.xls</code>) in the <code>C:\</code> directory. The document contains data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables. These tables are available in the human resources schema in the sample schema.</p>
</li>
<li>
<p>Open the <code>excel</code><code><span class="codeinlineitalic">xxxxx</span></code><code>.xls</code> file, where <code><span class="codeinlineitalic">xxxxx</span></code> is a time stamp, to see the content of this file.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref272"></a>
<h3 class="sect2">Core Functionality</h3>
<p>The following subsections describe the APIs that the Microsoft Excel demo exposes. These APIs are primitive and do not expose all the functionalities that Microsoft Excel exposes through COM Automation.</p>
<p class="subhead2"><a id="sthref273"></a><a id="sthref274"></a> CreateExcelWorkSheet</p>
<p>This API starts the Microsoft Excel COM Automation server and instantiates the objects for a workbook and a worksheet.</p>
<p class="subhead2"><a id="sthref275"></a>Syntax</p>
<pre>
FUNCTION CreateExcelWorkSheet() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref276"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref277"></a><a id="sthref278"></a>InsertData</p>
<p>This API inserts any kind of data into a specific cell of the current Excel worksheet.</p>
<p class="subhead2"><a id="sthref279"></a>Syntax</p>
<pre>
FUNCTION InsertData(range VARCHAR2, data <span class="italic">any_PL/SQL_data type</span>, data type VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="InsertData parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t6">Where</th>
<th class="cellalignment716" id="r1c2-t6">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t6" headers="r1c1-t6"><code>range</code></td>
<td class="cellalignment710" headers="r2c1-t6 r1c2-t6">a string that indicates a specific cell in the current Excel worksheet (for example, 'A1', 'B1').</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r3c1-t6" headers="r1c1-t6"><code>data</code></td>
<td class="cellalignment710" headers="r3c1-t6 r1c2-t6">the data that you want to insert into the current Excel worksheet.</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r4c1-t6" headers="r1c1-t6"><code>data type</code></td>
<td class="cellalignment710" headers="r4c1-t6 r1c2-t6">a string that indicates the data type of the data that you are inserting into Excel. The list of available data types are:</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r5c1-t6" headers="r1c1-t6">&nbsp;</td>
<td class="cellalignment710" headers="r5c1-t6 r1c2-t6">
<ul>
<li><code>I2</code> - 2-byte integer</li>
<li>
<p><code>I4</code> - 4-byte integer</p>
</li>
<li>
<p><code>R4</code> - IEEE 4-byte real</p>
</li>
<li>
<p><code>R8</code> - IEEE 8-byte real</p>
</li>
<li>
<p><code>SCODE</code> - error code</p>
</li>
<li>
<p><code>CY</code> - currency</p>
</li>
<li>
<p><code>DISPATCH</code> - dispatch pointer</p>
</li>
<li>
<p><code>BSTR</code> - String</p>
</li>
<li>
<p><code>BOOL</code> - boolean</p>
</li>
<li>
<p><code>DATE</code> - date</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r6c1-t6" headers="r1c1-t6"><code><span class="codeinlineitalic">any_PL/SQL_data type</span></code></td>
<td class="cellalignment710" headers="r6c1-t6 r1c2-t6">any data type supported by COM Automation Feature.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref280"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref281"></a><a id="sthref282"></a>InsertChart</p>
<p>This API creates a chart of a specified range of data and inserts the chart at the x and y position of the current worksheet with the desired height and width.</p>
<p class="subhead2"><a id="sthref283"></a>Syntax</p>
<pre>
FUNCTION InsertChart(xpos BINARY_INTEGER, ypos<span class="bold"> </span>BINARY_INTEGER,<span class="bold"> </span>width<span class="bold"> </span>BINARY_INTEGER,<span class="bold"> </span>height<span class="bold"> </span>BINARY_INTEGER,
<span class="bold"> </span>range<span class="bold"> </span>VARCHAR2,<span class="bold"> </span>type<span class="bold"> </span>VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="InsertChart parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t7">Where</th>
<th class="cellalignment716" id="r1c2-t7">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t7" headers="r1c1-t7"><code>xpos</code></td>
<td class="cellalignment710" headers="r2c1-t7 r1c2-t7">the x position in the current worksheet where the chart should be inserted</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r3c1-t7" headers="r1c1-t7"><code>ypos</code></td>
<td class="cellalignment710" headers="r3c1-t7 r1c2-t7">the y position in the current worksheet where the chart should be inserted</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r4c1-t7" headers="r1c1-t7"><code>width</code></td>
<td class="cellalignment710" headers="r4c1-t7 r1c2-t7">the width of the chart</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r5c1-t7" headers="r1c1-t7"><code>height</code></td>
<td class="cellalignment710" headers="r5c1-t7 r1c2-t7">the height of the chart</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r6c1-t7" headers="r1c1-t7"><code>range</code></td>
<td class="cellalignment710" headers="r6c1-t7 r1c2-t7">the range of cells to be graphed</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r7c1-t7" headers="r1c1-t7"><code>type</code></td>
<td class="cellalignment710" headers="r7c1-t7 r1c2-t7">the data type of the data to be graphed</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref284"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref285"></a><a id="sthref286"></a>SaveExcelFile</p>
<p>This API saves the current Microsoft Excel workbook as a specific file.</p>
<p class="subhead2"><a id="sthref287"></a>Syntax</p>
<pre>
FUNCTION SaveExcelFile(filename VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="SaveExcelFile parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t8">Where</th>
<th class="cellalignment716" id="r1c2-t8">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t8" headers="r1c1-t8"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t8 r1c2-t8">the fully qualified file name of the Excel workbook</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref288"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref289"></a><a id="sthref290"></a>ExitExcel</p>
<p>Performs some cleanup and destroys the outstanding references to the Excel COM Automation server. This should be the last API called.</p>
<p class="subhead2"><a id="sthref291"></a>Syntax</p>
<pre>
FUNCTION ExitExcel() RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref292"></a>Remarks</p>
<p>This function returns a <code>0</code> when successful or a nonzero <code>HRESULT</code> when an error occurs.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006495"></a>
<div class="sect1">
<h2 class="sect1">Microsoft PowerPoint Demo<a id="sthref293"></a><a id="sthref294"></a><a id="sthref295"></a></h2>
<p>The following sections detail how to install the Microsoft PowerPoint demo and describe the APIs that it exposes. This demo is provided as an example of the types of solutions that can be built with Oracle Database instance and Microsoft PowerPoint.</p>
<p>The Microsoft PowerPoint demo provides the following:</p>
<ul>
<li>
<p><code><a id="sthref296"></a><a id="sthref297"></a>ORDPPT</code>, a PL/SQL package that exposes several APIs for manipulating Microsoft PowerPoint. This package is created by the <a id="sthref298"></a><code>pptsol.sql</code> script.</p>
</li>
<li>
<p><a id="sthref299"></a><code>pptdem.sql</code>, a script that displays the capabilities of exchanging data between Oracle Database instance and Microsoft PowerPoint. It exchanges data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables in Oracle Database instance to a Microsoft PowerPoint document. These tables are available in the human resources schema in the sample schema.</p>
</li>
</ul>
<div class="sect2"><a id="sthref300"></a>
<h3 class="sect2">Installing the Microsoft PowerPoint Demo</h3>
<p><a id="sthref301"></a>Microsoft PowerPoint must be installed on the local computer before installing this demo.</p>
<p>To install the Microsoft PowerPoint demo:</p>
<ol>
<li>
<p>Start SQL*Plus.</p>
<pre>
C:&gt; sqlplus /NOLOG
</pre></li>
<li>
<p>Connect to the Oracle Database instance as the user who will use the Microsoft PowerPoint demo. For example:</p>
<pre>
SQL&gt; connect hr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Run the <code>pptsol.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\pptsol.sql;
</pre>
<p>This script creates the <code>ORDPPT</code> package in the current user's schema. You will receive the following error several times when you run this script for the first time:</p>
<pre>
ORA-04043: object <span class="italic">XXXX</span> does not exist. 
</pre>
<p>These messages are normal.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref302"></a>
<h3 class="sect2">Using the Microsoft PowerPoint Demo</h3>
<p>To run the Microsoft PowerPoint demo:</p>
<ol>
<li>
<p>Run the <code>pptdem.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\pptdem.sql;
</pre>
<p>This script creates a Microsoft PowerPoint presentation (<code>pptdemo.ppt</code>) on <code>C:\</code>. The document contains a list of employee names.</p>
</li>
<li>
<p>Open <code>pptdemo.ppt</code> to see its contents.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref303"></a>
<h3 class="sect2">Core Functionality</h3>
<p>The following subsections describe the APIs that the Microsoft PowerPoint demo exposes. These APIs are primitive and do not expose all the functionalities that Microsoft PowerPoint exposes through COM Automation.</p>
<p class="subhead2"><a id="sthref304"></a><a id="sthref305"></a>CreatePresentation</p>
<p>This API starts the Microsoft PowerPoint COM Automation server and instantiates the objects for a presentation.</p>
<p class="subhead2"><a id="sthref306"></a>Syntax</p>
<pre>
FUNCTION CreatePresentation (servername IN VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="CreatePresentation parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t9">Where</th>
<th class="cellalignment716" id="r1c2-t9">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t9" headers="r1c1-t9"><code>servername</code></td>
<td class="cellalignment710" headers="r2c1-t9 r1c2-t9">Microsoft Powerpoint COM Automation Server name</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref307"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref308"></a><a id="sthref309"></a>AddSlide</p>
<p>This API inserts a new slide in the PowerPoint presentation.</p>
<p class="subhead2"><a id="sthref310"></a>Syntax</p>
<pre>
FUNCTION AddSlide (layout IN BINARY_INTEGER) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="AddSlide parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t10">Where</th>
<th class="cellalignment716" id="r1c2-t10">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t10" headers="r1c1-t10"><code>layout</code></td>
<td class="cellalignment710" headers="r2c1-t10 r1c2-t10">the layout of the new slide</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref311"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref312"></a><a id="sthref313"></a>SetTitle</p>
<p>This API specifies the title of the PowerPoint slide.</p>
<p class="subhead2"><a id="sthref314"></a>Syntax</p>
<pre>
FUNCTION SetTitle (title IN VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="SetTitle parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t11">Where</th>
<th class="cellalignment716" id="r1c2-t11">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t11" headers="r1c1-t11"><code>title</code></td>
<td class="cellalignment710" headers="r2c1-t11 r1c2-t11">Powerpoint slide title</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref315"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref316"></a><a id="sthref317"></a>InsertText</p>
<p>This API inserts text into the specified location on the slide.</p>
<p class="subhead2"><a id="sthref318"></a>Syntax</p>
<pre>
FUNCTION InsertText (orientation IN BINARY_INTEGER, left IN BINARY_INTEGER, top IN BINARY_INTEGER, 
width IN BINARY_INTEGER, height IN BINARY_INTEGER, text IN VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="InsertText parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t12">Where</th>
<th class="cellalignment716" id="r1c2-t12">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t12" headers="r1c1-t12"><code>orientation</code></td>
<td class="cellalignment710" headers="r2c1-t12 r1c2-t12">orientation of the text box</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r3c1-t12" headers="r1c1-t12"><code>left</code></td>
<td class="cellalignment710" headers="r3c1-t12 r1c2-t12">distance between the left edge of the text box and the left edge of the slide in pixels</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r4c1-t12" headers="r1c1-t12"><code>top</code></td>
<td class="cellalignment710" headers="r4c1-t12 r1c2-t12">distance between the top edge of the text box and the top edge of the slide in pixels</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r5c1-t12" headers="r1c1-t12"><code>width</code></td>
<td class="cellalignment710" headers="r5c1-t12 r1c2-t12">width of the text box in pixels</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r6c1-t12" headers="r1c1-t12"><code>height</code></td>
<td class="cellalignment710" headers="r6c1-t12 r1c2-t12">height of the text box in pixels</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r7c1-t12" headers="r1c1-t12"><code>text</code></td>
<td class="cellalignment710" headers="r7c1-t12 r1c2-t12">text entered in the text box</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref319"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref320"></a><a id="sthref321"></a>PresentationSave</p>
<p>This API saves the current PowerPoint presentation.</p>
<p class="subhead2"><a id="sthref322"></a>Syntax</p>
<pre>
FUNCTION PresentationSave RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref323"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref324"></a><a id="sthref325"></a>PresentationSaveAs</p>
<p>This API saves the current presentation using the specified name.</p>
<p class="subhead2"><a id="sthref326"></a>Syntax</p>
<pre>
FUNCTION PresentationSaveAs (filename IN VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="PresentationSaveAs" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t13">Where</th>
<th class="cellalignment716" id="r1c2-t13">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t13" headers="r1c1-t13"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t13 r1c2-t13">the fully qualified filename of the presentation.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref327"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref328"></a><a id="sthref329"></a>PresentationClose</p>
<p>This API closes the current PowerPoint presentation.</p>
<p class="subhead2"><a id="sthref330"></a>Syntax</p>
<pre>
FUNCTION PresentationClose RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref331"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref332"></a><a id="sthref333"></a>Exit</p>
<p>This API exits the PowerPoint program.</p>
<p class="subhead2"><a id="sthref334"></a>Syntax</p>
<pre>
FUNCTION Exit RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref335"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006578"></a>
<div class="sect1">
<h2 class="sect1">MAPI Demo<a id="sthref336"></a><a id="sthref337"></a><a id="sthref338"></a></h2>
<p>The following sections detail how to install the <a href="glossary.htm#i996758"><span class="xrefglossterm">messaging application programming interface (MAPI)</span></a> demo and describe the APIs that it exposes. This demo is provided as an example of the types of solutions that can be built with an Oracle Database instance and MAPI-compliant applications.</p>
<p>The MAPI demo provides the following:</p>
<ul>
<li>
<p><code><a id="sthref339"></a><a id="sthref340"></a>ORDMAPI</code>, a PL/SQL package that exposes several APIs for manipulating the Extended MAPI client.</p>
</li>
<li>
<p><a id="sthref341"></a><code>mapidem.sql</code>, a script that displays the capabilities of exchanging data between Oracle Database instance and the Extended MAPI client.</p>
</li>
<li>
<p><code>mapi.reg</code>, a registration entry file that updates the registry settings.</p>
</li>
</ul>
<a id="i1006591"></a>
<div class="sect2">
<h3 class="sect2">Setting Up the Environment to Use the MAPI Demo</h3>
<p>You must set up certain related applications to use the MAPI demo.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The following setup requires Microsoft Outlook 2000 or later. Outlook Express will not work.</div>
<p>To set up the environment for the MAPI demo:</p>
<ol>
<li>
<p>Install <a id="sthref342"></a>Exchange Server and create a new account as follows:</p>
<p>Select <span class="bold">Start</span>, <span class="bold">Programs</span>, <span class="bold">Microsoft Exchange,</span> and then A<span class="bold">ctive Directory Users and</span> <span class="bold">Computers</span>.</p>
<p>Select your domain and expand the folders. Select users and right-click to create a new user.</p>
</li>
<li>
<p>Install <a id="sthref343"></a>Microsoft Outlook as follows:</p>
<p>Select <span class="bold">Custom Install</span>. Select <span class="bold">Collaboration Data Objects</span>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
During the installation, these are not installed by default.</div>
<p>Select the <span class="bold">Corporate or Workgroup</span> option.</p>
</li>
<li>
<p>Configure Microsoft Outlook and set connection information as follows:</p>
<p>Add the account that you created on Exchange Server.</p>
<p>Enter your incoming and outgoing mail servers, and enter the account name and password.</p>
<p>Select the connection type (for example, LAN).</p>
</li>
<li>
<p>Set <a id="sthref344"></a>Microsoft Outlook as the default program for the e-mail, newsgroups, and calendar tools as follows:</p>
<p>From<a id="sthref345"></a> Internet Explorer, choose <span class="bold">Tools</span>, <span class="bold">Internet Options</span>, <span class="bold">Programs</span> and set the fields.</p>
</li>
<li>
<p>Patch <code>CDO.DLL</code> as mentioned in the MSDN article, 268272. This patched DLL is part of Microsoft Exchange 5.5. Manually copy the patched DLL to the proper location. The default location for this DLL is:</p>
<pre>
C:\Program Files\Common Files\System\Mapi\1033\NT
</pre></li>
<li>
<p>Update the registry settings by double-clicking <code>MAPI.REG</code> from the Windows Explorer. <code>MAPI.REG</code> is located in:</p>
<pre>
ORACLE_BASE\ORACLE_HOME\com\demos
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1006617"></a>
<div class="sect2">
<h3 class="sect2">Preparing to Install MAPI Demo<a id="sthref346"></a><a id="sthref347"></a><a id="sthref348"></a></h3>
<p>The MAPI Solution invokes Extended MAPI client on behalf of the Oracle Database server. The Oracle Database service on Windows 2000 and higher, by default, runs as the system user <code>LocalSystem</code>. The MAPI profile for user <code>LocalSystem</code> is not easily configured. Before using the MAPI Solution, change both the Oracle Database service and <code>Oracle</code><code><span class="codeinlineitalic">HOME_NAME</span></code><code>TNSListener</code>service to start up using a login user account.</p>
<p>To prepare to install the MAPI demo:</p>
<ol>
<li>
<p>Log on to Windows using your local user account or domain user account, for example, <code>DOMAIN-1\hr</code>.</p>
</li>
<li>
<p>Start the MAPI server (for example, Microsoft Outlook) and configure the MAPI profile for the Windows 2000 and higher user <code>DOMAIN-1\hr</code>. Ensure that you can send out e-mail using this profile.</p>
</li>
<li>
<p>Go to Windows Control Panel/Services.</p>
</li>
<li>
<p>Shut down the <code>Oracle</code><code><span class="codeinlineitalic">HOME_NAMETNS</span></code><code>Listener</code> service.</p>
</li>
<li>
<p>Select the <code>Oracle</code><code><span class="codeinlineitalic">HOME_NAMETNS</span></code><code>Listener</code> service and click <span class="bold">Startup</span>.</p>
</li>
<li>
<p>Change the <span class="bold">Log On As</span> to <span class="bold">This Account</span> and fill in <code>DOMAIN-1\hr</code>.</p>
</li>
<li>
<p>Enter the password and confirm the password for <code>DOMAIN-1\hr</code>.</p>
</li>
<li>
<p>Restart the <code>Oracle</code><code><span class="codeinlineitalic">HOME_NAMETNS</span></code><code>Listener</code> service.</p>
</li>
<li>
<p>Shut down the Oracle Database service.</p>
</li>
<li>
<p>Select the Oracle Database service and click <span class="bold">Startup</span>.</p>
</li>
<li>
<p>Change <span class="bold">Log On As</span> to <span class="bold">This Account</span> and fill in <code>DOMAIN-1\hr</code>.</p>
</li>
<li>
<p>Enter the password and confirm the password for <code>DOMAIN-1\hr</code>.</p>
</li>
<li>
<p>Restart the Oracle Database service.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref349"></a>
<h3 class="sect2">Installing the MAPI Demo</h3>
<p><a id="sthref350"></a>The MAPI application, such as Microsoft Outlook 2000 or later, must be installed on the local computer before you install this demo.</p>
<p>To install the MAPI demo:</p>
<ol>
<li>
<p>Start SQL*Plus.</p>
<pre>
C:&gt; sqlplus /NOLOG
</pre></li>
<li>
<p>Connect to the Oracle Database instance as the user who will use the MAPI demo. For example:</p>
<pre>
SQL&gt; connect hr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Run the <code>mapisol.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\mapisol.sql;
</pre>
<p>This script creates the <code>ORDMAPI</code> package in the current user's schema. You will receive the following error several times when you run this script for the first time:</p>
<pre>
ORA-04043: object <span class="italic">XXXX</span> does not exist. 
</pre>
<p>These messages are normal.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref351"></a>
<h3 class="sect2">Using the MAPI Demo</h3>
<p>To use the MAPI demo:</p>
<ol>
<li>
<p>Open <code>mapidem.sql</code> with a text editor and change the e-mail address <code>hr@us.oracle.com</code> in <code>ORDMapi.AddRecipient</code> to your own e-mail address. If you are not using the default as your profile name, also change the profile name that is indicated in <code>ORDMapi.CreateMAPISession</code>, <code>MS</code> <code>Exchange</code> <code>Settings</code>. Save the changes.</p>
</li>
<li>
<p>Run the <code>mapidem.sql</code> script at the SQL*Plus prompt:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\demos\mapidem.sql;
</pre>
<p>This script connects to a database server, extracts the data, and sends an e-mail to a specified recipient.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref352"></a>
<h3 class="sect2">Core Functionality</h3>
<p>The following subsections describe the APIs that the MAPI demo exposes. These APIs are primitive and do not expose all the functionalities that MAPI exposes through COM Automation.</p>
<p class="subhead2"><a id="sthref353"></a><a id="sthref354"></a>CreateMAPISession</p>
<p>This API starts the MAPI COM Automation server and instantiates the objects for a session.</p>
<p class="subhead2"><a id="sthref355"></a>Syntax</p>
<pre>
FUNCTION CreateMAPISession (servername IN VARCHAR2 DEFAULT '', profilename IN VARCHAR2 DEFAULT NULL, 
password IN VARCHAR2 DEFAULT NULL) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="CreateMAPISession" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t16">Where</th>
<th class="cellalignment716" id="r1c2-t16">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t16" headers="r1c1-t16"><code>servername</code></td>
<td class="cellalignment710" headers="r2c1-t16 r1c2-t16">MAPI server name</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r3c1-t16" headers="r1c1-t16"><code>profilename</code></td>
<td class="cellalignment710" headers="r3c1-t16 r1c2-t16">name of the profile present in the MAPI server</td>
</tr>
<tr class="cellalignment704">
<td class="cellalignment710" id="r4c1-t16" headers="r1c1-t16"><code>password</code></td>
<td class="cellalignment710" headers="r4c1-t16 r1c2-t16">password to connect to the MAPI server</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref356"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref357"></a><a id="sthref358"></a>NewMessage</p>
<p>This API creates a new message.</p>
<p class="subhead2"><a id="sthref359"></a>Syntax</p>
<pre>
FUNCTION NewMessage RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref360"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref361"></a><a id="sthref362"></a>AddRecipient</p>
<p>This API adds the e-mail address of a recipient. This is the address where the e-mail message will be sent.</p>
<p class="subhead2"><a id="sthref363"></a>Syntax</p>
<pre>
FUNCTION AddRecipient (emailaddress VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="AddRecipient parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t17">Where</th>
<th class="cellalignment716" id="r1c2-t17">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t17" headers="r1c1-t17"><code>emailaddress</code></td>
<td class="cellalignment710" headers="r2c1-t17 r1c2-t17">e-mail address of the recipient</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref364"></a>Remarks</p>
<p>This function returns a <code>0</code> when successful or a nonzero <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref365"></a><a id="sthref366"></a>SetSubject</p>
<p>This API specifies the subject of the e-mail message.</p>
<p class="subhead2"><a id="sthref367"></a>Syntax</p>
<pre>
FUNCTION SetSubject (subject VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="SetSubject parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t18">Where</th>
<th class="cellalignment716" id="r1c2-t18">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t18" headers="r1c1-t18"><code>subject</code></td>
<td class="cellalignment710" headers="r2c1-t18 r1c2-t18">the subject of the e-mail message</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref368"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref369"></a><a id="sthref370"></a>SetBody</p>
<p>This API inserts the body text of the e-mail message.</p>
<p class="subhead2"><a id="sthref371"></a>Syntax</p>
<pre>
FUNCTION SetBody (messagetext VARCHAR2) RETURN BINARY_INTEGER;
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="SetBody parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t19">Where</th>
<th class="cellalignment716" id="r1c2-t19">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t19" headers="r1c1-t19"><code>messagetext</code></td>
<td class="cellalignment710" headers="r2c1-t19 r1c2-t19">the body of the e-mail message</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref372"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref373"></a><a id="sthref374"></a>SendMessage</p>
<p>This API sends the e-mail message to the specified recipients.</p>
<p class="subhead2"><a id="sthref375"></a>Syntax</p>
<pre>
FUNCTION SendMessage RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref376"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
<p class="subhead2"><a id="sthref377"></a><a id="sthref378"></a>EndMAPISession</p>
<p>This API exits the MAPI session.</p>
<p class="subhead2"><a id="sthref379"></a>Syntax</p>
<pre>
FUNCTION EndMAPISession RETURN BINARY_INTEGER;
</pre>
<p class="subhead2"><a id="sthref380"></a>Remarks</p>
<p>This function returns <code>0</code> when successful, or a nonzero value for <code>HRESULT</code> when an error occurs.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment703">
<tr>
<td class="cellalignment710">
<table class="cellalignment708">
<tr>
<td class="cellalignment707"><a href="ch3core.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment707"><a href="ch5java.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment712">
<table class="cellalignment706">
<tr>
<td class="cellalignment707"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment707"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment707"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment707"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment707"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment707"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
