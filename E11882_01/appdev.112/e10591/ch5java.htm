<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Oracle COM Automation Java Demos</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1" />
<meta name="dcterms.created" content="2011-01-21T18:9:26Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="COM Automation Feature Developer's Guide" />
<meta name="dcterms.identifier" content="E10591-05" />
<meta name="dcterms.isVersionOf" content="COMDG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="ch4plsql.htm" title="Previous" type="text/html" />
<link rel="Next" href="appendix.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10591.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">10/13</span> <!-- End Header --><a id="g1008186"></a>
<h1 class="chapter"><span class="secnum">5</span> <a id="COMDG006"></a>Oracle COM Automation Java Demos</h1>
<p>This chapter describes how to use the demonstration program designed for Oracle COM Automation Feature for Java.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1006183">Overview of Oracle COM Automation Feature for Java Demos</a></p>
</li>
<li>
<p><a href="#CHDIBJBG">Microsoft Word Java Demo</a></p>
</li>
</ul>
<a id="i1006183"></a>
<div class="sect1">
<h2 class="sect1">Overview of Oracle COM Automation Feature for Java Demos <a id="sthref381"></a><a id="sthref382"></a></h2>
<p>Oracle COM Automation Feature for Java includes an example that demonstrates how to use the feature to build solutions. The demo provides base functionality and can serve as a foundation on which to build more customized, complex applications that use COM Automation. This demo is based on the human resources schema available with the <a id="sthref383"></a>sample schema.</p>
<p>The demo exposes a core set of APIs that enable you to do simple operations using Oracle COM Automation Feature. Each COM Automation server, such as Word and Excel, provides more advanced capabilities than what is offered through the demo APIs. To take advantage of these advanced features, you must design and code your own Java classes.</p>
<p>In this release, COM Automation has provided the <a href="#CHDIBJBG">Microsoft Word Java Demo</a>, which exchanges data between an Oracle Database instance and Microsoft Word.</p>
</div>
<!-- class="sect1" -->
<a id="CHDIBJBG"></a>
<div class="sect1">
<h2 class="sect1">Microsoft Word Java Demo<a id="sthref384"></a><a id="sthref385"></a></h2>
<p>The following sections describe how to install the Microsoft Word Java demo and the APIs that it exposes. This demo is provided as an example of the types of solutions that can be built with Oracle Database and Microsoft Word.</p>
<p>The demo creates a Microsoft Word document containing the names of employees in the database.</p>
<p>The Microsoft Word Java demo is installed in the <code><span class="codeinlineitalic">ORACLE_BASE\ORACLE_HOME</span></code><code>\com\java\demos</code> directory and provides the following:</p>
<ul>
<li>
<p><code><a id="sthref386"></a>TestWORD.java</code>, the Java source for the demo. In addition to the collection of APIs, it includes the demo program <code>test</code>.</p>
</li>
<li>
<p><code><a id="sthref387"></a>TestWORD.class</code>, the Java class for the demo.</p>
</li>
<li>
<p><code><a id="sthref388"></a>TestWORD.sql</code>, the script that creates the call specification for the demo.</p>
</li>
</ul>
<div class="sect2"><a id="sthref389"></a>
<h3 class="sect2">Installing the Microsoft Word Java Demo<a id="sthref390"></a></h3>
<p>Microsoft Word must be installed on the local computer before you install this demo.</p>
<p>To install the demo:</p>
<ol>
<li>
<p>Run the <code>loadjava</code> tool from the command line:</p>
<pre>
<a id="sthref391"></a>loadjava -force -resolve -user hr <span class="italic">ORACLE_BASE\ORACLE_HOME\</span>com\java\demos\TestWORD.class
Password: <span class="italic">password</span>
</pre></li>
<li>
<p>Start SQL*Plus.</p>
<pre>
C:\&gt; sqlplus /NOLOG
</pre></li>
<li>
<p>Connect to the Oracle Database instance as the user who will use the Microsoft Word demo. For example:</p>
<pre>
SQL&gt; connect hr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Run the <code>TestWORD.sql</code> script to create the call specification<a id="sthref392"></a><a id="sthref393"></a>:</p>
<pre>
SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\com\java\demos\TestWORD.sql
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink JJDEV10060" href="../../java.112/e10588/cheleven.htm#JJDEV10060"><span class="italic">Oracle Database Java Developer's Guide</span></a> for further information about the <code>loadjava</code> tool</div>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref394"></a>
<h3 class="sect2">Using the Microsoft Word Java Demo<a id="sthref395"></a></h3>
<p>To use the Word demo:</p>
<ol>
<li>
<p>Set <code><a id="sthref396"></a>SERVEROUTPUT</code> on at the SQL*Plus prompt:</p>
<pre>
SQL&gt; SET SERVEROUTPUT ON
</pre></li>
<li>
<p>Call <code>TestWORD()</code> at the SQL*Plus prompt:</p>
<pre>
SQL&gt; CALL TestWORD();
</pre>
<p>This creates a Microsoft Word document (<code>worddemoj.doc</code>) in the <code>C:\</code> directory. The document contains data from the <code>EMPLOYEES</code> and <code>JOBS</code> tables. These tables are available in the human resources schema in the sample schema.</p>
</li>
<li>
<p>Open <code><a id="sthref397"></a>worddemoj.doc</code> to see its contents.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref398"></a>
<h3 class="sect2">Creating a Custom Application</h3>
<p>The public class <a id="sthref399"></a><code>TestWORD</code> API as described in <a href="#i1006272">"Core Functionality"</a> , provides a wrapper around the <code>Word.Basic</code> COM Automation class as well as some sample code that demonstrates how to use the wrapper. This code was written to be run on the Oracle database server.</p>
<p>To create a custom application that uses this wrapper:</p>
<ol>
<li>
<p>Instantiate an object of this class.</p>
</li>
<li>
<p>Create the <code>Word.Basic</code> object by calling the <code>CreateWordObject</code> method.</p>
</li>
<li>
<p>Create a new Microsoft Word document with the <code>FileNew</code> method, or open an existing document with the <code>FileLoad</code> method.</p>
</li>
<li>
<p>Use the <code>FormatFontSize</code>, <code>InsertText</code>, and <code>InsertNewLine</code> methods to add text and formatting to the document.</p>
</li>
<li>
<p>Save the document with the <code>FileSaveAs</code> or the <code>FileSave</code> method.</p>
</li>
<li>
<p>Call the <code>FileClose</code> method when you are finished with the document.</p>
</li>
<li>
<p>Call the <code>DestroyWordObject</code> method when you are finished with the <code>Word.Basic</code> object.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1006272"></a>
<div class="sect2">
<h3 class="sect2">Core Functionality</h3>
<p>The following subsections describe the APIs that the Microsoft Word Java demo exposes. These APIs are primitive and do not expose all the functionalities that Microsoft Word exposes through COM Automation.</p>
<p class="subhead2"><a id="sthref400"></a><a id="sthref401"></a>TestWORD</p>
<p>This API is the constructor. It does nothing.</p>
<p class="subhead2"><a id="sthref402"></a>Syntax</p>
<pre>
public TestWORD()
</pre>
<p class="subhead2"><a id="sthref403"></a><a id="sthref404"></a>CreateWordObject</p>
<p>Creates the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref405"></a>Syntax</p>
<pre>
public void CreateWordObject(java.lang.String servername)
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="CreateWordObject parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t3">Where</th>
<th class="cellalignment716" id="r1c2-t3">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t3" headers="r1c1-t3">servername</td>
<td class="cellalignment710" headers="r2c1-t3 r1c2-t3">the server on which to create the COM object. Specify null or the empty string for the local server.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref406"></a><a id="sthref407"></a>DestroyWordObject</p>
<p>This API destroys the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref408"></a>Syntax</p>
<pre>
public void DestroyWordObject()
</pre>
<p class="subhead2"><a id="sthref409"></a><a id="sthref410"></a>FileNew</p>
<p>This API creates a new Microsoft WORD document.</p>
<p class="subhead2"><a id="sthref411"></a>Syntax</p>
<pre>
public void FileNew()
</pre>
<p class="subhead2"><a id="sthref412"></a>Remarks</p>
<p>This API is a wrapper for the <code>FileNewDefault</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref413"></a><a id="sthref414"></a>FileLoad</p>
<p>This API loads an existing Microsoft WORD document.</p>
<p class="subhead2"><a id="sthref415"></a>Syntax</p>
<pre>
public void FileLoad(java.lang.String filename)
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FileLoad parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t4">Where</th>
<th class="cellalignment716" id="r1c2-t4">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t4" headers="r1c1-t4"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t4 r1c2-t4">the name of the file to load.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref416"></a>Remarks</p>
<p>This API is a wrapper for the <code>FileOpen</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref417"></a><a id="sthref418"></a>FormatFontSize</p>
<p>This API sets the font size.</p>
<p class="subhead2"><a id="sthref419"></a>Syntax</p>
<pre>
public void FormatFontSize(long fontsize)
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FormatFontSize parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t5">Where</th>
<th class="cellalignment716" id="r1c2-t5">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t5" headers="r1c1-t5"><code>fontsize</code></td>
<td class="cellalignment710" headers="r2c1-t5 r1c2-t5">the new font size.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref420"></a>Remarks</p>
<p>This API is a wrapper for the <code>FormatFont</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref421"></a><a id="sthref422"></a>InsertText</p>
<p>This API inserts text into the Microsoft Word document.</p>
<p class="subhead2"><a id="sthref423"></a>Syntax</p>
<pre>
public void InsertText(java.lang.String textstr)
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="InsertText parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t6">Where</th>
<th class="cellalignment716" id="r1c2-t6">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t6" headers="r1c1-t6"><code>textstr</code></td>
<td class="cellalignment710" headers="r2c1-t6 r1c2-t6">the text to insert.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref424"></a>Remarks</p>
<p>This API is a wrapper for the <code>Insert</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref425"></a><a id="sthref426"></a>InsertNewLine</p>
<p>This API inserts a new line into the Microsoft Word document.</p>
<p class="subhead2"><a id="sthref427"></a>Syntax</p>
<pre>
public void InsertNewLine()
</pre>
<p class="subhead2"><a id="sthref428"></a>Remarks</p>
<p>This API is a wrapper for the <code>InsertPara</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref429"></a><a id="sthref430"></a>FileSaveAs</p>
<p>This API saves the Microsoft Word document using a specified name.</p>
<p class="subhead2"><a id="sthref431"></a>Syntax</p>
<pre>
public void FileSaveAs(java.lang.String filename)
</pre>
<div class="inftblinformal">
<table class="cellalignment717" title="FileSaveAs parameter list" summary="rows are parameters. first column is parameter name;second column is description" dir="ltr">
<thead>
<tr class="cellalignment704">
<th class="cellalignment716" id="r1c1-t7">Where</th>
<th class="cellalignment716" id="r1c2-t7">Is</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment704">
<td class="cellalignment710" id="r2c1-t7" headers="r1c1-t7"><code>filename</code></td>
<td class="cellalignment710" headers="r2c1-t7 r1c2-t7">the name of the file.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="sthref432"></a>Remarks</p>
<p>This API is a wrapper for the <code>FileSaveAs</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref433"></a><a id="sthref434"></a>FileSave</p>
<p>This API saves the Microsoft Word document.</p>
<p class="subhead2"><a id="sthref435"></a>Syntax</p>
<pre>
public void FileSave()
</pre>
<p class="subhead2"><a id="sthref436"></a>Remarks</p>
<p>This API is a wrapper for the <code>FileSave</code> COM method of the <code>Word.Basic</code> COM object.</p>
<p class="subhead2"><a id="sthref437"></a><a id="sthref438"></a>FileClose</p>
<p>This API closes the Microsoft Word document, and exits Microsoft Word.</p>
<p class="subhead2"><a id="sthref439"></a>Syntax</p>
<pre>
public void FileClose()
</pre>
<p class="subhead2"><a id="sthref440"></a>Remarks</p>
<p>This API is a wrapper for the <code>FileClose</code> and <code>FileExit</code> COM methods of the <code>Word.Basic</code> COM object.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment703">
<tr>
<td class="cellalignment710">
<table class="cellalignment708">
<tr>
<td class="cellalignment707"><a href="ch4plsql.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment707"><a href="appendix.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment712">
<table class="cellalignment706">
<tr>
<td class="cellalignment707"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment707"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment707"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment707"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment707"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment707"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
