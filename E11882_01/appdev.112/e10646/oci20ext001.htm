<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Cartridge Services &mdash; OCI External Procedures</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023" />
<meta name="dcterms.created" content="2014-07-18T15:18:44Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Call Interface Programmer's Guide" />
<meta name="dcterms.identifier" content="E10646-15" />
<meta name="dcterms.isVersionOf" content="LNOCI" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="oci20ext.htm" title="Previous" type="text/html" />
<link rel="Next" href="oci20ext002.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10646.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">51/79</span> <!-- End Header --><a id="CIHJACCG"></a>
<div id="LNOCI191" class="refsect1">
<h1 class="refsect1">Cartridge Services &mdash; OCI External Procedures</h1>
<p><a href="#CIHJECEF">Table 20-1</a> lists the OCI external procedure functions for C that are described in this section.</p>
<div id="LNOCI17536" class="tblformalwide">
<p class="titleintable"><a id="sthref4559"></a><a id="CIHJECEF"></a>Table 20-1 External Procedures Functions</p>
<table class="cellalignment1011" title="External Procedures Functions" summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1005">
<th class="cellalignment1012" id="r1c1-t2">Function</th>
<th class="cellalignment1012" id="r1c2-t2">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1005">
<td class="cellalignment1013" id="r2c1-t2" headers="r1c1-t2">
<p><a href="#i447084">"OCIExtProcAllocCallMemory()"</a></p>
</td>
<td class="cellalignment1013" headers="r2c1-t2 r1c2-t2">
<p>Allocate memory for the duration of the External Procedure</p>
</td>
</tr>
<tr class="cellalignment1005">
<td class="cellalignment1013" id="r3c1-t2" headers="r1c1-t2">
<p><a href="#i443263">"OCIExtProcGetEnv()"</a></p>
</td>
<td class="cellalignment1013" headers="r3c1-t2 r1c2-t2">
<p>Get the OCI environment, service context, and error handles</p>
</td>
</tr>
<tr class="cellalignment1005">
<td class="cellalignment1013" id="r4c1-t2" headers="r1c1-t2">
<p><a href="#i441555">"OCIExtProcRaiseExcp()"</a></p>
</td>
<td class="cellalignment1013" headers="r4c1-t2 r1c2-t2">
<p>Raise an Exception to PL/SQL</p>
</td>
</tr>
<tr class="cellalignment1005">
<td class="cellalignment1013" id="r5c1-t2" headers="r1c1-t2">
<p><a href="#i441559">"OCIExtProcRaiseExcpWithMsg()"</a></p>
</td>
<td class="cellalignment1013" headers="r5c1-t2 r1c2-t2">
<p>Raise an exception with a message</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" -->
<div id="LNOCI17537" class="refsect2"><a id="i447084"></a>
<h2 class="refsect2">OCIExtProcAllocCallMemory()<a id="sthref4560"></a></h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4561"></a>Purpose</p>
<p>Allocates <span class="italic">N</span> bytes of memory for the duration of the external procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4562"></a>Syntax</p>
<pre>
void  * OCIExtProcAllocCallMemory ( OCIExtProcContext    *with_context,
                                    size_t                amount );
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4563"></a>Parameters</p>
<dl>
<dt>with_context (IN)</dt>
<dd>
<p>The <code>with_context</code> pointer that is passed to the C external procedure.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="oci20ext.htm#i442477">"With_Context Type"</a></div>
</dd>
</dl>
<dl>
<dt>amount (IN)</dt>
<dd>
<p>The number of bytes to allocate.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4564"></a>Comments</p>
<p>This call allocates <code>amount</code> bytes of memory for the duration of the call of the external procedure.</p>
<p>Any memory allocated by this call is freed by PL/SQL upon return from the external procedure. The application must not use any kind of <code>free()</code> function on memory allocated by <code>OCIExtProcAllocCallMemory()</code>. Use this function to allocate memory for function returns.</p>
<p>A zero return value should be treated as an error.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4565"></a>Returns</p>
<p>An untyped (opaque) pointer to the allocated memory.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4566"></a>Example</p>
<div class="example">
<p class="titleinexample"><a id="sthref4567"></a>Example 20-1 Using OCIExtProcAllocCallMemory() to Allocate 1024 Bytes of Memory</p>
<pre>
text *ptr = (text *)OCIExtProcAllocCallMemory(wctx, 1024)
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4568"></a>Related Functions</p>
<p><a href="oci17msc007.htm#i540516">OCIErrorGet()</a>, <a href="oci20ext002.htm#i448629">OCIMemoryAlloc()</a></p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="LNOCI17540" class="refsect2"><a id="i443263"></a>
<h2 class="refsect2">OCIExtProcGetEnv()<a id="sthref4569"></a></h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4570"></a>Purpose</p>
<p>Gets the OCI environment, service context, and error handles.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4571"></a>Syntax</p>
<pre>
sword OCIExtProcGetEnv ( OCIExtProcContext    *with_context, 
                         OCIEnv               **envh, 
                         OCISvcCtx            **svch, 
                         OCIError             **errh );
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4572"></a>Parameters</p>
<dl>
<dt>with_context (IN)</dt>
<dd>
<p>The <code>with_context</code> pointer that is passed to the C external procedure. See <a href="oci20ext.htm#i442477">"With_Context Type"</a>.</p>
</dd>
<dt>envh (OUT)</dt>
<dd>
<p>Pointer to a variable to store the OCI environment handle.</p>
</dd>
<dt>svch (OUT)</dt>
<dd>
<p>Pointer to a variable to store the OCI service handle.</p>
</dd>
<dt>errh (OUT)</dt>
<dd>
<p>Pointer to a variable to store the OCI error handle.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4573"></a>Comments</p>
<p>The primary purpose of this function is to allow OCI callbacks to use the database in the same transaction. The OCI handles obtained by this function should be used in OCI callbacks to the database. If these handles are obtained through standard OCI calls, then these handles use a new connection to the database and cannot be used for callbacks in the same transaction. In one external procedure you can use either callbacks or a new connection, but not both.</p>
<p>Example of a call:</p>
<pre>
OCIEnv    *envh;
OCISvcCtx *svch;
OCIError  *errh;
...
OCIExtProcGetEnv(ctx,&amp;envh,&amp;svch,&amp;errh);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4574"></a>Returns</p>
<p>This function returns <code>OCI_SUCCESS</code> if the call succeeds; otherwise, it returns <code>OCI_ERROR</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4575"></a>Related Functions</p>
<p><a href="oci16rel001.htm#i556149">OCIEnvCreate()</a>, <a href="oci16rel002.htm#i493114">OCIArrayDescriptorAlloc()</a>, <a href="oci16rel002.htm#i540847">OCIHandleAlloc()</a></p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="LNOCI17538" class="refsect2"><a id="i441555"></a>
<h2 class="refsect2">OCIExtProcRaiseExcp()<a id="sthref4576"></a></h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4577"></a>Purpose</p>
<p>Raises an Exception to PL/SQL.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4578"></a>Syntax</p>
<pre>
size_t OCIExtProcRaiseExcp ( OCIExtProcContext    *with_context, 
                             int                   errnum );
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4579"></a>Parameters</p>
<dl>
<dt>with_context (IN)</dt>
<dd>
<p>The <code>with_context</code> pointer that is passed to the C external procedure.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="oci20ext.htm#i442477">"With_Context Type"</a></div>
</dd>
</dl>
<dl>
<dt>errnum (IN)</dt>
<dd>
<p>Oracle Database error number to signal to PL/SQL. The <code>errnum</code> value must be a positive number and in the range 1 to 32767.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4580"></a>Comments</p>
<p>Calling this function signals an exception to PL/SQL. After a successful return from this function, the external procedure must start its exit handling and return to PL/SQL. Once an exception is signaled to PL/SQL, IN/OUT and OUT arguments, if any, are not processed at all.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4581"></a>Returns</p>
<p>This function returns <code>OCIEXTPROC_SUCCESS</code> if the call succeeds. It returns <code>OCIEXTPROC_ERROR</code> if the call fails.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4582"></a>Related Functions</p>
<p><a href="#i441559">OCIExtProcRaiseExcpWithMsg()</a></p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="LNOCI17539" class="refsect2"><a id="i441559"></a>
<h2 class="refsect2">OCIExtProcRaiseExcpWithMsg()<a id="sthref4583"></a></h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4584"></a>Purpose</p>
<p>Raises an exception with a message.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4585"></a>Syntax</p>
<pre>
size_t OCIExtProcRaiseExcpWithMsg ( OCIExtProcContext   *with_context,
                                    int                  errnum, 
                                    char                 *errmsg, 
                                    size_t               msglen );
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4586"></a>Parameters</p>
<dl>
<dt>with_context (IN)</dt>
<dd>
<p>The <code>with_context</code> pointer that is passed to the C external procedure.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="oci20ext.htm#i442477">"With_Context Type"</a></div>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<dl>
<dt>errnum (IN)</dt>
<dd>
<p>Oracle Database error number to signal to PL/SQL. The value of <code>errnum</code> must be a positive number and in the range 1 to 32767</p>
</dd>
<dt>errmsg (IN)</dt>
<dd>
<p>The error message associated with <code>errnum</code>.</p>
</dd>
<dt>msglen (IN)</dt>
<dd>
<p>The length of the error message. Pass zero if <code>errmsg</code> is a <code>NULL</code>-terminated string.</p>
</dd>
</dl>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4587"></a>Comments</p>
<p>This call raises an exception to PL/SQL. In addition, it substitutes the following error message string within the standard Oracle Database error message string.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The description of <a href="#i441555">OCIExtProcRaiseExcp()</a></div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4588"></a>Returns</p>
<p>This function returns <code>OCIEXTPROC_SUCCESS</code> if the call succeeds. It returns <code>OCIEXTPROC_ERROR</code> if the call fails.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4589"></a>Related Functions</p>
<p><a href="#i441555">OCIExtProcRaiseExcp()</a></p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1004">
<tr>
<td class="cellalignment1013">
<table class="cellalignment1009">
<tr>
<td class="cellalignment1008"><a href="oci20ext.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1008"><a href="oci20ext002.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1015">
<table class="cellalignment1007">
<tr>
<td class="cellalignment1008"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1008"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1008"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1008"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1008"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1008"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
