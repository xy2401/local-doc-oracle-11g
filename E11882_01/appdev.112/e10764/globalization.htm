<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Globalization and Unicode Support</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 711" />
<meta name="dcterms.created" content="2013-02-06T9:20:49Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="C++ Call Interface Programmer's Guide," />
<meta name="dcterms.identifier" content="E10764-04" />
<meta name="dcterms.isVersionOf" content="LNCPP" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="ottutility.htm" title="Previous" type="text/html" />
<link rel="Next" href="queuing.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10764.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/54</span> <!-- End Header --><a id="BABEJHEF"></a><a id="LNCPP009"></a><a id="i1000999"></a>
<h1 class="chapter"><span class="secnum">9</span> Globalization and Unicode Support</h1>
<p>This chapter describes OCCI support for multibyte and Unicode charactersets.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1006800">Overview of Globalization and Unicode Support</a></p>
</li>
<li>
<p><a href="#i1005200">Specifying Charactersets</a></p>
</li>
<li>
<p><a href="#CJHDBBAJ">Data Types for Globalization and Unicode Support</a></p>
</li>
<li>
<p><a href="#CJHDHHAH">Objects and OTT Support</a></p>
</li>
</ul>
<a id="i1006800"></a><a id="LNCPP20412"></a>
<div class="sect1">
<h2 class="sect1">Overview of Globalization and Unicode Support</h2>
<p>OCCI now enables application development in all Oracle supported multibyte and Unicode charactersets. The <code>UTF16</code> encoding of Unicode is fully supported. Application programs can specify their charactersets when the OCCI Environment is created. OCCI interfaces that take character string arguments (such as SQL statements, usernames, error messages, object names, and so on) have been extended to handle data in any characterset. Character data from relational tables or objects can be in any characterset. OCCI can be used to develop multi-lingual, global and Unicode applications.</p>
</div>
<!-- class="sect1" -->
<a id="i1005200"></a><a id="LNCPP20413"></a>
<div class="sect1">
<h2 class="sect1">Specifying Charactersets</h2>
<p>OCCI applications must specify the client characterset and client national characterset when initializing the OCCI Environment. The client characterset specifies the characterset for all SQL statements, object/user names, error messages, and data of all <code>CHAR</code> data type (<code>CHAR</code>, <code>VARCHAR2</code>, <code>LONG</code>) columns/attributes. The client national characterset specifies the characterset for data of all <code>NCHAR</code> data type (<code>NCHAR</code>, <code>NVARCHAR2</code>) columns/attributes.</p>
<p>A new <code>createEnvironment()</code> interface that takes the client characterset and client national characterset is now provided. This allows OCCI applications to set characterset information dynamically, independent of the <code>NLS_LANG</code> and <code>NLS_CHAR</code> initialization parameter.</p>
<p>Note that if an application specifies <code>OCCIUTF16</code> as the client characterset (first argument), then the application should use only the <code>UTF16</code> interfaces of OCCI. These interfaces take <code>UString</code> argument types.</p>
<p>The charactersets in the OCCI Environment are client-side only. They indicate the charactersets the OCCI application uses to interact with Oracle. The database characterset and database national characterset are specified when the database is created. Oracle converts all data from the client characterset/national characterset to the database characterset/national characterset before the server processes the data.</p>
<div class="example">
<p class="titleinexample"><a id="LNCPP20414"></a><a id="sthref587"></a>Example 9-1 How to Use Globalization and Unicode Support</p>
<pre>
Environment *env = Environment:createEnvironment("JA16SJIS","UTF8");
</pre>
<p>This statement creates an OCCI <code>Environment</code> with <code>JA16SJIS</code> as the client characterset and <code>UTF8</code> as the client national characterset.</p>
<p>Any valid Oracle characterset name (except <code>AL16UTF16</code>) can be passed to <code>createEnvironment()</code>. An OCCI specific string <code>OCCIUTF16</code> (in uppercase) can be passed to specify <code>UTF16</code> as the characterset.</p>
<pre>
Environment *env = Environment::createEnvironment("OCCIUTF16","OCCIUTF16");
Environment *env = Environment::createEnvironment("US7ASCII", "OCCIUTF16");
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" -->
<a id="CJHDBBAJ"></a><a id="LNCPP20415"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Data Types for Globalization and Unicode Support</h2>
<p>The data types used for supporting globalization and use of unicode include <a href="#BGBFAABA">UString Data Type</a>, <a href="#CHDFGBJB">Multibyte and UTF16 data</a>, and <a href="#CHDEEDEH">CLOB and NCLOB Data Types</a>.</p>
<a id="BGBFAABA"></a><a id="LNCPP20416"></a>
<div class="sect2">
<h3 class="sect2">UString Data Type</h3>
<p><code>UString</code> is a data type that enables applications and the OCCI library to pass and receive Unicode data in <code>UTF-16</code> encoding. <code>UString</code> is templated from the C++ <code>STL basic_string</code> with Oracle's <code>utext</code> data type.</p>
<pre>
typedef basic_string&lt;utext&gt; UString;
</pre>
<p>Oracle's <code>utext</code> data type is a 2 byte short data type and represents Unicode characters in the UTF-16 encoding. A Unicode character's codepoint can be represented in 1 <code>utext</code> or 2 <code>utext</code>s (2 or 4 bytes). Characters from European and most Asian scripts are represented in a single utext. Supplementary characters defined in the Unicode 3.1 standard are represented with 2 <code>utext</code> elements.</p>
<p>In Microsoft Windows platforms, <code>UString</code> is equivalent to the C++ standard <code>wstring</code> data type. This is because the <code>wchar_t</code> data type is type defined to a 2 byte <code>short</code> in these platforms, which is same as Oracle's <code>utext</code>, allowing applications to use a <code>wstring</code> type variable where a <code>UString</code> would be normally required. Consequently, applications can also pass wide-character string literals, created by prefixing the literal with the letter 'L', to OCCI Unicode APIs.</p>
<div class="example">
<p class="titleinexample"><a id="LNCPP20417"></a><a id="sthref588"></a>Example 9-2 Using wstring Data Type</p>
<pre>
//bind Unicode data using wstring data type
//binding the Euro symbol, UTF16 codepoint 0x20AC
wchar_t eurochars[] = {0x20AC,0x00};
wstring eurostr(eurochars);
stmt-&gt;setUString(1,eurostr);
 
//Call the Unicode version of createConnection by
//passing widechar literals
Connection *conn = Connection(L"HR",L"<span class="italic">password</span>",L"");
</pre></div>
<!-- class="example" -->
<p>OCCI applications should use the <code>UString</code> data type for data in <code>UTF16</code> characterset</p>
</div>
<!-- class="sect2" -->
<a id="CHDFGBJB"></a><a id="LNCPP20418"></a>
<div class="sect2">
<h3 class="sect2">Multibyte and UTF16 data</h3>
<p>For data in multibyte charactersets like <code>JA16SJIS</code> and <code>UTF8</code>, applications should use the C++ <code>string</code> type. The existing OCCI APIs that take <code>string</code> arguments can handle data in any multibyte characterset. Due to the use of <code>string</code> type, OCCI supports only byte length semantics for multibyte characterset <code>strings</code>.</p>
<div class="example">
<p class="titleinexample"><a id="LNCPP20419"></a><a id="sthref589"></a>Example 9-3 Binding UTF8 Data Using the string Data Type</p>
<pre>
//bind UTF8 data
//binding the Euro symbol, UTF8 codepoint : 0xE282AC
char eurochars[] = {0xE2,0x82,0xAC,0x00};
string eurostr(eurochars)
stmt-&gt;setString(1,eurostr);//use the string interface
</pre>
<p>For Unicode data in the <code>UTF16</code> characterset, the OCCI specific data type: <code>UString</code> and the <code>OCCI UTF16</code> interfaces must be used.</p>
</div>
<!-- class="example" -->
<div class="example">
<p class="titleinexample"><a id="LNCPP20420"></a><a id="sthref590"></a>Example 9-4 Binding UTF16 Data Using the UString Data Type</p>
<pre>
//bind Unicode data using UString data type
//binding the Euro symbol, UTF16 codepoint 0x20AC
utext eurochars[] = {0x20AC,0x00};
UString eurostr(eurochars);
stmt-&gt;setUString(1,eurostr);//use the UString interface
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHDEEDEH"></a><a id="LNCPP20421"></a>
<div class="sect2">
<h3 class="sect2">CLOB and NCLOB Data Types</h3>
<p>Oracle provides the <code>CLOB</code> and <code>NCLOB</code> data types for storing and processing large amounts of character data. <code>CLOB</code>s represent data in the database characterset and <code>NCLOB</code>s represent data in the database national characterset. <code>CLOB</code>s and <code>NCLOB</code>s can be used as column types in relational tables and as attributes in object types.</p>
<p>The OCCI <code>Clob</code> class is used to work with both <code>CLOB</code> and <code>NCLOB</code> data types. If the database type is <code>NCLOB</code>, then the <code>Clob</code> set <code>CharSetForm()</code> method should be called with <code>OCCI_SQLCS_NCHAR</code> before reading/writing from the <code>LOB</code>.</p>
<p>The OCCI <code>Clob</code> class has support for multibyte and UTF16 charactersets. By default, the <code>Clob</code> interfaces assume the data is encoded in the client-side characterset (for both <code>CLOB</code>s and <code>NCLOB</code>s). To specify a different characterset or to specify the client-side national characterset for a <code>NCLOB</code>, call the <code>setCharSetId()</code> or <code>setCharSetIdUString()</code> methods with the appropriate characterset. The OCCI specific string 'OCCIUTF16' can be passed to indicate UTF16 as the characterset.</p>
<div class="example">
<p class="titleinexample"><a id="LNCPP20422"></a><a id="sthref591"></a>Example 9-5 Using CLOB and NCLOB Data Types</p>
<pre>
//client characterset - ZHT16BIG5, national characterset - UTF16
Environment *env = Environment::createEnvironment("ZHT16BIG5","OCCIUTF16");...
Clob nclobvar;
//for NCLOBs, must call setCharSetForm method. 
nclobvar.setCharSetForm(OCCI_SQLCS_NCHAR);...
//if reading/writing data in UTF16 for this NCLOB, still must 
//explicitly call setCharSetId
nclobvar.setCharSetId("OCCIUTF16")
 
</pre></div>
<!-- class="example" -->
<p>To read or write data in multibyte charactersets, use the existing read and write interfaces that take a char buffer. New overloaded interfaces that take utext buffers for <code>UTF16</code> data have been added to the <a href="reference009.htm#i1118691">Clob Class</a> as <code>read()</code>, <code>write()</code> and <code>writeChunk()</code> methods. The arguments and return values for these methods are either bytes or characters, depending on the characterset of the LOB.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CJHDHHAH"></a><a id="LNCPP20423"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Objects and OTT Support</h2>
<p>Multibyte and <code>UTF16</code> charactersets are supported for handling character data in object attributes. All <code>CHAR</code> data type (<code>CHAR</code> or <code>VARCHAR2</code>) attributes hold data in the client-side characterset, while all <code>NCHAR</code> data type (<code>NCHAR</code> or <code>NVARCHAR2</code>) attributes hold data in the client-side national characterset. A member variable of <code>UString</code> data type represents an attribute in <code>UTF16</code> characterset.</p>
<div align="center">
<div class="inftblinformal"><br />
<table class="cellalignment1079">
<tbody>
<tr class="cellalignment1067">
<td class="cellalignment1075">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="reference.htm#CIAJIDCF">Chapter 13, "OCCI Application Programming Interface"</a>: two new versions of <a href="reference023.htm#i1072355">operator new()</a> that have been added to the <a href="reference023.htm#i1039640">PObject Class</a> for object support</p>
</li>
<li>
<p><a href="ottutility.htm#CHDBCDBH">Chapter 8, "Object Type Translator Utility"</a>: a new <a href="ottutility.htm#BABHGEHE">UNICODE</a> parameter that has been added for OTT utility support.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1066">
<tr>
<td class="cellalignment1075">
<table class="cellalignment1071">
<tr>
<td class="cellalignment1070"><a href="ottutility.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1070"><a href="queuing.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1078">
<table class="cellalignment1069">
<tr>
<td class="cellalignment1070"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1070"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1070"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1070"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1070"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1070"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
