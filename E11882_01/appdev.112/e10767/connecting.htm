<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Building a Simple .NET Application Using ODP.NET</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 005" />
<meta name="dcterms.created" content="2009-07-23T17:43:54Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + .NET Developer's Guide" />
<meta name="dcterms.identifier" content="E10767-01" />
<meta name="dcterms.isVersionOf" content="TDPNG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="installation.htm" title="Previous" type="text/html" />
<link rel="Next" href="building_odp.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10767.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">6/15</span> <!-- End Header --><a id="CEGFHEDI"></a>
<h1 class="chapter"><span class="secnum">3</span> <a id="TDPNG30000"></a>Building a Simple .NET Application Using ODP.NET</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#CEGCFHIC">Creating a New Project</a></p>
</li>
<li>
<p><a href="#BCGIIJEA">Adding a Reference</a></p>
</li>
<li>
<p><a href="#BCGGGBJJ">Adding Namespace Directives</a></p>
</li>
<li>
<p><a href="#BCGCAEFJ">Designing the User Interface</a></p>
</li>
<li>
<p><a href="#CEGEBJFD">Writing the Connection Code</a></p>
</li>
<li>
<p><a href="#BCGJDCFF">Compiling and Running the Application</a></p>
</li>
<li>
<p><a href="#CEGECCGI">Error Handling</a></p>
</li>
</ul>
<a id="CEGCFHIC"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30010"></a>Creating a New Project<a id="sthref110"></a><a id="sthref111"></a><a id="sthref112"></a><a id="sthref113"></a><a id="sthref114"></a><a id="sthref115"></a><a id="sthref116"></a><a id="sthref117"></a><a id="sthref118"></a></h2>
<p>Visual Studio groups all development code that you create into containers known as projects. Simpler projects often contain only one file. In this section, you will learn how to create a new development project.</p>
<p>The application you build in this chapter serves as a starting point for work in subsequent chapters, so it is important to follow the order of this guide.</p>
<p><span class="bold">NOTE:</span> When necessary, instructions specify <span class="bold">Visual</span> <span class="bold">C#</span> or <span class="bold">Visual</span> <span class="bold">Basic</span>.</p>
<p class="subhead2"><a id="sthref119"></a>To start a new project:</p>
<ol>
<li>
<p>Start Visual Studio.</p>
<p>Open the <span class="bold">Start</span> menu, select <span class="bold">All Programs</span>, and then select <span class="bold">Microsoft Visual Studio 2008</span>.</p>
<img width="862" height="651" src="img/connect00.gif" alt="Description of connect00.gif follows" title="Description of connect00.gif follows" /><br />
<a id="sthref120" href="img_text/connect00.htm">Description of the illustration connect00.gif</a><br />
<br />
<p>The Microsoft Visual Studio IDE environment appears.</p>
</li>
<li>
<p><a id="BCGIDHCG"></a><a id="sthref121"></a><a id="sthref122"></a>In the Start Page, under the Recent Projects heading, click <span class="bold">Create: Project</span>.</p>
<p>Alternatively, from the <span class="bold">File</span> menu, select <span class="bold">New</span>, and then select <span class="bold">Project</span>.</p>
<p>A <span class="bold">New Project</span> dialog box appears.</p>
</li>
<li>
<p>In Project Types, select the type of project you are creating:</p>
<p><span class="bold">Visual C#:</span></p>
<p>Visual C#: Windows</p>
<p><span class="bold">Visual Basic:</span></p>
<p>Other Languages: Visual Basic: Windows</p>
</li>
<li>
<p>In Templates, select <span class="bold">Windows Forms Application</span>.</p>
</li>
<li>
<p>In the Name field, enter the appropriate name.</p>
<p><span class="bold">Visual C#:</span></p>
<p>HR_Connect_CS</p>
<p><span class="bold">Visual Basic:</span></p>
<p>HR_Connect_VB</p>
<p>The abbreviation <code>CS</code> indicates C# projects and VB indicates Visual Basic projects.</p>
</li>
<li>
<p>In Location, enter the directory where you want to save the files.</p>
<p>For this guide, enter this directory <code>C:\HR_Projects</code>.</p>
</li>
<li>
<p>In Solution Name, the appropriate name, HR_Connect_CS or HR_Connect_VB should appear.</p>
<p>A solution can contain several projects; when it contains only one project, you can use the same name for both.</p>
</li>
<li>
<p>Check <span class="bold">Create directory for solution</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li><a id="BCGDCACE"></a> <img width="587" height="422" src="img/connect01.gif" alt="Description of connect01.gif follows" title="Description of connect01.gif follows" /><br />
<a id="sthref123" href="img_text/connect01.htm">Description of the illustration connect01.gif</a><br />
<br />
<p>The project is created.</p>
<p>The main window now displays a new title, either HR_Connect_CS - Microsoft Visual Studio or HR_Connect_CS - Microsoft Visual Studio, depending on the language, and contains Form1 shown below.</p>
<p><a id="sthref124"></a><a id="sthref125"></a><a id="sthref126"></a><a id="sthref127"></a><a id="sthref128"></a><a id="sthref129"></a><a id="sthref130"></a>It is important to remember that many projects automatically name the first form Form1. This is the name of the form control. Do not confuse this with the actual name given to the code file, which is typically <code>Form1.cs</code> or <code>Form1.vb</code>.</p>
<p>Both Form1 and <code>Form</code><code><span class="codeinlineitalic">1.xx</span></code> can be renamed. For the purposes of this guide, we will rename <code>Form</code><code><span class="codeinlineitalic">1.xx</span></code> several times.</p>
<img width="369" height="380" src="img/connect2a.gif" alt="Description of connect2a.gif follows" title="Description of connect2a.gif follows" /><br />
<a id="sthref131" href="img_text/connect2a.htm">Description of the illustration connect2a.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BCGIIJEA"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30020"></a>Adding a Reference<a id="sthref132"></a><a id="sthref133"></a><a id="sthref134"></a><a id="sthref135"></a><a id="sthref136"></a></h2>
<p>This section shows you how to add a reference to the <code>Oracle.DataAccess.dll</code> file, which contains the data provider, Oracle Data Provider for .NET.</p>
<p class="subhead2"><a id="sthref137"></a>To add a reference:</p>
<ol>
<li>
<p><a id="BCGDICIH"></a>From the <span class="bold">Project</span> menu, select <span class="bold">Add Reference</span>.</p>
<img width="232" height="336" src="img/reference01.gif" alt="Description of reference01.gif follows" title="Description of reference01.gif follows" /><br />
<a id="sthref138" href="img_text/reference01.htm">Description of the illustration reference01.gif</a><br />
<br />
<p>The Add Reference windows appears.</p>
</li>
<li>
<p><a id="BCGJDCHJ"></a>In the Add Reference window, under the .NET tab, select <span class="bold">Oracle.DataAccess</span>. Click <span class="bold">OK</span>.</p>
<img width="464" height="390" src="img/reference02.gif" alt="Description of reference02.gif follows" title="Description of reference02.gif follows" /><br />
<a id="sthref139" href="img_text/reference02.htm">Description of the illustration reference02.gif</a><br />
<br />
<p>Note that the new reference appears in the Solution Explorer.</p>
<img width="235" height="318" src="img/reference03.gif" alt="Description of reference03.gif follows" title="Description of reference03.gif follows" /><br />
<a id="sthref140" href="img_text/reference03.htm">Description of the illustration reference03.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BCGGGBJJ"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30030"></a>Adding Namespace Directives<a id="sthref141"></a><a id="sthref142"></a><a id="sthref143"></a><a id="sthref144"></a><a id="sthref145"></a><a id="sthref146"></a><a id="sthref147"></a><a id="sthref148"></a><a id="sthref149"></a></h2>
<p>You can add Oracle namespace directives that allow you to indicate an assembly's namespaces within the module. To do this, add C# <code>using</code> statements or Visual Basic <code>Imports</code> statements, at or near the top of a code file.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Adding a reference makes the namespace available within the application. Adding a namespace directive within the application code makes the namespace more visible and allows for additional scoping.</div>
<p class="subhead2"><a id="sthref150"></a>To add Oracle namespace directives:</p>
<ol>
<li>
<p><a id="BCGDGFJG"></a>With Form1 active, from the <span class="bold">View</span> menu select <span class="bold">Code</span>.</p>
<p>Alternatively, you can use the <span class="bold">F7</span> keyboard shortcut.</p>
<img width="168" height="139" src="img/connect04.gif" alt="Description of connect04.gif follows" title="Description of connect04.gif follows" /><br />
<a id="sthref151" href="img_text/connect04.htm">Description of the illustration connect04.gif</a><br />
<br /></li>
<li>
<p><a id="BCGCCCFC"></a>Add the following statements to the list of declarations depending on the language you are using.</p>
<ul>
<li>
<p><span class="bold">Visual C#</span>:</p>
<p>Add with other <code>using</code> statements, before the namespace.</p>
<pre>
<a id="BCGGAIFA"></a>
using Oracle.DataAccess.Client; 
using Oracle.DataAccess.Types;
</pre>
<img width="364" height="260" src="img/connect05.gif" alt="Description of connect05.gif follows" title="Description of connect05.gif follows" /><br />
<a id="sthref152" href="img_text/connect05.htm">Description of the illustration connect05.gif</a><br />
<br /></li>
<li>
<p><span class="bold">Visual Basic</span>:.</p>
<p>Add to the top of the file, in the declarations section.</p>
<pre>
<a id="BCGIHDEG"></a>
Imports Oracle.DataAccess.Client 
Imports Oracle.DataAccess.Types
</pre>
<img width="362" height="198" src="img/connect06.gif" alt="Description of connect06.gif follows" title="Description of connect06.gif follows" /><br />
<a id="sthref153" href="img_text/connect06.htm">Description of the illustration connect06.gif</a><br />
<br /></li>
</ul>
</li>
<li>
<p>Save the changes by selecting <span class="bold">Save</span> from the <span class="bold">File</span> menu, or using the <span class="bold">Ctrl+S</span> keyboard shortcut.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BCGCAEFJ"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30040"></a>Designing the User Interface<a id="sthref154"></a><a id="sthref155"></a><a id="sthref156"></a><a id="sthref157"></a><a id="sthref158"></a><a id="sthref159"></a><a id="sthref160"></a><a id="sthref161"></a><a id="sthref162"></a><a id="sthref163"></a><a id="sthref164"></a><a id="sthref165"></a><a id="sthref166"></a><a id="sthref167"></a><a id="sthref168"></a><a id="sthref169"></a><a id="sthref170"></a><a id="sthref171"></a><a id="sthref172"></a><a id="sthref173"></a><a id="sthref174"></a><a id="sthref175"></a><a id="sthref176"></a></h2>
<p>You can create a user interface by adding the toolbox controls to the design form. This interface accepts connection information from the user.</p>
<p class="subhead2"><a id="sthref177"></a>To add toolbox controls:</p>
<ol>
<li>
<p>From the <span class="bold">View</span> menu, select <span class="bold">Designer</span>.</p>
<p>This opens Form1, in design view, if it is not already open.</p>
<p>You will toggle between Code and Designer a lot. The keyboard shortcuts are <span class="bold">F7</span> and <span class="bold">shift-</span> <span class="bold">F7</span> respectively.</p>
</li>
<li>
<p>From the <span class="bold">View</span> menu, select <span class="bold">Toolbox</span>.</p>
</li>
<li>
<p>In the Toolbox, expand <span class="bold">Common Controls</span>.</p>
<img width="147" height="297" src="img/control01.gif" alt="Description of control01.gif follows" title="Description of control01.gif follows" /><br />
<a id="sthref178" href="img_text/control01.htm">Description of the illustration control01.gif</a><br />
<br /></li>
<li>
<p><a id="BABEHHCJ"></a>In the Toolbox, select <span class="bold">Label</span>, and drag it onto the Form1.</p>
<img width="372" height="212" src="img/control02.gif" alt="Description of control02.gif follows" title="Description of control02.gif follows" /><br />
<a id="sthref179" href="img_text/control02.htm">Description of the illustration control02.gif</a><br />
<br /></li>
<li>
<p>On Form1, right-click <span class="bold">label1</span>.</p>
<img width="392" height="323" src="img/control03.gif" alt="Description of control03.gif follows" title="Description of control03.gif follows" /><br />
<a id="sthref180" href="img_text/control03.htm">Description of the illustration control03.gif</a><br />
<br /></li>
<li>
<p>From the menu, select <span class="bold">Properties</span>, if the Properties Window is not already visible.</p>
<p>The Properties Window appears.</p>
</li>
<li>
<p><a id="BABJCEJE"></a>In the Properties Window, change the Text property from <span class="bold">label1</span> to <span class="bold">User ID</span>.</p>
<img width="154" height="253" src="img/control04.gif" alt="Description of control04.gif follows" title="Description of control04.gif follows" /><br />
<a id="sthref181" href="img_text/control04.htm">Description of the illustration control04.gif</a><br />
<br /></li>
<li>
<p>Repeat steps <a href="#BABEHHCJ">4</a> through <a href="#BABJCEJE">7</a> twice, placing two more labels on Form 1 and changing their text properties to <span class="bold">Password</span> and <span class="bold">Data Source</span>.</p>
<img width="388" height="84" src="img/control05.gif" alt="Description of control05.gif follows" title="Description of control05.gif follows" /><br />
<a id="sthref182" href="img_text/control05.htm">Description of the illustration control05.gif</a><br />
<br /></li>
<li>
<p><a id="BABFEGHG"></a>In the Toolbox, select <span class="bold">TextBox</span>, and drag it onto the Form1, next to the User ID label.</p>
<img width="393" height="106" src="img/control06.gif" alt="Description of control06.gif follows" title="Description of control06.gif follows" /><br />
<a id="sthref183" href="img_text/control06.htm">Description of the illustration control06.gif</a><br />
<br /></li>
<li>
<p><a id="BABHFDII"></a>In the Properties Window, change the Name property to <span class="bold">userID</span>.</p>
<img width="157" height="194" src="img/control07.gif" alt="Description of control07.gif follows" title="Description of control07.gif follows" /><br />
<a id="sthref184" href="img_text/control07.htm">Description of the illustration control07.gif</a><br />
<br /></li>
<li>
<p>Repeat steps <a href="#BABFEGHG">9</a> and <a href="#BABHFDII">10</a> twice, positioning two more text boxes next to the existing labels, and setting the Name property to <span class="bold">password</span> and <span class="bold">dataSource</span>.</p>
<img width="455" height="111" src="img/control08.gif" alt="Description of control08.gif follows" title="Description of control08.gif follows" /><br />
<a id="sthref185" href="img_text/control08.htm">Description of the illustration control08.gif</a><br />
<br /></li>
<li>
<p>Select the text box next to the Password label. In the Properties Window, scroll to the PasswordChar property and set it to an asterisk (*).</p>
<p>This masks the password during entry.</p>
<img width="143" height="190" src="img/control09.gif" alt="Description of control09.gif follows" title="Description of control09.gif follows" /><br />
<a id="sthref186" href="img_text/control09.htm">Description of the illustration control09.gif</a><br />
<br /></li>
<li>
<p>From the Toolbox, select <span class="bold">Button</span> and drag it onto Form1.</p>
<p>In the Properties Window, change the Text property of the button from <span class="bold">button1</span> to <span class="bold">Connect</span>, and change the Name property to <span class="bold">connect</span>.</p>
<img width="549" height="114" src="img/control10.gif" alt="Description of control10.gif follows" title="Description of control10.gif follows" /><br />
<a id="sthref187" href="img_text/control10.htm">Description of the illustration control10.gif</a><br />
<br /></li>
<li>
<p>Save.</p>
</li>
<li>
<p>Close the Toolbox.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CEGEBJFD"></a>
<div class="sect1">
<h2 class="sect1"><a id="TDPNG30050"></a>Writing the Connection Code<a id="sthref188"></a><a id="sthref189"></a><a id="sthref190"></a><a id="sthref191"></a><a id="sthref192"></a><a id="sthref193"></a><a id="sthref194"></a></h2>
<p>Now we write the code that takes the information provided to the user interface and connects to the database.</p>
<p>To connect to the database, you must create a connection object.</p>
<p class="subhead2"><a id="sthref195"></a>To write code that connects to the database:</p>
<p>These steps enable your application to connect to the database based on data that the user enters into the Form1 control. See <a href="#BCGJDCFF">"Compiling and Running the Application"</a>.</p>
<ol>
<li>
<p>From the <span class="bold">View</span> menu, select <span class="bold">Code</span>.</p>
</li>
<li>
<p><a id="BCGJHICE"></a>Add the code indicated to instantiate a database connection string.</p>
<p><span class="bold">Visual C#:</span> Add the class variable <code>conn</code> to the <code>Form1</code> class right after the <code>public</code> <code>Form1()</code> block with this code.</p>
<pre>
<a id="CEGCAEEJ"></a>
private OracleConnection conn = new OracleConnection();
</pre>
<img width="557" height="430" src="img/connect1.gif" alt="Description of connect1.gif follows" title="Description of connect1.gif follows" /><br />
<a id="sthref196" href="img_text/connect1.htm">Description of the illustration connect1.gif</a><br />
<br />
<p><span class="bold">Visual Basic:</span> Add the <code>conn</code> class variable in the <code>Form1</code> class declaration, using this code.</p>
<pre>
<a id="CEGFJEBB"></a>
Public Class Form1
   <span class="bold">Dim conn As New OracleConnection</span>
</pre>
<img width="753" height="191" src="img/connect2.gif" alt="Description of connect2.gif follows" title="Description of connect2.gif follows" /><br />
<a id="sthref197" href="img_text/connect2.htm">Description of the illustration connect2.gif</a><br />
<br /></li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Change to Designer view by clicking on the <span class="bold">View</span> menu and selecting <span class="bold">Designer</span>.</p>
</li>
<li>
<p>Double-click the <span class="bold">Connect</span> button on Form1 to open the code window to the <code>connect_Click()</code> method.</p>
<p>Insert the code indicated into the <code>connect_Click()</code> method.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CEGFFEHD"></a>
conn.ConnectionString = "User Id=" + userID.Text +
   ";Password=" + password.Text + 
   ";Data Source=" + dataSource.Text + ";";
conn.Open();
           
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CEGCCJFD"></a>
conn.ConnectionString = "User Id=" + userID.Text &amp; _
  ";Password=" + password.Text &amp; _
  ";Data Source=" + dataSource.Text
conn.Open()
</pre>
<p>Note: Before a connection can be opened, it must be built from user input for the <code>User</code> <code>ID</code>, <code>Password</code>, and <code>Data</code> <code>Source</code>. The <code>Open()</code> method makes the actual connection.</p>
</li>
<li>
<p>Set the <code>Enabled</code> attribute of the button to <code>false</code> by inserting the indicated code at the end of the <code>connect_Click()</code> method.</p>
<p>This disables the <code>Connect</code> button, which is a good practice once a connection is successfully made.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="BABCCGAE"></a>
connect.Enabled = false;
</pre>
<img width="577" height="469" src="img/connect_obj1.gif" alt="Description of connect_obj1.gif follows" title="Description of connect_obj1.gif follows" /><br />
<a id="sthref198" href="img_text/connect_obj1.htm">Description of the illustration connect_obj1.gif</a><br />
<br />
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="BABIIHDD"></a>
connect.Enabled = false
</pre>
<img width="795" height="244" src="img/connect_obj2.gif" alt="Description of connect_obj2.gif follows" title="Description of connect_obj2.gif follows" /><br />
<a id="sthref199" href="img_text/connect_obj2.htm">Description of the illustration connect_obj2.gif</a><br />
<br /></li>
</ol>
<p>You have now finished writing an application that can connect to the Oracle database. The following sections show how to use it.</p>
</div>
<!-- class="sect1" -->
<a id="BCGJDCFF"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30060"></a>Compiling and Running the Application</h2>
<p>This section shows how to compile and run the application you created in the previous sections.</p>
<p class="subhead2"><a id="sthref200"></a>To compile and run the application:</p>
<ol>
<li>
<p>From the <span class="bold">Build</span> menu, select <span class="bold">Build Solution</span>.</p>
<img width="213" height="233" src="img/build1.gif" alt="Description of build1.gif follows" title="Description of build1.gif follows" /><br />
<a id="sthref201" href="img_text/build1.htm">Description of the illustration build1.gif</a><br />
<br /></li>
<li>
<p>Ensure that there are no errors reported in the output window, available from the <span class="bold">View</span> menu.</p>
<p>The following graphics shows a typical output result.</p>
<img width="568" height="151" src="img/build2.gif" alt="Description of build2.gif follows" title="Description of build2.gif follows" /><br />
<a id="sthref202" href="img_text/build2.htm">Description of the illustration build2.gif</a><br />
<br /></li>
<li>
<p>If there are any errors indicated, from the <span class="bold">View</span> menu, select <span class="bold">Error List</span> and fix the errors.</p>
</li>
<li>
<p>From the <span class="bold">Debug</span> menu, select <span class="bold">Start Without Debugging</span> to run the application.</p>
<img width="239" height="258" src="img/build3.gif" alt="Description of build3.gif follows" title="Description of build3.gif follows" /><br />
<a id="sthref203" href="img_text/build3.htm">Description of the illustration build3.gif</a><br />
<br /></li>
<li>
<p>In the Form1 application, enter the User ID, Password, and Data Source.</p>
<p>Click <span class="bold">Connect</span>.</p>
<p>This is where the application makes use of the <code>tnsnames.ora</code> file. See <a href="installation.htm#CHDGBJCH">"Configuring a NET Connect Alias"</a>.</p>
<p>Once the connection is opened, the Connect button is disabled. You have succeeded in implementing a connection to an Oracle Database instance.</p>
<img width="547" height="193" src="img/build4.gif" alt="Description of build4.gif follows" title="Description of build4.gif follows" /><br />
<a id="sthref204" href="img_text/build4.htm">Description of the illustration build4.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CEGECCGI"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG30070"></a>Error Handling<a id="sthref205"></a><a id="sthref206"></a><a id="sthref207"></a><a id="sthref208"></a><a id="sthref209"></a><a id="sthref210"></a><a id="sthref211"></a><a id="sthref212"></a><a id="sthref213"></a></h2>
<p>Applications must be able to handle run-time errors gracefully. For example, if you try to log in using an incorrect password, the application you developed so far cannot establish a connection to the database, and exits with the following unhandled exception error, <code>ORA-1017:</code> <code>invalid username/password,</code> <code>logon</code> <code>denied</code>.</p>
<img width="446" height="159" src="img/error1.gif" alt="Description of error1.gif follows" title="Description of error1.gif follows" /><br />
<a id="sthref214" href="img_text/error1.htm">Description of the illustration error1.gif</a><br />
<br />
<p>You must reselect <span class="bold">Start Without Debugging</span> to try this with a different password.</p>
<p>Error handling manages occurrences of conditions that change the normal flow of program execution. Oracle Data Provider for .NET contains three classes for error handling and support:</p>
<ul>
<li>
<p>The <code>OracleError</code> class represents a warning or an error reported by Oracle.</p>
</li>
<li>
<p>An <code>OracleErrorCollection</code> class represents a collection of all errors that are thrown by the Oracle Data Provider for .NET. It is a simple <code>ArrayList</code> that holds a list of <code>OracleError</code>s.</p>
</li>
<li>
<p>The <code>OracleException</code> class represents an exception that is thrown when the Oracle Data Provider for .NET encounters an error. Each <code>OracleException</code> object contains at least one <code>OracleError</code> object in the <code>Error</code> property that describes the error or warning.</p>
</li>
</ul>
<div class="sect2"><a id="sthref215"></a>
<h3 class="sect2">Using Try-Catch-Finally Block Structure<a id="sthref216"></a><a id="sthref217"></a><a id="sthref218"></a><a id="sthref219"></a><a id="sthref220"></a></h3>
<p>.NET languages use Try-Catch-Finally block structure for error handling. With this structure, the Try code is the main code, the goal that the application wants to accomplish. The Catch code catches errors of various types, as shown in the next two section. The Finally block comes last and always executes.</p>
<p>The Finally block frequently contains the <code>Dispose</code> method, which closes and disposes of the connection. Having the <code>Dispose</code> method in the Finally block ensures that the database connection is always closed after the Try-Catch-Finally block completes. Closing database connections after the application no longer requires database access is important for many reasons, especially data security.</p>
<p>Attempting to close a closed database connection does not cause an error. The attempt is irrelevant. Nonetheless, placing <code>Dispose()</code> in the Finally code block guarantees that the connection is closed.</p>
<p>The next section shows how to use Try-Catch-Finally block structure with general errors, and the section after that, with Oracle errors.</p>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref221"></a>
<h3 class="sect2">Handling General Errors<a id="sthref222"></a></h3>
<p>This section shows how to handle general errors using a Try-Catch-Finally block.</p>
<p class="subhead2"><a id="sthref223"></a>To handle general errors:</p>
<ol>
<li>
<p>Change the code of the <code>connect_Click()</code> method in <code>Form1</code> by adding an implementation of the Try-Catch-Finally syntax.</p>
<p>New code is in bold font.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
private void connect_Click(object sender, EventArgs e)
{
  conn.ConnectionString = "Data Source=ORCL;User Id="
     + userID.Text + ";Password=" + password.Text + ";";
<span class="bold">  try</span>
<span class="bold">  {</span>
    conn.Open();
    connect.Enabled = false;
<span class="bold">  }</span>
<span class="bold">  catch (Exception ex)</span>
<span class="bold">  {</span>
<span class="bold">    MessageBox.Show(ex.Message.ToString());</span>
<span class="bold">  }</span>
<span class="bold">  finally</span>
<span class="bold">  {</span>
<span class="bold">    conn.Dispose();</span>
<span class="bold">  }</span>
}
</pre>
<p>Alternatively, you can use C# syntax that disposes of a connection when it goes out of scope, with the <code>using</code> keyword, as follows:</p>
<pre>
<a id="CHDFJABE"></a>
using (OracleConnection conn = new OracleConnection())
{
  conn.Open();
  // application code
  ...
}
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CEGEFIII"></a>
<span class="bold">Try</span>
  conn.Open()
  connect.Enabled = false

<span class="bold">Catch ex As Exception</span>
<span class="bold">  MessageBox.Show(ex.Message.ToString())</span>

<span class="bold">Finally</span>
<span class="bold">  conn.Dispose()</span>
<span class="bold">End Try</span>
</pre></li>
<li>
<p>From the <span class="bold">Build</span> menu, select <span class="bold">Rebuild Solution</span>.</p>
<p>Ensure that there are no errors.</p>
</li>
<li>
<p>From the <span class="bold">Debug</span> menu, select <span class="bold">Start Without Debugging</span>.</p>
</li>
<li>
<p><a id="BCGBGABA"></a>Run the application again, as described in section <a href="#BCGJDCFF">"Compiling and Running the Application"</a>, and attempt to connect using an incorrect password. This time, the application catches the error and displays it in a pop-up window, <code>ORA-1017: invalid</code> <code>username/password;</code> <code>logon</code> <code>denied</code>.</p>
<img width="284" height="108" src="img/error2.gif" alt="Description of error2.gif follows" title="Description of error2.gif follows" /><br />
<a id="sthref224" href="img_text/error2.htm">Description of the illustration error2.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref225"></a>
<h3 class="sect2">Handling Common Oracle Errors<a id="sthref226"></a><a id="sthref227"></a><a id="sthref228"></a><a id="sthref229"></a><a id="sthref230"></a></h3>
<p>In the completed Try-Catch-Finally block code shown below, the first Catch statement branch is skipped if there are no <code>OracleException</code>s. The second Catch statement branch catches all other <code>Exception</code>s.</p>
<p>The first catch statement contains <code>Case</code> statements, which can be used to trap common database errors and display them in a user-friendly manner.</p>
<p>Note that the second <code>Case</code> statement catches a specific example of <code>OracleException</code>, when the database is not accessible.</p>
<p class="subhead2"><a id="sthref231"></a>To handle specific errors:</p>
<ol>
<li>
<p>Stop the database instance. See <a href="appendix_a.htm#BABHDJAH">Appendix A, "Starting and Stopping an Oracle&nbsp;Database&nbsp;Instance"</a>.</p>
</li>
<li>
<p>Add the <code>Catch</code> <code>OracleException</code> block shown below in bold, before the <code>Catch</code> <code>Exception</code> block previously added in the <code>connect_Click()</code> method.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CEGFGBHF"></a>
try
  {
    conn.Open();
    connect.Enabled = false;
  }
<span class="bold">catch (OracleException ex)</span>
<span class="bold">{</span>
  <span class="bold">switch (ex.Number)</span>
  <span class="bold">{</span>
    <span class="bold">case 1:</span>
     <span class="bold"> MessageBox.Show("Error attempting to insert duplicate data.");</span>
      <span class="bold">break;</span>
    <span class="bold">case 12560:</span>
      <span class="bold">MessageBox.Show("The database is unavailable.");</span>
      <span class="bold">break;</span>
    <span class="bold">default:</span>
      <span class="bold">MessageBox.Show("Database error: " + ex.Message.ToString());</span>
      <span class="bold">break;</span>
  <span class="bold">}</span>
<span class="bold">}</span>
 catch (Exception ex)
   {
     MessageBox.Show(ex.Message.ToString());
   }
finally
  {
    conn.Dispose();
  }
}
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CEGBBCIG"></a>
Try
  conn.Open()
  connect.Enabled = false

<span class="bold">Catch ex As OracleException ' catches only Oracle errors</span>
  <span class="bold">Select Case ex.Number</span>
    <span class="bold">Case 1</span>
      <span class="bold">MessageBox.Show("Error attempting to insert duplicate data.")</span>
    <span class="bold">Case 12560</span>
      <span class="bold">MessageBox.Show("The database is unavailable.")</span>
    <span class="bold">Case Else</span>
      <span class="bold">MessageBox.Show("Database error: " + ex.Message.ToString())</span>
  <span class="bold">End Select</span>


Catch ex As Exception
  MessageBox.Show(ex.Message.ToString())

Finally
  conn.Dispose()
End Try
</pre></li>
<li>
<p><a id="BCGJGIDF"></a>Compile and run the application again, as described in section <a href="#BCGJDCFF">"Compiling and Running the Application"</a>.</p>
<p>Note that the <code>ORA-12560</code> error appears in the pop-up window as <code>The</code> <code>database</code> <code>is</code> <code>unavailable</code> with no error number provided.</p>
<img width="167" height="109" src="img/error04.gif" alt="Description of error04.gif follows" title="Description of error04.gif follows" /><br />
<a id="sthref232" href="img_text/error04.htm">Description of the illustration error04.gif</a><br />
<br /></li>
<li>
<p>Restart the database instance. See <a href="appendix_a.htm#BABHDJAH">Appendix A, "Starting and Stopping an Oracle&nbsp;Database&nbsp;Instance"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1159">
<tr>
<td class="cellalignment1166">
<table class="cellalignment1164">
<tr>
<td class="cellalignment1163"><a href="installation.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1163"><a href="building_odp.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1168">
<table class="cellalignment1162">
<tr>
<td class="cellalignment1163"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1163"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1163"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1163"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1163"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1163"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
