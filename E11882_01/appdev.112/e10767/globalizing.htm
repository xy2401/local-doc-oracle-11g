<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Including Globalization Support</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 005" />
<meta name="dcterms.created" content="2009-07-23T17:44:37Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + .NET Developer's Guide" />
<meta name="dcterms.identifier" content="E10767-01" />
<meta name="dcterms.isVersionOf" content="TDPNG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="procedures_dot_net.htm" title="Previous" type="text/html" />
<link rel="Next" href="appendix_a.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10767.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">12/15</span> <!-- End Header --><a id="sthref596"></a>
<h1 class="chapter"><span class="secnum">9</span> <a id="TDPNG80000"></a>Including Globalization Support</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#CHDHJBAB">Introduction to Global Applications</a></p>
</li>
<li>
<p><a href="#CHDGHAAI">Developing Global Applications with the .NET Framework</a></p>
</li>
<li>
<p><a href="#CHDGHBHD">Presenting Data in the Correct User Local Convention</a></p>
</li>
<li>
<p><a href="#CHDIFACF">Synchronizing the .NET and Oracle Database Locale Environments</a></p>
</li>
<li>
<p><a href="#CACGGIIE">Client Globalization Support in Oracle Data Provider for .NET</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ODPNT0012" href="../../win.112/e23174/global.htm#ODPNT0012">Chapter 8, "Oracle Data Provider for .NET Globalization Classes"</a> in <a><span class="italic">Oracle Data Provider for .NET Developer's Guide</span></a></p>
</li>
<li>
<p>"Working in a Global Environment" in the <a class="olink TDDDG70000" href="../../appdev.112/e10766/tdddg_deploying.htm#TDDDG70000"><span class="italic">Oracle Database 2 Day Developer's Guide</span></a></p>
</li>
<li>
<p>Microsoft .NET Internationalization Internet site,<a id="sthref597"></a> <code><a href="http://msdn.microsoft.com/en-us/goglobal/bb688096.aspx">http://msdn.microsoft.com/en-us/goglobal/bb688096.aspx</a></code></p>
</li>
</ul>
</div>
<a id="CHDHJBAB"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG80010"></a>Introduction to Global Applications<a id="sthref598"></a><a id="sthref599"></a><a id="sthref600"></a><a id="sthref601"></a><a id="sthref602"></a><a id="sthref603"></a><a id="sthref604"></a></h2>
<p>This chapter discusses global application development with Oracle Database in .NET. It addresses the basic tasks associated with developing applications that are ready for global deployment, such as developing locale awareness and presenting data with cultural conventions of the user's locale. It also discusses globalization support features available in Oracle Data Provider for .NET.</p>
<p>Building a global-ready application that supports different locales requires good development practices.</p>
<p>A locale refers to a national language and the region in which the language is spoken. The application itself must be aware of the user's locale preference and be able to present content following the cultural convention expected by the user. It is important to present data with appropriate locale characteristics, such as the correct date and number formats. Oracle Database is fully internationalized to provide a global platform for developing and deploying global applications.</p>
</div>
<!-- class="sect1" -->
<a id="CHDGHAAI"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG80020"></a>Developing Global Applications with the .NET Framework<a id="sthref605"></a><a id="sthref606"></a><a id="sthref607"></a><a id="sthref608"></a><a id="sthref609"></a><a id="sthref610"></a></h2>
<p>When planning a global-ready application, you have to consider two main tasks:</p>
<ul>
<li>
<p><span class="bold">Globalization</span> is the process of designing applications that can adapt to different cultures.</p>
</li>
<li>
<p><span class="bold">Localization</span> is the process of translating resources for a specific culture.</p>
</li>
</ul>
<p>In the .NET Framework, the <code>System.Globalization</code> namespace contains classes that define information related to culture, such as language, country and region, calendars, format patterns for dates, currency, and numbers, and the sort order for strings. These classes simplify the process of developing a global-ready application, so that passing a <code>CultureInfo</code> object that represents the user's culture to methods in <code>System.Globalization</code> namespace initiates the correct set of rules and data.</p>
<p>The .NET Framework also supports the creation and localization of resources, and offers a model for packaging and deploying them. Localizing the application's resources for specific cultures supports development of translated versions of the application. The .NET Framework base class library provides several classes in the <code>System.Resources</code> namespace for building and manipulating application resources.</p>
</div>
<!-- class="sect1" -->
<a id="CHDGHBHD"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG80030"></a>Presenting Data in the Correct User Local Convention<a id="sthref611"></a></h2>
<p>Data in the application must be presented in a way that meets the user's expectations, or its meaning can be misinterpreted. For example, 12/11/05 implies December 11, 2005 in the United States and November 12, 2005 in the United Kingdom. Similar confusion exists for number and monetary formats. For example, the period (.) is a decimal separator in the United States and a thousand separator throughout Europe.</p>
<p>Different languages have their own sorting rules: some languages are collated according to the letter sequence in the alphabet, others according to stroke count in the letter, still others are ordered by the pronunciation of the words. Presenting data that is not sorted according to the linguistic sequence that the user is accustomed to can make searching for information difficult and time-consuming.</p>
<p>Depending on the application logic and the volume of data retrieved from the database, it may be more appropriate to format the data at the database level rather than at the application level. Oracle Database offers many features that refine the presentation of data when the user locale preference is known.</p>
<div class="sect2"><a id="sthref612"></a>
<h3 class="sect2">Connecting to SQL*Plus<a id="sthref613"></a></h3>
<p>Several of the following examples require that you use SQL*Plus to connect as a user with database administrator privileges such as <code>SYS</code> or <code>SYSTEM</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMQS12042" href="../../server.112/e10897/users_secure.htm#ADMQS12042">"Locking and Unlocking User Accounts"</a> in the <a class="olink ADMQS" href="../../server.112/e10897/toc.htm"><span class="italic">Oracle Database 2 Day DBA</span></a> for further information</div>
</div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref614"></a>
<h3 class="sect2"><a id="TDPNG80031"></a>Using Oracle Date Formats<a id="sthref615"></a><a id="sthref616"></a><a id="sthref617"></a><a id="sthref618"></a><a id="sthref619"></a></h3>
<p>There are three different date presentation formats in Oracle Database: standard, short, and long. The following steps illustrate the difference between the short and long date formats for United States and Germany.</p>
<p class="subhead2"><a id="sthref620"></a>To change the Oracle date format:</p>
<ol>
<li>
<p><a id="BABIHIDD"></a>From a Windows command prompt, enter the following</p>
<pre>
  C:\&gt;sqlplus "sys as sysdba"
Enter password:<span class="italic">passwd</span>
</pre>
<p>where <code><span class="codeinlineitalic">passwd</span></code> is the <code>Sys</code> password that was established when the database was installed. The password does not appear when you type the characters. <img width="667" height="230" src="img/nls00.gif" alt="Description of nls00.gif follows" title="Description of nls00.gif follows" /><br />
<a id="sthref621" href="img_text/nls00.htm">Description of the illustration nls00.gif</a><br />
<br /></p>
</li>
<li>
<p>Enter this command at the SQL prompt:</p>
<pre>
<a id="CHDCJFAB"></a>
SQL&gt; ALTER SESSION SET NLS_TERRITORY=america NLS_LANGUAGE=american;
</pre>
<p>This message appears: <code>Session altered.</code></p>
<p>There is no problem with setting a parameter to its current setting. You may want to do this for security. To determine what your current settings are enter:</p>
<pre>
SQL&gt; select * from v$nls_parameters;  
</pre>
<p>or</p>
<pre>
select * from v$nls_parameters where parameter = 'NLS_LANGUAGE';
</pre></li>
<li>
<p><a id="CEGGIIEB"></a>At the SQL prompt, enter the following query:</p>
<pre>
<a id="CHDGFGJE"></a>
SQL&gt; SELECT employee_id "ID",
  SUBSTR (first_name,1,1)||'. '||last_name "Name",
  TO_CHAR (hire_date, 'DS') "Short Hire",
  TO_CHAR (hire_date, 'DL') "Long Hire Date"
  FROM hr.employees
  WHERE employee_id &lt; 105;
</pre>
<p>Note that you must use <code>hr.employees</code> in order to access the <code>employees</code> table in the <code>hr</code> schema because you are currently logged in as <code>sys</code>, not <code>hr</code>.</p>
<p>The result of the query returns in the American format specified in Step <a href="#BABIHIDD">1</a>.</p>
<img width="666" height="182" src="img/nls01.gif" alt="Description of nls01.gif follows" title="Description of nls01.gif follows" /><br />
<a id="sthref622" href="img_text/nls01.htm">Description of the illustration nls01.gif</a><br />
<br /></li>
<li>
<p><a id="CHDGAIHC"></a>Enter the following command at the SQL prompt:</p>
<pre>
<a id="CHDIHFFC"></a>
SQL&gt; ALTER SESSION SET NLS_TERRITORY=germany NLS_LANGUAGE=german;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p>At the SQL prompt, enter the query from Step <a href="#CEGGIIEB">3</a>.</p>
<p>The result of the query returns in the German format specified in Step <a href="#CHDGAIHC">4</a>.</p>
<img width="547" height="366" src="img/nls02.gif" alt="Description of nls02.gif follows" title="Description of nls02.gif follows" /><br />
<a id="sthref623" href="img_text/nls02.htm">Description of the illustration nls02.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref624"></a>
<h3 class="sect2"><a id="TDPNG80032"></a>Using Oracle Number Formats<a id="sthref625"></a><a id="sthref626"></a><a id="sthref627"></a></h3>
<p>There are also differences in the decimal character and group separator. The following steps illustrate these difference between United States and Germany.</p>
<p class="subhead2"><a id="sthref628"></a>To change the Oracle number format:</p>
<ol>
<li>
<p><a id="CEGHIDEI"></a>Enter the following command at the SQL prompt:</p>
<pre>
<a id="CHDCCCCF"></a>
SQL&gt; ALTER SESSION SET NLS_TERRITORY=america NLS_LANGUAGE=american;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p><a id="CEGHJGCE"></a>At the SQL prompt, enter the following query:</p>
<pre>
<a id="CHDGIDIH"></a>
SQL&gt; SELECT employee_id "ID",
  SUBSTR (first_name,1,1)||'. '||last_name "Name",
  TO_CHAR (salary, '99G999D99') "Salary"
  FROM hr.employees
  WHERE employee_id &lt; 105;
</pre>
<p>The result of the query returns in the American format specified in Step <a href="#CEGHIDEI">1</a>.</p>
<img width="618" height="174" src="img/nls03.gif" alt="Description of nls03.gif follows" title="Description of nls03.gif follows" /><br />
<a id="sthref629" href="img_text/nls03.htm">Description of the illustration nls03.gif</a><br />
<br /></li>
<li>
<p><a id="CEGIEIGC"></a>Enter the following command at the SQL prompt:</p>
<pre>
<a id="CHDCCGCG"></a>
SQL&gt; ALTER SESSION SET NLS_TERRITORY=germany;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p>At the SQL prompt, enter the query in Step <a href="#CEGHJGCE">2</a>.</p>
<p>The result of the query returns in the German format specified in Step <a href="#CEGIEIGC">3</a>.</p>
<img width="619" height="175" src="img/nls04.gif" alt="Description of nls04.gif follows" title="Description of nls04.gif follows" /><br />
<a id="sthref630" href="img_text/nls04.htm">Description of the illustration nls04.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref631"></a>
<h3 class="sect2"><a id="TDPNG80033"></a>Using Oracle Linguistic Sorts<a id="sthref632"></a><a id="sthref633"></a><a id="sthref634"></a><a id="sthref635"></a></h3>
<p>Spain traditionally treats <code>ch</code>, <code>ll</code>, and <code>&ntilde;</code> as letters of their own, ordered after <code>c</code>, <code>l</code> and <code>n</code>, respectively. The following steps illustrate the effect of using a Spanish sort against the employee names <code>Chen</code>, <code>Chung</code>, and <code>Colmenares</code>.</p>
<p class="subhead2"><a id="sthref636"></a>To change the Oracle linguistic sort:</p>
<ol>
<li>
<p><a id="CEGGBFEA"></a>Enter the following command at the SQL prompt.</p>
<pre>
<a id="CHDHCAHH"></a>
SQL&gt; ALTER SESSION SET NLS_SORT=binary;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p><a id="CEGJDJFH"></a>At the SQL prompt, enter the following query:</p>
<pre>
<a id="CHDCEFCJ"></a>
SQL&gt; SELECT employee_id "ID",
          last_name "Name"
  FROM hr.employees
  WHERE last_name LIKE 'C%'
  ORDER BY last_name;
</pre>
<p>The result of the query returns in the binary sort specified in Step <a href="#CEGGBFEA">1</a>.</p>
<img width="617" height="197" src="img/nls05.gif" alt="Description of nls05.gif follows" title="Description of nls05.gif follows" /><br />
<a id="sthref637" href="img_text/nls05.htm">Description of the illustration nls05.gif</a><br />
<br /></li>
<li>
<p><a id="CEGEECEC"></a>Enter the following command at the SQL prompt.</p>
<pre>
<a id="CHDCIFCH"></a>
SQL&gt; ALTER SESSION SET NLS_SORT=spanish_m;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p>At the SQL prompt, enter the query in Step <a href="#CEGJDJFH">2</a>.</p>
</li>
<li>
<p><a id="CHDEHJBJ"></a>The result of the query returns in the Spanish sort specified in Step <a href="#CEGEECEC">3</a>.</p>
<img width="615" height="196" src="img/nls06.gif" alt="Description of nls06.gif follows" title="Description of nls06.gif follows" /><br />
<a id="sthref638" href="img_text/nls06.htm">Description of the illustration nls06.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref639"></a>
<h3 class="sect2"><a id="TDPNG80034"></a>Oracle Error Messages<a id="sthref640"></a><a id="sthref641"></a><a id="sthref642"></a><a id="sthref643"></a></h3>
<p>The <code>NLS_LANGUAGE</code> parameter also controls the language of the database error messages. Setting this parameter prior to submitting a SQL query ensures the return of local language-specific error messages, as shown in these steps:</p>
<p class="subhead2"><a id="sthref644"></a>To change the Oracle NLS language parameter:</p>
<ol>
<li>
<p><a id="CEGEJBBF"></a>Enter the following command at the SQL prompt.</p>
<pre>
<a id="CHDCBBII"></a>
SQL&gt; ALTER SESSION SET NLS_LANGUAGE=american;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p><a id="CEGJJJBD"></a>At the SQL prompt, enter the following query.</p>
<pre>
<a id="CHDHHBHA"></a>
SQL&gt; SELECT * FROM managers;
</pre>
<p>The result of the query return the error message in the language specified in Step <a href="#CEGEJBBF">1</a>.</p>
<img width="615" height="128" src="img/nls07.gif" alt="Description of nls07.gif follows" title="Description of nls07.gif follows" /><br />
<a id="sthref645" href="img_text/nls07.htm">Description of the illustration nls07.gif</a><br />
<br /></li>
<li>
<p><a id="CEGGHFCJ"></a>Enter the following command at the SQL prompt.</p>
<pre>
SQL&gt; ALTER SESSION SET NLS_LANGUAGE=french;
</pre>
<p>This message appears: <code>Session altered.</code></p>
</li>
<li>
<p>At the SQL prompt, enter the query in Step <a href="#CEGJJJBD">2</a>.</p>
<p>The result of the query returns the error message in the language specified in Step <a href="#CEGGHFCJ">3</a>.</p>
<img width="612" height="125" src="img/nls08.gif" alt="Description of nls08.gif follows" title="Description of nls08.gif follows" /><br />
<a id="sthref646" href="img_text/nls08.htm">Description of the illustration nls08.gif</a><br />
<br /></li>
<li>
<p>Reset your language, local, and sort settings back to their original values.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDIFACF"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG80040"></a>Synchronizing the .NET and Oracle Database Locale Environments<a id="sthref647"></a><a id="sthref648"></a><a id="sthref649"></a><a id="sthref650"></a><a id="sthref651"></a></h2>
<p>When you are developing global applications, always synchronize the user locale settings between the database and clients. Otherwise, the application may present conflicting culture-sensitive information. For example, a .NET application must map the Culture ID of the application user to the correct <code>NLS_LANGUAGE</code> and <code>NLS_TERRITORY</code> parameter values before performing SQL operations.</p>
<p><a href="#CEGFFIGE">Table 9-1</a> shows some of the more common locales, as defined in .NET and Oracle environments.</p>
<div class="tblformal">
<p class="titleintable"><a id="sthref652"></a><a id="CEGFFIGE"></a>Table 9-1 Common NLS_LANGUAGE and NLS_TERRITORY Parameters</p>
<table class="cellalignment1173" title="Common NLS_LANGUAGE and NLS_TERRITORY Parameters" summary="The first column represents the culture, the second column is the ID of the culture, the third column is the NLS_LANGUAGE parameter value, and the fourth column is the NLS_TERRITORY parametere value." dir="ltr">
<thead>
<tr class="cellalignment1160">
<th class="cellalignment1172" id="r1c1-t4">Culture</th>
<th class="cellalignment1172" id="r1c2-t4">Culture ID</th>
<th class="cellalignment1172" id="r1c3-t4">NLS_LANGUAGE</th>
<th class="cellalignment1172" id="r1c4-t4">NLS_TERRITORY</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r2c1-t4" headers="r1c1-t4">
<p>Chinese (P.R.C.)</p>
</td>
<td class="cellalignment1166" headers="r2c1-t4 r1c2-t4">
<p><code>zh-CN</code></p>
</td>
<td class="cellalignment1166" headers="r2c1-t4 r1c3-t4">
<p><code>SIMPLIFIED CHINESE</code></p>
</td>
<td class="cellalignment1166" headers="r2c1-t4 r1c4-t4">
<p><code>CHINA</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r3c1-t4" headers="r1c1-t4">
<p>Chinese (Taiwan)</p>
</td>
<td class="cellalignment1166" headers="r3c1-t4 r1c2-t4">
<p><code>zh-TW</code></p>
</td>
<td class="cellalignment1166" headers="r3c1-t4 r1c3-t4">
<p><code>TRADITIONAL CHINESE</code></p>
</td>
<td class="cellalignment1166" headers="r3c1-t4 r1c4-t4">
<p><code>TAIWAN</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r4c1-t4" headers="r1c1-t4">
<p>English (U.S.A.)</p>
</td>
<td class="cellalignment1166" headers="r4c1-t4 r1c2-t4">
<p><code>en-US</code></p>
</td>
<td class="cellalignment1166" headers="r4c1-t4 r1c3-t4">
<p><code>AMERICAN</code></p>
</td>
<td class="cellalignment1166" headers="r4c1-t4 r1c4-t4">
<p><code>AMERICA</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r5c1-t4" headers="r1c1-t4">
<p>English (U.K.)</p>
</td>
<td class="cellalignment1166" headers="r5c1-t4 r1c2-t4">
<p><code>en-GB</code></p>
</td>
<td class="cellalignment1166" headers="r5c1-t4 r1c3-t4">
<p><code>ENGLISH</code></p>
</td>
<td class="cellalignment1166" headers="r5c1-t4 r1c4-t4">
<p><code>UNITED</code> <code>KINGDOM</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r6c1-t4" headers="r1c1-t4">
<p>French (Canada)</p>
</td>
<td class="cellalignment1166" headers="r6c1-t4 r1c2-t4">
<p><code>fr-CA</code></p>
</td>
<td class="cellalignment1166" headers="r6c1-t4 r1c3-t4">
<p><code>CANADIAN FRENCH</code></p>
</td>
<td class="cellalignment1166" headers="r6c1-t4 r1c4-t4">
<p><code>CANADA</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r7c1-t4" headers="r1c1-t4">
<p>French (France)</p>
</td>
<td class="cellalignment1166" headers="r7c1-t4 r1c2-t4">
<p><code>fr-FR</code></p>
</td>
<td class="cellalignment1166" headers="r7c1-t4 r1c3-t4">
<p><code>FRENCH</code></p>
</td>
<td class="cellalignment1166" headers="r7c1-t4 r1c4-t4">
<p><code>FRANCE</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r8c1-t4" headers="r1c1-t4">
<p>German</p>
</td>
<td class="cellalignment1166" headers="r8c1-t4 r1c2-t4">
<p><code>de</code></p>
</td>
<td class="cellalignment1166" headers="r8c1-t4 r1c3-t4">
<p><code>GERMAN</code></p>
</td>
<td class="cellalignment1166" headers="r8c1-t4 r1c4-t4">
<p><code>GERMANY</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r9c1-t4" headers="r1c1-t4">
<p>Italian</p>
</td>
<td class="cellalignment1166" headers="r9c1-t4 r1c2-t4">
<p><code>it</code></p>
</td>
<td class="cellalignment1166" headers="r9c1-t4 r1c3-t4">
<p><code>ITALIAN</code></p>
</td>
<td class="cellalignment1166" headers="r9c1-t4 r1c4-t4">
<p><code>ITALY</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r10c1-t4" headers="r1c1-t4">
<p>Japanese</p>
</td>
<td class="cellalignment1166" headers="r10c1-t4 r1c2-t4">
<p>j<code>a</code></p>
</td>
<td class="cellalignment1166" headers="r10c1-t4 r1c3-t4">
<p><code>JAPANESE</code></p>
</td>
<td class="cellalignment1166" headers="r10c1-t4 r1c4-t4">
<p><code>JAPAN</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r11c1-t4" headers="r1c1-t4">
<p>Korean</p>
</td>
<td class="cellalignment1166" headers="r11c1-t4 r1c2-t4">
<p><code>ko</code></p>
</td>
<td class="cellalignment1166" headers="r11c1-t4 r1c3-t4">
<p><code>KOREAN</code></p>
</td>
<td class="cellalignment1166" headers="r11c1-t4 r1c4-t4">
<p><code>KOREA</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r12c1-t4" headers="r1c1-t4">
<p>Portuguese (Brazil)</p>
</td>
<td class="cellalignment1166" headers="r12c1-t4 r1c2-t4">
<p><code>pt-BR</code></p>
</td>
<td class="cellalignment1166" headers="r12c1-t4 r1c3-t4">
<p><code>BRAZILIAN PORTUGUESE</code></p>
</td>
<td class="cellalignment1166" headers="r12c1-t4 r1c4-t4">
<p><code>BRAZIL</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r13c1-t4" headers="r1c1-t4">
<p>Portuguese</p>
</td>
<td class="cellalignment1166" headers="r13c1-t4 r1c2-t4">
<p><code>pt</code></p>
</td>
<td class="cellalignment1166" headers="r13c1-t4 r1c3-t4">
<p><code>PORTUGUESE</code></p>
</td>
<td class="cellalignment1166" headers="r13c1-t4 r1c4-t4">
<p><code>PORTUGAL</code></p>
</td>
</tr>
<tr class="cellalignment1160">
<td class="cellalignment1166" id="r14c1-t4" headers="r1c1-t4">
<p>Spanish</p>
</td>
<td class="cellalignment1166" headers="r14c1-t4 r1c2-t4">
<p><code>es</code></p>
</td>
<td class="cellalignment1166" headers="r14c1-t4 r1c3-t4">
<p><code>SPANISH</code></p>
</td>
<td class="cellalignment1166" headers="r14c1-t4 r1c4-t4">
<p><code>SPAIN</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="sect1" -->
<a id="CACGGIIE"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><a id="TDPNG80050"></a>Client Globalization Support in Oracle Data Provider for .NET<a id="sthref653"></a><a id="sthref654"></a><a id="sthref655"></a><a id="sthref656"></a><a id="sthref657"></a><a id="sthref658"></a><a id="sthref659"></a><a id="sthref660"></a></h2>
<p>Oracle Data Provider for .NET enables applications to manipulate culture-sensitive data, such as ensuring proper string format, date, time, monetary, numeric, sort order, and calendar support using culture conventions defined in the Oracle Database. The default globalization settings are determined by the client's <code>NLS_LANG</code> parameter, which is defined in the Windows Registry of the local computer. When the <code>OracleConnection</code> <code>Open</code> method establishes a connection, it implicitly opens a session with globalization parameters specified by the value of the <code>NLS_LANG</code> parameter.</p>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref661"></a>
<h3 class="sect2"><a id="TDPNG80051"></a>Client Globalization Settings<a id="sthref662"></a><a id="sthref663"></a><a id="sthref664"></a><a id="sthref665"></a></h3>
<p>The client globalization parameter settings are read-only and remain constant throughout the lifetime of the application. Changing the <code>OracleGlobalization</code> object properties does not change the globalization settings of the session or the thread. The following sections describe how to modify the globalization settings at the session and thread level.</p>
<p>Your .NET application can obtain globalization settings by calling the <code>OracleGlobalization.GetClientInfo()</code> static method. The <code>OracleGlobalization</code> sample code below demonstrates how to obtain some of the values in .NET.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CACFCGJD"></a>
using System;
using Oracle.DataAccess.Client; 
 
class ClientGlobalizationSample
{
  static void Main()
  {
    OracleGlobalization ClientGlob = OracleGlobalization.GetClientInfo();
    Console.WriteLine("Client machine language: " + ClientGlob.Language);
    Console.WriteLine("Client characterset: " + ClientGlob.ClientCharacterSet);
  }
}
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CHDFJFFA"></a>
Imports System
Imports Oracle.DataAccess.Client
 
Class ClientGlobalizationSample
  Shared Sub Main()
    Dim ClientGlob As OracleGlobalization = OracleGlobalization.GetClientInfo()
    Console.WriteLine("Client machine language: " + ClientGlob.Language)
    Console.WriteLine("Client characterset: " + ClientGlob.ClientCharacterSet)
  End Sub
End Class
</pre></div>
<!-- class="sect2" -->
<div class="sect2"><a id="sthref666"></a>
<h3 class="sect2"><a id="TDPNG80052"></a>Using Session Globalization Settings<a id="sthref667"></a><a id="sthref668"></a><a id="sthref669"></a><a id="sthref670"></a><a id="sthref671"></a><a id="sthref672"></a><a id="sthref673"></a></h3>
<p>Session globalization parameters are initially identical to client globalization settings, but they can be modified. To modify the session parameters, you must establish a connection to the database, and then call the <code>GetSessionInfo()</code> method of an <code>OracleConnection</code> object to retrieve the session globalization settings. Next, you modify the globalization settings as needed, then save the settings back to the <code>OracleConnection</code> object through the <code>SetSessionInfo(OracleGlobalization)</code> method.</p>
<p class="subhead2"><a id="sthref674"></a>To specify the globalization session setting:</p>
<ol>
<li>
<p>Open the application <code>HR_Connect_CS</code> or <code>HR_Connect_VB</code>.</p>
</li>
<li>
<p>Make a copy of <code>Form3.</code><code><span class="codeinlineitalic">xx</span></code>, which you finished at the end of <a href="building_odp.htm#CHDDJIFI">Chapter 4</a> and name it <code>Form5.</code><code>xx</code>, following the instructions in <a href="appendix_b.htm#BABJJIJJ">Appendix B, "Copying a Form"</a>.</p>
</li>
<li>
<p>Open <span class="bold">Form1</span> of the project, and switch to design view.</p>
</li>
<li>
<p>From the <span class="bold">View</span> menu, select <span class="bold">Toolbox</span>.</p>
</li>
<li>
<p>From the Toolbox, under Windows Forms, drag and drop a <span class="bold">Button</span> onto Form1.</p>
</li>
<li>
<p>Right-click the new <span class="bold">Button</span>, select <span class="bold">Properties</span>. The Properties window appears.</p>
</li>
<li>
<p><a id="CHDCJJBE"></a>In the Properties window, set these properties:</p>
<ul>
<li>
<p>Under Appearance, change <span class="bold">Text</span> to <code>Change</code> <code>Date</code> <code>Format</code>.</p>
</li>
<li>
<p>Under Design, change <span class="bold">(Name)</span> to <code>date_change</code>.</p>
<p>Form1 should look much like this:</p>
<img width="596" height="320" src="img/nls09.gif" alt="Description of nls09.gif follows" title="Description of nls09.gif follows" /><br />
<a id="sthref675" href="img_text/nls09.htm">Description of the illustration nls09.gif</a><br />
<br /></li>
</ul>
<p>In the properties window, if you click <span class="bold">Events</span> (lightning bolt icon), <code>date_change_Click()</code> now shows as the Event for the date button.</p>
</li>
<li>
<p>Open the new <code>date_change_Click()</code> method just created and add the following code to change the date format from the standard <code>DD-MON-RR</code> to <code>YYYY-MM-DD</code> and to update the <code>DataSet</code>.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CHDBIBJB"></a>
si.DateFormat = "YYYY-MM-DD";
conn.SetSessionInfo(si);
 
ds.Clear();
da.Fill(ds);
departments.DataSource = ds.Tables[0];
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CHDIDCGF"></a>
si.DateFormat = "YYYY-MM-DD"
conn.SetSessionInfo(si)
 
ds.Clear()
da.Fill(ds)
departments.DataSource = ds.Tables(0)
</pre>
<p>Note that the <code>ds.Clear()</code> call will clear the old results before posting the changed data.</p>
<p>Also, the <code>si</code> class variable will be declared and session globalization information retrieved in Step <a href="#CHDDDCEJ">10</a> and Step <a href="#BABFBAHC">11</a>.</p>
</li>
<li>
<p><a id="CHDHAADG"></a>Within the appropriate method, add the code indicated.</p>
<p><span class="bold">Visual C#:</span> In the <code>Form1()</code> method</p>
<pre>
<a id="CHDDIAJD"></a>
date_change.Enabled = false;
</pre>
<p><span class="bold">Visual Basic:</span> In the <code>Form1_Load</code> method</p>
<pre>
<a id="CHDFAIHA"></a>
date_change.Enabled = false
</pre>
<img width="600" height="177" src="img/nls10.gif" alt="Description of nls10.gif follows" title="Description of nls10.gif follows" /><br />
<a id="sthref676" href="img_text/nls10.htm">Description of the illustration nls10.gif</a><br />
<br /></li>
<li>
<p><a id="CHDDDCEJ"></a>Add the following class variable to the existing Form1 class declarations right after the <code>public</code> <code>Form1()</code> block with this code as indicated.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CHDBCJED"></a>
private OracleGlobalization si;
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CHDCCFHJ"></a>
private si As OracleGlobalization
</pre>
<img width="622" height="227" src="img/nls11.gif" alt="Description of nls11.gif follows" title="Description of nls11.gif follows" /><br />
<a id="sthref677" href="img_text/nls11.htm">Description of the illustration nls11.gif</a><br />
<br /></li>
<li>
<p><a id="BABFBAHC"></a>Within the <code>connect_Click()</code> method <code>try</code> block, add the indicated code which does the following:</p>
<ul>
<li>
<p>Retrieve the value of the <code>OracleGlobalization</code> object.</p>
</li>
<li>
<p>Retrieve data from the <code>EMPLOYEES</code> table (note the new query).</p>
</li>
<li>
<p>Enable the <span class="bold">Change Date Format</span> button.</p>
</li>
</ul>
<p>The changed code is in bold typeface.</p>
<p><span class="bold">Visual C#:</span></p>
<pre>
<a id="CHDDJCBE"></a>
conn.Open();
connect.Enabled = false;

<span class="bold">si = conn.GetSessionInfo();</span>
 
string sql = <span class="bold">"select employee_id, first_name, last_name, TO_CHAR(hire_date)</span>" +
   " <span class="bold">\"Hire Date\</span>" <span class="bold">from employees where employee_id &lt; 105"</span>;
cmd = new OracleCommand(sql, conn);
cmd.CommandType = CommandType.Text;

da = new OracleDataAdapter(cmd);
cb = new OracleCommandBuilder(da);
ds = new DataSet();
 
da.Fill(ds);
 
departments.DataSource = ds.Tables[0];
 
save.Enabled = true;
<span class="bold">date_change.Enabled = true;</span>
</pre>
<p><span class="bold">Visual Basic:</span></p>
<pre>
<a id="CHDHICGB"></a>
conn.Open()
connect.Enabled = false

<span class="bold">si = conn.GetSessionInfo()</span>

Dim sql As String = <span class="bold">"select employee_id, first_name, last_name,</span> " &amp; _
<span class="bold">    "TO_CHAR(hire_date) ""Hire Date""</span> <span class="bold">from employees where employee_id &lt; 105"</span>
cmd = new OracleCommand(sql, conn)
cmd.CommandType = CommandType.Text

da = new OracleDataAdapter(cmd)
cb = new OracleCommandBuilder(da)
ds = new DataSet()
 
da.Fill(ds)
 
departments.DataSource = ds.Tables[0]
 
save.Enabled = true
<span class="bold">date_change.Enabled = true</span>
</pre></li>
<li>
<p>Save <code>Form1</code>.</p>
</li>
<li>
<p>Run the application using the <span class="bold">F5</span> keyboard shortcut.</p>
<p>The application successfully connects to the database so the data grid is populated with the results of the query.</p>
<img width="526" height="392" src="img/nls12.gif" alt="Description of nls12.gif follows" title="Description of nls12.gif follows" /><br />
<a id="sthref678" href="img_text/nls12.htm">Description of the illustration nls12.gif</a><br />
<br /></li>
<li>
<p><a id="CHDCCAIC"></a>Click <span class="bold">Change Date Format</span>.</p>
<img width="523" height="393" src="img/nls13.gif" alt="Description of nls13.gif follows" title="Description of nls13.gif follows" /><br />
<a id="sthref679" href="img_text/nls13.htm">Description of the illustration nls13.gif</a><br />
<br />
<p>Note that the date format changed from the original <code>DD-MON-RR</code> to <code>YYYY-MM-DD</code>.</p>
</li>
<li>
<p>Close the application.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref680"></a>
<h3 class="sect2"><a id="TDPNG80053"></a>Thread-Based Globalization Settings<a id="sthref681"></a><a id="sthref682"></a><a id="sthref683"></a><a id="sthref684"></a><a id="sthref685"></a><a id="sthref686"></a><a id="sthref687"></a><a id="sthref688"></a><a id="sthref689"></a></h3>
<p>Thread-based globalization parameter settings are specific to each thread. Initially, these settings are identical to the client globalization parameters, but they can be changed programmatically. When converting ODP.NET Types to and from strings, use the thread-based globalization parameters, if applicable.</p>
<p>Thread-based globalization parameter settings are obtained by calling the <code>GetThreadInfo()</code> static method of the <code>OracleGlobalization</code> class. A call to <code>SetThreadInfo()</code> static method sets the globalization settings of the thread.</p>
<p>ODP.NET classes and structures rely solely on the <code>OracleGlobalization</code> settings when manipulating culture-sensitive data. They do not use .NET thread culture information. If the application uses only .NET types, <code>OracleGlobalization</code> settings have no effect. However, when conversions are made between ODP.NET Types and .NET Types, <code>OracleGlobalization</code> settings are used where applicable.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Changes to the <code>System.Threading.Thread. CurrentThread.CurrentCulture</code> property do not impact the <code>OracleGlobalization</code> settings of the thread or the session. The reverse is also true.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1159">
<tr>
<td class="cellalignment1166">
<table class="cellalignment1164">
<tr>
<td class="cellalignment1163"><a href="procedures_dot_net.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1163"><a href="appendix_a.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1168">
<table class="cellalignment1162">
<tr>
<td class="cellalignment1163"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1163"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1163"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1163"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1163"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1163"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
