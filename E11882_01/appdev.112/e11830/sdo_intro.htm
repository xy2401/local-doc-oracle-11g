<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Spatial Concepts</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 743" />
<meta name="description" content="Provides usage and reference information for indexing and storing spatial data and for developing spatial applications using Oracle Spatial and Graph and Oracle Locator." />
<meta name="dcterms.created" content="2013-11-26T3:11:43Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Spatial Developer's Guide" />
<meta name="dcterms.identifier" content="E11830-15" />
<meta name="dcterms.isVersionOf" content="SPATL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sdo_prtusage.htm" title="Previous" type="text/html" />
<link rel="Next" href="sdo_objrelschema.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e11830.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">9/51</span> <!-- End Header -->
<div id="SPATL010" class="chapter"><a id="BGEBIHIH"></a> <a id="i884907"></a>
<h1 class="chapter"><span class="secnum">1</span> Spatial Concepts</h1>
<p>Oracle Spatial is an integrated set of functions and procedures that enables spatial data to be stored, accessed, and analyzed quickly and efficiently in an Oracle database.</p>
<p>Spatial data represents the essential location characteristics of real or conceptual objects as those objects relate to the real or conceptual space in which they exist.</p>
<p>This chapter contains the following major sections:</p>
<ul>
<li>
<p><a href="#BAJGDGHA">Section 1.1, "What Is Oracle Spatial?"</a></p>
</li>
<li>
<p><a href="#i881614">Section 1.2, "Object-Relational Model"</a></p>
</li>
<li>
<p><a href="#BAJJIFJJ">Section 1.3, "Introduction to Spatial Data"</a></p>
</li>
<li>
<p><a href="#BAJDIHJF">Section 1.4, "Geometry Types"</a></p>
</li>
<li>
<p><a href="#BAJDCCCB">Section 1.5, "Data Model"</a></p>
</li>
<li>
<p><a href="#g1000087">Section 1.6, "Query Model"</a></p>
</li>
<li>
<p><a href="#i877656">Section 1.7, "Indexing of Spatial Data"</a></p>
</li>
<li>
<p><a href="#i880253">Section 1.8, "Spatial Relationships and Filtering"</a></p>
</li>
<li>
<p><a href="#BAJDEGDH">Section 1.9, "Spatial Operators, Procedures, and Functions"</a></p>
</li>
<li>
<p><a href="#i883627">Section 1.10, "Spatial Aggregate Functions"</a></p>
</li>
<li>
<p><a href="#BABIDJJB">Section 1.11, "Three-Dimensional Spatial Objects"</a></p>
</li>
<li>
<p><a href="#BGEJBDIJ">Section 1.12, "Geocoding"</a></p>
</li>
<li>
<p><a href="#BAJHICEH">Section 1.13, "Spatial Java Application Programming Interface"</a></p>
</li>
<li>
<p><a href="#BAJDECJC">Section 1.14, "Predefined User Accounts Created by Spatial"</a></p>
</li>
<li>
<p><a href="#i885392">Section 1.15, "Performance and Tuning Information"</a></p>
</li>
<li>
<p><a href="#BABBFIHI">Section 1.16, "OGC and ISO Compliance"</a></p>
</li>
<li>
<p><a href="#BAJIIFBA">Section 1.17, "Spatial Release (Version) Number"</a></p>
</li>
<li>
<p><a href="#BHCGIAII">Section 1.18, "Spatially Enabling a Table"</a></p>
</li>
<li>
<p><a href="#BHCEJFDI">Section 1.19, "Moving Spatial Metadata (MDSYS.MOVE_SDO)"</a></p>
</li>
<li>
<p><a href="#BAJEJBCH">Section 1.20, "Spatial Application Hardware Requirement Considerations"</a></p>
</li>
<li>
<p><a href="#BAJHCEAH">Section 1.21, "Spatial Error Messages"</a></p>
</li>
<li>
<p><a href="#BAJIEFCA">Section 1.22, "Spatial Examples"</a></p>
</li>
<li>
<p><a href="#BABIECBB">Section 1.23, "README File for Spatial and Related Features"</a></p>
</li>
</ul>
<a id="BAJGDGHA"></a>
<div id="SPATL440" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.1</span> What Is Oracle Spatial?</h2>
<p>Oracle Spatial, often referred to as Spatial, provides a SQL schema and functions that facilitate the storage, retrieval, update, and query of collections of spatial features in an Oracle database. Spatial consists of the following:</p>
<ul>
<li>
<p><a id="sthref32"></a>A schema (MDSYS) that prescribes the storage, syntax, and semantics of supported geometric data types</p>
</li>
<li>
<p>A spatial indexing mechanism</p>
</li>
<li>
<p>Operators, functions, and procedures for performing area-of-interest queries, spatial join queries, and other spatial analysis operations</p>
</li>
<li>
<p>Functions and procedures for utility and tuning operations</p>
</li>
<li>
<p>Topology data model for working with data about nodes, edges, and faces in a topology (described in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>).</p>
</li>
<li>
<p>Network data model for representing capabilities or objects that are modeled as nodes and links in a network (described in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>).</p>
</li>
<li>
<p>GeoRaster, a feature that lets you store, index, query, analyze, and deliver GeoRaster data, that is, raster image and gridded data and its associated metadata (described in <a class="olink GEORS" href="../e11827/toc.htm"><span class="italic">Oracle Spatial GeoRaster Developer's Guide</span></a>).</p>
</li>
</ul>
<p>The spatial component of a spatial feature is the geometric representation of its shape in some coordinate space. This is referred to as its <span class="bold">geometry</span>.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Do not modify any packages, tables, or other objects under the MDSYS schema. (The only exception is if you need to create a user-defined coordinate reference system, as explained in <a href="sdo_cs_concepts.htm#i894537">Section 6.9</a>.)</div>
</div>
<!-- class="sect1" -->
<a id="i881614"></a>
<div id="SPATL441" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.2</span> Object-Relational Model</h2>
<p>Spatial supports the <span class="bold">object-relational</span> model for representing geometries. This model stores an entire geometry in the Oracle native spatial data type for vector data, SDO_GEOMETRY. An Oracle table can contain one or more SDO_GEOMETRY columns. The object-relational model corresponds to a "SQL with Geometry Types" implementation of spatial feature tables in the Open GIS ODBC/SQL specification for geospatial features.</p>
<p>The benefits provided by the object-relational model include:</p>
<ul>
<li>
<p>Support for many geometry types, including arcs, circles, compound polygons, compound line strings, and optimized rectangles</p>
</li>
<li>
<p>Ease of use in creating and maintaining indexes and in performing spatial queries</p>
</li>
<li>
<p>Index maintenance by the Oracle database</p>
</li>
<li>
<p>Geometries modeled in a single column</p>
</li>
<li>
<p>Optimal performance</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BAJJIFJJ"></a>
<div id="SPATL442" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.3</span> Introduction to Spatial Data</h2>
<p>Oracle Spatial is designed to make spatial data management easier and more natural to users of location-enabled applications and geographic information system (GIS) applications. Once spatial data is stored in an Oracle database, it can be easily manipulated, retrieved, and related to all other data stored in the database.</p>
<p>A common example of spatial data can be seen in a road map. A road map is a two-dimensional object that contains points, lines, and polygons that can represent cities, roads, and political boundaries such as states or provinces. A road map is a visualization of geographic information. The location of cities, roads, and political boundaries that exist on the surface of the Earth are projected onto a two-dimensional display or piece of paper, preserving the relative positions and relative distances of the rendered objects.</p>
<p>The data that indicates the Earth location (such as longitude and latitude) of these rendered objects is the spatial data. When the map is rendered, this spatial data is used to project the locations of the objects on a two-dimensional piece of paper. A GIS is often used to store, retrieve, and render this Earth-relative spatial data.</p>
<p>Types of spatial data (other than GIS data) that can be stored using Spatial include data from computer-aided design (CAD) and computer-aided manufacturing (CAM) systems. Instead of operating on objects on a geographic scale, CAD/CAM systems work on a smaller scale, such as for an automobile engine or printed circuit boards.</p>
<p>The differences among these systems are in the size and precision of the data, not the data's complexity. The systems might all involve the same number of data points. On a geographic scale, the location of a bridge can vary by a few tenths of an inch without causing any noticeable problems to the road builders, whereas if the diameter of an engine's pistons is off by a few tenths of an inch, the engine will not run.</p>
<p>In addition, the complexity of data is independent of the absolute scale of the area being represented. For example, a printed circuit board is likely to have many thousands of objects etched on its surface, containing in its small area information that may be more complex than the details shown on a road builder's blueprints.</p>
<p>These applications all store, retrieve, update, or query some collection of features that have both nonspatial and spatial attributes. Examples of nonspatial attributes are name, soil_type, landuse_classification, and part_number. The spatial attribute is a coordinate geometry, or vector-based representation of the shape of the feature.</p>
</div>
<!-- class="sect1" -->
<a id="BAJDIHJF"></a>
<div id="SPATL443" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.4</span> <a id="sthref33"></a><a id="sthref34"></a>Geometry Types</h2>
<p>A <span class="bold">geometry</span> is an ordered sequence of vertices that are connected by straight line segments or circular arcs. The semantics of the geometry are determined by its type. Spatial supports several primitive types, and geometries composed of collections of these types, including two-dimensional:</p>
<ul>
<li>
<p>Points and point clusters</p>
</li>
<li>
<p>Line strings</p>
</li>
<li>
<p><span class="italic">n</span>-point polygons</p>
</li>
<li>
<p>Arc line strings (All arcs are generated as circular arcs.)</p>
</li>
<li>
<p>Arc polygons</p>
</li>
<li>
<p>Compound polygons</p>
</li>
<li>
<p>Compound line strings</p>
</li>
<li>
<p>Circles</p>
</li>
<li>
<p>Optimized rectangles</p>
</li>
</ul>
<p><span class="bold">Two-dimensional points</span> are elements composed of two ordinates, X and Y, often corresponding to longitude and latitude. <span class="bold">Line strings</span> are composed of one or more pairs of points that define line segments. <span class="bold">Polygons</span> are composed of connected line strings that form a closed ring, and the area of the polygon is implied. For example, a point might represent a building location, a line string might represent a road or flight path, and a polygon might represent a state, city, zoning district, or city block.</p>
<p><a id="sthref35"></a><a id="sthref36"></a><a id="sthref37"></a>Self-crossing polygons are not supported, although self-crossing line strings are supported. If a line string crosses itself, it does not become a polygon. A self-crossing line string does not have any implied area.</p>
<p><a href="#i885654">Figure 1-1</a> illustrates the geometric types.</p>
<div id="SPATL444" class="figure">
<p class="titleinfigure"><a id="i885654"></a>Figure 1-1 Geometric Types</p>
<img width="347" height="268" src="img/geom_types.gif" alt="Description of Figure 1-1 follows" /><br />
<a id="sthref38" href="img_text/geom_types.htm">Description of "Figure 1-1 Geometric Types"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Spatial also supports the storage and indexing of three-dimensional and four-dimensional geometric types, where three or four coordinates are used to define each vertex of the object being defined. For information about support for three-dimensional geometries, see <a href="#BABIDJJB">Section 1.11</a>.</p>
</div>
<!-- class="sect1" -->
<a id="BAJDCCCB"></a>
<div id="SPATL445" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.5</span> <a id="sthref39"></a>Data Model</h2>
<p>The Spatial data model is a hierarchical structure consisting of elements, geometries, and layers. Layers are composed of geometries, which in turn are made up of elements.</p>
<div id="SPATL446" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref40"></a>
<h3 class="sect2"><span class="secnum">1.5.1</span> Element</h3>
<p>An <span class="bold"><a id="sthref41"></a>element</span> is the basic building block of a geometry. The supported spatial element types are points, line strings, and polygons. For example, elements might model star constellations (point clusters), roads (line strings), and county boundaries (polygons). Each coordinate in an element is stored as an X,Y pair. The exterior ring and zero or more interior rings (holes) of a complex polygon are considered a single element.</p>
<p><span class="bold"><a id="sthref42"></a>Point data</span> consists of one coordinate. <span class="bold"><a id="sthref43"></a>Line data</span> consists of two coordinates representing a line segment of the element. <span class="bold"><a id="sthref44"></a>Polygon data</span> consists of coordinate pair values, one vertex pair for each line segment of the polygon. Coordinates are defined in order around the polygon (counterclockwise for an exterior polygon ring, clockwise for an interior polygon ring).</p>
</div>
<!-- class="sect2" -->
<div id="SPATL447" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref45"></a>
<h3 class="sect2"><span class="secnum">1.5.2</span> Geometry</h3>
<p>A <span class="bold">geometry</span> (or <span class="bold">geometry object</span>) is the representation of a spatial feature, modeled as an ordered set of primitive elements. A geometry can consist of a single element, which is an instance of one of the supported primitive types, or a homogeneous or heterogeneous collection of elements. A multipolygon, such as one used to represent a set of islands, is a homogeneous collection. A heterogeneous collection is one in which the elements are of different types, for example, a point and a polygon.</p>
<p>An example of a geometry might describe the buildable land in a town. This could be represented as a polygon with holes where water or zoning prevents construction.</p>
</div>
<!-- class="sect2" -->
<div id="SPATL448" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref46"></a>
<h3 class="sect2"><span class="secnum">1.5.3</span> <a id="sthref47"></a>Layer</h3>
<p>A <span class="bold">layer</span> is a collection of geometries having the same attribute set. For example, one layer in a GIS might include topographical features, while another describes population density, and a third describes the network of roads and bridges in the area (lines and points). The geometries and associated spatial index for each layer are stored in the database in standard tables.</p>
</div>
<!-- class="sect2" -->
<a id="i884977"></a>
<div id="SPATL449" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.5.4</span> <a id="sthref48"></a>Coordinate System</h3>
<p>A <span class="bold">coordinate system</span> (also called a <span class="italic">spatial reference system</span>) is a means of assigning coordinates to a location and establishing relationships between sets of such coordinates. It enables the interpretation of a set of coordinates as a representation of a position in a real world space.</p>
<p>Any spatial data has a coordinate system associated with it. The coordinate system can be <span class="italic">georeferenced</span> (related to a specific representation of the Earth) or not georeferenced (that is, Cartesian, and not related to a specific representation of the Earth). If the coordinate system is georeferenced, it has a default <span class="italic">unit of measurement</span> (such as meters) associated with it, but you can have Spatial automatically return results in another specified unit (such as miles). (For more information about unit of measurement support, see <a href="sdo_objrelschema.htm#i1010145">Section 2.10</a>.)</p>
<p>Spatial data can be associated with a Cartesian, geodetic (geographical), projected, or local coordinate system:</p>
<ul>
<li>
<p><a id="sthref49"></a><a id="sthref50"></a><span class="bold">Cartesian coordinates</span> are coordinates that measure the position of a point from a defined origin along axes that are perpendicular in the represented two-dimensional or three-dimensional space.</p>
<p>If a coordinate system is not explicitly associated with a geometry, a Cartesian coordinate system is assumed.</p>
</li>
<li>
<p><a id="sthref51"></a><a id="sthref52"></a><a id="sthref53"></a><span class="bold">Geodetic coordinates</span> (sometimes called <span class="italic">geographic coordinates</span>) are angular coordinates (longitude and latitude), closely related to spherical polar coordinates, and are defined relative to a particular Earth geodetic datum. (A <a id="sthref54"></a><a id="sthref55"></a>geodetic datum is a means of representing the figure of the Earth and is the reference for the system of geodetic coordinates.)</p>
</li>
<li>
<p><a id="sthref56"></a><a id="sthref57"></a><span class="bold">Projected coordinates</span> are planar Cartesian coordinates that result from performing a mathematical mapping from a point on the Earth's surface to a plane. There are many such mathematical mappings, each used for a particular purpose.</p>
</li>
<li>
<p><a id="sthref58"></a><a id="sthref59"></a><span class="bold">Local coordinates</span> are Cartesian coordinates in a non-Earth (non-georeferenced) coordinate system. Local coordinate systems are often used for CAD applications and local surveys.</p>
</li>
</ul>
<p>When performing operations on geometries, Spatial uses either a Cartesian or curvilinear computational model, as appropriate for the coordinate system associated with the spatial data.</p>
<p>For more information about coordinate system support in Spatial, including geodetic, projected, and local coordinates and coordinate system transformation, see <a href="sdo_cs_concepts.htm#g1002522">Chapter 6</a>.</p>
</div>
<!-- class="sect2" -->
<a id="i884589"></a>
<div id="SPATL450" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.5.5</span> <a id="sthref60"></a>Tolerance</h3>
<p>Tolerance is used to associate a level of precision with spatial data. <span class="bold">Tolerance</span> reflects the <span class="italic">distance that two points can be apart and still be considered the same</span> (for example, to accommodate rounding errors). The tolerance value must be a positive number greater than zero. The significance of the value depends on whether or not the spatial data is associated with a geodetic coordinate system. (Geodetic and other types of coordinate systems are described in <a href="#i884977">Section 1.5.4</a>.)</p>
<ul>
<li>
<p>For geodetic data (such as data identified by longitude and latitude coordinates), the tolerance value is a number of meters. For example, a tolerance value of 100 indicates a tolerance of 100 meters. The tolerance value for geodetic data must be 0.05 (5 centimeters) or greater. Spatial uses 0.05 as the tolerance value for geodetic data if you specify a smaller value with the following functions: <a href="sdo_objgeom.htm#BGHCDIDG">SDO_GEOM.RELATE</a>, <a href="sdo_objgeom.htm#i857512">SDO_GEOM.SDO_DIFFERENCE</a>, <a href="sdo_objgeom.htm#i857570">SDO_GEOM.SDO_INTERSECTION</a>, <a href="sdo_objgeom.htm#i857624">SDO_GEOM.SDO_UNION</a>, and <a href="sdo_objgeom.htm#i857842">SDO_GEOM.SDO_XOR</a>; however, the geometries must be valid at the 0.05 tolerance.</p>
</li>
<li>
<p>For non-geodetic data, the tolerance value is a number of the units that are associated with the coordinate system associated with the data. For example, if the unit of measurement is miles, a tolerance value of 0.005 indicates a tolerance of 0.005 (that is, 1/200) mile (approximately 26 feet or 7.9 meters), and a tolerance value of 2 indicates a tolerance of 2 miles.</p>
</li>
</ul>
<p>In both cases, the smaller the tolerance value, the more precision is to be associated with the data.</p>
<p>For geometries that have 16 or more digits of precision, Spatial boolean operations (such as <a href="sdo_objgeom.htm#i857624">SDO_GEOM.SDO_UNION</a> and <a href="sdo_objgeom.htm#i857570">SDO_GEOM.SDO_INTERSECTION</a>) and the <a href="sdo_objgeom.htm#BGHCDIDG">SDO_GEOM.RELATE</a> function might produce inconsistent results due to the loss of precision in floating point arithmetic. The number of digits of precision is calculated as in the following example: if the tolerance is set to 0.0000000005 and the coordinates have 6 digits to the left of decimal (for example, 123456.4321), the precision is 10 + 6 digits (16). In such cases, it is better to use a larger tolerance value (fewer leading zeros after the decimal) to get consistent results using Spatial operations.</p>
<p>A tolerance value is specified in two cases:</p>
<ul>
<li>
<p>In the geometry metadata definition for a layer (see <a href="#i884635">Section 1.5.5.1</a>)</p>
</li>
<li>
<p>As an input parameter to certain functions (see <a href="#i884646">Section 1.5.5.2</a>)</p>
</li>
</ul>
<p>For additional information about tolerance with linear referencing system (LRS) data, see <a href="sdo_lrs_concepts.htm#CIHJBDGG">Section 7.6</a>.</p>
<a id="i884635"></a>
<div id="SPATL451" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">1.5.5.1</span> Tolerance in the Geometry Metadata for a Layer</h4>
<p>The dimensional information for a layer includes a tolerance value. Specifically, the DIMINFO column (described in <a href="sdo_objrelschema.htm#i1010905">Section 2.8.3</a>) of the xxx_SDO_GEOM_METADATA views includes an SDO_TOLERANCE value for each dimension, and the value should be the same for each dimension.</p>
<p>If a function accepts an optional <code>tolerance</code> parameter and this parameter is null or not specified, the SDO_TOLERANCE value of the layer is used. Using the non-geodetic data from the example in <a href="sdo_objrelschema.htm#i1004750">Section 2.1</a>, the actual distance between geometries <code>cola_b</code> and <code>cola_d</code> is 0.846049894. If a query uses the <a href="sdo_objgeom.htm#i857957">SDO_GEOM.SDO_DISTANCE</a> function to return the distance between <code>cola_b</code> and <code>cola_d</code> and does not specify a <code>tolerance</code> parameter value, the result depends on the SDO_TOLERANCE value of the layer. For example:</p>
<ul>
<li>
<p>If the SDO_TOLERANCE value of the layer is 0.005, this query returns .846049894.</p>
</li>
<li>
<p>If the SDO_TOLERANCE value of the layer is 0.5, this query returns 0.</p>
<p>The zero result occurs because Spatial first constructs an imaginary buffer of the tolerance value (0.5) around each geometry to be considered, and the buffers around <code>cola_b</code> and <code>cola_d</code> overlap in this case. (If the two geometries being considered have different tolerance values, the higher value is used for the imaginary buffer.)</p>
</li>
</ul>
<p>You can, therefore, take either of two approaches in selecting an SDO_TOLERANCE value for a layer:</p>
<ul>
<li>
<p>The value can reflect the desired level of precision in queries for distances between objects. For example, if two non-geodetic geometries 0.8 units apart should be considered as separated, specify a small SDO_TOLERANCE value such as 0.05 or smaller.</p>
</li>
<li>
<p>The value can reflect the precision of the values associated with geometries in the layer. For example, if all geometries in a non-geodetic layer are defined using integers and if two objects 0.8 units apart should not be considered as separated, an SDO_TOLERANCE value of 0.5 is appropriate. To have greater precision in any query, you must override the default by specifying the <code>tolerance</code> parameter.</p>
</li>
</ul>
<p>With non-geodetic data, the guideline to follow for most instances of the second case (precision of the values of the geometries in the layer) is: take the highest level of precision in the geometry definitions, and use .5 at the next level as the SDO_TOLERANCE value. For example, if geometries are defined using integers (as in the simplified example in <a href="sdo_objrelschema.htm#i1004750">Section 2.1</a>), the appropriate value is 0.5; however, if geometries are defined using numbers up to four decimal positions (for example, 31.2587), the appropriate value is 0.00005.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This guideline should not be used if the geometries include any polygons that are so narrow at any point that the distance between facing sides is less than the proposed tolerance value. Be sure that the tolerance value is less than the shortest distance between any two sides in any polygon.
<p>Moreover, if you encounter "invalid geometry" errors with inserted or updated geometries, and if the geometries are in fact valid, consider increasing the precision of the tolerance value (for example, changing 0.00005 to 0.000005).</p>
</div>
</div>
<!-- class="sect3" -->
<a id="i884646"></a>
<div id="SPATL452" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">1.5.5.2</span> Tolerance as an Input Parameter</h4>
<p>Many Spatial functions accept a <code>tolerance</code> parameter, which (if specified) overrides the default tolerance value for the layer (explained in <a href="#i884635">Section 1.5.5.1</a>). If the distance between two points is less than or equal to the tolerance value, Spatial considers the two points to be a single point. Thus, tolerance is usually a reflection of how accurate or precise users perceive their spatial data to be.</p>
<p>For example, assume that you want to know which restaurants are within 5 kilometers of your house. Assume also that Maria's Pizzeria is 5.1 kilometers from your house. If the spatial data has a geodetic coordinate system and if you ask, <span class="italic">Find all restaurants within 5 kilometers and use a tolerance of 100</span> (or greater, such as 500), Maria's Pizzeria will be included, because 5.1 kilometers (5100 meters) is within 100 meters of 5 kilometers (5000 meters). However, if you specify a tolerance less than 100 (such as 50), Maria's Pizzeria will not be included.</p>
<p>Tolerance values for Spatial functions are typically very small, although the best value in each case depends on the kinds of applications that use or will use the data. See also the tolerance guidelines in <a href="#i884635">Section 1.5.5.1</a>, and ensure that all input geometries are valid. (Spatial functions may not work as expected if the geometry data is not valid.)</p>
<p>If you explicitly want to use the tolerance value from the dimensional information array for the geometry layer, and if a subprogram has separate formats with <code>tolerance</code> (or <code>tol</code>) and <code>dim</code> parameters, use the format with <code>dim</code>. In the following example, the first statement uses the tolerance value from the dimensional information array, and the second statement specifies a numeric tolerance value (0.005):</p>
<pre>
-- Return the area of the cola_a geometry.
 
SELECT c.name, SDO_GEOM.SDO_AREA(c.shape, m.diminfo) 
  FROM cola_markets c, user_sdo_geom_metadata m 
  WHERE m.table_name = 'COLA_MARKETS' AND m.column_name = 'SHAPE' 
  AND c.name = 'cola_a';
 
SELECT c.name, SDO_GEOM.SDO_AREA(c.shape, 0.005) FROM cola_markets c 
   WHERE c.name = 'cola_a';
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="g1000087"></a>
<div id="SPATL453" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.6</span> <a id="sthref61"></a><a id="sthref62"></a><a id="sthref63"></a>Query Model</h2>
<p><a id="sthref64"></a>Spatial uses a <span class="bold">two-tier query model</span> to resolve spatial queries and spatial joins. The term is used to indicate that two distinct operations are performed to resolve queries. The output of the two combined operations yields the exact result set.</p>
<p>The two operations are referred to as <span class="italic">primary</span> and <span class="italic">secondary</span> filter operations.</p>
<ul>
<li>
<p>The <span class="bold">primary filter</span> permits fast selection of candidate records to pass along to the secondary filter. The primary filter compares geometry approximations to reduce computation complexity and is considered a lower-cost filter. Because the primary filter compares geometric approximations, it returns a superset of the exact result set.</p>
</li>
<li>
<p>The <span class="bold">secondary filter</span> applies exact computations to geometries that result from the primary filter. The secondary filter yields an accurate answer to a spatial query. The secondary filter operation is computationally expensive, but it is only applied to the primary filter results, not the entire data set.</p>
</li>
</ul>
<p><a href="#i878085">Figure 1-2</a> illustrates the relationship between the primary and secondary filters.</p>
<div id="SPATL454" class="figure">
<p class="titleinfigure"><a id="i878085"></a>Figure 1-2 Query Model</p>
<img width="412" height="118" src="img/query.gif" alt="Description of Figure 1-2 follows" /><br />
<a id="sthref65" href="img_text/query.htm">Description of "Figure 1-2 Query Model"</a><br />
<br /></div>
<!-- class="figure" -->
<p>As shown in <a href="#i878085">Figure 1-2</a>, the primary filter operation on a large input data set produces a smaller candidate set, which contains at least the exact result set and may contain more records. The secondary filter operation on the smaller candidate set produces the exact result set.</p>
<p>Spatial uses a spatial index to implement the primary filter. Spatial does not require the use of both the primary and secondary filters. In some cases, just using the primary filter is sufficient. For example, a <span class="italic">zoom</span> feature in a mapping application queries for data that has any interaction with a rectangle representing visible boundaries. The primary filter very quickly returns a superset of the query. The mapping application can then apply clipping routines to display the target area.</p>
<p>The purpose of the primary filter is to quickly create a subset of the data and reduce the processing burden on the secondary filter. The primary filter, therefore, should be as efficient (that is, selective yet fast) as possible. This is determined by the characteristics of the spatial index on the data.</p>
<p>For more information about querying spatial data, see <a href="sdo_index_query.htm#g1010114">Section 5.2</a>.</p>
</div>
<!-- class="sect1" -->
<a id="i877656"></a>
<div id="SPATL455" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.7</span> Indexing of Spatial Data</h2>
<p><a id="sthref66"></a>The introduction of spatial indexing capabilities into the Oracle database engine is a key feature of the Spatial product. A spatial index, like any other index, provides a mechanism to limit searches, but in this case the mechanism is based on spatial criteria such as intersection and containment. A spatial index is needed to:</p>
<ul>
<li>
<p>Find objects within an indexed data space that interact with a given point or area of interest (window query)</p>
</li>
<li>
<p>Find pairs of objects from within two indexed data spaces that interact spatially with each other (spatial join)</p>
</li>
</ul>
<p>Testing of spatial indexes with many workloads and operators is ongoing, and results and recommendations will be documented as they become available.</p>
<p>The following sections explain the concepts and options associated with R-tree indexing.</p>
<a id="i883140"></a>
<div id="SPATL456" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.7.1</span> R-Tree Indexing</h3>
<p><a id="sthref67"></a><a id="sthref68"></a>A spatial R-tree index can index spatial data of up to four dimensions. An R-tree index approximates each geometry by a single rectangle that minimally encloses the geometry (called the minimum bounding rectangle, or MBR), as shown in <a href="#i884362">Figure 1-3</a>.</p>
<div id="SPATL457" class="figure">
<p class="titleinfigure"><a id="i884362"></a>Figure 1-3 MBR Enclosing a Geometry</p>
<img width="138" height="54" src="img/rt_mbr.gif" alt="Description of Figure 1-3 follows" /><br />
<a id="sthref69" href="img_text/rt_mbr.htm">Description of "Figure 1-3 MBR Enclosing a Geometry"</a><br />
<br /></div>
<!-- class="figure" -->
<p>For a layer of geometries, an R-tree index consists of a hierarchical index on the MBRs of the geometries in the layer, as shown in <a href="#i884377">Figure 1-4</a>.</p>
<div id="SPATL458" class="figure">
<p class="titleinfigure"><a id="i884377"></a>Figure 1-4 R-Tree Hierarchical Index on MBRs</p>
<img width="307" height="110" src="img/rt_tree.gif" alt="Description of Figure 1-4 follows" /><br />
<a id="sthref70" href="img_text/rt_tree.htm">Description of "Figure 1-4 R-Tree Hierarchical Index on MBRs"</a><br />
<br /></div>
<!-- class="figure" -->
<p>In <a href="#i884377">Figure 1-4</a>:</p>
<ul>
<li>
<p><span class="italic">1</span> through <span class="italic">9</span> are geometries in a layer.</p>
</li>
<li>
<p><span class="italic">a</span>, <span class="italic">b</span>, <span class="italic">c</span>, and <span class="italic">d</span> are the leaf nodes of the R-tree index, and contain minimum bounding rectangles of geometries, along with pointers to the geometries. For example, <span class="italic">a</span> contains the MBR of geometries <span class="italic">1</span> and <span class="italic">2</span>, <span class="italic">b</span> contains the MBR of geometries <span class="italic">3</span> and <span class="italic">4</span>, and so on.</p>
</li>
<li>
<p><span class="italic">A</span> contains the MBR of <span class="italic">a</span> and <span class="italic">b</span>, and <span class="italic">B</span> contains the MBR of <span class="italic">c</span> and <span class="italic">d</span>.</p>
</li>
<li>
<p>The root contains the MBR of <span class="italic">A</span> and <span class="italic">B</span> (that is, the entire area shown).</p>
</li>
</ul>
<p>An R-tree index is stored in the spatial index table (SDO_INDEX_TABLE in the USER_SDO_INDEX_METADATA view, described in <a href="sdo_objrelschema.htm#i1001420">Section 2.9</a>). The R-tree index also maintains a sequence object (SDO_RTREE_SEQ_NAME in the USER_SDO_INDEX_METADATA view) to ensure that simultaneous updates by concurrent users can be made to the index.</p>
</div>
<!-- class="sect2" -->
<a id="BAJIAJJC"></a>
<div id="SPATL459" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.7.2</span> <a id="sthref71"></a><a id="sthref72"></a>R-Tree Quality</h3>
<p>A substantial number of insert and delete operations affecting an R-tree index may degrade the quality of the R-tree structure, which may adversely affect query performance.</p>
<p>The R-tree is a hierarchical tree structure with nodes at different heights of the tree. The performance of an R-tree index structure for queries is roughly proportional to the area and perimeter of the index nodes of the R-tree. The area covered at level 0 represents the area occupied by the minimum bounding rectangles of the data geometries, the area at level 1 indicates the area covered by leaf-level R-tree nodes, and so on. The original ratio of the area at the root (topmost level) to the area at level 0 can change over time based on updates to the table; and if there is a degradation in that ratio (that is, if it increases significantly), rebuilding the index may help the performance of queries.</p>
<p>If the performance of <a href="sdo_operat.htm#BJAFBCFC">SDO_FILTER</a> operations has degraded, and if there have been a large number of insert, update, or delete operations affecting geometries, the performance degradation may be due to a degradation in the quality of the associated R-tree index. You can check for degradation of index quality by using the <a href="sdo_objtune.htm#CACHEDCG">SDO_TUNE.QUALITY_DEGRADATION</a> function (described in <a href="sdo_objtune.htm#g1000942">Chapter 31</a>); and if the function returns a number greater than 2, consider rebuilding the index. Note, however, that the R-tree index quality degradation number may not be significant in terms of overall query performance due to Oracle caching strategies and other significant Oracle capabilities, such as table pinning, which can essentially remove I/O overhead from R-tree index queries.</p>
<p>To rebuild an R-tree index, use the <a href="sdo_objindex.htm#i78198">ALTER INDEX REBUILD</a> statement, which is described in <a href="sdo_objindex.htm#g999465">Chapter 18</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i880253"></a>
<div id="SPATL460" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.8</span> Spatial Relationships and Filtering</h2>
<p>Spatial uses secondary filters to determine the spatial relationship between entities in the database. The spatial relationship is based on geometry locations. The most common spatial relationships are based on topology and distance. <a id="sthref73"></a>For example, the <span class="italic">boundary</span> of an area consists of a set of curves that separates the area from the rest of the coordinate space. <a id="sthref74"></a>The <span class="italic">interior</span> of an area consists of all points in the area that are not on its boundary. Given this, two areas are said to be adjacent if they share part of a boundary but do not share any points in their interior.</p>
<p>The distance between two spatial objects is the minimum distance between any points in them. Two objects are said to be <span class="italic">within a given distance</span> of one another if their distance is less than the given distance.</p>
<p>To determine spatial relationships, Spatial has several secondary filter methods:</p>
<ul>
<li>
<p>The <a href="sdo_operat.htm#i78531">SDO_RELATE</a> operator evaluates topological criteria.</p>
</li>
<li>
<p>The <a href="sdo_operat.htm#i77653">SDO_WITHIN_DISTANCE</a> operator determines if two spatial objects are within a specified distance of each other.</p>
</li>
<li>
<p>The <a href="sdo_operat.htm#i78067">SDO_NN</a> operator identifies the nearest neighbors for a spatial object.</p>
</li>
</ul>
<p>The syntax of these operators is given in <a href="sdo_operat.htm#g1001037">Chapter 19</a>.</p>
<p>The <a href="sdo_operat.htm#i78531">SDO_RELATE</a> operator implements a nine-intersection model for categorizing binary topological relationships between points, lines, and polygons. Each spatial object has an interior, a boundary, and an exterior. <a id="sthref75"></a><a id="sthref76"></a>The boundary consists of points or lines that separate the interior from the exterior. The boundary of a line string consists of its end points; however, if the end points overlap (that is, if they are the same point), the line string has no boundary. <a id="sthref77"></a><a id="sthref78"></a>The boundaries of a multiline string are the end points of each of the component line strings; however, if the end points overlap, only the end points that overlap an odd number of times are boundaries. <a id="sthref79"></a><a id="sthref80"></a>The boundary of a polygon is the line that describes its perimeter. The interior consists of points that are in the object but not on its boundary, and the exterior consists of those points that are not in the object and are not on its boundary.</p>
<p>Given that an object A has three components (a boundary Ab, an interior Ai, and an exterior Ae), any pair of objects has nine possible interactions between their components. Pairs of components have an empty (0) or not empty (1) set intersection. The set of interactions between two geometries is represented by a nine-intersection matrix that specifies which pairs of components intersect and which do not. <a href="#i879003">Figure 1-5</a> shows the nine-intersection matrix for two polygons that are adjacent to one another. This matrix yields the following bit mask, generated in row-major form: "101001111".</p>
<div id="SPATL461" class="figure">
<p class="titleinfigure"><a id="i879003"></a>Figure 1-5 The Nine-Intersection Model</p>
<img width="350" height="150" src="img/nine_inter.gif" alt="Description of Figure 1-5 follows" /><br />
<a id="sthref81" href="img_text/nine_inter.htm">Description of "Figure 1-5 The Nine-Intersection Model"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Some of the topological relationships identified in the seminal work by Professor Max Egenhofer (University of Maine, Orono) and colleagues have names associated with them. Spatial uses the following names:</p>
<ul>
<li>
<p><a id="sthref82"></a>DISJOINT: The boundaries and interiors do not intersect.</p>
</li>
<li>
<p><a id="sthref83"></a>TOUCH: The boundaries intersect but the interiors do not intersect.</p>
</li>
<li>
<p><a id="sthref84"></a>OVERLAPBDYDISJOINT: The interior of one object intersects the boundary and interior of the other object, but the two boundaries do not intersect. This relationship occurs, for example, when a line originates outside a polygon and ends inside that polygon.</p>
</li>
<li>
<p><a id="sthref85"></a>OVERLAPBDYINTERSECT: The boundaries and interiors of the two objects intersect.</p>
</li>
<li>
<p><a id="sthref86"></a>EQUAL: The two objects have the same boundary and interior.</p>
</li>
<li>
<p><a id="sthref87"></a>CONTAINS: The interior and boundary of one object is completely contained in the interior of the other object.</p>
</li>
<li>
<p><a id="sthref88"></a>COVERS: The interior of one object is completely contained in the interior or the boundary of the other object and their boundaries intersect.</p>
</li>
<li>
<p><a id="sthref89"></a>INSIDE: The opposite of CONTAINS. A INSIDE B implies B CONTAINS A.</p>
</li>
<li>
<p><a id="sthref90"></a>COVEREDBY: The opposite of COVERS. A COVEREDBY B implies B COVERS A.</p>
</li>
<li>
<p><a id="sthref91"></a>ON: The interior and boundary of one object is on the boundary of the other object. This relationship occurs, for example, when a line is on the boundary of a polygon.</p>
</li>
<li>
<p><a id="sthref92"></a><a id="sthref93"></a>ANYINTERACT: The objects are non-disjoint.</p>
</li>
</ul>
<p><a href="#i883562">Figure 1-6</a> illustrates these topological relationships.</p>
<div id="SPATL462" class="figure">
<p class="titleinfigure"><a id="i883562"></a>Figure 1-6 Topological Relationships</p>
<img width="343" height="270" src="img/top_rel.gif" alt="Description of Figure 1-6 follows" /><br />
<a id="sthref94" href="img_text/top_rel.htm">Description of "Figure 1-6 Topological Relationships"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The <a href="sdo_operat.htm#i77653">SDO_WITHIN_DISTANCE</a> operator determines if two spatial objects, A and B, are within a specified distance of one another. This operator first constructs a distance buffer, D<sub>b</sub>, around the reference object B. It then checks that A and D<sub>b</sub> are non-disjoint. The distance buffer of an object consists of all points within the given distance from that object. <a href="#i878990">Figure 1-7</a> shows the distance buffers for a point, a line, and a polygon.</p>
<div id="SPATL463" class="figure">
<p class="titleinfigure"><a id="i878990"></a>Figure 1-7 Distance Buffers for Points, Lines, and Polygons</p>
<img width="326" height="104" src="img/buffers.gif" alt="Description of Figure 1-7 follows" /><br />
<a id="sthref95" href="img_text/buffers.htm">Description of "Figure 1-7 Distance Buffers for Points, Lines, and Polygons"</a><br />
<br /></div>
<!-- class="figure" -->
<p>In the point, line, and polygon geometries shown in <a href="#i878990">Figure 1-7</a>:</p>
<ul>
<li>
<p>The dashed lines represent distance buffers. Notice how the buffer is rounded near the corners of the objects.</p>
</li>
<li>
<p>The geometry on the right is a polygon with a hole: the large rectangle is the exterior polygon ring and the small rectangle is the interior polygon ring (the hole). The dashed line outside the large rectangle is the buffer for the exterior ring, and the dashed line inside the small rectangle is the buffer for the interior ring.</p>
</li>
</ul>
<p>The <a href="sdo_operat.htm#i78067">SDO_NN</a> operator returns a specified number of objects from a geometry column that are closest to a specified geometry (for example, the five closest restaurants to a city park). In determining how close two geometry objects are, the shortest possible distance between any two points on the surface of each object is used.</p>
</div>
<!-- class="sect1" -->
<a id="BAJDEGDH"></a>
<div id="SPATL464" class="sect1">
<h2 class="sect1"><span class="secnum">1.9</span> <a id="sthref96"></a>Spatial Operators, Procedures, and Functions</h2>
<p>The Spatial PL/SQL application programming interface (API) includes several operators and many procedures and functions.</p>
<p>Spatial operators, such as <a href="sdo_operat.htm#BJAFBCFC">SDO_FILTER</a> and <a href="sdo_operat.htm#i78531">SDO_RELATE</a>, provide optimum performance because they use the spatial index. (Spatial operators require that the geometry column in the first parameter have a spatial index defined on it.) Spatial operators must be used in the WHERE clause of a query. The first parameter of any operator specifies the geometry column to be searched, and the second parameter specifies a query window. If the query window does not have the same coordinate system as the geometry column, Spatial performs an implicit coordinate system transformation. For detailed information about the spatial operators, see <a href="sdo_operat.htm#g1001037">Chapter 19</a>.</p>
<p>Spatial procedures and functions are provided as subprograms in PL/SQL packages, such as SDO_GEOM, SDO_CS, and SDO_LRS. These subprograms do not require that a spatial index be defined, and they do not use a spatial index if it is defined. These subprograms can be used in the WHERE clause or in a subquery. If two geometries are input parameters to a Spatial procedure or function, both must have the same coordinate system.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For any numbers in string (VARCHAR2) parameters to Spatial and Graph operators and subprograms, the period (.) must be used for any decimal points regardless of the locale. Example: <code>'distance=3.7'</code></div>
<p><a id="sthref97"></a><a id="sthref98"></a><a id="sthref99"></a>The following performance-related guidelines apply to the use of spatial operators, procedures, and functions:</p>
<ul>
<li>
<p>If an operator and a procedure or function perform comparable operations, and if the operator satisfies your requirements, use the operator. For example, unless you need to do otherwise, use <a href="sdo_operat.htm#i78531">SDO_RELATE</a> instead of <a href="sdo_objgeom.htm#BGHCDIDG">SDO_GEOM.RELATE</a>, and use <a href="sdo_operat.htm#i77653">SDO_WITHIN_DISTANCE</a> instead of <a href="sdo_objgeom.htm#i856373">SDO_GEOM.WITHIN_DISTANCE</a>.</p>
</li>
<li>
<p>With operators, always specify <code>TRUE</code> in uppercase. That is, specify <code>= 'TRUE'</code>, and do not specify <code>&lt;&gt; 'FALSE'</code> or <code>= 'true'</code>.</p>
</li>
<li>
<p><a id="sthref100"></a><a id="sthref101"></a><a id="sthref102"></a>With operators, use the <code>/*+ ORDERED */</code> optimizer hint if the query window comes from a table. (You must use this hint if multiple windows come from a table.) See the Usage Notes and Examples for specific operators for more information.</p>
</li>
</ul>
<p>For information about using operators with topologies, see <a class="olink TOPOL300" href="../../appdev.112/e11831/sdo_topo_concepts.htm#TOPOL300"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="i883627"></a>
<div id="SPATL465" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.10</span> Spatial <a id="sthref103"></a>Aggregate Functions</h2>
<p>SQL has long had aggregate functions, which are used to aggregate the results of a SQL query. The following example uses the SUM aggregate function to aggregate employee salaries by department:</p>
<pre>
SELECT SUM(salary), dept
   FROM employees
   GROUP BY dept;
</pre>
<p>Oracle Spatial aggregate functions aggregate the results of SQL queries involving geometry objects. Spatial aggregate functions return a geometry object of type SDO_GEOMETRY. For example, the following statement returns the minimum bounding rectangle of all geometries in a table (using the definitions and data from <a href="sdo_objrelschema.htm#i1004750">Section 2.1</a>):</p>
<pre>
SELECT SDO_AGGR_MBR(shape) FROM cola_markets;
</pre>
<p>The following example returns the union of all geometries except <code>cola_d</code>:</p>
<pre>
SELECT SDO_AGGR_UNION(SDOAGGRTYPE(c.shape, 0.005))
  FROM cola_markets c WHERE c.name &lt;&gt; 'cola_d';
</pre>
<p>For reference information about the spatial aggregate functions and examples of their use, see <a href="sdo_aggr.htm#g998149">Chapter 20</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Spatial aggregate functions are supported for two-dimensional geometries only, except for <a href="sdo_aggr.htm#i867160">SDO_AGGR_MBR</a>, which is supported for both two-dimensional and three-dimensional geometries.</div>
<a id="i885389"></a>
<div id="SPATL466" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.10.1</span> <a id="sthref104"></a><a id="sthref105"></a>SDOAGGRTYPE Object Type</h3>
<p>Many spatial aggregate functions accept an input parameter of type SDOAGGRTYPE. Oracle Spatial defines the object type SDOAGGRTYPE as:</p>
<pre>
CREATE TYPE sdoaggrtype AS OBJECT (
 geometry SDO_GEOMETRY,
 tolerance NUMBER);
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not use SDOAGGRTYPE as the data type for a column in a table. Use this type only in calls to spatial aggregate functions.</div>
<p>The <code>tolerance</code> value in the SDOAGGRTYPE definition should be the same as the SDO_TOLERANCE value specified in the DIMINFO column in the xxx_SDO_GEOM_METADATA views for the geometries, unless you have a specific reason for wanting a different value. For more information about tolerance, see <a href="#i884589">Section 1.5.5</a>; for information about the xxx_SDO_GEOM_METADATA views, see <a href="sdo_objrelschema.htm#i1001937">Section 2.8</a>.</p>
<p>The <code>tolerance</code> value in the SDOAGGRTYPE definition can affect the result of a spatial aggregate function. <a href="#i885315">Figure 1-8</a> shows a spatial aggregate union (<a href="sdo_aggr.htm#i867161">SDO_AGGR_UNION</a>) operation of two geometries using two different tolerance values: one smaller and one larger than the distance between the geometries.</p>
<div id="SPATL467" class="figure">
<p class="titleinfigure"><a id="i885315"></a>Figure 1-8 Tolerance in an Aggregate Union Operation</p>
<img width="294" height="157" src="img/tol_union.gif" alt="Description of Figure 1-8 follows" /><br />
<a id="sthref106" href="img_text/tol_union.htm">Description of "Figure 1-8 Tolerance in an Aggregate Union Operation"</a><br />
<br /></div>
<!-- class="figure" -->
<p>In the first aggregate union operation in <a href="#i885315">Figure 1-8</a>, where the tolerance is less than the distance between the rectangles, the result is a compound geometry consisting of two rectangles. In the second aggregate union operation, where the tolerance is greater than the distance between the rectangles, the result is a single geometry.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABIDJJB"></a>
<div id="SPATL468" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.11</span> <a id="sthref107"></a><a id="sthref108"></a>Three-Dimensional Spatial Objects</h2>
<p>Effective with Oracle Database Release 11.1, Oracle Spatial supports the storage and retrieval of three-dimensional spatial data, which can include points, point clouds (collections of points), lines, polygons, surfaces, and solids. <a href="#BABFDHDH">Table 1-1</a> show the SDO_GTYPE and element-related attributes of the SDO_GEOMETRY type that are relevant to three-dimensional geometries. (The SDO_GEOMETRY type is explained in <a href="sdo_objrelschema.htm#i1004087">Section 2.2</a>.)</p>
<div id="SPATL469" class="tblformal">
<p class="titleintable"><a id="sthref109"></a><a id="BABFDHDH"></a>Table 1-1 SDO_GEOMETRY Attributes for Three-Dimensional Geometries</p>
<table class="cellalignment740" title="SDO_GEOMETRY Attributes for Three-Dimensional Geometries" summary="SDO_GEOMETRY Attributes for Three-Dimensional Geometries" dir="ltr">
<thead>
<tr class="cellalignment734">
<th class="cellalignment741" id="r1c1-t7">Type of 3-D Data</th>
<th class="cellalignment741" id="r1c2-t7">SDO_GTYPE</th>
<th class="cellalignment741" id="r1c3-t7">Element Type, Interpretation in SDO_ELEM_INFO</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment734">
<td class="cellalignment742" id="r2c1-t7" headers="r1c1-t7">
<p>Point</p>
</td>
<td class="cellalignment742" headers="r2c1-t7 r1c2-t7">
<p>3001</p>
</td>
<td class="cellalignment742" headers="r2c1-t7 r1c3-t7">
<p>Does not apply. Specify all 3 dimension values in the SDO_POINT_TYPE attribute.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r3c1-t7" headers="r1c1-t7">
<p>Line</p>
</td>
<td class="cellalignment742" headers="r3c1-t7 r1c2-t7">
<p>3002</p>
</td>
<td class="cellalignment742" headers="r3c1-t7 r1c3-t7">
<p>2, 1</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r4c1-t7" headers="r1c1-t7">
<p>Polygon</p>
</td>
<td class="cellalignment742" headers="r4c1-t7 r1c2-t7">
<p>3003</p>
</td>
<td class="cellalignment742" headers="r4c1-t7 r1c3-t7">
<p>1003, 1: planar exterior polygon</p>
<p>2003, 1: planar interior polygon</p>
<p>1003, 3: planar exterior rectangle</p>
<p>2003, 3: planar interior rectangle</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r5c1-t7" headers="r1c1-t7">
<p>Surface</p>
</td>
<td class="cellalignment742" headers="r5c1-t7 r1c2-t7">
<p>3003</p>
</td>
<td class="cellalignment742" headers="r5c1-t7 r1c3-t7">
<p>1006, 1: surface (followed by element information for the polygons)</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r6c1-t7" headers="r1c1-t7">
<p>Collection</p>
</td>
<td class="cellalignment742" headers="r6c1-t7 r1c2-t7">
<p>3004</p>
</td>
<td class="cellalignment742" headers="r6c1-t7 r1c3-t7">
<p>Same considerations as for two-dimensional</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r7c1-t7" headers="r1c1-t7">
<p>Multipoint (point cloud)</p>
</td>
<td class="cellalignment742" headers="r7c1-t7 r1c2-t7">
<p>3005</p>
</td>
<td class="cellalignment742" headers="r7c1-t7 r1c3-t7">
<p>1, <span class="italic">n</span> (where <span class="italic">n</span> is the number of points)</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r8c1-t7" headers="r1c1-t7">
<p>Multiline</p>
</td>
<td class="cellalignment742" headers="r8c1-t7 r1c2-t7">
<p>3006</p>
</td>
<td class="cellalignment742" headers="r8c1-t7 r1c3-t7">
<p>Same considerations as for two-dimensional</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r9c1-t7" headers="r1c1-t7">
<p>Multisurface</p>
</td>
<td class="cellalignment742" headers="r9c1-t7 r1c2-t7">
<p>3007</p>
</td>
<td class="cellalignment742" headers="r9c1-t7 r1c3-t7">
<p>Element definitions for one or more surfaces</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r10c1-t7" headers="r1c1-t7">
<p>Solid</p>
</td>
<td class="cellalignment742" headers="r10c1-t7 r1c2-t7">
<p>3008</p>
</td>
<td class="cellalignment742" headers="r10c1-t7 r1c3-t7">
<p>Simple solid formed by a single closed surface: one element type 1007, followed by one element type 1006 (the external surface) and optionally one or more element type 2006 (internal surfaces)</p>
<p>Composite solid formed by multiple adjacent simple solids: one element type 1008 (holding the count of simple solids), followed by any number of element type 1007 (each describing one simple solid)</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r11c1-t7" headers="r1c1-t7">
<p>Multisolid</p>
</td>
<td class="cellalignment742" headers="r11c1-t7 r1c2-t7">
<p>3009</p>
</td>
<td class="cellalignment742" headers="r11c1-t7 r1c3-t7">
<p>Element definitions for one or more simple solids (element type 1007) or composite solids (element type 1008)</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>The following Spatial operators consider all three dimensions in their computations:</p>
<ul>
<li>
<p><a href="sdo_operat.htm#BGEJHDGD">SDO_ANYINTERACT</a></p>
</li>
<li>
<p><a href="sdo_operat.htm#BJAFBCFC">SDO_FILTER</a></p>
</li>
<li>
<p><a href="sdo_operat.htm#BGEFABDH">SDO_INSIDE</a> (for solid geometries only)</p>
</li>
<li>
<p><a href="sdo_operat.htm#i78067">SDO_NN</a></p>
</li>
<li>
<p><a href="sdo_operat.htm#i77653">SDO_WITHIN_DISTANCE</a></p>
</li>
</ul>
<p>The other operators consider only the first two dimensions. For some of preceding operators the height information is ignored when dealing with geodetic data, as explained later in this section. (Spatial operators are described in <a href="sdo_operat.htm#g1001037">Chapter 19</a>.)</p>
<p>The <a href="sdo_objgeom.htm#CACHCHEH">SDO_GEOM.SDO_VOLUME</a> function applies only to solid geometries, which are by definition three-dimensional; however, this function cannot be used with geodetic data. (This function is described in <a href="sdo_objgeom.htm#BGHCIGBI">Chapter 24</a>.) For information about support for three-dimensional geometries with other SDO_GEOM subprograms, see the usage information after <a href="sdo_objgeom.htm#BGHGDBED">Table 24-1, "Geometry Subprograms"</a>.</p>
<p>For distance computations with three-dimensional geometries:</p>
<ul>
<li>
<p>If the data is geodetic (geographic 3D), the distance computations are done on the geodetic surface.</p>
</li>
<li>
<p>If the data is non-geodetic (projected or local), the distance computations are valid only if the unit of measure is the same for all three dimensions.</p>
</li>
</ul>
<p>To have any functions, procedures, or operators consider all three dimensions, you must specify <code>PARAMETERS ('sdo_indx_dims=3')</code> in the <a href="sdo_objindex.htm#i78196">CREATE INDEX</a> statement when you create the spatial index on a spatial table containing Geographic3D data (longitude, latitude, ellipsoidal height). If you do not specify that parameter in the <a href="sdo_objindex.htm#i78196">CREATE INDEX</a> statement, a two-dimensional index is created.</p>
<p>For Spatial functions, procedures, and operators that consider all three dimensions, distance and length computations correctly factor in the height or elevation. For example, consider two three-dimensional points, one at the origin of a Cartesian space (0,0,0), and the other at X=3 on the Y axis and a height (Z) of 4 (3,0,4).</p>
<ul>
<li>
<p>If the operation considers all three dimensions, the distance between the two points is 5. (Think of the hypotenuse of a 3-4-5 right triangle.)</p>
</li>
<li>
<p>If the operation considers only two dimensions, the distance between the two points is 3. (That is, the third dimension, or height, is ignored.)</p>
</li>
</ul>
<p>However, for the following operators and subprograms, when dealing with geodetic data, the distances with three-dimensional geometries are computed between the "ground" representations (for example, the longitude/latitude extent of the footprint of a building), and the height information is ignored:</p>
<ul>
<li>
<p><a href="sdo_operat.htm#i78067">SDO_NN</a> operator</p>
</li>
<li>
<p><a href="sdo_operat.htm#i77653">SDO_WITHIN_DISTANCE</a> operator</p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i857957">SDO_GEOM.SDO_DISTANCE</a> function</p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i856373">SDO_GEOM.WITHIN_DISTANCE</a> function</p>
</li>
</ul>
<p>For a two-dimensional query window with three-dimensional data, you can use the <a href="sdo_operat.htm#BJAFBCFC">SDO_FILTER</a> operator, but not any other spatial operators.</p>
<p>For examples of creating different types of three-dimensional spatial geometries, see <a href="sdo_objrelschema.htm#CBBGAJFH">Section 2.7.9</a>. That section also includes an example showing how to update the spatial metadata and create spatial indexes for three-dimensional geometries.</p>
<p>For information about support for three-dimensional coordinate reference systems, see <a href="sdo_cs_concepts.htm#CIHHDDDF">Section 6.5</a>.</p>
<p>Three-dimensional support does not apply to many spatial aggregate functions and PL/SQL packages and subprograms. The following are supported for two-dimensional geometries only:</p>
<ul>
<li>
<p>Spatial aggregate functions, except for <a href="sdo_aggr.htm#i867160">SDO_AGGR_MBR</a>, which is supported for both two-dimensional and three-dimensional geometries.</p>
</li>
<li>
<p>SDO_GEOM (geometry) subprograms, except for the following, which are supported for both two-dimensional and three-dimensional geometries:</p>
<ul>
<li>
<p><a href="sdo_objgeom.htm#BGHCDIDG">SDO_GEOM.RELATE</a> with the ANYINTERACT mask</p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i856247">SDO_GEOM.SDO_AREA</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i857957">SDO_GEOM.SDO_DISTANCE</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i856257">SDO_GEOM.SDO_LENGTH</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i866249">SDO_GEOM.SDO_MAX_MBR_ORDINATE</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i866042">SDO_GEOM.SDO_MBR</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i866250">SDO_GEOM.SDO_MIN_MBR_ORDINATE</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#CACHCHEH">SDO_GEOM.SDO_VOLUME</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#BGHFDDBF">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#BGHIAAIF">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a></p>
</li>
<li>
<p><a href="sdo_objgeom.htm#i856373">SDO_GEOM.WITHIN_DISTANCE</a></p>
</li>
</ul>
</li>
<li>
<p>SDO_SAM (spatial analysis and mining) subprograms</p>
</li>
<li>
<p><a href="sdo_objmigr.htm#i856634">SDO_MIGRATE.TO_CURRENT</a> procedure</p>
</li>
</ul>
<a id="BABJBBEB"></a>
<div id="SPATL470" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.11.1</span> <a id="sthref110"></a><a id="sthref111"></a><a id="sthref112"></a>Modeling Surfaces</h3>
<p>A surface contains an area but not a volume, and it can have two or three dimensions. A surface is often constructed by a set of planar regions.</p>
<p>Surfaces can be modeled as surface-type SDO_GEOMETRY objects or, if they are very large, as SDO_TIN objects. The surface-type in SDO_GEOMETRY can be an arbitrary surface defining a contiguous area bounded by adjacent three-dimensional polygons. The number of polygons in the SDO_GEOMETRY is limited by the number of ordinates that can be in the SDO_ORDINATES_ARRAY. An SDO_TIN object, on the other hand, models the surface as a network of triangles with no explicit limit on the number of triangles.</p>
<p><a id="sthref113"></a><a id="sthref114"></a>Surfaces are stored as a network of triangles, called triangulated irregular networks, or <span class="bold">TINs</span>. The TIN model represents a surface as a set of contiguous, non-overlapping triangles. Within each triangle the surface is represented by a plane. The triangles are made from a set of points called mass points. If mass points are carefully selected, the TIN represents an accurate representation of the model of the surface. Well-placed mass points occur where there is a major change in the shape of the surface, for example, at the peak of a mountain, the floor of a valley, or at the edge (top and bottom) of cliffs.</p>
<p>TINs are generally computed from a set of three-dimensional points specifying coordinate values in the longitude (x), latitude (y), and elevation (z) dimensions. Oracle TIN generation software uses the Delaunay triangulation algorithm, but it is not required that TIN data be formed using only Delaunay triangulation techniques.</p>
<p>The general process for working with a TIN is as follows:</p>
<ol>
<li>
<p>Initialize the TIN, using the <a href="sdo_tin_pkg_ref.htm#i855832">SDO_TIN_PKG.INIT</a> function.</p>
</li>
<li>
<p>Create the TIN, using the <a href="sdo_tin_pkg_ref.htm#CACJHFFD">SDO_TIN_PKG.CREATE_TIN</a> procedure.</p>
</li>
<li>
<p>As needed for queries, clip the TIN, using the <a href="sdo_tin_pkg_ref.htm#i855810">SDO_TIN_PKG.CLIP_TIN</a> function.</p>
</li>
<li>
<p>If necessary, use the <a href="sdo_tin_pkg_ref.htm#CACFHAAH">SDO_TIN_PKG.TO_GEOMETRY</a> function (for example, to convert the result of a clip operation into a single SDO_GEOMETRY object).</p>
</li>
</ol>
<p>The PL/SQL subprograms for working with TINs are described in <a href="sdo_tin_pkg_ref.htm#CACGDACE">Chapter 30</a>.</p>
<p>For a Java example of working with TINs, see the following files:</p>
<pre>
$ORACLE_HOME/md/demo/TIN/examples/java/README.txt
$ORACLE_HOME/md/demo/TIN/examples/java/readTIN.java
</pre></div>
<!-- class="sect2" -->
<a id="BABDBHDA"></a>
<div id="SPATL471" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.11.2</span> <a id="sthref115"></a><a id="sthref116"></a><a id="sthref117"></a><a id="sthref118"></a>Modeling Solids</h3>
<p>The simplest types of solids can be represented as cuboids, such as a cube or a brick. A more complex solid is a <span class="bold">frustum</span>, which is a pyramid formed by cutting a larger pyramid (with three or more faces) by a plane parallel to the base of that pyramid. Frustums can only be used as query windows to spatial operators. Frustums and cubes are typically modeled as solid-type SDO_GEOMETRY objects. <a href="#BABDBFII">Figure 1-9</a> shows a frustum as a query window, with two spatial objects at different distances from the view point.</p>
<div id="SPATL472" class="figure">
<p class="titleinfigure"><a id="BABDBFII"></a>Figure 1-9 Frustum as Query Window for Spatial Objects</p>
<img width="409" height="225" src="img/frustum_view.gif" alt="Description of Figure 1-9 follows" /><br />
<a id="sthref119" href="img_text/frustum_view.htm">Description of "Figure 1-9 Frustum as Query Window for Spatial Objects"</a><br />
<br /></div>
<!-- class="figure" -->
<p><a id="sthref120"></a><span class="bold">Point clouds</span>, which are large collections of points, can sometimes be used to model the shape or structure of solid and surface geometries. Most applications that use point cloud data contain one or both of the following kinds of spatial queries: queries based on location, and queries based on both location and visibility (that is, visibility queries).</p>
<p>Most applications that use point cloud data seek to minimize data transfer by retrieving objects based on their distance from a view point. For example, in <a href="#BABDBFII">Figure 1-9</a>, object B is farther from the view point than object A, and therefore the application might retrieve object A in great detail (high resolution) and object B in less detail (low resolution). In most scenarios, the number of objects increases significantly as the distance from the view point increases; and if farther objects are retrieved at lower resolutions than nearer objects, the number of bytes returned by the query and the rendering time for the objects decrease significantly.</p>
<p>The general process for working with a point cloud is as follows:</p>
<ol>
<li>
<p>Initialize the point cloud, using the <a href="sdo_pc_pkg_ref.htm#CHDGHFHC">SDO_PC_PKG.INIT</a> function.</p>
</li>
<li>
<p>Create the point cloud, using the <a href="sdo_pc_pkg_ref.htm#CHDBJJIH">SDO_PC_PKG.CREATE_PC</a> procedure.</p>
</li>
<li>
<p>As needed for queries, clip the point cloud, using the <a href="sdo_pc_pkg_ref.htm#CHDGAJDI">SDO_PC_PKG.CLIP_PC</a> function.</p>
</li>
<li>
<p>If necessary, use the <a href="sdo_pc_pkg_ref.htm#CHDFJJCA">SDO_PC_PKG.TO_GEOMETRY</a> function (for example, to convert the result of a clip operation into a single SDO_GEOMETRY object).</p>
</li>
</ol>
<p>The PL/SQL subprograms for working with point clouds are described in <a href="sdo_pc_pkg_ref.htm#CHDCEBBG">Chapter 28</a>.</p>
<p>For a Java example of working with point clouds, see the following files:</p>
<pre>
$ORACLE_HOME/md/demo/PointCloud/examples/java/README.txt
$ORACLE_HOME/md/demo/PointCloud/examples/java/readPointCloud.java
</pre></div>
<!-- class="sect2" -->
<a id="BABIIGCD"></a>
<div id="SPATL473" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.11.3</span> <a id="sthref121"></a><a id="sthref122"></a>Three-Dimensional Optimized Rectangles</h3>
<p><a id="sthref123"></a><a id="sthref124"></a>Instead of specifying all the vertices for a three-dimensional rectangle (a polygon in the shape of rectangle in three-dimensional space), you can represent the rectangle by specifying just the two corners corresponding to the minimum ordinate values (<span class="italic">min-corner</span>) and the maximum ordinate values (<span class="italic">max-corner</span>) for the X, Y, and Z dimensions.</p>
<p>The orientation of a three-dimensional rectangle defined in this way is as follows:</p>
<ul>
<li>
<p>If the rectangle is specified as <span class="italic">&lt;min-corner, max-corner&gt;</span>, the normal points in the positive direction of the perpendicular third dimension.</p>
</li>
<li>
<p>If the rectangle is specified as <span class="italic">&lt;max-corner, min-corner&gt;</span>, the normal points in the negative direction of the perpendicular third dimension.</p>
</li>
</ul>
<p>For example, if the rectangle is in the XY plane and the order of the vertices is <span class="italic">&lt;min-corner, max-corner&gt;</span>, the normal is along the positive Z-axis; but if the order is <span class="italic">&lt;max-corner, min-corner&gt;</span>, the normal is along the negative Z-axis.</p>
<p>Using these orientation rules for rectangles, you can specify the order of the <span class="italic">min-corner</span> and <span class="italic">max-corner</span> vertices for a rectangle appropriately so that the following requirements are met:</p>
<ul>
<li>
<p>The normal for each polygon in a solid always points outward from the solid when the rectangle is part of the solid.</p>
</li>
<li>
<p>An inner rectangle polygon is oriented in the reverse direction as its outer when the rectangle is part of a surface.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="SPATL1405" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref125"></a>
<h3 class="sect2"><span class="secnum">1.11.4</span> <a id="sthref126"></a>Using Texture Data</h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
This section describes concepts that you will need to understand for using texture data with Spatial. However, the texture metadata is not yet fully implemented in Oracle Spatial, and a viewer is not yet supported. This section will be updated when texture support is released.</div>
<p>A <span class="bold">texture</span> is an image that represents one or more parts of a feature. Textures are commonly used with visualizer applications (viewers) that display objects stored as spatial geometries. For example, a viewer might display an office building (three-dimensional solid) using textures, to allow a more realistic visualization than using just colors. Textures can be used with two-dimensional and three-dimensional geometries.</p>
<p>In the simplest case, a rectangular geometry can be draped with a texture bitmap. However, often only a sub-region of a texture bitmap is used, as in the following example cases:</p>
<ul>
<li>
<p>If the texture bitmap contains multiple sides of the same building, as well as the roof and rood gables. In this case, each bitmap portion is draped over one of the geometry faces.</p>
</li>
<li>
<p>If the texture bitmap represents a single panel or window on the building surface, and a geometric face represents a wall with 15 such panels or windows (five on each of three floors). In this case, the single texture bitmap is tiled 15 times over the face.</p>
</li>
<li>
<p>If the face is non-rectangular sub-faces, such as roof gables. In this case, only a portion (possible triangular) of the texture bitmap is used.</p>
</li>
</ul>
<p><a href="#BABBFEEH">Figure 1-10</a> shows a large rectangular surface that, when viewed, appears to consist of three textures, each of which is repeated multiple times in various places on the surface.</p>
<div id="SPATL1406" class="figure">
<p class="titleinfigure"><a id="BABBFEEH"></a>Figure 1-10 Faces and Textures</p>
<img width="423" height="389" src="img/textures_2.gif" alt="Description of Figure 1-10 follows" /><br />
<a id="sthref127" href="img_text/textures_2.htm">Description of "Figure 1-10 Faces and Textures"</a><br />
<br /></div>
<!-- class="figure" -->
<p>As shown in <a href="#BABBFEEH">Figure 1-10</a>:</p>
<ul>
<li>
<p>The entire image is a large surface that consists of 12 smaller rectangular faces (surface geometries), each of which can be represented by one of three images (labeled A, B, and C).</p>
</li>
<li>
<p>Three texture bitmaps (labeled A, B, and C) can be used to visualize all of the faces. In this case, bitmap A is used 3 times, bitmap B is used 6 times, and bitmap C is used 3 times.</p>
</li>
</ul>
<p><a href="#BABGHCCG">Figure 1-11</a> shows a texture bitmap mapped to a triangular face.</p>
<div id="SPATL1407" class="figure">
<p class="titleinfigure"><a id="BABGHCCG"></a>Figure 1-11 Texture Mapped to a Face</p>
<img width="348" height="132" src="img/textures_3.gif" alt="Description of Figure 1-11 follows" /><br />
<a id="sthref128" href="img_text/textures_3.htm">Description of "Figure 1-11 Texture Mapped to a Face"</a><br />
<br /></div>
<!-- class="figure" -->
<p>As shown in <a href="#BABGHCCG">Figure 1-11</a>:</p>
<ul>
<li>
<p>The face (surface geometry) is a triangle. (For example, a side or roof of a building may contain several occurrences of this face.)</p>
</li>
<li>
<p>The texture bitmap (image) is a rectangle, shown in the box in the middle.</p>
</li>
<li>
<p>A portion of the texture bitmap represents an image of the face. This portion is shown by a dashed line in the box on the right.</p>
<p>In your application, you will need to specify coordinates within the texture bitmap to map the appropriate portion to the face geometry.</p>
</li>
</ul>
<p>To minimize the storage requirements for image data representing surfaces, you should store images for only the distinct textures that will be needed. The data type for storing a texture is SDO_ORDINATE_ARRAY, which is used in the SDO_GEOMETRY type definition (explained in <a href="sdo_objrelschema.htm#i1004087">Section 2.2</a>).</p>
<p>For example, assume that the large surface in <a href="#BABBFEEH">Figure 1-10</a> has the following definition:</p>
<pre>
SDO_GEOMETRY(
  2003,  -- two-dimensional polygon
  NULL,
  NULL,
  SDO_ELEM_INFO_ARRAY(1,1003,1), -- one polygon (exterior polygon ring)
  SDO_ORDINATE_ARRAY(1,1. 1,13, 13,13, 1,13, 1,1)
)
</pre>
<p>Assume that you have a MY_TEXTURE_COORDINATES table with the following definition:</p>
<pre>
CREATE TABLE my_texture_coordinates (
  texture_coord_id NUMBER PRIMARY KEY,
  texture_name VARCHAR2(32),
  texture_coordinates SDO_ORDINATE_ARRAY);
</pre>
<p><a href="#BABGDAGE">Example 1-1</a> inserts three texture coordinate definitions into this table. For each texture, its coordinates reflect one of the appropriate smaller rectangles shown in <a href="#BABBFEEH">Figure 1-10</a>; however, you can choose any one of the appropriate rectangles for each texture. In <a href="#BABGDAGE">Example 1-1</a>, the SDO_ORDINATE_ARRAY definitions for each texture reflect a polygon near the top of <a href="#BABBFEEH">Figure 1-10</a>.</p>
<div id="SPATL1408" class="example">
<p class="titleinexample"><a id="BABGDAGE"></a>Example 1-1 Inserting Texture Coordinate Definitions</p>
<pre>
INSERT INTO my_texture_coordinates VALUES(
  1,
  'Texture_A',
   SDO_ORDINATE_ARRAY(1,9, 1,5, 5,12, 1,12, 1,9)
  );
 
INSERT INTO my_texture_coordinates VALUES(
  2,
  'Texture_B', 
  SDO_ORDINATE_ARRAY(5,9, 9,9, 9,12, 5,12, 5,9)
  );
 
INSERT INTO my_texture_coordinates VALUES(
  3,
  'Texture_C', 
  SDO_ORDINATE_ARRAY(1,12, 13,12, 13,13, 1,13, 1,12)
  );
</pre></div>
<!-- class="example" -->
<div id="SPATL1409" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref129"></a>
<h4 class="sect3"><span class="secnum">1.11.4.1</span> Schema Considerations with Texture Data</h4>
<p>Texture bitmaps (stored as BLOBs or as URLs in VARCHAR2 format) and texture coordinate arrays (stored using type SDO_ORDINATE_ARRAY) can be stored in the same table as the SDO_GEOMETRY column or in separate tables; however, especially for the texture bitmaps, it is usually better to use separate tables. Texture bitmaps are likely to be able to be shared among features (such as different office buildings), but texture coordinate definitions are less likely to be shareable among features. (For example, many office buildings may share the same general type of glass exterior, but few of the buildings have the same number of windows and floors. In designing your textures and applications, you must consider how many buildings use the same texture sub-region or drape the texture in the same size of repetitive matrix.)</p>
<p>An exception is a texture coordinate array that drapes an entire texture bitmap over a rectangular geometric face. In this case, the texture coordinate array can be specified as (0,0, 1,0, 1,1, 0,1, 1,1), defined by vertices "lower left", "lower right", "upper right", "upper left", and closing with "lower left". Many data sets use this texture coordinate array extensively, because they have primarily rectangular faces and they store one facade for each texture bitmap.</p>
<p>If you used separate tables, you could link them to the surface geometries using foreign keys, as in <a href="#BABFDAIF">Example 1-2</a>.</p>
<div id="SPATL1410" class="example">
<p class="titleinexample"><a id="BABFDAIF"></a>Example 1-2 Creating Tables for Texture Coordinates, Textures, and Surfaces</p>
<pre>
-- One row for each texture coordinates definition.
CREATE TABLE my_texture_coordinates (
  texture_coord_id NUMBER PRIMARY KEY,
  texture_coordinates SDO_ORDINATE_ARRAY);
 
-- One row for each texture.
CREATE TABLE my_textures(
  texture_id NUMBER PRIMARY KEY,
  texture BLOB);
 
-- One row for each surface (each individual "piece" of a 
-- potentially larger surface).
CREATE TABLE my_surfaces(
  surface_id NUMBER PRIMARY KEY,
  surface_geometry SDO_GEOMETRY,
  texture_id NUMBER,
  texture_coord_id NUMBER,
  CONSTRAINT texture_id_fk 
    FOREIGN KEY (texture_id) REFERENCES my_textures(texture_id),
  CONSTRAINT texture_coord_id_fk 
    FOREIGN KEY (texture_coord_id) REFERENCES 
      my_texture_coordinates(texture_coord_id));
</pre></div>
<!-- class="example" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABHEJBH"></a>
<div id="SPATL474" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">1.11.5</span> <a id="sthref130"></a>Validation Checks for Three-Dimensional Geometries</h3>
<p>The <a href="sdo_objgeom.htm#BGHFDDBF">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</a> and <a href="sdo_objgeom.htm#BGHIAAIF">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a> subprograms can validate two-dimensional and three-dimensional geometries. For a three-dimensional geometry, these subprograms perform any necessary checks on any two-dimensional geometries (see the Usage Notes for <a href="sdo_objgeom.htm#BGHFDDBF">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</a>) within the overall three-dimensional geometry, but also several checks specific to the three-dimensional nature of the overall object.</p>
<p>For a simple solid (one outer surface and any number of inner surfaces), these subprograms perform the following checks:</p>
<ul>
<li>
<p>Closedness: The solid must be closed.</p>
</li>
<li>
<p>Reachability: Each face of a solid must have a full-edge intersection with its neighboring faces, and all faces must be reachable from any face.</p>
</li>
<li>
<p>Inner-outer disjointedness: An inner surface must not intersect the outer surface at more than a point or a line; that is, there must be no overlapping areas with inner surfaces.</p>
</li>
<li>
<p>No surface patch: No additional surfaces can be defined on the surfaces that make up the solid.</p>
</li>
<li>
<p><a id="sthref131"></a><a id="sthref132"></a>Orientation: For all surfaces, the vertices must be aligned so that the normal vector (or surface normal, or "the normal") points to the outside of (away from) the outer solid. Thus, the volume of the outer solid must be greater than zero, and the volume of any inner solid must be less than zero.</p>
</li>
</ul>
<p>For a composite solid (one or more solids connected to each other), these subprograms perform the following checks:</p>
<ul>
<li>
<p>Connectedness: All solids of a composite solid must share at least one face.</p>
</li>
<li>
<p>Zero-volume intersections: Any intersections of the solids in a composite solid must have a volume of zero.</p>
</li>
</ul>
<p>For a multisolid (one or more solids, each of which is a simple or composite solid), these subprograms perform the following check:</p>
<ul>
<li>
<p>Disjointedness: Any two solids of a multisolid can share points or lines, but must not intersect in any other manner.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BGEJBDIJ"></a>
<div id="SPATL475" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.12</span> <a id="sthref133"></a>Geocoding</h2>
<p><span class="bold">Geocoding</span> is the process of converting tables of address data into standardized address, location, and possibly other data. The result of a geocoding operation includes the pair of longitude and latitude coordinates that correspond with the input address or location. For example, if the input address is <span class="italic">22 Monument Square, Concord, MA 01742</span>, the longitude and latitude coordinates in the result of the geocoding operation may be (depending on the geocoding data provider) -71.34937 and 42.46101, respectively.</p>
<p>Given a geocoded address, you can perform proximity or location queries using a spatial engine, such as Oracle Spatial, or demographic analysis using tools and data from Oracle's business partners. In addition, you can use geocoded data with other spatial data such as block group, postal code, and county code for association with demographic information. Results of analyses or queries can be presented as maps, in addition to tabular formats, using third-party software integrated with Oracle Spatial.</p>
<p>For conceptual and usage information about the geocoding capabilities of Oracle Spatial, see <a href="sdo_geocode_concepts.htm#CIHECECC">Chapter 11</a>. For reference information about the MDSYS.SDO_GCDR PL/SQL package, see <a href="sdo_geocode_ref.htm#CACCHBGE">Chapter 23</a>.</p>
</div>
<!-- class="sect1" -->
<a id="BAJHICEH"></a>
<div id="SPATL476" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.13</span> <a id="sthref134"></a>Spatial Java Application Programming Interface</h2>
<p>Oracle Spatial provides a Java application programming interface (API) that includes the following packages:</p>
<ul>
<li>
<p><code>oracle.spatial.geometry</code> provides support for the Spatial SQL SDO_GEOMETRY data type, which is documented in this guide.</p>
</li>
<li>
<p><code>oracle.spatial.georaster</code> provides support for the core GeoRaster features, which are documented in <a class="olink GEORS" href="../e11827/toc.htm"><span class="italic">Oracle Spatial GeoRaster Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.georaster.image</code> provides support for generating Java images from a GeoRaster object or subset of a GeoRaster object, and for processing the images. These features are documented in <a class="olink GEORS" href="../e11827/toc.htm"><span class="italic">Oracle Spatial GeoRaster Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.georaster.sql</code> provides support for wrapping the GeoRaster PL/SQL API, which is documented in <a class="olink GEORS" href="../e11827/toc.htm"><span class="italic">Oracle Spatial GeoRaster Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.network</code> provides support for the Oracle Spatial network data model, which is documented in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.network.lod</code> provides support for the load-on-demand (LOD) approach of network analysis in the Oracle Spatial network data model, which is documented in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.network.lod.config</code> provides support for the configuration of load-on-demand (LOD) network analysis in the Oracle Spatial network data model, which is documented in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.topo</code> provides support for the Oracle Spatial topology data model, which is documented in <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>.</p>
</li>
<li>
<p><code>oracle.spatial.util</code> provides classes that perform miscellaneous operations.</p>
</li>
</ul>
<p>For detailed reference information about the classes and interfaces in these packages, see <a class="olink SPAJV" href="../e11829/toc.htm"><span class="italic">Oracle Spatial Java API Reference</span></a> (Javadoc).</p>
<p>The Spatial Java class libraries are in <code>.jar</code> files under the <code>&lt;ORACLE_HOME&gt;/md/jlib/</code> directory.</p>
</div>
<!-- class="sect1" -->
<a id="BAJDECJC"></a>
<div id="SPATL477" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.14</span> <a id="sthref135"></a><a id="sthref136"></a><a id="sthref137"></a>Predefined User Accounts Created by Spatial</h2>
<p>During installation, Spatial creates user accounts that have the minimum privileges needed to perform their jobs. These accounts are created locked and expired; so if you need to use the accounts, you must unlock them. <a href="#BABDBJJA">Table 1-2</a> lists the predefined user accounts created by Spatial.</p>
<div id="SPATL478" class="tblformal">
<p class="titleintable"><a id="sthref138"></a><a id="BABDBJJA"></a>Table 1-2 Predefined User Accounts Created by Spatial</p>
<table class="cellalignment740" title="Predefined User Accounts Created by Spatial" summary="Predefined user accounts created by Spatial" dir="ltr">
<thead>
<tr class="cellalignment734">
<th class="cellalignment741" id="r1c1-t9">User Account</th>
<th class="cellalignment741" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment734">
<td class="cellalignment742" id="r2c1-t9" headers="r1c1-t9">
<p>MDDATA</p>
</td>
<td class="cellalignment742" headers="r2c1-t9 r1c2-t9">
<p>The schema used by Oracle Spatial for storing data used by geocoding and routing applications. This is the default schema for Oracle software that accesses geocoding and routing data.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r3c1-t9" headers="r1c1-t9">
<p>SPATIAL_CSW_ADMIN_USR</p>
</td>
<td class="cellalignment742" headers="r3c1-t9 r1c2-t9">
<p>The Catalog Services for the Web (CSW) account. It is used by the Oracle Spatial CSW cache manager to load all record type metadata and all record instances from the database into main memory for the record types that are cached.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r4c1-t9" headers="r1c1-t9">
<p>SPATIAL_WFS_ADMIN_USR</p>
</td>
<td class="cellalignment742" headers="r4c1-t9 r1c2-t9">
<p>The Web Feature Service (WFS) account. It is used by the Oracle Spatial WFS cache manager to load all feature type metadata and all feature instances from the database into main memory for the feature types that are cached.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>For information about Oracle Database predefined user accounts, including how to secure these accounts, see <a class="olink TDPSG20030" href="../../server.112/e10575/tdpsg_user_accounts.htm#TDPSG20030"><span class="italic">Oracle Database 2 Day + Security Guide</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="i885392"></a>
<div id="SPATL479" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.15</span> <a id="sthref139"></a><a id="sthref140"></a>Performance and Tuning Information</h2>
<p>Many factors can affect the performance of Oracle Spatial applications, such as the use of optimizer hints to influence the plan for query execution. This guide contains some information about performance and tuning where it is relevant to a particular topic. For example, <a href="#BAJIAJJC">Section 1.7.2</a> discusses R-tree quality and its possible effect on query performance, and <a href="#BAJDEGDH">Section 1.9</a> explains why spatial operators provide better performance than procedures and functions.</p>
<p>In addition, more Spatial performance and tuning information is available in one or more white papers through the Oracle Technology Network (OTN). That information is often more detailed than what is in this guide, and it is periodically updated as a result of internal testing and consultations with Spatial users. To find that information on the OTN, go to</p>
<p><code><a href="http://www.oracle.com/technetwork/database/options/spatialandgraph/">http://www.oracle.com/technetwork/database/options/spatialandgraph/</a></code></p>
<p>Look for material relevant to Spatial performance and tuning.</p>
</div>
<!-- class="sect1" -->
<a id="BABBFIHI"></a>
<div id="SPATL480" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.16</span> <a id="sthref141"></a><a id="sthref142"></a><a id="sthref143"></a>OGC and <a id="sthref144"></a><a id="sthref145"></a>ISO Compliance</h2>
<p>Oracle Spatial is conformant with Open Geospatial Consortium (OGC) Simple Features Specification 1.1.1 (Document 99-049), starting with Oracle Database release 10<span class="italic">g</span> (version 10.1.0.4). Conformance with the Geometry Types Implementation means that Oracle Spatial supports all the types, functions, and language constructs detailed in Section 3.2 of the specification.</p>
<p><a id="sthref146"></a>Synonyms are created to match all OGC function names except for <code>X(p Point)</code> and <code>Y(p Point)</code>. For these functions, you must use the names <code>OGC_X</code> and <code>OGC_Y</code> instead of just <code>X</code> and <code>Y</code>.</p>
<p>Oracle Spatial is conformant with the following International Organization for Standardization (ISO) standards:</p>
<ul>
<li>
<p>ISO 13249-3 SQL Multimedia and Application Packages - Part 3: Spatial</p>
</li>
<li>
<p>ISO 19101: Geographic information - Reference model (definition of terms and approach)</p>
</li>
<li>
<p>ISO 19109: Geographic information - Rules for application schema (called the General Feature Model)</p>
</li>
<li>
<p>ISO 19111: Geographic information - Spatial referencing by coordinates (also OGC Abstract specification for coordinate reference systems)</p>
</li>
<li>
<p>ISO 19118: Geographic information - Encoding (GML 2.1 and GML 3.1.1)</p>
</li>
<li>
<p>ISO 19107: Geographic information - Spatial schema (also OGC Abstract specification for Geometry)</p>
</li>
</ul>
<p>However, standards compliance testing for Oracle Spatial and Graph is ongoing, and compliance with more recent versions of standards or with new standards might be announced at any time. For current information about compliance with standards, see <code><a href="http://www.oracle.com/technetwork/database/options/spatialandgraph/documentation/">http://www.oracle.com/technetwork/database/options/spatialandgraph/documentation/</a></code>.</p>
</div>
<!-- class="sect1" -->
<a id="BAJIIFBA"></a>
<div id="SPATL481" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.17</span> <a id="sthref147"></a><a id="sthref148"></a><a id="sthref149"></a>Spatial Release (Version) Number</h2>
<p>To check which release of Spatial you are running, use the SDO_VERSION function. For example:</p>
<pre>
SELECT SDO_VERSION FROM DUAL;

SDO_VERSION
--------------------------------------------------------------------------------
11.2.0.2.0
</pre></div>
<!-- class="sect1" -->
<a id="BHCGIAII"></a>
<div id="SPATL1514" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.18</span> <a id="sthref150"></a><a id="sthref151"></a>Spatially Enabling a Table</h2>
<p>If you have a regular Oracle table without an SDO_GEOMETRY column, but containing location-related information (such as latitude/longitude values for points), you can <span class="italic">spatially enable</span> the table by adding an SDO_GEOMETRY column and using existing (and future) location-related information in records to populate the SDO_GEOMETRY column values.</p>
<p>The following are the basic steps for spatially enabling a regular table. They assume that the regular table has columns that contain location-related values associated with each record in the table.</p>
<ol>
<li>
<p>Alter the table to add a geometry (SDO_GEOMETRY) column.</p>
</li>
<li>
<p>Update the table to populate the SDO_GEOMETRY objects using existing location-related data values.</p>
</li>
<li>
<p>Update the spatial metadata (USER_SDO_GEOM_METADATA).</p>
</li>
<li>
<p>Create the spatial index on the table.</p>
</li>
</ol>
<p><a href="#BHCBBACD">Example 1-3</a> creates a table (CITY_POINTS) that initially does not contain an SDO_GEOMETRY column but does contain latitude and longitude values for each record (a point in or near a specified city). It spatially enables the table, updating the existing records to include the SDO_GEOMETRY information, and it also inserts new records and updates those.</p>
<div id="SPATL1515" class="example">
<p class="titleinexample"><a id="BHCBBACD"></a>Example 1-3 Spatially Enabling a Table</p>
<pre>
-- Original table without a spatial geometry column.
CREATE TABLE city_points (
  city_id NUMBER PRIMARY KEY,
  city_name VARCHAR2(25),
  latitude NUMBER,
  longitude NUMBER);
 
-- Original data for the table.
-- (The sample coordinates are for a random point in or near the city.)
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (1, 'Boston', 42.207905, -71.015625);
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (2, 'Raleigh', 35.634679, -78.618164);
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (3, 'San Francisco', 37.661791, -122.453613);
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (4, 'Memphis', 35.097140, -90.065918);
 
-- Add a spatial geometry column.
ALTER TABLE city_points ADD (shape SDO_GEOMETRY);
 
-- Update the table to populate geometry objects using existing
-- latutide and longitude coordinates.
UPDATE city_points SET shape = 
  SDO_GEOMETRY(
    2001,
    8307,
    SDO_POINT_TYPE(LONGITUDE, LATITUDE, NULL),
    NULL,
    NULL
   );
 
-- Update the spatial metadata.
INSERT INTO user_sdo_geom_metadata VALUES (
  'city_points',
  'SHAPE', 
  SDO_DIM_ARRAY(
    SDO_DIM_ELEMENT('Longitude',-180,180,0.5), 
    SDO_DIM_ELEMENT('Latitude',-90,90,0.5)
  ), 
  8307
);
 
-- Create the spatial index.
CREATE INDEX city_points_spatial_idx on city_points(SHAPE) 
  INDEXTYPE IS MDSYS.SPATIAL_INDEX;
 
-- Later, add new records to the table, using original INSERT format
-- (latitude and longitude, no spatial geometry object data).
-- Then update to include spatial geometry object information.
-- Tip: For efficiency, keep track of existing and new records, and use 
-- a WHERE clause to restrict the UPDATE to new records (not shown here).
 
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (5, 'Chicago', 41.848832, -87.648926);
INSERT INTO city_points (city_id, city_name, latitude, longitude)
  VALUES (6, 'Miami', 25.755043, -80.200195);
 
UPDATE city_points SET shape = 
  SDO_GEOMETRY(
    2001,
    8307,
    SDO_POINT_TYPE(LONGITUDE, LATITUDE, NULL),
    NULL,
    NULL
   );
</pre></div>
<!-- class="example" -->
<p>Notes on <a href="#BHCBBACD">Example 1-3</a>:</p>
<ul>
<li>
<p>It does not matter that the original table has the LATITUDE and LONGITUDE values in that order, as long as the column names are specified in the correct order in the geometry constructor (SDO_POINT in this case) in the UPDATE statement. (SDO_GEOMETRY objects have longitude first, then latitude for points.)</p>
</li>
<li>
<p>Geometry validation is not included in the example because validation is not relevant for points. However, if you spatially enable a table with other types of geometries, you should validate all initial and added geometries. (To perform validation, use <a href="sdo_objgeom.htm#BGHIAAIF">SDO_GEOM.VALIDATE_LAYER_WITH_CONTEXT</a> or <a href="sdo_objgeom.htm#BGHFDDBF">SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT</a>.)</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="sdo_objrelschema.htm#BGHFECGD">Chapter 2, "Spatial Data Types and Metadata"</a></p>
</li>
<li>
<p><a href="sdo_index_query.htm#g1010227">Chapter 5, "Indexing and Querying Spatial Data"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BHCEJFDI"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.19</span> <a id="sthref152"></a><a id="sthref153"></a><a id="sthref154"></a>Moving Spatial Metadata (MDSYS.MOVE_SDO)</h2>
<p>Database administrators (DBAs) can use the MDSYS.MOVE_SDO procedure to move all Oracle Spatial metadata tables to a specified target tablespace. By default, the Spatial metadata tables are created in the <code>SYSAUX</code> tablespace in Release 11.1 and later releases, and in the <code>SYSTEM</code> tablespace in releases before 11.1.</p>
<p>The MDSYS.MOVE_SDO procedure has the following syntax:</p>
<pre>
MDSYS.MOVE_SDO(
   target_tablespace_name IN VARCHAR2);
</pre>
<p>The required <code>target_tablespace_name</code> parameter specifies the name of the tablespace to which to move the Spatial metadata tables.</p>
<p>This procedure should be used only by DBAs.</p>
<p>During the move operation, all other Oracle Spatial capabilities are disabled.</p>
<p>The following example moves the Spatial metadata tables to the <code>SYSAUX</code> tablespace.</p>
<pre>
EXECUTE MDSYS.MOVE_SDO('SYSAUX');
</pre></div>
<!-- class="sect1" -->
<a id="BAJEJBCH"></a>
<div id="SPATL482" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.20</span> Spatial <a id="sthref155"></a><a id="sthref156"></a><a id="sthref157"></a>Application <a id="sthref158"></a><a id="sthref159"></a>Hardware Requirement Considerations</h2>
<p>This section discusses some general guidelines that affect the amount of disk storage space and CPU power needed for applications that use Oracle Spatial. These guidelines are intended to supplement, not replace, any other guidelines you use for general application sizing.</p>
<p>The following characteristics of spatial applications can affect the need for storage space and CPU power:</p>
<ul>
<li>
<p>Data volumes: The amount of storage space needed for spatial objects depends on their complexity (precision of representation and number of points for each object). For example, storing one million point objects takes less space than storing one million road segments or land parcels. Complex natural features such as coastlines, seismic fault lines, rivers, and land types can require significant storage space if they are stored at a high precision.</p>
</li>
<li>
<p>Query complexity: The CPU requirements for simple mapping queries, such as <span class="italic">Select all features in this rectangle</span>, are lower than for more complex queries, such as <span class="italic">Find all seismic fault lines that cross this coastline</span>.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BAJHCEAH"></a>
<div id="SPATL483" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.21</span> <a id="sthref160"></a><a id="sthref161"></a>Spatial Error Messages</h2>
<p>Spatial error messages are documented in <a class="olink ERRMG" href="../../server.112/e17766/toc.htm"><span class="italic">Oracle Database Error Messages</span></a>.</p>
<p>Oracle error message documentation is only available in HTML. If you only have access to the Oracle Documentation DVD, you can browse the error messages by range. Once you find the specific range, use your browser's "find in page" feature to locate the specific message. When connected to the Internet, you can search for a specific error message using the error message search feature of the Oracle online documentation.</p>
</div>
<!-- class="sect1" -->
<a id="BAJIEFCA"></a>
<div id="SPATL484" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.22</span> Spatial Examples</h2>
<p><a id="sthref162"></a>Oracle Spatial provides examples that you can use to reinforce your learning and to create models for coding certain operations. If you installed the demo files from the Oracle Database Examples media (see <a class="olink EXMPL" href="../../install.112/e24501/toc.htm"><span class="italic">Oracle Database Examples Installation Guide</span></a>), several examples are provided in the following directory:</p>
<pre>
<span class="italic">$ORACLE_HOME</span>/md/demo/examples
</pre>
<p><a id="sthref163"></a><a id="sthref164"></a><a id="sthref165"></a><a id="sthref166"></a><a id="sthref167"></a>The following files in that directory are helpful for applications that use the Oracle Call Interface (OCI):</p>
<ul>
<li>
<p><code>readgeom.c</code> and <code>readgeom.h</code></p>
</li>
<li>
<p><code>writegeom.c</code> and <code>writegeom.h</code></p>
</li>
</ul>
<p><a id="sthref168"></a><a id="sthref169"></a><a id="sthref170"></a><a id="sthref171"></a>This guide also includes many examples in SQL and PL/SQL. One or more examples are usually provided with the reference information for each function or procedure, and several simplified examples are provided that illustrate table and index creation, combinations of functions and procedures, and advanced features:</p>
<ul>
<li>
<p>Inserting, indexing, and querying spatial data (<a href="sdo_objrelschema.htm#i1004750">Section 2.1</a>)</p>
</li>
<li>
<p>Coordinate systems (spatial reference systems) (<a href="sdo_cs_concepts.htm#i889615">Section 6.13</a>)</p>
</li>
<li>
<p>Linear referencing system (LRS) (<a href="sdo_lrs_concepts.htm#i885918">Section 7.7</a>)</p>
</li>
<li>
<p>SDO_GEOMETRY objects in function-based indexes (<a href="sdo_exten.htm#i1005799">Section 9.2</a>)</p>
</li>
<li>
<p>Complex queries (<a href="sdo_complex_queries.htm#BEHEBIDJ">Appendix C</a>)</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABIECBB"></a>
<div id="SPATL485" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">1.23</span> README File for Spatial and Related Features</h2>
<p><a id="sthref172"></a>A <code>README.txt</code> file supplements the information in the following manuals: <span class="italic">Oracle Spatial Developer's Guide</span> (this manual), <a class="olink GEORS" href="../e11827/toc.htm"><span class="italic">Oracle Spatial GeoRaster Developer's Guide</span></a>, and <a class="olink TOPOL" href="../e11831/toc.htm"><span class="italic">Oracle Spatial Topology and Network Data Models Developer's Guide</span></a>. This file is located at:</p>
<pre>
<span class="italic">$ORACLE_HOME</span>/md/doc/README.txt
</pre></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment733">
<tr>
<td class="cellalignment742">
<table class="cellalignment738">
<tr>
<td class="cellalignment737"><a href="sdo_prtusage.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment737"><a href="sdo_objrelschema.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment744">
<table class="cellalignment736">
<tr>
<td class="cellalignment737"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment737"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment737"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment737"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment737"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment737"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
