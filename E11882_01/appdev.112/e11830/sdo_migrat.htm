<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Installation, Migration, Compatibility, and Upgrade</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 743" />
<meta name="description" content="Provides usage and reference information for indexing and storing spatial data and for developing spatial applications using Oracle Spatial and Graph and Oracle Locator." />
<meta name="dcterms.created" content="2013-11-26T3:11:52Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Spatial Developer's Guide" />
<meta name="dcterms.identifier" content="E11830-15" />
<meta name="dcterms.isVersionOf" content="SPATL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sdo_prtother.htm" title="Previous" type="text/html" />
<link rel="Next" href="sdo_locator.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e11830.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">46/51</span> <!-- End Header -->
<div id="SPATL320" class="appendix"><a id="g623863"></a> <a id="i621386"></a>
<h1 class="appendix"><span class="secnum">A</span> Installation, Migration, Compatibility, and Upgrade</h1>
<p><a id="sthref3031"></a><a id="sthref3032"></a><a id="sthref3033"></a><a id="sthref3034"></a>If you are upgrading to Oracle Database 11<span class="italic">g</span>, Oracle Spatial is automatically upgraded as part of the operation. For information about the upgrade procedure, see <a class="olink UPGRD" href="../../server.112/e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a>.</p>
<p><a id="sthref3035"></a>If you need to downgrade Spatial to the previous Oracle Database release, follow the instructions for downgrading a database back to the previous Oracle Database release in <a class="olink UPGRD007" href="../../server.112/e23633/downgrade.htm#UPGRD007"><span class="italic">Oracle Database Upgrade Guide</span></a>.</p>
<p>If you need to migrate spatial data from one database to another, see <a href="#BABHEAHG">Section A.1</a>.</p>
<p>If you use Oracle Spatial GeoRaster, see <a href="#CHDIGIJI">Section A.2</a>.</p>
<p>If you are using Spatial Web Feature Service (WFS) or Catalog Services for the Web (CSW) support, and if you have data from a previous release that was indexed using one or more SYS.XMLTABLEINDEX indexes, see <a href="#CHDEIGBF">Section A.3</a>.</p>
<p>If you need to support geometries with more than 1,048,576 ordinates, see <a href="#CHDBCHBG">Section A.4</a>.</p>
<a id="BABHEAHG"></a>
<div id="SPATL1517" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">A.1</span> <a id="sthref3036"></a><a id="sthref3037"></a>Migrating Spatial Data from One Database to Another</h2>
<p>Migrating spatial data refers to moving or copying Oracle Spatial and Graph geometry objects from one Oracle database to another. (The databases can have the same or different Oracle Database release numbers.)</p>
<p>If you are migrating spatial data using database links, export/import, Oracle Data Pump, or transportable tablespaces, the MDSYS schema must already exist in the destination database.</p>
<p>In limited situations you might also need to use the <a href="sdo_objmigr.htm#i856634">SDO_MIGRATE.TO_CURRENT</a> subprogram (described in <a href="sdo_objmigr.htm#g999102">Chapter 26</a>). See the Usage Notes for that subprogram.</p>
</div>
<!-- class="sect1" -->
<a id="CHDIGIJI"></a>
<div id="SPATL330" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">A.2</span> <a id="sthref3038"></a><a id="sthref3039"></a>Ensuring That GeoRaster Works Properly After an Installation or Upgrade</h2>
<p>To use the GeoRaster feature of Oracle Spatial, Oracle XML DB Repository must be installed properly. (In general, you should ensure that Oracle XML DB Repository is installed before you install Oracle Spatial.)</p>
<p>If Oracle Spatial has been installed (such as during an upgrade) but Oracle XML DB Repository is not installed, you need to install the Oracle XML DB Repository and reload related GeoRaster PL/SQL packages. In this case, follow these steps</p>
<ol>
<li>
<p>Install Oracle XML DB Repository.</p>
<p>For information about installing and uninstalling Oracle XML DB Repository, see <a class="olink ADXDB" href="../e23094/toc.htm"><span class="italic">Oracle XML DB Developer's Guide</span></a>.</p>
</li>
<li>
<p>Go to the <code><span class="codeinlineitalic">$ORACLE_HOME</span></code><code>/md/admin</code> directory.</p>
</li>
<li>
<p>Connect to the database as <code>SYS AS SYSDBA</code>.</p>
</li>
<li>
<p>Enter the following SQL statements:</p>
<pre>
ALTER SESSION SET CURRENT_SCHEMA=MDSYS;
@prvtgrs.plb
@sdogrxml.sql
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CHDEIGBF"></a>
<div id="SPATL1425" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">A.3</span> Index Maintenance Before and After an Upgrade (WFS and CSW)</h2>
<p>Effective with Release 11.2, the SYS.XMLTABLEINDEX index type is deprecated, and therefore the Spatial WFS and CSW <code>createXMLTableIndex</code> methods create indexes of type XDB.XMLINDEX instead of type SYS.XMLTABLEINDEX as in previous releases. However, if you have data from a previous release that was indexed using one or more SYS.XMLTABLEINDEX indexes, you must drop the associated indexes before the upgrade and re-create the indexes after the upgrade, as follows:</p>
<ol>
<li>
<p>Using Oracle Database Release 11.1, call the <code>dropXMLTableIndex</code> method (in <code>oracle.spatial.csw.CSWAdmin</code> or <code>oracle.spatial.wfs.WFSAdmin</code>, as appropriate depending on the application) to drop associated indexes.</p>
</li>
<li>
<p>Upgrade the database from Release 11.1 to Release 11.2.</p>
</li>
<li>
<p>Using Oracle Database Release 11.2, call the <code>createXMLTableIndex</code> (in <code>oracle.spatial.csw.CSWAdmin</code> or <code>oracle.spatial.wfs.WFSAdmin</code>, as appropriate depending on the application) to create indexes that were dropped in step 1.</p>
</li>
</ol>
<p>For information about Spatial Web Feature Service (WFS) support, see <a href="sdo_wfs.htm#CIHEFGJJ">Chapter 15</a>, and especially the following:</p>
<ul>
<li>
<p><code>createXMLTableIndex</code> method (<a href="sdo_wfs.htm#CIHDECAA">Section 15.4.1</a>)</p>
</li>
<li>
<p><code>dropXMLTableIndex</code> method (<a href="sdo_wfs.htm#CIHFIFCE">Section 15.4.3</a>)</p>
</li>
<li>
<p><code>getIsXMLTableIndexCreated</code> method (<a href="sdo_wfs.htm#CIHGADJE">Section 15.4.4</a>)</p>
</li>
<li>
<p><code>genXMLIndex</code> and <code>idxPaths</code> parameters of the <code>publishFeatureType</code> method (<a href="sdo_wfs.htm#CIHDDEHH">Section 15.4.7</a>)</p>
</li>
<li>
<p>setXMLTableIndexInfo method (<a href="sdo_wfs.htm#CIHHEFAA">Section 15.4.10</a>)</p>
</li>
</ul>
<p>For information about Spatial Catalog Services for the Web (CSW) support, see <a href="sdo_csw.htm#CEGJGDAI">Chapter 16</a>, and especially the following:</p>
<ul>
<li>
<p><code>createXMLTableIndex</code> method (<a href="sdo_csw.htm#CEGHEGIJ">Section 16.4.1</a>)</p>
</li>
<li>
<p><code>dropXMLTableIndex</code> method (<a href="sdo_csw.htm#CEGEFIGI">Section 16.4.6</a>)</p>
</li>
<li>
<p><code>getIsXMLTableIndexCreated</code> method (<a href="sdo_csw.htm#CEGGHDJG">Section 16.4.8</a>)</p>
</li>
<li>
<p><code>genXMLIndex</code> and <code>idxPaths</code> parameters of the <code>publishRecordType</code> method (<a href="sdo_csw.htm#CEGIDDHG">Section 16.4.12</a>)</p>
</li>
<li>
<p><code>setXMLTableIndexInfo</code> method (<a href="sdo_csw.htm#CEGFFICJ">Section 16.4.19</a>)</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDBCHBG"></a>
<div id="SPATL1426" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">A.4</span> Increasing the Size of Ordinate Arrays to Support Very Large Geometries</h2>
<p>If you need to support geometries with more than 1,048,576 ordinates, you must follow the instructions in this section. However, doing so involves significant extra work (running a script, migrating existing spatial data), some database downtime , and some considerations and restrictions. Therefore, you should not perform the actions in this section unless you need to.</p>
<p>To increase the size of ordinate arrays to support geometries with up to 10M ordinates, follow these steps:</p>
<ol>
<li>
<p>Ensure that no users are using any spatial tables or Oracle Spatial or Locator features.</p>
</li>
<li>
<p>Connect to the database as the SYS user with SYSDBA privileges (SYS AS SYSDBA, and enter the SYS account password when prompted).</p>
</li>
<li>
<p>Enter the following statement:</p>
<ul>
<li>
<p>Linux: <code>@$ORACLE_HOME/md/admin/sdoupggeom.sql</code></p>
</li>
<li>
<p>Windows: <code>@%ORACLE_HOME%\md\admin\sdoupggeom.sql</code></p>
</li>
</ul>
<p>One of the actions of the <code>sdoupggeom.sql</code> script is to automatically migrate all spatial data to accommodate the new SDO_ORDINATE_ARRAY definition. This script may take a long time to complete, and the amount of time will depend on the amount of spatial data that exists in the database.</p>
</li>
</ol>
<p>After you perform these steps, the following considerations and restrictions apply:</p>
<ul>
<li>
<p>Any existing transportable tablespaces that were created with the old SDO_ORDINATE_ARRAY definition will not work.</p>
</li>
<li>
<p>If an export file was created using the Original Export utility on a database with the old SDO_ORDINATE_ARRAY definition, and if that file needs to be imported into a database that is using the new SDO_ORDINATE_ARRAY definition, you must specify the <code>TOID_NOVALIDATE</code> flag with the Original Import utility, as in the following example:</p>
<pre>
imp scott/<span class="italic">&lt;password&gt;</span> file=states.dmp tables=states TOID_NOVALIDATE=MDSYS.SDO_GEOMETRY,MDSYS.SDO_ORDINATE_ARRAY,MDSYS.SDO_ELEM_INFO_ARRAY
</pre></li>
<li>
<p>If you plan to use Oracle Data Pump to import data after <code>sdoupggeom.sql</code> has been executed on a source database, you must also run <code>sdoupggeom.sql</code> on the target (destination) database after the import operation.</p>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment733">
<tr>
<td class="cellalignment742">
<table class="cellalignment738">
<tr>
<td class="cellalignment737"><a href="sdo_prtother.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment737"><a href="sdo_locator.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment744">
<table class="cellalignment736">
<tr>
<td class="cellalignment737"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment737"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment737"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment737"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment737"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment737"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
