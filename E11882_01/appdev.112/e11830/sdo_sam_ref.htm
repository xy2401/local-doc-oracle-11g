<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>SDO_SAM Package (Spatial Analysis and Mining)</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 743" />
<meta name="description" content="Provides usage and reference information for indexing and storing spatial data and for developing spatial applications using Oracle Spatial and Graph and Oracle Locator." />
<meta name="dcterms.created" content="2013-11-26T3:11:50Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Spatial Developer's Guide" />
<meta name="dcterms.identifier" content="E11830-15" />
<meta name="dcterms.isVersionOf" content="SPATL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sdo_pc_pkg_ref.htm" title="Previous" type="text/html" />
<link rel="Next" href="sdo_tin_pkg_ref.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e11830.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">39/51</span> <!-- End Header -->
<div id="SPATL190" class="chapter"><a id="CACIGDJJ"></a>
<h1 class="chapter"><span class="secnum">29</span> SDO_SAM Package (Spatial Analysis and Mining)</h1>
<p><a id="sthref2379"></a><a id="sthref2380"></a><a id="sthref2381"></a>The <a id="sthref2382"></a><a id="sthref2383"></a><a id="sthref2384"></a><a id="sthref2385"></a>MDSYS.SDO_SAM package contains subprograms for spatial analysis and data mining.</p>
<p>To use the subprograms in this chapter, you must understand the conceptual information about spatial analysis and data mining in <a href="sdo_sam_concepts.htm#CIHFJHFC">Chapter 8</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
SDO_SAM subprograms are supported for two-dimensional geometries only. They are not supported for three-dimensional geometries.</div>
<p><a href="#CACCGABG">Table 29-1</a> lists the spatial analysis and mining subprograms.</p>
<div id="SPATL1196" class="tblformal">
<p class="titleintable"><a id="sthref2386"></a><a id="CACCGABG"></a>Table 29-1 Subprograms for Spatial Analysis and Mining</p>
<table class="cellalignment740" title="Subprograms for Spatial Analysis and Mining" summary="Subprograms for Spatial Analysis and Mining" dir="ltr">
<thead>
<tr class="cellalignment734">
<th class="cellalignment741" id="r1c1-t3">Function</th>
<th class="cellalignment741" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment734">
<td class="cellalignment742" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#CACJAJDC">SDO_SAM.AGGREGATES_FOR_GEOMETRY</a></p>
</td>
<td class="cellalignment742" headers="r2c1-t3 r1c2-t3">
<p>Computes the thematic aggregate for a geometry.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r3c1-t3" headers="r1c1-t3">
<p><a href="#CACICHIG">SDO_SAM.AGGREGATES_FOR_LAYER</a></p>
</td>
<td class="cellalignment742" headers="r3c1-t3 r1c2-t3">
<p>Computes thematic aggregates for a layer of geometries.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r4c1-t3" headers="r1c1-t3">
<p><a href="#CACHBADC">SDO_SAM.BIN_GEOMETRY</a></p>
</td>
<td class="cellalignment742" headers="r4c1-t3 r1c2-t3">
<p>Computes the most-intersecting tile for a geometry.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r5c1-t3" headers="r1c1-t3">
<p><a href="#CACCEFIG">SDO_SAM.BIN_LAYER</a></p>
</td>
<td class="cellalignment742" headers="r5c1-t3 r1c2-t3">
<p>Assigns each location (and the corresponding row) in a data mining table to a spatial bin.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r6c1-t3" headers="r1c1-t3">
<p><a href="#CACBBFEF">SDO_SAM.COLOCATED_REFERENCE_FEATURES</a></p>
</td>
<td class="cellalignment742" headers="r6c1-t3 r1c2-t3">
<p>Performs a partial predicate-based join of tables, and materializes the join results into a table.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r7c1-t3" headers="r1c1-t3">
<p><a href="#CACFCAII">SDO_SAM.SIMPLIFY_GEOMETRY</a></p>
</td>
<td class="cellalignment742" headers="r7c1-t3 r1c2-t3">
<p>Simplifies a geometry.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r8c1-t3" headers="r1c1-t3">
<p><a href="#CACIGFHG">SDO_SAM.SIMPLIFY_LAYER</a></p>
</td>
<td class="cellalignment742" headers="r8c1-t3 r1c2-t3">
<p>Simplifies a geometry layer.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r9c1-t3" headers="r1c1-t3">
<p><a href="#CACBFDJE">SDO_SAM.SPATIAL_CLUSTERS</a></p>
</td>
<td class="cellalignment742" headers="r9c1-t3 r1c2-t3">
<p>Computes clusters using the existing R-tree index, and returns a set of SDO_REGION objects where the geometry column specifies the boundary of each cluster and the <code>geometry_key</code> value is set to null.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r10c1-t3" headers="r1c1-t3">
<p><a href="#CACDIGED">SDO_SAM.TILED_AGGREGATES</a></p>
</td>
<td class="cellalignment742" headers="r10c1-t3 r1c2-t3">
<p>Tiles aggregates for a domain. For each tile, computes the intersecting geometries from the theme table; the values in the <code>aggr_col_string</code> column are weighted proportionally to the area of the intersection, and aggregated according to <code>aggr_col_string</code>.</p>
</td>
</tr>
<tr class="cellalignment734">
<td class="cellalignment742" id="r11c1-t3" headers="r1c1-t3">
<p><a href="#CACFBBFF">SDO_SAM.TILED_BINS</a></p>
</td>
<td class="cellalignment742" headers="r11c1-t3 r1c2-t3">
<p>Tiles a two-dimensional space and returns geometries corresponding to those tiles.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>The rest of this chapter provides reference information on the spatial analysis and mining subprograms, listed in alphabetical order.</p>
<div class="refentry"><a id="CACJAJDC"></a>
<div id="SPATL1197" class="refsect1">
<h2 class="refsect1"><a id="sthref2387"></a><a id="sthref2388"></a>SDO_SAM.AGGREGATES_FOR_GEOMETRY</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2389"></a>Format</p>
<p class="synopsis">SDO_SAM.AGGREGATES_FOR_GEOMETRY(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_name IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_type_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_col_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom IN SDO_GEOMETRY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_spec IN VARCHAR2 DEFAULT NULL</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN NUMBER;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2390"></a>Description</p>
<p>Computes the thematic aggregate for a geometry.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2391"></a>Parameters</p>
<dl>
<dt>theme_name</dt>
<dd>
<p>Name of the theme table.</p>
</dd>
<dt>theme_colname</dt>
<dd>
<p>Name of the geometry column in <code>theme_name</code>.</p>
</dd>
<dt>aggr_type_string</dt>
<dd>
<p>Any Oracle SQL aggregate function that accepts one or more numeric values and computes a numeric value, such as <code>SUM</code>, <code>MIN</code>, <code>MAX</code>, or <code>AVG</code>.</p>
</dd>
<dt>aggr_col_string</dt>
<dd>
<p>Name of a column in <code>theme_name</code> on which to compute aggregate values, as explained in the Usage Notes. An example might be a POPULATION column.</p>
</dd>
<dt>geom</dt>
<dd>
<p>Geometry object.</p>
</dd>
<dt>dst_spec</dt>
<dd>
<p>A quoted string specifying either a distance buffer or a number of nearest neighbor geometries to consider. See the Usage Notes for an explanation of the format and meaning.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2392"></a>Usage Notes</p>
<p>For a specific geometry, this function identifies the geometries in the <code>theme_name</code> table, finds their intersection ratio, multiplies the specified aggregate using this intersection ratio, and aggregates it for the geometry. Specifically, for all rows of the <code>theme_name</code> table that intersect with the specified geometry, it returns the value from the following function:</p>
<pre>
aggr_type_string(aggr_col_string * proportional_area_of_intersection(geometry, theme_name.theme_colname))
</pre>
<p>The <code>theme_colname</code> column must have a spatial index defined on it. For best performance, insert simplified geometries into this column.</p>
<p>The <code>dst_spec</code> parameter, if specified, is a quoted string that must contain either of the following:</p>
<ul>
<li>
<p>The <code>distance</code> keyword and optionally the <code>unit</code> keyword (unit of measurement associated with the distance value), to specify a buffer around the geometry. For example, <code>'distance=2 unit=km'</code> specifies a 2-kilometer buffer around the input geometry. If <code>dst_spec</code> is not specified, no buffer is used.</p>
<p>If the <code>unit</code> keyword is specified, the value must be an SDO_UNIT value from the MDSYS.SDO_DIST_UNITS table (for example, <code>'unit=km'</code>). If the <code>unit</code> keyword is not specified, the unit of measurement associated with the geometry is used. See <a href="sdo_objrelschema.htm#i1010145">Section 2.10</a> for more information about unit of measurement specification.</p>
</li>
<li>
<p>The <code>sdo_num_res</code> keyword, to specify the number of nearest-neighbor geometries to consider, without considering proportional coverage. For example, <code>'sdo_num_res=5'</code> could be used in a query that asks for the populations of the five cities that are nearest to a specified point.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2393"></a>Examples</p>
<p>The following example computes the thematic aggregate for an area with a 3-mile radius around a specified point geometry. In this case, the total population of the area is computed based on the proportion of the circle's area within different counties, assuming uniform distribution of population within the counties.</p>
<pre>
SELECT sdo_sam.aggregates_for_geometry(
  'GEOD_COUNTIES', 'GEOM',
  'sum', 'totpop',
  SDO_GEOMETRY(2001, 8307,
    SDO_POINT_TYPE(-73.943849, 40.6698,NULL),
    NULL, NULL),
  'distance=3 unit=mile')
FROM DUAL a ;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACICHIG"></a>
<div id="SPATL1198" class="refsect1">
<h2 class="refsect1"><a id="sthref2394"></a><a id="sthref2395"></a>SDO_SAM.AGGREGATES_FOR_LAYER</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2396"></a>Format</p>
<p class="synopsis">SDO_SAM.AGGREGATES_FOR_LAYER(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_name IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_type_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_col_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_spec IN VARCHAR2 DEFAULT NULL</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_REGAGGRSET;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2397"></a>Description</p>
<p>Computes thematic aggregates for a layer of geometries.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2398"></a>Parameters</p>
<dl>
<dt>theme_name</dt>
<dd>
<p>Name of the theme table.</p>
</dd>
<dt>theme_colname</dt>
<dd>
<p>Name of the geometry column in <code>theme_name</code>.</p>
</dd>
<dt>aggr_type_string</dt>
<dd>
<p>Any Oracle SQL aggregate function that accepts one or more numeric values and computes a numeric value, such as <code>SUM</code>, <code>MIN</code>, <code>MAX</code>, or <code>AVG</code>.</p>
</dd>
<dt>aggr_col_string</dt>
<dd>
<p>Name of a column in <code>theme_name</code> on which to compute aggregate values, as explained in the Usage Notes. An example might be a POPULATION column.</p>
</dd>
<dt>tablename</dt>
<dd>
<p>Name of the data mining table.</p>
</dd>
<dt>colname</dt>
<dd>
<p>Name of the column in <code>tablename</code> that holds the geometries.</p>
</dd>
<dt>dst_spec</dt>
<dd>
<p>A quoted string specifying either a distance buffer or a number of nearest neighbor geometries to consider. See the Usage Notes for the <a href="#CACJAJDC">SDO_SAM.AGGREGATES_FOR_GEOMETRY</a> function in this chapter for an explanation of the format and meaning.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2399"></a>Usage Notes</p>
<p>For each geometry in <code>tablename</code>, this function identifies the geometries in the <code>theme_name</code> table, finds their intersection ratio, multiplies the specified aggregate using this intersection ratio, and aggregates it for each geometry in <code>tablename</code>. Specifically, for all rows of the <code>theme_name</code> table, it returns the value from the following function:</p>
<pre>
aggr_type_string(aggr_col_string * proportional_area_of_intersection(geometry, theme_name.theme_colname))
</pre>
<p><a id="sthref2400"></a><a id="sthref2401"></a>This function returns an object of type SDO_REGAGGRSET. The SDO_REGAGGRSET object type is defined as:</p>
<pre>
TABLE OF SDO_REGAGGR
</pre>
<p>The SDO_REGAGGR object type is defined as:</p>
<pre>
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 REGION_ID                                          VARCHAR2(24)
 GEOMETRY                                           MDSYS.SDO_GEOMETRY
 AGGREGATE_VALUE                                    NUMBER
</pre>
<p>The <code>theme_colname</code> column must have a spatial index defined on it. For best performance, insert simplified geometries into this column.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2402"></a>Examples</p>
<p>The following example computes the thematic aggregates for all geometries in a table named TEST_TAB for an area with a 3-mile radius around a specified point geometry. In this case, the total population of each area is computed based on the proportion of the circle's area within different counties, assuming uniform distribution of population within the counties.</p>
<pre>
SELECT a.aggregate_value FROM TABLE(sdo_sam.aggregates_for_layer(
  'GEOD_COUNTIES', 'GEOM', 'SUM', TOTPOP', TEST_TAB', 'GEOM'
    'distance=3 unit=mile')) a;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACHBADC"></a>
<div id="SPATL1199" class="refsect1">
<h2 class="refsect1"><a id="sthref2403"></a><a id="sthref2404"></a><a id="sthref2405"></a>SDO_SAM.BIN_GEOMETRY</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2406"></a>Format</p>
<p class="synopsis">SDO_SAM.BIN_GEOMETRY(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom IN SDO_GEOMETRY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tol IN SDO_DIM_ARRAY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_colname IN VARCHAR2</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN NUMBER;</p>
<p>or</p>
<p class="synopsis">SDO_SAM.BIN_GEOMETRY(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom IN SDO_GEOMETRY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim IN SDO_DIM_ARRAY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_colname IN VARCHAR2</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN NUMBER;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2407"></a>Description</p>
<p>Computes the most-intersecting tile for a geometry.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2408"></a>Parameters</p>
<dl>
<dt>geom</dt>
<dd>
<p>Geometry for which to compute the bin.</p>
</dd>
<dt>tol</dt>
<dd>
<p>Tolerance value (see <a href="sdo_intro.htm#i884589">Section 1.5.5</a>).</p>
</dd>
<dt>dim</dt>
<dd>
<p>Dimensional array for the table that holds the geometries for the bins.</p>
</dd>
<dt>bin_tablename</dt>
<dd>
<p>Name of the table that holds the geometries for the bins.</p>
</dd>
<dt>bin_colname</dt>
<dd>
<p>Column in <code>bin_tablename</code> that holds the geometries for the bins.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2409"></a>Usage Notes</p>
<p>This function returns the bin that intersects most with the specified geometry. If multiple bins intersect to the same extent with the specified geometry, the bin with the smallest area is returned.</p>
<p>To perform this operation on all rows in the data mining table, using the specified <code>bin_tablename</code>, you can use the <a href="#CACCEFIG">SDO_SAM.BIN_LAYER</a> procedure.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2410"></a>Examples</p>
<p>The following example computes the bin for a specified geometry.</p>
<pre>
SELECT sdo_sam.bin_geometry(a.geometry, 0.0000005, 'BINTBL', 'GEOMETRY')
  FROM poly_4pt a, user_sdo_geom_metadata b
  WHERE b.table_name='POLY_4PT' AND a.gid=1;
 
SDO_SAM.BIN_GEOMETRY(A.GEOMETRY,0.0000005,'BINTBL','GEOMETRY')
--------------------------------------------------------------
                                                            43
 
1 row selected.
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACCEFIG"></a>
<div id="SPATL1200" class="refsect1">
<h2 class="refsect1"><a id="sthref2411"></a><a id="sthref2412"></a><a id="sthref2413"></a>SDO_SAM.BIN_LAYER</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2414"></a>Format</p>
<p class="synopsis">SDO_SAM.BIN_LAYER(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_id_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commit_interval IN NUMBER DEFAULT 20);</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2415"></a>Description</p>
<p>Assigns each location (and the corresponding row) in a data mining table to a spatial bin.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2416"></a>Parameters</p>
<dl>
<dt>tablename</dt>
<dd>
<p>Name of the data mining table.</p>
</dd>
<dt>colname</dt>
<dd>
<p>Name of the column in <code>table_name</code> that holds the location coordinates.</p>
</dd>
<dt>bin_tablename</dt>
<dd>
<p>Name of the table that contains information (precomputed for the entire two-dimensional space) about the spatial bins.</p>
</dd>
<dt>bin_colname</dt>
<dd>
<p>Column in <code>bin_tablename</code> that holds the geometries for the bins.</p>
</dd>
<dt>bin_id_colname</dt>
<dd>
<p>Name of the column in the data mining table that holds the bin ID value of each geometry added to a bin. (Each affected row in the data mining table is updated with the ID value of the bin geometry in <code>bin_tablename</code>.)</p>
</dd>
<dt>commit_interval</dt>
<dd>
<p>Number of bin insert operations to perform before Spatial performs an internal commit operation. If <code>commit_interval</code> is not specified, a commit is performed after every 20 insert operations.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2417"></a>Usage Notes</p>
<p>This procedure computes the most-intersecting tile for each geometry in a specified layer using the bins in <code>bin_tablename</code>. The bin ID value for each geometry is added in <code>bin_id_colname</code>.</p>
<p>Using this procedure achieves the same result as using the <a href="#CACHBADC">SDO_SAM.BIN_GEOMETRY</a> function on each row in the data mining table, using the specified <code>bin_tablename</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2418"></a>Examples</p>
<p>The following example assigns each GEOMETRY column location and corresponding row in the POLY_4PT_TEMP data mining table to a spatial bin, and performs an internal commit operation after each bin table insertion.</p>
<pre>
CALL SDO_SAM.BIN_LAYER('POLY_4PT_TEMP', 'GEOMETRY', 'BINTBL', 'GEOMETRY', 'BIN_ID', 1);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACBBFEF"></a>
<div id="SPATL1201" class="refsect1">
<h2 class="refsect1"><a id="sthref2419"></a><a id="sthref2420"></a>SDO_SAM.COLOCATED_REFERENCE_FEATURES</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2421"></a>Format</p>
<p class="synopsis">SDO_SAM.COLOCATED_REFERENCE_FEATURES(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_predicate IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref_predicate IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_spec IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commit_interval IN NUMBER DEFAULT 100);</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2422"></a>Description</p>
<p>Performs a partial predicate-based join of tables, and materializes the join results into a table.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2423"></a>Parameters</p>
<dl>
<dt>theme_tablename</dt>
<dd>
<p>Name of the table with which to join <code>tablename</code>.</p>
</dd>
<dt>theme_colname</dt>
<dd>
<p>Name of the geometry column in <code>theme_tablename</code>.</p>
</dd>
<dt>theme_predicate</dt>
<dd>
<p>Qualifying WHERE clause predicate to be applied to <code>theme_tablename</code>.</p>
</dd>
<dt>tablename</dt>
<dd>
<p>Name of the data mining table.</p>
</dd>
<dt>colname</dt>
<dd>
<p>Name of the column in <code>tablename</code> that holds the location coordinates.</p>
</dd>
<dt>ref_predicate</dt>
<dd>
<p>Qualifying WHERE clause predicate to be applied to <code>tablename</code>. Must be a single table predicate, such as <code>'country_code=10'.</code></p>
</dd>
<dt>dst_spec</dt>
<dd>
<p>A quoted string containing a distance value and optionally a unit value for a buffer around the geometries. See the Usage Notes for an explanation of the format and meaning.</p>
</dd>
<dt>result_tablename</dt>
<dd>
<p>The table in which materialized join results are stored. This table must have the following definition: <code>(tid NUMBER, rid1 VARCHAR2(24), rid2 VARCHAR2(24))</code></p>
</dd>
<dt>commit_interval</dt>
<dd>
<p>Number of internal join operations to perform before Spatial performs an internal commit operation. If <code>commit_interval</code> is not specified, a commit is performed after every 100 internal join operations.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2424"></a>Usage Notes</p>
<p>This procedure materializes each pair of rowids returned from a predicate-based join operation, and stores them in the <code>rid1, rid2</code> columns of <code>result_tablename</code>. The <code>tid</code> is a unique generated "interaction" number corresponding to each <code>rid1</code> value.</p>
<p>The <code>dst_spec</code> parameter, if specified, is a quoted string containing the <code>distance</code> keyword and optionally the <code>unit</code> keyword (unit of measurement associated with the distance value), to specify a buffer around the geometry. For example, <code>'distance=2 unit=km'</code> specifies a 2-kilometer buffer around the input geometry. If <code>dst_spec</code> is not specified, no buffer is used.</p>
<p>If the <code>unit</code> keyword is specified, the value must be an SDO_UNIT value from the MDSYS.SDO_DIST_UNITS table (for example, <code>'unit=KM'</code>). If the <code>unit</code> keyword is not specified, the unit of measurement associated with the geometry is used. See <a href="sdo_objrelschema.htm#i1010145">Section 2.10</a> for more information about unit of measurement specification.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2425"></a>Examples</p>
<p>The following example identifies cities with a 1990 population (POP90 column value) greater than 120,000 that are located within 20 kilometers of interstate highways (GEOM column in the GEOD_INTERSTATES table). It stores the results in a table named COLOCATION_TABLE, and performs an internal commit operation after each 20 internal operations.</p>
<pre>
EXECUTE SDO_SAM.COLOCATED_REFERENCE_FEATURES(
  'geod_cities', 'location', 'pop90 &gt; 120000',
  'geod_interstates', 'geom', null,
  'distance=20 unit=km', 'colocation_table', 20);
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACFCAII"></a>
<div id="SPATL1202" class="refsect1">
<h2 class="refsect1"><a id="sthref2426"></a><a id="sthref2427"></a>SDO_SAM.SIMPLIFY_GEOMETRY</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2428"></a>Format</p>
<p class="synopsis">SDO_SAM.SIMPLIFY_GEOMETRY(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom IN SDO_GEOMETRY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim IN SDO_DIM_ARRAY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pct_area_change_limit IN NUMBER DEFAULT 2</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_GEOMETRY;</p>
<p>or</p>
<p class="synopsis">SDO_SAM.SIMPLIFY_GEOMETRY(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom IN SDO_GEOMETRY,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tol IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pct_area_change_limit IN NUMBER DEFAULT 2</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_GEOMETRY;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2429"></a>Description</p>
<p>Simplifies a geometry.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2430"></a>Parameters</p>
<dl>
<dt>geom</dt>
<dd>
<p>Geometry to be simplified.</p>
</dd>
<dt>dim</dt>
<dd>
<p>Dimensional array for the geometry to be simplified.</p>
</dd>
<dt>tol</dt>
<dd>
<p>Tolerance value (see <a href="sdo_intro.htm#i884589">Section 1.5.5</a>).</p>
</dd>
<dt>pct_area_change_limit</dt>
<dd>
<p>The percentage of area changed to be used for each simplification iteration, as explained in the Usage Notes.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2431"></a>Usage Notes</p>
<p>This function reduces the number of vertices in a geometry by internally applying the <a href="sdo_util.htm#BJEHCIBF">SDO_UTIL.SIMPLIFY</a> function (documented in <a href="sdo_util.htm#CEGCFDED">Chapter 32</a>) with an appropriate threshold value.</p>
<p>Reducing the number of vertices may result in a change in the area of the geometry. The <code>pct_area_change_limit</code> parameter specifies how much area change can be tolerated while simplifying the geometry. It is usually a number from 1 to 100. The default value is 2; that is, the area of the geometry can either increase or decrease by at most two percent compared to the original geometry as a result of the geometry simplification.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2432"></a>Examples</p>
<p>The following example simplifies the geometries in the GEOMETRY column of the POLY_4PT_TEMP table.</p>
<pre>
SELECT sdo_sam.simplify_geometry(a.geometry, 0.00000005)
  FROM poly_4pt_temp a, user_sdo_geom_metadata b
  WHERE b.table_name='POLY_4PT_TEMP' ;
 
SDO_SAM.SIMPLIFY_GEOMETRY(A.GEOMETRY,0.00000005)(ORIG_AREA, CUR_AREA, ORIG_LEN,
--------------------------------------------------------------------------------
SDO_SMPL_GEOMETRY(28108.5905, 28108.5905, 758.440118, 758.440118, SDO_GEOMETRY(2
003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 1), SDO_ORDINATE_ARRAY(-122.4215,
37.7862, -122.422, 37.7869, -122.421, 37.789, -122.42, 37.7866, -122.4215, 37.78
62)))
 
SDO_SMPL_GEOMETRY(4105.33806, 4105.33806, 394.723053, 394.723053, SDO_GEOMETRY(2
003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 1), SDO_ORDINATE_ARRAY(-122.4019,
37.8052, -122.4027, 37.8055, -122.4031, 37.806, -122.4012, 37.8052, -122.4019, 3
7.8052)))
   . 
   . 
   . 
50 rows selected.
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACIGFHG"></a>
<div id="SPATL1203" class="refsect1">
<h2 class="refsect1"><a id="sthref2433"></a><a id="sthref2434"></a>SDO_SAM.SIMPLIFY_LAYER</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2435"></a>Format</p>
<p class="synopsis">SDO_SAM.SIMPLIFY_LAYER(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smpl_geom_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commit_interval IN NUMBER DEFAULT 10,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pct_area_change_limit IN NUMBER DEFAULT 2);</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2436"></a>Description</p>
<p>Simplifies a geometry layer.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2437"></a>Parameters</p>
<dl>
<dt>theme_tablename</dt>
<dd>
<p>Name of the table containing the geometry layer to be simplified.</p>
</dd>
<dt>theme_colname</dt>
<dd>
<p>Column in <code>theme_tablename</code> of type SDO_GEOMETRY containing the geometries to be simplified.</p>
</dd>
<dt>smpl_geom_colname</dt>
<dd>
<p>Column in <code>theme_tablename</code> of type SDO_GEOMETRY into which the simplified geometries are to be placed by this procedure.</p>
</dd>
<dt>commit_interval</dt>
<dd>
<p>Number of geometries to simplify before Spatial performs an internal commit operation. If <code>commit_interval</code> is not specified, a commit is performed after every 10 simplification operations.</p>
</dd>
<dt>pct_area_change_limit</dt>
<dd>
<p>The percentage of area changed to be used for each simplification iteration, as explained in the Usage Notes for the <a href="#CACFCAII">SDO_SAM.SIMPLIFY_GEOMETRY</a> function.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2438"></a>Usage Notes</p>
<p>This procedure simplifies all geometries in a layer. It is equivalent to calling the <a href="#CACFCAII">SDO_SAM.SIMPLIFY_GEOMETRY</a> function for each geometry in the layer, except that each simplified geometry is put in a separate column in the table instead of being returned to the caller. See also the Usage Notes for the <a href="#CACFCAII">SDO_SAM.SIMPLIFY_GEOMETRY</a> function.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2439"></a>Examples</p>
<p>The following example adds a column named SMPL_GEOM to the POLY_4PT_TEMP table, then simplifies all geometries in the GEOMETRY column of the POLY_4PT_TEMP table, placing each simplified geometry in the SMPL_GEOM column in the same row with its associated original geometry.</p>
<pre>
ALTER TABLE poly_4pt_temp ADD (smpl_geom mdsys.sdo_geometry);
 
Table altered.
 
EXECUTE sdo_sam.simplify_layer('POLY_4PT_TEMP', 'GEOMETRY', 'SMPL_GEOM');
 
PL/SQL procedure successfully completed.
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACBFDJE"></a>
<div id="SPATL1204" class="refsect1">
<h2 class="refsect1"><a id="sthref2440"></a><a id="sthref2441"></a>SDO_SAM.SPATIAL_CLUSTERS</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2442"></a>Format</p>
<p class="synopsis">SDO_SAM.SPATIAL_CLUSTERS(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tablename IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_clusters IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allow_outliers IN VARCHAR2 DEFAULT 'TRUE',</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tablepartition IN VARCHAR2 DEFAULT NULL</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_REGIONSET;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2443"></a>Description</p>
<p>Computes clusters using the existing R-tree index, and returns a set of SDO_REGION objects where the geometry column specifies the boundary of each cluster and the <code>geometry_key</code> value is set to null.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2444"></a>Parameters</p>
<dl>
<dt>tablename</dt>
<dd>
<p>Name of the data mining table.</p>
</dd>
<dt>colname</dt>
<dd>
<p>Name of the column in <code>tablename</code> that holds the location coordinates.</p>
</dd>
<dt>max_clusters</dt>
<dd>
<p>Maximum number of clusters to obtain.</p>
</dd>
<dt>allow_outliers</dt>
<dd>
<p><code>TRUE</code> (the default) causes outlying values (isolated instances) to be included in the spatial clusters; <code>FALSE</code> causes outlying values not to be included in the spatial clusters. (<code>TRUE</code> accommodates all data and may result in larger clusters; <code>FALSE</code> may exclude some data and may result in smaller clusters.)</p>
</dd>
<dt>tablepartition</dt>
<dd>
<p>Name of the partition in <code>tablename</code>.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2445"></a>Usage Notes</p>
<p>The clusters are computed using the spatial R-tree index on <code>tablename</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2446"></a>Examples</p>
<p>The following example clusters the locations in cities into at most three clusters, and includes outlying values in the clusters.</p>
<pre>
SELECT * FROM
  TABLE(sdo_sam.spatial_clusters('PROJ_CITIES', 'LOCATION', 3, 'TRUE'));
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACDIGED"></a>
<div id="SPATL1205" class="refsect1">
<h2 class="refsect1"><a id="sthref2447"></a><a id="sthref2448"></a>SDO_SAM.TILED_AGGREGATES</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2449"></a>Format</p>
<p class="synopsis">SDO_SAM.TILED_AGGREGATES(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_name IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theme_colname IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_type_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggr_col_string IN VARCHAR2,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tiling_level IN NUMBER DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tiling_domain IN SDO_DIM_ARRAY DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero_agg_tiles IN NUMBER DEFAULT 0,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xdivs IN NUMBER DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ydivs IN NUMBER DEFAULT NULL</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_REGAGGRSET;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2450"></a>Description</p>
<p>Tiles aggregates for a domain. For each tile, computes the intersecting geometries from the theme table; the values in the <code>aggr_col_string</code> column are weighted proportionally to the area of the intersection, and aggregated according to <code>aggr_col_string</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2451"></a>Parameters</p>
<dl>
<dt>theme_name</dt>
<dd>
<p>Table containing theme information (for example, demographic information).</p>
</dd>
<dt>theme_colname</dt>
<dd>
<p>Name of the column in the <code>theme_name</code> table that contains geometry objects.</p>
</dd>
<dt>aggr_type_string</dt>
<dd>
<p>Any Oracle SQL aggregate function that accepts one or more numeric values and computes a numeric value, such as <code>SUM</code>, <code>MIN</code>, <code>MAX</code>, or <code>AVG</code>.</p>
</dd>
<dt>aggr_col_string</dt>
<dd>
<p>Name of a column in the <code>theme_name</code> table on which to compute aggregate values. An example might be a POPULATION column.</p>
</dd>
<dt>tiling_level</dt>
<dd>
<p>Level to be used to create tiles. If you specify this parameter, the extent of each dimension is divided into 2^<code>tiling_level</code> parts, resulting in at most 4*<code>tiling_level</code> tiles. (Specify either this parameter or the combination of the <code>xdivs</code> and <code>ydivs</code> parameters.)</p>
</dd>
<dt>tiling_domain</dt>
<dd>
<p>Domain for the tiling level. The parameter is not required, and if you do not specify it, the extent associated with the <code>theme_name</code> table is used.</p>
</dd>
<dt>zero_agg_tiles</dt>
<dd>
<p>Specify 0 to exclude tiles that have a value of 0 for the computed aggregate, or specify 1 to return all tiles. The default value is 0, which ensures that only tiles with a nonzero aggregate value are returned.</p>
</dd>
<dt>xdivs</dt>
<dd>
<p>The number of times that the extent in the first dimension is divided, such that the total number of parts is <code>xdivs</code> + 1. For example, if you specify 10 for <code>xdivs</code>, the extent of the first dimension is divided into 11 parts.</p>
</dd>
<dt>ydivs</dt>
<dd>
<p>The number of times that the extent in the second dimension is divided, such that the total number of parts is <code>ydivs</code> + 1. For example, if you specify 10 for <code>ydivs</code>, the extent of the second dimension is divided into 11 parts.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2452"></a>Usage Notes</p>
<p>This function is similar to <a href="#CACICHIG">SDO_SAM.AGGREGATES_FOR_LAYER</a>, but the results are dynamically generated using tiling information. Given a <code>theme_name</code> table, the tiling domain is determined. Based on the <code>tiling_level</code> value or the <code>xdivs</code> and <code>ydivs</code> values, the necessary tiles are generated. For each tile geometry, thematic aggregates are computed as described in the Usage Notes for <a href="#CACICHIG">SDO_SAM.AGGREGATES_FOR_LAYER</a>.</p>
<p>You must specify either the <code>tiling_level</code> parameter or both the <code>xdivs</code> and <code>ydivs</code> parameters. If you specify all three of these parameters, the <code>tiling_level</code> parameter is ignored and the <code>xdivs</code> and <code>ydivs</code> parameters are used.</p>
<p>If you specify the <code>xdivs</code> and <code>ydivs</code> parameters, the total number of grids (tiles) returned is <code>(xdivs+1)*(ydivs+1)</code>.</p>
<p><a id="sthref2453"></a><a id="sthref2454"></a>This function returns an object of type SDO_REGAGGRSET. The SDO_REGAGGRSET object type is defined as:</p>
<pre>
TABLE OF SDO_REGAGGR
</pre>
<p>The SDO_REGAGGR object type is defined as:</p>
<pre>
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 REGION_ID                                          VARCHAR2(24)
 GEOMETRY                                           MDSYS.SDO_GEOMETRY
 AGGREGATE_VALUE                                    NUMBER
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2455"></a>Examples</p>
<p>The following example computes the sum of the population rows of POLY_4PT_TEMP table intersecting with each tile. The extent of the POLY_4PT_TEMP table stored in the USER_SDO_GEOM_METADATA view is used as the domain, and a tiling level of 2 is used (that is, the domain is divided into 16 tiles).</p>
<pre>
SELECT a.geometry, a.aggregate_value
  from TABLE(sdo_sam.tiled_aggregates('POLY_4PT_TEMP',
                        'GEOMETRY', 'SUM', 'POPULATION', 2)) a;
 
GEOMETRY(SDO_GTYPE, SDO_SRID, SDO_POINT(X, Y, Z), SDO_ELEM_INFO, SDO_ORDINATES)
--------------------------------------------------------------------------------
AGGREGATE_VALUE
---------------
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-180, -90, -90, -45))
     .007150754
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-180, -45, -90, 0))
     .034831005
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-180, 0, -90, 45))
     7.73307783
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-90, -90, 0, -45))
     .019498368
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-90, -45, 0, 0))
     .939061456
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-90, 0, 0, 45))
     1.26691592
 
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(0, 0, 90, 45))
             40
 
7 rows selected.
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" -->
<a id="CACFBBFF"></a>
<div id="SPATL1206" class="refsect1">
<h2 class="refsect1"><a id="sthref2456"></a><a id="sthref2457"></a><a id="sthref2458"></a>SDO_SAM.TILED_BINS</h2>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2459"></a>Format</p>
<p class="synopsis">SDO_SAM.TILED_BINS(</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l1 IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u1 IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l2 IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u2 IN NUMBER,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tiling_level IN NUMBER DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srid IN NUMBER DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xdivs IN NUMBER DEFAULT NULL,</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ydivs IN NUMBER DEFAULT NULL</p>
<p class="synopsis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) RETURN SDO_REGIONSET;</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2460"></a>Description</p>
<p>Tiles a two-dimensional space and returns geometries corresponding to those tiles.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2461"></a>Parameters</p>
<dl>
<dt>l1</dt>
<dd>
<p>Lower bound of the extent in the first dimension.</p>
</dd>
<dt>u1</dt>
<dd>
<p>Upper bound of the extent in the first dimension.</p>
</dd>
<dt>l2</dt>
<dd>
<p>Lower bound of the extent in the second dimension.</p>
</dd>
<dt>u2</dt>
<dd>
<p>Upper bound of the extent in the second dimension.</p>
</dd>
<dt>tiling_level</dt>
<dd>
<p>Level to be used to tile the specified extent. If you specify this parameter, the extent of each dimension is divided into 2^<code>tiling_level</code> parts, resulting in at most 4*<code>tiling_level</code> tiles. (Specify either this parameter or the combination of the <code>xdivs</code> and <code>ydivs</code> parameters.)</p>
</dd>
<dt>srid</dt>
<dd>
<p>SRID value to be included for the coordinate system in the returned tile geometries.</p>
</dd>
<dt>xdivs</dt>
<dd>
<p>The number of times that the extent in the first dimension is divided, such that the total number of parts is <code>xdivs</code> + 1. For example, if you specify 10 for <code>xdivs</code>, the extent of the first dimension is divided into 11 parts.</p>
</dd>
<dt>ydivs</dt>
<dd>
<p>The number of times that the extent in the second dimension is divided, such that the total number of parts is <code>ydivs</code> + 1. For example, if you specify 10 for <code>ydivs</code>, the extent of the second dimension is divided into 11 parts.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2462"></a>Usage Notes</p>
<p>You must specify either the <code>tiling_level</code> parameter or both the <code>xdivs</code> and <code>ydivs</code> parameters. If you specify all three of these parameters, the <code>tiling_level</code> parameter is ignored and the <code>xdivs</code> and <code>ydivs</code> parameters are used.</p>
<p>If you specify the <code>xdivs</code> and <code>ydivs</code> parameters, the total number of grids (tiles) returned is <code>(xdivs+1)*(ydivs+1)</code>.</p>
<p><a id="sthref2463"></a><a id="sthref2464"></a>This function returns an object of type SDO_REGIONSET. The SDO_REGIONSET object type is defined as:</p>
<pre>
TABLE OF SDO_REGION
</pre>
<p>The SDO_REGION object type is defined as:</p>
<pre>
Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                                 NUMBER
 GEOMETRY                                           MDSYS.SDO_GEOMETRY
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2465"></a>Examples</p>
<p>The following example tiles the entire Earth's surface at the first tiling level, using the standard longitude and latitude coordinate system (SRID 8307). The resulting SDO_REGIONSET object contains four SDO_REGION objects, one for each tile.</p>
<pre>
SELECT * FROM TABLE(sdo_sam.tiled_bins(-180, 180, -90, 90, 1, 8307))
  ORDER BY id;
 
        ID
----------
GEOMETRY(SDO_GTYPE, SDO_SRID, SDO_POINT(X, Y, Z), SDO_ELEM_INFO, SDO_ORDINATES)
--------------------------------------------------------------------------------
         0
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-180, -90, 0, 0))
 
         1
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(-180, 0, 0, 90))
 
         2
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(0, -90, 180, 0))
 
         3
SDO_GEOMETRY(2003, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 1003, 3), SDO_ORDINATE_ARR
AY(0, 0, 180, 90))
 
4 rows selected.
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment733">
<tr>
<td class="cellalignment742">
<table class="cellalignment738">
<tr>
<td class="cellalignment737"><a href="sdo_pc_pkg_ref.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment737"><a href="sdo_tin_pkg_ref.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment744">
<table class="cellalignment736">
<tr>
<td class="cellalignment737"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment737"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment737"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment737"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment737"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment737"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
