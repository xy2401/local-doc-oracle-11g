<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>How to Create a Master Detail PDF Report</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 015" />
<meta name="dcterms.created" content="2012-02-02T14:33:25Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Application Express Advanced Tutorials" />
<meta name="dcterms.identifier" content="E11945-02" />
<meta name="dcterms.isVersionOf" content="HTMAD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="pckg_app.htm" title="Previous" type="text/html" />
<link rel="Next" href="issue_track_obj.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e11945.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/19</span> <!-- End Header --><a id="BABFAJII"></a>
<h1 class="chapter"><span class="secnum">13</span> <a id="HTMAD013"></a>How to Create a Master Detail PDF Report</h1>
<p>Oracle Application Express supports the ability to print a report by exporting a report region to PDF. Defined declaratively, report printing enables users to view and print reports that include page headings and that properly conform to specified page sizes. When users print a report, the report data is transformed to a PDF format using an externally defined report server.</p>
<p>In addition to enabling printing for report regions, you can also define output using report queries and report layouts that are linked to an application.</p>
<p>This tutorial explains how to build a master detail form, define a report query and RTF template, and then create a button to expose the new report.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#BABDIJCG">About Oracle BI Publisher Licensing Requirements</a></p>
</li>
<li>
<p><a href="#BABHDIGH">Loading the Required Objects</a></p>
</li>
<li>
<p><a href="#BABEDEGB">Creating a Master Detail Form</a></p>
</li>
<li>
<p><a href="#BABFEAIB">Creating the Report Query</a></p>
</li>
<li>
<p><a href="#BABEJIBA">Creating the RTF Template</a></p>
</li>
<li>
<p><a href="#BABFGHEI">Creating the Report Layout</a></p>
</li>
<li>
<p><a href="#BABCAFFB">Linking the PDF Report to the Application</a></p>
</li>
<li>
<p><a href="#BABFBJCI">About Creating One PDF Containing All Orders</a></p>
</li>
</ul>
<p>For additional examples on this topic, please visit the following Oracle by Examples (OBEs):</p>
<ul>
<li>
<p>Creating PDF Reports with Oracle Application Express 3.1</p>
<p><code><a href="http://www.oracle.com/technology/obe/apex/apex31nf/apex31rpt.htm">http://www.oracle.com/technology/obe/apex/apex31nf/apex31rpt.htm</a></code></p>
</li>
<li>
<p>Utilizing Advanced Printing in Oracle Application Express 3.1</p>
<p><code><a href="http://www.oracle.com/technology/obe/11gr1_db/appdev/apexpdf/apexpdf.htm">http://www.oracle.com/technology/obe/11gr1_db/appdev/apexpdf/apexpdf.htm</a></code></p>
</li>
<li>
<p>Creating a PDF Report with Multiple Queries</p>
<p><code><a href="http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt_otn.htm">http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt_otn.htm</a></code></p>
</li>
<li>
<p>Including Dynamic Images in Your Report</p>
<p><code><a href="http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt2_otn.htm">http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt2_otn.htm</a></code></p>
</li>
<li>
<p>Storing and Accessing Reports in the Database</p>
<p><code><a href="http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt3_otn.htm">http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt3_otn.htm</a></code></p>
</li>
<li>
<p>Creating Reports With Dynamic Layout Selection</p>
<p><code><a href="http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt4_otn.htm">http://www.oracle.com/technology/obe/hol08/apexprnt/apexprnt4_otn.htm</a></code></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic"><a href="http://www.oracle.com/technology/products/database/application_express/html/configure_printing.html">PDF Printing in Application Express 3.0</a></span> and "Configuring Printing for Reports" in <span class="italic"><a class="olink HTMDB05033" href="../../appdev.112/e11947/bldapp_rpt.htm#HTMDB05033">Oracle Database Application Express User's Guide</a></span></div>
<a id="BABDIJCG"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Oracle BI Publisher Licensing Requirements</h2>
<p>Advanced PDF Printing requires Oracle Application Express release 3.0 or higher and a valid license of Oracle BI Publisher. If your Oracle Application Express instance is not currently configured to use BI Publisher, you can learn more about installing and configuring PDF Printing in <span class="italic"><a href="http://www.oracle.com/technology/products/database/application_express/html/configure_printing.html">PDF Printing in Application Express 3.0</a></span>.</p>
<a id="BABDAECI"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing a Hosted Version of the Application</h3>
<p>If you do not have a valid Oracle BI Publisher license, or have not yet installed or configured Oracle BI Publisher, you can follow the exercises in this tutorial and view a completed version of the application on <code>apex.oracle.com</code>.</p>
<p>To view hosted version of the application:</p>
<ol>
<li>
<p>In your Web browser go to:</p>
<pre>
<a href="http://apex.oracle.com/pls/otn/f?p=15610">http://apex.oracle.com/pls/otn/f?p=15610</a>
</pre>
<p>The hosted application appears.</p>
</li>
<li>
<p>Click the <span class="bold">Edit</span> icon adjacent to a customer.</p>
</li>
<li>
<p>On the Order Details page, click <span class="bold">Print PDF of Order</span>.</p>
</li>
<li>
<p>Save the PDF to your hard drive so you can view it.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABHDIGH"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Loading the Required Objects</h2>
<p>In order to complete this tutorial, you must download and install the packaged application <span class="italic">How To Create a Master-Detail PDF Report</span> from Oracle Technology Network (OTN). Importing and installing this packaged application creates the required objects needed to complete this tutorial. Additionally, it also contains the final version the application you will build. That way, you can refer to it as a code reference.</p>
<p>Topics in this section include:</p>
<ul>
<li>
<p><a href="#BABHEHIH">Download the Packaged Application</a></p>
</li>
<li>
<p><a href="#BABBIJAA">Import and Install the Packaged Application</a></p>
</li>
</ul>
<a id="BABHEHIH"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Download the Packaged Application</h3>
<p>To download the packaged application from OTN:</p>
<ol>
<li>
<p>Download the <code>md_pdf_howto.zip</code> file to your computer. In your Web browser go to:</p>
<pre>
<a href="http://www.oracle.com/technology/products/database/application_express/packaged_apps/md_pdf_howto.zip">http://www.oracle.com/technology/products/database/application_express/packaged_apps/md_pdf_howto.zip</a>
</pre></li>
<li>
<p>Unzip and extract the <code>md_pdf_howto.zip</code> file:</p>
<ul>
<li>
<p>Microsoft Windows - Double-click the <code>md_pdf_howto.zip</code> file</p>
</li>
<li>
<p>UNIX or Linux - Enter the following command:</p>
<pre>
$ unzip md_pdf_howto.zip
</pre></li>
</ul>
</li>
<li>
<p>Review the <code>md_pdf_howto_readme.txt</code> file.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABBIJAA"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Import and Install the Packaged Application</h3>
<p>To import and install the application, <span class="italic">How To Create a Master-Detail PDF Report</span>:</p>
<ol>
<li>
<p>Log in to Oracle Application Express. See "Logging In To Oracle Application Express" in <a class="olink HTMDB01006" href="../../appdev.112/e11947/start_login.htm#HTMDB01006"><span class="italic">Oracle Database Application Express User's Guide</span></a>.</p>
</li>
<li>
<p>On the Workspace home page, click <span class="bold">Application Builder</span>.</p>
<p>The Application Builder home page appears.</p>
</li>
<li>
<p>Click the <span class="bold">Import</span> button.</p>
</li>
<li>
<p>For Specify File, specify the following:</p>
<ol>
<li>
<p>Import file - Click <span class="bold">Browse</span> and go to the <code>md_pdf_howto_installer.sql</code> file.</p>
</li>
<li>
<p>File Type - Select <span class="bold">Application, Page, or Component Export</span>.</p>
</li>
<li>
<p>Verify that File Character Set is correct.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For File Import Confirmation, click <span class="bold">Next</span> to install the imported file.</p>
<p>The Install Application Wizard appears.</p>
</li>
<li>
<p>In the Install Application Wizard, specify the following:</p>
<ol>
<li>
<p>Parsing Schema - Select the appropriate schema.</p>
</li>
<li>
<p>Build Status - Select <span class="bold">Run and Build Application</span>.</p>
</li>
<li>
<p>Install As Application - Select <span class="bold">Auto Assign New Application ID</span>.</p>
</li>
<li>
<p>Click <span class="bold">Install</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Supporting Objects, select <span class="bold">Yes</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Confirm your selections by clicking <span class="bold">Install</span>.</p>
</li>
<li>
<p>Click the <span class="bold">Home</span> breadcrumb link at the top of the page.</p>
<p>The Application Builder home page appears.</p>
</li>
</ol>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref150"></a>
<h4 class="sect3">About Checking the Available Space in Your Workspace</h4>
<p>If you experience problems installing the <span class="italic">How To Create a Master-Detail PDF Report</span> application, verify the available space in your workspace. You many need to request additional storage space.</p>
<p>If you are a workspace administrator, you can:</p>
<ol>
<li>
<p>Determine if you need additional storage space. See "Viewing the Workspace Overview Report" in <span class="italic"><a class="olink HTMDB08011" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=HTMDB08011">Oracle Database Application Express User's Guide</a></span>.</p>
</li>
<li>
<p>Request additional storage space. See "Requesting Additional Storage" in <span class="italic"><a class="olink HTMDB08012" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=HTMDB08012">Oracle Database Application Express User's Guide</a></span>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref151"></a>
<h4 class="sect3">About Deleting the Packaged Application</h4>
<p>Deleting the <span class="italic">How To Create a Master-Detail PDF Report</span> application and selecting to deinstall the supporting objects completely removes all associated objects and sample data.</p>
<p>To delete the <span class="italic">How To Create a Master-Detail PDF</span> Report application:</p>
<ol>
<li>
<p>Log in to Oracle Application Express.</p>
</li>
<li>
<p>On the Workspace home page, click <span class="bold">Application Builder</span>.</p>
<p>The Application Builder home page appears.</p>
</li>
<li>
<p>Select the <span class="italic">How To Create a Master-Detail PDF Report</span> application.</p>
<p>The Application home page appears.</p>
</li>
<li>
<p>On the Tasks list, click <span class="bold">Delete this Application</span>.</p>
<p>The Deinstall page appears.</p>
</li>
<li>
<p>To remove all associated objects and sample data, select <span class="bold">Remove Application Definition</span> and <span class="bold">Deinstall Supporting Objects</span>.</p>
</li>
<li>
<p>Click <span class="bold">Deinstall</span>.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABEDEGB"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating a Master Detail Form</h2>
<p>To create a master detail form:</p>
<ol>
<li>
<p>On the Workspace home page, click the <span class="bold">Application Builder</span> icon.</p>
</li>
<li>
<p>Select the <span class="italic">How To Create a Master-Detail PDF Report</span> application.</p>
</li>
<li>
<p>Click <span class="bold">Create Page</span>.</p>
</li>
<li>
<p>Select <span class="bold">Form</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Select <span class="bold">Master Detail Form</span> and click <span class="bold">Next</span>.</p>
<p>The Master Detail Wizard appears.</p>
</li>
<li>
<p>On Master Table, select the following:</p>
<ol>
<li>
<p>Table/View Owner - Select the appropriate schema.</p>
</li>
<li>
<p>Table/View Name - Select <code>MD_PDF_ORDERS</code>.</p>
<p>The columns in that object appear under Available Columns.</p>
</li>
<li>
<p>Press the <span class="bold">Shift</span> key to select all the columns and then click the <span class="bold">Add</span> button to move them to Displayed Columns.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>On Detail Table, specify the following:</p>
<ol>
<li>
<p>Show Only Related Tables - Accept the default, <span class="bold">Yes</span>.</p>
</li>
<li>
<p>Table/View Owner - Select the appropriate schema.</p>
</li>
<li>
<p>Table/View Name - Select <code>MD_PDF_ORDER_ITEMS</code>.</p>
<p>The columns in that object appear under Available Columns.</p>
</li>
<li>
<p>Press the <span class="bold">Shift</span> key to select all the columns and then click the <span class="bold">Add</span> button to move them to Displayed Columns.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>On Primary Key Source:</p>
<ol>
<li>
<p>For the Primary Key Column <code>ORDER_ID</code>, accept the default, <span class="bold">Existing Trigger</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For the Primary Key Column <code>ORDER_ITEM_ID</code>, accept the default, <span class="bold">Existing Trigger</span> and click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>To accept the remaining defaults, click <span class="bold">Finish</span>.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>A Success page appears.</p>
</li>
</ol>
<a id="BABFBECF"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">View the Report</h3>
<p>To view the new pages:</p>
<ol>
<li>
<p>Click the <span class="bold">Run Page</span> icon.</p>
<p>The PDF Orders report appears as shown in <a href="#BABHJJBF">Figure 13-1</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABHJJBF"></a>Figure 13-1 Md Pdf Orders Report</p>
<img width="663" height="249" src="img/pdf_report1.gif" alt="Description of Figure 13-1 follows" title="Description of Figure 13-1 follows" /><br />
<a id="sthref152" href="img_text/pdf_report1.htm">Description of "Figure 13-1 Md Pdf Orders Report"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Note that the wizard added two pages to the application, a report on the master table and a master detail form that references both tables.</p>
</li>
<li>
<p>To edit an order and view the master detail form, click the <span class="bold">Edit</span> icon.</p>
<p>The Master Details page appears as shown in <a href="#BABGBCAJ">Figure 13-2</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABGBCAJ"></a>Figure 13-2 Master Details Page</p>
<img width="596" height="430" src="img/pdf_report_details.gif" alt="Description of Figure 13-2 follows" title="Description of Figure 13-2 follows" /><br />
<a id="sthref153" href="img_text/pdf_report_details.htm">Description of "Figure 13-2 Master Details Page"</a><br />
<br /></div>
<!-- class="figure" --></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFEAIB"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating the Report Query</h2>
<p>The form you created displays order items for five orders. Using standard PDF printing, you could enable region printing on the tabular form. This would result in an output that would display just the order items records and only for the selected master. To create a report that incorporates all the order information, along with the Order Items, you will create a report query. The order information will be retrieved from the session state for each order item.</p>
<p>To create a report query:</p>
<ol>
<li>
<p>Go to the Report Queries page:</p>
<ol>
<li>
<p>To return to the Application home page, click the <span class="bold">Application</span> link on the Developer toolbar.</p>
</li>
<li>
<p>Click on the <span class="bold">Shared Components</span> icon.</p>
</li>
<li>
<p>Under Reports, click <span class="bold">Report Queries</span>.</p>
<p>The Report Queries page appears.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
</li>
<li>
<p>For Report Query Definition, enter the following:</p>
<ol>
<li>
<p>Report Query Name - Enter <code>order_details</code>.</p>
</li>
<li>
<p>Session State - Select <span class="bold">Include application and session information</span>.</p>
<p>The Select Items fields appear.</p>
</li>
<li>
<p>Select Items - Select <span class="bold">P3_CUSTOMER_NAME</span>, and click <span class="bold">Add</span>.</p>
<p>Repeat this procedure for:</p>
<p><span class="bold">P3_ORDER_DATE</span></p>
<p><span class="bold">P3_ORDER_ID</span></p>
<p><span class="bold">P3_ORDER_MODE</span></p>
<p><span class="bold">P3_ORDER_STATUS</span></p>
<p><span class="bold">P3_ORDER_TOTAL</span></p>
<p><span class="bold">P3_SALES_REP</span></p>
</li>
<li>
<p>Accept remaining defaults and click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Source Queries, enter the following:</p>
<ol>
<li>
<p>SQL Query - Enter the following code:</p>
<pre>
SELECT LINE_ITEM_ID,
       QUANTITY,
       ORDER_ITEM_ID,
       PRODUCT_NAME,
       to_char(UNIT_PRICE,'$9,999.99') unit_price
  FROM MD_PDF_ORDER_ITEMS
 WHERE ORDER_ID = :P<span class="italic">3</span>_ORDER_ID
</pre></li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Data Source for Report Layout, select <span class="bold">XML Data</span> and the click <span class="bold">Download</span> button.</p>
<p>This step downloads an XML file with the name of the report query, <code>order_details.xml</code>.</p>
</li>
<li>
<p>Save the resulting file to your hard drive.</p>
<p>You will create an RTF template using this XML file and then upload it. First, however, you must complete the process of creating the report query using a generic report layout. You will then edit the report query to reference the new report layout once it is created and uploaded.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Report Layout File, browse to and select the <code>order_details.xml</code> file you saved.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>Notice the URL that displays. This is the URL that will be used to call this report from within your application.</p>
</li>
<li>
<p>Click <span class="bold">Finish</span>.</p>
<p>Next, you need to create an RTF template using this XML file.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BABEJIBA"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating the RTF Template</h2>
<p>To edit the XML produced from your report query, you need the Oracle BI Publisher Desktop. When properly loaded, Oracle BI Publisher Desktop adds a new menu option to Microsoft Word.</p>
<p>Topics in this section include:</p>
<ul>
<li>
<p><a href="#BABFEGAB">Download Oracle BI Publisher Desktop</a></p>
</li>
<li>
<p><a href="#BABJDHCG">Load the XML Details</a></p>
</li>
<li>
<p><a href="#BABDAGDF">Insert the Fields</a></p>
</li>
<li>
<p><a href="#BABBJBAB">Include Line Items</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic"><a href="http://www.oracle.com/technology/products/xml-publisher/xmlpclient.html">Oracle BI Publisher Desktop White Papers and Demonstrations</a></span></div>
<a id="BABFEGAB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Download Oracle BI Publisher Desktop</h3>
<p>If you do not have the Desktop loaded, you can download it here:</p>
<pre>
<a href="http://www.oracle.com/technology/software/htdocs/devlic.html?url=/technology/software/products/ias/htdocs/101320bi.html">http://www.oracle.com/technology/software/htdocs/devlic.html?url=/technology/software/products/ias/htdocs/101320bi.html</a>
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABDIJCG">"About Oracle BI Publisher Licensing Requirements"</a></div>
</div>
<!-- class="sect2" -->
<a id="BABJDHCG"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Load the XML Details</h3>
<p>To load the XML generated by your report query:</p>
<ol>
<li>
<p>Open Microsoft Word.</p>
</li>
<li>
<p>From the Oracle BI Publisher menu, select <span class="bold">Data</span> and then <span class="bold">Load Sample XML Data</span>.</p>
</li>
<li>
<p>Select the file you generated when creating report query, <code>order_details.xml</code>.</p>
<p>The following message appears:</p>
<pre>
Data loaded successfully
</pre></li>
<li>
<p>Click <span class="bold">Ok</span>.</p>
<p>Note that nothing appears on the page.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABDAGDF"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Insert the Fields</h3>
<p>To insert the order columns:</p>
<ol>
<li>
<p>From the Oracle BI Publisher menu, select <span class="bold">Insert</span> and then <span class="bold">Field</span>.</p>
</li>
<li>
<p>Select <code>P3 Customer Name</code> and click <span class="bold">Insert</span>.</p>
</li>
<li>
<p>Continue to insert each of the order columns.</p>
</li>
<li>
<p>Exit the Field dialog box, click <span class="bold">Close</span>.</p>
<p>Although each of the order items displays on the page, they are in one long string.</p>
</li>
<li>
<p>Edit the page so that each item displays on a separate line and is prefaced by a descriptive label. Consider the following example:</p>
<pre>
Customer: P3_CUSTOMER_NAME
Order Date: P3_ORDER_DATE
Order ID: P3_ORDER_ID
Order Mode: P3_ORDER_MODE
Order Status: P3_ORDER_STATUS
Order Total: P3_ORDER_TOTAL
Sales Rep: P3_SALES_REP
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABBJBAB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Include Line Items</h3>
<p>To include line items:</p>
<ol>
<li>
<p>Insert a few blank lines below your order details.</p>
</li>
<li>
<p>From the Oracle BI Publisher menu, select <span class="bold">Insert</span> and then <span class="bold">Table Wizard</span>.</p>
</li>
<li>
<p>Accept the default, <span class="bold">Table</span>, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Grouping Field, select <span class="bold">DOCUMENT/REGION/ROWSET/ROW</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Select each field and move it to the right column. Click <span class="bold">Next</span>.</p>
<p>You do not need to make any grouping selections since your report will select just one order.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Sort By, select <span class="bold">Line Item Id</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Labels, edit the following:</p>
<ol>
<li>
<p>Line Item Id - Change to <code>Line Item</code>.</p>
</li>
<li>
<p>Order Item Id - Change to <code>Order Item</code>.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Finish</span>.</p>
<p>Your basic framework is created and should resemble <a href="#BABIFAHD">Figure 13-3</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABIFAHD"></a>Figure 13-3 Report Layout Template</p>
<img width="644" height="250" src="img/pdf_framework.gif" alt="Description of Figure 13-3 follows" title="Description of Figure 13-3 follows" /><br />
<a id="sthref154" href="img_text/pdf_framework.htm">Description of "Figure 13-3 Report Layout Template"</a><br />
<br /></div>
<!-- class="figure" --></li>
<li>
<p>To define a header and footer, from the View menu, select <span class="bold">Header and Footer</span>.</p>
<p>For example, the header could contain the name of the report (for example, <code>My Order Report</code>) and the footer could contain page numbers or the date the report was executed. You can also customize the font family or font size.</p>
</li>
<li>
<p>Save your changes:</p>
<ol>
<li>
<p>From the File menu, select <span class="bold">Save As</span>.</p>
</li>
<li>
<p>For Save as type, select <span class="bold">Rich Text Format (*.rtf)</span>.</p>
</li>
<li>
<p>For File Name, enter <code>order_details.rtf</code>.</p>
</li>
<li>
<p>Exit Microsoft Word.</p>
</li>
</ol>
</li>
</ol>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref155"></a>
<h4 class="sect3">About Including Variables in Your RTF</h4>
<p>You can include variables in the header and footer of your RTF. For example, the RTF file used in the sample pages included in the <span class="italic">How To Create a Master-Detail PDF Report</span> application include the date the report was executed and the user that executed the report.</p>
<p>To download and view this RTF:</p>
<ol>
<li>
<p>Go to the Report Layouts page:</p>
<ol>
<li>
<p>Click on the <span class="bold">Shared Components</span> icon.</p>
</li>
<li>
<p>Under Reports, click <span class="bold">Report Layouts</span>.</p>
<p>The Report Queries page appears.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">order_details2</span>.</p>
</li>
<li>
<p>Click <span class="bold">Download</span> and save <code>order_details2.rtf</code> to your hard drive.</p>
</li>
<li>
<p>Open <code>order_details2.rtf</code> in Microsoft Word and note the variables included in the footer.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFGHEI"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating the Report Layout</h2>
<p>Once you complete your report layout template, you need to upload it to Application Builder and associate it with your report query.</p>
<p>Topics in this section include:</p>
<ul>
<li>
<p><a href="#BABBDJHE">Create a Report Layout</a></p>
</li>
<li>
<p><a href="#BABEGIDJ">Associate the Report Layout and Report Query</a></p>
</li>
</ul>
<a id="BABBDJHE"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Create a Report Layout</h3>
<p>To create a report layout:</p>
<ol>
<li>
<p>Go to the Shared Components page:</p>
<ol>
<li>
<p>Click the <span class="bold">Shared Components</span> breadcrumb.</p>
</li>
<li>
<p>Under Reports, click <span class="bold">Report Layouts</span>.</p>
<p>The Report Layouts page appears.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
</li>
<li>
<p>For Layout Type, select <span class="bold">Named Columns</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Layout Type, specify the following:</p>
<ol>
<li>
<p>For Layout Name, enter <code>order details</code>.</p>
</li>
<li>
<p>For Report Layout File, click <span class="bold">Browse</span> and select <span class="bold">order_details.rtf</span>.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Create Layout</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABEGIDJ"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Associate the Report Layout and Report Query</h3>
<p>To associate the report layout and report query:</p>
<ol>
<li>
<p>Go to the Shared Components page. Click the <span class="bold">Shared Components</span> breadcrumb.</p>
</li>
<li>
<p>Under Reports, click <span class="bold">Report Queries</span>.</p>
</li>
<li>
<p>Edit the query by clicking <span class="bold">order_details</span>.</p>
</li>
<li>
<p>Under Report Query Attributes, for Report Layout, select <span class="bold">order details</span>.</p>
</li>
<li>
<p>Click <span class="bold">Apply Changes</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABCAFFB"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Linking the PDF Report to the Application</h2>
<p>In this exercise, you link the PDF report to the application by creating a button.</p>
<p>Topics in this section include:</p>
<ul>
<li>
<p><a href="#BABCICBB">Create a Button</a></p>
</li>
<li>
<p><a href="#BABDHBIC">Run the Page</a></p>
</li>
</ul>
<a id="BABCICBB"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Create a Button</h3>
<p>To create a button:</p>
<ol>
<li>
<p>Go to the Page Definition for the Master Detail page:</p>
<ol>
<li>
<p>Click the Application breadcrumb link.</p>
</li>
<li>
<p>Select <span class="bold">Master Detail</span>.</p>
</li>
</ol>
</li>
<li>
<p>Under Buttons, click the <span class="bold">Create</span> icon.</p>
<div class="figure">
<p class="titleinfigure"><a id="sthref156"></a>Figure 13-4 Create Icon</p>
<img width="62" height="67" src="img/rpt_frm_create_reg.gif" alt="Description of Figure 13-4 follows" title="Description of Figure 13-4 follows" /><br />
<a id="sthref157" href="img_text/rpt_frm_create_reg.htm">Description of "Figure 13-4 Create Icon"</a><br />
<br /></div>
<!-- class="figure" --></li>
<li>
<p>For Button Region, select <span class="bold">Md Pdf Orders</span> and click <span class="bold">Next</span>.</p>
<p>This selection positions the button in the top (or master) region.</p>
</li>
<li>
<p>For Button Position, select accept the default, <span class="bold">Create a button in a region position</span>, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Button Attributes:</p>
<ol>
<li>
<p>Button Name - Enter <code>PRINT</code>.</p>
</li>
<li>
<p>Label - Enter <code>Print PDF of Order</code>.</p>
</li>
<li>
<p>For Button Type, accept the default, <span class="bold">Template Driven</span>.</p>
</li>
<li>
<p>For Action, select <span class="bold">Download printable report query</span>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Button Template, accept the default and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>For Display Properties:</p>
<ol>
<li>
<p>Position - Select <span class="bold">Region Template Position #CREATE#</span>.</p>
<p>This positions the button to the right of the Apply Changes button.</p>
</li>
<li>
<p>Accept the remaining defaults and click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Branching:</p>
<ol>
<li>
<p>Report Query - Select <code>order_details</code>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
</li>
</ol>
</li>
<li>
<p>For Conditional Display:</p>
<ol>
<li>
<p>Condition Type - Select <span class="bold">Value of Item in Express 1 Is NOT NULL</span>.</p>
</li>
<li>
<p>Expression 1 - Enter <code>P3_ORDER_ID</code>.</p>
<p>By creating this condition, the print button will not display when you are creating a new order.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Create Button</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABDHBIC"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Run the Page</h3>
<p>To run the page:</p>
<ol>
<li>
<p>Click the <span class="bold">Run Page</span> icon in the upper right corner as shown in <a href="#BABFEHJA">Figure 13-5</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABFEHJA"></a>Figure 13-5 Run Page Icon</p>
<img width="14" height="20" src="img/run_ico_green.gif" alt="Description of Figure 13-5 follows" title="Description of Figure 13-5 follows" /><br />
<a id="sthref158" href="img_text/run_ico_green.htm">Description of "Figure 13-5 Run Page Icon"</a><br />
<br /></div>
<!-- class="figure" --></li>
<li>
<p>When the report appears, click <span class="bold">Cancel</span> to return to the Md Pdf Order page.</p>
</li>
<li>
<p>Click the <span class="bold">Edit</span> icon to select another order.</p>
<p>Your Master Detail page should resemble <a href="#BABIGHFG">Figure 13-6</a>. Note the new Print PDF or Order button.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABIGHFG"></a>Figure 13-6 Revised Master Detail Page</p>
<img width="590" height="480" src="img/pdf_report_final.gif" alt="Description of Figure 13-6 follows" title="Description of Figure 13-6 follows" /><br />
<a id="sthref159" href="img_text/pdf_report_final.htm">Description of "Figure 13-6 Revised Master Detail Page"</a><br />
<br /></div>
<!-- class="figure" --></li>
<li>
<p>If you do not have an Oracle BI Publisher license, or have not yet installed or configured Oracle BI Publisher, you will not be able to save the report as a PDF.</p>
<p>To view a fully functional version of this application:</p>
<ul>
<li>
<p>View the hosted version on <code>apex.oracle.com.</code> See <a href="#BABDAECI">"Viewing a Hosted Version of the Application"</a>.</p>
</li>
<li>
<p>View the example pages included with the demonstration application. Return to the Application home page, run the Orders page, click <span class="bold">Edit</span> to edit an order, and click <span class="bold">Print PDF Order</span>.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFBJCI"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Creating One PDF Containing All Orders</h2>
<p>This tutorial created a report that was specific to one order. You could also create the same report without passing in the Order ID. This would create one PDF that would contain all orders. To accomplish this, you would:</p>
<ol>
<li>
<p>Create one report query that returns all the required columns. There would be no need to include session state variables.</p>
</li>
<li>
<p>Load the resulting XML into Microsoft Word just as you did in this tutorial and use the Table Wizard.</p>
</li>
<li>
<p>When prompted to specify Groupings, select the columns that you want to use as your master.</p>
<p>The resulting display will include the grouped columns above a table that contains your detail records. You can then add labels and customize the display. When the report is run, each master value will display on a new page.</p>
</li>
</ol>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment883">
<tr>
<td class="cellalignment890">
<table class="cellalignment893">
<tr>
<td class="cellalignment887"><a href="pckg_app.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment887"><a href="issue_track_obj.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment892">
<table class="cellalignment886">
<tr>
<td class="cellalignment887"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment887"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment887"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment887"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment887"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
