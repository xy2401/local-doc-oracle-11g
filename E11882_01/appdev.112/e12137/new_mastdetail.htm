<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Creating a Master-Detail Application Using JPA and Oracle ADF</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 041" />
<meta name="dcterms.created" content="2012-02-02T15:52:0Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + Java Developer's Guide" />
<meta name="dcterms.identifier" content="E12137-02" />
<meta name="dcterms.isVersionOf" content="TDPJD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="addfunc.htm" title="Previous" type="text/html" />
<link rel="Next" href="getuncon.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12137.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/16</span> <!-- End Header --><a id="CIHGCJGC"></a><a id="TDPJD224"></a>
<h1 class="chapter"><span class="secnum">7</span> Creating a Master-Detail Application Using JPA and Oracle ADF</h1>
<p>This chapter describes how to create a master-detail application usingJava Persistence API(JPA)and <a id="sthref521"></a>Oracle Application Developer Framework (<a id="sthref522"></a>Oracle ADF) in the following sections:</p>
<ul>
<li>
<p><a href="#CIHCEAFE">Overview of the Master-Detail Application</a></p>
</li>
<li>
<p><a href="#CIHFEHDI">Using Java Persistence API (JPA) with Oracle ADF</a></p>
</li>
<li>
<p><a href="#CIHDJDCH">Building the Data Model with EJB 3.0 Using the EJB Diagramer</a></p>
</li>
<li>
<p><a href="#CIHIDGCE">Create a New Project for the User Interface</a></p>
</li>
<li>
<p><a href="#CIHEFHCJ">Creating the Page Flow</a></p>
</li>
<li>
<p><a href="#CIHDJIDJ">Creating a Master-Detail JavaServer Faces Page</a></p>
</li>
<li>
<p><a href="#CIHBEABA">Creating a Query and Edit Page</a></p>
</li>
<li>
<p><a href="#CIHEGIFC">Running the Application</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
To develop, the master-detail application as described in this chapter, you must have an installation of Oracle JDeveloper 11<span class="italic">g</span> or later Studio Edition.</div>
<a id="CIHCEAFE"></a><a id="TDPJD225"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.1</span> Overview of the Master-Detail Application</h2>
<p>A <a id="sthref523"></a><a id="sthref524"></a>master-detail application allows you to view data from related tables at the same time. The records from a master table can be viewed along with related records from the detail table. If provisioning to edit the master-detail data is built into the application, you can also edit data from both the tables from a common interface. The master-detail application created in this chapter consists of:</p>
<ul>
<li>
<p>JPA/EJB middle-tier components exposed through the ADF binding layer, to allow data in the table from the <code>HR</code> schema to be accessed and updated. This is in one <a id="sthref525"></a>project called <code>model</code>.</p>
</li>
<li>
<p>A user interface (UI), or view, that consists of a set of JavaServer Faces(JSF) pages that serve as the UI for the application. This will be in a project called <code>view</code>.</p>
</li>
</ul>
<p>The <code>model</code> and <code>view</code> projects are based on the Java EE <a id="sthref526"></a>Model-View-Controller (<a id="sthref527"></a>MVC) design pattern, that is easily implemented using Oracle ADF.</p>
<p><a href="#CHDGDHCF">Figure 7-1</a> shows the relationships among the items developed for this application.</p>
<div class="figure">
<p class="titleinfigure"><a id="CHDGDHCF"></a><a id="TDPJD352"></a>Figure 7-1 Master Detail Application Pages</p>
<img width="521" height="186" src="img/adf_sampleapp.gif" alt="Description of Figure 7-1 follows" /><br />
<a id="sthref528" href="img_text/adf_sampleapp.htm">Description of "Figure 7-1 Master Detail Application Pages"</a><br />
<br /></div>
<!-- class="figure" -->
<p>This application accesses the <code>HR</code> schema on Oracle Database. It uses the departments table as the master table to display detail data from the employees table. This chapter describes how you can use Oracle ADF with JDeveloper to create this application.</p>
</div>
<!-- class="sect1" -->
<a id="CIHFEHDI"></a><a id="TDPJD226"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.2</span> Using Java Persistence API (JPA) with Oracle ADF</h2>
<p><a id="sthref529"></a><a id="sthref530"></a><a id="sthref531"></a>Oracle ADF is an end-to-end application framework that builds on Java EE standards and open-source technologies to simplify and accelerate creating <a id="sthref532"></a>service-oriented applications. You can use Oracle ADF to develop enterprise solutions that search, display, create, modify, and validate data using web, wireless, desktop, or web services interfaces. Used in tandem, Oracle JDeveloper 11<span class="italic">g</span> and Oracle ADF give you an environment that covers the full development lifecycle from design to deployment, with drag-and-drop data binding, visual UI design, and team development features built-in.</p>
<p>The following subsections introduce Java Persistence API (JPA) and some of the Oracle ADF features that you will use to create the master detail application:</p>
<ul>
<li>
<p><a href="#BABEHJFA">Java Persistence API (JPA)</a></p>
</li>
<li>
<p><a href="#BABHBEIH">Oracle ADF Faces</a></p>
</li>
<li>
<p><a href="#CIHBJDCE">ADF Data Controls</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li><code><a href="http://www.oracle.com/technology/products/adf/pdf/ADF_11_overview.pdf">http://www.oracle.com/technology/products/adf/pdf/ADF_11_overview.pdf</a></code> for more information on Oracle ADF architecture</li>
<li>
<p><code><a href="http://www.oracle.com/technology/products/adf/index.html">http://www.oracle.com/technology/products/adf/index.html</a></code> for a compilation of resources on Oracle ADF</p>
</li>
</ul>
</div>
<a id="BABEHJFA"></a><a id="TDPJD227"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">7.2.1</span> Java Persistence API (JPA)</h3>
<p>JPA is part of the Java EE specification that deals with object/relational mapping and data persistence between Java and databases.</p>
<p><a id="sthref533"></a>The <a id="sthref534"></a>Java Persistence consists of:</p>
<ul>
<li>
<p>The Java Persistence API or JPA</p>
</li>
<li>
<p>The query language</p>
</li>
<li>
<p>Object or relational mapping metadata</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABHBEIH"></a><a id="TDPJD228"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">7.2.2</span> <a id="sthref535"></a>Oracle ADF Faces</h3>
<p>Oracle ADF Faces is based on the <a id="sthref536"></a><a id="sthref537"></a>JavaServer Faces (JSF) JSR 127 specification. Oracle ADF Faces components are used in the user interfaces of the application. These components can be used in any IDE that supports JSF.</p>
<p>You can use Oracle ADF Faces to determine a consistent look and feel for your application. This allows you to focus on user interface interaction rather than look and feel compliance. ADF Faces components also support multi&ndash;language and translation implementation as well as accessibility features.</p>
<p>JDeveloper provides several design tools, wizards, special dialogs, and property editors that help you insert and use ADF Faces components in your pages. For example, the Visual Editor lets you design user interfaces by dragging and dropping components from the Component Palette. If you are familiar with XML or JSP/HTML coding, you can also edit the source of the page files to insert ADF Faces component tags.</p>
</div>
<!-- class="sect2" -->
<a id="CIHBJDCE"></a><a id="TDPJD230"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">7.2.3</span> <a id="sthref538"></a>ADF Data Controls</h3>
<p>Oracle ADF data controls permit the application client to access business services defined by the model object layer. Business services can be any collection, value, or action that your model project defines. At runtime, the ADF Model layer reads the information describing the data controls and bindings from appropriate XML files and implements the two-way connection between the user interface and the business service.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHDJDCH"></a><a id="TDPJD353"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.3</span> Building the Data Model with EJB 3.0 Using the EJB Diagramer</h2>
<p>In the next few steps, you create an application in JDeveloper and create a data model for your application.</p>
<ul>
<li>
<p><a href="#CIHIJFDH">Creating an Application and Project</a></p>
</li>
<li>
<p><a href="#CIHIJDDI">Creating the Persistence Model</a></p>
</li>
<li>
<p><a href="#CIHCAIIF">Creating the Data Model</a></p>
</li>
<li>
<p><a href="#CIHBCGEA">Running the Java Service outside Java EE container</a></p>
</li>
</ul>
<a id="CIHIJFDH"></a><a id="TDPJD231"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">7.3.1</span> Creating an <a id="sthref539"></a><a id="sthref540"></a>Application and Project</h3>
<p>Before you proceed to developing the master detail application, you must create a <a id="sthref541"></a><code>Connection</code> object <code>HRConn</code> that establishes a connection between the application and the database. For instructions to create a <code>Connection</code> object, refer to <a href="getconn.htm#CACIADFI">Chapter 3</a>.</p>
<ol>
<li>
<p>From the <span class="bold">File</span> menu, select <span class="bold">New</span> to display the New Gallery. From the <span class="bold">General</span> category, select <span class="bold">Application</span> and then select <span class="bold">Generic Application</span>. The Create Generic Application wizard is displayed.</p>
</li>
<li>
<p>Enter <code>HR_EJB_JPA_App</code> as the <span class="bold">Name</span> of the application, enter <code>oracle</code> as the <span class="bold">Application Package Prefix</span>, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In the Name your Generic project screen, enter <code>EJBModel</code> as the <span class="bold">Project Name</span> and click <span class="bold">Finish</span>.</p>
</li>
<li>
<p>In the Navigator pane, click the <span class="bold">Database Navigator</span> tab. Select the <span class="bold">HRConn</span> connection in the IDE connections list and drag and drop it inside the <code>HR_EJB_JPA_App</code> node to make the connection available for your application.</p>
</li>
</ol>
<p>You now have an application called <code>HR_EJB_JPA_App</code>, which contains a project called <code>EJBModel</code>.</p>
</div>
<!-- class="sect2" -->
<a id="CIHIJDDI"></a><a id="TDPJD232"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">7.3.2</span> Creating the Persistence Model</h3>
<p>In the model project, you will create the persistence model for <code>hr.Departments</code> and <code>hr.Employees</code> table using EJB 3.0 entity beans.</p>
<ol>
<li>
<p>In the JDeveloper Application Navigator, select the <a id="sthref542"></a><span class="bold">EJBModel</span> project.</p>
</li>
<li>
<p>From the <span class="bold">File</span> menu, select <span class="bold">New</span> to display the New Gallery. Expand the <span class="bold">Business Tier</span> category, and select <span class="bold">EJB</span>. In the <span class="bold">Items</span> list, select <span class="bold">Entities from Tables.</span> Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In Select EJB Version, select <span class="bold">EJB 3.0 -- JPA Entities</span> as the EJB version, then <span class="bold">Next</span>. Click <span class="bold">Next</span> to skip the Persistence Unit page.</p>
</li>
<li>
<p>In the Type of Connection page choose the <span class="bold">Online Database Connection</span> option and accept the default Offline Database name, then click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In the Database Connection Details page, select <span class="bold">HRConn</span> as the connection to use. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Click Query to retrieve the available objects for the HR schema. Then move <span class="bold">DEPARTMENTS</span> and <span class="bold">EMPLOYEES</span> to the <span class="bold">Selected</span> list. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In this step, make sure the package name is <code>oracle</code>. Click <span class="bold">Next</span>, then <span class="bold">Finish</span>.</p>
</li>
<li>
<p>Right click the <span class="bold">EJBModel</span> node in the Application Navigator and select <span class="bold">New</span>.</p>
</li>
<li>
<p>In the New Gallery select <span class="bold">Business Tier</span>, then <span class="bold">EJB</span> as the category and double click <span class="bold">EJB Diagram (JPA/EJB 3.0)</span>.</p>
</li>
<li>
<p>In the Create EJB Diagram dialog, change the default name for the diagram (EJB Diagram1) to <span class="bold">EJB 3</span> and verify <code>oracle</code> is the Package name. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>On the Associate Diagram With Persistence Unit dialog, click <span class="bold">OK</span> to accept the proposed Persistence Unit EJBModel (<code>EJBModel.jpr</code>). A new empty diagram opens in the diagram editor.</p>
</li>
<li>
<p>Select the <span class="bold">Departments</span> and <span class="bold">Employees</span> entities from the Application Navigator then drag and drop them onto the diagram. Reorganize the layout of the diagram to have both entities horizontally aligned. Save all your work.</p>
</li>
</ol>
<div class="figure">
<p class="titleinfigure"><a id="TDPJD354"></a><a id="sthref543"></a>Figure 7-2 Persistence Model</p>
<img width="494" height="368" src="img/ejb3.gif" alt="Persistence Model" /><br /></div>
<!-- class="figure" --></div>
<!-- class="sect2" -->
<a id="CIHCAIIF"></a><a id="TDPJD355"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">7.3.3</span> Creating the Data Model</h3>
<p>In this section, you create a session bean that implements a method to find employee and department records.</p>
<ol>
<li>
<p>Select <span class="bold">EJB Components</span> from the Component Palette library and open the <span class="bold">EJB Nodes</span>. Select the <span class="bold">Session Bean</span> component and drag and drop it onto the diagram. The Create Session Bean Wizard opens.</p>
</li>
<li>
<p>In the EJB Name and Options step, set the EJB Name to HRFacade and make sure that the following values are properly set:</p>
<ul>
<li>
<p>Session Type: <span class="bold">Stateless</span></p>
</li>
<li>
<p>Transaction Type: <span class="bold">Container</span></p>
</li>
<li>
<p>Generate Session Facade Method is checked</p>
</li>
<li>
<p>Entity Implementation: <span class="bold">JPA Entities</span></p>
</li>
<li>
<p>Persistence Unit: <span class="bold">EJBModel</span></p>
</li>
</ul>
<p>Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Expand the <span class="bold">Employees</span> and <span class="bold">Departments</span> nodes and deselect the <span class="bold">findAllByRange</span> method for each entity. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In the Class Definition step, make sure that the full name for Bean Class is <code>oracle.HRFacadeBean</code>. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In the following step, we have both Remote and Local interface implementation selected. The remote interface is used for client applications that run in a separate virtual machine, such as Java clients whereas local interface is used for client applications that run in the same virtual machine, such as Web clients. Click <span class="bold">Next</span> to review the summary of the created classes and then click <span class="bold">Finish</span>.</p>
<p>The session bean is made up of three files: <span class="bold">HRFacadeBean</span> - contains the session bean code. <span class="bold">HRFacade</span> - describes the capabilities of the bean for remote clients and <span class="bold">HRFacadeLocal</span> describes the capabilities for the local client.</p>
</li>
<li>
<p>Double click the <span class="bold">Employees</span> entity bean on the diagram to open the source code for the class.</p>
</li>
<li>
<p>Add a comma at the end of the last <code>@NamedQuery</code> statement, then add the following statement:</p>
<pre>
@NamedQuery(name = "Employees.findByName",
query = "select o from Employees o where o.firstName like :p_name")
</pre>
<p>The code will look as follows:</p>
<pre>
@Entity
@NamedQueries({
@NamedQuery(name = "Employees.findAll", query = "select o from Employees o"),
@NamedQuery(name = "Employees.findByName", query = "select o from Employees o where o.firstName like :p_name")
})
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
What makes these objects different from other Java files are the annotations that identify them as EJB entities. A key feature of EJB 3.0 and JPA is the ability to create entities that contain object-relational mappings by using metadata annotations rather than deployment descriptors as in earlier versions.</div>
</li>
<li>
<p>Click the <span class="bold">Make</span> icon to compile the <code>Employees.java</code> class. Make sure that the Message - Log window does not report any errors.</p>
</li>
<li>
<p>Right-click the <span class="bold">HRFacadeBean</span> node in the Application Navigator and select <span class="bold">Edit Session Facade</span> from the context menu.</p>
</li>
<li>
<p>Expand the <span class="bold">Employees</span> node of the dialog. The new named query <code>Employees.findByName</code> appears as an exposable method. Select it and click <span class="bold">OK</span>. This will add the new method to the session bean.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHBCGEA"></a><a id="TDPJD356"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">7.3.4</span> Running the Java Service outside Java EE container</h3>
<p>A persistence unit can be configured to run inside or outside the container. In this section, you create a session bean that implements a method to find employee and department records.</p>
<ol>
<li>
<p>Expand <span class="bold">META-INF</span> then right-click the <span class="bold">persistence.xml</span>. Select <span class="bold">New Java Service Facade</span> from the context menu.</p>
</li>
<li>
<p>In the Java Service Class panel, you can choose to create a new persistence unit or use an existing unit. Select <span class="bold">Choose a Persistence Unit or Create one in the next Panel</span>, and check the <span class="bold">Generate a main() method</span> checkbox. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Name the the Persistence Unit <code>outside</code>. Choose <span class="bold">JDBC Connection</span> and make sure the JDBC connection is set to <code>HRConn</code>. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>All methods should be selected by default. Deselect all the <code>byRange</code> methods. Click <span class="bold">Next</span>, then <span class="bold">Finish</span>.</p>
<div class="figure">
<p class="titleinfigure"><a id="TDPJD357"></a><a id="sthref544"></a>Figure 7-3 Creating Java Service Facade</p>
<img width="691" height="480" src="img/jsfacade.gif" alt="Creating Java Service Facade" /><br /></div>
<!-- class="figure" --></li>
<li>
<p>In the source editor window, for the JavaServiceFacade class, add a new line after the <code>// TODO comment</code> and enter the following statement:</p>
<pre>
Employees a = javaServiceFacade.queryEmployeesFindByName("P%").get(0);
</pre></li>
<li>
<p>Compile the class and save your work.</p>
</li>
<li>
<p>Right-click the <span class="bold">JavaServiceFacade</span> node in the Application Navigator and select <span class="bold">Run</span> from context.</p>
<p>The Log window displays the result of the execution of the class running outside Java EE container, returning the first <code>lastName</code> of the retrieved records.</p>
</li>
<li>
<p>Expand <span class="bold">META-INF</span> and double-click <span class="bold">persistence.xml</span> to display the contents of the file.</p>
</li>
<li>
<p>Both persistence units are described. The default inside one and the newly-created for outside Java EE run. Click the Source tab to review details.</p>
</li>
<li>
<p>You now expose the EJB as a data control for the Oracle ADF framework. This simplifies the way that you bind user interfaces to the EJB.</p>
<p>Right-click the <span class="bold">HRFacadeBean</span> node in the Application Navigator and select <span class="bold">Create Data Controls</span> from context.</p>
</li>
<li>
<p>In the Choose EJB Interface dialog, select <span class="bold">Local</span>, and click <span class="bold">OK</span>. Save all your work.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHIDGCE"></a><a id="TDPJD358"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.4</span> Create a New Project for the User Interface</h2>
<p>The application user interface consists of a set of JSP pages. For this application, the user interface (UI), referred to as the view, is defined in a separate project.</p>
<p>To create the <a id="sthref545"></a><a id="sthref546"></a>application UI, you define a project called <code>UserInterface</code> as follows:</p>
<ol>
<li>
<p>In the Application Navigator, select the <span class="bold">HR_EJB_JPA_App</span> application and from the <span class="bold">File</span> menu, select <span class="bold">New</span> to display the New Gallery. From the <span class="bold">General</span> category, select <span class="bold">Project</span>. From the Items list, select <span class="bold">Generic Project</span> and click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Create Generic Project screen, enter <code>UserInterface</code> as the <span class="bold">Name</span> of the new project, and click <span class="bold">Finish</span>.</p>
</li>
<li>
<p>In the Application Navigator, right click the <span class="bold">UserInterface</span> node and select <span class="bold">Project Properties</span> from context.</p>
</li>
<li>
<p>In the Project Properties dialog, select the <span class="bold">JSP Tag Libraries</span> node. Select Distributed libraries, then click <span class="bold">Add</span>.</p>
</li>
<li>
<p>In the Tag Libraries list, select <span class="bold">ADF Faces Components 11</span>. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>Select the <span class="bold">Technology scope</span> node. In the Available technologies list, select <span class="bold">JSF</span>. Notice that selecting <span class="bold">JSF</span> automatically propagates the required associated technologies, Java, JSP and Servlets. Click <span class="bold">OK</span>. Save your work.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHEFHCJ"></a><a id="TDPJD359"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.5</span> Creating the Page Flow</h2>
<p>You now use JDeveloper's JSF Navigation Modeler to diagrammatically plan and create your application's pages, and the navigation between them.</p>
<ol>
<li>
<p>In the Application Navigator, expand <span class="bold">UserInterface</span>, then <span class="bold">Web Content</span>, and then <span class="bold">WEB_INF</span>. Double click <span class="bold">faces-config.xml</span> to open a page flow diagram.</p>
</li>
<li>
<p>In the JSF Navigation Diagram page of the Component Palette, select <span class="bold">JSF Page</span>, and click in the diagram where you want the page to appear. Rename the page <code>browse</code>.</p>
</li>
<li>
<p>From the Component Palette, drag and drop a <span class="bold">JSF Page</span> next to the previous one. Rename the page <code>query</code>.</p>
</li>
<li>
<p>Select <span class="bold">JSF Navigation Case</span> in the Component Palette. Click the icon for the source JSF page (<code>browse</code>), and then click the icon for the destination JSF page (<code>query</code>) for the navigation case.</p>
<img width="289" height="143" src="img/jsfnavigation1.gif" alt="JSF Navigation" /><br /></li>
<li>
<p>Modify the default label, <code>success</code>, by clicking it and typing <code>query</code> over it. Notice that there is a warning icon above the Navigation Case. This is because you have not yet created the JSF pages.This warning disappears when you create the respective pages.</p>
</li>
<li>
<p>Select <span class="bold">JSF Navigation Case</span> in the Component Palette. Click the icon for the source JSF page (<code>query</code>), and then click the icon for the destination JSF page (<code>browse</code>) for the navigation case. Rename the label to <code>browse</code>. Save your work.</p>
<div class="figure">
<p class="titleinfigure"><a id="TDPJD360"></a><a id="sthref547"></a>Figure 7-4 JSF Navigation</p>
<img width="291" height="126" src="img/jsfnavigation2.gif" alt="JSF Navigation" /><br /></div>
<!-- class="figure" --></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHDJIDJ"></a><a id="TDPJD361"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.6</span> Creating a Master-Detail JavaServer Faces Page</h2>
<p>In the next few steps, you create a JavaServer Faces Page using ADF Faces components for the Department Employees Master Detail page.</p>
<ol>
<li>
<p>On the Page Flow diagram, double-click the browse icon to launch the Create JSF JSP wizard.</p>
</li>
<li>
<p>The File name should be <code>browse.jspx</code>, select the <span class="bold">Create as XML Document</span> option. Click <span class="bold">OK</span>.</p>
<p>You now have an empty <code>browse.jspx</code> page. In the next few steps, you add a data-bound ADF Faces component to the page. This component displays a department along with the employees belonging to this department.</p>
</li>
<li>
<p>From the Component palette, for the ADF Faces library, select the <span class="bold">Layout</span> section and drag a <span class="bold">Panel Stretch Layout</span> component onto the page</p>
</li>
<li>
<p>From the Component Palette, drag a <span class="bold">Panel Splitter</span> component on the middle of the page. The cursor should be on the left of the center tag.</p>
</li>
<li>
<p>Open the Data Controls component and expand <span class="bold">HRFacadeLocal</span>, then <span class="bold">queryDepartmentsFindAll</span> and then drag and drop the <span class="bold">Departments</span> node within the first facet. In the pop up menu, select <span class="bold">Forms</span>, then <span class="bold">ADF Read-only Form</span>.</p>
</li>
<li>
<p>In the Edit Form Fields, check the <span class="bold">Include Navigation Controls</span> option. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Data Controls, expand the <span class="bold">Departments</span> node, select the <span class="bold">employeesList</span> node and drop it in the second facet. In the pop up menu, select <span class="bold">Tables</span>, then <span class="bold">ADF Read-only Table</span>.</p>
</li>
<li>
<p>In the Edit Table Columns dialog delete all columns except the following:</p>
<ul>
<li>
<p>commissionPct</p>
</li>
<li>
<p>email</p>
</li>
<li>
<p>employeeId</p>
</li>
<li>
<p>firstName</p>
</li>
<li>
<p>hiredate</p>
</li>
<li>
<p>jobId</p>
</li>
<li>
<p>lastName</p>
</li>
<li>
<p>phoneNumber</p>
</li>
<li>
<p>salary</p>
</li>
</ul>
<p>Select <span class="bold">Row Selection</span>, and <span class="bold">Sorting</span> options. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Structure pane, select the <span class="bold">af:panelSplitter</span> pane and in the Property Inspector, set the <span class="bold">Orientation</span> to <code>vertical</code>.</p>
</li>
<li>
<p>Select the <span class="bold">af:panelStretchLayout</span> tag. In the Property Inspector, expand <span class="bold">Style</span>. In the Box tab set the Width to <span class="bold">600</span> Pixel and the Height to <span class="bold">400</span> Pixel so that the Employees table appears in the layout editor.</p>
<p>Select the <span class="bold">af:table</span> tag in the second pane. In the Property Inspector, expand <span class="bold">Style</span>. In the Box tab set the Width to <span class="bold">100</span> Pct and the Height to <span class="bold">100</span> Pct.</p>
<p>Reduce the height of the Department block on the page using your mouse to drag the line.</p>
<img width="603" height="297" src="img/dep_height.gif" alt="Adjusting Department Height" /><br /></li>
<li>
<p>You want the employees section of this page to refresh when the user navigates between departments. You implement that by adding a Partial Page Rendering trigger to the employees table.</p>
<p>Select the <span class="bold">First</span> button and in the Properties Inspector add <code>first</code> as the ID. Repeat this for the remaining 3 buttons. Set <span class="bold">Previous</span> to <code>previous</code>, <span class="bold">Next</span> to <code>next</code>, and <span class="bold">Last</span> to <code>last</code>.</p>
</li>
<li>
<p>Set the Partial Page Rendereing trigger to fire when the user clicks any of those buttons.</p>
<p>Select the <span class="bold">employees</span> table. In the Properties Inspector, expand <span class="bold">Behavior</span>, then <span class="bold">PartialTriggers</span> property and click on <span class="bold">Edit</span>. The Edit button is on the far right of the field.</p>
</li>
<li>
<p>In the Edit Property dialog, expand <span class="bold">facet (first)</span>, then <span class="bold">panelFormLayout - Departments</span> , then <span class="bold">facet (footer)</span>, and then <span class="bold">panelGroupLayout</span> to expose the navigation buttons. Add all four buttons to the selected list. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>From the Component Palette, in the Common Components, select the <span class="bold">Panel Menu Bar</span> component and drop it onto the <span class="bold">Facet Top</span> tag, in the Design of the page. Click the <span class="bold">Menu</span> component then drag and drop it inside the <span class="bold">Menu Bar</span>.</p>
</li>
<li>
<p>(AFBrandingBarTitle, AFHeaderLevelTwo, Click Browse Employees and select Heading2. Drag to resige top facet)</p>
</li>
<li>
<p>In the Property Inspector change the Text from <code>menu 1</code> to <code>Options</code>. Click the <span class="bold">Behavior</span> tab and set the <span class="bold">Detachable</span> field to <span class="bold">true</span>.</p>
</li>
<li>
<p>In the Structure Pane, right-click the <span class="bold">af:menu</span> tag and from context select <span class="bold">Insert Inside af:menu</span> and then <span class="bold">MenuItem</span>.</p>
</li>
<li>
<p>In the Property Inspector, using the Common tab, change the <span class="bold">Text</span> to <code>Query</code> and from the drop down list set the <span class="bold">Action</span> to <code>query</code>. Save your work.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHBEABA"></a><a id="TDPJD362"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.7</span> Creating a Query and Edit Page</h2>
<p>In the next few steps, you use ADF Faces to build the query page to edit Employees.</p>
<ol>
<li>
<p>Click the <span class="bold">faces-config.xml</span> tab to switch back to the Page Flow diagram, and double-click the <span class="bold">query</span> icon to launch the page wizard.</p>
</li>
<li>
<p>The file name should be <code>query.jspx</code> and <span class="bold">Create as XML Document</span> is checked. Click <span class="bold">OK</span></p>
</li>
<li>
<p>A new Design page opens. In Data Controls, under the HRFacadeLocal node, select the <span class="bold">queryEmployeesFindByName(Object)</span> node and drop it onto the page. From the popup menu, select <span class="bold">Parameters</span>, then <span class="bold">ADF Parameter Form</span>.</p>
</li>
<li>
<p>In the Edit Form Fields click <span class="bold">OK</span> to accept the proposed fields.</p>
</li>
<li>
<p>In the Edit Action Binding dialog click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Data Controls, expand the <span class="bold">queryEmployeesFindByName</span> node and select the <span class="bold">Employees</span> node. Drop it onto the page below the Parameter Form. From the popup menu, select <span class="bold">Forms</span>, then <span class="bold">ADF Form</span>.</p>
</li>
<li>
<p>In the Edit Form Fields, select <span class="bold">Include Navigation Controls</span> and <span class="bold">Include Submit Button</span> checkboxes. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>This page needs to be updatable. To specify this, select the <span class="bold">mergeEntity(Object)</span> method in the Data Controls pane, and drop it onto the <span class="bold">Submit</span> button. In the Edit Action Binding dialog, click the down arrow and select <span class="bold">Show EL Expression Builder</span>.</p>
</li>
<li>
<p>In the Variables dialog, expand <span class="bold">ADF Bindings</span>, then <span class="bold">Bindings</span>, then <span class="bold">queryEmployeesFindByNameIterator</span>, then <span class="bold">currentRow</span> and select <span class="bold">dataProvider</span>. As you select each node in the expression. the editor adds it to the expression in the top of the window.</p>
<p>Click <span class="bold">OK</span>. Click <span class="bold">OK</span> again. In the Confirm Component Rebinding dialog, click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the design of the query page, select the <span class="bold">mergeEntity</span> button</p>
<p>In the Property Inspector, Common tab, set the <span class="bold">Text</span> value to <code>Save</code> and in the Button Action section, set the the <span class="bold">Action</span> to <code>browse</code> from the drop down list. Save your work.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHEGIFC"></a><a id="TDPJD248"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">7.8</span> <a id="sthref548"></a>Running the Application</h2>
<p>You may now run the application as follows:</p>
<ol>
<li>
<p>In the Application Navigator, right-click <code>browse.jsp</code> and select <span class="bold">Run</span> from the shortcut menu.</p>
</li>
<li>
<p>As you run the application, you will be able to navigate through the different Departments and then select individual Employees for editing. Experiment with updating either the salary or hiredate of an employee.</p>
</li>
</ol>
<p>The Employees page displayed in a browser is shown in <a href="#CIHBJFIF">Figure 7-5</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="CIHBJFIF"></a><a id="TDPJD363"></a>Figure 7-5 Master-Detail Application Viewed in a Browser</p>
<img width="606" height="403" src="img/master_detail.gif" alt="Master Detail Page" /><br /></div>
<!-- class="figure" -->
<p>The edit page displayed in a browser is similar to that shown in <a href="#CIHJCHGI">Figure 7-6</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="CIHJCHGI"></a><a id="TDPJD364"></a>Figure 7-6 Editing the Master Detail Application Content</p>
<img width="439" height="253" src="img/edit_ms.gif" alt="Edit Master Detail content" /><br /></div>
<!-- class="figure" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1097">
<tr>
<td class="cellalignment1104">
<table class="cellalignment1102">
<tr>
<td class="cellalignment1101"><a href="addfunc.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1101"><a href="getuncon.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1106">
<table class="cellalignment1100">
<tr>
<td class="cellalignment1101"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1101"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1101"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1101"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1101"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1101"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
