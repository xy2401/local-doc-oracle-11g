<!--NewPage-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<!-- Generated by javadoc (build 1.5.0_24-rev) on Wed Jul 21 13:37:52 PDT 2010 -->
<title>XStreamLCRCallbackHandler (Oracle Database XStream Java API Reference)</title>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="keywords" content="oracle.streams.XStreamLCRCallbackHandler interface">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript">
function windowTitle()
{
    parent.document.title="XStreamLCRCallbackHandler (Oracle Database XStream Java API Reference)";
}
</script>
<meta name="generator" content="Oracle ST-Doc Jadey 2.3">
</head>
<body bgcolor="white" onload="windowTitle();">
<p style="display: none"><a href="#skip_navbar_top" title="Skip navigation links">Skip navigation links</a> <a name="navbar_top" id="navbar_top"><!-- --></a></p>
<table class="oac_no_warn" summary="Layout table... probably." border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan="2" bgcolor="#EEEEFF" class="NavBarCell1"><a name="navbar_top_firstrow" id="navbar_top_firstrow"><!-- --></a>
<table class="oac_no_warn" summary="Layout table... probably." border="0" cellpadding="0" cellspacing="3">
<tr align="center" valign="top">
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../oracle/streams/package-summary.html"><span class="NavBarFont1"><b>Package</b></span></a>&nbsp;</td>
<td bgcolor="#FFFFFF" class="NavBarCell1Rev">&nbsp;<span class="NavBarFont1Rev"><b>Class</b></span>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="package-tree.html"><span class="NavBarFont1"><b>Tree</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../deprecated-list.html"><span class="NavBarFont1"><b>Deprecated</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../index-all.html"><span class="NavBarFont1"><b>Index</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../help-doc.html"><span class="NavBarFont1"><b>Help</b></span></a>&nbsp;</td>
</tr>
</table>
</td>
<td align="right" valign="top" rowspan="3"><em><b>Oracle&reg; Database XStream Java API Reference<br>
11g Release 2 (11.2)</b><br>
E16674-02</em></td>
</tr>
<tr>
<td bgcolor="white" class="NavBarCell2"><span style="font-size: smaller">&nbsp;<a href="../../oracle/streams/XStreamIn.html" title="class in oracle.streams"><b>PREV CLASS</b></a>&nbsp; &nbsp;<a href="../../oracle/streams/XStreamOut.html" title="class in oracle.streams"><b>NEXT CLASS</b></a></span></td>
<td bgcolor="white" class="NavBarCell2"><span style="font-size: smaller"><a href="../../index.html?oracle/streams/XStreamLCRCallbackHandler.html" target="_top"><b>FRAMES</b></a> &nbsp; &nbsp;<a href="XStreamLCRCallbackHandler.html" target="_top"><b>NO FRAMES</b></a> &nbsp; &nbsp;</span><script type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes<\/B><\/A>');
  }
  //-->
</script> <noscript><a href="../../allclasses-noframe.html"><b>All Classes</b></a></noscript></td>
</tr>
<tr>
<td valign="top" class="NavBarCell3"><span style="font-size: smaller">SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<a href="#method_summary">METHOD</a></span></td>
<td valign="top" class="NavBarCell3"><span style="font-size: smaller">DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<a href="#method_detail">METHOD</a></span></td>
</tr>
</table>
<p><a name="skip_navbar_top" id="skip_navbar_top"></a> <!-- ========= END OF TOP NAVBAR ========= --></p>
<hr>
<!-- ======== START OF CLASS DATA ======== -->
<h2><span style="font-size: smaller">oracle.streams</span><br>
Interface XStreamLCRCallbackHandler</h2>
<hr>
<dl>
<dd>
<pre>
public interface <b>XStreamLCRCallbackHandler</b>
</pre></dd>
</dl>
<p>The XStreamLCRCallbackHandler interface enables clients to receive LCRs and chunk data from an XStream outbound server or send LCRs and chunk data to an XStream inbound server using a callback mechanism. This interface is the callback interface for LCR handling in Oracle XStream.<br>
A Client Application needs to implement this interface for using XStream Inbound and/or Outbound, and process/create the LCR according to their requirements through callback mechanism.<br></p>
<ul>
<li>The processLCR() interface is the callback method used for XStreamOut to deliver LCRs to a client application.<br></li>
<li>The processChunk() interface is the callback method used for XStreamOut to deliver chunk data to a client application.<br></li>
<li>The createLCR() interface is the callback method used for XStreamIn to retrieve LCRs from a client application.<br></li>
<li>The createChunk() interface is the callback method used for XStreamIn to retrieve chunk data from a client application.<br></li>
</ul>
<dl>
<dt><b>See Also:</b></dt>
<dd><a href="../../oracle/streams/XStreamIn.html" title="class in oracle.streams"><code>XStreamIn</code></a>, <a href="../../oracle/streams/XStreamOut.html" title="class in oracle.streams"><code>XStreamOut</code></a>, <a href="../../oracle/streams/LCR.html" title="interface in oracle.streams"><code>LCR</code></a></dd>
</dl>
<hr>
<p><!-- ========== METHOD SUMMARY =========== -->
 <a name="method_summary" id="method_summary"><!-- --></a></p>
<table class="oac_no_warn" summary="Layout table... probably." border="1" width="100%" cellpadding="3" cellspacing="0">
<tr bgcolor="#CCCCFF" class="TableHeadingColor">
<th align="left" colspan="2"><span><b>Method Summary</b></span></th>
</tr>
<tr bgcolor="white" class="TableRowColor">
<td align="right" valign="top" width="1%"><span style="font-size: smaller"><code>&nbsp;<a href="../../oracle/streams/ChunkColumnValue.html" title="interface in oracle.streams">ChunkColumnValue</a></code></span></td>
<td><code><b><a href="../../oracle/streams/XStreamLCRCallbackHandler.html#createChunk__">createChunk</a></b>()</code><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The callback method for constructing chunk data that is sent to an XStream inbound server.</td>
</tr>
<tr bgcolor="white" class="TableRowColor">
<td align="right" valign="top" width="1%"><span style="font-size: smaller"><code>&nbsp;<a href="../../oracle/streams/LCR.html" title="interface in oracle.streams">LCR</a></code></span></td>
<td><code><b><a href="../../oracle/streams/XStreamLCRCallbackHandler.html#createLCR__">createLCR</a></b>()</code><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The callback method for creating an LCR and sending it to an XStream inbound server.</td>
</tr>
<tr bgcolor="white" class="TableRowColor">
<td align="right" valign="top" width="1%"><span style="font-size: smaller"><code>&nbsp;void</code></span></td>
<td><code><b><a href="../../oracle/streams/XStreamLCRCallbackHandler.html#processChunk_oracle_streams_ChunkColumnValue_">processChunk</a></b>(<a href="../../oracle/streams/ChunkColumnValue.html" title="interface in oracle.streams">ChunkColumnValue</a>&nbsp;chunk)</code><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The callback method for processing chunk data received from an XStream outbound server for an LCR received through the processLCR callback method.</td>
</tr>
<tr bgcolor="white" class="TableRowColor">
<td align="right" valign="top" width="1%"><span style="font-size: smaller"><code>&nbsp;void</code></span></td>
<td><code><b><a href="../../oracle/streams/XStreamLCRCallbackHandler.html#processLCR_oracle_streams_LCR_">processLCR</a></b>(<a href="../../oracle/streams/LCR.html" title="interface in oracle.streams">LCR</a>&nbsp;lcr)</code><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The callback method for processing an LCR recevied from an XStream outbound server.</td>
</tr>
</table>
<p>&nbsp;</p>
<p><!-- ============ METHOD DETAIL ========== -->
 <a name="method_detail" id="method_detail"><!-- --></a></p>
<table class="oac_no_warn" summary="Layout table... probably." border="1" width="100%" cellpadding="3" cellspacing="0">
<tr bgcolor="#CCCCFF" class="TableHeadingColor">
<th align="left" colspan="1"><span><b>Method Detail</b></span></th>
</tr>
</table>
<p><a name="processLCR_oracle_streams_LCR_" id="processLCR_oracle_streams_LCR_"><!-- --></a></p>
<h3>processLCR</h3>
<pre class="oac_no_warn">
void <b>processLCR</b>(<a href="../../oracle/streams/LCR.html" title="interface in oracle.streams">LCR</a> lcr)
                throws <a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a>
</pre>
<dl>
<dd>The callback method for processing an LCR recevied from an XStream outbound server.<br>
You must implement the LCR handling logic in this method. If XStream Out is not used, you can provide an empty implementation of this method.<br>
<br>
To process an LCR with LOB columns, you must also use the processchunk API to retrieve the streaming chunk data.<br>
The following is an example of implementing this API:<br>
Note that the example is not a complete implementation and only illustrates how to process an LCR using the XStream APIs.<br>
<pre>

  public void processLCR(LCR lcr)
    throws StreamsException
  {
    // access LCR header info
    String cmdtype   = lcr.getCommandType();
    String srcDB     = lcr.getSourceDatabaseName();
    String objOwner  = lcr.getObjectOwner();
    String objName   = lcr.getObjectName();
    String txnId     = lcr.getTransactionId();
    DATE   srcTime   = lcr.getSourceTime();
    byte[] pos       = lcr.getPosition());
    ...

    // access scalar columns
    if (lcr instanceof RowLCR)
    {
      if ((lcr.getCommandType()).compareTo(RowLCR.INSERT) == 0)
      { 
        // access scalar columns in new column list
        ColumnValue[] collist = ((RowLCR)lcr).getNewValues();
        for (int i = 0; i &lt; collist.length; i++)
        {
          String colName = collist[i].getColumnName();
          Datum colData = collist[i].getColumnData();
          if (colData instanceof NUMBER)
          {
            System.out.println(((NUMBER)coldata).intValue());
          }
          else if(colData instanceof CHAR)
          {
            System.out.println(((CHAR)colData).stringValue());
            System.out.println(((CHAR)colData).oracleId());
          }
          ...
        }

        if (((RowLCR)lcr).hasChunkData())
        {
          // prepare to retrieve all LOB columns through
          // processChunk() callback method.
        }
      }
      ...
    }
    else
    {
      // handle DDL LCR.
    }
  }
 
</pre></dd>
<dd>
<dl>
<dt><b>Parameters:</b></dt>
<dd><code>lcr</code> - the LCR received from an XStream outbound server.</dd>
<dt><b>Throws:</b></dt>
<dd><code><a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a></code> - if error occurs when processing an LCR.</dd>
</dl>
</dd>
</dl>
<hr>
<p><a name="processChunk_oracle_streams_ChunkColumnValue_" id="processChunk_oracle_streams_ChunkColumnValue_"><!-- --></a></p>
<h3>processChunk</h3>
<pre class="oac_no_warn">
void <b>processChunk</b>(<a href="../../oracle/streams/ChunkColumnValue.html" title="interface in oracle.streams">ChunkColumnValue</a> chunk)
                  throws <a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a>
</pre>
<dl>
<dd>The callback method for processing chunk data received from an XStream outbound server for an LCR received through the processLCR callback method.<br>
You must implement the chunk handling logic in this method. If XStream Out is not used, you can provide an empty implementation of this method.<br>
<br>
The following is an example of implementing this API:<br>
Note that the example is not a complete implementation and only illustrates how to process chunk data using the XStream APIs.<br>
<pre>

  public void processChunk(ChunkColumnValue chunk)
    throws StreamsException
  {
    // process the chunk data
    Datum coldata = chunk.getColumnData();
    String colname = chunk.getColumnName();
    ... 

    if (chunk.isLastChunk())
      // do something for the column
    if (chunk.isEndOfRow())
      // do something for the entire row change, cleanup
  }
 
</pre></dd>
<dd>
<dl>
<dt><b>Parameters:</b></dt>
<dd><code>chunk</code> - the chunk received from an XStream outbound server.</dd>
<dt><b>Throws:</b></dt>
<dd><code><a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a></code> - if error occurs when processing chunk data.</dd>
</dl>
</dd>
</dl>
<hr>
<p><a name="createLCR__" id="createLCR__"><!-- --></a></p>
<h3>createLCR</h3>
<pre class="oac_no_warn">
<a href="../../oracle/streams/LCR.html" title="interface in oracle.streams">LCR</a> <b>createLCR</b>()
              throws <a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a>
</pre>
<dl>
<dd>The callback method for creating an LCR and sending it to an XStream inbound server.<br>
You must implement the LCR construction logic in this method. If XStreamIn is not used, you can provide an empty implementation of this method.<br>
<br>
This method is invoked by XStreamIn inside a sendLCRCallback call to retrieve LCRs. You can return a null LCR to stop the sendLCRCallback execution.<br>
<br>
To construct LCR with LOB columns, you can use the createChunk() callback method to send the streaming chunk data.<br>
<br>
You must construct the partial LCR with all scalar columns and set the ChunkDataFlag to true using setChunkDataFlag() method. When XStream gets the partially constructed LCR with this chunkDataFlag set to true, the createChunk callback method is invoked to get the chunk data.<br>
<br>
The following is an example of implementing this API:<br>
Note that the example is not a complete implementation and only illustrates how to construct an LCR using the XStream APIs.<br>
<pre>

  public LCR createLCR()
    throws StreamsException
  {
    // first construct the lcr with scalar columns 
    DefaultRowLCR alcr = new DefaultRowLCR();

    alcr.setSourceDatabaseName("MY.TEST.DB");
    alcr.setSourceTime(getCurrentDate());
    alcr.setPosition(NUMBER.toBytes(1));
    alcr.setCommandType("INSERT");
    alcr.setObjectOwner("SCOTT");
    alcr.setObjectName("TEST_TABLE");
    alcr.setTransactionId("1.0.0");

    ColumnValue[] newValues = new DefaultColumnValue[4];
    try 
    {              
      CharacterSet mycharset = 
        CharacterSet.make(CharacterSet.AL16UTF16_CHARSET);
      newValues[0] = new DefaultColumnValue("ID",new NUMBER(1));
      newValues[1] = new DefaultColumnValue("CHAR_COLUMN", 
                                          new CHAR("chartest",mycharset));
      DefaultChunkColumnValue chunk1 = 
        new DefaultChunkColumnValue("LOB1_COLUMN", 
                                    null, ChunkColumnValue.CLOB);
      chunk1.setEmptyChunk(true);
      newValues[2] = chunk1;
      DefaultChunkColumnValue chunk2 = 
        new DefaultChunkColumnValue("LOB2_COLUMN", 
                                    null, ChunkColumnValue.BLOB);  
      chunk2.setEmptyChunk(true);
      newValues[3]  = chunk2;
    } 
    catch(Exception e)
    {
      System.out.println("fail to construct a lcr: "+e.getMessage());
      e.printStackTrace();
      throw new StreamsException("fail to create an LCR");
    }     
    alcr.setNewValues(newValues);
    alcr.setChunkDataFlag(true);

    // return this lcr to an XStream inbound Server
    return alcr;
  }
 
</pre></dd>
<dd>
<dl>
<dt><b>Returns:</b></dt>
<dd>the LCR sent to an XStream inbound server.</dd>
<dt><b>Throws:</b></dt>
<dd><code><a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a></code> - if error occurs when creating an LCR.</dd>
</dl>
</dd>
</dl>
<hr>
<p><a name="createChunk__" id="createChunk__"><!-- --></a></p>
<h3>createChunk</h3>
<pre class="oac_no_warn">
<a href="../../oracle/streams/ChunkColumnValue.html" title="interface in oracle.streams">ChunkColumnValue</a> <b>createChunk</b>()
                             throws <a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a>
</pre>
<dl>
<dd>The callback method for constructing chunk data that is sent to an XStream inbound server.<br>
You must implement the Chunk construction logic in this method. If XStream Inbound is not used, you can provide an empty implementation of this method.<br>
<br>
The following is an example of implementing this API:<br>
Note that the example is not a complete implementation and only illustrates how to construct chunk data using the XStream APIs.<br>
<pre>

  public ChunkColumnValue createChunk()
    throws StreamsException
  {
    // construct the chunk data
    ChunkColumnValue chunk = new DefaultChunkColumnValue(...); 
    ...

    if (last chunk in the column)
      chunk.setLastChunk(true)
    if (last chunk for the entire row)
      chunk.setEndOfRow(true);
    return chunk;
  }
 
</pre></dd>
<dd>
<dl>
<dt><b>Returns:</b></dt>
<dd>the Chunk sent to an XStream inbound server.</dd>
<dt><b>Throws:</b></dt>
<dd><code><a href="../../oracle/streams/StreamsException.html" title="class in oracle.streams">StreamsException</a></code> - if error occurs when creating chunk data.</dd>
</dl>
</dd>
</dl>
<!-- ========= END OF CLASS DATA ========= -->
<hr>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<p style="display: none"><a href="#skip_navbar_bottom" title="Skip navigation links">Skip navigation links</a> <a name="navbar_bottom" id="navbar_bottom"><!-- --></a></p>
<table class="oac_no_warn" summary="Layout table... probably." border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan="2" bgcolor="#EEEEFF" class="NavBarCell1"><a name="navbar_bottom_firstrow" id="navbar_bottom_firstrow"><!-- --></a>
<table class="oac_no_warn" summary="Layout table... probably." border="0" cellpadding="0" cellspacing="3">
<tr align="center" valign="top">
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../oracle/streams/package-summary.html"><span class="NavBarFont1"><b>Package</b></span></a>&nbsp;</td>
<td bgcolor="#FFFFFF" class="NavBarCell1Rev">&nbsp;<span class="NavBarFont1Rev"><b>Class</b></span>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="package-tree.html"><span class="NavBarFont1"><b>Tree</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../deprecated-list.html"><span class="NavBarFont1"><b>Deprecated</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../index-all.html"><span class="NavBarFont1"><b>Index</b></span></a>&nbsp;</td>
<td bgcolor="#EEEEFF" class="NavBarCell1"><a href="../../help-doc.html"><span class="NavBarFont1"><b>Help</b></span></a>&nbsp;</td>
</tr>
</table>
</td>
<td align="right" valign="top" rowspan="3"><em><b>Oracle&reg; Database XStream Java API Reference<br>
11g Release 2 (11.2)</b><br>
E16674-02</em></td>
</tr>
<tr>
<td bgcolor="white" class="NavBarCell2"><span style="font-size: smaller">&nbsp;<a href="../../oracle/streams/XStreamIn.html" title="class in oracle.streams"><b>PREV CLASS</b></a>&nbsp; &nbsp;<a href="../../oracle/streams/XStreamOut.html" title="class in oracle.streams"><b>NEXT CLASS</b></a></span></td>
<td bgcolor="white" class="NavBarCell2"><span style="font-size: smaller"><a href="../../index.html?oracle/streams/XStreamLCRCallbackHandler.html" target="_top"><b>FRAMES</b></a> &nbsp; &nbsp;<a href="XStreamLCRCallbackHandler.html" target="_top"><b>NO FRAMES</b></a> &nbsp; &nbsp;</span><script type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes<\/B><\/A>');
  }
  //-->
</script> <noscript><a href="../../allclasses-noframe.html"><b>All Classes</b></a></noscript></td>
</tr>
<tr>
<td valign="top" class="NavBarCell3"><span style="font-size: smaller">SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<a href="#method_summary">METHOD</a></span></td>
<td valign="top" class="NavBarCell3"><span style="font-size: smaller">DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<a href="#method_detail">METHOD</a></span></td>
</tr>
</table>
<p><a name="skip_navbar_bottom" id="skip_navbar_bottom"></a> <!-- ======== END OF BOTTOM NAVBAR ======= --></p>
<hr>
<center>Copyright &copy; 2009, 2010, Oracle and/or its affiliates. All Rights Reserved.</center>
</body>
</html>
