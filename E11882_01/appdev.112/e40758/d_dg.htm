<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DBMS_DG</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-07-19T18:55:13Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference" />
<meta name="dcterms.identifier" content="E40758-03" />
<meta name="dcterms.isVersionOf" content="ARPLS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="d_descrb.htm" title="Previous" type="text/html" />
<link rel="Next" href="d_dimens.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40758.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">62/265</span> <!-- End Header -->
<div id="ARPLS920" class="chapter"><a id="CHDDBJJI"></a>
<h1 class="chapter"><span class="secnum">58</span> DBMS_DG</h1>
<p>The <a id="sthref4024"></a><code>DBMS_DG</code> package allows applications to notify the primary database in an Oracle Data Guard broker environment to initiate a fast-start failover when the application encounters a condition that warrants a failover.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a class="olink DGBKR" href="../../server.112/e40771/toc.htm"><span class="italic">Oracle Data Guard Broker</span></a> for more information about performing a fast-start failover in a broker configuration</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BJFFHGJI">Using DBMS_DG</a></p>
<ul>
<li>
<p><a href="#CEGHECJF">Security Model</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#BJFJBAGJ">Summary of the DBMS_DG Subprogram</a></p>
</li>
</ul>
<div class="refentry"><a id="BJFFHGJI"></a>
<hr />
<div id="ARPLS66222" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Using DBMS_DG<a id="sthref4025"></a></h2>
<p>There are conditions detectable by applications running outside of the Oracle database that may warrant the Oracle Data Guard broker to perform a fast-start failover. Because the range of possible conditions is virtually unlimited, it is left to the applications to determine which conditions warrant a fast-start failover.</p>
<p>When such conditions occur, the application calls the <code>DBMS_DG</code>.<code>INITIATE_FS_FAILOVER</code> procedure to alert the primary database that the application wants a fast-start failover to occur immediately. The primary database then notifies the observer, which immediately initiates a fast-start failover as long as the standby database is in a valid fast-start failover state ("observed" and either "synchronized" or "within lag") to accept a failover.If the configuration is not in a valid fast-start failover state, the <code>INITIATE_FS_FAILOVER</code> subprogram returns an ORA error message (it will not signal an exception) to inform the calling application that a fast-start failover could not be performed.</p>
<div id="ARPLS73145" class="refsect2"><a id="CEGHECJF"></a>
<hr />
<h3 class="refsect2">Security Model</h3>
<p>The <code>DBMS_DG</code> package runs with invoker's rights and requires the <code>SYSDBA</code> privilege.</p>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="BJFJBAGJ"></a>
<hr />
<div id="ARPLS66223" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Summary of the DBMS_DG Subprogram</h2>
<div id="ARPLS66224" class="tblhruleformal">
<p class="titleintable"><a id="sthref4026"></a><a id="BJFBJFIE"></a>Table 58-1 DBMS_DG Package Subprogram</p>
<table class="cellalignment1226" title="DBMS_DG Package Subprogram" summary="Summary of the procedures in the DBMS_DG Subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t3">Subprogram</th>
<th class="cellalignment1227" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t3" headers="r1c1-t3">
<p><a href="#CHDFFIAD">INITIATE_FS_FAILOVER Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r2c1-t3 r1c2-t3">
<p>Enables an application to notify the primary database that a fast-start failover is necessary when the application encounters conditions that warrant a failover.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<div id="ARPLS66225" class="refsect2"><a id="CHDFFIAD"></a>
<hr />
<h3 class="refsect2">INITIATE_FS_FAILOVER Procedure<a id="sthref4027"></a></h3>
<p>Use this procedure to specify a condition string that, when encountered by an application, allows the application to request the primary database to immediately invoke a fast-start failover.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4028"></a>Syntax</p>
<pre>
DBMS_DG.INITIATE_FS_FAILOVER (
     condstr          IN VARCHAR2)
RETURN BINARY_INTEGER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4029"></a>Parameters</p>
<div id="ARPLS66226" class="tblformal">
<p class="titleintable"><a id="sthref4030"></a><a id="sthref4031"></a>Table 58-2 INITIATE_FS_FAILOVER Procedure Parameters</p>
<table class="cellalignment1229" title="INITIATE_FS_FAILOVER Procedure Parameters" summary="Parameters for the DBMS_DG.INITIATE_FS_FAILOVER procedure" dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t4">Parameter</th>
<th class="cellalignment1227" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t4" headers="r1c1-t4">
<p>condstr</p>
</td>
<td class="cellalignment1228" headers="r2c1-t4 r1c2-t4">
<p>Specifies the condition string for which a fast-start failover should be requested. If no condition string argument is supplied, the default string of "Application Failover Requested" will be logged in the broker log file and in the database alert log of the primary database.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4032"></a>Usage Notes</p>
<ul>
<li>
<p>This procedure returns a binary integer.</p>
</li>
<li>
<p>Query the <code>V$FS_FAILOVER_STATS</code> view to see the time of the last fast-start failover and the reason it was performed.</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4033"></a>Errors</p>
<div id="ARPLS66227" class="tblformal">
<p class="titleintable"><a id="sthref4034"></a><a id="sthref4035"></a>Table 58-3 INITIATE_FS_FAILOVER Procedure Errors</p>
<table class="cellalignment1229" title="INITIATE_FS_FAILOVER Procedure Errors" summary="Errors returned by the DBMS_DG.INITIATE_FS_FAILOVER procedure." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t5">Error</th>
<th class="cellalignment1227" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t5" headers="r1c1-t5">
<p><code>ORA-00000: normal, successful completion</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t5 r1c2-t5">
<p>The request to initiate a fast-start failover has been posted to the observer.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t5" headers="r1c1-t5">
<p><code>ORA-16646: fast-start failover is disabled</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t5 r1c2-t5">
<p>Either a broker configuration does not exist or fast-start failover has not been enabled.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t5" headers="r1c1-t5">
<p><code>ORA-16666: unable to initiate fast-start failover on a standby database</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t5 r1c2-t5">
<p><code>DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked on a standby site.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t5" headers="r1c1-t5">
<p><code>ORA-16817: unsynchronized fast-start failover configuration</code></p>
</td>
<td class="cellalignment1228" headers="r5c1-t5 r1c2-t5">
<p><code>DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked in a maximum available fast-start failover configuration when the configuration was not synchronized.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t5" headers="r1c1-t5">
<p><code>ORA-16819: fast-start failover observer not started</code></p>
</td>
<td class="cellalignment1228" headers="r6c1-t5 r1c2-t5">
<p><code>DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked but an observer had not yet been started.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r7c1-t5" headers="r1c1-t5">
<p><code>ORA-16820: fast-start failover observer is no longer observing this database</code></p>
</td>
<td class="cellalignment1228" headers="r7c1-t5 r1c2-t5">
<p><code>DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked but the configuration detects that the observer may not be running.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r8c1-t5" headers="r1c1-t5">
<p><code>ORA-16829: lagging fast-start failover configuration</code></p>
</td>
<td class="cellalignment1228" headers="r8c1-t5 r1c2-t5">
<p><code>DBMS_DG.INITIATE_FS_FAILOVER</code> was invoked in a maximum performance fast-start failover configuration when the configuration was not in the user-specified redo lag limit.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4036"></a>Example</p>
<p>In this example, the program attempts to initiate a fast-start failover when fast-start failover is disabled. To use this example, connect as user <code>SYS</code> with <code>SYDDBA</code> privileges.</p>
<pre>
set serveroutput on

declare
status integer;

begin
status := dbms_dg.initiate_fs_failover(''Failover Requested'');

dbms_output.put_line(''Fast-Start Failover is disabled: Expected status = ORA-16646'');
dbms_output.put_line(''                  Actual Status = ORA-'' || status);

end;
/
exit;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1219">
<tr>
<td class="cellalignment1228">
<table class="cellalignment1224">
<tr>
<td class="cellalignment1223"><a href="d_descrb.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1223"><a href="d_dimens.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1231">
<table class="cellalignment1222">
<tr>
<td class="cellalignment1223"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1223"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1223"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1223"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1223"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1223"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
