<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DBMS_DST</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-07-19T18:55:13Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference" />
<meta name="dcterms.identifier" content="E40758-03" />
<meta name="dcterms.isVersionOf" content="ARPLS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="d_dimens.htm" title="Previous" type="text/html" />
<link rel="Next" href="d_dist_trust_adm.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40758.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">64/265</span> <!-- End Header -->
<div id="ARPLS234" class="chapter"><a id="CIHDCJIC"></a>
<h1 class="chapter"><span class="secnum">60</span> DBMS_DST</h1>
<p>The DBMS_DST package provides an interface to apply the Daylight Saving Time (DST) patch to the Timestamp with Time Zone data type.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink NLSPG259" href="../../server.112/e10729/ch4datetime.htm#NLSPG259"><span class="italic">Oracle Database Globalization Support Guide</span></a></p>
</li>
<li>
<p><a class="olink REFRN20731" href="../../server.112/e40402/statviews_2123.htm#REFRN20731"><span class="italic">Oracle Database Reference</span></a></p>
</li>
</ul>
</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIHIEBGD">Using DBMS_DST</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
<li>
<p>Views</p>
</li>
</ul>
</li>
<li>
<p><a href="#CIHJCDBB">Summary of DBMS_DST Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="CIHIEBGD"></a>
<hr />
<div id="ARPLS66246" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Using DBMS_DST</h2>
<ul>
<li>
<p><a href="#CIHEDCIA">Overview</a></p>
</li>
<li>
<p><a href="#CIHFIGJD">Security Model</a></p>
</li>
<li>
<p><a href="#CIHCFFDF">Views</a></p>
</li>
</ul>
<div id="ARPLS66247" class="refsect2"><a id="CIHEDCIA"></a>
<hr />
<h3 class="refsect2">Overview</h3>
<p>The transition period during which Daylight Saving Time comes into effect, or stops being in effect, has the potential for problems, such as data loss, when handling timestamps with time zone data. The <code>DBMS_DST</code> package enables working with these transitions in the context of a set of rules.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS66248" class="refsect2"><a id="CIHFIGJD"></a>
<hr />
<h3 class="refsect2">Security Model</h3>
<p>The <code>DBMS_DST</code> package is an invoker's rights package.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink LNPLS00809" href="../../appdev.112/e25519/subprograms.htm#LNPLS00809"><span class="italic">Oracle Database PL/SQL Language Reference</span></a> for more information about using Invoker Rights or Definer Rights</div>
<p>The execute privilege on the package is granted to the <code>EXECUTE_CATALOG_ROLE</code> role. This role is normally granted to selected users to allow <code>EXECUTE</code> privileges for packages and procedures in the data dictionary.</p>
<p>The user that invokes the package must have the following privileges:</p>
<ul>
<li>
<p><code>CREATE</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>ALTER</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>DROP</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>SELECT</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>LOCK</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>ALTER</code> <code>ANY</code> <code>INDEX</code></p>
</li>
<li>
<p><code>ALTER</code> <code>ANY</code> <code>TRIGGER</code></p>
</li>
<li>
<p><code>UPDATE</code> <code>ANY</code> <code>TABLE</code></p>
</li>
<li>
<p><code>EXECUTE</code> <code>ANY</code> <code>TYPE</code></p>
</li>
</ul>
</div>
<!-- class="refsect2" -->
<div id="ARPLS66249" class="refsect2"><a id="CIHCFFDF"></a>
<hr />
<h3 class="refsect2">Views</h3>
<p>The <code>DBMS_DST</code> package uses the views shown in <a href="#CIHIHEAE">Table 60-1, "Views used by DBMS_DST"</a>, further described in the <a class="olink REFRN" href="../../server.112/e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a>:</p>
<div id="ARPLS72967" class="tblformal">
<p class="titleintable"><a id="sthref4051"></a><a id="CIHIHEAE"></a>Table 60-1 Views used by DBMS_DST</p>
<table class="cellalignment1229" title="Views used by DBMS_DST" summary="This table uses views used by DBMS_DST package" dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t4">View</th>
<th class="cellalignment1227" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t4" headers="r1c1-t4">
<p><a class="olink REFRN23731" href="../../server.112/e40402/statviews_5072.htm#REFRN23731"><code>DBA_TSTZ_TABLES</code></a></p>
</td>
<td class="cellalignment1228" headers="r2c1-t4 r1c2-t4">
<p>Displays information about all tables in the database, which have columns defined on <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types or object types containing attributes of <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types. Its columns are the same as those in <code>ALL_TSTZ_TABLES</code></p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t4" headers="r1c1-t4">
<p><a class="olink REFRN26731" href="../../server.112/e40402/statviews_5498.htm#REFRN26731"><code>USER_TSTZ_TABLES</code></a></p>
</td>
<td class="cellalignment1228" headers="r3c1-t4 r1c2-t4">
<p>Displays information about the tables owned by the current user, which have columns defined on <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types or object types containing attributes of <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types. Its columns (except for <code>OWNER</code>) are the same as those in <code>ALL_TSTZ_TABLES</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t4" headers="r1c1-t4">
<p><a class="olink REFRN20731" href="../../server.112/e40402/statviews_2123.htm#REFRN20731"><code>ALL_TSTZ_TABLES</code></a></p>
</td>
<td class="cellalignment1228" headers="r4c1-t4 r1c2-t4">
<p>Displays information about the tables accessible to the current user, which have columns defined on <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types or object types containing attributes of <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data types</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="CIHJCDBB"></a>
<hr />
<div id="ARPLS66250" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h2 class="refsect1">Summary of DBMS_DST Subprograms</h2>
<div id="ARPLS66251" class="tblformal">
<p class="titleintable"><a id="sthref4052"></a><a id="sthref4053"></a>Table 60-2 DBMS_DST Package Subprograms</p>
<table class="cellalignment1229" title="DBMS_DST Package Subprograms" summary="DBMS_DST Package Subprograms" dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t5">Subprogram</th>
<th class="cellalignment1227" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t5" headers="r1c1-t5">
<p><a href="#CIHDCBDI">BEGIN_PREPARE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r2c1-t5 r1c2-t5">
<p>Starts a prepare window</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t5" headers="r1c1-t5">
<p><a href="#CIHDDJDJ">BEGIN_UPGRADE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r3c1-t5 r1c2-t5">
<p>Starts an upgrade window</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t5" headers="r1c1-t5">
<p><a href="#CIHFIHAF">CREATE_AFFECTED_TABLE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r4c1-t5 r1c2-t5">
<p>Creates a table that has the schema shown in the comments for the <a href="#CIHHFEBD">FIND_AFFECTED_TABLES Procedure</a></p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t5" headers="r1c1-t5">
<p><a href="#CIHIDDIB">CREATE_ERROR_TABLE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r5c1-t5 r1c2-t5">
<p>Creates a log error table</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t5" headers="r1c1-t5">
<p><a href="#CIHJHFDD">CREATE_TRIGGER_TABLE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r6c1-t5 r1c2-t5">
<p>Creates a table that is used to record active triggers disabled before performing upgrade on the table, having not been enabled due to fatal failure during the upgrading process</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r7c1-t5" headers="r1c1-t5">
<p><a href="#CIHDEJDD">END_PREPARE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r7c1-t5 r1c2-t5">
<p>Ends a prepare window</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r8c1-t5" headers="r1c1-t5">
<p><a href="#CIHEACDD">END_UPGRADE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r8c1-t5 r1c2-t5">
<p>Ends an upgrade window</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r9c1-t5" headers="r1c1-t5">
<p><a href="#CIHHFEBD">FIND_AFFECTED_TABLES Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r9c1-t5 r1c2-t5">
<p>Finds all the tables that have affected TSTZ data due to the new timezone version</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r10c1-t5" headers="r1c1-t5">
<p><a href="#CIHJEIJC">UPGRADE_DATABASE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r10c1-t5 r1c2-t5">
<p>Upgrades all tables in the database that have one or more columns defined on the TSTZ type, or an ADT containing the TSTZ type</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r11c1-t5" headers="r1c1-t5">
<p><a href="#CIHBIJDB">UPGRADE_SCHEMA Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r11c1-t5 r1c2-t5">
<p>Upgrades tables in a specified list of schemas that has one or more columns defined on the TSTZ type, or an ADT containing the TSTZ type</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r12c1-t5" headers="r1c1-t5">
<p><a href="#CIHCEGHG">UPGRADE_TABLE Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r12c1-t5 r1c2-t5">
<p>Upgrades a specified list of tables that has one or more columns defined on the TSTZ type or an ADT containing the TSTZ type</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div id="ARPLS66252" class="refsect2"><a id="CIHDCBDI"></a>
<hr />
<h3 class="refsect2"><a id="sthref4054"></a>BEGIN_PREPARE Procedure</h3>
<p>This procedure starts a prepare window. Once a prepare window is started successfully, the database property '<code>DST_UPGRADE_STATE</code>' is set to '<code>PREPARE</code>', and the database property '<code>SECONDARY_TT_VERSION</code>' is set to a new timezone version.</p>
<p>The prepare window lets a DBA investigate data affected by the upgrade, and so judge when it is optimal to perform the upgrade. The prepare window can overlap normal database operation.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4055"></a>Syntax</p>
<pre>
DBMS_DST.BEGIN_PREPARE (
   new_version                IN  BINARY_INTEGER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4056"></a>Parameters</p>
<div id="ARPLS66253" class="tblformal">
<p class="titleintable"><a id="sthref4057"></a><a id="sthref4058"></a>Table 60-3 BEGIN_PREPARE Procedure Parameters</p>
<table class="cellalignment1229" title="BEGIN_PREPARE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.BEGIN_PREPARE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t6">Parameter</th>
<th class="cellalignment1227" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t6" headers="r1c1-t6">
<p><code>new_version</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t6 r1c2-t6">
<p>New timezone version to which the database is to be prepared to upgrade</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66254" class="refsect2"><a id="CIHDDJDJ"></a>
<hr />
<h3 class="refsect2"><a id="sthref4059"></a>BEGIN_UPGRADE Procedure</h3>
<p>This procedure starts an upgrade window. When an upgraded window is started successfully, the TSTZ data in the dictionary tables is upgraded to reflect the new timezone version, and the database property <code>'DST_UPGRADE_STATE'</code> is set to <code>'UPGRADE'</code>. Once <code>BEGIN_UPGRADE</code> has been performed successfully, the user must re-start the database. After a successful restart, the database property <code>'PRIMARY_TT_VERSION'</code> is the new timezone version, and <code>'SECONDARY_TT_VERSION'</code> is the old timezone version.</p>
<p>The procedure operates atomically, and upgrades all or none of the dictionary tables and the database properties. It must be called in the database in <code>OPEN MIGRATE</code> mode.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4060"></a>Syntax</p>
<pre>
DBMS_DST.BEGIN_UPGRADE (
   new_version                IN  BINARY_INTEGER,
   error_on_overlap_time      IN  BOOLEAN := FALSE,
   error_on_nonexisting_time  IN  BOOLEAN := FALSE);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4061"></a>Parameters</p>
<div id="ARPLS66255" class="tblformal">
<p class="titleintable"><a id="sthref4062"></a><a id="sthref4063"></a>Table 60-4 BEGIN_UPGRADE Procedure Parameters</p>
<table class="cellalignment1229" title="BEGIN_UPGRADE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.BEGIN_UPGRADE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t7">Parameter</th>
<th class="cellalignment1227" id="r1c2-t7">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t7" headers="r1c1-t7">
<p><code>new_version</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t7 r1c2-t7">
<p>New timezone version to which the database is to be upgraded</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t7" headers="r1c1-t7">
<p><code>error_on_overlap_time</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t7 r1c2-t7">
<p>Boolean flag indicating whether to report errors on the 'overlap' time semantic conversion error. The default is <code>TRUE</code>. For more information about boundary cases, see <a class="olink SQLRF30039" href="../../server.112/e41084/sql_elements001.htm#SQLRF30039"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t7" headers="r1c1-t7">
<p><code>error_on_nonexisting_time</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t7 r1c2-t7">
<p>Boolean flag indicating whether to report errors on the 'non-existing' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66256" class="refsect2"><a id="CIHFIHAF"></a>
<hr />
<h3 class="refsect2"><a id="sthref4064"></a>CREATE_AFFECTED_TABLE Procedure</h3>
<p>This procedure creates a table that has the schema shown in the comments for the <a href="#CIHHFEBD">FIND_AFFECTED_TABLES Procedure</a>.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4065"></a>Syntax</p>
<pre>
DBMS_DST.CREATE_AFFECTED_TABLE (
   table_name      IN  VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4066"></a>Parameters</p>
<div id="ARPLS66257" class="tblformal">
<p class="titleintable"><a id="sthref4067"></a><a id="sthref4068"></a>Table 60-5 CREATE_AFFECTED_TABLE Procedure Parameters</p>
<table class="cellalignment1229" title="CREATE_AFFECTED_TABLE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.CREATE_AFFECTED_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t8">Parameter</th>
<th class="cellalignment1227" id="r1c2-t8">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t8" headers="r1c1-t8">
<p><code>table_name</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t8 r1c2-t8">
<p>Name of the table created</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4069"></a>Usage Notes</p>
<p>This procedures takes a <code>table_name</code> without schema qualification, creating a table within the current user schema.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66258" class="refsect2"><a id="CIHIDDIB"></a>
<hr />
<h3 class="refsect2"><a id="sthref4070"></a>CREATE_ERROR_TABLE Procedure</h3>
<p>This procedure creates a log error table which has the following schema:</p>
<pre>
CREATE TABLE dst$error_table(
   table_owner     VARCHAR2(30),
   table_name      VARCHAR2(30),
   column_name     VARCHAR2(4000),
   rid             ROWID,
   error_number    NUMBER)
</pre>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4071"></a>Syntax</p>
<pre>
DBMS_DST.CREATE_ERROR_TABLE (
   table_name      IN  VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4072"></a>Parameters</p>
<div id="ARPLS72844" class="tblformal">
<p class="titleintable"><a id="sthref4073"></a><a id="sthref4074"></a>Table 60-6 CREATE_ERROR_TABLE Procedure Parameters</p>
<table class="cellalignment1229" title="CREATE_ERROR_TABLE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.CREATE_ERROR_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t9">Parameter</th>
<th class="cellalignment1227" id="r1c2-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t9" headers="r1c1-t9">
<p><code>table_name</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t9 r1c2-t9">
<p>Name of the table created</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4075"></a>Usage Notes</p>
<ul>
<li>
<p>This procedures takes a <code>table_name</code> without schema qualification, creating a table within the current user schema.</p>
</li>
<li>
<p>The error number is found when upgrading time zone file and timestamp with time zone data. For more information about error handling when upgrading time zone file and timestamp with time zone data, see <a class="olink NLSPG762" href="../../server.112/e10729/ch4datetime.htm#NLSPG762">Oracle Database Globalization Support Guide</a></p>
</li>
</ul>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66260" class="refsect2"><a id="CIHJHFDD"></a>
<hr />
<h3 class="refsect2"><a id="sthref4076"></a>CREATE_TRIGGER_TABLE Procedure</h3>
<p>This procedure creates a table that has the following schema.</p>
<pre>
CREATE TABLE dst_trigger_table (
trigger_owner  VARCHAR2(30),
trigger_name   VARCHAR2(30));
</pre>
<p>This table is used to record active triggers that are disabled before performing upgrade on the table, having not been enabled due to fatal failure during the upgrading process.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4077"></a>Syntax</p>
<pre>
DBMS_DST.CREATE_TRIGGER_TABLE (
   table_name     IN    VARCHAR2);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4078"></a>Parameters</p>
<div id="ARPLS72845" class="tblformal">
<p class="titleintable"><a id="sthref4079"></a><a id="sthref4080"></a>Table 60-7 CREATE_TRIGGER_TABLE Procedure Parameters</p>
<table class="cellalignment1229" title="CREATE_TRIGGER_TABLE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.CREATE_ERROR_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t10">Parameter</th>
<th class="cellalignment1227" id="r1c2-t10">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t10" headers="r1c1-t10">
<p><code>table_name</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t10 r1c2-t10">
<p>Name of table to be created</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4081"></a>Usage Notes</p>
<p>This procedures takes a <code>table_name</code> without schema qualification, creating a table within the current user schema.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66262" class="refsect2"><a id="CIHDEJDD"></a>
<hr />
<h3 class="refsect2"><a id="sthref4082"></a>END_PREPARE Procedure</h3>
<p>This procedure ends a prepare window.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4083"></a>Syntax</p>
<pre>
DBMS_DST.BEGIN_PREPARE;
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66263" class="refsect2"><a id="CIHEACDD"></a>
<hr />
<h3 class="refsect2"><a id="sthref4084"></a>END_UPGRADE Procedure</h3>
<p>This procedure ends an upgrade window. An upgraded window is ended if all the affected user tables have been upgraded. Otherwise, the <code>OUT</code> parameter <code>num_of_failures</code> indicates how many tables have not been converted.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4085"></a>Syntax</p>
<pre>
DBMS_DST.END_UPGRADE (
  num_of_failures    OUT  BINARY_INTEGER);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4086"></a>Parameters</p>
<div id="ARPLS66264" class="tblformal">
<p class="titleintable"><a id="sthref4087"></a><a id="sthref4088"></a>Table 60-8 END_UPGRADE Procedure Parameters</p>
<table class="cellalignment1229" title="END_UPGRADE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.END_UPGRADE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t11">Parameter</th>
<th class="cellalignment1227" id="r1c2-t11">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t11" headers="r1c1-t11">
<p><code>num_of_failures</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t11 r1c2-t11">
<p>Number of tables that fail to complete</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66265" class="refsect2"><a id="CIHHFEBD"></a>
<hr />
<h3 class="refsect2"><a id="sthref4089"></a>FIND_AFFECTED_TABLES Procedure</h3>
<p>This procedure finds all the tables which have affected TSTZ data due to the new timezone version. This procedure can only be invoked during a prepare window. The tables which have affected TSTZ data are recorded into a table indicated by parameter <code>affected_tables</code>. If semantic errors must be logged, they are recorded into a table indicated by parameter <code>log_errors_table</code>.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4090"></a>Syntax</p>
<pre>
DBMS_DST.FIND_AFFECTED_TABLES (
   affected_tables             IN  VARCHAR2 =: 'sys.dst$affected_tables',
   log_errors                  IN  BOOLEAN := FALSE,
   log_errors_table            IN  VARCHAR2 =: 'sys.dst$error_table');
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4091"></a>Parameters</p>
<div id="ARPLS66266" class="tblformal">
<p class="titleintable"><a id="sthref4092"></a><a id="sthref4093"></a>Table 60-9 FIND_AFFECTED_TABLES Procedure Parameters</p>
<table class="cellalignment1229" title="FIND_AFFECTED_TABLES Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.FIND_AFFECTED_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t12">Parameter</th>
<th class="cellalignment1227" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t12" headers="r1c1-t12">
<p><code>affected_tables</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t12 r1c2-t12">
<p>Name of table with the following schema:</p>
<pre>
CREATE TABLE dst$affected_tables (
table_owner VARCHAR2(30),
table_name VARCHAR2(30),
column_name VARCHAR2(4000),
row_count NUMBER,
error_count NUMBER)
</pre>
<p>The table can be created with the <a href="#CIHFIHAF">CREATE_AFFECTED_TABLE Procedure</a>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t12" headers="r1c1-t12">
<p><code>log_errors</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t12 r1c2-t12">
<p>Boolean flag indicating whether to log errors during upgrade. If <code>FALSE</code>, no error is logged into the <code>log_errors_table</code> after aborting conversion of the current table. If <code>TRUE</code>, the error is logged to the <code>log_errors_table</code>.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t12" headers="r1c1-t12">
<p><code>log_errors_table</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t12 r1c2-t12">
<p>Table name with the following schema:</p>
<pre>
CREATE TABLE dst$error_table (
table_owner VARCHAR2(30),
table_name VARCHAR2(30),
column_name VARCHAR2(4000),
rid ROWID,
error_number NUMBER)
</pre>
<p>The table can be created with the <a href="#CIHIDDIB">CREATE_ERROR_TABLE Procedure</a>. The <code>rid</code> column records the rowids of the offending rows, and the <code>error_number</code> column records the corresponding error number.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66267" class="refsect2"><a id="CIHJEIJC"></a>
<hr />
<h3 class="refsect2"><a id="sthref4094"></a>UPGRADE_DATABASE Procedure</h3>
<p>This procedure upgrades all tables in the database, which have one or more columns defined on the TSTZ type or an ADT containing the TSTZ type. This procedure can only be invoked after an upgrade window has been started. Each table is upgraded in an atomic transaction. Note that, a base table and its materialized view log table are upgraded in an atomic transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4095"></a>Syntax</p>
<pre>
DBMS_DST.UPGRADE_DATABASE  (
   num_of_failures             OUT BINARY_INTEGER,
   upgrade_data                IN  BOOLEAN := TRUE,
   parallel                    IN  BOOLEAN := FALSE,
   continue_after_errors       IN  BOOLEAN := TRUE,
   log_errors                  IN  BOOLEAN := FALSE,
   log_errors_table            IN  VARCHAR2 =: 'sys.dst$error_table' ,
   error_on_overlap_time       IN  BOOLEAN := FALSE,
   error_on_nonexisting_time   IN  BOOLEAN := FALSE,
   log_triggers_table          IN  VARCHAR2 := 'sys.dst$trigger_table');
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4096"></a>Parameters</p>
<div id="ARPLS66268" class="tblformal">
<p class="titleintable"><a id="sthref4097"></a><a id="sthref4098"></a>Table 60-10 UPGRADE_DATABASE Procedure Parameters</p>
<table class="cellalignment1229" title="UPGRADE_DATABASE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.UPGRADE_DATABASE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t13">Parameter</th>
<th class="cellalignment1227" id="r1c2-t13">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t13" headers="r1c1-t13">
<p><code>num_of_failures</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t13 r1c2-t13">
<p>Number of tables that fail to complete</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t13" headers="r1c1-t13">
<p><code>upgrade_data</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to convert TSTZ data using the new Time Zone patch File (<code>TRUE</code>), or to leave it unconverted (<code>FALSE</code>).The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t13" headers="r1c1-t13">
<p><code>parallel</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to convert tables using PDML (Parallel DML) or Serial DML.The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t13" headers="r1c1-t13">
<p><code>continue_after_errors</code></p>
</td>
<td class="cellalignment1228" headers="r5c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to continue after upgrade fails on the current table.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t13" headers="r1c1-t13">
<p><code>log_errors</code></p>
</td>
<td class="cellalignment1228" headers="r6c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to log errors during upgrade. If <code>FALSE</code>, no error is logged into the <code>log_errors_table</code> after aborting conversion of the current table. If <code>TRUE</code>, errors are logged to the <code>log_errors_table</code>.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r7c1-t13" headers="r1c1-t13">
<p><code>log_errors_table</code></p>
</td>
<td class="cellalignment1228" headers="r7c1-t13 r1c2-t13">
<p>Table name with the following schema:</p>
<pre>
CREATE TABLE dst$error_table (
table_owner VARCHAR2(30),
table_name VARCHAR2(30),
column_name VARCHAR2(4000),
rid ROWID,
error_number NUMBER)
</pre>
<p>The table can be created with the <a href="#CIHIDDIB">CREATE_ERROR_TABLE Procedure</a>. The <code>rid</code> column records the rowids of the offending rows, and the <code>error_number</code> column records the corresponding error number.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r8c1-t13" headers="r1c1-t13">
<p><code>error_on_overlap_time</code></p>
</td>
<td class="cellalignment1228" headers="r8c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to report errors on the 'overlap' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r9c1-t13" headers="r1c1-t13">
<p><code>error_on_nonexisting_time</code></p>
</td>
<td class="cellalignment1228" headers="r9c1-t13 r1c2-t13">
<p>Boolean flag indicating whether to report errors on the 'non-existing' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r10c1-t13" headers="r1c1-t13">
<p><code>log_triggers_table</code></p>
</td>
<td class="cellalignment1228" headers="r10c1-t13 r1c2-t13">
<p>Table to log triggers which are disabled before upgrade, having not been enabled due to a fatal failure when performing an upgrade</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66269" class="refsect2"><a id="CIHBIJDB"></a>
<hr />
<h3 class="refsect2"><a id="sthref4099"></a>UPGRADE_SCHEMA Procedure</h3>
<p>This procedure upgrades tables in a specified list of schemas that have one or more columns defined on the TSTZ type, or an ADT containing the TSTZ type. This procedure can be invoked only after an upgrade window has been started. Each table is upgraded in an atomic transaction. Note that a base table and its materialized view log table are upgraded in an atomic transaction.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4100"></a>Syntax</p>
<pre>
DBMS_DST.UPGRADE_SCHEMA (
   num_of_failures             OUT BINARY_INTEGER,
   schema_list                 IN  VARCHAR2,
   upgrade_data                IN  BOOLEAN := TRUE,
   parallel                    IN  BOOLEAN := FALSE,
   continue_after_errors       IN  BOOLEAN := TRUE,
   log_errors                  IN  BOOLEAN := FALSE,
   log_errors_table            IN  VARCHAR2 =: 'sys.dst$error_table' ,
   error_on_overlap_time       IN  BOOLEAN := FALSE,
   error_on_nonexisting_time   IN  BOOLEAN := FALSE,
   log_triggers_table          IN  VARCHAR2 := 'sys.dst$trigger_table');
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4101"></a>Parameters</p>
<div id="ARPLS66270" class="tblformal">
<p class="titleintable"><a id="sthref4102"></a><a id="sthref4103"></a>Table 60-11 UPGRADE_SCHEMA Procedure Parameters</p>
<table class="cellalignment1229" title="UPGRADE_SCHEMA Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.UPGRADE_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t14">Parameter</th>
<th class="cellalignment1227" id="r1c2-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t14" headers="r1c1-t14">
<p><code>num_of_failures</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t14 r1c2-t14">
<p>Number of tables that fail to complete</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t14" headers="r1c1-t14">
<p><code>schema_list</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t14 r1c2-t14">
<p>Schema name list (comma separated strings)</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t14" headers="r1c1-t14">
<p><code>upgrade_data</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to convert TSTZ data using the new Time Zone patch File (<code>TRUE</code>) or to leave unconverted (<code>FALSE</code>).The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t14" headers="r1c1-t14">
<p><code>parallel</code></p>
</td>
<td class="cellalignment1228" headers="r5c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to convert tables using PDML (Parallel DML) or Serial DML.The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t14" headers="r1c1-t14">
<p><code>continue_after_errors</code></p>
</td>
<td class="cellalignment1228" headers="r6c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to continue after upgrade fails on the current table.The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r7c1-t14" headers="r1c1-t14">
<p><code>log_errors</code></p>
</td>
<td class="cellalignment1228" headers="r7c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to log errors during upgrade. If <code>FALSE</code>, no error is logged into the <code>log_errors_table</code> after aborting conversion of the current table. If <code>TRUE</code>, the error is logged to the <code>log_errors_table</code>.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r8c1-t14" headers="r1c1-t14">
<p><code>log_errors_table</code></p>
</td>
<td class="cellalignment1228" headers="r8c1-t14 r1c2-t14">
<p>Table name with the following schema:</p>
<pre>
CREATE TABLE dst$error_table (
table_owner VARCHAR2(30),
table_name VARCHAR2(30),
column_name VARCHAR2(4000),
rid ROWID,
error_number NUMBER)
</pre>
<p>The table can be created with the <a href="#CIHIDDIB">CREATE_ERROR_TABLE Procedure</a>. The <code>rid</code> column records the rowids of the offending rows, and the <code>error_number</code> column records the corresponding error number.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r9c1-t14" headers="r1c1-t14">
<p><code>error_on_overlap_time</code></p>
</td>
<td class="cellalignment1228" headers="r9c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to report errors on the 'overlap' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r10c1-t14" headers="r1c1-t14">
<p><code>error_on_nonexisting_time</code></p>
</td>
<td class="cellalignment1228" headers="r10c1-t14 r1c2-t14">
<p>Boolean flag indicating whether to report errors on the 'non-existing' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r11c1-t14" headers="r1c1-t14">
<p><code>log_triggers_table</code></p>
</td>
<td class="cellalignment1228" headers="r11c1-t14 r1c2-t14">
<p>Table to log triggers that are disabled before upgrade, having not been enabled due to a fatal failure when performing an upgrade</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" -->
<div id="ARPLS66271" class="refsect2"><a id="CIHCEGHG"></a>
<hr />
<h3 class="refsect2"><a id="sthref4104"></a>UPGRADE_TABLE Procedure</h3>
<p>This procedure upgrades a specified list of tables that have one or more columns defined on the TSTZ type, or an ADT containing the TSTZ type.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4105"></a>Syntax</p>
<pre>
DBMS_DST.UPGRADE_TABLE  (
   num_of_failures             OUT BINARY_INTEGER,
   table_list                  IN  VARCHAR2,
   upgrade_data                IN  BOOLEAN := TRUE,
   parallel                    IN  BOOLEAN := FALSE,
   continue_after_errors       IN  BOOLEAN := TRUE,
   log_errors                  IN  BOOLEAN := FALSE,
   log_errors_table            IN  VARCHAR2 =: 'sys.dst$error_table' ,
   error_on_overlap_time       IN  BOOLEAN := FALSE,
   error_on_nonexisting_time   IN  BOOLEAN := FALSE,
   log_triggers_table          IN  VARCHAR2 := 'sys.dst$trigger_table',
   atomic_upgrade              IN  BOOLEAN := FALSE);
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4106"></a>Parameters</p>
<div id="ARPLS66272" class="tblformal">
<p class="titleintable"><a id="sthref4107"></a><a id="sthref4108"></a>Table 60-12 UPGRADE_TABLE Procedure Parameters</p>
<table class="cellalignment1229" title="UPGRADE_TABLE Procedure Parameters" summary="This table describes the Parameters of DBMS_DST.UPGRADE_TABLE subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t15">Parameter</th>
<th class="cellalignment1227" id="r1c2-t15">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t15" headers="r1c1-t15">
<p><code>num_of_failures</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t15 r1c2-t15">
<p>Number of tables that fail to complete</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t15" headers="r1c1-t15">
<p><code>table_list</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t15 r1c2-t15">
<p>Table name list (comma separated strings)</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t15" headers="r1c1-t15">
<p><code>upgrade_data</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to convert TSTZ data using the new Time Zone patch File (<code>TRUE</code>), or to leave unconverted (<code>FALSE</code>).</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t15" headers="r1c1-t15">
<p><code>parallel</code></p>
</td>
<td class="cellalignment1228" headers="r5c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to convert tables using PDML (Parallel DML), or Serial DML.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t15" headers="r1c1-t15">
<p><code>continue_after_errors</code></p>
</td>
<td class="cellalignment1228" headers="r6c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to continue after upgrade fails on the current table.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r7c1-t15" headers="r1c1-t15">
<p><code>log_errors</code></p>
</td>
<td class="cellalignment1228" headers="r7c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to log errors during upgrade. If <code>FALSE</code>, no error is logged into the <code>log_errors_table</code> after aborting conversion of the current table. If <code>TRUE</code>, the error is logged to the <code>log_errors_table</code>.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r8c1-t15" headers="r1c1-t15">
<p><code>log_errors_table</code></p>
</td>
<td class="cellalignment1228" headers="r8c1-t15 r1c2-t15">
<p>Table name with the following schema:</p>
<pre>
CREATE TABLE dst$error_table (
table_owner VARCHAR2(30),
table_name VARCHAR2(30),
column_name VARCHAR2(4000),
rid ROWID,
error_number NUMBER)
</pre>
<p>The table can be created with the <a href="#CIHIDDIB">CREATE_ERROR_TABLE Procedure</a>. The <code>rid</code> parameter records the rowids of the offending rows and the corresponding error number.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r9c1-t15" headers="r1c1-t15">
<p><code>error_on_overlap_time</code></p>
</td>
<td class="cellalignment1228" headers="r9c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to report errors on the 'overlap' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r10c1-t15" headers="r1c1-t15">
<p><code>error_on_nonexisting_time</code></p>
</td>
<td class="cellalignment1228" headers="r10c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to report errors on the 'non-existing' time semantic conversion error.</p>
<p>The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r11c1-t15" headers="r1c1-t15">
<p><code>log_triggers_table</code></p>
</td>
<td class="cellalignment1228" headers="r11c1-t15 r1c2-t15">
<p>Table to log triggers that are disabled before upgrade, having not been enabled due to a fatal failure when performing an upgrade</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r12c1-t15" headers="r1c1-t15">
<p><code>atomic_upgrade</code></p>
</td>
<td class="cellalignment1228" headers="r12c1-t15 r1c2-t15">
<p>Boolean flag indicating whether to convert the listed tables atomically (in a single transaction). If <code>FALSE</code>, each table is converted in its own transaction.</p>
<p>The default is <code>FALSE</code>.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref4109"></a>Usage Notes</p>
<p>This procedure can only be invoked after an upgrade window has been started. The table list has to satisfy the following partial ordering:</p>
<ol>
<li>
<p>If a base table has a materialized view log table, the log table must be the next item in the list.</p>
</li>
<li>
<p>If the container table for a materialized view appears in the list, the materialized view's 'non-upgraded' base tables and log tables must appear in the table list and before the container table.</p>
</li>
</ol>
<p>A base table and its materialized view log table need to be upgraded in an atomic transaction by specifying <code>atomic_upgrade</code> to <code>TRUE</code>.</p>
</div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1219">
<tr>
<td class="cellalignment1228">
<table class="cellalignment1224">
<tr>
<td class="cellalignment1223"><a href="d_dimens.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1223"><a href="d_dist_trust_adm.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1231">
<table class="cellalignment1222">
<tr>
<td class="cellalignment1223"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1223"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1223"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1223"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1223"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1223"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
