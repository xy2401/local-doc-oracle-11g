<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DBMS_PCLXUTIL</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-07-19T18:55:21Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database PL/SQL Packages and Types Reference" />
<meta name="dcterms.identifier" content="E40758-03" />
<meta name="dcterms.isVersionOf" content="ARPLS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="d_parallel_ex.htm" title="Previous" type="text/html" />
<link rel="Next" href="d_pipe.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40758.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">106/265</span> <!-- End Header -->
<div id="ARPLS037" class="chapter"><a id="sthref6820"></a>
<h1 class="chapter"><span class="secnum">102</span> DBMS_PCLXUTIL</h1>
<p>The <code><a id="sthref6821"></a>DBMS_PCLXUTIL</code> package provides intra-partition parallelism for creating partition-wise local indexes. <code>DBMS_PCLXUTIL</code> circumvents the limitation that, for local index creation, the degree of parallelism is restricted to the number of partitions as only one slave process for each partition is used.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
There are several rules concerning partitions and indexes. For more information, see <a class="olink CNCPT" href="../../server.112/e40540/toc.htm"><span class="italic">Oracle Database Concepts</span></a> and <a class="olink ADMIN" href="../../server.112/e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a>.</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BABDGBIH">Using DBMS_PCLXUTIL</a></p>
<ul>
<li>
<p>Overview</p>
</li>
<li>
<p>Security Model</p>
</li>
<li>
<p>Operational Notes</p>
</li>
<li>
<p>Rules and Limits</p>
</li>
</ul>
</li>
<li>
<p><a href="#i996811">Summary of DBMS_PCLXUTIL Subprograms</a></p>
</li>
</ul>
<div class="refentry"><a id="BABDGBIH"></a>
<hr />
<div id="ARPLS67383" class="refsect1">
<h2 class="refsect1">Using DBMS_PCLXUTIL</h2>
<ul>
<li>
<p><a href="#i998012">Overview</a></p>
</li>
<li>
<p><a href="#CHDFCCJC">Security Model</a></p>
</li>
<li>
<p><a href="#i998037">Operational Notes</a></p>
</li>
<li>
<p><a href="#i998038">Rules and Limits</a></p>
</li>
</ul>
<div id="ARPLS67384" class="refsect2"><a id="i998012"></a>
<hr />
<h3 class="refsect2">Overview</h3>
<p><code>DBMS_PCLXUTIL</code> uses the <code>DBMS_JOB</code> package to provide a greater degree of parallelism for creating a local index for a partitioned table. This is achieved by asynchronous inter-partition parallelism using the background processes (with <code>DBMS_JOB</code>), in combination with intra-partition parallelism using the parallel query slave processes.</p>
<p><code>DBMS_PCLXUTIL</code> works with both range and range-hash composite partitioning.</p>
<p>The <code>DBMS_PCLXUTIL</code> package can be used during the following DBA tasks:</p>
<ol>
<li>
<p>Local index creation</p>
<p>The procedure <code>BUILD_PART_INDEX</code> assumes that the dictionary information for the local index already exists. This can be done by issuing the create index SQL command with the <code>UNUSABLE</code> option.</p>
<pre>
CREATE INDEX &lt;idx_name&gt; on &lt;tab_name&gt;(...) local(...) unusable; 
</pre>
<p>This causes the dictionary entries to be created without "building" the index itself, the time consuming part of creating an index. Now, invoking the procedure <code>BUILD_PART_INDEX</code> causes a concurrent build of local indexes with the specified degree of parallelism.</p>
<pre>
EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,FALSE); 
 
</pre>
<p>For composite partitions, the procedure automatically builds local indexes for all subpartitions of the composite table.</p>
</li>
<li>
<p>Local index maintenance</p>
<p>By marking desired partitions usable or unusable, the <code>BUILD_PART_INDEX</code> procedure also enables selective rebuilding of local indexes. The <code>force_opt</code> parameter provides a way to override this and build local indexes for all partitions.</p>
<pre>
ALTER INDEX &lt;idx_name&gt; local(...) unusable; 
</pre>
<p>Rebuild only the desired (sub)partitions (that are marked unusable):</p>
<pre>
EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,FALSE); 
 
</pre>
<p>Rebuild all (sub)partitions using <code>force_opt</code> = <code>TRUE</code>:</p>
<pre>
EXECUTE dbms_pclxutil.build_part_index(4,4,&lt;tab_name&gt;,&lt;idx_name&gt;,TRUE); 
 
</pre>
<p>A progress report is produced, and the output appears on screen when the program is ended (because the <code>DBMS_OUTPUT</code> package writes messages to a buffer first, and flushes the buffer to the screen only upon termination of the program).</p>
</li>
</ol>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67385" class="refsect2"><a id="CHDFCCJC"></a>
<hr />
<h3 class="refsect2">Security Model</h3>
<p>This utility can be run only as table owner, and not as any other user.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67386" class="refsect2"><a id="i998037"></a>
<hr />
<h3 class="refsect2">Operational Notes</h3>
<p><code>DBMS_PCLXUTIL</code> submits a job for each partition. It is the responsibility of the user/dba to control the number of concurrent jobs by setting the <code>INIT</code>.<code>ORA</code> parameter <code>JOB_QUEUE_PROCESSES</code> correctly. There is minimal error checking for correct syntax. Any errors are reported in the job queue process trace files.</p>
</div>
<!-- class="refsect2" -->
<div id="ARPLS67387" class="refsect2"><a id="i998038"></a>
<hr />
<h3 class="refsect2">Rules and Limits</h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
For range partitioning, the minimum compatibility mode is 8.0; for range-hash composite partitioning, the minimum compatibility mode is 8<span class="italic">i</span>.</div>
<p>Because <code>DBMS_PCLXUTIL</code> uses the <code>DBMS_JOB</code> package, you must be aware of the following limitations pertaining to <code>DBMS_JOB</code>:</p>
<ul>
<li>
<p>You must decide appropriate values for the <code>job_queue_processes</code> initialization parameter. Clearly, if the job processes are not started before calling <code>BUILD_PART_INDEX</code>(), then the package will not function properly. The background processes are specified by the following <code>init</code>.<code>ora</code> parameters:</p>
</li>
</ul>
<pre>
    job_queue_processes=n   #the number of background processes = n  
</pre>
<ul>
<li>
<p>Failure conditions are reported only in the trace files (a <code>DBMS_JOB</code> limitation), making it impossible to give interactive feedback to the user. This package prints a failure message, removes unfinished jobs from the queue, and requests the user to take a look at the <code>j*.trc</code> trace files.</p>
</li>
</ul>
</div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" -->
<a id="i996811"></a>
<hr />
<div id="ARPLS67388" class="refsect1">
<h2 class="refsect1">Summary of DBMS_PCLXUTIL Subprograms</h2>
<div id="ARPLS67389" class="tblformal">
<p class="titleintable"><a id="sthref6822"></a><a id="sthref6823"></a>Table 102-1 DBMS_PCLXUTIL Package Subprograms</p>
<table class="cellalignment1229" title="DBMS_PCLXUTIL Package Subprograms " summary="This table lists the DBMS_PCLXUTIL subprogram and briefly describes it." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t4">Subprogram</th>
<th class="cellalignment1227" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t4" headers="r1c1-t4">
<p><a href="#i996814">BUILD_PART_INDEX Procedure</a></p>
</td>
<td class="cellalignment1228" headers="r2c1-t4 r1c2-t4">
<p>Provides intra-partition parallelism for creating partition-wise local indexes</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div id="ARPLS67390" class="refsect2"><a id="i996814"></a>
<hr />
<h3 class="refsect2"><a id="sthref6824"></a>BUILD_PART_INDEX Procedure</h3>
<p>This procedure provides intra-partition parallelism for creating partition-wise local indexes.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6825"></a>Syntax</p>
<pre>
DBMS_PCLXUTIL.BUILD_PART_INDEX ( 
   jobs_per_batch  IN NUMBER   DEFAULT 1,
   procs_per_job   IN NUMBER   DEFAULT 1, 
   tab_name        IN VARCHAR2 DEFAULT NULL, 
   idx_name        IN VARCHAR2 DEFAULT NULL, 
   force_opt       IN BOOLEAN  DEFAULT FALSE);  
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6826"></a>Parameters</p>
<div id="ARPLS67391" class="tblformal">
<p class="titleintable"><a id="sthref6827"></a><a id="sthref6828"></a>Table 102-2 BUILD_PART_INDEX Procedure Parameters</p>
<table class="cellalignment1229" title="BUILD_PART_INDEX Procedure Parameters" summary="This table describes Parameters used by the BUILD_PART_INDEX subprogram." dir="ltr">
<thead>
<tr class="cellalignment1220">
<th class="cellalignment1227" id="r1c1-t5">Parameter</th>
<th class="cellalignment1227" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r2c1-t5" headers="r1c1-t5">
<p><code>jobs_per_batch</code></p>
</td>
<td class="cellalignment1228" headers="r2c1-t5 r1c2-t5">
<p>The number of concurrent partition-wise "local index builds".</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r3c1-t5" headers="r1c1-t5">
<p><code>procs_per_job</code></p>
</td>
<td class="cellalignment1228" headers="r3c1-t5 r1c2-t5">
<p>The number of parallel query slaves to be utilized for each local index build (1 &lt;= <code>procs_per_job</code> &lt;= <code>max_slaves</code>).</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r4c1-t5" headers="r1c1-t5">
<p><code>tab_name</code></p>
</td>
<td class="cellalignment1228" headers="r4c1-t5 r1c2-t5">
<p>The name of the partitioned table (an exception is raised if the table does not exist or not partitioned).</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r5c1-t5" headers="r1c1-t5">
<p><code>idx_name</code></p>
</td>
<td class="cellalignment1228" headers="r5c1-t5 r1c2-t5">
<p>The name given to the local index (an exception is raised if a local index is not created on the table <code>tab_name</code>).</p>
</td>
</tr>
<tr class="cellalignment1220">
<td class="cellalignment1228" id="r6c1-t5" headers="r1c1-t5">
<p><code>force_opt</code></p>
</td>
<td class="cellalignment1228" headers="r6c1-t5 r1c2-t5">
<p>If <code>TRUE</code>, then force rebuild of all partitioned indexes; otherwise, rebuild only the partitions marked '<code>UNUSABLE</code>'.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6829"></a>Usage Notes</p>
<p>This utility can be run only as table owner, and not as any other user.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref6830"></a>Examples</p>
<p>Suppose a table <code>PROJECT</code> is created with two partitions <code>PROJ001</code> and <code>PROJ002</code>, along with a local index <code>IDX</code>.</p>
<p>A call to the procedure <code>BUILD_PART_INDEX(2,4,'PROJECT','IDX',TRUE)</code> produces the following output:</p>
<pre>
SQLPLUS&gt; EXECUTE dbms_pclxutil.build_part_index(2,4,'PROJECT','IDX',TRUE); 
Statement processed. 
INFO: Job #21 created for partition PROJ002 with 4 slaves 
INFO: Job #22 created for partition PROJ001 with 4 slaves 
</pre></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect2" --></div>
<!-- class="refsect1" --></div>
<!-- class="refentry" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1219">
<tr>
<td class="cellalignment1228">
<table class="cellalignment1224">
<tr>
<td class="cellalignment1223"><a href="d_parallel_ex.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1223"><a href="d_pipe.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1231">
<table class="cellalignment1222">
<tr>
<td class="cellalignment1223"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1223"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1223"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1223"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1223"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1223"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
