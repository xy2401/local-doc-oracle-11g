<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Starting and Interacting with the RMAN&nbsp;Client</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T14:1:10Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery User's Guide" />
<meta name="dcterms.identifier" content="E10642-08" />
<meta name="dcterms.isVersionOf" content="BRADV" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="rcmarchi.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmconfb.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10642.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/47</span> <!-- End Header -->
<div id="BRADV005" class="chapter"><a id="CEGGAIIE"></a> <a id="i1010158"></a>
<h1 class="chapter"><span class="secnum">4</span> Starting and Interacting with the RMAN&nbsp;Client</h1>
<p>This chapter explains how to start the RMAN command-line interface and make database connections. This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#i1006174">Starting and Exiting RMAN</a></p>
</li>
<li>
<p><a href="#BABBCGIE">Specifying the Location of RMAN Output</a></p>
</li>
<li>
<p><a href="#i1007650">Setting Globalization Support Environment Variables for RMAN</a></p>
</li>
<li>
<p><a href="#BABEIDCF">Entering RMAN Commands</a></p>
</li>
<li>
<p><a href="#i1006020">Making Database Connections with RMAN</a></p>
</li>
<li>
<p><a href="#i1008446">Using the RMAN Pipe Interface</a></p>
</li>
</ul>
<a id="i1006174"></a>
<div id="BRADV8121" class="sect1">
<h2 class="sect1">Starting and Exiting RMAN</h2>
<p><a id="i1005921"></a>The RMAN executable is automatically installed with the database and is typically located in the same directory as the other database executables. For example, the RMAN client on Linux is located in <code dir="ltr">$ORACLE_HOME/bin</code>. You have the following basic options for starting RMAN:</p>
<ul>
<li>
<p>Start the RMAN executable at the operating system command line without specifying any connection options, as in the following example:</p>
<pre dir="ltr">
% rman
</pre></li>
<li>
<p>Start the RMAN executable at the operating system command line while connecting to a <a href="glossary.htm#i433583"><span class="xrefglossterm">target database</span></a> and, possibly, to a <a href="glossary.htm#i433280"><span class="xrefglossterm">recovery catalog</span></a>, as in the following examples:</p>
<pre dir="ltr">
% rman TARGET /                       # operating system authentication
% rman TARGET SYS@prod NOCATALOG      # RMAN prompts for SYS password
% rman TARGET / CATALOG rco@catdb     # RMAN prompts for rco password
</pre></li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Most RMAN commands require that RMAN connect to at least a target database to perform useful work. See <a href="#i1006020">"Making Database Connections with RMAN"</a> for more details about connecting RMAN to different types of databases.</div>
<p>To quit RMAN and terminate the program, enter <code dir="ltr">EXIT</code> or <code dir="ltr">QUIT</code> at the RMAN prompt:</p>
<pre dir="ltr">
RMAN&gt; EXIT
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF111" href="../../backup.112/e10643/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for RMAN command-line syntax</div>
</div>
<!-- class="sect1" -->
<a id="BABBCGIE"></a>
<div id="BRADV89382" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Specifying the Location of RMAN Output</h2>
<p>By default, RMAN writes command output to standard output. To redirect output to a log file, enter the <code dir="ltr">LOG</code> parameter on the command line when starting RMAN, as in the following example:</p>
<pre dir="ltr">
% rman LOG /tmp/rman.log
</pre>
<p>In this case, RMAN displays command input but does not display the RMAN output. The easiest way to send RMAN output both to a log file and to standard output is to use the Linux <code dir="ltr">tee</code> command or its equivalent. For example, the following technique enables both input and output to be visible in the RMAN command-line interface:</p>
<pre dir="ltr">
% rman | tee rman.log
RMAN&gt;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF111" href="../../backup.112/e10643/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about RMAN command-line options</div>
</div>
<!-- class="sect1" -->
<a id="i1007650"></a>
<div id="BRADV8122" class="sect1">
<h2 class="sect1">Setting Globalization Support Environment Variables for RMAN</h2>
<p><a id="sthref265"></a><a id="sthref266"></a><a id="sthref267"></a><a id="sthref268"></a><a id="sthref269"></a><a id="sthref270"></a>Before invoking RMAN, it may be useful to set the <code dir="ltr">NLS_DATE_FORMAT</code> and <code dir="ltr">NLS_LANG</code> environment variables. These variables determine the format used for the time parameters in RMAN commands such as <a class="olink RCMRF149" href="../../backup.112/e10643/rcmsynta2008.htm#RCMRF149"><code dir="ltr">RESTORE</code></a>, <a class="olink RCMRF140" href="../../backup.112/e10643/rcmsynta2001.htm#RCMRF140"><code dir="ltr">RECOVER</code></a>, and <a class="olink RCMRF147" href="../../backup.112/e10643/rcmsynta2006.htm#RCMRF147"><code dir="ltr">REPORT</code></a>.</p>
<p>The following example shows typical language and date format settings:</p>
<pre dir="ltr">
NLS_LANG=american
NLS_DATE_FORMAT='Mon DD YYYY HH24:MI:SS'
</pre>
<p><a id="sthref271"></a><a id="sthref272"></a>If you are going to use RMAN to connect to an unmounted database and mount the database later while RMAN is still connected, then set the <code dir="ltr">NLS_LANG</code> environment variable so that it also specifies the character set used by the database.</p>
<p>A database that is not mounted assumes the default character set, which is <code dir="ltr">US7ASCII</code>. If your character set is different from the default, then RMAN returns errors after the database is mounted. For example, if the character set is <code dir="ltr">WE8DEC</code>, then to avoid errors, you can set the <code dir="ltr">NLS_LANG</code> variable as follows:</p>
<pre dir="ltr">
NLS_LANG=american_america.we8dec
</pre>
<p>In order for the environment variable <a class="olink REFRN10119" href="../../server.112/e40402/initparams147.htm#REFRN10119"><code dir="ltr">NLS_DATE_FORMAT</code></a> to be applied and override the defaults set for the server in the server initialization file, the environment variable <code dir="ltr">NLS_LANG</code> must also be set.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink REFRN" href="../../server.112/e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a> for more information about the <code dir="ltr">NLS_LANG</code> and <code dir="ltr">NLS_DATE_FORMAT</code> parameters</p>
</li>
<li>
<p><a class="olink NLSPG" href="../../server.112/e10729/toc.htm"><span class="italic">Oracle Database Globalization Support Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABEIDCF"></a>
<div id="BRADV89383" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Entering RMAN Commands</h2>
<p>You can enter RMAN commands either directly from the RMAN prompt or read them in from a text file.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#BABHDIIE">Entering RMAN Commands at the RMAN Prompt</a></p>
</li>
<li>
<p><a href="#BABBDAEA">Using Command Files with RMAN</a></p>
</li>
<li>
<p><a href="#BABBCAEE">Entering Comments in RMAN Command Files</a></p>
</li>
<li>
<p><a href="#CHDFIGBC">Using Substitution Variables in Command Files</a></p>
</li>
<li>
<p><a href="#BABJJIJB">Checking RMAN Syntax</a></p>
</li>
</ul>
<a id="BABHDIIE"></a>
<div id="BRADV89384" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Entering RMAN Commands at the RMAN Prompt</h3>
<p>When the RMAN client is ready for your commands, it displays the command prompt, as in this example:</p>
<pre dir="ltr">
RMAN&gt; 
</pre>
<p>Enter commands for RMAN to execute. For example:</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET
RMAN&gt; BACKUP DATABASE;
</pre>
<p>Most RMAN commands take some parameters and must end with a semicolon. Some commands, such as <a class="olink RCMRF158" href="../../backup.112/e10643/rcmsynta2019.htm#RCMRF158"><code dir="ltr">STARTUP</code></a>, <a class="olink RCMRF155" href="../../backup.112/e10643/rcmsynta2016.htm#RCMRF155"><code dir="ltr">SHUTDOWN</code></a>, and <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><code dir="ltr">CONNECT</code></a>, can be used with or without a semicolon.</p>
<p>When you enter a line of text that is not a complete command, RMAN prompts for continuation input with a line number. For example:</p>
<pre dir="ltr">
RMAN&gt; BACKUP DATABASE
2&gt; INCLUDE CURRENT 
3&gt; CONTROLFILE
4&gt; ;
</pre></div>
<!-- class="sect2" -->
<a id="BABBDAEA"></a>
<div id="BRADV89385" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Command Files with RMAN</h3>
<p>For repetitive tasks, you can create a text file containing RMAN commands, and start the RMAN client with the <code dir="ltr">@</code> argument, followed by a file name. For example, create a text file <code dir="ltr">cmdfile1</code> in the current directory containing one line of text as shown here:</p>
<pre dir="ltr">
BACKUP DATABASE PLUS ARCHIVELOG;
</pre>
<p>You can run this command file from the command line as shown in this example, and the command contained in it is executed:</p>
<pre dir="ltr">
% rman TARGET / @cmdfile1
</pre>
<p>After the command completes, RMAN exits.</p>
<p>You can also use the <a class="olink RCMRF100" href="../../backup.112/e10643/rcmsynta001.htm#RCMRF100"><code dir="ltr">@</code></a> command at the RMAN command prompt to execute the contents of a command file during an <a href="glossary.htm#CHDHHCJB"><span class="xrefglossterm">RMAN session</span></a>. RMAN reads the file and executes the commands in it. For example:</p>
<pre dir="ltr">
RMAN&gt; @cmdfile1
</pre>
<p>After the command file contents have been executed, RMAN displays the following message:</p>
<pre dir="ltr">
RMAN&gt;  **end-of-file**
</pre>
<p>Unlike the case where a command file is executed from the operating system command line, RMAN does not exit.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF111" href="../../backup.112/e10643/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for RMAN command-line syntax</div>
</div>
<!-- class="sect2" -->
<a id="BABBCAEE"></a>
<div id="BRADV99960" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Entering Comments in RMAN Command Files</h3>
<p><a id="sthref273"></a>The comment character in RMAN is a pound sign (<code dir="ltr">#</code>). All text from the pound sign to the end of the line is ignored. For example, the following command file contents backs up the database and archived redo log files and includes comments:</p>
<pre dir="ltr">
# Command file name: mybackup.rman
# The following command backs up the database
BACKUP DATABASE;
# The following command backs up the archived redo logs
BACKUP ARCHIVELOG ALL;
</pre>
<p>The following example shows that you can break a single RMAN command across multiple lines:</p>
<pre dir="ltr">
RMAN&gt; BACKUP # this is a comment
2&gt; SPFILE;

Starting backup at 30-APR-07
allocated channel: ORA_DISK_1
     .
     .
     .
</pre></div>
<!-- class="sect2" -->
<a id="CHDFIGBC"></a>
<div id="BRADV89386" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Substitution Variables in Command Files</h3>
<p>When running a command file, you can specify one or more values in a <code dir="ltr">USING</code> clause for use in substitution variables in a command file. In this way, you can make your command files dynamic.</p>
<p>As in SQL*Plus, <code dir="ltr">&amp;1</code> indicates where to place the first value, <code dir="ltr">&amp;2</code> where to place the second value, and so on. The substitution variable syntax is <code dir="ltr">&amp;</code><code dir="ltr"><span class="codeinlineitalic">integer</span></code> followed by an optional period, for example, <code dir="ltr">&amp;1.3</code>. The optional period is part of the variable and replaced with the value, thus enabling the substitution text to be immediately followed by another integer. For example, if you pass the value <code dir="ltr">mybackup</code> to a command file containing the variable <code dir="ltr">&amp;1.3</code>, then the result of the substitution is <code dir="ltr">mybackup3</code>.</p>
<p>The following procedure explains how to create and use a dynamic shell script that calls a command file containing substitution variables.</p>
<p class="subhead2"><a id="BRADV561"></a>To create and use a dynamic shell script:</p>
<ol>
<li>
<p>Create an RMAN command file that uses substitution variables.</p>
<p>The following example shows the contents of a command file named <code dir="ltr">quarterly_backup.cmd</code>, which is run every quarter. The script uses substitution variables for the name of the tape set, for a string in the <code dir="ltr">FORMAT</code> specification, and for the name of the restore point to be created.</p>
<pre dir="ltr">
<a id="CHDICEJF"></a>
# quarterly_backup.cmd
CONNECT TARGET /
RUN
{
  ALLOCATE CHANNEL c1
    DEVICE TYPE sbt
    PARMS 'ENV=(OB_MEDIA_FAMILY=&amp;1)';
  BACKUP DATABASE 
    TAG &amp;2 
    FORMAT '/disk2/bck/&amp;1%U.bck'
    KEEP FOREVER 
    RESTORE POINT &amp;3;
}
EXIT;
</pre></li>
<li>
<p>Create a shell script that you can use to run the RMAN command file created in the previous step.</p>
<p>The following example creates a shell script named <code dir="ltr">runbackup.sh</code>. The example creates shell variables for the format and restore point name and accepts the values for these variables as command-line arguments to the script.</p>
<pre dir="ltr">
<a id="CHDJEAHJ"></a>
#!/bin/tcsh
# name: runbackup.sh
# usage: use the tag name and number of copies as arguments
set media_family = $argv[1]
set format = $argv[2]set restore_point = $argv[3]
rman @'/disk1/scripts/whole_db.cmd' USING $media_family $format $restore_point
</pre></li>
<li>
<p>Execute the shell script created in the previous step, specifying the desired arguments on the command line.</p>
<p>The following example runs the <code dir="ltr">runbackup.sh</code> shell script and passes it <code dir="ltr">archival_backup</code> as the media family name, <code dir="ltr">bck0906</code> as the format string, and <code dir="ltr">FY06Q3</code> as the restore point name.</p>
<pre dir="ltr">
% runbackup.sh archival_backup bck0906 FY06Q3
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF100" href="../../backup.112/e10643/rcmsynta001.htm#RCMRF100"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code dir="ltr">@</code> syntax</div>
</div>
<!-- class="sect2" -->
<a id="BABJJIJB"></a>
<div id="BRADV89387" class="sect2">
<h3 class="sect2">Checking RMAN Syntax</h3>
<p>You may want to test RMAN commands for syntactic correctness without executing them. Use the command-line argument <code dir="ltr">CHECKSYNTAX</code> to start the RMAN client in a mode in which it only parses the commands that you enter and returns an <code dir="ltr">RMAN-00558</code> error for commands that are not legal RMAN syntax.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF111" href="../../backup.112/e10643/rcmsynta2011.htm#RCMRF111"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code dir="ltr">CHECKSYNTAX</code> command-line option</div>
<div id="BRADV89388" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref274"></a>
<h4 class="sect3">Checking RMAN Syntax at the Command Line</h4>
<p>You can check the syntax of RMAN commands interactively without actually executing the commands.</p>
<p class="subhead2"><a id="BRADV562"></a>To check RMAN syntax at the command line:</p>
<ol>
<li>
<p>Start RMAN with the <code dir="ltr">CHECKSYNTAX</code> parameter.</p>
<p>For example, enter the following commands:</p>
<pre dir="ltr">
% rman CHECKSYNTAX
</pre></li>
<li>
<p>Enter the RMAN commands to be tested.</p>
<p>The following shows a sample interactive session, with user-entered text in bold.</p>
<pre dir="ltr">
<a id="BABIBDBB"></a>
RMAN&gt; <span class="bold">run [ backup database; ]</span>
 
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01006: error signaled during parse 
 RMAN-02001: unrecognized punctuation symbol "["
 
RMAN&gt; <span class="bold">run { backup database; }</span>

The command has no syntax errors

RMAN&gt;
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<div id="BRADV89389" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref275"></a>
<h4 class="sect3">Checking RMAN Syntax in Command Files</h4>
<p>To test commands in a command file, start RMAN with the <code dir="ltr">CHECKSYNTAX</code> parameter and use the <a class="olink RCMRF100" href="../../backup.112/e10643/rcmsynta001.htm#RCMRF100"><code dir="ltr">@</code></a> command to name the command file to be passed.</p>
<p class="subhead2"><a id="BRADV149"></a>To test commands in a command file:</p>
<ol>
<li>
<p>Use a text editor to create a command file.</p>
<p>Assume that you create the <code dir="ltr">/tmp/goodcmdfile</code> with the following contents:</p>
<pre dir="ltr">
# command file with legal syntax
RESTORE DATABASE; 
RECOVER DATABASE;
</pre>
<p>Assume that you create another command file, <code dir="ltr">/tmp/badcmdfile</code>, with the following contents:</p>
<pre dir="ltr">
# command file with bad syntax commands
RESTORE DATABASE
RECOVER DATABASE
</pre></li>
<li>
<p>Run the command file from the RMAN prompt in the following format, where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is the name of the command file:</p>
<pre dir="ltr">
% rman CHECKSYNTAX @<span class="italic">filename</span>
</pre>
<p>The following example shows the output when you run <code dir="ltr">/tmp/goodcmdfile</code> with <code dir="ltr">CHECKSYNTAX</code>:</p>
<pre dir="ltr">
<a id="CHDDCHAD"></a>
RMAN&gt; # command file with legal syntax
2&gt; restore database;
3&gt; recover database;
4&gt;
The cmdfile has no syntax errors
 
Recovery Manager complete.
</pre>
<p>In contrast, the following example shows the output when you run <code dir="ltr">/tmp/badcmdfile</code> with <code dir="ltr">CHECKSYNTAX</code>:</p>
<pre dir="ltr">
<a id="CHDHHAAJ"></a>
RMAN&gt; #command file with syntax error
2&gt; restore database
3&gt; recover
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01005: syntax error: found "recover": expecting one of: "archivelog, 
      channel, check, controlfile, clone, database, datafile, device, 
      from, force, high, (, preview, ;, skip, spfile, standby, tablespace, 
      until, validate"
RMAN-01007: at line 3 column 1 file: /tmp/badcmdfile
</pre></li>
</ol>
<p>As explained in <a href="#CHDFIGBC">"Using Substitution Variables in Command Files"</a>, you make your command files dynamic by including substitution variables. When you check the syntax of a command file that contains substitution variables, RMAN prompts you to enter values. <a href="#BABCBGJD">Example 4-1</a> illustrates what happens you enter invalid values when checking the syntax of a dynamic command file. The text in bold indicates text entered as the prompt.</p>
<div id="BRADV150" class="example">
<p class="titleinexample"><a id="BABCBGJD"></a>Example 4-1 Checking the Syntax of a Command File with Bad Syntax</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET *
2&gt; BACKUP TAG 
Enter value for 1: <span class="bold">mybackup</span>
abc COPIES 
Enter value for 2: <span class="bold">mybackup</span>
abc
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-00558: error encountered while parsing input commands
RMAN-01009: syntax error: found "identifier": expecting one of: "integer"
RMAN-01008: the bad identifier was: mybackup
RMAN-01007: at line 2 column 25 file: /tmp/whole_db.cmd
</pre></div>
<!-- class="example" -->
<p>RMAN indicates a syntax error because the string <code dir="ltr">mybackup</code> is not a valid argument for <code dir="ltr">COPIES</code>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006020"></a>
<div id="BRADV8123" class="sect1">
<h2 class="sect1">Making Database Connections with RMAN</h2>
<p><a id="sthref276"></a><a id="sthref277"></a>This section explains how to connect the RMAN client to target databases. It contains the following topics:</p>
<ul>
<li>
<p><a href="#BABJJCGB">About RMAN Database Connections</a></p>
</li>
<li>
<p><a href="#BABCIDCE">Connecting RMAN to an Auxiliary Database</a></p>
</li>
<li>
<p><a href="#i1008207">Making RMAN Database Connections Within Command Files</a></p>
</li>
<li>
<p><a href="#BABEDIAJ">Diagnosing RMAN Connection Problems</a></p>
</li>
</ul>
<a id="BABJJCGB"></a>
<div id="BRADV89390" class="sect2">
<h3 class="sect2">About RMAN Database Connections</h3>
<p><a id="sthref278"></a><a id="sthref279"></a>To perform useful work, the RMAN client must connect to a database. The following table describes the types of database connections that you can make with RMAN.</p>
<div id="BRADV151" class="tblruleformal">
<p class="titleintable"><a id="sthref280"></a><a id="sthref281"></a>Table 4-1 Overview of RMAN Database Connections</p>
<table class="cellalignment1945" title="Overview of RMAN Database Connections" summary="Types of RMAN database connections" dir="ltr">
<thead>
<tr class="cellalignment1934">
<th class="cellalignment1941" id="r1c1-t9">Type of Database Connection</th>
<th class="cellalignment1941" id="r1c2-t9">Keyword</th>
<th class="cellalignment1941" id="r1c3-t9">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r2c1-t9" headers="r1c1-t9">
<p><a href="glossary.htm#i433583"><span class="xrefglossterm">target database</span></a></p>
</td>
<td class="cellalignment1942" headers="r2c1-t9 r1c2-t9">
<p><code dir="ltr">TARGET</code></p>
</td>
<td class="cellalignment1942" headers="r2c1-t9 r1c3-t9">
<p>A database to be backed up or restored by RMAN</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r3c1-t9" headers="r1c1-t9">
<p><a href="glossary.htm#i433287"><span class="xrefglossterm">recovery catalog database</span></a></p>
</td>
<td class="cellalignment1942" headers="r3c1-t9 r1c2-t9">
<p><code dir="ltr">CATALOG</code></p>
</td>
<td class="cellalignment1942" headers="r3c1-t9 r1c3-t9">
<p>A database that provides an optional backup store for the RMAN repository in addition to the control file.</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r4c1-t9" headers="r1c1-t9">
<p><a href="glossary.htm#CHDDCDAC"><span class="xrefglossterm">auxiliary instance</span></a> or <a href="glossary.htm#i432021"><span class="xrefglossterm">auxiliary database</span></a></p>
</td>
<td class="cellalignment1942" headers="r4c1-t9 r1c2-t9">
<p><code dir="ltr">AUXILIARY</code></p>
</td>
<td class="cellalignment1942" headers="r4c1-t9 r1c3-t9">
<p>A <a href="glossary.htm#CHDEJBIJ"><span class="xrefglossterm">physical standby database</span></a>, or a database instance created for performing a specific task such as creating a <a href="glossary.htm#CHDBEFHG"><span class="xrefglossterm">duplicate database</span></a>, transporting tablespaces, or performing <a href="glossary.htm#i433562"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a>.</p>
<p>For many tasks that use an auxiliary database, RMAN creates an automatic auxiliary instance for use during the task, connects to it, performs the task, and then destroys it when the task is completed. You do not give any explicit command to connect to automatic auxiliary instances.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<a id="i1005954"></a>
<div id="BRADV89391" class="sect3">
<h4 class="sect3">Authentication for RMAN Database Connections</h4>
<p><a id="sthref282"></a><a id="sthref283"></a>RMAN connections to a database are specified and authenticated in the same way as SQL*Plus connections to a database. The only difference is that RMAN connections to a target or auxiliary database require the <code dir="ltr">SYSDBA</code> privilege. The <code dir="ltr">AS SYSDBA</code> keywords are implied for target and auxiliary connections and cannot be explicitly specified.</p>
<p>A <code dir="ltr">SYSDBA</code> privilege is not required when connecting to the recovery catalog. You must grant the <code dir="ltr">RECOVERY_CATALOG_OWNER</code> role to the catalog schema owner.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn about database connection options when using SQL*Plus</div>
<div id="BRADV90309" class="sect4"><a id="sthref284"></a>
<h5 class="sect4">Authentication for RMAN Database Connections Using the Operating System</h5>
<p>To connect to a database using operating system authentication, you must set the environment variable specifying the Oracle SID. For example, to set the SID to <code dir="ltr">prod</code> in some UNIX shells, you would enter:</p>
<pre dir="ltr">
% ORACLE_SID=prod; export ORACLE_SID
</pre>
<p>A special operating system groups controls <code dir="ltr">SYSDBA</code> connections when using operating system authentication. This group is generically referred to as OSDBA. The group is created and assigned a specific name as part of the database installation process. The specific name varies depending upon your operating system.</p>
<p>If the current operating system user is a member of the OSDBA group, and if the Oracle SID is set, then RMAN can connect to this database with <code dir="ltr">SYSDBA</code> privileges as follows:</p>
<pre dir="ltr">
% rman TARGET /
</pre></div>
<!-- class="sect4" -->
<div id="BRADV90306" class="sect4"><a id="sthref285"></a>
<h5 class="sect4">Authentication for RMAN Database Connections Using a Password File</h5>
<p>If a database uses a <a href="glossary.htm#CHDIDFHF"><span class="xrefglossterm">password file</span></a>, then RMAN can use a password to connect to this database. Use a password file for either local or remote access. You must use a password file if you are connecting remotely as <code dir="ltr">SYSDBA</code> with a net service name.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Good security practice requires that passwords should not be entered in plain text on the command line. You should enter passwords in RMAN only when requested by an RMAN prompt. See <a class="olink DBSEG0032" href="../../network.112/e36292/authentication.htm#DBSEG0032"><span class="italic">Oracle Database Security Guide</span></a> to learn about password protection.</div>
<p>You can start RMAN without a password in the connect string, as in this example:</p>
<pre dir="ltr">
% rman TARGET SYS@prod

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)
</pre>
<p>RMAN prompts for a password and does not echo the characters.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABJCDBA"></a>
<div id="BRADV89392" class="sect2">
<h3 class="sect2">Making RMAN Database Connections from the Operating System Command Line</h3>
<p>To connect to a target database from the operating system command line, enter the <code dir="ltr">rman</code> command followed by the connection information. You can begin executing commands after the RMAN prompt is displayed.</p>
<p>In the examples in this chapter, the generic values have the meanings shown in <a href="#CEGBGCCC">Table 4-2</a>.</p>
<div id="BRADV152" class="tblhruleformal">
<p class="titleintable"><a id="sthref286"></a><a id="CEGBGCCC"></a>Table 4-2 Values in Examples</p>
<table class="cellalignment1945" title="Values in Examples" summary="Explains the meanings of the values used in the examples" dir="ltr">
<thead>
<tr class="cellalignment1934">
<th class="cellalignment1941" id="r1c1-t12">Value Used in Example</th>
<th class="cellalignment1941" id="r1c2-t12">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r2c1-t12" headers="r1c1-t12">
<p><code dir="ltr">SYS</code></p>
</td>
<td class="cellalignment1942" headers="r2c1-t12 r1c2-t12">
<p>User with <code dir="ltr">SYSDBA</code> privileges</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r3c1-t12" headers="r1c1-t12">
<p><code dir="ltr">prod</code></p>
</td>
<td class="cellalignment1942" headers="r3c1-t12 r1c2-t12">
<p>The net service name for the target database</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r4c1-t12" headers="r1c1-t12">
<p><code dir="ltr">rco</code></p>
</td>
<td class="cellalignment1942" headers="r4c1-t12 r1c2-t12">
<p>User that owns the recovery catalog schema. This is a user defined in the recovery catalog database that has been granted the <code dir="ltr">RECOVERY_CATALOG_OWNER</code> role.</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r5c1-t12" headers="r1c1-t12">
<p><code dir="ltr">catdb</code></p>
</td>
<td class="cellalignment1942" headers="r5c1-t12 r1c2-t12">
<p>The net service name for the recovery catalog database</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r6c1-t12" headers="r1c1-t12">
<p><code dir="ltr">aux</code></p>
</td>
<td class="cellalignment1942" headers="r6c1-t12 r1c2-t12">
<p>The net service name for an auxiliary instance</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p><a href="#CHDHAFFI">Example 4-2</a> illustrates a connection to a target database that uses operating system authentication. The <code dir="ltr">NOCATALOG</code> option indicates that a recovery catalog is not used in the session.</p>
<div id="BRADV153" class="example">
<p class="titleinexample"><a id="CHDHAFFI"></a>Example 4-2 Connecting to a Target Database from the System Prompt</p>
<pre dir="ltr">
% rman TARGET / NOCATALOG

connected to target database: PROD (DBID=39525561)
using target database control file instead of recovery catalog
 
RMAN&gt;
</pre></div>
<!-- class="example" -->
<p><a href="#CHDIGBFC">Example 4-3</a> illustrates a connection to a target database that uses Oracle Net authentication. RMAN prompts for the password.</p>
<div id="BRADV563" class="example">
<p class="titleinexample"><a id="CHDIGBFC"></a>Example 4-3 Connecting to a Target Database from the System Prompt</p>
<pre dir="ltr">
% rman TARGET SYS@prod NOCATALOG

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)

RMAN&gt;
</pre></div>
<!-- class="example" -->
<p>Use the <code dir="ltr">CATALOG</code> keyword to connect to a recovery catalog. <a href="#BABJAFDA">Example 4-4</a> illustrates a connection that uses Oracle Net authentication for the target and recovery catalog databases. In both cases RMAN prompts for a password.</p>
<div id="BRADV155" class="example">
<p class="titleinexample"><a id="BABJAFDA"></a>Example 4-4 Connecting to Target and Catalog Databases from the System Prompt</p>
<pre dir="ltr">
% rman TARGET SYS@prod CATALOG rco@catdb

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)
recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt;
</pre></div>
<!-- class="example" -->
<p>You can also start RMAN without specifying <code dir="ltr">NOCATALOG</code> or <code dir="ltr">CATALOG</code>. If you do not specify <code dir="ltr">NOCATALOG</code> on the command line, and if you do not specify <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><code dir="ltr">CONNECT CATALOG</code></a> after RMAN has started, then RMAN defaults to <code dir="ltr">NOCATALOG</code> mode the first time that you run a command that requires the use of the RMAN repository.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
After you have executed a command that uses the RMAN repository in <code dir="ltr">NOCATALOG</code> mode, you must exit and restart RMAN to be able to connect to a recovery catalog.</div>
<p>If you connect to the target database on the operating system command line, then you can begin executing commands after the RMAN prompt is displayed.</p>
</div>
<!-- class="sect2" -->
<a id="BABIEHEA"></a>
<div id="BRADV89393" class="sect2">
<h3 class="sect2">Making Database Connections from the RMAN Prompt</h3>
<p>If you start RMAN without connecting to a target database, then you must issue a <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><code dir="ltr">CONNECT TARGET</code></a> command at the RMAN prompt to connect to a target database and begin performing useful work.</p>
<p class="subhead2"><a id="BRADV564"></a>To make a database connection from the RMAN prompt:</p>
<ol>
<li>
<p>On the operating system command line, start the RMAN client without making a database connection. For example, enter <code dir="ltr">rman</code> as follows:</p>
<pre dir="ltr">
% rman
RMAN&gt;
</pre></li>
<li>
<p>At the RMAN prompt, enter one or more <code dir="ltr">CONNECT</code> commands.</p>
<p>The following example connects to a target database using operating system authentication:</p>
<pre dir="ltr">
<a id="CHDJGBEH"></a>
RMAN&gt; CONNECT TARGET /
</pre>
<p>The following alternative example connects to a target database and then a recovery catalog. The target connection uses operating system authentication, whereas the catalog database connection uses Oracle Net authentication. RMAN prompts for the password of the recovery catalog user.</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database
</pre>
<p>The following example connects to a target database with database-level credentials. RMAN prompts for the <code dir="ltr">SYS</code> password.</p>
<pre dir="ltr">
<a id="CHDIDJIG"></a>
% rman
RMAN&gt; CONNECT TARGET SYS@prod

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code dir="ltr">CONNECT</code> command</div>
</div>
<!-- class="sect2" -->
<a id="BABCIDCE"></a>
<div id="BRADV128" class="sect2">
<h3 class="sect2">Connecting RMAN to an Auxiliary Database</h3>
<p><a id="sthref287"></a><a id="sthref288"></a>To use the <a class="olink RCMRF126" href="../../backup.112/e10643/rcmsynta020.htm#RCMRF126"><code dir="ltr">DUPLICATE</code></a> command, you must connect to an <a href="glossary.htm#CHDDCDAC"><span class="xrefglossterm">auxiliary instance</span></a>. To perform RMAN <a href="glossary.htm#i433562"><span class="xrefglossterm">tablespace point-in-time recovery (TSPITR)</span></a>, you may also need to connect to an auxiliary instance.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When you use the <code dir="ltr">DUPLICATE ... FROM ACTIVE DATABASE</code> command, a net service name is required. See <a href="rcmdupdb.htm#i1006474">"Step 5: Creating an Initialization Parameter File and Starting the Auxiliary Instance"</a> for more details.<a id="sthref289"></a><a id="sthref290"></a></div>
<p><a id="sthref291"></a>The form of an auxiliary connection is identical to a target database connection, except that you use the <code dir="ltr">AUXILIARY</code> keyword instead of the <code dir="ltr">TARGET</code> keyword. <a href="#BABIABJA">Example 4-5</a> connects to a target database and auxiliary instance from the RMAN prompt.</p>
<div id="BRADV565" class="example">
<p class="titleinexample"><a id="BABIABJA"></a>Example 4-5 Connecting to the Target and Auxiliary Databases from the RMAN Prompt</p>
<pre dir="ltr">
% rman
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT AUXILIARY SYS@aux

auxiliary database Password: <span class="italic">password</span>
connected to auxiliary database: PROD (DBID=30472568)
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="rcmdupdb.htm#BGBHBIFE">Chapter 24, "Duplicating a Database"</a> for more details on using the <a class="olink RCMRF126" href="../../backup.112/e10643/rcmsynta020.htm#RCMRF126"><code dir="ltr">DUPLICATE</code></a> command</p>
</li>
<li>
<p><a href="rcmtspit.htm#CIHGGAFH">Chapter 21, "Performing RMAN Tablespace Point-in-Time Recovery (TSPITR)"</a> for more details on performing TSPITR</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1008207"></a>
<div id="BRADV129" class="sect2">
<h3 class="sect2">Making RMAN Database Connections Within Command Files</h3>
<p><a id="sthref292"></a><a id="sthref293"></a><a id="sthref294"></a>If you create an RMAN command file which uses a <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><code dir="ltr">CONNECT</code></a> command with database level credentials (user name and password), then anyone with read access to this file can learn the password. There is no secure way to incorporate a <code dir="ltr">CONNECT</code> string with a password into a command file.</p>
<p>If you create an RMAN command file which uses a <code dir="ltr">CONNECT</code> command, then RMAN does not echo the connect string when you run the command file with the <a class="olink RCMRF100" href="../../backup.112/e10643/rcmsynta001.htm#RCMRF100"><code dir="ltr">@</code></a> command. This behavior prevents connect strings from appearing in any log files that contain RMAN output. For example, suppose you create a command file <code dir="ltr">listbkup.rman</code> as follows:</p>
<pre dir="ltr">
cat &gt; listbkup.rman &lt;&lt; EOF
CONNECT TARGET /
LIST BACKUP;
EOF
</pre>
<p>You execute this script by running RMAN with the <code dir="ltr">@</code> command line option as follows:</p>
<pre dir="ltr">
% rman @listbkup.rman
</pre>
<p>When the command file executes, RMAN replaces the connection string with an asterisk, as shown in the following output:</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET *
2&gt; LIST BACKUP;
3&gt;
connected to target database: RDBMS (DBID=771530996)

using target database control file instead of recovery catalog

List of Backup Sets
===================
. . .
</pre></div>
<!-- class="sect2" -->
<a id="BABEDIAJ"></a>
<div id="BRADV89394" class="sect2">
<h3 class="sect2">Diagnosing RMAN Connection Problems</h3>
<p>When diagnosing errors RMAN encounters in connecting to the target, catalog and auxiliary databases, using SQL*Plus to connect to the databases directly can reveal underlying problems with the connection information or the databases.</p>
<div id="BRADV89395" class="sect3"><a id="sthref295"></a>
<h4 class="sect3">Diagnosing Target and Auxiliary Database Connection Problems</h4>
<p>RMAN always connects to target and auxiliary databases using the <code dir="ltr">SYSDBA</code> privilege. Thus, when using SQL*Plus to diagnose connection problems to the target or auxiliary databases, request a <code dir="ltr">SYSDBA</code> connection to reproduce RMAN behavior.</p>
<p>For example, suppose that the following RMAN command encountered connection errors:</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET /
</pre>
<p>You reproduce the preceding connection attempt with the SQL*Plus command as follows:</p>
<pre dir="ltr">
SQL&gt; CONNECT / AS SYSDBA
</pre></div>
<!-- class="sect3" -->
<div id="BRADV89396" class="sect3"><a id="sthref296"></a>
<h4 class="sect3">Diagnosing Recovery Catalog Connection Problems</h4>
<p>When RMAN connects to the recovery catalog database, it does not use the <code dir="ltr">SYSDBA</code> privilege. So, when you are using SQL*Plus to diagnose connection problems to the recovery catalog database, you must enter the database connect string exactly as it was entered into RMAN. Do not specify <code dir="ltr">AS SYSDBA</code>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1008446"></a>
<div id="BRADV1130" class="sect1">
<h2 class="sect1">Using the RMAN Pipe Interface</h2>
<p><a id="sthref297"></a><a id="sthref298"></a><a id="sthref299"></a>The RMAN pipe interface is an alternative method for issuing commands to RMAN and receiving the output from those commands. With this interface, RMAN obtains commands and sends output by using the <a id="sthref300"></a><a id="sthref301"></a><code dir="ltr">DBMS_PIPE</code> PL/SQL package instead of the operating system shell. Using this interface, it is possible to write a portable programmatic interface to RMAN.</p>
<p>The pipe interface is invoked by using the <code dir="ltr">PIPE</code> command-line parameter for the RMAN client. RMAN uses two private pipes: one for receiving commands and the other for sending output. The names of the pipes are derived from the value of the <code dir="ltr">PIPE</code> parameter. For example, you can invoke RMAN with the following command:</p>
<pre dir="ltr">
% rman PIPE abc TARGET /
</pre>
<p>RMAN opens the two pipes in the target database: <code dir="ltr">ORA$RMAN_ABC_IN</code>, which RMAN uses to receive user commands, and <code dir="ltr">ORA$RMAN_ABC_OUT</code>, which RMAN uses to send all output back to RMAN. All messages on both the input and output pipes are of type <code dir="ltr">VARCHAR2</code>.</p>
<p>RMAN does not permit the pipe interface to be used with public pipes, because they are a potential security problem. With a public pipe, any user who knows the name of the pipe can send commands to RMAN and intercept its output.</p>
<p>If the pipes are not initialized, then RMAN creates them as private pipes. If you want to put commands on the input pipe before starting RMAN, you must first create the pipe by calling <a id="sthref302"></a><a id="sthref303"></a><a id="sthref304"></a><code dir="ltr">DBMS_PIPE.CREATE_PIPE</code>. Whenever a pipe is not explicitly created as a private pipe, the first access to the pipe automatically creates it as a public pipe, and RMAN returns an error if it is told to use a public pipe.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If multiple RMAN sessions can run against the target database, then you must use unique pipe names for each <a href="glossary.htm#CHDHHCJB"><span class="xrefglossterm">RMAN session</span></a>. The <code dir="ltr">DBMS_PIPE.UNIQUE_SESSION_NAME</code> function is one method that you can use to generate unique pipe names.</div>
<div id="BRADV89397" class="sect2"><a id="sthref305"></a>
<h3 class="sect2">Executing Multiple RMAN Commands in Succession Through a Pipe: Example</h3>
<p>This scenario assumes that the application controlling RMAN wants to run multiple commands in succession. After each command is sent down the pipe and executed and the output returned, RMAN pauses and waits for the next command.</p>
<p class="subhead2"><a id="BRADV158"></a>To execute RMAN commands through a pipe:</p>
<ol>
<li>
<p>Start RMAN by connecting to a target database (required) and specifying the <code dir="ltr">PIPE</code> option. For example, issue:</p>
<pre dir="ltr">
% rman PIPE abc TARGET /
</pre>
<p>You can also specify the <code dir="ltr">TIMEOUT</code> option, which forces RMAN to exit automatically if it does not receive any input from the input pipe in the specified number of seconds. For example, enter:</p>
<pre dir="ltr">
% rman PIPE abc TARGET / TIMEOUT 60
</pre></li>
<li>
<p>Connect to the target database and put the desired commands on the input pipe by using <code dir="ltr">DBMS_PIPE.PACK_MESSAGE</code> and <code dir="ltr">DBMS_PIPE.SEND_MESSAGE</code>. In pipe mode, RMAN issues message <code dir="ltr">RMAN-00572</code> when it is ready to accept input instead of displaying the standard RMAN prompt.</p>
</li>
<li>
<p>Read the RMAN output from the output pipe by using <code dir="ltr">DBMS_PIPE.RECEIVE_MESSAGE</code> and <code dir="ltr">DBMS_PIPE.UNPACK_MESSAGE</code>.</p>
</li>
<li>
<p>Repeat Steps 2 and 3 to execute further commands with the same RMAN instance that was started in Step 1.</p>
</li>
<li>
<p>If you used the <code dir="ltr">TIMEOUT</code> option when starting RMAN, then RMAN terminates automatically after not receiving any input for the specified length of time. To force RMAN to terminate immediately, send the <code dir="ltr">EXIT</code> command.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<div id="BRADV89398" class="sect2"><a id="sthref306"></a>
<h3 class="sect2">Executing RMAN Commands in a Single Job Through a Pipe: Example</h3>
<p>This scenario assumes that the application controlling RMAN wants to run one or more commands as a single job. After running the commands that are on the pipe, RMAN exits.</p>
<p class="subhead2"><a id="BRADV159"></a>To execute RMAN commands in a single job through a pipe:</p>
<ol>
<li>
<p>After connecting to the target database, create a pipe (if it does not exist under the name <code dir="ltr">ORA$RMAN_</code><span class="italic">pipe</span><code dir="ltr">_IN</code>).</p>
</li>
<li>
<p>Put the desired commands on the input pipe. In pipe mode, RMAN issues message <code dir="ltr">RMAN-00572</code> when it is ready to accept input instead of displaying the standard RMAN prompt.</p>
</li>
<li>
<p>Start RMAN with the <code dir="ltr">PIPE</code> option, and specify <code dir="ltr">TIMEOUT</code> <code dir="ltr">0</code>. For example, enter:</p>
<pre dir="ltr">
% rman PIPE abc TARGET / TIMEOUT 0
</pre></li>
<li>
<p>RMAN reads the commands that were put on the pipe and executes them by using <code dir="ltr">DBMS_PIPE.PACK_MESSAGE</code> and <code dir="ltr">DBMS_PIPE.SEND_MESSAGE</code>. When it has exhausted the input pipe, RMAN exits immediately.</p>
</li>
<li>
<p>Read RMAN output from the output pipe by using <code dir="ltr">DBMS_PIPE.RECEIVE_MESSAGE</code> and <code dir="ltr">DBMS_PIPE.UNPACK_MESSAGE</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS038" href="../../appdev.112/e40758/d_pipe.htm#ARPLS038"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for documentation on the <code dir="ltr">DBMS_PIPE</code> package</div>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1933">
<tr>
<td class="cellalignment1942">
<table class="cellalignment1938">
<tr>
<td class="cellalignment1937"><a href="rcmarchi.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1937"><a href="rcmconfb.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1944">
<table class="cellalignment1936">
<tr>
<td class="cellalignment1937"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1937"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1937"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1937"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1937"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1937"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
