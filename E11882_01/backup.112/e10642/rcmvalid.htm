<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Validating Database Files and Backups</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T14:1:11Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery User's Guide" />
<meta name="dcterms.identifier" content="E10642-08" />
<meta name="dcterms.isVersionOf" content="BRADV" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="rcmrepai.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmcomre.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10642.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">28/47</span> <!-- End Header -->
<div id="BRADV90063" class="chapter"><a id="CHDBFAIF"></a>
<h1 class="chapter"><span class="secnum">16</span> Validating Database Files and Backups</h1>
<p>This chapter explains how to check the integrity of database files and backups. This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDECGBJ">Overview of RMAN Validation</a></p>
</li>
<li>
<p><a href="#CHDBDCCG">Checking for Block Corruption with the VALIDATE Command</a></p>
</li>
<li>
<p><a href="#CHDCEHFD">Validating Database Files with BACKUP VALIDATE</a></p>
</li>
<li>
<p><a href="#i1031282">Validating Backups Before Restoring Them</a></p>
</li>
</ul>
<a id="CHDECGBJ"></a>
<div id="BRADV115" class="sect1">
<h2 class="sect1">Overview of RMAN Validation</h2>
<p>This section explains the basic concepts and tasks involved in RMAN validation.</p>
<div id="BRADV90064" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref1448"></a>
<h3 class="sect2">Purpose of RMAN Validation</h3>
<p>The main purpose of RMAN <a href="glossary.htm#i433696"><span class="xrefglossterm">validation</span></a> is to check for corrupt blocks and missing files. You can also use RMAN to determine whether backups can be restored. You can use the following RMAN commands to perform validation:</p>
<ul>
<li>
<p><code dir="ltr">VALIDATE</code></p>
</li>
<li>
<p><code dir="ltr">BACKUP ... VALIDATE</code></p>
</li>
<li>
<p><code dir="ltr">RESTORE ... VALIDATE</code></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink RCMRF162" href="../../backup.112/e10643/rcmsynta2024.htm#RCMRF162"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code dir="ltr">VALIDATE</code> syntax</p>
</li>
<li>
<p><a class="olink RCMRF149" href="../../backup.112/e10643/rcmsynta2008.htm#RCMRF149"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code dir="ltr">RESTORE ... VALIDATE</code> syntax</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<div id="BRADV90065" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref1449"></a>
<h3 class="sect2">Basic Concepts of RMAN Validation</h3>
<p><a id="sthref1450"></a>The <a id="sthref1451"></a>database prevents operations that result in unusable backup files or corrupted restored datafiles. The database automatically does the following:</p>
<ul>
<li>
<p>Blocks access to datafiles while they are being restored or recovered</p>
</li>
<li>
<p>Permits only one restore operation for each data file at a time</p>
</li>
<li>
<p>Ensures that incremental backups are applied in the correct order</p>
</li>
<li>
<p>Stores information in backup files to allow detection of corruption</p>
</li>
<li>
<p>Checks a block every time it is read or written in an attempt to report a corruption as soon as it has been detected</p>
</li>
</ul>
<div id="BRADV89566" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref1452"></a>
<h4 class="sect3">Checksums and Corrupt Blocks</h4>
<p>A <a id="sthref1453"></a><a href="glossary.htm#i432401"><span class="xrefglossterm">corrupt block</span></a> is a block that has been changed so that it differs from what Oracle Database expects to find. Block corruptions can be caused by various failures including, but not limited to the following:</p>
<ul>
<li>
<p>Faulty disks and disk controllers</p>
</li>
<li>
<p>Faulty memory</p>
</li>
<li>
<p>Oracle Database software defects</p>
</li>
</ul>
<p><code dir="ltr">DB_BLOCK_CHECKSUM</code> <a id="sthref1454"></a>is a database initialization parameter that controls the writing of checksums for the blocks in datafiles and online redo log files in the database (not backups). If <code dir="ltr">DB_BLOCK_CHECKSUM</code> is <code dir="ltr">typical</code>, then the database computes a checksum for each block during normal operations and stores it in the header of the block before writing it to disk. When the database reads the block from disk later, it recomputes the checksum and compares it to the stored value. If the values do not match, then the block is corrupt.</p>
<p>By default, the <code dir="ltr">BACKUP</code> command computes a checksum for each block and stores it in the backup. The <code dir="ltr">BACKUP</code> command ignores the values of <code dir="ltr">DB_BLOCK_CHECKSUM</code> because this initialization parameter applies to datafiles in the database, not backups.</p>
</div>
<!-- class="sect3" -->
<div id="BRADV991" class="sect3"><a id="sthref1455"></a>
<h4 class="sect3">Physical and Logical Block Corruption</h4>
<p>In a <a id="sthref1456"></a><a href="glossary.htm#CHDBIGAC"><span class="xrefglossterm">physical corruption</span></a>, which is also called a media corruption, the database does not recognize the block at all: the <a href="glossary.htm#CHDIHJHF"><span class="xrefglossterm">checksum</span></a> is invalid, the block contains all zeros, or the header and footer of the block do not match.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
By default, the <code dir="ltr">BACKUP</code> command computes a checksum for each block and stores it in the backup. If you specify the <code dir="ltr">NOCHECKSUM</code> option, then RMAN does not perform a checksum of the blocks when creating the backup.</div>
<p>In a <a id="sthref1457"></a><a href="glossary.htm#CHDFJGFF"><span class="xrefglossterm">logical corruption</span></a>, the contents of the block are logically inconsistent. Examples of logical corruption include corruption of a row piece or index entry. If RMAN detects logical corruption, then it logs the block in the alert log and server session trace file.</p>
<p>By default, RMAN does not check for logical corruption. If you specify <code dir="ltr">CHECK LOGICAL</code> on the <code dir="ltr">BACKUP</code> command, however, then RMAN tests data and index blocks for logical corruption, such as corruption of a row piece or index entry, and log them in the alert log located in the <a id="sthref1458"></a><a href="glossary.htm#CHDDAHBD"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a>. If you use RMAN with the following configuration when backing up or restoring files, then it detects all types of block corruption that are possible to detect:</p>
<ul>
<li>
<p>In the initialization parameter file of a database, set <code dir="ltr">DB_BLOCK_CHECKSUM=typical</code> so that the database calculates data file checksums automatically (not for backups, but for data files in use by the database)</p>
</li>
<li>
<p>Do not precede the <code dir="ltr">BACKUP</code> command with <code dir="ltr">SET MAXCORRUPT</code> so that RMAN does not tolerate any unmarked block corruptions.</p>
</li>
<li>
<p>In a <code dir="ltr">BACKUP</code> command, do <span class="italic">not</span> specify the <code dir="ltr">NOCHECKSUM</code> option so that RMAN calculates a checksum when writing backups</p>
</li>
<li>
<p>In <code dir="ltr">BACKUP</code> and <code dir="ltr">RESTORE</code> commands, specify the <code dir="ltr">CHECK</code> <code dir="ltr">LOGICAL</code> option so that RMAN checks for logical and physical corruption</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<div id="BRADV89567" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref1459"></a>
<h4 class="sect3">Limits for Corrupt Blocks in RMAN Backups</h4>
<p><a id="sthref1460"></a>You can use the <code dir="ltr">SET MAXCORRUPT</code> command to set the total number of unmarked corruptions permitted in a file for RMAN backups. The default is zero, meaning that RMAN does not tolerate unmarked corrupt blocks of any kind.</p>
<p>If the <code dir="ltr">MAXCORRUPT</code> limit is exceeded when RMAN encounters an unmarked corrupt block during a backup, then RMAN terminates the backup. Otherwise, RMAN writes the newly detected corrupt block to the backup with a special header indicating that the block is marked corrupt. You can use the <code dir="ltr">VALIDATE</code> command to determine which blocks are already marked as corrupt and to find any previously unmarked corrupt blocks.</p>
<p>Because RMAN allows previously marked corrupt blocks in a backup, and because RMAN can be instructed to allow previously unmarked corrupt blocks to be marked as corrupt in the backup (when <code dir="ltr">MAXCORRUPT</code> is used), it is possible to restore a data file that has several blocks marked as corrupt. If you backup this restored data file (assuming no new corruptions have happened), even without <code dir="ltr">MAXCORRUPT</code> setting, then the backup succeeds. This is because the previously marked corruptions do not stop RMAN from completing the backup.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF153" href="../../backup.112/e10643/rcmsynta2014.htm#RCMRF153"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code dir="ltr">SET</code> <code dir="ltr">MAXCORRUPT</code> syntax</div>
</div>
<!-- class="sect3" -->
<div id="BRADV994" class="sect3"><a id="sthref1461"></a>
<h4 class="sect3">Detection of Block Corruption</h4>
<p>Oracle Database supports different techniques for detecting, repairing, and monitoring block corruption. The technique depends on whether the corruption is <a href="glossary.htm#CHDIADHG"><span class="xrefglossterm">interblock corruption</span></a> or <a href="glossary.htm#CHDIBBCC"><span class="xrefglossterm">intrablock corruption</span></a>. In intrablock corruption, the corruption occurs within the block itself. This corruption can be either physical or logical. In an interblock corruption, the corruption occurs between blocks and can only be logical.</p>
<p>For example, <a id="sthref1462"></a>the <a class="olink REFRN30048" href="../../server.112/e40402/dynviews_1098.htm#REFRN30048"><code dir="ltr">V$DATABASE_BLOCK_CORRUPTION</code></a> view records intrablock corruptions, while the <a id="sthref1463"></a><a href="glossary.htm#CHDDAHBD"><span class="xrefglossterm">Automatic Diagnostic Repository (ADR)</span></a> tracks all types of corruptions. <a id="sthref1464"></a><a id="sthref1465"></a><a id="sthref1466"></a><a href="#CHDEICIB">Table 16-1</a> summarizes how the database treats different types of block corruption.</p>
<div id="BRADV336" class="tblruleformalwide">
<p class="titleintable"><a id="sthref1467"></a><a id="CHDEICIB"></a>Table 16-1 Detection, Repair, and Monitoring of Block Corruption</p>
<table class="cellalignment1945" title="Detection, Repair, and Monitoring of Block Corruption" summary="Describes how the database handles block corruption." dir="ltr">
<thead>
<tr class="cellalignment1934">
<th class="cellalignment1941" id="r1c1-t5">Response</th>
<th class="cellalignment1941" id="r1c2-t5">Intrablock Corruption</th>
<th class="cellalignment1941" id="r1c3-t5">Interblock Corruption</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r2c1-t5" headers="r1c1-t5">
<p>Detection</p>
</td>
<td class="cellalignment1942" headers="r2c1-t5 r1c2-t5">
<p>All database utilities detect intrablock corruption, including RMAN (for example, the <code dir="ltr">BACKUP</code> command) and the DBVERIFY utility. If a database process can encounter the <code dir="ltr">ORA-1578</code> error, then it can detect the corruption and monitor it.</p>
</td>
<td class="cellalignment1942" headers="r2c1-t5 r1c3-t5">
<p>Only DBVERIFY and the <code dir="ltr">ANALYZE</code> statement detect interblock corruption.</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r3c1-t5" headers="r1c1-t5">
<p>Tracking</p>
</td>
<td class="cellalignment1942" headers="r3c1-t5 r1c2-t5">
<p>The <code dir="ltr">V$DATABASE_BLOCK_CORRUPTION</code> view displays blocks marked corrupt by Oracle Database components such as RMAN commands, <code dir="ltr">ANALYZE</code>, <code dir="ltr">dbv</code>, SQL queries, and so on. Any process that encounters an intrablock corruption records the block corruption in this view and in ADR.</p>
</td>
<td class="cellalignment1942" headers="r3c1-t5 r1c3-t5">
<p>The database monitors this type of block corruption in ADR.</p>
</td>
</tr>
<tr class="cellalignment1934">
<td class="cellalignment1942" id="r4c1-t5" headers="r1c1-t5">
<p>Repair</p>
</td>
<td class="cellalignment1942" headers="r4c1-t5 r1c2-t5">
<p>Repair techniques include <a id="sthref1468"></a><a href="glossary.htm#i432160"><span class="xrefglossterm">block media recovery</span></a>, restoring data files, recovering with incremental backups, and block newing. Block media recovery can repair physical corruptions, but not logical corruptions.</p>
<p>Any RMAN command that fixes or detects that a block is repaired updates <code dir="ltr">V$DATABASE_BLOCK_CORRUPTION</code>. For example, RMAN updates the repository at end of successful block media recovery. If a <code dir="ltr">BACKUP</code>, <code dir="ltr">RESTORE</code>, or <code dir="ltr">VALIDATE</code> command detects that a block is no longer corrupted, then it removes the repaired block from the view.</p>
</td>
<td class="cellalignment1942" headers="r4c1-t5 r1c3-t5">
<p>You must fix interblock corruption with manual techniques such as dropping an object, rebuilding an index, and so on.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformalwide" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="rcmcomre.htm#g1047425">Chapter 17, "Performing Complete Database Recovery"</a></p>
</li>
<li>
<p><a href="rcmblock.htm#CHDCBIIB">Chapter 19, "Performing Block Media Recovery"</a></p>
</li>
<li>
<p><a class="olink ADMIN11257" href="../../server.112/e25494/diag.htm#ADMIN11257"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn about ADR</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDBDCCG"></a>
<div id="BRADV89563" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Checking for Block Corruption with the VALIDATE Command</h2>
<p><a id="sthref1469"></a><a id="sthref1470"></a><a id="sthref1471"></a><a id="sthref1472"></a><a id="sthref1473"></a><a id="sthref1474"></a><a id="sthref1475"></a><a id="sthref1476"></a><a id="sthref1477"></a><a id="sthref1478"></a><a id="sthref1479"></a><a id="sthref1480"></a><a id="sthref1481"></a><a id="sthref1482"></a><a id="sthref1483"></a>You can use the <a class="olink RCMRF162" href="../../backup.112/e10643/rcmsynta2024.htm#RCMRF162"><code dir="ltr">VALIDATE</code></a> command to manually check for physical and logical corruptions in database files. This command performs the same types of checks as<a id="sthref1484"></a><a id="sthref1485"></a><a id="sthref1486"></a> <code dir="ltr">BACKUP VALIDATE</code>, but <code dir="ltr">VALIDATE</code> can check a larger selection of objects. For example, you can validate individual blocks with the <code dir="ltr">VALIDATE DATAFILE ... BLOCK</code> command.</p>
<p>When validating whole files, RMAN checks every block of the input files. If the backup validation discovers previously unmarked corrupt blocks, then RMAN updates the <a id="sthref1487"></a><a id="sthref1488"></a><a id="sthref1489"></a><code dir="ltr">V$DATABASE_BLOCK_CORRUPTION</code> view with rows describing the corruptions.</p>
<p>Use <code dir="ltr">VALIDATE BACKUPSET</code> when you suspect that one or more backup pieces in a backup set are missing or have been damaged. This command checks every block in a backup set to ensure that the backup can be restored. If RMAN finds block corruption, then it issues an error and terminates the validation. The command <code dir="ltr">VALIDATE BACKUPSET</code> enables you to choose which backups to check, whereas the <code dir="ltr">VALIDATE</code> option of the <code dir="ltr">RESTORE</code> command lets RMAN choose.</p>
<p class="subhead2"><a id="BRADV337"></a>To use VALIDATE to check database files and backups:</p>
<ol>
<li>
<p>Start RMAN and connect to a target database.</p>
</li>
<li>
<p>Execute the <code dir="ltr">VALIDATE</code> command with the desired options.</p>
<p>For example, to validate all datafiles and control files (and the server parameter file if one is in use), execute the following command at the RMAN prompt:</p>
<pre dir="ltr">
RMAN&gt; VALIDATE DATABASE;
</pre>
<p>Alternatively, you can validate a particular backup set by using the form of the command shown in the following example (sample output included).</p>
<pre dir="ltr">
RMAN&gt; VALIDATE BACKUPSET 22;

Starting validate at 17-AUG-06
using channel ORA_DISK_1
allocated channel: ORA_SBT_TAPE_1
channel ORA_SBT_TAPE_1: SID=89 device type=SBT_TAPE
channel ORA_SBT_TAPE_1: Oracle Secure Backup
channel ORA_DISK_1: starting validation of datafile backup set
channel ORA_DISK_1: reading from backup piece /disk1/oracle/work/orcva/RDBMS/backupset/2007_08_16/o1_mf_nnndf_TAG20070816T153034_2g774bt2_.bkp
channel ORA_DISK_1: piece handle=/disk1/oracle/work/orcva/RDBMS/backupset/2007_08_16/o1_mf_nnndf_TAG20070816T153034_2g774bt2_.bkp tag=TAG20070816T153034
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: validation complete, elapsed time: 00:00:01
Finished validate at 17-AUG-06
</pre>
<p>The following example illustrates how you can check individual <a id="sthref1490"></a>data blocks within a data file for corruption.</p>
<pre dir="ltr">
RMAN&gt; VALIDATE DATAFILE 1 BLOCK 10;
 
Starting validate at 17-AUG-06
using channel ORA_DISK_1
channel ORA_DISK_1: starting validation of datafile
channel ORA_DISK_1: specifying datafile(s) for validation
input datafile file number=00001 name=/disk1/oracle/dbs/tbs_01.f
channel ORA_DISK_1: validation complete, elapsed time: 00:00:01
List of Datafiles
=================
File Status Marked Corrupt Empty Blocks Blocks Examined High SCN
---- ------ -------------- ------------ --------------- ----------
1    OK     0              2            127             481907
  File Name: /disk1/oracle/dbs/tbs_01.f
  Block Type Blocks Failing Blocks Processed
  ---------- -------------- ----------------
  Data       0              36
  Index      0              31
  Other      0              58

Finished validate at 17-AUG-06
</pre></li>
</ol>
<p class="subhead2"><a id="CHDDJJAI"></a><a id="BRADV613"></a>Make Parallel the Validation of a Data File</p>
<p><a id="sthref1491"></a><a id="sthref1492"></a>If you must validate a large data file, then RMAN can make the work parallel by dividing the file into sections and processing each <a id="sthref1493"></a><a href="glossary.htm#CHDHHBFC"><span class="xrefglossterm">file section</span></a> in parallel. If multiple channels are configured or allocated, and if you want the channels to make parallel the validation, then specify <a id="sthref1494"></a>the <code dir="ltr">SECTION SIZE</code> parameter of the <code dir="ltr">VALIDATE</code> command.</p>
<p>If you specify a section size that is larger than the size of the file, then RMAN does not create file sections. If you specify a small section size that would produce more than 256 sections, then RMAN increases the section size to a value that results in exactly 256 sections.</p>
<p class="subhead2"><a id="BRADV338"></a>To make parallel the validation of a data file:</p>
<ol>
<li>
<p>Start RMAN and connect to a target database. The target database must be mounted or open.</p>
</li>
<li>
<p>Run <code dir="ltr">VALIDATE</code> with the <code dir="ltr">SECTION SIZE</code> parameter.</p>
<p>The following example allocates two channels and validates a large data file. The section size is 1200 MB.</p>
<pre dir="ltr">
RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
  ALLOCATE CHANNEL c2 DEVICE TYPE DISK;
  VALIDATE DATAFILE 1 SECTION SIZE 1200M;
}
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="rcmbckad.htm#CHDBAHAD">"Dividing the Backup of a Large Data File into Sections"</a></p>
</li>
<li>
<p><a class="olink RCMRF162" href="../../backup.112/e10643/rcmsynta2024.htm#RCMRF162"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code dir="ltr">VALIDATE</code> command</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CHDCEHFD"></a>
<div id="BRADV89562" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Validating Database Files with BACKUP VALIDATE</h2>
<p><a id="sthref1495"></a><a id="sthref1496"></a><a id="sthref1497"></a><a id="sthref1498"></a><a id="sthref1499"></a><a id="sthref1500"></a><a id="sthref1501"></a><a id="sthref1502"></a><a id="sthref1503"></a><a id="sthref1504"></a><a id="sthref1505"></a><a id="sthref1506"></a><a id="sthref1507"></a><a id="sthref1508"></a>You can use the <code dir="ltr">BACKUP VALIDATE</code> command to do the following:</p>
<ul>
<li>
<p>Check datafiles for physical and logical block corruption</p>
</li>
<li>
<p>Confirm that all database files exist and are in the correct locations</p>
</li>
</ul>
<p>When you run <code dir="ltr">BACKUP</code> <code dir="ltr">VALIDATE</code>, RMAN reads the files to be backed up in their entirety, as it would during a real backup. RMAN does not, however, actually produce any backup sets or image copies.</p>
<p>You cannot use the <code dir="ltr">BACKUPSET</code>, <code dir="ltr">MAXCORRUPT</code>, or <code dir="ltr">PROXY</code> parameters with <code dir="ltr">BACKUP VALIDATE</code>. To validate specific backup sets, run the <code dir="ltr">VALIDATE</code> command.</p>
<p class="subhead2"><a id="BRADV339"></a>To validate files with the BACKUP VALIDATE command:</p>
<ol>
<li>
<p>Start RMAN and connect to a target database and recovery catalog (if used).</p>
</li>
<li>
<p>Run the <code dir="ltr">BACKUP VALIDATE</code> command.</p>
<p>For example, you can validate that all database files and archived logs can be backed up by running a command as shown in the following example. This command checks for physical corruptions only.</p>
<pre dir="ltr">
BACKUP VALIDATE 
  DATABASE 
  ARCHIVELOG ALL;
</pre>
<p>To check for logical corruptions in addition to physical corruptions, run the following variation of the preceding command:</p>
<pre dir="ltr">
BACKUP VALIDATE 
  CHECK LOGICAL 
  DATABASE 
  ARCHIVELOG ALL;
</pre>
<p>In the preceding examples, the RMAN client displays the same output that it would if it were really backing up the files. If RMAN cannot back up one or more of the files, then it issues an error message. For example, RMAN may show output similar to the following:</p>
<pre dir="ltr">
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of backup command at 08/29/2007 14:33:47
ORA-19625: error identifying file /oracle/oradata/trgt/arch/archive1_6.dbf
ORA-27037: unable to obtain file status
SVR4 Error: 2: No such file or directory
Additional information: 3
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink RCMRF107" href="../../backup.112/e10643/rcmsynta007.htm#RCMRF107"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for <code dir="ltr">BACKUP</code> syntax</p>
</li>
<li>
<p><a href="rcmblock.htm#CHDCBIIB">Chapter 19, "Performing Block Media Recovery"</a>to learn how to repair corrupt blocks discovered by <code dir="ltr">BACKUP</code> <code dir="ltr">VALIDATE</code></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1031282"></a>
<div id="BRADV8156" class="sect1">
<h2 class="sect1">Validating Backups Before Restoring Them</h2>
<p><a id="sthref1509"></a>You can run <code dir="ltr">RESTORE</code> <code dir="ltr">...</code> <code dir="ltr">VALIDATE</code> to test whether RMAN can restore a specific file or set of files from a backup. RMAN chooses which backups to use.</p>
<p>The database must be mounted or open for this command. You do not have to take datafiles offline when validating the restore of datafiles, because validation of backups of the datafiles only reads the backups and does not affect the production datafiles.</p>
<p>When validating files on disk or tape, RMAN reads all blocks in the backup piece or image copy. RMAN also validates offsite backups. The validation is identical to a real restore operation except that RMAN does not write output files.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
As an additional test measure, you can perform a <a id="sthref1510"></a><a href="glossary.htm#CHDDIHDD"><span class="xrefglossterm">trial recovery</span></a> with <a id="sthref1511"></a>the <code dir="ltr">RECOVER ... TEST</code> command. A trial recovery applies redo in a way similar to normal recovery, but it is in memory only and it rolls back its changes after the trial.</div>
<p class="subhead2"><a id="BRADV340"></a>To validate backups with the <code dir="ltr">RESTORE</code> command:</p>
<ol>
<li>
<p>Run the <code dir="ltr">RESTORE</code> command with the <code dir="ltr">VALIDATE</code> option.</p>
<p>This following example illustrates validating the restore of the database and all archived redo logs:</p>
<pre dir="ltr">
RESTORE DATABASE VALIDATE;
RESTORE ARCHIVELOG ALL VALIDATE;
</pre>
<p>If you do <span class="italic">not</span> see an RMAN error stack, then skip the subsequent steps. The lack of error messages means that RMAN had confirmed that it can use these backups successfully during a real restore and recovery.</p>
</li>
<li>
<p>If you see error messages in the output and the <code dir="ltr">RMAN-06026</code> message, then investigate the cause of the problem. If possible, correct the problem that is preventing RMAN from validating the backups and retry the validation.</p>
<p>The following error means that RMAN cannot restore one or more of the specified files from your available backups:</p>
<pre dir="ltr">
RMAN-06026: some targets not found - aborting restore
</pre>
<p>The following sample output shows that RMAN encountered a problem reading the specified backup:</p>
<pre dir="ltr">
RMAN-03009: failure of restore command on c1 channel at 12-DEC-06 23:22:30
ORA-19505: failed to identify file "oracle/dbs/1fafv9gl_1_1"
ORA-27037: unable to obtain file status
SVR4 Error: 2: No such file or directory
Additional information: 3
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF149" href="../../backup.112/e10643/rcmsynta2008.htm#RCMRF149"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> to learn about the <code dir="ltr">RESTORE ... VALIDATE</code> command</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1933">
<tr>
<td class="cellalignment1942">
<table class="cellalignment1938">
<tr>
<td class="cellalignment1937"><a href="rcmrepai.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1937"><a href="rcmcomre.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1944">
<table class="cellalignment1936">
<tr>
<td class="cellalignment1937"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1937"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1937"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1937"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1937"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1937"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
