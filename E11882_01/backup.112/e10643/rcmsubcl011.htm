<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>keepOption</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:48Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsubcl010.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsubcl012.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">79/158</span> <!-- End Header --><a id="i97063"></a>
<div id="RCMRF131" class="refsect1">
<h1 class="refsect1">keepOption<a id="sthref2356"></a><a id="sthref2357"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2358"></a>Purpose</p>
<p>Use the <a id="BABEHFCA"></a><code dir="ltr"><span class="codeinlineitalic">keepOption</span></code> subclause to specify the status of a backup or copy in relation to a retention policy.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2359"></a>Syntax</p>
<p class="subhead2"><a id="BABGDGCC"></a><a id="RCMRF90451"></a><span class="italic">keepOption</span>::=</p>
<img width="531" height="76" src="img/keepoption.gif" alt="Description of keepoption.gif follows" /><br />
<a id="sthref2360" href="img_text/keepoption.htm">Description of the illustration keepoption.gif</a><br />
<br /></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2361"></a>Usage Notes</p>
<p>RMAN does not consider backup pieces with the <code dir="ltr">KEEP</code> option when computing the backup retention policy. If available, RMAN uses these backups for disaster recovery restore operations, but their purpose is to produce a snapshot of the database that can be restored on another system for testing or historical usage.</p>
<p>When creating archival backups with <code dir="ltr">KEEP</code>, RMAN only considers <code dir="ltr">KEEP</code> backups with the same tag. Thus, when using <code dir="ltr"><span class="codeinlineitalic">keepOption</span></code> with <code dir="ltr"><span class="codeinlineitalic">notBackedUpSpec</span></code>, RMAN only skips a backup if it finds the specified maximum number of <code dir="ltr">KEEP</code> backups with the same tag. Other backups are not counted.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2362"></a>Semantics</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for keepOption Subclause" summary="Describes keepOption subclause parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t17">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t17">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t17" headers="r1c1-t17"><code dir="ltr"><a id="sthref2363"></a>KEEP</code></td>
<td class="cellalignment1926" headers="r2c1-t17 r1c2-t17">Specifies the backup as an <span class="glossaryterm">archival backup</span>, which is a self-contained backup that is exempt from the configured retention policy.
<p>An archival backup is self-contained because is contains all files necessary to restore the backup and recover it to a consistent state. If the database is open during the backup, then RMAN automatically generates and backs up the archived redo log files needed to make the database backup consistent (see <a href="rcmsynta007.htm#CHDCIBCJ">Example 2-26</a>).</p>
<p>RMAN does not consider backup pieces with the <code dir="ltr">KEEP</code> option when computing the retention policy. If available, RMAN uses these backups for disaster recovery restore operations, but their purpose is to produce a snapshot of the database that can be restored on another system for testing or historical usage.</p>
<p><span class="bold">Note:</span> You cannot use <code dir="ltr">KEEP</code> to override the retention policy for files stored in the fast recovery area. If you specify <code dir="ltr">KEEP</code> when backing up to the recovery area, then RMAN issues an error.</p>
<p>When <code dir="ltr">KEEP</code> is specified, RMAN creates multiple backup sets. RMAN backs up data files, archived redo log files, the control file, and the server parameter file with the options specified in the first <code dir="ltr"><span class="codeinlineitalic">backupOperand</span></code>. Since a backup of the control file is already created, an autobackup of the control file is not created. RMAN uses the <code dir="ltr">FORMAT</code>, <code dir="ltr">POOL</code>, and <code dir="ltr">TAG</code> parameters for all the backups. For this reason, the <code dir="ltr">FORMAT</code> string must allow for the creation of multiple backup pieces. Specifying <code dir="ltr"><a href="rcmsubcl010.htm#BABGHHGH"><code dir="ltr">%U</code></a></code> is the easiest way to meet this requirement.</p>
<p><span class="bold">See Also:</span> <a href="rcmsynta010.htm#i80338">CONFIGURE</a> and <span class="italic">Oracle Database Backup and Recovery User's Guide</span> to learn more about autobackup of the control file.</p>
<p>When <code dir="ltr">KEEP</code> is specified with <code dir="ltr">INCREMENTAL LEVEL</code>, the parent backup must be a <code dir="ltr">KEEP</code> backup and have the same <code dir="ltr">TAG</code> string. Unless both these criteria are met, the backup cannot be created. Backups that meet these criteria do not interfere with other nightly or archival backup tasks.</p>
<p><span class="bold">Note:</span> A recovery catalog is only required for <code dir="ltr">KEEP FOREVER</code>. No other <code dir="ltr">KEEP</code> options require a catalog.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t17" headers="r1c1-t17"><code dir="ltr">&nbsp;&nbsp;&nbsp;FOREVER</code></td>
<td class="cellalignment1926" headers="r3c1-t17 r1c2-t17">Specifies that the backup or copy never becomes obsolete (see <a href="rcmsynta007.htm#CHDJJIJG">Example 2-27</a>). A recovery catalog is required when <code dir="ltr">FOREVER</code> is specified because the backup records eventually age out of the control file.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t17" headers="r1c1-t17"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;UNTIL&nbsp;TIME</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;'</code><code dir="ltr"><span class="codeinlineitalic">date_string</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r4c1-t17 r1c2-t17">Specifies the time until which the backup or copy must be kept. After this time the backup is obsolete, regardless of the backup retention policy settings.
<p>You can either specify a specific time by using the current <code dir="ltr">NLS_DATE_FORMAT</code>, or a SQL date expression such as <code dir="ltr">'SYSDATE+365'</code>. If you specify a <code dir="ltr">KEEP TIME</code> such as <code dir="ltr">01-JAN-07</code>, then the backup becomes obsolete one second after midnight on this date. If you specify a <code dir="ltr">KEEP</code> time such as 9:00 p.m, then the backup becomes obsolete at 9:01 p.m.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t17" headers="r1c1-t17"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;RESTORE&nbsp;POINT</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">restore_point_name</span></code></td>
<td class="cellalignment1926" headers="r5c1-t17 r1c2-t17">Creates a normal restore point matching the SCN to which RMAN must recover the backup to a consistent state (see <a href="rcmsynta007.htm#CHDCIBCJ">Example 2-26</a>). The restore point name must not exist.
<p>The SCN is captured just after the data file backups complete. The restore point is a label for the SCN to which this archival backup can be restored and recovered, enabling the database to be opened. In contrast, the <code dir="ltr">UNTIL TIME</code> clause specifies the date until which the backup must be kept.</p>
<p><span class="bold">Note:</span> The <code dir="ltr">RESTORE POINT</code> parameter is not valid with the <code dir="ltr"><a href="rcmsynta009.htm#i79920">CHANGE</a></code> command.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t17" headers="r1c1-t17"><code dir="ltr"><a id="sthref2364"></a>NOKEEP</code></td>
<td class="cellalignment1926" headers="r6c1-t17 r1c2-t17">Specifies that any <code dir="ltr">KEEP</code> attributes no longer apply to the backup. Thus, the backup is a normal backup that is subject to the configured backup retention policy. This is the default behavior if no <code dir="ltr">KEEP</code> option is specified.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref2365"></a>Examples</p>
<div id="RCMRF90452" class="example">
<p class="titleinexample"><a id="sthref2366"></a>Example 4-23 Creating a Consistent Database Backup for Archival</p>
<p>This example makes a database backup with tag <code dir="ltr">Q107</code> and specifies that it should never be considered obsolete (partial sample output included). The archived redo log files necessary to make the data files consistent are included in the backup set.</p>
<pre dir="ltr">
RMAN&gt; BACKUP TAG Q107 DATABASE KEEP FOREVER;

Starting backup at 24-JAN-07

current log archived
allocated channel: ORA_SBT_TAPE_1
channel ORA_SBT_TAPE_1: SID=105 device type=SBT_TAPE
channel ORA_SBT_TAPE_1: Oracle Secure Backup
backup will never be obsolete
archived logs required to recover from this backup will be backed up
channel ORA_SBT_TAPE_1: starting full datafile backup set
channel ORA_SBT_TAPE_1: specifying datafile(s) in backup set
.
.
.
</pre></div>
<!-- class="example" -->
<div id="RCMRF90453" class="example">
<p class="titleinexample"><a id="sthref2367"></a>Example 4-24 Removing the KEEP Attributes for a Backup</p>
<p>This example backs up all archived redo log files. The <code dir="ltr">KEEP</code> clause specifies that one second after midnight on January 1, 2008 the backup is considered obsolete.</p>
<pre dir="ltr">
RMAN&gt; BACKUP KEEP UNTIL TIME '01-JAN-08' ARCHIVELOG ALL;
</pre>
<p>The following command removes the <code dir="ltr">KEEP</code> attributes of all archived redo log backups (sample output included):</p>
<pre dir="ltr">
RMAN&gt; CHANGE BACKUP OF ARCHIVELOG ALL NOKEEP;
 
using channel ORA_SBT_TAPE_1
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=77 device type=DISK
keep attributes for the backup are deleted
backup set key=330 RECID=19 STAMP=612722760
keep attributes for the backup are deleted
backup set key=397 RECID=22 STAMP=612722884
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsubcl010.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsubcl012.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
