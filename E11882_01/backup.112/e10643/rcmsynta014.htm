<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>CREATE SCRIPT</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:40Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta013.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta015.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">27/158</span> <!-- End Header --><a id="i1000575"></a>
<div id="RCMRF118" class="refsect1">
<h1 class="refsect1">CREATE SCRIPT<a id="ABC1060697"></a><a id="ABC1060697SRI1"></a><a id="ABC1060697SRI12"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref749"></a>Purpose</p>
<p>Use the <a id="CHDJFFBC"></a><code dir="ltr">CREATE SCRIPT</code> command to create a stored script in the recovery catalog. A stored script is a sequence of RMAN commands that is given a name and stored in the recovery catalog for later execution.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink BRADV182" href="../../backup.112/e10642/rcmcatdb.htm#BRADV182"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> to learn how to use stored scripts</p>
</li>
<li>
<p><code dir="ltr"><a href="rcmsynta2005.htm#i84552">REPLACE SCRIPT</a></code> to learn how to update a stored script</p>
</li>
</ul>
</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref750"></a>Prerequisites</p>
<p>Execute <code dir="ltr">CREATE SCRIPT</code> only at the RMAN prompt. RMAN must be connected to a target database and a recovery catalog. The recovery catalog database must be open.</p>
<p>If <code dir="ltr">GLOBAL</code> is specified, then a global script with this name must not exist in the recovery catalog. If <code dir="ltr">GLOBAL</code> is not specified, then a local script must not exist with the same name for the same target database. In you do not meet these prerequisites, then RMAN returns error <code dir="ltr"><a id="sthref751"></a><a id="sthref752"></a>RMAN-20401</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CHDBJHHH"></a>Usage Notes</p>
<p>A stored script may be local or global. A local script is created for the current target database only, whereas a global script is available for use with any database registered in the recovery catalog.</p>
<p>It is permissible to create a global script with the same name as a local script, or a local script with the same name as a global script.</p>
<p class="subhead2"><a id="RCMRF90121"></a>Substitution Variables in Stored Scripts</p>
<p><a id="sthref753"></a><a id="sthref754"></a><a id="sthref755"></a><a id="sthref756"></a>RMAN supports the use of substitution variables in a stored script. <code dir="ltr">&amp;1</code> indicates where to place the first value, <code dir="ltr">&amp;2</code> indicate where to place the second value, and so on. Special characters must be quoted.</p>
<p>The substitution variable syntax is <code dir="ltr">&amp;</code><code dir="ltr"><span class="codeinlineitalic">integer</span></code> followed by an optional period, for example, <code dir="ltr">&amp;1.3</code>. The optional period is part of the variable and replaced with the value, thus enabling the substitution text to be immediately followed by another integer. For example, if you pass the value <code dir="ltr">mybackup</code> to a command file that contains the substitution variable <code dir="ltr">&amp;1.3</code>, then the result of the substitution is <code dir="ltr">mybackup3</code>. To create the result <code dir="ltr">mybackup.3</code>, you use the syntax <code dir="ltr">&amp;1..3</code>.</p>
<p>When you create a stored script with substitution variables, you must provide example values at create time. You can provide these values with the <code dir="ltr">USING</code> clause when starting RMAN (see <code dir="ltr"><a href="rcmsynta2011.htm#i80108">RMAN</a></code>) or enter them when prompted (see <a href="#CHDBBABA">Example 2-62</a>).</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref757"></a>Syntax</p>
<p class="subhead2"><a id="RCMRF90122"></a><span class="italic">createScript</span>::=</p>
<img width="583" height="206" src="img/createscript.gif" alt="Description of createscript.gif follows" /><br />
<a id="sthref758" href="img_text/createscript.htm">Description of the illustration createscript.gif</a><br />
<br />
<p><a href="rcmsynta2012.htm#CHDIDAJB"><span class="xreftitleitalic"><span class="italic">backupCommands</span>::=</span></a>, <a href="rcmsynta2012.htm#CHDHAGID"><span class="xreftitleitalic"><span class="italic">maintenanceCommands</span>::=</span></a>, <a href="rcmsynta2012.htm#CHDJFJFH"><span class="xreftitleitalic"><span class="italic">miscellaneousCommands</span>::=</span></a>, <a href="rcmsynta2012.htm#CHDIFJGG"><span class="xreftitleitalic"><span class="italic">restoreCommands</span>::=</span></a>)</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref759"></a>Semantics</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics of CREATE SCRIPT Command" summary="Describes CREATE SCRIPT command parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t62">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t62">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t62" headers="r1c1-t62"><code dir="ltr"><a id="sthref760"></a>GLOBAL</code></td>
<td class="cellalignment1926" headers="r2c1-t62 r1c2-t62">Identifies the script as global.
<p><span class="bold">Note:</span> A virtual private catalog has read-only access to global scripts. Creating or updating global scripts must be done while connected to the base recovery catalog.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t62" headers="r1c1-t62"><code dir="ltr">SCRIPT</code> <code dir="ltr"><span class="codeinlineitalic">script_name</span></code></td>
<td class="cellalignment1926" headers="r3c1-t62 r1c2-t62">Specifies the name of the script. Quotes must be used around the script name when the name contains either spaces or reserved words.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t62" headers="r1c1-t62"><code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref761"></a>COMMENT</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">comment</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r4c1-t62 r1c2-t62">Associates an explanatory comment with the stored script in the recovery catalog. The comment is used in the output of <code dir="ltr"><a href="rcmsynta027.htm#i82460">LIST</a></code> <code dir="ltr">SCRIPT NAMES</code>.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t62" headers="r1c1-t62"><code dir="ltr"><span class="codeinlineitalic">backupCommands</span></code>
<p><code dir="ltr"><span class="codeinlineitalic">maintenanceCommands</span></code></p>
<p><code dir="ltr"><span class="codeinlineitalic">miscellaneousCommands</span></code></p>
<p><code dir="ltr"><span class="codeinlineitalic">restoreCommands</span></code></p>
</td>
<td class="cellalignment1926" headers="r5c1-t62 r1c2-t62">Specifies commands to include in the stored script. The commands allowable within the brackets of the <code dir="ltr">CREATE SCRIPT</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">script_name</span></code><code dir="ltr">'</code> <code dir="ltr">{</code><code dir="ltr">...</code><code dir="ltr">}</code> command are the same commands supported within a <code dir="ltr"><a href="rcmsynta2012.htm#i85731">RUN</a></code> command. Any command that is valid within a <code dir="ltr">RUN</code> command is permitted in the stored script. The following commands are not valid within stored scripts: <code dir="ltr"><a href="rcmsynta2012.htm#i85731">RUN</a></code>, <code dir="ltr"><a href="rcmsynta001.htm#BGBFADED">@ (at sign)</a></code>, and <code dir="ltr"><a href="rcmsynta002.htm#i78210">@@ (double at sign)</a></code>.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t62" headers="r1c1-t62"><code dir="ltr">FROM&nbsp;<a id="sthref762"></a><a id="sthref763"></a>FILE '</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r6c1-t62 r1c2-t62">Reads the sequence of commands to define the script from the specified file.
<p>The file should look like the body of a valid stored script. The first line of the file must be a left brace (<code dir="ltr">{</code>) and the last line must contain a right brace (<code dir="ltr">}</code>). The RMAN commands in the file must be valid in a stored script.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref764"></a><a id="sthref765"></a>Examples</p>
<div id="RCMRF90123" class="example">
<p class="titleinexample"><a id="sthref766"></a>Example 2-60 Creating a Local Stored Script</p>
<p>Assume that you want to create a local stored script for backing up database <code dir="ltr">prod</code>. You start RMAN, connect to <code dir="ltr">prod</code> as <code dir="ltr">TARGET</code>, and connect to a recovery catalog. You create a stored script called <code dir="ltr">backup_whole</code> and then use <code dir="ltr"><a href="rcmsynta021.htm#i82011">EXECUTE SCRIPT</a></code> to run it as follows:</p>
<pre dir="ltr">
CREATE SCRIPT backup_whole 
COMMENT "backup whole database and archived redo log files"
{
    BACKUP 
      INCREMENTAL LEVEL 0 TAG backup_whole
      FORMAT "/disk2/backup/%U"
      DATABASE PLUS ARCHIVELOG;
}
RUN { EXECUTE SCRIPT backup_whole; }
</pre></div>
<!-- class="example" -->
<div id="RCMRF90124" class="example">
<p class="titleinexample"><a id="CHDFABFG"></a>Example 2-61 Creating a Global Stored Script</p>
<p>This example connects RMAN to target database <code dir="ltr">prod</code> and recovery catalog database <code dir="ltr">catdb</code> as catalog user <code dir="ltr">rco</code>. The example creates a global script called <code dir="ltr">global_backup_db</code> that backs up the database and archived redo log files:</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET SYS@prod

target database Password: <span class="italic">password</span>
connected to target database: PROD (DBID=39525561)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE GLOBAL SCRIPT global_backup_db { BACKUP DATABASE PLUS ARCHIVELOG; }
RMAN&gt; EXIT;
</pre>
<p>You can now connect RMAN to a different target database such as <code dir="ltr">prod2</code> and run the global stored script:</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET SYS@prod2

target database Password: <span class="italic">password</span>
connected to target database: PROD2 (DBID=36508508)

RMAN&gt; CONNECT CATALOG rco@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; RUN { EXECUTE SCRIPT global_backup_db; }
</pre></div>
<!-- class="example" -->
<div id="RCMRF90125" class="example">
<p class="titleinexample"><a id="CHDBBABA"></a>Example 2-62 Creating a Stored Script That Uses Substitution Variables</p>
<p>The following example connects RMAN to a target database and recovery catalog and uses <code dir="ltr"><a href="#i1000575">CREATE SCRIPT</a></code> to create a backup script that includes three substitution variables. RMAN prompts you to enter initial values for the variables (user input is shown in bold).</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT CATALOG rman@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; CREATE SCRIPT backup_df 
2&gt; { BACKUP DATAFILE &amp;1 TAG &amp;2.1 FORMAT '/disk1/&amp;3_%U'; }
 Enter value for 1: <span class="bold">1</span>
 
Enter value for 2: <span class="bold">df1_backup</span>
 
Enter value for 3: <span class="bold">df1</span>

starting full resync of recovery catalog
full resync complete
created script backup_df
 
</pre>
<p>When you run <code dir="ltr"><a href="rcmsynta021.htm#i82011">EXECUTE SCRIPT</a></code>, you can pass different values to the script. The following example passes the values <code dir="ltr">3</code>, <code dir="ltr">test_backup</code>, and <code dir="ltr">test</code> to the substitution variables in the stored script:</p>
<pre dir="ltr">
RMAN&gt; RUN { EXECUTE SCRIPT backup_df USING 3 test_backup df3; }
</pre>
<p>After the values are substituted, the script executes as follows:</p>
<pre dir="ltr">
BACKUP DATAFILE 3 TAG test_backup1 FORMAT '/disk1/df3_%U';
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta013.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta015.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
