<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DELETE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:41Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta015.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta017.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">29/158</span> <!-- End Header --><a id="i81315"></a>
<div id="RCMRF121" class="refsect1">
<h1 class="refsect1">DELETE<a id="ABC1061604"></a><a id="ABC1061604SRI1"></a><a id="ABC1061604SRI12"></a><a id="ABC1061604SRI123"></a><a id="ABC1061604SRI1234"></a><a id="ABC1061604SRI12345"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref789"></a>Purpose</p>
<p>Use the <a id="CHDFEJHF"></a><code dir="ltr">DELETE</code> command to perform the following actions:</p>
<ul>
<li>
<p>Delete physical backups and copies.</p>
</li>
<li>
<p>Update the repository records in the target control file to show that the files are deleted. For example, the record for a backup piece in <code dir="ltr">V$BACKUP_PIECE.STATUS</code> shows the value <code dir="ltr">D</code>.</p>
</li>
<li>
<p>Remove the repository records for deleted files from the recovery catalog (if you use a catalog). For example, <code dir="ltr">RC_BACKUP_PIECE</code> no longer contains a row for a deleted backup piece.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<code dir="ltr"><a href="rcmsynta007.htm#i78895">BACKUP</a></code> to learn about the <code dir="ltr">BACKUP ... DELETE INPUT</code> command</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref790"></a>Prerequisites</p>
<p>RMAN must be connected to a target database, which must be mounted or open.</p>
<p>RMAN uses all configured channels to perform the deletion. If you use <code dir="ltr">DELETE</code> for files on devices that are <span class="italic">not</span> configured for automatic channels, then you must use <code dir="ltr"><a href="rcmsynta005.htm#i78398">ALLOCATE CHANNEL FOR MAINTENANCE</a></code>. For example, if you made a backup with an SBT channel, but only a disk channel is configured, then you must manually allocate an SBT channel for <code dir="ltr">DELETE</code>. An automatic or manually allocated maintenance channel is required when you use <code dir="ltr">DELETE</code> on a disk-only file.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref791"></a>Usage Notes</p>
<p>The best practice is to run <code dir="ltr"><a href="rcmsynta015.htm#i81077">CROSSCHECK</a></code> to update the status of backups and copies in the repository and then run <code dir="ltr">DELETE</code> to remove the desired files. When running RMAN interactively, <code dir="ltr">DELETE</code> displays a list of files and prompts for confirmation before deleting any file in the list. If you confirm, then RMAN shows each item as it is deleted. When reading commands from a command file, RMAN does not prompt for confirmation.</p>
<p>You can view the status of backups and copies recorded in the RMAN repository through <code dir="ltr"><a href="rcmsynta027.htm#i82460">LIST</a></code>, <code dir="ltr">V$</code> views, or recovery catalog views (if you use a catalog). The repository record for a backup can fail to reflect its physical status. For example, a user deletes a disk backup with the Linux <code dir="ltr">rm</code> command. The backup record cannot be updated by <code dir="ltr">rm</code>, so the RMAN repository shows the file as available although it no longer exists.</p>
<p class="subhead2"><a id="RCMRF90133"></a>Behavior of DELETE Command for Files of Different Status Values</p>
<p><a href="#CHDCHAJJ">Table 2-5</a> describes the behavior of <code dir="ltr">DELETE</code> when the <code dir="ltr">FORCE</code> option is not specified.</p>
<div id="RCMRF90134" class="tblruleformal">
<p class="titleintable"><a id="sthref792"></a><a id="CHDCHAJJ"></a>Table 2-5 Behavior of DELETE Command Without FORCE Option</p>
<table class="cellalignment1929" title="Behavior of DELETE Command Without FORCE Option" summary="Describes the effect of DELETE on files by status" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t67">Repository Status</th>
<th class="cellalignment1930" id="r1c2-t67">Physical Status</th>
<th class="cellalignment1930" id="r1c3-t67">Behavior of DELETE Command</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t67" headers="r1c1-t67">
<p><code dir="ltr"><a id="sthref793"></a>AVAILABLE</code></p>
</td>
<td class="cellalignment1926" headers="r2c1-t67 r1c2-t67">
<p>Not found on media</p>
</td>
<td class="cellalignment1926" headers="r2c1-t67 r1c3-t67">
<p>Does not delete the object and reports the list of mismatched objects after the job. RMAN does not update the repository status.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t67" headers="r1c1-t67">
<p><code dir="ltr"><a id="sthref794"></a>EXPIRED</code></p>
</td>
<td class="cellalignment1926" headers="r3c1-t67 r1c2-t67">
<p>Found on media</p>
</td>
<td class="cellalignment1926" headers="r3c1-t67 r1c3-t67">
<p>Does not delete the object and reports the list of mismatched objects after the job. RMAN does not update the repository status.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t67" headers="r1c1-t67">
<p><code dir="ltr"><a id="sthref795"></a>UNAVAILABLE</code></p>
</td>
<td class="cellalignment1926" headers="r4c1-t67 r1c2-t67">
<p>Any</p>
</td>
<td class="cellalignment1926" headers="r4c1-t67 r1c3-t67">
<p>Removes repository record and deletes object if it exists. All I/O errors are ignored.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<p class="subhead2"><a id="RCMRF90135"></a>Backup Deletion in a Data Guard Environment</p>
<p><a id="sthref796"></a><a href="rcmsynta007.htm#CHDJIIGD">"RMAN Backups in a Data Guard Environment"</a> explains the difference between the association and accessibility of a backup. In a Data Guard environment, the database that creates a backup or copy is associated with the file. You can use maintenance commands such as <code dir="ltr">CHANGE</code>, <code dir="ltr"><a href="#i81315">DELETE</a></code>, and <code dir="ltr"><a href="rcmsynta015.htm#i81077">CROSSCHECK</a></code> for backups when connected to any database in the Data Guard environment if the backups are accessible. In general, RMAN considers tape backups created on any database as accessible to all databases in the environment, whereas disk backups are accessible only to the database that created them.</p>
<p>If a deletion is successful, then RMAN removes the metadata for the file, even if the file is associated with another database. If a deletion was not successful, and if the file is associated with another database in the Data Guard environment, then RMAN prompts you to perform the same <code dir="ltr">DELETE</code> command while connected as <code dir="ltr">TARGET</code> to the database associated with the file. You must use <code dir="ltr">DELETE ... FORCE</code> to delete the file metadata.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref797"></a>Syntax</p>
<p class="subhead2"><a id="RCMRF90136"></a><span class="italic"><a id="sthref798"></a><a id="sthref799"></a>delete</span>::=</p>
<img width="676" height="103" src="img/delete.gif" alt="Description of delete.gif follows" /><br />
<a id="sthref800" href="img_text/delete.htm">Description of the illustration delete.gif</a><br />
<br />
<p>(<a href="rcmsubcl014.htm#BABFBCJA"><span class="xreftitleitalic"><span class="italic">maintSpec</span>::=</span></a>, <a href="rcmsubcl015.htm#BABFCBDE"><span class="xreftitleitalic"><span class="italic">obsOperandList</span>::=</span></a>, <a href="rcmsubcl006.htm#BABDEJAC"><span class="xreftitleitalic"><span class="italic">deviceSpecifier</span>::=</span></a>)</p>
<p class="subhead2"><a id="RCMRF90137"></a><a id="sthref801"></a><a id="sthref802"></a><a href="rcmsubcl014.htm#BABFBDDF"><span class="xreftitleitalic"><span class="italic">maintSpec</span></span></a>::=</p>
<img width="362" height="194" src="img/maintspec.gif" alt="Description of maintspec.gif follows" /><br />
<a id="sthref803" href="img_text/maintspec.htm">Description of the illustration maintspec.gif</a><br />
<br />
<p>(<a href="rcmsubcl012.htm#BABBEIIJ"><span class="xreftitleitalic"><span class="italic">listObjList</span>::=</span></a>, <a href="rcmsubcl002.htm#BABJGBFG"><span class="xreftitleitalic"><span class="italic">archivelogRecordSpecifier</span>::=</span></a>, <a href="rcmsubcl013.htm#BABEEGAJ"><span class="xreftitleitalic"><span class="italic">maintQualifier</span>::=</span></a>, <a href="rcmsubcl006.htm#BABDEJAC"><span class="xreftitleitalic"><span class="italic">deviceSpecifier</span>::=</span></a>, <a href="rcmsubcl016.htm#BABEIAEB"><span class="xreftitleitalic"><span class="italic">recordSpec</span>::=</span></a>)</p>
<p class="subhead2"><a id="RCMRF90138"></a><a id="sthref804"></a><a id="sthref805"></a><a href="rcmsubcl008.htm#BABBBGBC"><span class="xreftitleitalic"><span class="italic">forDbUniqueNameOption</span>::=</span></a></p>
<img width="381" height="64" src="img/fordbuniquenameoption.gif" alt="Description of fordbuniquenameoption.gif follows" /><br />
<a id="sthref806" href="img_text/fordbuniquenameoption.htm">Description of the illustration fordbuniquenameoption.gif</a><br />
<br /></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref807"></a>Semantics</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics of the DELETE Command" summary="Describes DELETE command parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t68">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t68">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t68" headers="r1c1-t68"><code dir="ltr"><a id="sthref808"></a>FORCE</code></td>
<td class="cellalignment1926" headers="r2c1-t68 r1c2-t68">Deletes specified files&mdash;whether or not they exist on the media&mdash;and removes repository records (see <a href="#CHDBBFBE">Example 2-68</a>).
<p>RMAN ignores any I/O errors for the deleted objects. RMAN also ignores any <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> <code dir="ltr"><a href="rcmsynta010.htm#CHDHCEEH">ARCHIVELOG&nbsp;DELETION&nbsp;POLICY</a></code> settings. RMAN displays the number of deleted objects after the job.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t68" headers="r1c1-t68"><code dir="ltr"><a id="sthref809"></a>NOPROMPT</code></td>
<td class="cellalignment1926" headers="r3c1-t68 r1c2-t68">Deletes specified files without first listing the files or prompting for confirmation. The <code dir="ltr">DELETE NOPROMPT</code> command displays each item as it is deleted.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t68" headers="r1c1-t68"><code dir="ltr"><a id="sthref810"></a><a id="sthref811"></a>EXPIRED</code></td>
<td class="cellalignment1926" headers="r4c1-t68 r1c2-t68">Removes only files whose status in the repository is <code dir="ltr">EXPIRED</code> (see <a href="#CHDFHGAJ">Example 2-65</a>). RMAN marks backups and copies as expired when you run a <code dir="ltr">CROSSCHECK</code> command and the files are absent or inaccessible. To determine which files are expired, run a <code dir="ltr">LIST EXPIRED</code> command.
<p>If for some reason a backup marked <code dir="ltr">EXPIRED</code> exists when you run the <code dir="ltr">DELETE EXPIRED</code> command, then RMAN does not delete the physical file.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t68" headers="r1c1-t68"><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl014.htm#i92412">maintSpec</a></span></code></td>
<td class="cellalignment1926" headers="r5c1-t68 r1c2-t68">Deletes backups and copies.
<p>You can set rules for the deletion with the <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl013.htm#i83829">maintQualifier</a></span></code> clause. For example, you can delete archived redo log files that have been backed up to tape (see <a href="#CHDFCDDE">Example 2-67</a>).</p>
<p><span class="bold">Note:</span> <code dir="ltr">DELETE ARCHIVELOG ALL</code> considers only the archived log deletion policy and does not consider the configured retention policy.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl014.htm#i92412">maintSpec</a></span></code> and <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl013.htm#i83829">maintQualifier</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t68" headers="r1c1-t68"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl008.htm#BABEACAI">forDbUniqueNameOption</a></span></code></td>
<td class="cellalignment1926" headers="r6c1-t68 r1c2-t68">Deletes the backups and copies in <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl014.htm#i92412">maintSpec</a></span></code> that are exclusively associated with the specified <a id="sthref812"></a><code dir="ltr">DB_UNIQUE_NAME</code> in a Data Guard environment.
<p><span class="bold">Note:</span> The <code dir="ltr">FOR DB_UNIQUE_NAME</code> option is not allowed with the <code dir="ltr">DELETE OBSOLETE</code> command.</p>
<p>If RMAN successfully deletes tape backups associated with the specified <code dir="ltr">DB_UNIQUE_NAME</code>, then RMAN removes the metadata for these files from the recovery catalog. If RMAN could not delete these files because they are associated with a different database in the Data Guard environment, then RMAN prompts you to perform the same <code dir="ltr">DELETE</code> operation for these files at the database that is associated with them.</p>
<p><span class="bold">Note:</span> You cannot use <code dir="ltr">FORCE</code> to override the default behavior and specify that RMAN should delete files that are associated with a different database. In this way, RMAN protects you from accidental deletions caused by incorrect RMAN configurations for SBT. To remove the metadata for files that RMAN prevents you from deleting, use the <code dir="ltr"><a href="rcmsynta009.htm#i79920">CHANGE</a></code> <code dir="ltr">RESET DB_UNIQUE_NAME</code> command.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl008.htm#BABEACAI">forDbUniqueNameOption</a></span></code> for descriptions of the options in this clause</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t68" headers="r1c1-t68"><code dir="ltr"><a id="sthref813"></a><a id="sthref814"></a><a id="sthref815"></a><a id="sthref816"></a><a id="sthref817"></a>OBSOLETE</code></td>
<td class="cellalignment1926" headers="r7c1-t68 r1c2-t68">Deletes data file backups and copies recorded in the RMAN repository that are obsolete, that is, no longer needed (see <a href="#CHDIAJIJ">Example 2-66</a>). RMAN also deletes obsolete archived redo log files and log backups.
<p>RMAN determines which backups and copies of data files are no longer needed, which in turn determines when logs (and backups of logs) are no longer needed. RMAN considers the creation of a data file as a backup when deciding which logs to keep.</p>
<p>RMAN first uses the options specified with <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl015.htm#i83923">obsOperandList</a></span></code> to determine which files are obsolete. If you do not specify options in <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl015.htm#i83923">obsOperandList</a></span></code>, then RMAN uses the options specified in <code dir="ltr">CONFIGURE</code> <code dir="ltr"><a href="rcmsynta010.htm#BGBDJIHJ">RETENTION&nbsp;POLICY</a></code>.</p>
<p><span class="bold">Note:</span> <code dir="ltr">DELETE OBSOLETE</code> considers only the backup retention policy and does not use the configured archived log deletion policy to determine which logs are obsolete. In contrast, <code dir="ltr">DELETE ARCHIVELOG ALL</code> considers only the configured archived log deletion policy.</p>
<p><span class="bold">Note:</span> If you make a backup with the <code dir="ltr">KEEP UNTIL TIME</code> clause, then this backup becomes obsolete after the specified <code dir="ltr">KEEP</code> time passes and is removed by <code dir="ltr">DELETE OBSOLETE</code>. RMAN does not consider the backup retention policy for archival backups whose <code dir="ltr">KEEP</code> time has expired.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t68" headers="r1c1-t68"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl015.htm#i83923">obsOperandList</a></span></code></td>
<td class="cellalignment1926" headers="r8c1-t68 r1c2-t68">Specifies the criteria for determining which backups and copies are obsolete.
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl015.htm#i83923">obsOperandList</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t68" headers="r1c1-t68"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref818"></a>DEVICE&nbsp;TYPE</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></td>
<td class="cellalignment1926" headers="r9c1-t68 r1c2-t68">Restricts the deletion to obsolete backups and copies created on the specified device type only.
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref819"></a><a id="sthref820"></a>Examples</p>
<div id="RCMRF90139" class="example">
<p class="titleinexample"><a id="CHDFHGAJ"></a>Example 2-65 Deleting Expired Backups</p>
<p>This example uses a configured <code dir="ltr">sbt</code> channel to check the media manager for expired backups of the tablespace <code dir="ltr">users</code> that are more than one month old and removes their recovery catalog records.</p>
<pre dir="ltr">
CROSSCHECK BACKUPSET OF TABLESPACE users 
  DEVICE TYPE sbt COMPLETED BEFORE 'SYSDATE-31';
DELETE NOPROMPT EXPIRED BACKUPSET OF TABLESPACE users 
  DEVICE TYPE sbt COMPLETED BEFORE 'SYSDATE-31';
</pre></div>
<!-- class="example" -->
<div id="RCMRF90140" class="example">
<p class="titleinexample"><a id="CHDIAJIJ"></a>Example 2-66 Deleting Obsolete Backups</p>
<p>This example deletes backups and copies that are not needed to recover the database to an arbitrary SCN within the last week. RMAN also deletes archived redo log files that are no longer needed.</p>
<pre dir="ltr">
DELETE NOPROMPT OBSOLETE RECOVERY WINDOW OF 7 DAYS;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90141" class="example">
<p class="titleinexample"><a id="CHDFCDDE"></a>Example 2-67 Deleting Archived Redo Log Files That Have Been Backed Up</p>
<p>Assume that you have configured RMAN settings as follows:</p>
<pre dir="ltr">
CONFIGURE DEFAULT DEVICE TYPE TO sbt;
CONFIGURE ARCHIVELOG DELETION POLICY TO
  BACKED UP 2 TIMES
  TO DEVICE TYPE sbt;
</pre>
<p>The following <code dir="ltr">DELETE</code> command deletes all archived redo log files on disk if they are not needed to meet the configured deletion policy, which specifies that logs must be backed up twice to tape (sample output included):</p>
<pre dir="ltr">
RMAN&gt; DELETE ARCHIVELOG ALL;
 
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=84 device type=DISK

List of Archived Log Copies for database with db_unique_name PROD
=====================================================================
 
Key     Thrd Seq     S Low Time
------- ---- ------- - ---------
107     1    4       A 12-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_12/o1_mf_1_4_2x28bpcm_.arc 
108     1    5       A 12-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_12/o1_mf_1_5_2x28g7s9_.arc
109     1    6       A 12-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_6_2x3bbqym_.arc 
157     1    7       A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_7_2x3w2cvs_.arc
164     1    8       A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_8_2x3w40vr_.arc 
171     1    9       A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_9_2x3w8pf7_.arc
318     1    10      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_10_2x3zx6d9_.arc 
330     1    11      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_11_2x403wco_.arc
448     1    12      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_12_2x40wn6x_.arc 
455     1    13      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_13_2x412s3m_.arc
583     1    14      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_14_2x428p9d_.ar 
638     1    15      A 13-FEB-07
        Name: /orcva/PROD/archivelog/2007_02_13/o1_mf_1_15_2x42f0gj_.arc
 
Do you really want to delete the above objects (enter YES or NO)?
</pre></div>
<!-- class="example" -->
<div id="RCMRF90142" class="example">
<p class="titleinexample"><a id="CHDBBFBE"></a>Example 2-68 Forcing the Deletion of a Backup Set</p>
<p>The following example attempts to delete the backup set copy with tag <code dir="ltr">weekly_bkup</code>:</p>
<pre dir="ltr">
RMAN&gt; DELETE NOPROMPT BACKUPSET TAG weekly_bkup;
</pre>
<p>RMAN displays a warning because the repository shows the backup set as available, but the object is not actually available on the media:</p>
<pre dir="ltr">
List of Backup Pieces
BP Key  BS Key  Pc# Cp# Status      Device Type Piece Name
------- ------- --- --- ----------- ----------- ----------
809     806     1   1   AVAILABLE   SBT_TAPE    0ri9uu08_1_1
 
RMAN-06207: WARNING: 1 objects could not be deleted for SBT_TAPE channel(s) due
RMAN-06208:          to mismatched status.  Use CROSSCHECK command to fix status
RMAN-06210: List of Mismatched objects
RMAN-06211: ==========================
RMAN-06212:   Object Type   Filename/Handle
RMAN-06213: --------------- ---------------------------------------------------
RMAN-06214: Backup Piece    0ri9uu08_1_1
</pre>
<p>The following command forces RMAN to delete the backup set (sample output included):</p>
<pre dir="ltr">
RMAN&gt; DELETE FORCE NOPROMPT BACKUPSET TAG weekly_bkup;

using channel ORA_SBT_TAPE_1
using channel ORA_DISK_1
 
List of Backup Pieces
BP Key  BS Key  Pc# Cp# Status      Device Type Piece Name
------- ------- --- --- ----------- ----------- ----------
809     806     1   1   AVAILABLE   SBT_TAPE    0ri9uu08_1_1
deleted backup piece
backup piece handle=0ri9uu08_1_1 RECID=26 STAMP=614430728
Deleted 1 objects
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta015.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta017.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
