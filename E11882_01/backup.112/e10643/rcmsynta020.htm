<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DUPLICATE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:41Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta019.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta021.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">33/158</span> <!-- End Header --><a id="i81724"></a>
<div id="RCMRF126" class="refsect1">
<h1 class="refsect1">DUPLICATE<a id="ABC1062459"></a><a id="ABC1062459SRI1"></a><a id="ABC1062459SRI12"></a><a id="ABC1062459SRI123"></a><a id="ABC1062459SRI1234"></a><a id="ABC1062459SRI12345"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref858"></a>Purpose</p>
<p>Use the <a id="CHDFJIIJ"></a><code dir="ltr">DUPLICATE</code> command to create a copy of a <span class="bold">source database</span>. RMAN can create either of the following types of databases:</p>
<ul>
<li>
<p>A <span class="glossaryterm">duplicate database</span>, which is a copy of the source database (or a subset of the source database) with a unique DBID. Because a duplicate database has a unique DBID, it is independent of the source database and can be registered in the same recovery catalog. Typically, duplicate databases are used for testing.</p>
</li>
<li>
<p>A <span class="glossaryterm">standby database</span>, which is a special copy of the source database (called a <span class="bold">primary database</span> in a Data Guard environment) that is updated by applying archived redo log files from the primary database. A standby database is not assigned a new DBID.</p>
</li>
</ul>
<p>RMAN can perform the duplication in any of the following supported modes:</p>
<ul>
<li>
<p><span class="bold">Active duplication</span></p>
<p>RMAN duplicates the files directly from either an open or mounted database.</p>
</li>
<li>
<p><span class="bold">Backup-based duplication</span> <span class="bold">without a target connection</span></p>
<p>RMAN creates duplicate files from pre-existing RMAN backups and copies. The <code dir="ltr">DUPLICATE</code> command must have been issued with the <code dir="ltr">DATABASE</code> clause. This form requires a connection to an auxiliary instance and a recovery catalog.</p>
<p>This mode is useful when the target database is not available or a connection to it is not desirable (as mandated by security policy restrictions or a firewall).</p>
</li>
<li>
<p><span class="bold">Backup-based duplication</span> <span class="bold">with a target connection</span></p>
<p>RMAN creates duplicate files from pre-existing RMAN backups and copies.</p>
</li>
<li>
<p><span class="bold">Backup-based duplication without connection to target and recovery catalog</span></p>
<p>RMAN creates duplicate files from RMAN backups and copies that were placed in a designated <code dir="ltr">BACKUP LOCATION.</code></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink BRADV010" href="../../backup.112/e10642/rcmdupdb.htm#BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> to learn how to create a duplicate database with the <code dir="ltr">DUPLICATE</code> command</p>
</li>
<li>
<p><a class="olink SBYDB00200" href="../../server.112/e41134/create_ps.htm#SBYDB00200"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn how to create, manage, and back up a standby database</p>
</li>
</ul>
</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref859"></a>Additional Topics</p>
<ul>
<li>
<p><a href="#CHDEDFFH">Prerequisites</a></p>
</li>
<li>
<p><a href="#CHDHJJGI">Usage Notes</a></p>
</li>
<li>
<p><a href="#CHDFIGHC">Syntax</a></p>
</li>
<li>
<p><a href="#CHDEHIGF">Semantics</a></p>
</li>
<li>
<p><a href="#i104404">Examples</a></p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CHDEDFFH"></a>Prerequisites</p>
<p>The prerequisites vary depending on the type of duplication.</p>
<p class="subhead2"><a id="RCMRF90149"></a>Prerequisites Common to All Forms of Duplication</p>
<p>RMAN must be connected as <code dir="ltr">AUXILIARY</code> to the instance of the duplicate database. The instance of the duplicate database is called the <span class="bold">auxiliary instance</span>. The auxiliary instance must be started with the <code dir="ltr">NOMOUNT</code> option.</p>
<p>The <span class="bold">source host</span> is the database on which the source database resides. The <span class="bold">destination host</span> is the host on which you intend to create the duplicate database. If you intend to create the duplicate database on the source host, then set the <a id="sthref860"></a><a id="sthref861"></a><code dir="ltr">CONTROL_FILES</code> initialization parameter appropriately so that the <code dir="ltr">DUPLICATE</code> command does not generate an error because the source control file is in use. Also, set all *<code dir="ltr">_DEST</code> initialization parameters appropriately so that the source database files are not overwritten by the duplicate database files.</p>
<p><a id="sthref862"></a><a id="sthref863"></a>The source and duplicate databases must be on the same platform. In the context of <code dir="ltr">DUPLICATE</code>, 32-bit and 64-bit versions of the same platform are considered the same platform. For example, Linux IA (32-bit) is considered the same platform as Linux IA (64-bit). However, after duplicating a database between 32-bit and 64-bit platforms, you must run the <a id="sthref864"></a><a id="sthref865"></a><code dir="ltr">utlirp.sql</code> script to convert the PL/SQL code to the new format. This script is located in <code dir="ltr"><span class="codeinlineitalic">ORACLE_HOME</span></code><code dir="ltr">/rdbms/admin</code> on Linux and UNIX platforms.</p>
<p>The <code dir="ltr">DUPLICATE</code> command requires one or more auxiliary channels. These channels perform the work of the duplication on the auxiliary database instance. In the following circumstances, RMAN uses the channel configuration from the source database for auxiliary channels:</p>
<ul>
<li>
<p>You have not used <code dir="ltr"><a href="rcmsynta004.htm#i78244">ALLOCATE CHANNEL</a></code> to manually allocate auxiliary channels.</p>
</li>
<li>
<p>You have not used <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> to configure auxiliary channels.</p>
</li>
</ul>
<p>If you have configured automatic target channels to use <code dir="ltr">CONNECT</code> strings, then RMAN attempts to replicate the channel allocation on the auxiliary instance. However, if you must control or vary the channel allocation for duplication, you should manually allocate auxiliary channels.</p>
<p>If the <a id="sthref866"></a><a id="sthref867"></a><code dir="ltr">COMPATIBLE</code> initialization parameter is set greater than or equal to 11.0.0, then by default RMAN duplicates transportable tablespaces that were not made read/write after being transported. Otherwise, RMAN cannot duplicate <a id="sthref868"></a>transportable tablespaces unless they have been made read/write after being transported.</p>
<p><a id="sthref869"></a><a id="sthref870"></a><a id="sthref871"></a><a id="sthref872"></a><a id="sthref873"></a>The following database encryption features both use the wallet: transparent data encryption, which functions at the column level, and tablespace encryption. If you are duplicating an encrypted tablespace, then you must manually copy the wallet to the duplicate database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ASOAG600" href="../../network.112/e40393/asotrans.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Administrator's Guide</span></a> to learn about transparent data encryption</div>
<p class="subhead2"><a id="RCMRF90150"></a>Prerequisites Specific to Backup-Based Duplication</p>
<p>As shown in <a href="#BABEDFJI">Table 2-6</a>, the prerequisites for backup-based duplication depend on whether RMAN is connected as <code dir="ltr">TARGET</code> to the source database.</p>
<div id="RCMRF90151" class="tblruleformal">
<p class="titleintable"><a id="sthref874"></a><a id="BABEDFJI"></a>Table 2-6 Prerequisites for Three Modes of Backup-Based Duplication</p>
<table class="cellalignment1929" title="Prerequisites for Three Modes of Backup-Based Duplication" summary="Requirements for Two Modes of Backup-Based Duplication" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t75">Prerequisite</th>
<th class="cellalignment1930" id="r1c2-t75">No Target and No Recovery Connection</th>
<th class="cellalignment1930" id="r1c3-t75">No Target Connection</th>
<th class="cellalignment1930" id="r1c4-t75">Target Connection</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t75" headers="r1c1-t75">
<p>RMAN requires a connection to a recovery catalog.</p>
</td>
<td class="cellalignment1926" headers="r2c1-t75 r1c2-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r2c1-t75 r1c3-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r2c1-t75 r1c4-t75">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t75" headers="r1c1-t75">
<p>All backups and archived redo log files used for creating and recovering the duplicate database must be accessible by the server session on the destination host.</p>
</td>
<td class="cellalignment1926" headers="r3c1-t75 r1c2-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r3c1-t75 r1c3-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r3c1-t75 r1c4-t75">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t75" headers="r1c1-t75">
<p>If the destination host is different from the source host, then you must make backups on disk on the source host available to the destination host with the same full path name as in the source database.</p>
</td>
<td class="cellalignment1926" headers="r4c1-t75 r1c2-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r4c1-t75 r1c3-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r4c1-t75 r1c4-t75">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t75" headers="r1c1-t75">
<p>You must provide the name of the source database with the <code dir="ltr">DATABASE</code> clause. If the name of the source database is not unique in the recovery catalog, then you must also provide the database ID (DBID) in the <code dir="ltr">DATABASE</code> clause.</p>
</td>
<td class="cellalignment1926" headers="r5c1-t75 r1c2-t75">
<p>No if <code dir="ltr">BACKUP LOCATION</code> does not have backups from multiple databases.</p>
</td>
<td class="cellalignment1926" headers="r5c1-t75 r1c3-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r5c1-t75 r1c4-t75">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t75" headers="r1c1-t75">
<p><code dir="ltr">UNTIL</code> clause must be specified in the current incarnation.</p>
</td>
<td class="cellalignment1926" headers="r6c1-t75 r1c2-t75">
<p>Not applicable</p>
</td>
<td class="cellalignment1926" headers="r6c1-t75 r1c3-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r6c1-t75 r1c4-t75">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t75" headers="r1c1-t75">
<p><code dir="ltr">NOREDO</code> must be specified when RMAN must prevent application of archived redo log files to the backups (see description of <code dir="ltr">NOREDO</code> for more information).</p>
</td>
<td class="cellalignment1926" headers="r7c1-t75 r1c2-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r7c1-t75 r1c3-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r7c1-t75 r1c4-t75">
<p>Yes</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t75" headers="r1c1-t75">
<p>If you duplicate a subset of tablespaces, and if the source database is not open, then any duplicated tablespaces with undo segments must be listed in the <code dir="ltr">UNDO TABLESPACE</code> clause.</p>
</td>
<td class="cellalignment1926" headers="r8c1-t75 r1c2-t75">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r8c1-t75 r1c3-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r8c1-t75 r1c4-t75">
<p>Yes (if no catalog used and target is not open)</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t75" headers="r1c1-t75">
<p>RMAN automatically enforces the rule that the set of tablespaces must be self-contained and must not contain database objects owned by <code dir="ltr">SYS</code>.</p>
</td>
<td class="cellalignment1926" headers="r9c1-t75 r1c2-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r9c1-t75 r1c3-t75">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r9c1-t75 r1c4-t75">
<p>Yes</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<p class="subhead2"><a id="CHDBCJFA"></a><a id="RCMRF90152"></a>Prerequisites Specific to Active Database Duplication</p>
<p>When you execute <code dir="ltr">DUPLICATE</code> with <code dir="ltr">FROM ACTIVE DATABASE</code>, at least one normal target channel and at least one <code dir="ltr">AUXILIARY</code> channel are required.</p>
<p>When you connect RMAN to the source database as <code dir="ltr">TARGET</code>, you must specify a password, even if RMAN uses operating system authentication. The source database must be mounted or open. If the source database is open, then archiving must be enabled. If the source database is not open, then it must have been shut down consistently.</p>
<p>When you connect RMAN to the auxiliary instance, you must provide a net service name. This requirement applies even if the auxiliary instance is on the local host.</p>
<p>The source database and auxiliary instances must use the same <a id="sthref875"></a><code dir="ltr">SYSDBA</code> password, which means that both instances must have password files. You can create the password file with a single password so you can start the auxiliary instance and enable the source database to connect to it.</p>
<p>The <code dir="ltr">DUPLICATE</code> behavior for <a id="sthref876"></a><a id="sthref877"></a>password files varies depending on whether your duplicate database acts as a standby database. If you create a duplicate database that is not a standby database, then RMAN does not copy the password file by default. You can specify the <code dir="ltr">PASSWORD FILE</code> option to indicate that RMAN should overwrite the existing password file on the auxiliary instance. If you create a standby database, then RMAN copies the password file to the standby host by default, overwriting the existing password file. In this case, the <code dir="ltr">PASSWORD FILE</code> clause is not necessary.</p>
<p>You cannot use the <code dir="ltr">UNTIL</code> clause when performing active database duplication. RMAN chooses a time based on when the online data files have been completely copied, so that the data files can be recovered to a consistent point in time.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG0032" href="../../network.112/e36292/authentication.htm#DBSEG0032"><span class="italic">Oracle Database Security Guide</span></a> to learn about password protection</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CHDHJJGI"></a>Usage Notes</p>
<p><a id="sthref878"></a><a id="sthref879"></a><a id="sthref880"></a>Active database duplication uses the auxiliary service name to copy the source database over the network to the auxiliary instance on the destination host, whereas backup-based duplication uses pre-existing RMAN backups and copies. <a href="#CHDIJJHJ">Table 2-7</a> shows which files from the source database are duplicated.</p>
<div id="RCMRF90153" class="tblruleformalmax">
<p class="titleintable"><a id="sthref881"></a><a id="CHDIJJHJ"></a>Table 2-7 Duplicated Files</p>
<table class="cellalignment1929" title="Duplicated Files" summary="Identifies source database files that are duplicated" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t77">Source Database Files</th>
<th class="cellalignment1930" id="r1c2-t77">Active Database</th>
<th class="cellalignment1930" id="r1c3-t77">Backup-Based</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t77" headers="r1c1-t77">
<p>Control files</p>
</td>
<td class="cellalignment1926" headers="r2c1-t77 r1c2-t77">
<p>Copied from source database when <code dir="ltr">FOR STANDBY</code> specified; otherwise re-created</p>
</td>
<td class="cellalignment1926" headers="r2c1-t77 r1c3-t77">
<p>Restored from backups</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t77" headers="r1c1-t77">
<p>Data files</p>
</td>
<td class="cellalignment1926" headers="r3c1-t77 r1c2-t77">
<p>Copied from source database (unless excluded with a <code dir="ltr">SKIP</code> option)</p>
</td>
<td class="cellalignment1926" headers="r3c1-t77 r1c3-t77">
<p>Restored from backups (unless excluded with a <code dir="ltr">SKIP</code> option)</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t77" headers="r1c1-t77">
<p>Temp files</p>
</td>
<td class="cellalignment1926" headers="r4c1-t77 r1c2-t77">
<p>Re-created (see <a href="#CHDHHBIA">"Tempfile Re-Creation"</a>)</p>
</td>
<td class="cellalignment1926" headers="r4c1-t77 r1c3-t77">
<p>Re-created (see <a href="#CHDHHBIA">"Tempfile Re-Creation"</a>)</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t77" headers="r1c1-t77">
<p>Online redo log files</p>
</td>
<td class="cellalignment1926" headers="r5c1-t77 r1c2-t77">
<p>Re-created</p>
</td>
<td class="cellalignment1926" headers="r5c1-t77 r1c3-t77">
<p>Re-created</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t77" headers="r1c1-t77">
<p>Standby redo log files</p>
</td>
<td class="cellalignment1926" headers="r6c1-t77 r1c2-t77">
<p>Re-created when <code dir="ltr">FOR STANDBY</code> specified and defined on primary database</p>
</td>
<td class="cellalignment1926" headers="r6c1-t77 r1c3-t77">
<p>Re-created when <code dir="ltr">FOR STANDBY</code> specified and defined on primary database</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t77" headers="r1c1-t77">
<p>Archived redo log files</p>
</td>
<td class="cellalignment1926" headers="r7c1-t77 r1c2-t77">
<p>Copied from source database, but only if needed for the duplication</p>
</td>
<td class="cellalignment1926" headers="r7c1-t77 r1c3-t77">
<p>Obtained from backups or cataloged copies, but only if needed for the duplication</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t77" headers="r1c1-t77">
<p>Server parameter file</p>
</td>
<td class="cellalignment1926" headers="r8c1-t77 r1c2-t77">
<p>Copied from source database (see <code dir="ltr">SPFILE</code> clause in <a href="#i1011578"><span class="xreftitleitalic"><span class="italic">dupOptionList</span></span></a>)</p>
</td>
<td class="cellalignment1926" headers="r8c1-t77 r1c3-t77">
<p>Restored from backup if <code dir="ltr">SPFILE</code> clause is specified (see <a href="#i1011578"><span class="xreftitleitalic"><span class="italic">dupOptionList</span></span></a>)</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t77" headers="r1c1-t77">
<p>Flashback log files</p>
</td>
<td class="cellalignment1926" headers="r9c1-t77 r1c2-t77">
<p>Not re-created</p>
</td>
<td class="cellalignment1926" headers="r9c1-t77 r1c3-t77">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r10c1-t77" headers="r1c1-t77">
<p>Block change tracking file</p>
</td>
<td class="cellalignment1926" headers="r10c1-t77 r1c2-t77">
<p>Not re-created</p>
</td>
<td class="cellalignment1926" headers="r10c1-t77 r1c3-t77">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r11c1-t77" headers="r1c1-t77">
<p>Password file</p>
</td>
<td class="cellalignment1926" headers="r11c1-t77 r1c2-t77">
<p>Copied by default for standby databases; for nonstandby databases, copied only if <code dir="ltr">PASSWORD FILE</code> option is specified</p>
</td>
<td class="cellalignment1926" headers="r11c1-t77 r1c3-t77">
<p>Not re-created</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r12c1-t77" headers="r1c1-t77">
<p>Backups and other files in fast recovery area</p>
</td>
<td class="cellalignment1926" headers="r12c1-t77 r1c2-t77">
<p>Not copied</p>
</td>
<td class="cellalignment1926" headers="r12c1-t77 r1c3-t77">
<p>Not copied</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformalmax" -->
<p>All data files are included in the duplicate database unless they are offline clean or excluded. You can exclude tablespaces with the <code dir="ltr">SKIP</code> clause, or by including only a subset of tablespaces with <code dir="ltr">DUPLICATE ... TABLESPACE</code>.</p>
<p>The <a id="sthref882"></a><a id="sthref883"></a>fast recovery area is defined on the duplicate or standby database if you explicitly define it. Also, if a flash recovery was defined on the source database, and if the auxiliary instance uses a server parameter file that was copied or restored with the <code dir="ltr">DUPLICATE</code> command, then a flash recovery is defined on the duplicate or standby database.</p>
<p>If you use active database duplication, then see the <code dir="ltr">FROM ACTIVE DATABASE</code> description in <a href="#i1011578"><span class="xreftitleitalic"><span class="italic">dupOptionList</span></span></a> for usage notes.</p>
<p class="subhead2"><a id="RCMRF90154"></a>Backup-Based Duplication</p>
<p><a id="sthref884"></a>In backup-based duplication of databases with a connection to the target database and in <a id="sthref885"></a><code dir="ltr">NOARCHIVELOG</code> mode, media recovery uses the <code dir="ltr">NOREDO</code> option. Thus, if incremental backups exist, RMAN applies only these incremental backups to the restored files during recovery.</p>
<p>For backup-based duplication of databases in <a id="sthref886"></a><code dir="ltr">ARCHIVELOG</code> mode, RMAN recovers by default up to the last archived redo log generated when the command was executed, or until a time specified with a <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">UNTIL</code> clause.</p>
<p>For backup-based duplication of databases without a connection to the target database, RMAN cannot determine whether the source database was in <code dir="ltr">NOARCHIVELOG</code> mode. Therefore, you must use the <code dir="ltr">NOREDO</code> option when the source database was in <code dir="ltr">NOARCHIVELOG</code> mode when the backups were taken. You can also use the <code dir="ltr">NOREDO</code> option when you do not want to apply archived redo log files to a consistent backup.</p>
<p>If you are using backup-based duplication, and if the source database and auxiliary instances reside on different hosts, then you must decide how to make the backups of the source database available to the auxiliary instance. For more information on how to do this with <code dir="ltr">BACKUP LOCATION</code>, review the options described in the section <a class="olink BRADV99993" href="../../backup.112/e10642/rcmdupdb.htm#BRADV99993"><span class="italic">Making Disk Backups Accessible to the Auxiliary Instance</span></a> in the <span class="italic">Oracle Database Backup and Recovery User's Guide</span>.</p>
<p>If the target database does not use a recovery area in ASM storage, then perform one of the following tasks before executing the <code dir="ltr">DUPLICATE</code> command:</p>
<ul>
<li>
<p>If you are using SBT backups, then make the tapes with the backups accessible to the destination host.</p>
</li>
<li>
<p>If you are using disk backups, and if you can use the same backup directory names on the destination host as the source host, then do one of the following:</p>
<ul>
<li>
<p>Manually transfer the backups and copies from the source host to the destination host to an identical path.</p>
</li>
<li>
<p>Use NFS or shared disks and ensure that the same path is accessible in the destination host.</p>
</li>
</ul>
</li>
<li>
<p>If you are using disk backups, and if you <span class="italic">cannot</span> use the same backup directory names on the destination host as the source host, then use of the techniques described in <a class="olink BRADV99993" href="../../backup.112/e10642/rcmdupdb.htm#BRADV99993"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a>.</p>
</li>
</ul>
<p>If the source database uses a recovery area in <a id="sthref887"></a>ASM storage, then perform one of the following tasks before executing the <code dir="ltr">DUPLICATE</code> command:</p>
<ul>
<li>
<p>Make a database backup to a location outside the fast recovery area. You can make this backup accessible in the following ways:</p>
<ul>
<li>
<p>Use NFS to mount the backup on the destination host with the same name.</p>
</li>
<li>
<p>Use NFS to mount the backup on the destination host with a different name, and then <code dir="ltr"><a href="rcmsynta008.htm#i79811">CATALOG</a></code> the backup while RMAN is connected as <code dir="ltr">TARGET</code> to the source database.</p>
</li>
</ul>
</li>
<li>
<p>Back up the fast recovery area to tape and use it for duplication.</p>
</li>
</ul>
<p class="subhead2"><a id="CHDECBFJ"></a><a id="RCMRF90155"></a>Duplication with Oracle Managed Files</p>
<p>If the source database files are in the <a id="sthref888"></a><a id="sthref889"></a>Oracle Managed Files (OMF) format, then you cannot use the <a id="sthref890"></a><a id="sthref891"></a><code dir="ltr">DB_FILE_NAME_CONVERT</code> and <code dir="ltr">LOG_FILE_NAME_CONVERT</code><a id="sthref892"></a><a id="sthref893"></a> initialization parameters or the <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl007.htm#i101650"><span class="xreftitleitalic">fileNameConversionSpec</span></a></span></code> clause to generate new OMF file names for the duplicate database. If you do not follow this rule, the new OMF files generated from these three methods can cause problems. For more information on OMF names, see the "Considerations When Renaming OMF Auxiliary Set Files in TSPITR" in the <span class="italic">Oracle Database Backup and Recovery User's Guide</span></p>
<p>The only exception to this rule is when changing only an ASM disk group name. Assume that source data files and online redo log files are stored in ASM disk group <code dir="ltr">+SOURCEDSK</code>. You want to store the duplicate database files in ASM disk group <code dir="ltr">+DUPDSK</code>. In this case, you can set the initialization parameters as follows:</p>
<pre dir="ltr">
DB_FILE_NAME_CONVERT = ("+SOURCEDSK","+DUPDSK")
LOG_FILE_NAME_CONVERT = ("+SOURCEDSK","+DUPDSK")
</pre>
<p>RMAN uses <code dir="ltr">DB_FILE_NAME_CONVERT</code> or <code dir="ltr">LOG_FILE_NAME_CONVERT</code> to convert the disk group name, and then generates a new, valid file name based on the converted disk group name.</p>
<p>You have the following other supported options for naming data files when the source files are in the Oracle Managed Files format:</p>
<ul>
<li>
<p>Use <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">NEWNAME</code> to specify names for individual data files.</p>
</li>
<li>
<p>Set <code dir="ltr">DB_FILE_CREATE_DEST</code> to make all data files of the new database Oracle-managed files, except the files for which <code dir="ltr">SET NEWNAME</code> is used. You should not set <code dir="ltr">DB_FILE_NAME_CONVERT</code> if you set <code dir="ltr">DB_FILE_CREATE_DEST</code>.</p>
</li>
</ul>
<p>Supported options for naming online redo logs duplicated from Oracle-managed files are <code dir="ltr">DB_CREATE_FILE_DEST</code>, <code dir="ltr">DB_RECOVERY_FILE_DEST</code>, or <code dir="ltr">DB_CREATE_ONLINE_LOG_DEST_</code><code dir="ltr"><span class="codeinlineitalic">n</span></code>.</p>
<p class="subhead2"><a id="CHDHHBIA"></a><a id="RCMRF90156"></a>Tempfile Re-Creation</p>
<p>You can use the <code dir="ltr">DB_FILE_NAME_CONVERT</code> parameter to convert the temp file names for the new database that are not Oracle-managed files (OMF). The only exception to this restriction are Automatic Storage Management (ASM) OMF names where only the name of the disk group can be changed.</p>
<p>The other method for converting temp file names for the new database is to use <code dir="ltr">SET NEWNAME FOR TEMPFILE TO'filename'</code> or <code dir="ltr">TO NEW</code>. With this latter method, it does not matter if the data files are OMF or non-OMF, the temp files are re-created in the <code dir="ltr">DB_CREATE_FILE_DEST</code> directory location when the database is opened.</p>
<p><a id="sthref894"></a>To specify different file names for the temp files, see the discussion of <code dir="ltr"><a href="rcmsynta2020.htm#i86534">SWITCH</a></code> <code dir="ltr">TEMPFILE</code> .</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CHDFIGHC"></a>Syntax</p>
<p class="subhead2"><a id="CHDICDAE"></a><a id="RCMRF90157"></a><a id="sthref895"></a><a id="sthref896"></a><a href="#i1018642"><span class="xreftitleitalic"><span class="italic">duplicate</span></span></a>::=</p>
<img width="735" height="182" src="img/duplicate.gif" alt="Description of duplicate.gif follows" /><br />
<a id="sthref897" href="img_text/duplicate.htm">Description of the illustration duplicate.gif</a><br />
<br />
<p>(<a href="#CHDHECDG"><span class="xreftitleitalic"><span class="italic">dupOptionList</span>::=</span></a>)</p>
<p class="subhead2"><a id="CHDHECDG"></a><a id="RCMRF90158"></a><a id="sthref898"></a><a id="sthref899"></a><a href="#i1011578"><span class="xreftitleitalic"><span class="italic">dupOptionList</span></span></a>::=</p>
<img width="746" height="735" src="img/dupoptionlist.gif" alt="Description of dupoptionlist.gif follows" /><br />
<a id="sthref900" href="img_text/dupoptionlist.htm">Description of the illustration dupoptionlist.gif</a><br />
<br />
<p>(<a href="rcmsubcl006.htm#BABDEJAC"><span class="xreftitleitalic"><span class="italic">deviceSpecifier</span>::=</span></a>, <a href="rcmsubcl007.htm#BABBJGBH"><span class="xreftitleitalic"><span class="italic">fileNameConversionSpec</span>::=</span></a>, <a href="#CHDIGIJD"><span class="xreftitleitalic"><span class="italic">logSpec</span>::=</span></a>, <a href="#CHDIGEDI"><span class="xreftitleitalic"><span class="italic">setParameter</span>::=</span></a>, <a href="rcmsubcl019.htm#BABEDABD"><span class="xreftitleitalic"><span class="italic">untilClause</span>::=</span></a>)</p>
<p class="subhead2"><a id="CHDIGEDI"></a><a id="RCMRF90159"></a><a id="sthref901"></a><a id="sthref902"></a><a href="#CHDHAJGD"><span class="xreftitleitalic"><span class="italic">setParameter</span></span></a>::=</p>
<img width="414" height="112" src="img/setparameter.gif" alt="Description of setparameter.gif follows" /><br />
<a id="sthref903" href="img_text/setparameter.htm">Description of the illustration setparameter.gif</a><br />
<br />
<p class="subhead2"><a id="CHDIGIJD"></a><a id="RCMRF90160"></a><a id="sthref904"></a><a id="sthref905"></a><a href="#BGBIHEHG"><span class="xreftitleitalic"><span class="italic">logSpec</span></span></a>::=</p>
<img width="471" height="88" src="img/logspec.gif" alt="Description of logspec.gif follows" /><br />
<a id="sthref906" href="img_text/logspec.htm">Description of the illustration logspec.gif</a><br />
<br />
<p class="subhead2"><a id="RCMRF90161"></a><a id="sthref907"></a><a id="sthref908"></a><a href="rcmsynta007.htm#i1017291"><span class="xreftitleitalic"><span class="italic">sizeSpec</span></span></a>::=</p>
<img width="129" height="88" src="img/sizespec.gif" alt="Description of sizespec.gif follows" /><br />
<a id="sthref909" href="img_text/sizespec.htm">Description of the illustration sizespec.gif</a><br />
<br /></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CHDEHIGF"></a>Semantics</p>
<p class="subhead2"><a id="i1018642"></a><a id="RCMRF90162"></a><span class="italic"><a id="sthref910"></a><a id="sthref911"></a>duplicate</span></p>
<p>This clause enables you to duplicate a database or tablespace. Refer to the <a href="#CHDICDAE"><span class="xreftitleitalic"><span class="italic">duplicate</span>::=</span></a> diagram for the syntax.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for DUPLICATE Command" summary="Describes DUPLICATE command parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t78">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t78">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t78" headers="r1c1-t78"><code dir="ltr"><a id="sthref912"></a>TARGET DATABASE</code></td>
<td class="cellalignment1926" headers="r2c1-t78 r1c2-t78">Specifies the source database, which is the database you want to duplicate. Starting with Oracle Database 11<span class="italic">g</span> Release 2 the <code dir="ltr">TARGET</code> keyword is optional.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t78" headers="r1c1-t78"><code dir="ltr"><a id="sthref913"></a>DATABASE</code></td>
<td class="cellalignment1926" headers="r3c1-t78 r1c2-t78">Specifies the source database</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t78" headers="r1c1-t78"><code dir="ltr"><span class="codeinlineitalic">&nbsp;&nbsp;&nbsp;'database_name'</span></code></td>
<td class="cellalignment1926" headers="r4c1-t78 r1c2-t78">Specifies the name of the source database, which is the database that you want to duplicate.
<p>This clause can be used instead of <code dir="ltr">TARGET DATABASE</code> when RMAN is connected as <code dir="ltr">TARGET</code> to the source database. When performing duplicate with a target connection, then you must specify the currently connected database and not use the INCARNATION subclause.</p>
<p>For backup-based duplication without a target connection, you must either specify the database name or run the <code dir="ltr">SET DATABASE</code> <span class="italic">'database_name'</span> command.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t78" headers="r1c1-t78"><code dir="ltr">&nbsp;&nbsp;&nbsp;DBID</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r5c1-t78 r1c2-t78">Specifies the database ID (DBID) of the source database.
<p>The <code dir="ltr">DBID</code> parameter is required when you duplicate without a <code dir="ltr">TARGET</code> connection to the source database and the database name in the recovery catalog is not unique. Another option is to use the <code dir="ltr">SET DBID</code> command.</p>
<p>When RMAN duplicates the database while connected to the source database as <code dir="ltr">TARGET</code>, the <code dir="ltr">DBID</code> parameter is not needed. If <code dir="ltr">DBID</code> is specified, then the parameter value should match the <code dir="ltr">DBID</code> of the source database.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t78" headers="r1c1-t78"><a id="sthref914"></a><code dir="ltr">&nbsp;INCARNATION</code> <code dir="ltr"><span class="codeinlineitalic">primaryKey</span></code></td>
<td class="cellalignment1926" headers="r6c1-t78 r1c2-t78">Specifies an orphan incarnation.
<p>By default, the <code dir="ltr">DUPLICATE</code> command with the <code dir="ltr">UNTIL</code> clause refers to a point in time in the current database incarnation or the direct ancestor of the current incarnation. This clause enables you to designate an incarnation not in the current incarnation path, known as an orphan incarnation. It is invalid to specify <code dir="ltr">INCARNATION</code> when connected to a target database or when using <code dir="ltr">BACKUP LOCATION</code>.</p>
<p>Another option is to use the <code dir="ltr">SET INCARNATION</code> command.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t78" headers="r1c1-t78"><code dir="ltr"><a id="sthref915"></a>FOR&nbsp;STANDBY</code></td>
<td class="cellalignment1926" headers="r7c1-t78 r1c2-t78">Specifies that database being duplicated is to be used as a standby database (see <a href="#CHDDFDGH">Example 2-81</a>).
<p>To create a standby database with the <code dir="ltr">DUPLICATE</code> command you must specify the <code dir="ltr">FOR STANDBY</code> option. The <code dir="ltr">DUPLICATE ... FOR STANDBY</code> command creates the standby database by restoring a standby control file and mounting the standby control file. If you specify <code dir="ltr">FROM ACTIVE DATABASE</code>, then RMAN copies the data files from the primary to standby database. Otherwise, RMAN restores backups of the source database data files to the standby database. RMAN restores the most recent files, unless <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">UNTIL</code> is specified.</p>
<p>If you are duplicating the SPFILE, then specify a unique <code dir="ltr">DB_UNIQUE_NAME</code> in the <code dir="ltr">SPFILE</code> clause. If not, then manually set this parameter to a unique value in the PFILE or SPFILE of the auxiliary instance.</p>
<p>You cannot use <code dir="ltr">TO</code> <code dir="ltr"><span class="codeinlineitalic">database_name</span></code> for a standby database.</p>
<p>If <code dir="ltr">DORECOVER</code> is specified, then RMAN also recovers the database. The standby database is left mounted after duplication is complete.</p>
<p>You cannot use <code dir="ltr">SET NEWNAME</code> or <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> <code dir="ltr">AUXNAME</code> to transform the file names for the online redo logs on the standby database.</p>
<p>You cannot <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> RMAN to the standby database and then use <code dir="ltr">DUPLICATE ... FOR STANDBY</code> to create an additional standby database. To create additional standby databases, connect RMAN to the original primary database and run <code dir="ltr">DUPLICATE ... FOR STANDBY</code>.</p>
<p><span class="bold">Note:</span> Although you can use the <code dir="ltr">DUPLICATE</code> command to create a standby database, you cannot use this command to activate a standby database.</p>
<p>When you connect RMAN to the standby database and the recovery catalog in which the primary database is registered, RMAN recognizes the standby database and implicitly registers it. Do not attempt to use the <code dir="ltr">REGISTER</code> command for the standby database.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t78" headers="r1c1-t78"><code dir="ltr">TO</code> <code dir="ltr"><span class="codeinlineitalic">database_name</span></code></td>
<td class="cellalignment1926" headers="r8c1-t78 r1c2-t78">Specifies the name of the duplicate database. This duplicate database is not a standby database, so this clause cannot be used with <code dir="ltr">FOR STANDBY</code>.
<p>If you do not specify the <code dir="ltr">SPFILE</code> clause, then the specified database name should match the name in the initialization parameter file of the duplicate database instance, which is the instance to which RMAN is connected as <code dir="ltr">AUXILIARY</code>. Otherwise, the database signals an error.</p>
<p>You cannot use the same database name for the source database and duplicate database when the duplicate database resides in the same Oracle home as the source database. However, if the duplicate database resides in a different Oracle home from the source database, then its database name just has to differ from other database names in its Oracle home. To simplify administration of duplicate database, Oracle recommends that you use different names for the source and duplicate databases.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t78" headers="r1c1-t78"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="#i1011578"><span class="italic">dupOptionList</span></a></span></code></td>
<td class="cellalignment1926" headers="r9c1-t78 r1c2-t78">Specifies options for creating a duplicate or standby database. See <a href="#i1011578"><span class="xreftitleitalic"><span class="italic">dupOptionList</span></span></a>.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="i1011578"></a><a id="RCMRF90163"></a><span class="italic"><a id="sthref916"></a><a id="sthref917"></a>dupOptionList</span></p>
<p>This subclause includes options that control aspects of duplication such as naming the files and determining an end point for the duplication. Refer to the <a href="#CHDHECDG"><span class="xreftitleitalic"><span class="italic">dupOptionList</span>::=</span></a> diagram for the syntax.</p>
<p>Specify new file names or convert source database file names for the data files and online redo logs when the file names of the duplicate database must be different from the file names of the source database (as when the destination host and source host are the same). If you do not specify file names for the online redo logs and data files of the duplicate database, then RMAN uses the data file names from the source database.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for dupOptionList Command" summary="Describes DUPLICATE command dupOptionList parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t79">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t79">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t79" headers="r1c1-t79"><code dir="ltr">BACKUP LOCATION</code> <span class="italic">backup_location</span></td>
<td class="cellalignment1926" headers="r2c1-t79 r1c2-t79">Specifies the backup location on disk where the backups and copies of the database to be duplicated have been placed. This option is valid for duplication without a target or a recovery catalog connection.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref918"></a><a id="sthref919"></a>DEVICE&nbsp;TYPE</code> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></td>
<td class="cellalignment1926" headers="r3c1-t79 r1c2-t79">Allocates automatic channels for the specified device only (for example, <code dir="ltr">DISK</code> or <code dir="ltr">sbt</code>).
<p>This option is valid only if you have configured automatic channels and have <span class="italic">not</span> manually allocated channels. For example, if you <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> automatic disk and tape channels, and if you run <code dir="ltr">DUPLICATE...DEVICE TYPE DISK</code>, then RMAN allocates only disk channels.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref920"></a>DORECOVER</code></td>
<td class="cellalignment1926" headers="r4c1-t79 r1c2-t79">Specifies that RMAN should recover the standby database after creating it. If you specify an <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code>, then RMAN recovers to the specified SCN or time and leaves the database mounted.
<p>RMAN leaves the standby database mounted after media recovery is complete, but does not place the standby database in manual or managed recovery mode. After RMAN creates the standby database, you must resolve any gap sequence before placing it in manual or managed recovery mode, or opening it in read-only mode.</p>
<p>The checkpoint SCN of the control file must be included in an archived redo log that is either available at the standby site or included in an RMAN backup. For example, assume that you create the standby control file and then immediately afterward archive the current log, which has a sequence of 100. In this case, you must recover the standby database up to at least log sequence 100, or the database signals an <a id="sthref921"></a><a id="sthref922"></a><code dir="ltr">ORA-1152</code> error message because the standby control file backup was taken after the point in time.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t79" headers="r1c1-t79"><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl007.htm#i101650">fileNameConversionSpec</a></span></code></td>
<td class="cellalignment1926" headers="r5c1-t79 r1c2-t79">Specifies one or more patterns to map source database file names to duplicate database file names (see <a href="#CHDCHBGC">Example 2-75</a>).
<p><a id="sthref923"></a><a id="sthref924"></a><code dir="ltr">DB_FILE_NAME_CONVERT</code> set on the <code dir="ltr">DUPLICATE</code> command overrides the initialization parameter <code dir="ltr">DB_FILE_NAME_CONVERT</code> (if set). For example, if the initialization parameter file setting is <code dir="ltr">DB_FILE_NAME_CONVERT=('disk1','disk2')</code>, but you execute <code dir="ltr">DUPLICATE ... DB_FILE_NAME_CONVERT ('disk1','disk3')</code>, then RMAN does not convert the <code dir="ltr">disk1</code> substring to <code dir="ltr">disk2</code>. Instead, RMAN converts the <code dir="ltr">disk1</code> substring to <code dir="ltr">disk3</code>.</p>
<p>If a file in the specification list is not affected by the conversion parameter in <code dir="ltr">DUPLICATE</code>, then you must rename it by other means, such as <code dir="ltr">SET NEWNAME</code>.</p>
<p><span class="bold">Note:</span> If you specify the <a href="#CHDEAJCC">SPFILE</a> clause, then <code dir="ltr">DUPLICATE ... DB_FILE_NAME_CONVERT</code> overrides any conversion parameter specified in the <code dir="ltr">SPFILE</code> syntax. For example, if you specify <code dir="ltr">DB_FILE_NAME_CONVERT</code> twice in the <code dir="ltr">DUPLICATE</code> command, both in the <code dir="ltr">SPFILE</code> clause and outside of the <code dir="ltr">SPFILE</code> clause, then the setting outside of the <code dir="ltr">SPFILE</code> clause takes precedence.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl007.htm#i101650">fileNameConversionSpec</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t79" headers="r1c1-t79"><code dir="ltr">FROM&nbsp;<a id="sthref925"></a><a id="sthref926"></a>ACTIVE&nbsp;DATABASE</code></td>
<td class="cellalignment1926" headers="r6c1-t79 r1c2-t79">Specifies that the files for the duplicate database are provided directly from the source database and not from a backup of the source database (see <a href="#CHDJGCFC">Example 2-72</a>).
<p><span class="bold">See Also:</span> <a href="#CHDBCJFA">"Prerequisites Specific to Active Database Duplication"</a> for command prerequisites</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref927"></a><a id="sthref928"></a>LOGFILE</code></td>
<td class="cellalignment1926" headers="r7c1-t79 r1c2-t79">Specifies options for creating online redo logs when creating a duplicate database that is not a standby database (see <a href="#CHDCHBGC">Example 2-75</a>).</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t79" headers="r1c1-t79"><code dir="ltr">&nbsp;&nbsp;&nbsp;INSTANCE</code><code dir="ltr">&nbsp;'</code><code dir="ltr"><span class="codeinlineitalic">inst_name</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r8c1-t79 r1c2-t79"><a id="sthref929"></a><a id="sthref930"></a><a id="sthref931"></a>Creates online redo logs for the specified instance in a Real Applications Cluster (Oracle RAC) database. The instance name is a string of up to 80 characters.
<p>RMAN automatically uses the thread mapped to the specified instance. If no <code dir="ltr">INSTANCE</code> name is specified, then the log files are for the default instance.</p>
<p>This clause is relevant when you use <code dir="ltr">DUPLICATE TARGET DATABASE</code> to duplicate an Oracle RAC database to a single-instance database. Otherwise, you do not need to use <code dir="ltr">INSTANCE</code>. If you use the <code dir="ltr">LOGFILE</code> clause, then use <code dir="ltr">INSTANCE</code> to specify the name of the Oracle RAC instance for each thread that was open during the database backup (for backup-based duplication) or during the <code dir="ltr">UNTIL TIME</code> (for active database duplication).</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t79" headers="r1c1-t79"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="#BGBIHEHG"><span class="italic">logSpec</span></a></span></code></td>
<td class="cellalignment1926" headers="r9c1-t79 r1c2-t79">Specifies the file names and groups for the online redo log files.
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="#BGBIHEHG"><span class="italic">logSpec</span></a></span></code> for the valid options</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r10c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref932"></a>NOFILENAMECHECK</code></td>
<td class="cellalignment1926" headers="r10c1-t79 r1c2-t79">Prevents RMAN from checking whether the data files and online redo logs files of the source database are in use when the source database files share the same names as the duplicate database files. You are responsible for determining that the duplicate operation does not overwrite useful data.
<p>This option is necessary when you are creating a duplicate database in a different host that has the same disk configuration, directory structure, and file names as the host of the source database. For example, assume that you have a small database located in the <code dir="ltr">/dbs</code> directory of <code dir="ltr">srchost</code>:</p>
<pre dir="ltr">
/oracle/dbs/system_prod1.dbf
/oracle/dbs/users_prod1.dbf
/oracle/dbs/rbs_prod1.dbf
</pre>
<p>Assume that you want to duplicate this database to <code dir="ltr">desthost</code>, which has the same file system <code dir="ltr">/oracle/dbs/</code><code dir="ltr">*</code>, and you want to use the same file names in the duplicate database as in the source database. In this case, specify the <code dir="ltr">NOFILENAMECHECK</code> option to avoid an error message. Because RMAN is not aware of the different hosts, RMAN cannot determine automatically that it should not check the file names.</p>
<p>If duplicating a database on the same host as the source database, then ensure that <code dir="ltr">NOFILENAMECHECK</code> is not set. Otherwise, RMAN can potentially overwrite and corrupt the target database data files, temp files, or online logs. It may also signal the following error:</p>
<pre dir="ltr">
<a id="sthref933"></a><a id="sthref934"></a><a id="sthref935"></a><a id="sthref936"></a><a id="sthref937"></a><a id="sthref938"></a><a id="sthref939"></a><a id="sthref940"></a>RMAN-10035: exception raised in RPC: <a id="sthref941"></a><a id="sthref942"></a>ORA-19504: failed to create 
            file "/oracle/dbs/tbs_01.f" 
ORA-27086: skgfglk: unable to lock file - already in use 
SVR4 Error: 11: Resource temporarily unavailable 
Additional information: 8 
RMAN-10031: ORA-19624 occurred during call to 
DBMS_BACKUP_RESTORE.RESTOREBACKUPPIECE
</pre></td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r11c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref943"></a><a id="sthref944"></a>NOREDO</code></td>
<td class="cellalignment1926" headers="r11c1-t79 r1c2-t79">Specifies that no archived redo log files should be applied when recovering a consistent backup in any of the following scenarios:
<ul>
<li>
<p>You do not want to apply archived redo log files to the consistent backup even though the archived redo log files are available.</p>
</li>
<li>
<p>The source database was running in <code dir="ltr">NOARCHIVELOG</code> mode at backup time and <code dir="ltr">DUPLICATE</code> is not connected to the target database.</p>
</li>
<li>
<p>The source database is currently running in <code dir="ltr">ARCHIVELOG</code> mode but the backup was taken when the database was in <code dir="ltr">NOARCHIVELOG</code> mode.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r12c1-t79" headers="r1c1-t79"><code dir="ltr">NORESUME</code></td>
<td class="cellalignment1926" headers="r12c1-t79 r1c2-t79">Disables the ability for RMAN to automatically recover from a failed duplication operation. Using <code dir="ltr">NORESUME</code> in the first invocation of duplicate permanently prevents any subsequent duplicate command for the new database from using this automatic optimization.
<p><span class="bold">See Also:</span> <span class="italic">Oracle Database Backup and Recovery User's Guide</span> to learn more about the automated recovery from a failed <code dir="ltr">DUPLICATE</code> operation.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r13c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref945"></a><a id="sthref946"></a>OPEN&nbsp;RESTRICTED</code></td>
<td class="cellalignment1926" headers="r13c1-t79 r1c2-t79">Enables a restricted session in the duplicate database by issuing the following SQL statement: <code dir="ltr">ALTER SYSTEM ENABLE RESTRICTED SESSION</code>. RMAN issues this statement immediately before the duplicate database is opened.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r14c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref947"></a>PASSWORD&nbsp;FILE</code></td>
<td class="cellalignment1926" headers="r14c1-t79 r1c2-t79">Specifies that RMAN should use the password file on the source database to overwrite the password file currently used by the auxiliary instance (see <a href="#CHDJGCFC">Example 2-72</a>). This option is only valid when <code dir="ltr">FROM ACTIVE DATABASE</code> is specified; otherwise, RMAN signals an error.
<p>If <code dir="ltr">FOR STANDBY</code> is specified, then RMAN copies the password file by default; if not specified, then RMAN does not copy the password file by default. You can use <code dir="ltr">PASSWORD FILE</code> to request that RMAN overwrite the existing password file with the password file from the source database. If you want the duplicate database to contain all the passwords available on your production database, then use the <code dir="ltr">PASSWORD FILE</code> option.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r15c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref948"></a>PFILE</code> <code dir="ltr"><span class="codeinlineitalic">filename</span></code></td>
<td class="cellalignment1926" headers="r15c1-t79 r1c2-t79"><a id="sthref949"></a><a id="sthref950"></a><a id="sthref951"></a>Specifies a text-based initialization parameter file used by the auxiliary instance (see <a href="#CHDCHBGC">Example 2-75</a>). RMAN automatically shuts down and restarts the auxiliary instance during duplication. If the auxiliary does not use a server parameter file in the default location, then you must specify the text-based initialization parameter file that RMAN should use when starting the auxiliary instance. The initialization parameter file must reside on the same host as the RMAN client used to perform the duplication.
<p>If the auxiliary instance uses a server parameter file in the default location, then you do not need to specify <code dir="ltr">PFILE</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r16c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref952"></a><a id="sthref953"></a>SKIP&nbsp;READONLY</code></td>
<td class="cellalignment1926" headers="r16c1-t79 r1c2-t79">Excludes data files in current read-only tablespaces from the duplicate database. By default RMAN duplicates current read-only tablespaces.
<p>If a tablespace is currently read/write, but you use <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code> to duplicate the database to an SCN at which the tablespace was read-only, then RMAN does not include the tablespace in the duplicate database. Tablespaces that were read-only previously are considered offline tablespaces and so are not included in the duplication.</p>
<p><span class="bold">Note:</span> The read-only tablespaces must be self-contained for the <code dir="ltr">DUPLICATE</code> command to succeed with this option.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r17c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref954"></a><a id="sthref955"></a>SKIP&nbsp;TABLESPACE</code> <code dir="ltr"><span class="codeinlineitalic">tbs_name</span></code></td>
<td class="cellalignment1926" headers="r17c1-t79 r1c2-t79">Excludes the specified tablespace from the duplicate database (see <a href="#CHDCHBGC">Example 2-75</a>).
<p><span class="bold">Note:</span> You must not exclude SYS-owned objects or tablespaces with rollback segments, nor tablespaces containing materialized views. The set of tablespaces to be duplicated must be self-contained.</p>
<p>If you must duplicate a database when some backups of the source database do not exist, then <code dir="ltr">SKIP TABLESPACE</code> is required. If you do not specify <code dir="ltr">SKIP TABLESPACE</code>, then RMAN attempts to duplicate the following:</p>
<ul>
<li>
<p>All data files in online tablespaces, whether or not the data files are online.</p>
</li>
<li>
<p>All tablespaces taken offline with an option <span class="italic">other than</span> <code dir="ltr">NORMAL</code>. For example, RMAN attempts to duplicate tablespaces taken offline with the <code dir="ltr">IMMEDIATE</code> option. You cannot duplicate <code dir="ltr">OFFLINE NORMAL</code> tablespaces, although you can add these tablespaces manually after duplication.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r18c1-t79" headers="r1c1-t79"><a id="CHDEAJCC"></a><code dir="ltr"><a id="sthref956"></a>SPFILE</code></td>
<td class="cellalignment1926" headers="r18c1-t79 r1c2-t79">Copies the server parameter file from the source database to the duplicate database. No initialization parameters previously set in the duplicate database are used.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r19c1-t79" headers="r1c1-t79"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="#CHDHAJGD"><span class="italic">setParameter</span></a></span></code></td>
<td class="cellalignment1926" headers="r19c1-t79 r1c2-t79">Sets the specified initialization parameters to the specified values. Refer to <code dir="ltr"><span class="codeinlineitalic"><a href="#CHDHAJGD"><span class="italic">setParameter</span></a></span></code>.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r20c1-t79" headers="r1c1-t79"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref957"></a><a id="sthref958"></a>PARAMETER_VALUE_CONVERT</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">string_pattern</span></code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;[</code><code dir="ltr"><span class="codeinlineitalic"><a href="#CHDHAJGD"><span class="italic">setParameter</span></a></span></code><code dir="ltr">]</code></td>
<td class="cellalignment1926" headers="r20c1-t79 r1c2-t79">Replaces the first string with the second string in all matching initialization parameter values. Refer to the description of <code dir="ltr">PARAMETER_VALUE_CONVERT</code> in <code dir="ltr"><span class="codeinlineitalic"><a href="#i1011578"><span class="italic">dupOptionList</span></a></span></code>.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r21c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref959"></a><a id="sthref960"></a>TABLESPACE</code> <code dir="ltr"><span class="codeinlineitalic">tablespace_name</span></code></td>
<td class="cellalignment1926" headers="r21c1-t79 r1c2-t79">Specifies which tablespaces are included in the specified database. Unlike <code dir="ltr">SKIP TABLESPACE</code>, which specifies which tablespaces are <span class="italic">excluded</span> from the duplicate database, this option specifies which tablespaces are included and then skips the remaining tablespaces.
<p><span class="bold">Note:</span> RMAN automatically includes the <code dir="ltr">SYSTEM</code>, <code dir="ltr">SYSAUX</code>, and undo tablespaces in the duplicate database. These tablespaces cannot be skipped and the set of tablespaces that you want to duplicate must be self-contained.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r22c1-t79" headers="r1c1-t79"><code dir="ltr"><a id="sthref961"></a><a id="sthref962"></a>UNDO TABLESPACE</code> <code dir="ltr"><span class="codeinlineitalic">tablespace_name</span></code></td>
<td class="cellalignment1926" headers="r22c1-t79 r1c2-t79">Specifies the names of the tablespaces with undo segments. This option is only required when a subset of tablespaces are being duplicated with the <code dir="ltr">SKIP TABLESPACE</code> and <code dir="ltr">TABLESPACE</code> clauses. You must provide the list of tablespaces with undo segments in the following cases:
<ul>
<li>
<p>No connection to the target database or the recovery catalog</p>
</li>
<li>
<p>No connection to a recovery catalog, a connection to the target but the target database is not open.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r23c1-t79" headers="r1c1-t79"><br />
<code dir="ltr"><a id="sthref963"></a><a id="sthref964"></a>TO&nbsp;RESTORE&nbsp;POINT</code><br />
<code dir="ltr"><span class="codeinlineitalic">restore_point_name</span></code></td>
<td class="cellalignment1926" headers="r23c1-t79 r1c2-t79">Specifies a restore point for backup-based duplication, with the SCN at which the restore point was created as the upper, inclusive limit. Because the limit is inclusive, RMAN selects only files that it can use to duplicate a database up to <span class="italic">and including</span> the corresponding SCN.
<p><span class="bold">Note:</span> The same restrictions that apply to <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code> also apply to <code dir="ltr">TO RESTORE POINT</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r24c1-t79" headers="r1c1-t79"><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code></td>
<td class="cellalignment1926" headers="r24c1-t79 r1c2-t79"><a id="sthref965"></a><a id="sthref966"></a><a id="sthref967"></a><a id="sthref968"></a>Sets the end time, SCN, or log sequence number for point-in-time recovery in backup-based duplication (see <a href="#CHDCHBGC">Example 2-75</a>). The <code dir="ltr">UNTIL</code> clause is not supported in active database duplication.
<p>You can achieve the same result by running <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">UNTIL</code> before the <code dir="ltr">DUPLICATE</code> command. If you specify the <code dir="ltr">UNTIL</code> clause for duplication, then the following restrictions apply:</p>
<ul>
<li>
<p>RMAN determines whether to use <a id="sthref969"></a><code dir="ltr">NOREDO</code> based on the current state of the database. If the database was in an archiving mode at the specified <code dir="ltr">UNTIL</code> time or SCN that is different from the current archiving mode, then RMAN does not use <code dir="ltr">NOREDO</code>.</p>
</li>
<li>
<p>The end point for a <code dir="ltr">DUPLICATE</code> command cannot be before the SCN of the most recent <code dir="ltr">ALTER DATABASE OPEN RESETLOGS</code>. Duplication with a connection to a target does not support previous database incarnations. However, you can specify previous incarnations if you are duplicating without a connection to a target database.</p>
</li>
<li>
<p>You cannot recover the duplicate database to the current point in time, that is, the most recent SCN. RMAN recovers the duplicate database up to or before the most recent available archived log, but cannot recover into the online redo logs.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="CHDHAJGD"></a><a id="RCMRF90164"></a><span class="italic"><a id="sthref970"></a><a id="sthref971"></a>setParameter</span></p>
<p>This subclause specifies server parameter file values.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for ServerParam Command" summary="Describes DUPLICATE command setParameter parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t80">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t80">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t80" headers="r1c1-t80"><code dir="ltr"><a id="sthref972"></a><a id="sthref973"></a>SET</code> <code dir="ltr"><span class="codeinlineitalic">identifier&nbsp;string</span></code></td>
<td class="cellalignment1926" headers="r2c1-t80 r1c2-t80">Sets the specified initialization parameters to the specified values (see <a href="#CHDCBDHI">Example 2-73</a>). You can use <code dir="ltr">SET</code> to adjust for differences in memory, turn off replication options, and set other options for the duplicate database.
<p>This <code dir="ltr">SET</code> functionality is equivalent to pausing the duplication after restoring the server parameter file and issuing <code dir="ltr">ALTER SYSTEM SET</code> statements to change the initialization parameter file.</p>
<p>RMAN processes <code dir="ltr">SET</code> after <a id="sthref974"></a><code dir="ltr">PARAMETER_VALUE_CONVERT</code>. If <code dir="ltr">PARAMETER_VALUE_CONVERT</code> sets the file name specified by a parameter, and if <code dir="ltr">SET</code> sets the file name specified by the same parameter, then the <code dir="ltr">SET</code> value overrides the <code dir="ltr">PARAMETER_VALUE_CONVERT</code> setting.</p>
<p><span class="bold">Note:</span> If <a id="sthref975"></a><a id="sthref976"></a><code dir="ltr">DB_FILE_NAME_CONVERT</code> is specified on the <code dir="ltr">DUPLICATE</code> command, then its file name settings override competing settings specified by <code dir="ltr">SPFILE SET</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t80" headers="r1c1-t80"><code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref977"></a>COMMENT</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">string</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r3c1-t80 r1c2-t80">Specifies an optional comment for the parameter setting.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t80" headers="r1c1-t80"><code dir="ltr">RESET</code> <code dir="ltr"><span class="codeinlineitalic">identifier&nbsp;string</span></code></td>
<td class="cellalignment1926" headers="r4c1-t80 r1c2-t80">Deletes specified initialization parameters from the parameter file. You can use <code dir="ltr">RESET</code> to remove unneeded initialization parameters.
<p>This <code dir="ltr">RESET</code> functionality is equivalent to pausing the duplication after restoring the server parameter file and issuing <code dir="ltr">ALTER SYSTEM RESET</code> statements to change the initialization parameter file.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="BGBIHEHG"></a><a id="RCMRF90165"></a><span class="italic"><a id="sthref978"></a><a id="sthref979"></a>logSpec</span></p>
<p><a id="sthref980"></a>This subclause specifies the online redo logs when creating a duplicate database that is not a standby database. Refer to the <a href="#CHDIGIJD"><span class="xreftitleitalic"><span class="italic">logSpec</span>::=</span></a> diagram for the syntax diagram.</p>
<p>If you do not specify <code dir="ltr"><a id="sthref981"></a>LOGFILE</code>, then RMAN first checks if any of the following initialization parameters are set: <code dir="ltr"><a id="sthref982"></a>LOG_FILE_NAME_CONVERT,DB_CREATE_FILE_DEST, DB_RECOVERY_FILE_DEST</code> or <code dir="ltr">DB_CREATE_ONLINE_LOG_DEST_n</code>. If these parameters are set, RMAN directs duplicate database online redo log files to Oracle managed storage based on these parameter settings. If none of these initialization parameters are set, then RMAN uses the original redo log file names of the source database for redo log files of the duplicate database. You must specify the <a id="sthref983"></a><code dir="ltr">NOFILENAMECHECK</code> option in this case.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for logSpec Command" summary="Describes DUPLICATE command logSpec parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t81">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t81">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t81" headers="r1c1-t81"><code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code> <code dir="ltr">SIZE&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">sizeSpec</span></code></td>
<td class="cellalignment1926" headers="r2c1-t81 r1c2-t81">Specifies the file name of the online redo log member and the size of the file in kilobytes (<code dir="ltr">K</code>) or megabytes (<code dir="ltr">M</code>). The default is in bytes.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t81" headers="r1c1-t81"><code dir="ltr">&nbsp;&nbsp;&nbsp;REUSE</code></td>
<td class="cellalignment1926" headers="r3c1-t81 r1c2-t81">Allows the database to reuse an existing file. If the file exists, then the database verifies that its size matches the value of the <code dir="ltr">SIZE</code> parameter. If the file does not exist, then it is created.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t81" headers="r1c1-t81"><br />
<code dir="ltr">GROUP</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code><br />
<code dir="ltr">('</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">', ...)</code><br />
<code dir="ltr">SIZE</code>&nbsp;<code dir="ltr"><span class="codeinlineitalic">sizeSpec</span></code></td>
<td class="cellalignment1926" headers="r4c1-t81 r1c2-t81">Specifies the group containing the online redo log members, the file name of the online redo log member, and the size of the file in kilobytes (<code dir="ltr">K</code>) or megabytes (<code dir="ltr">M</code>). The default is in bytes.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t81" headers="r1c1-t81"><code dir="ltr">&nbsp;&nbsp;&nbsp;REUSE</code></td>
<td class="cellalignment1926" headers="r5c1-t81 r1c2-t81">Allows the database to reuse an existing log.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="i104404"></a><a id="sthref984"></a>Examples</p>
<div id="RCMRF90166" class="example">
<p class="titleinexample"><a id="CHDJGCFC"></a>Example 2-72 Duplicating from an Active Database to a Host with the Same Directory Structure</p>
<p>Assume that you want to create a test database from database <code dir="ltr">prod1</code> on a new host. The new host has the same directory structure as the source host, so the files in the duplicate database can use the same names as the files in the source database. You want to create the database without using RMAN backups and allow <code dir="ltr">prod1</code> to remain open during the duplication.</p>
<p>If <code dir="ltr">prod1</code> uses a server parameter file, then you can create an initialization parameter file on the destination host that contains only the <code dir="ltr">DB_NAME</code> parameter set to an arbitrary value. Before starting the auxiliary instance you should create a password file that has the same <code dir="ltr">SYSDBA</code> password as the source database. Afterward, start the auxiliary instance using an spfile, if available. If you start the auxiliary instance with a pfile, then RMAN creates an spfile in the default location, possibly overwriting any spfile residing there.</p>
<p>By default, RMAN does not duplicate the password file when creating a duplicate database that is not a standby database. The <code dir="ltr">PASSWORD FILE</code> option specifies that RMAN should copy the password file to the destination host. If you want the duplicate database to contain all the passwords available on your source database, then use the <code dir="ltr">PASSWORD FILE</code> option.</p>
<p>You do not need to configure auxiliary channels because RMAN uses the normal channels configured on the source database to copy the database files. Start the RMAN client, connect to the source and auxiliary database instances, and duplicate the database as follows:</p>
<pre dir="ltr">
% rman
RMAN&gt; CONNECT TARGET SYS@prod1

target database Password: <span class="italic">password</span>
connected to target database: PROD1 (DBID=39525561)

RMAN&gt; CONNECT AUXILIARY SYS@dup1

auxiliary database Password: <span class="italic">password</span>
connected to auxiliary database: DUP1 (not mounted)

RMAN&gt; DUPLICATE TARGET DATABASE TO dup1
2&gt; FROM ACTIVE DATABASE
3&gt; NOFILENAMECHECK
4&gt; PASSWORD FILE
5&gt; SPFILE;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90167" class="example">
<p class="titleinexample"><a id="CHDCBDHI"></a>Example 2-73 Copying the Server Parameter File in Active Database Duplication</p>
<p>Assume that you want to create a standby database from database <code dir="ltr">prod1</code> on a new host. The destination host has a different directory structure from the source host, so the standby database files are stored in <code dir="ltr">/disk2</code> rather than <code dir="ltr">/disk1</code>. You want to create the standby database without using RMAN backups and let <code dir="ltr">prod1</code> remain open during the duplication.</p>
<p>Your first step is to create a minimal initialization parameter file for the standby database and then start the standby instance. This parameter file is minimal because when you use the <code dir="ltr"><a href="#CHDEAJCC">SPFILE</a></code> option, RMAN copies the server parameter file to the new host and sets various parameters to the new values provided. The parameters used to start the standby instance are ignored.</p>
<p>Start the RMAN client, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to the source database as <code dir="ltr">TARGET</code> and connect to the auxiliary instance. Allocate multiple channels to the target instance and a channel to the auxiliary instance as shown here:</p>
<pre dir="ltr">
ALLOCATE CHANNEL tgt10 TYPE DISK; 
ALLOCATE CHANNEL tgt20 TYPE DISK; 
ALLOCATE CHANNEL tgt30 TYPE DISK; 
ALLOCATE CHANNEL tgt40 TYPE DISK; 
ALLOCATE AUXILIARY CHANNEL dup1 TYPE DISK;
</pre>
<p>You can then enter the following command:</p>
<pre dir="ltr">
DUPLICATE TARGET DATABASE
  FOR STANDBY
  FROM ACTIVE DATABASE
  PASSWORD FILE
  SPFILE 
    PARAMETER_VALUE_CONVERT '/disk1', '/disk2'
    SET DB_FILE_NAME_CONVERT '/disk1','/disk2'
    SET LOG_FILE_NAME_CONVERT '/disk1','/disk2'
    SET DB_UNIQUE_NAME 'dup1'
    SET SGA_MAX_SIZE 200M
    SET SGA_TARGET 125M;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90168" class="example">
<p class="titleinexample"><a id="sthref985"></a>Example 2-74 Duplicating a Database Without a Target Connection to a Host with the Same Directory Structure</p>
<p>Assume that you want to duplicate source database <code dir="ltr">prod</code> using backups and do not want to connect RMAN as <code dir="ltr">TARGET</code> to this database because it is shut down for maintenance. A description of the environment follows:</p>
<ul>
<li>
<p>The source and destination hosts have identical directory structures. The data file and online redo log names in the duplicate database must be identical to the names in the source database.</p>
</li>
<li>
<p>The same number of online redo log files are used in the duplicate database.</p>
</li>
<li>
<p>A recovery catalog is available. The source database name <code dir="ltr">prod</code> is unique in the recovery catalog.</p>
</li>
<li>
<p>Auxiliary channels have been configured with the <code dir="ltr">CONFIGURE CHANNEL</code> command.</p>
</li>
</ul>
<p>The following commands create a duplicate database named <code dir="ltr">dupdb</code>:</p>
<pre dir="ltr">
% <span class="bold">rman</span> 

RMAN&gt; <span class="bold">CONNECT CATALOG rman@catdb;</span>
 
recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; <span class="bold">CONNECT AUXILIARY SYS@dupdb;</span>

auxiliary database Password: <span class="bolditalic">password</span>
connected to auxiliary database: DUPDB (not mounted)

RMAN&gt; <span class="bold">DUPLICATE DATABASE 'PROD' TO 'DUPDB' NOFILENAMECHECK;</span>
</pre>
<p>Assume a different scenario in which the database name <code dir="ltr">prod</code> is not unique in the recovery catalog. The following <code dir="ltr">DUPLICATE</code> command uses the <code dir="ltr">DBID</code> parameter to uniquely identify the source database:</p>
<pre dir="ltr">
RMAN&gt; <span class="bold">DUPLICATE DATABASE 'PROD' DBID 39525561 TO 'DUPDB' NOFILENAMECHECK;</span>
</pre></div>
<!-- class="example" -->
<div id="RCMRF90169" class="example">
<p class="titleinexample"><a id="CHDCHBGC"></a>Example 2-75 Setting New File Names in the DUPLICATE Command</p>
<p>Assume that you want to use tape backups to duplicate the source database <code dir="ltr">prod</code> on <code dir="ltr">srchost</code> to <code dir="ltr">newdb</code> on <code dir="ltr">desthost</code>.</p>
<p>In this scenario, the source database does not use a server parameter file. You create a text-based initialization parameter file on <code dir="ltr">desthost</code> and use it to start the database instance. Thus, backup-based duplication must use a target connection (see <a href="#BABEDFJI">Table 2-6</a>).</p>
<p>When executing <code dir="ltr">DUPLICATE</code> on <code dir="ltr">desthost</code>, you must use the <code dir="ltr">PFILE</code> parameter to specify the location of the initialization parameter file. You must use the RMAN client on the same host as the initialization parameter file for the duplicate database.</p>
<p>You do not want the tablespaces <code dir="ltr">example</code> and <code dir="ltr">history</code> to be included in the duplicate database, so you specify <code dir="ltr">DUPLICATE ... SKIP TABLESPACE</code> for these tablespaces. Also, you want the duplicate database to be in the state that the production database was in 24 hours ago, so you use <code dir="ltr">DUPLICATE ... UNTIL TIME</code>.</p>
<p>This example assumes that the data files of the source database are on <code dir="ltr">srchost</code> in directory <code dir="ltr">/h1/oracle/dbs/trgt</code>. You intend to duplicate the data files to the directory <code dir="ltr">/h2/oracle/oradata/newdb</code>, so you specify <code dir="ltr">DUPLICATE ... DB_FILE_NAME_CONVERT</code> to generate the names for the duplicate data files. You use <code dir="ltr">DUPLICATE ... LOGFILE</code> to specify names for the online redo log files in the duplicate database.</p>
<p>Start the RMAN client on <code dir="ltr">desthost</code>, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to the source database as <code dir="ltr">TARGET</code>, and connect to the auxiliary instance. You can then enter the following <code dir="ltr">RUN</code> command:</p>
<pre dir="ltr">
RUN
{  
  ALLOCATE AUXILIARY CHANNEL newdb DEVICE TYPE sbt; 
  DUPLICATE TARGET DATABASE TO newdb
    PFILE ?/dbs/initNEWDB.ora
    UNTIL TIME 'SYSDATE-1'  # specifies incomplete recovery
    SKIP TABLESPACE example, history   # skip desired tablespaces
    DB_FILE_NAME_CONVERT ('/h1/oracle/dbs/trgt/','/h2/oracle/oradata/newdb/')
    LOGFILE
      GROUP 1 ('/h2/oradata/newdb/redo01_1.f',
               '/h2/oradata/newdb/redo01_2.f') SIZE 4M,
      GROUP 2 ('/h2/oradata/newdb/redo02_1.f',
               '/h2/oradata/newdb/redo02_2.f') SIZE 4M,
      GROUP 3 ('/h2/oradata/newdb/redo03_1.f',
               '/h2/oradata/newdb/redo03_2.f') SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF90170" class="example">
<p class="titleinexample"><a id="BGBGEHCG"></a>Example 2-76 Using SET NEWNAME FOR DATABASE to Name Duplicate Files</p>
<p>In this scenario, you intend to use backup-based duplication without a target connection.</p>
<p>The source database <code dir="ltr">prod</code> contains eight data files spread out over multiple directories. The data files are not Oracle Managed Files. You want to duplicate the source database to <code dir="ltr">dupdb</code> on destination host <code dir="ltr">desthost</code>.</p>
<p>In this scenario, <code dir="ltr">srchost</code> and <code dir="ltr">desthost</code> have different directory structures. You want to store the data files in <code dir="ltr">desthost</code> in the <code dir="ltr">/oradata1</code> subdirectory, so you use <code dir="ltr">SET NEWNAME FOR DATABASE</code> to specify the file names stripped of directory paths. For example, if a source data file has the name <code dir="ltr">'/oradata/prod/financial.dbf'</code>, then <code dir="ltr">%b</code> results in <code dir="ltr">'financial.dbf'</code>.</p>
<p>The source database does not use a server parameter file, so you cannot use the <code dir="ltr">SPFILE</code> technique to specify names for the duplicate data files. You decide to use the <code dir="ltr">SET NEWNAME DATABASE</code> command because you want all duplicate data files in the same directory on the destination host.</p>
<p>You want to create two online redo log groups, each with two members of size 200 KB, in the directory <code dir="ltr">/duplogs</code> on the destination host. Assume that <code dir="ltr">srchost</code> and <code dir="ltr">desthost</code> cannot mount each other's file systems by any means such as NFS.</p>
<p>You have disk copies or backup sets stored on disk for all the data files and archived redo log files in the source database, and you have manually copied them to <code dir="ltr">desthost</code> using an operating system utility. These backups and copies exist in the same location on <code dir="ltr">desthost</code> as they do in <code dir="ltr">srchost</code>.</p>
<p>You use an operating system utility to copy the initialization parameter file from <code dir="ltr">srchost</code> to an appropriate location in <code dir="ltr">desthost</code>. You have reset all initialization parameters that end in <code dir="ltr">_DEST</code> and specify a path name. You do not set <code dir="ltr">DB_FILE_NAME_CONVERT</code> and <code dir="ltr">LOG_FILE_NAME_CONVERT</code> because you are specifying names for data files and online logs in the <code dir="ltr">RUN</code> command itself. The auxiliary instance uses a server-side initialization parameter file in the default location so the <code dir="ltr">PFILE</code> parameter is not necessary on the <code dir="ltr">DUPLICATE</code> command.</p>
<p>The following sample script creates the duplicate database. A <code dir="ltr">RUN</code> command is necessary because you can only execute <code dir="ltr">SET NEWNAME</code> within <code dir="ltr">RUN</code>.</p>
<pre dir="ltr">
RUN
{
  SET NEWNAME FOR DATABASE TO '/oradata1/%b'; 
  DUPLICATE TARGET DATABASE TO dupdb
    LOGFILE
      GROUP 1 ('/duplogs/redo01a.log', 
               '/duplogs/redo01b.log') SIZE 4M REUSE,
      GROUP 2 ('/duplogs/redo02a.log',
               '/duplogs/redo02b.log') SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF90171" class="example">
<p class="titleinexample"><a id="BGBFADEH"></a>Example 2-77 Using SET NEWNAME FOR DATAFILE and SET NEWNAME FOR TABLESPACE to Name Duplicate Files</p>
<p>In this scenario, you intend to duplicate a database by using backup-based duplication.</p>
<p>Assume that the source database <code dir="ltr">prod</code> is on <code dir="ltr">srchost</code> and contains nine data files, which are spread out over multiple directories. You want to duplicate the source database to database <code dir="ltr">dupdb</code> on remote host <code dir="ltr">desthost</code>. The <code dir="ltr">dupdb</code> database should exclude tablespace <code dir="ltr">tools</code>, but keep all of the other tablespaces.</p>
<p>The source database does not use a server parameter file, so you cannot use the <code dir="ltr">SPFILE</code> technique to specify names for the duplicate data files. You decide to use <code dir="ltr">SET NEWNAME</code> commands to specify the file names because the duplicate data files will be spread across several directories.</p>
<p>In this scenario, <code dir="ltr">srchost</code> and <code dir="ltr">desthost</code> have different directory structures. You want to store the data files in <code dir="ltr">desthost</code> in the <code dir="ltr">/oradata1</code> through <code dir="ltr">/oradata7</code> subdirectories. You want to place each data file in a different directory, except for the <code dir="ltr">USERS</code> tablespace, which contains two data files that you intend to duplicate to <code dir="ltr">/oradata7</code>.</p>
<p>You want to create two online redo log groups, each with two members of size 200 KB, in the directory <code dir="ltr">/duplogs</code> on the destination host. Assume that <code dir="ltr">srchost</code> and <code dir="ltr">desthost</code> cannot mount each other's file systems by any means such as NFS.</p>
<p>You have disk copies or backup sets stored on disk for all the data files and archived redo log files in the source database, and you have manually copied them to <code dir="ltr">desthost</code> using an operating system utility. These backups and copies exist in the same location on <code dir="ltr">desthost</code> as they do in <code dir="ltr">srchost</code>.</p>
<p>You use an operating system utility to copy the initialization parameter file from <code dir="ltr">srchost</code> to an appropriate location in <code dir="ltr">desthost</code>. You have reset all initialization parameters that end in <code dir="ltr">_DEST</code> and specify a path name. You do not set <code dir="ltr">DB_FILE_NAME_CONVERT</code> and <code dir="ltr">LOG_FILE_NAME_CONVERT</code> because you are specifying names for data files and online logs in the <code dir="ltr">RUN</code> command itself. The auxiliary instance uses a server-side initialization parameter file in the default location so the <code dir="ltr">PFILE</code> parameter is not necessary on the <code dir="ltr">DUPLICATE</code> command.</p>
<p>The following sample scripts creates the duplicate database. A <code dir="ltr">RUN</code> command is necessary because you can only execute <code dir="ltr">SET NEWNAME</code> within <code dir="ltr">RUN</code>.</p>
<pre dir="ltr">
<a id="BGBFICJI"></a>
RUN
{
  SET NEWNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf'; 
  SET NEWNAME FOR DATAFILE 2 TO '/oradata2/undotbs01.dbf';
  SET NEWNAME FOR DATAFILE 3 TO '/oradata3/cwmlite01.dbf'; 
  SET NEWNAME FOR DATAFILE 4 TO '/oradata4/drsys01'; 
  SET NEWNAME FOR DATAFILE 5 TO '/oradata5/example01.dbf'; 
  # because the users tablespace contains 2 datafiles, the following command
  # generates unique names for both datafiles, placing them in /oradata7
  SET NEWNAME FOR TABLESPACE users TO '/oradata7/users%b.dbf';
  DUPLICATE TARGET DATABASE TO dupdb
    SKIP TABLESPACE tools
    LOGFILE
      GROUP 1 ('/duplogs/redo01a.log', 
               '/duplogs/redo01b.log') SIZE 4M REUSE, 
      GROUP 2 ('/duplogs/redo02a.log', 
               '/duplogs/redo02b.log') SIZE 4M REUSE;
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF89957" class="example">
<p class="titleinexample"><a id="BGBCEBDI"></a>Example 2-78 Using SET NEWNAME FOR DATAFILE to Name Oracle-Managed Files</p>
<p>There are two ways to store specific data files or temp files in an Oracle-managed files destination that is independent of the locations of the rest of the database files.</p>
<ol>
<li>
<p>Set the parameter <code dir="ltr">DB_CREATE_FILE_DEST</code> in the initialization parameter file of the auxiliary instance to the desired location.</p>
</li>
<li>
<p>Set the initialization parameters <code dir="ltr">DB_CREATE_FILE_DEST</code> and <code dir="ltr">DB_FILE_NAME_CONVERT</code>. At this point, you can use the <code dir="ltr">SET NEWNAME</code> command for those data files that you do not want to be converted by <code dir="ltr">DB_FILE_NAME_CONVERT</code>.</p>
</li>
</ol>
<p>The specified data files or temp files are created with Oracle-managed file names in the location specified by <code dir="ltr">DB_CREATE_FILE_DEST</code>.</p>
<p>As shown in the following sample script, you can also use <code dir="ltr">SET</code> <code dir="ltr">NEWNAME</code> to direct individual data files or temp files to a specific ASM disk group.</p>
<pre dir="ltr">
<a id="CHDCACEF"></a>
RUN
{
   SET NEWNAME FOR DATAFILE 1 TO "+DGROUP1";
   SET NEWNAME FOR DATAFILE 2 TO "+DGROUP2";
   .
   .
   .
   DUPLICATE TARGET DATABASE 
     TO dupdb
     FROM ACTIVE DATABASE
     SPFILE SET DB_CREATE_FILE_DEST +DGROUP3;
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF89958" class="example">
<p class="titleinexample"><a id="CHDJGFIJ"></a>Example 2-79 Using CONFIGURE AUXNAME to Name Duplicate Files</p>
<p><a id="sthref986"></a>This section assumes the same circumstances described in <a href="#BGBFADEH">Example 2-77, "Using SET NEWNAME FOR DATAFILE and SET NEWNAME FOR TABLESPACE to Name Duplicate Files"</a>. This example is a variation that uses <code dir="ltr">CONFIGURE AUXNAME</code> instead of <code dir="ltr">SET NEWNAME</code> to specify the new data file names. These new file names are recorded in the control file and used every time you perform the duplication in the future.</p>
<p>This example also uses automatic channels and a client-side initialization parameter file for the database duplication, and uses the <code dir="ltr">LOGFILE</code> clause to specify names and sizes for the online redo logs. In this case the <code dir="ltr">RUN</code> command is not necessary because you are not using <code dir="ltr">SET NEWNAME</code>.</p>
<pre dir="ltr">
<a id="CHDEIAHB"></a>
CONFIGURE AUXNAME FOR DATAFILE 1 TO '/oradata1/system01.dbf'; 
CONFIGURE AUXNAME FOR DATAFILE 2 TO '/oradata2/undotbs01.dbf';
CONFIGURE AUXNAME FOR DATAFILE 3 TO '/oradata3/cwmlite01.dbf'; 
CONFIGURE AUXNAME FOR DATAFILE 4 TO '/oradata4/drsys01'; 
CONFIGURE AUXNAME FOR DATAFILE 5 TO '/oradata5/example01.dbf'; 
CONFIGURE AUXNAME FOR DATAFILE 6 TO '/oradata6/indx01.dbf';
DUPLICATE TARGET DATABASE
  TO dupdb
  SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 ('/duplogs/redo01a.log',
             '/duplogs/redo01b.log') SIZE 4M REUSE,
    GROUP 2 ('/duplogs/redo02a.log',
             '/duplogs/redo02b.log') SIZE 4M REUSE;
</pre>
<p>RMAN uses all incremental backups, archived redo log backups, and archived redo log files to perform incomplete recovery and then opens the database with the <code dir="ltr">RESETLOGS</code> option to create the online redo logs.</p>
<p>After the duplication is complete, you can clear the configured auxiliary names for the data files in the duplicate database, so that they are not overwritten by future operations. For example, enter the following commands:</p>
<pre dir="ltr">
CONFIGURE AUXNAME FOR DATAFILE 1 CLEAR; 
CONFIGURE AUXNAME FOR DATAFILE 2 CLEAR; 
CONFIGURE AUXNAME FOR DATAFILE 3 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 4 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 5 CLEAR;
CONFIGURE AUXNAME FOR DATAFILE 6 CLEAR;
</pre>
<p>Alternatively, you may want to periodically synchronize a duplicate database with the original database that was duplicated. In this case, you can run the <code dir="ltr">DUPLICATE</code> command again, essentially re-creating the duplicate database. This technique requires making complete copies of the data files of the duplicate database. Run the following script whenever you want to synchronize the duplicate with the source database. For example, you might run the script daily or weekly.</p>
<pre dir="ltr">
<a id="CHDDFCBD"></a>
DUPLICATE TARGET DATABASE TO dupdb
SKIP TABLESPACE tools
  LOGFILE
    GROUP 1 ('/duplogs/redo01a.log',
             '/duplogs/redo01b.log') SIZE 4M REUSE,
    GROUP 2 ('/duplogs/redo02a.log',
             '/duplogs/redo02b.log') SIZE 4M REUSE;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90172" class="example">
<p class="titleinexample"><a id="CHDDDADC"></a>Example 2-80 Creating a Standby Database with the Same Directory Structure</p>
<p>Assume that you want to use RMAN backups to create a standby database on a remote host with the same directory structure as the source host. The source database is called <code dir="ltr">prod1</code> and is the primary database in the Data Guard environment.</p>
<p>First, start the RMAN client, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to the source database <code dir="ltr">prod1</code> as <code dir="ltr">TARGET</code>, and connect to the auxiliary instance. You can then <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> the default device type to <code dir="ltr">sbt</code> for a standby database with the <code dir="ltr">DB_UNIQUE_NAME</code> of <code dir="ltr">standby1</code>:</p>
<pre dir="ltr">
CONFIGURE DEFAULT DEVICE TYPE sbt FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEVICE TYPE sbt PARALLELISM 2 FOR DB_UNIQUE_NAME standby1;
</pre>
<p>Assume all backups needed to create the standby database are on tape. In the standby database initialization parameter file, you set <code dir="ltr">DB_UNIQUE_NAME</code> to <code dir="ltr">standby1</code>.</p>
<p>The default initialization parameter file location is in use on the standby database. After starting the standby instance <code dir="ltr">NOMOUNT</code>, you start the RMAN client, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to the source database as <code dir="ltr">TARGET</code>, and connect to the auxiliary instance and recovery catalog. You run the following <code dir="ltr">DUPLICATE</code> command, specifying the <code dir="ltr">NOFILENAMECHECK</code> option because the standby and primary data files and online redo log files have the same names:</p>
<pre dir="ltr">
DUPLICATE TARGET DATABASE FOR STANDBY
  NOFILENAMECHECK;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90173" class="example">
<p class="titleinexample"><a id="CHDDFDGH"></a>Example 2-81 Creating a Standby Database in OMF and ASM</p>
<p><a id="sthref987"></a><a id="sthref988"></a>Assume that you want to use RMAN backups to create a standby database on a host that uses OMF and ASM. The source database is called <code dir="ltr">prod1</code> and is the primary database in the Data Guard environment.</p>
<p>First, start the RMAN client, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to database <code dir="ltr">prod1</code> as <code dir="ltr">TARGET</code>, and connect to the recovery catalog. Run the following commands to <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> the default device type to <code dir="ltr">sbt</code> for a standby database that has the <code dir="ltr">DB_UNIQUE_NAME</code> of <code dir="ltr">standby1</code> and the net service name <code dir="ltr">sby1</code>.</p>
<pre dir="ltr">
CONFIGURE CONNECT IDENTIFIER "sby1" FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEFAULT DEVICE TYPE TO sbt FOR DB_UNIQUE_NAME standby1;
CONFIGURE DEVICE TYPE sbt PARALLELISM 2 FOR DB_UNIQUE_NAME standby1;
</pre>
<p>Assume all backups needed to create the standby database are stored on tape. You set the following parameters in the initialization parameter file for database <code dir="ltr">standby1</code>:</p>
<ul>
<li>
<p>Set <code dir="ltr">DB_UNIQUE_NAME</code> to the value <code dir="ltr">standby1</code>.</p>
</li>
<li>
<p>Set <code dir="ltr">DB_CREATE_FILE_DEST</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST</code> to the desired ASM disk groups on the standby host. For example, set <code dir="ltr">DB_CREATE_FILE_DEST</code> to <code dir="ltr">+DATAFILE</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST</code> to <code dir="ltr">+FLASH_REC_AREA</code>.</p>
</li>
</ul>
<p>Ensure that the standby instance is in <code dir="ltr">NOMOUNT</code> mode. Start the RMAN client, <code dir="ltr"><a href="rcmsynta011.htm#i80734">CONNECT</a></code> to database <code dir="ltr">prod1</code> as <code dir="ltr">TARGET</code>, connect to the <code dir="ltr">standby1</code> instance as <code dir="ltr">AUXILIARY</code>, and connect to the recovery catalog. Enter the following command to create the standby database:</p>
<pre dir="ltr">
DUPLICATE TARGET DATABASE FOR STANDBY;
</pre>
<p>RMAN automatically generates new OMF/ASM data file names for the restored data files.</p>
</div>
<!-- class="example" -->
<div id="RCMRF90507" class="example">
<p class="titleinexample"><a id="sthref989"></a>Example 2-82 Duplicating a Database Without Connection to Target Database and Recovery Catalog</p>
<p>In this example, all the necessary backups of data files, controlfile and archived logs of database <code dir="ltr">prod</code> can be accessed from the location: <code dir="ltr">/net/prod/backups</code>. This location is where only backups of database <code dir="ltr">prod</code> reside. The only connection is to the new instance as <code dir="ltr">AUXILIARY</code>.</p>
<p>Enter the following command to create a test database when there is no connection to the recovery catalog or target database:</p>
<pre dir="ltr">
DUPLICATE DATABASE TO 'TEST' BACKUP LOCATION '/net/prod/backups' NOFILENAMECHECK;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90508" class="example">
<p class="titleinexample"><a id="sthref990"></a>Example 2-83 Selecting a Specific Database When Duplicating Without Connection to Target Database and Recovery Catalog</p>
<p>In this example, <code dir="ltr">/backups</code> contains backups from several databases, including more than two databases with the name <code dir="ltr">PROD</code>. In this case, you must specify the <code dir="ltr">DBNAME</code> and the <code dir="ltr">DBID</code> of the database that you want to duplicate. The only connection is to the auxiliary instance.</p>
<pre dir="ltr">
DUPLICATE DATABASE 'PROD' dbid 8675309 to 'TEST'
  UNTIL TIME "to_date('11/01/2007', 'MM/DD/YYYY')"
  BACKUP LOCATION '/backups' NOFILENAMECHECK
  PFILE='?/dbs/inittest.ora' db_file_name_convert='prod','test';
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta019.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta021.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
