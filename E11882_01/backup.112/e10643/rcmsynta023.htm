<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>FLASHBACK DATABASE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:42Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta022.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta024.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">36/158</span> <!-- End Header --><a id="i82108"></a>
<div id="RCMRF194" class="refsect1">
<h1 class="refsect1">FLASHBACK DATABASE<a id="ABC1064439"></a><a id="ABC1064439SRI1"></a><a id="ABC1064439SRI12"></a><a id="ABC1064439SRI123"></a><a id="ABC1064439SRI1234"></a><a id="ABC1064439SRI12345"></a><a id="ABC1064439SRI123456"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1014"></a>Purpose</p>
<p>Use the <a id="CHDDJDAD"></a><code dir="ltr">FLASHBACK DATABASE</code> command to rewind the database to a target time, SCN, or log sequence number.</p>
<p>This command works by undoing changes made by Oracle Database to the data files that exist when you run the command. Flashback can fix logical failures, but not physical failures. Thus, you cannot use the command to recover from disk failures or the accidental deletion of data files.</p>
<p><code dir="ltr">FLASHBACK DATABASE</code> is usually much faster than a <code dir="ltr">RESTORE</code> operation followed by point-in-time recovery, because the time needed to perform <code dir="ltr">FLASHBACK DATABASE</code> depends on the number of changes made to the database since the desired flashback time. On the other hand, the time needed to do a traditional point-in-time recovery from restored backups depends on the size of the database.</p>
<p>Flashback Database also has several uses in a Data Guard environment.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01801" href="../../server.112/e41084/statements_9011.htm#SQLRF01801"><span class="italic">Oracle Database SQL Language Reference</span></a> for a complete list of command prerequisites and usage notes for <code dir="ltr">FLASHBACK DATABASE</code></p>
</li>
</ul>
<ul>
<li>
<p><a class="olink SBYDB00717" href="../../server.112/e41134/role_management.htm#SBYDB00717"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> to learn about uses of Flashback Database in a Data Guard environment</p>
</li>
</ul>
</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1015"></a>Prerequisites</p>
<p>You can run this command from the RMAN prompt or from within a <code dir="ltr"><a href="rcmsynta2012.htm#i85731">RUN</a></code> command.</p>
<p>RMAN must be connected as <code dir="ltr">TARGET</code> to a database, which must be Oracle Database 10<span class="italic">g</span> or later. The target database must be mounted with a current control file, that is, the control file cannot be a backup or re-created. The database must run in <a id="sthref1016"></a><code dir="ltr">ARCHIVELOG</code> mode.</p>
<p>You cannot use <code dir="ltr">FLASHBACK DATABASE</code> to return to a point in time before the restore or re-creation of a control file. If the database control file is restored from backup or re-created, then all existing flashback log information is discarded.</p>
<p>The fast recovery area must be configured to enable flashback logging. Flashback logs are stored as Oracle-managed files in the fast recovery area and cannot be created if no fast recovery area is configured. You must have enabled the flashback logging before the target time for flashback using the SQL statement <code dir="ltr">ALTER DATABASE ... FLASHBACK ON</code>. Query <a id="sthref1017"></a><a id="sthref1018"></a><code dir="ltr">V$DATABASE.FLASHBACK_ON</code> to see whether flashback logging has been enabled.</p>
<p>The database must contain no online tablespaces for which flashback functionality was disabled with the SQL statement <code dir="ltr">ALTER TABLESPACE ... FLASHBACK OFF</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1019"></a>Usage Notes</p>
<p>A Flashback Database operation applies to the whole database. You cannot flash back individual tablespaces. A Flashback Database operation is similar to a database point-in-time recovery (DBPITR) performed with <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code>, but RMAN uses <a id="sthref1020"></a><span class="glossaryterm">flashback logs</span> to undo changes to a point before the target time or SCN. RMAN automatically restores from backup any archived redo log files that are needed and recovers the database to make it consistent. RMAN never flashes back data for temporary tablespaces.</p>
<p>The earliest SCN that can be used for a Flashback Database operation depends on the setting of the <a id="sthref1021"></a><a id="sthref1022"></a><code dir="ltr">DB_FLASHBACK_RETENTION_TARGET</code> initialization parameter, and on the actual retention of flashback logs permitted by available disk. View the current database SCN in <a id="sthref1023"></a><a id="sthref1024"></a><code dir="ltr">V$DATABASE.CURRENT_SCN</code>.</p>
<p class="subhead2"><a id="RCMRF90179"></a>Effect of NOLOGGING Operations on Flashback Database</p>
<p><a id="sthref1025"></a><a id="sthref1026"></a>When using <code dir="ltr">FLASHBACK DATABASE</code> with a target time at which a <code dir="ltr">NOLOGGING</code> operation was in progress, block corruption is likely in the database objects and data files affected by the <code dir="ltr">NOLOGGING</code> operation. For example, assume that you do a direct-path <code dir="ltr">INSERT</code> operation in <code dir="ltr">NOLOGGING</code> mode and that the operation runs from 9:00 to 9:15 on April 3. If you later use Flashback Database to return to 09:07 on this date, then the objects and data files updated by the direct-path <code dir="ltr">INSERT</code> may be left with block corruption after Flashback Database completes.</p>
<p>If possible, avoid using <code dir="ltr">FLASHBACK DATABASE</code> with a target time or SCN that coincides with a <code dir="ltr">NOLOGGING</code> operation. Also, perform a full or incremental backup of the affected data files immediately after any <code dir="ltr">NOLOGGING</code> operation to ensure recoverability to points in time after the operation. If you expect to use <code dir="ltr">FLASHBACK DATABASE</code> to return to a point in time during an operation such as a direct-path <code dir="ltr">INSERT</code>, then consider performing the operation in <code dir="ltr">LOGGING</code> mode.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The discussion of <code dir="ltr">logging_clause</code> in <a class="olink SQLRF021" href="../../server.112/e41084/clauses.htm#SQLRF021"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about operations that support <code dir="ltr">NOLOGGING</code> mode</div>
<p class="subhead2"><a id="RCMRF90180"></a>Effect of Data File Status Changes on Flashback Database</p>
<p>The <code dir="ltr">FLASHBACK DATABASE</code> command does not start modifying the database until it has made sure that it has all the files and resources that it needs. A Flashback Database operation should never fail due to missing data files, redo log files, or flashback logs.</p>
<p><a id="sthref1027"></a>If a data file has changed status between the current SCN and the target SCN of the flashback, then the <code dir="ltr">FLASHBACK DATABASE</code> command behaves differently depending on the nature of the status change. Refer to <a href="#g1040866">Table 2-8</a> for details.</p>
<div id="RCMRF90181" class="tblruleformal">
<p class="titleintable"><a id="sthref1028"></a><a id="g1040866"></a>Table 2-8 How FLASHBACK DATABASE Responds to Data File Status Changes</p>
<table class="cellalignment1929" title="How FLASHBACK DATABASE Responds to Data File Status Changes" summary="Describes effects of FLASHBACK DATABASE command" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t86">If this data file operation occurred during the flashback window ...</th>
<th class="cellalignment1930" id="r1c2-t86">Then the FLASHBACK DATABASE command ...</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t86" headers="r1c1-t86">
<p>Added</p>
</td>
<td class="cellalignment1926" headers="r2c1-t86 r1c2-t86">
<p>Removes the data file record from the control file.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t86" headers="r1c1-t86">
<p>Dropped</p>
</td>
<td class="cellalignment1926" headers="r3c1-t86 r1c2-t86">
<p>Adds the data file to the control file, but marks it as offline and does not flash it back. You can then restore and recover the data file to the same time or SCN.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t86" headers="r1c1-t86">
<p>Renamed</p>
</td>
<td class="cellalignment1926" headers="r4c1-t86 r1c2-t86">
<p>Ignores the renaming. The data file retains its current name.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t86" headers="r1c1-t86">
<p>Resized</p>
</td>
<td class="cellalignment1926" headers="r5c1-t86 r1c2-t86">
<p>May fail. You can take the data file offline and then rerun the <code dir="ltr">FLASHBACK DATABASE</code> command. The data file is not flashed back. You can then restore and recover the data file to the same time or SCN.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t86" headers="r1c1-t86">
<p>Taken offline</p>
</td>
<td class="cellalignment1926" headers="r6c1-t86 r1c2-t86">
<p>Ignores the operation. The data file retains its current online status.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t86" headers="r1c1-t86">
<p>Brought online</p>
</td>
<td class="cellalignment1926" headers="r7c1-t86 r1c2-t86">
<p>Ignores the operation. The data file retains its current offline status.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t86" headers="r1c1-t86">
<p>Made read-only or read/write</p>
</td>
<td class="cellalignment1926" headers="r8c1-t86 r1c2-t86">
<p>Changes the status of the data file in the control file.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<p class="subhead2"><a id="RCMRF90182"></a>Tablespaces with Flashback Logging Disabled</p>
<p>It is possible for the <code dir="ltr">ALTER TABLESPACE ... FLASHBACK OFF</code> statement to have been executed for some tablespaces. If <code dir="ltr">FLASHBACK DATABASE</code> has insufficient flashback data to rewind a tablespace to the target SCN, then RMAN issues an error and does not modify the database. Whenever <code dir="ltr">FLASHBACK DATABASE</code> fails or is interrupted, the database is left mounted.</p>
<p>In this scenario, query <a id="sthref1029"></a><a id="sthref1030"></a><code dir="ltr">V$TABLESPACE</code> to determine which tablespaces have flashback logging disabled. You have the following options:</p>
<ul>
<li>
<p>Take the data files in the affected tablespaces offline. Afterwards, run <code dir="ltr"><a href="rcmsynta2008.htm#i85188">RESTORE</a></code> and then <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> to bring these data files to the same point in time as the rest of the database.</p>
</li>
<li>
<p>Drop the affected data files with the <code dir="ltr">ALTER DATABASE DATAFILE ... OFFLINE FOR DROP</code> statement. You can then open the database with the <code dir="ltr">RESETLOGS</code> option. After the database is open, execute <code dir="ltr">DROP TABLESPACE</code> statements for the tablespaces that contain the dropped data files.</p>
</li>
</ul>
<p class="subhead2"><a id="RCMRF90183"></a>State of the Database After Flashback Database</p>
<p>After running <code dir="ltr">FLASHBACK DATABASE</code>, the database may not be left at the SCN most immediately before the target time. Events other than transactions can cause the database SCN to be updated. If you use the <code dir="ltr">FLASHBACK DATABASE TO</code> form of the command, and if a transaction is associated with the target SCN, then after the flashback the database includes all changes up to and including this transaction. Otherwise, all changes up to but <span class="italic">not</span> including this transaction are included in the data files, whether you use the <code dir="ltr">FLASHBACK DATABASE TO</code> or <code dir="ltr">FLASHBACK DATABASE TO BEFORE</code> form of the command. Changes after the specified target SCN are never applied because of a <code dir="ltr">FLASHBACK DATBASE</code>.</p>
<p>After <code dir="ltr">FLASHBACK DATABASE</code> completes, you may want to open the database read-only and run queries to ensure that you achieved the intended result. If you are not satisfied, then you can use <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> <code dir="ltr">DATABASE</code> to recover the database to its state when you started the flashback. You can then rerun <code dir="ltr">FLASHBACK DATABASE</code>.</p>
<p>If you are satisfied with the results of the flashback, then you can <code dir="ltr">OPEN RESETLOGS</code> to abandon all changes after the target time. Alternatively, you can use <a id="sthref1031"></a>Data Pump to export lost data, use <code dir="ltr">RECOVER DATABASE</code> to return the database to its state before the flashback operation, and then use Data Pump to reimport the lost data.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1032"></a>Syntax</p>
<p class="subhead2"><a id="RCMRF90184"></a><span class="italic">flashback</span>::=</p>
<img width="402" height="319" src="img/flashback.gif" alt="Description of flashback.gif follows" /><br />
<a id="sthref1033" href="img_text/flashback.htm">Description of the illustration flashback.gif</a><br />
<br />
<p>(<a href="rcmsubcl006.htm#BABDEJAC"><span class="xreftitleitalic"><span class="italic">deviceSpecifier</span>::=</span></a>)</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1034"></a>Semantics</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for FLASHBACK DATABASE Command" summary="Describes FLASHBACK DATABASE command parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t87">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t87">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1035"></a>DEVICE&nbsp;TYPE</code> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></td>
<td class="cellalignment1926" headers="r2c1-t87 r1c2-t87">Allocates automatic channels for the specified device type only. For example, if you configure automatic disk and tape channels, and issue <code dir="ltr">FLASHBACK ... DEVICE TYPE DISK</code>, then RMAN allocates only disk channels. RMAN may need to restore redo logs from backup during the flashback database process. Changes between the last flashback log and the target time must be re-created based on the archived redo log. If no automatic channels are allocated for tape and a needed redo log is on tape, then the <code dir="ltr">FLASHBACK DATABASE</code> operation fails.
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1036"></a><a id="sthref1037"></a><a id="sthref1038"></a>TO&nbsp;BEFORE&nbsp;SCN</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r3c1-t87 r1c2-t87">Returns the database to its state just before the specified SCN. Any changes at an SCN lower than that specified are applied, but if there is a change associated with the specified SCN it is not applied. By default, the provided SCN resolves to the current or ancestor incarnation. You can override the default by using the <code dir="ltr"><a href="rcmsynta2007.htm#i85086">RESET DATABASE</a></code> <code dir="ltr">INCARNATION</code> command.
<p>Query <code dir="ltr">OLDEST_FLASHBACK_SCN</code> in<a id="ABC30006237"></a><a id="ABC30006237SRI1"></a> <code dir="ltr">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest SCN to which you can flash back.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1039"></a><a id="sthref1040"></a><a id="sthref1041"></a><a id="sthref1042"></a>TO&nbsp;BEFORE&nbsp;SEQUENCE</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code> <code dir="ltr">[THREAD&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">integer</span></code>]</td>
<td class="cellalignment1926" headers="r4c1-t87 r1c2-t87">Specifies a redo log sequence number and thread as an upper limit. RMAN applies changes up to (but not including) the last change in the log with the specified sequence and thread number.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1043"></a><a id="sthref1044"></a><a id="sthref1045"></a><a id="sthref1046"></a><a id="sthref1047"></a>TO&nbsp;BEFORE&nbsp;RESETLOGS</code></td>
<td class="cellalignment1926" headers="r5c1-t87 r1c2-t87">Returns the database to its state including all changes up to the SCN of the most recent <code dir="ltr">OPEN RESETLOGS</code>.
<p><span class="bold">Note:</span> <code dir="ltr">FLASHBACK DATABASE</code> can only return the database to a point before the most recent <code dir="ltr">OPEN RESETLOGS</code> operation if your database has been upgraded to Oracle Database 10<span class="italic">g</span> Release 2 or later.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t87" headers="r1c1-t87"><br />
<code dir="ltr"><a id="sthref1048"></a><a id="sthref1049"></a><a id="sthref1050"></a>TO&nbsp;BEFORE&nbsp;TIME</code><br />
<code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">date_string</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r6c1-t87 r1c2-t87">Returns the database to its state including all changes up to but not including changes at the specified time.
<p>Query <code dir="ltr">OLDEST_FLASHBACK_TIME</code> in <code dir="ltr">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest time to which you can flash back.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t87" headers="r1c1-t87"><code dir="ltr">TO&nbsp;SCN</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r7c1-t87 r1c2-t87">Returns the database to the point up to (and including) the specified SCN. By default, the provided SCN resolves to the current or ancestor incarnation. You can override the default by using the RMAN <code dir="ltr"><a href="rcmsynta2007.htm#i85086">RESET DATABASE</a></code> command to set the recovery target incarnation.
<p>Query <code dir="ltr">OLDEST_FLASHBACK_SCN</code> in <code dir="ltr">V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest SCN to which you can flash back.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1051"></a><a id="sthref1052"></a><a id="sthref1053"></a>TO SEQUENCE</code>&nbsp;<code dir="ltr"><span class="codeinlineitalic">integer</span></code> <code dir="ltr">THREAD</code>&nbsp;<code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r8c1-t87 r1c2-t87">Specifies a redo log sequence number and thread as an upper limit. RMAN applies changes up to (and including) the last change in the log with the specified sequence and thread number.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t87" headers="r1c1-t87"><br />
<code dir="ltr"><a id="sthref1054"></a><a id="sthref1055"></a>TO&nbsp;RESTORE&nbsp;POINT</code><br />
<code dir="ltr"><span class="codeinlineitalic">restore_point_name</span></code></td>
<td class="cellalignment1926" headers="r9c1-t87 r1c2-t87">Returns the database to the SCN associated with the specified restore point. This can be an ordinary restore point or a guaranteed restore point.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r10c1-t87" headers="r1c1-t87"><code dir="ltr"><a id="sthref1056"></a><a id="sthref1057"></a>TO&nbsp;TIME</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">date_string</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r10c1-t87 r1c2-t87">Returns the database to its state at the specified time. You can use any SQL <code dir="ltr">DATE</code> expressions to convert the time to the current format, for example, <code dir="ltr">FLASHBACK DATABASE TO TIME 'SYSDATE-7'</code>.
<p>Query <code dir="ltr">OLDEST_FLASHBACK_TIME</code> in <code dir="ltr"><a id="sthref1058"></a><a id="sthref1059"></a>V$FLASHBACK_DATABASE_LOG</code> to see the approximate lowest time to which you can flash back.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1060"></a><a id="sthref1061"></a>Examples</p>
<div id="RCMRF90185" class="example">
<p class="titleinexample"><a id="sthref1062"></a>Example 2-87 FLASHBACK DATABASE to a Specific SCN</p>
<p>Assume that you inserted corrupted rows in many tables at 5:00 p.m. on February 14. You connect SQL*Plus to the database and query the earliest SCN in the flashback window:</p>
<pre dir="ltr">
SQL&gt; SELECT OLDEST_FLASHBACK_SCN, OLDEST_FLASHBACK_TIME
  2  FROM   V$FLASHBACK_DATABASE_LOG;

OLDEST_FLASHBACK_SCN OLDEST_FLASHBACK
-------------------- ----------------
              411010 2007/02/14 16:49
</pre>
<p>You then open a new terminal, start the RMAN client, and connect to the target database and recovery catalog. You enter RMAN commands as follows (sample output for the <code dir="ltr">FLASHBACK DATABASE</code> is included):</p>
<pre dir="ltr">
RMAN&gt; SHUTDOWN IMMEDIATE
RMAN&gt; STARTUP MOUNT
RMAN&gt; FLASHBACK DATABASE TO SCN 411010;
 
Starting flashback at 15-FEB-07
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=104 device type=DISK
 
 
starting media recovery
media recovery complete, elapsed time: 00:00:07
 
Finished flashback at 15-FEB-07
 
RMAN&gt; ALTER DATABASE OPEN RESETLOGS;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90186" class="example">
<p class="titleinexample"><a id="sthref1063"></a>Example 2-88 FLASHBACK DATABASE to a Restore Point</p>
<p>Assume that you are preparing to load a massive number of updates to the database. You create a guaranteed restore point before the performing the updates:</p>
<pre dir="ltr">
SQL&gt; CREATE RESTORE POINT before_update GUARANTEE FLASHBACK DATABASE;
</pre>
<p>The bulk update fails, leaving the database with extensive corrupted data. You start an RMAN session, connect to the target database and recovery catalog, and list the guaranteed restore points:</p>
<pre dir="ltr">
RMAN&gt; LIST RESTORE POINT ALL;

SCN              RSP Time  Type       Time      Name
---------------- --------- ---------- --------- ----
412742                     GUARANTEED 15-FEB-07 BEFORE_UPDATE
</pre>
<p>You mount the database, flash back the database to the restore point (sample output included), and then open the database with the <code dir="ltr">RESETLOGS</code> option:</p>
<pre dir="ltr">
RMAN&gt; SHUTDOWN IMMEDIATE
RMAN&gt; STARTUP MOUNT
RMAN&gt; FLASHBACK DATABASE TO RESTORE POINT 'BEFORE_UPDATE';
 
Starting flashback at 15-FEB-07
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=104 device type=DISK
 
 
starting media recovery
 
archived log for thread 1 with sequence 34 is already on disk as file /disk2/oracle/oradata/prod/arch/archive1_34_614598462.dbf
media recovery complete, elapsed time: 00:00:01
Finished flashback at 15-FEB-07
 
RMAN&gt; ALTER DATABASE OPEN RESETLOGS;
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta022.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta024.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
