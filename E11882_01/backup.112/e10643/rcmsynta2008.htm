<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>RESTORE</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta2007.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta2009.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">51/158</span> <!-- End Header --><a id="i85188"></a>
<div id="RCMRF149" class="refsect1">
<h1 class="refsect1">RESTORE<a id="ABC1077583"></a><a id="ABC1077583SRI1"></a><a id="ABC1077583SRI12"></a><a id="ABC1077583SRI123"></a><a id="ABC1077583SRI1234"></a><a id="ABC1077583SRI12345"></a><a id="ABC1077583SRI123456"></a><a id="ABC1077583SRI1234567"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1573"></a>Purpose</p>
<p>Use the <a id="CHDBEIEJ"></a><code dir="ltr">RESTORE</code> command to restore, validate, or preview RMAN backups. Typically, you restore backups when a media failure has damaged a current data file, control file, or archived redo log or before performing a point-in-time recovery.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1574"></a>Prerequisites</p>
<p>To restore data files to their current location, the database must be started, mounted, or open with the tablespaces or data files to be restored offline.</p>
<p>If you use RMAN in a Data Guard environment, then RMAN must be connected to a recovery catalog.</p>
<p>If you are performing a trial restore of the production database, then perform either of the following actions before restoring the database in the test environment:</p>
<ul>
<li>
<p>If the test database uses a fast recovery area that is physically <span class="italic">different</span> from the recovery area used by the production database, then set <code dir="ltr">DB_RECOVERY_FILE_DEST</code> in the test database instance to the new location.</p>
</li>
<li>
<p>If the test database uses a fast recovery area that is physically the <span class="italic">same</span> as the recovery area used by the production database, then set <code dir="ltr"><a id="sthref1575"></a>DB_UNIQUE_NAME</code> in the test database instance to a different name from the production database.</p>
</li>
</ul>
<p>If you do not perform either of the preceding actions, then RMAN assumes that you are restoring the production database and deletes <a id="sthref1576"></a>flashback logs from the fast recovery area because they are considered unusable.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1577"></a>Usage Notes</p>
<p>The <code dir="ltr">RESTORE</code> command restores full backups, level 0 incremental backups, or image copies. You can restore files to their default location or a different location.</p>
<p>By default, RMAN examines read-only data files to ensure they exist, are readable, and have the correct checkpoint. If any of the conditions is not met, then RMAN restores the files. If all of the conditions are met, then RMAN does not restore the files.</p>
<p class="subhead2"><a id="RCMRF90294"></a>Backup Selection</p>
<p>By default, <code dir="ltr">RESTORE</code> chooses the most recent backup set or file copy, that is, the file copy or backup set that needs the least media recovery. RMAN only restores backups created on the same type of channels allocated by the <code dir="ltr">RESTORE</code> command. For example, if you made backups of a data file with <code dir="ltr">DISK</code> and <code dir="ltr">sbt</code> channels, and if only a <code dir="ltr">DISK</code> channel is allocated for the <code dir="ltr">RESTORE</code> command, then RMAN does not restore the <code dir="ltr">sbt</code> backups. If you do not manually allocate channels, then RMAN allocates all automatic channels that it possibly needs, subject to any restrictions imposed by the <code dir="ltr">DEVICE TYPE</code> option.</p>
<p>In an Oracle RAC configuration, RMAN automatically restores backups, control file copies, and data file copies from channels that can read the files on tape or a local file system. For example, if channel <code dir="ltr">ch1</code> connected to <code dir="ltr">inst1</code> can read log 1000 from its tape drive, but channel <code dir="ltr">ch2</code> connected to <code dir="ltr">inst2</code> cannot read the same log from its tape drive, then <code dir="ltr">ch1</code> cannot participate in restoring the log and so <code dir="ltr">ch2</code> restores the log. Autolocation is automatically enabled when the channels have different <code dir="ltr">PARMS</code> or <code dir="ltr">CONNECT</code> settings.</p>
<p>If data file names are symbolic links, then the control file stores the file names of the link files but RMAN performs I/O on the data files pointed to by the link files. If a link file is lost and you restore a data file without re-creating the symbolic link, then RMAN restores the data file to the location of the link file rather than to the location pointed to by the link file.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV30001" href="../../backup.112/e10642/rcmrvcon.htm#BRADV30001"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for details on restore failover</div>
<p class="subhead2"><a id="RCMRF90295"></a>Restore Operations Using Encrypted Backup Sets</p>
<p><a id="sthref1578"></a>As explained in <a href="rcmsynta007.htm#CHDIHIGD">"Encryption of Backup Sets"</a>, how RMAN handles encrypted backup sets during restore operations depends on the encryption mode with which the backup was created. You can use <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> and <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> to manage the RMAN backup encryption settings for your database. Note the following restore considerations:</p>
<ul>
<li>
<p><a id="sthref1579"></a>For transparent-mode encrypted backups, the required passwords must be available in the database wallet. The same wallet used when creating the backup must be open and available when restoring it. <code dir="ltr">SET DECRYPTION</code> is not required.</p>
</li>
<li>
<p><a id="sthref1580"></a>For password-mode encrypted backups, the required passwords must be provided with <code dir="ltr">SET DECRYPTION</code>.</p>
</li>
<li>
<p>For dual-mode encrypted backups, the required passwords must be available in the database wallet or provided with <code dir="ltr">SET DECRYPTION</code>.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Wallet-based encryption is more secure than password-based encryption because no passwords are involved. You should use password-based encryption only when absolutely necessary because your backups must be transportable.</div>
<p class="subhead2"><a id="RCMRF90296"></a>Restore Failover</p>
<p>If a backup piece, image copy or proxy copy is inaccessible or if a block is corrupted, then RMAN performs <a id="sthref1581"></a><a id="sthref1582"></a><a id="sthref1583"></a><a id="sthref1584"></a><a id="sthref1585"></a>restore failover. The <code dir="ltr">RESTORE</code> command automatically looks for another usable copy of a backup or image copy on the same device and other devices. If no usable copies are available, then RMAN searches for previous backups. RMAN continuously searches for previous usable backups until it has exhausted all possibilities. RMAN automatically uses eligible backups from previous database incarnations if required.</p>
<p>If you are restoring a data file for which no backups are available, then RMAN creates an empty data file with the checkpoint change as creation SCN. During recovery, all archived redo log files back to the creation of the data file are restored, and all changes during the history of the data file are reapplied to re-create its contents.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="rcmsynta007.htm#CHDIHIGD">"Encryption of Backup Sets"</a> and the extended discussion in <a class="olink BRADV72450" href="../../backup.112/e10642/rcmbckad.htm#BRADV72450"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a></div>
<p class="subhead2"><a id="RCMRF90297"></a>Location of Restored Data Files</p>
<p><a id="sthref1586"></a>If you restore data files to the default location, then RMAN overwrites files with the same file names. By default, RMAN does not restore a data file if the data file is in the correct place and its header contains the expected data. RMAN does not scan the data file body for corrupt blocks.</p>
<p>If RMAN detects that the default file name cannot be used (for example, the file may be an Oracle-managed file or on an <a id="sthref1587"></a>Automatic Storage Management disk group), then RMAN attempts to create a new file in the same location or disk group.</p>
<p>RMAN restores data files to the location currently stored in the recovery catalog. This default behavior eliminates problems with restoring data files to locations that may have become obsolete since the time of the original backup. It also means that if you have changed the location of the data files from their original backup location, that RMAN restores the files to the most current or changed location.</p>
<p>To restore files to a nondefault location, use <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">NEWNAME</code> commands to rename the restored files and then use a <code dir="ltr"><a href="rcmsynta2020.htm#i86534">SWITCH</a></code> command to make the restored files current (as illustrated in <a href="#CHDFEAAH">Example 3-19</a>). If you do not issue <code dir="ltr">SWITCH</code> commands, then RMAN considers the restored files as valid copies for use in future restore operations. <a href="#CHDCJADE">Table 3-8</a> describes the behavior of the <code dir="ltr">RESTORE</code>, <code dir="ltr">SET NEWNAME</code>, and <code dir="ltr">SWITCH</code> commands.</p>
<div id="RCMRF90298" class="tblruleformal">
<p class="titleintable"><a id="sthref1588"></a><a id="CHDCJADE"></a>Table 3-8 <a id="sthref1589"></a><a id="sthref1590"></a><a id="sthref1591"></a><a id="sthref1592"></a>SET NEWNAME, SWITCH, and RESTORE</p>
<table class="cellalignment1929" title="SET NEWNAME, SWITCH, and RESTORE" summary="Explains the interaction between SET NEWNAME, SWITCH, and RESTORE" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t36">SET NEWNAME Run</th>
<th class="cellalignment1930" id="r1c2-t36">SWITCH Run</th>
<th class="cellalignment1930" id="r1c3-t36">RESTORE Behavior</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t36" headers="r1c1-t36">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r2c1-t36 r1c2-t36">
<p>N/A</p>
</td>
<td class="cellalignment1926" headers="r2c1-t36 r1c3-t36">
<p>RMAN restores the files to the most recent location stored in the recovery catalog.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t36" headers="r1c1-t36">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r3c1-t36 r1c2-t36">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r3c1-t36 r1c3-t36">
<p>RMAN restores the files to the path names specified by <code dir="ltr">SET</code> <code dir="ltr">NEWNAME</code>. RMAN replaces the current data file names in the control file with the names of the restored files. RMAN records the data files with the old names as data file copies.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t36" headers="r1c1-t36">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r4c1-t36 r1c2-t36">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r4c1-t36 r1c3-t36">
<p>RMAN restores the files to the path names specified by <code dir="ltr">SET</code> <code dir="ltr">NEWNAME</code>. RMAN does not update the current data file names in the control file. The restored files are listed in the RMAN repository as data file copies.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<p>Because temp files cannot be backed up and because no redo is ever generated for them, RMAN never restores or recovers temp files. RMAN does track the names of temp files, but only so that it can automatically re-create them when needed.</p>
<p class="subhead2"><a id="RCMRF90299"></a>RMAN Behavior When Restoring Control Files</p>
<p>The behavior of RMAN when restoring control files depend on a variety of factors, which are summarized in <a href="#CHDFEFBD">Table 3-9</a>. Required commands and options for restoring autobackups are summarized in <a href="#CHDBGBBD">Table 3-10</a>.</p>
<div id="RCMRF90300" class="tblruleformalwidemax">
<p class="titleintable"><a id="sthref1593"></a><a id="CHDFEFBD"></a>Table 3-9 RESTORE CONTROLFILE Scenarios</p>
<table class="cellalignment1929" title="RESTORE CONTROLFILE Scenarios" summary="Describes restoration of control files under various scenarios" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t37">RMAN Connection</th>
<th class="cellalignment1930" id="r1c2-t37">RESTORE CONTROLFILE;</th>
<th class="cellalignment1930" id="r1c3-t37">RESTORE CONTROLFILE FROM AUTOBACKUP;</th>
<th class="cellalignment1930" id="r1c4-t37">RESTORE CONTROLFILE ... TO '<span class="italic">filename</span>';</th>
<th class="cellalignment1930" id="r1c5-t37">RESTORE CONTROLFILE ... FROM '<span class="italic">media_handle</span>' or TAG '<span class="italic">user_tag</span>';</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t37" headers="r1c1-t37">
<p>No catalog, target database started in <code dir="ltr">NOMOUNT</code> state</p>
</td>
<td class="cellalignment1926" headers="r2c1-t37 r1c2-t37">
<p>Error. Must specify <code dir="ltr">FROM AUTOBACKUP</code>.</p>
</td>
<td class="cellalignment1926" headers="r2c1-t37 r1c3-t37">
<p>Restores to <code dir="ltr">CONTROL_FILES</code> locations. See <a href="#CHDBGBBD">Table 3-10</a> for required commands and options.</p>
</td>
<td class="cellalignment1926" headers="r2c1-t37 r1c4-t37">
<p>Must specify <code dir="ltr">FROM AUTOBACKUP</code>. Restores only to <code dir="ltr"><span class="codeinlineitalic">filename</span></code>.</p>
</td>
<td class="cellalignment1926" headers="r2c1-t37 r1c5-t37">
<p>First run <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">DBID</code>. Restores from specified file (cannot restore from <code dir="ltr">TAG</code>). If <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>' not used, restores to all <code dir="ltr">CONTROL_FILES</code> locations.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t37" headers="r1c1-t37">
<p>No catalog, target database mounted or open</p>
</td>
<td class="cellalignment1926" headers="r3c1-t37 r1c2-t37">
<p>Error. Must use <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>', where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r3c1-t37 r1c3-t37">
<p>Error. Must use <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>', where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r3c1-t37 r1c4-t37">
<p>Restores only to <code dir="ltr"><span class="codeinlineitalic">filename</span></code>, where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r3c1-t37 r1c5-t37">
<p>RMAN issues error <a id="sthref1594"></a><a id="sthref1595"></a><code dir="ltr">RMAN-06496</code>. Use <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>' instead.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t37" headers="r1c1-t37">
<p>Catalog, target database started in <code dir="ltr">NOMOUNT</code> state</p>
</td>
<td class="cellalignment1926" headers="r4c1-t37 r1c2-t37">
<p>Restores to <code dir="ltr">CONTROL_FILES</code> locations. Run <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">DBID</code> only if <code dir="ltr">DB_NAME</code> not unique in catalog.</p>
</td>
<td class="cellalignment1926" headers="r4c1-t37 r1c3-t37">
<p>Only use with recovery catalog for testing.</p>
</td>
<td class="cellalignment1926" headers="r4c1-t37 r1c4-t37">
<p>Restores only to <code dir="ltr"><span class="codeinlineitalic">filename</span></code>, where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r4c1-t37 r1c5-t37">
<p>Restores from specified file. If <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>' not used, restores to all <code dir="ltr">CONTROL_FILES</code> locations.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t37" headers="r1c1-t37">
<p>Catalog, target database mounted or open</p>
</td>
<td class="cellalignment1926" headers="r5c1-t37 r1c2-t37">
<p>Error. Must use <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>', where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r5c1-t37 r1c3-t37">
<p>Do not use with recovery catalog.</p>
</td>
<td class="cellalignment1926" headers="r5c1-t37 r1c4-t37">
<p>Restores only to <code dir="ltr"><span class="codeinlineitalic">filename</span></code>, where <code dir="ltr"><span class="codeinlineitalic">filename</span></code> is not in <code dir="ltr">CONTROL_FILES</code> list.</p>
</td>
<td class="cellalignment1926" headers="r5c1-t37 r1c5-t37">
<p>RMAN issues error <a id="sthref1596"></a><a id="sthref1597"></a><code dir="ltr">RMAN-06496</code>. Use <code dir="ltr">TO</code> '<code dir="ltr"><span class="codeinlineitalic">filename</span></code>' instead.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformalwidemax" -->
<p>If you use RMAN in a <a id="sthref1598"></a>Data Guard environment, then RMAN transparently converts primary control files to standby control files and vice versa. RMAN automatically updates file names for data files, online redo logs, standby redo logs, and temp files when you issue <code dir="ltr">RESTORE</code> and <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code>. The recovery catalog always contains the correct information about the backup file names for each database, as explained in <a href="rcmsynta007.htm#CHDJIIGD">"RMAN Backups in a Data Guard Environment"</a>.</p>
<p class="subhead2"><a id="RCMRF90301"></a>Control File and Server Parameter File Autobackup Options</p>
<p><a id="sthref1599"></a><a id="sthref1600"></a><a id="sthref1601"></a>When restoring an autobackup, the commands and options that you use depend on the autobackup type (control file or server parameter file) and location (inside or outside fast recovery area). The options are summarized in <a href="#CHDBGBBD">Table 3-10</a>.</p>
<div id="RCMRF90302" class="tblruleformalwidemax">
<p class="titleintable"><a id="sthref1602"></a><a id="CHDBGBBD"></a>Table 3-10 RESTORE ... FROM AUTOBACKUP</p>
<table class="cellalignment1929" title="RESTORE ... FROM AUTOBACKUP" summary="Describes restoration from autobackups using various options" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t38">Restore Object</th>
<th class="cellalignment1930" id="r1c2-t38">Autobackup Location</th>
<th class="cellalignment1930" id="r1c3-t38">Run SET DBID?</th>
<th class="cellalignment1930" id="r1c4-t38">Specify RECOVERY AREA on RESTORE?</th>
<th class="cellalignment1930" id="r1c5-t38">Specify DB_NAME or DB_UNIQUE_NAME on RESTORE?</th>
<th class="cellalignment1930" id="r1c6-t38">Run SET CONTROLFILE AUTOBACKUP FORMAT?</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t38" headers="r1c1-t38">
<p>SPFILE</p>
</td>
<td class="cellalignment1926" headers="r2c1-t38 r1c2-t38">
<p>Recovery area</p>
</td>
<td class="cellalignment1926" headers="r2c1-t38 r1c3-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r2c1-t38 r1c4-t38">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r2c1-t38 r1c5-t38">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r2c1-t38 r1c6-t38">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t38" headers="r1c1-t38">
<p>SPFILE</p>
</td>
<td class="cellalignment1926" headers="r3c1-t38 r1c2-t38">
<p>Outside recovery area</p>
</td>
<td class="cellalignment1926" headers="r3c1-t38 r1c3-t38">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r3c1-t38 r1c4-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r3c1-t38 r1c5-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r3c1-t38 r1c6-t38">
<p>Only if autobackup is not in default location</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t38" headers="r1c1-t38">
<p>Control file</p>
</td>
<td class="cellalignment1926" headers="r4c1-t38 r1c2-t38">
<p>Recovery area</p>
</td>
<td class="cellalignment1926" headers="r4c1-t38 r1c3-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r4c1-t38 r1c4-t38">
<p>Only if autobackup is in noncurrent recovery area</p>
</td>
<td class="cellalignment1926" headers="r4c1-t38 r1c5-t38">
<p>Only if autobackup is in noncurrent recovery area and uses a noncurrent <code dir="ltr">DB_UNIQUE_NAME</code></p>
</td>
<td class="cellalignment1926" headers="r4c1-t38 r1c6-t38">
<p>No</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t38" headers="r1c1-t38">
<p>Control file</p>
</td>
<td class="cellalignment1926" headers="r5c1-t38 r1c2-t38">
<p>Outside recovery area</p>
</td>
<td class="cellalignment1926" headers="r5c1-t38 r1c3-t38">
<p>Yes</p>
</td>
<td class="cellalignment1926" headers="r5c1-t38 r1c4-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r5c1-t38 r1c5-t38">
<p>No</p>
</td>
<td class="cellalignment1926" headers="r5c1-t38 r1c6-t38">
<p>Only if autobackup is not in default location</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformalwidemax" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1603"></a>Syntax</p>
<p class="subhead2"><a id="RCMRF90303"></a><a id="sthref1604"></a><a id="sthref1605"></a><a href="#i1017375"><span class="xreftitleitalic"><span class="italic">restore</span></span></a>::=</p>
<img width="439" height="510" src="img/restore.gif" alt="Description of restore.gif follows" /><br />
<a id="sthref1606" href="img_text/restore.htm">Description of the illustration restore.gif</a><br />
<br />
<p>(<a href="#CHDIJJJD"><span class="xreftitleitalic"><span class="italic">restoreObject</span>::=</span></a>, <a href="#CHDCEJCJ"><span class="xreftitleitalic"><span class="italic">restoreSpecOperand</span>::=</span></a>, <a href="rcmsubcl006.htm#BABDEJAC"><span class="xreftitleitalic"><span class="italic">deviceSpecifier</span>::=</span></a>, <a href="rcmsubcl019.htm#BABEDABD"><span class="xreftitleitalic"><span class="italic">untilClause</span>::=</span></a>)</p>
<p class="subhead2"><a id="CHDIJJJD"></a><a id="RCMRF90304"></a><a id="sthref1607"></a><a id="sthref1608"></a><a href="#BGBJJGCB"><span class="xreftitleitalic"><span class="italic">restoreObject</span></span></a>::=</p>
<img width="676" height="393" src="img/restoreobject.gif" alt="Description of restoreobject.gif follows" /><br />
<a id="sthref1609" href="img_text/restoreobject.htm">Description of the illustration restoreobject.gif</a><br />
<br />
<p>(<a href="rcmsubcl002.htm#BABJGBFG"><span class="xreftitleitalic"><span class="italic">archivelogRecordSpecifier</span>::=</span></a>, <a href="rcmsubcl005.htm#BABCCBBJ"><span class="xreftitleitalic"><span class="italic">datafileSpec</span>::=</span></a>)</p>
<p class="subhead2"><a id="CHDCEJCJ"></a><a id="RCMRF90305"></a><a id="sthref1610"></a><a id="sthref1611"></a><a href="#i1036865"><span class="xreftitleitalic"><span class="italic">restoreSpecOperand</span></span></a>::=</p>
<img width="327" height="143" src="img/restorespecoperand.gif" alt="Description of restorespecoperand.gif follows" /><br />
<a id="sthref1612" href="img_text/restorespecoperand.htm">Description of the illustration restorespecoperand.gif</a><br />
<br />
<p class="subhead2"><a id="RCMRF90306"></a><a id="sthref1613"></a><a id="sthref1614"></a><a href="#BGBHBIAC"><span class="xreftitleitalic"><span class="italic">autoBackupOptList</span></span></a>::=</p>
<img width="647" height="182" src="img/autobackupoptlist.gif" alt="Description of autobackupoptlist.gif follows" /><br />
<a id="sthref1615" href="img_text/autobackupoptlist.htm">Description of the illustration autobackupoptlist.gif</a><br />
<br /></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1616"></a>Semantics</p>
<p class="subhead2"><a id="i1017375"></a><a id="RCMRF90307"></a><span class="italic"><a id="sthref1617"></a><a id="sthref1618"></a>restore</span></p>
<p>This clause enables you to select which files you want to restore and specify parameters that control the behavior of the restore operation.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for RESTORE Command" summary="Describes RESTORE command parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t39">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t39">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic"><a href="#BGBJJGCB"><span class="italic">restoreObject</span></a></span></code></td>
<td class="cellalignment1926" headers="r2c1-t39 r1c2-t39">Specifies the files to be restored.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic"><a href="#i1036865"><span class="italic">restoreSpecOperand</span></a></span></code></td>
<td class="cellalignment1926" headers="r3c1-t39 r1c2-t39">Specifies options for the <code dir="ltr"><span class="codeinlineitalic"><a href="#BGBJJGCB"><span class="italic">restoreObject</span></a></span></code> clause.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1619"></a>CHANNEL</code> <code dir="ltr"><span class="codeinlineitalic">channel_id</span></code></td>
<td class="cellalignment1926" headers="r4c1-t39 r1c2-t39">Refer to the <code dir="ltr"><span class="codeinlineitalic"><a href="#i1036865"><span class="italic">restoreSpecOperand</span></a></span></code> clause.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1620"></a>CHECK LOGICAL</code></td>
<td class="cellalignment1926" headers="r5c1-t39 r1c2-t39">Tests data and index blocks that pass physical corruption checks for logical corruption, for example, corruption of a row piece or index entry. If RMAN finds logical corruption, then it logs the block in the alert log and server session trace file.
<p>If the total number of physical and logical corruptions detected in a file is less than its <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">MAXCORRUPT</code> setting, then the RMAN command completes and the database populates the <code dir="ltr"><a id="sthref1621"></a>V$DATABASE_BLOCK_CORRUPTION</code> view with corrupt block ranges. If <code dir="ltr">MAXCORRUPT</code> is exceeded, then the command terminates without populating the views.</p>
<p>When restoring a backup data file, RMAN honors the <code dir="ltr">DB_BLOCK_CHECKSUM</code> initialization parameter setting. RMAN clears the checksum if <code dir="ltr">DB_BLOCK_CHECKSUM</code> is set to <code dir="ltr">false</code>. If set to <code dir="ltr">typical</code>, then RMAN verifies the checksum when restoring from the backup and writing to the data file. If the initialization parameter <code dir="ltr">DB_BLOCK_CHECKSUM=typical</code>, and if <code dir="ltr">MAXCORRUPT</code> is not set, then specifying <code dir="ltr">CHECK LOGICAL</code> detects all types of corruption that are possible to detect.</p>
<p><span class="bold">Note:</span> The <code dir="ltr">MAXCORRUPT</code> setting represents the total number of physical and logical corruptions permitted on a file.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1622"></a><a id="sthref1623"></a>DEVICE&nbsp;TYPE</code> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#i81605">deviceSpecifier</a></span></code></td>
<td class="cellalignment1926" headers="r6c1-t39 r1c2-t39">Allocates automatic channels for the specified device type only. For example, if you configure automatic disk and tape channels, and issue <code dir="ltr">RESTORE ... DEVICE TYPE DISK</code>, then RMAN allocates only disk channels. You must have configured a device type by using <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> (except for <code dir="ltr">DISK</code>, which is preconfigured) before specifying the <code dir="ltr">DEVICE TYPE</code> option.
<p><span class="bold">Note:</span> You cannot manually allocate channels within a <code dir="ltr"><a href="rcmsynta2012.htm#i85731">RUN</a></code> block and then run <code dir="ltr">RESTORE</code> with the <code dir="ltr">DEVICE TYPE</code> clause.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl006.htm#BABHDFAD">deviceSpecifier</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1624"></a><a id="sthref1625"></a>FORCE</code></td>
<td class="cellalignment1926" headers="r7c1-t39 r1c2-t39">Overrides the restartable restore feature and restores all files regardless of whether they must be restored. If you do not specify <code dir="ltr">FORCE</code>, then RMAN restores a file only if its header information does not match the information in the control file.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1626"></a><a id="sthref1627"></a><a id="sthref1628"></a>FROM&nbsp;BACKUPSET</code></td>
<td class="cellalignment1926" headers="r8c1-t39 r1c2-t39">Specifies that RMAN should restore from backup sets only. By default <code dir="ltr">RESTORE</code> chooses the file copy or backup set that needs the least media recovery.
<p>If you use the <code dir="ltr">FROM BACKUPSET</code> option, then channels for the appropriate type of storage devices must be allocated for the backup sets that must be restored. For example, if needed backups are only available on tape, and no <code dir="ltr">sbt</code> channels have been allocated, then RMAN cannot find a candidate backup set to restore, and the <code dir="ltr">RESTORE</code> command fails.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1629"></a><a id="sthref1630"></a><a id="sthref1631"></a>FROM&nbsp;DATAFILECOPY</code></td>
<td class="cellalignment1926" headers="r9c1-t39 r1c2-t39">Specifies that RMAN should restore data file copies only. By default <code dir="ltr">RESTORE</code> chooses the file copy or backup set that needs the least media recovery. If you use the <code dir="ltr">FROM DATAFILECOPY</code> option, then the allocated channels must be of <code dir="ltr">DEVICE TYPE DISK</code>.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r10c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1632"></a><a id="sthref1633"></a>FROM&nbsp;TAG</code> <code dir="ltr"><span class="codeinlineitalic">tag_name</span></code></td>
<td class="cellalignment1926" headers="r10c1-t39 r1c2-t39">Refer to the <code dir="ltr"><span class="codeinlineitalic"><a href="#i1036865"><span class="italic">restoreSpecOperand</span></a></span></code> clause.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r11c1-t39" headers="r1c1-t39"><a id="CHDFAJFI"></a><code dir="ltr"><a id="sthref1634"></a><a id="sthref1635"></a><a id="sthref1636"></a>PREVIEW</code></td>
<td class="cellalignment1926" headers="r11c1-t39 r1c2-t39">Reports&mdash;but does not restore&mdash;the backups and archived redo log files that RMAN could use to restore and recover the database to the specified time. RMAN queries the metadata and does not actually read the backup files.
<p>The <code dir="ltr">RESTORE ... PREVIEW</code> output is in the same format as the <code dir="ltr"><a href="rcmsynta027.htm#i82460">LIST</a></code> <code dir="ltr">BACKUP</code> output (see <a href="#CHDEFIAA">Example 3-24</a>).</p>
<p><a id="sthref1637"></a><a id="sthref1638"></a>Some media managers provide status information to RMAN about which backups are offsite. Offsite backups are stored in a remote location, such as a secure storage facility, and cannot be used without retrieving media.</p>
<p>Offsite backups are marked as <code dir="ltr">AVAILABLE</code> in the RMAN repository even though the media must be retrieved from storage before the backup can be restored. If RMAN attempts to restore a offsite backup, then the restore operation fails. <code dir="ltr">RESTORE ... PREVIEW</code> can identify backups needed for a <code dir="ltr">RESTORE</code> operation that are stored on media that requires retrieval. The output indicates whether backups are stored offsite.</p>
<p>If a needed backup is stored offsite, but the media manager does not support offsite backups, then your options are:</p>
<ul>
<li>
<p>Use <code dir="ltr"><a href="rcmsynta009.htm#i79920">CHANGE</a></code> <code dir="ltr">... UNAVAILABLE</code> to prevent RMAN from selecting the needed offsite backups, and attempt the <code dir="ltr">RESTORE ... PREVIEW</code> operation again to determine whether RMAN selects another offsite backup. When RMAN does not select any offsite backups, you can perform the restore operation.</p>
</li>
<li>
<p>Use <code dir="ltr">RESTORE ... PREVIEW</code> with the <code dir="ltr">RECALL</code> option.</p>
</li>
</ul>
<p><span class="bold">See Also:</span> <code dir="ltr"><a href="rcmsynta027.htm#i82460">LIST</a></code>, specifically the <code dir="ltr">BACKUPS</code> and <code dir="ltr">SUMMARY</code> options, and the <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> <code dir="ltr">... VALIDATE HEADER</code> command</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r12c1-t39" headers="r1c1-t39"><code dir="ltr">&nbsp;&nbsp;&nbsp;RECALL</code></td>
<td class="cellalignment1926" headers="r12c1-t39 r1c2-t39">Instructs the media manager to retrieve the backup media needed for the specified restore operation from offsite storage (see <a href="#CHDDHJHH">Example 3-25</a>).
<p><span class="bold">Note:</span> This option only works if your media manager supports this functionality. You can use <code dir="ltr">RESTORE ... PREVIEW</code> periodically to monitor whether the needed backups are stored locally again.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r13c1-t39" headers="r1c1-t39"><code dir="ltr">&nbsp;&nbsp;&nbsp;SUMMARY</code></td>
<td class="cellalignment1926" headers="r13c1-t39 r1c2-t39">Summarizes the backups that RMAN would restore. The output is in the same format as the output of the <code dir="ltr">LIST BACKUPS ... SUMMARY</code> command.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r14c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1639"></a><a id="sthref1640"></a>SKIP READONLY</code></td>
<td class="cellalignment1926" headers="r14c1-t39 r1c2-t39">Does not restore read-only files.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r15c1-t39" headers="r1c1-t39"><br />
<code dir="ltr"><a id="sthref1641"></a><a id="sthref1642"></a>TO RESTORE POINT</code><br />
<code dir="ltr"><span class="codeinlineitalic">restore_point_name</span></code></td>
<td class="cellalignment1926" headers="r15c1-t39 r1c2-t39">Specifies a restore point, with the SCN at which the restore point was created as the upper, inclusive limit. Because the limit is inclusive, RMAN selects only files that it can use to restore files up to <span class="italic">and including</span> the SCN corresponding to the restore point.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r16c1-t39" headers="r1c1-t39"><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code></td>
<td class="cellalignment1926" headers="r16c1-t39 r1c2-t39">Limits the selection to backup sets or file copies that are suitable for a point-in-time recovery to the specified time, SCN, or log sequence number.
<p>In the absence of any other criteria, RMAN selects the most current file copy or backup set to restore. The time specified in the <code dir="ltr">UNTIL</code> clause must fall within the current database incarnation.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl019.htm#i1000331">untilClause</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r17c1-t39" headers="r1c1-t39"><code dir="ltr"><a id="sthref1643"></a>VALIDATE</code></td>
<td class="cellalignment1926" headers="r17c1-t39 r1c2-t39">Specifies that RMAN should decide which backup sets, data file copies, and archived redo log files must be restored, and then validate them (see <a href="#CHDHIEJA">Example 3-26</a>). No files are restored.
<p>For files on both disk and tape, RMAN reads all blocks in the backup piece or image copy. RMAN also validates offsite backups. The validation is identical to a real restore operation except that RMAN does not write output files.</p>
<p><span class="bold">Note:</span> If you use <code dir="ltr">RESTORE</code> with the <code dir="ltr">VALIDATE</code> option, then the database can be open with data files online.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><a href="rcmsynta2024.htm#i86794">VALIDATE</a></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r18c1-t39" headers="r1c1-t39"><code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref1644"></a>HEADER</code></td>
<td class="cellalignment1926" headers="r18c1-t39 r1c2-t39">Reports and validates&mdash;but does not restore&mdash;the backups that RMAN could use to restore to the specified time.
<p>When you specify this option, RMAN performs the same functions as when you run <code dir="ltr">RESTORE</code> with the <code dir="ltr"><a href="#CHDFAJFI"><code dir="ltr">PREVIEW</code></a></code> option. However, in addition to listing the files needed for restore and recovery, RMAN validates the backup file headers to determine whether the files on disk or in the media management catalog correspond to the metadata in the RMAN repository.</p>
<p><span class="bold">See Also:</span> The descriptions of the <code dir="ltr">RESTORE</code> <code dir="ltr"><a href="#CHDFAJFI"><code dir="ltr">PREVIEW</code></a></code> option and the <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> <code dir="ltr">... VALIDATE HEADER</code> option</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="BGBJJGCB"></a><a id="RCMRF90308"></a><span class="italic"><a id="sthref1645"></a><a id="sthref1646"></a>restoreObject</span></p>
<p>This subclause specifies the objects to be restored: control files, data files, archived redo log files, or the server parameter file. RMAN does not support backup and recovery of the change tracking file. RMAN re-creates the change tracking file after database restore and recovery; the next incremental backup after any recovery can use the file. Thus, restore and recovery has no user-visible effect on change tracking.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for restoreObject Subclause" summary="Describes RESTORE command restoreObject parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t40">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t40">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t40" headers="r1c1-t40"><code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl002.htm#i78730">archivelogRecordSpecifier</a></span></code></td>
<td class="cellalignment1926" headers="r2c1-t40 r1c2-t40"><a id="sthref1647"></a>Restores the specified range of archived redo log files.
<p>The default restore location is <code dir="ltr"><a id="sthref1648"></a><a id="sthref1649"></a>DB_RECOVERY_FILE_DEST</code> (if one of <code dir="ltr">LOG_ARCHIVE_DEST_n</code> is configured to <code dir="ltr">USE_DB_RECOVERY_FILE_DEST</code> either implicitly or explicitly). Otherwise, the default restore file names are constructed with the <code dir="ltr"><a id="sthref1650"></a><a id="sthref1651"></a>LOG_ARCHIVE_FORMAT</code> and <code dir="ltr"><a id="sthref1652"></a><a id="sthref1653"></a>LOG_ARCHIVE_DEST_1</code> initialization parameters of the target database. These parameters combine in a port-specific fashion to derive the name of the restored log. You can override the default location with the <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">ARCHIVELOG DESTINATION</code> command.</p>
<p>Because the <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> command automatically restores archived redo log files as needed, you seldom need to restore logs manually. Possible reasons for manually restoring archived redo log files are to speed up recovery, to stage the logs to multiple destinations, or to analyze the log contents after a point-in-time recovery. To restore logs from a previous incarnation without shutting down the database, you can use <code dir="ltr">RESTORE ARCHIVELOG</code> with:</p>
<ul>
<li>
<p>... <code dir="ltr">FROM SCN</code></p>
</li>
<li>
<p>..<code dir="ltr">.SCN BETWEEN... AND</code></p>
</li>
<li>
<p><code dir="ltr">FROM SCN ... INCARNATION &lt;integer&gt;</code></p>
</li>
<li>
<p><code dir="ltr">FROM SCN... INCARNATION ALL</code></p>
</li>
</ul>
<p><span class="bold">Note:</span> The database can be started, mounted, or open for this operation.</p>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl002.htm#i78730">archivelogRecordSpecifier</a></span></code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1654"></a><a id="sthref1655"></a>CONTROLFILE</code></td>
<td class="cellalignment1926" headers="r3c1-t40 r1c2-t40">Restores either a standby or backup control file depending on the target database role.
<p>If the control file is lost, then restore the control file (see <a href="#CHDFEFBD">Table 3-9</a>) and restore the database after mounting the restored control file. You must always run the <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> command after mounting a restored control file and you must open the database with the <code dir="ltr">RESETLOGS</code> option.</p>
<p><span class="bold">Note:</span> If the target database is not mounted, and if RMAN is not connected to a recovery catalog, then you must specify the <code dir="ltr">FROM AUTOBACKUP</code> clause with <code dir="ltr">RESTORE CONTROLFILE</code>. If the autobackup is in a nondefault format, then first use the <code dir="ltr">SET CONTROLFILE AUTOBACKUP FORMAT</code> command to specify the format. If the target database is mounted or open, then you must specify the <code dir="ltr">TO</code> <code dir="ltr"><span class="codeinlineitalic">filename</span></code> clause with <code dir="ltr">RESTORE CONTROLFILE</code>.</p>
<p>When you run <code dir="ltr">RESTORE</code> with a backup control file while connected to a recovery catalog (see <a href="#CHDGHAJH">Example 3-20</a>), RMAN automatically updates the control file to reflect the structure of the restored database based on the metadata in the catalog.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t40" headers="r1c1-t40"><code dir="ltr">&nbsp;&nbsp;&nbsp;TO</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r4c1-t40 r1c2-t40">Restores the control file to the specified file name.
<p><a href="#CHDFEFBD">Table 3-9</a> explains RMAN behavior when restoring the control file with the <code dir="ltr">TO</code> clause.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1656"></a><a id="sthref1657"></a>DATABASE</code></td>
<td class="cellalignment1926" headers="r5c1-t40 r1c2-t40">Restores all data files in the database except those that are offline. By default, RMAN restores data file in read-only tablespaces.
<p>Unlike <code dir="ltr"><a href="rcmsynta007.htm#i78895">BACKUP</a></code> <code dir="ltr">DATABASE</code>, <code dir="ltr">RESTORE DATABASE</code> does <span class="italic">not</span> automatically include the control file and the server parameter file&mdash;you must issue additional <code dir="ltr">RESTORE CONTROLFILE</code> and <code dir="ltr">RESTORE SPFILE</code> commands to restore these files.</p>
<p><span class="bold">Note:</span> To restore offline data files you must use <code dir="ltr">RESTORE DATAFILE</code> or <code dir="ltr">RESTORE TABLESPACE</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t40" headers="r1c1-t40"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref1658"></a>SKIP [FOREVER]</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;TABLESPACE</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">tablespace_name</span></code></td>
<td class="cellalignment1926" headers="r6c1-t40 r1c2-t40">Excludes the specifies tablespaces from the restore operation. This option is useful to avoid restoring tablespaces containing temporary data.
<p>Specifying the <code dir="ltr">FOREVER</code> keyword does not change the behavior of <code dir="ltr">SKIP</code>. The <code dir="ltr">FOREVER</code> keyword exists solely to maintain compatible syntax between <code dir="ltr">RESTORE SKIP FOREVER</code> and <code dir="ltr">RECOVER SKIP FOREVER</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1659"></a><a id="sthref1660"></a>DATAFILE</code> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl005.htm#i81255">datafileSpec</a></span></code></td>
<td class="cellalignment1926" headers="r7c1-t40 r1c2-t40">Restores the data files specified by file name or absolute data file number (see <a href="#CHDFEAAH">Example 3-19</a>).
<p><span class="bold">Note:</span> Do not specify a data file more than once in a restore job. For example, the following command is invalid because data file 1 is both specified explicitly and implied by the <code dir="ltr">SYSTEM</code> tablespace:</p>
<pre dir="ltr">
RESTORE TABLESPACE SYSTEM DATAFILE 1;
</pre>
<p><span class="bold">See Also:</span> <code dir="ltr"><span class="codeinlineitalic"><a href="rcmsubcl005.htm#i81255">datafileSpec</a></span></code></p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1661"></a>PRIMARY CONTROLFILE</code></td>
<td class="cellalignment1926" headers="r8c1-t40 r1c2-t40">Restores a control file for a primary database in a Data Guard environment.
<p>RMAN restores either a normal or standby control file as appropriate, depending on the most recent database role known to the recovery catalog (<code dir="ltr"><a href="rcviews051.htm#BABHADIJ">RC_SITE</a></code><code dir="ltr">.DATABASE_ROLE</code>) for the target database. The purpose of this option to override the default setting in cases where the most recent database role is out-of-date.</p>
<p><a id="sthref1662"></a>Assume that you perform a switchover from primary database <code dir="ltr">dgny</code> to standby database <code dir="ltr">dgsf</code>, so that <code dir="ltr">dgsf</code> is the new primary database. You want to restore a control file on <code dir="ltr">dgsf</code>, but the recovery catalog was not resynchronized and still shows <code dir="ltr">dgsf</code> as a standby database. In this case, you can specify <code dir="ltr">PRIMARY CONTROLFILE</code> to override the default RMAN behavior and restore a normal control file.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r9c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1663"></a><a id="sthref1664"></a><a id="sthref1665"></a>SPFILE</code></td>
<td class="cellalignment1926" headers="r9c1-t40 r1c2-t40">Restores a primary or standby server parameter file to the location from which it was backed up. RMAN cannot overwrite a server parameter file currently in use by the target database.
<p>By default RMAN restores the most current server parameter file. Specify the <code dir="ltr">UNTIL</code> or <code dir="ltr">TAG</code> options to restore older versions of the server parameter file.</p>
<p>If the server parameter file is lost, then connect RMAN to the target database (and recovery catalog if used) and run <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">DBID</code>. Run <code dir="ltr"><a href="rcmsynta2019.htm#i86446">STARTUP</a></code> <code dir="ltr">FORCE NOMOUNT</code> before running <code dir="ltr">RESTORE SPFILE</code>. Then run <code dir="ltr">STARTUP FORCE</code> to restart the database instance with the restored server parameter file.</p>
<p><span class="bold">Note:</span> If the target database is not mounted, and if RMAN is not connected to a recovery catalog, then you must specify the <code dir="ltr">FROM AUTOBACKUP</code> clause with <code dir="ltr">RESTORE SPFILE</code>. If the autobackup is in a nondefault format, then first use the <code dir="ltr">SET CONTROLFILE AUTOBACKUP FORMAT</code> command to specify the format. If the target database is started, mounted, or open, and if the database was started with a server parameter file, then you must specify the <code dir="ltr">TO</code> <code dir="ltr"><span class="codeinlineitalic">filename</span></code> clause with <code dir="ltr">RESTORE SPFILE</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r10c1-t40" headers="r1c1-t40"><code dir="ltr">&nbsp;&nbsp;&nbsp;TO [PFILE]</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r10c1-t40 r1c2-t40"><a id="sthref1666"></a>Restores a primary or standby server parameter file to the location specified by the <code dir="ltr">TO</code> clause. Specify <code dir="ltr">PFILE</code> to save the server parameter file as a text-based initialization parameter file.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r11c1-t40" headers="r1c1-t40"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref1667"></a><a id="sthref1668"></a>FOR DB_UNIQUE_NAME</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">db_unique_name</span></code></td>
<td class="cellalignment1926" headers="r11c1-t40 r1c2-t40">Specifies the <code dir="ltr">DB_UNIQUE_NAME</code> for the target database when the instance is not started. This parameter is only useful in a Data Guard environment.
<p><a id="sthref1669"></a>When <code dir="ltr">FOR DB_UNIQUE_NAME</code> is specified, RMAN can locate the correct RMAN configurations for the host on which the <code dir="ltr">SPFILE</code> is being restored and use them to access backup devices. Otherwise, RMAN cannot choose the correct channel configurations and returns an <a id="sthref1670"></a><a id="sthref1671"></a><code dir="ltr">RMAN-6758</code> error.</p>
<p>In a Data Guard environment, the primary and standby hosts may have different channel configurations for communicating with their associated SBT backup and disk devices. If both the primary and standby databases are known to the recovery catalog, then the configuration settings for both databases are recorded in the recovery catalog. Because the two databases have the same <code dir="ltr">DB_NAME</code>, the records in the recovery catalog can only be distinguished with the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter.</p>
<p><span class="bold">Note:</span> Using <code dir="ltr">RESTORE SPFILE</code> when the <code dir="ltr">DB_NAME</code> is not unique in the recovery catalog produces an <code dir="ltr">RMAN-6758</code> error.</p>
<p><span class="bold">See Also:</span> <a class="olink SBYDB04700" href="../../server.112/e41134/rman.htm#SBYDB04700"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for a detailed procedure for restoring the server parameter file in a Data Guard environment</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r12c1-t40" headers="r1c1-t40"><code dir="ltr">&nbsp;&nbsp;&nbsp;TO</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r12c1-t40 r1c2-t40">Restores the standby control file to the specified file name. <a href="#CHDFEFBD">Table 3-9</a> explains the RMAN behavior when restoring the control file with the <code dir="ltr">TO</code> clause.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r13c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1672"></a><a id="sthref1673"></a><a id="sthref1674"></a>STANDBY CONTROLFILE</code></td>
<td class="cellalignment1926" headers="r13c1-t40 r1c2-t40">Restores a control file for a standby database. RMAN can transparently restore a normal control file backup and make it usable for a standby database.
<p>RMAN restores either a normal or standby control file as appropriate, depending on the most recent database role known to the recovery catalog (<code dir="ltr"><a href="rcviews051.htm#BABHADIJ">RC_SITE</a></code><code dir="ltr">.DATABASE_ROLE</code>) for the target database. The purpose of this option to override the default setting in cases where the most recent database role is out-of-date. Assume that you perform a switchover from primary database <code dir="ltr">dgny</code> to standby database <code dir="ltr">dgsf</code>, so that <code dir="ltr">dgsf</code> is the new primary database. Later, you make <code dir="ltr">dgny</code> a standby database for <code dir="ltr">dgsf</code>. You want to restore a control file on <code dir="ltr">dgny</code>, but the recovery catalog was not resynchronized and still shows <code dir="ltr">dgny</code> as a primary database. In this case, you can specify <code dir="ltr">STANDBY CONTROLFILE</code> to override the default RMAN behavior and restore a standby control file.</p>
<p>If you restore the control file of a database whose <code dir="ltr">DB_UNIQUE_NAME</code> is known to the recovery catalog, then RMAN updates all file names in the control file to file names known to the recovery catalog. Any file names explicitly renamed with <code dir="ltr">ALTER DATABASE RENAME FILE</code> take precedence over the file names in the recovery catalog.</p>
<p><span class="bold">See Also:</span> <a href="#CHDFEFBD">Table 3-9</a> for restrictions and usage notes</p>
<p><span class="bold">Note:</span> You must always run the <code dir="ltr"><a href="rcmsynta2001.htm#i84135">RECOVER</a></code> command after mounting a restored control file, and must also always open the database with the <code dir="ltr">RESETLOGS</code> option.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r14c1-t40" headers="r1c1-t40"><code dir="ltr"><a id="sthref1675"></a>TABLESPACE</code> <code dir="ltr"><span class="codeinlineitalic">tablespace_name</span></code></td>
<td class="cellalignment1926" headers="r14c1-t40 r1c2-t40">Restores all data files in the specified tablespaces (see <a href="#CHDGADCD">Example 3-18</a>).
<p>RMAN translates the tablespace name internally into a list of data files. If you rename a tablespace (for example, from <code dir="ltr">users</code> to <code dir="ltr">customers</code>), then so long as an additional tablespace with the old name (<code dir="ltr">users</code>) has not been created, you can use either the old name (<code dir="ltr">users</code>) or the new name (<code dir="ltr">customers</code>) for the tablespace. RMAN detects that the tablespace has changed its name and updates the recovery catalog on the next resynchronization.</p>
<p><span class="bold">Note:</span> RMAN can back up and restore dictionary-managed temporary tablespaces, but it cannot back up locally managed temporary tablespaces. However, RMAN automatically re-creates locally managed temporary tablespaces after restoring the database.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="i1036865"></a><a id="RCMRF90309"></a><span class="italic">restoreSpecOperand</span></p>
<p>This subclause specifies options for the <a href="#BGBJJGCB"><span class="xreftitleitalic"><span class="italic">restoreObject</span></span></a> clause. These parameters override the parameters with the same name at the <code dir="ltr">RESTORE</code> command level.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for restoreSpecOperand Subclause" summary="Describes RESTORE command restoreSpecOperand parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t41">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t41">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t41" headers="r1c1-t41"><code dir="ltr"><a id="sthref1676"></a>CHANNEL</code> <code dir="ltr"><span class="codeinlineitalic">channel_id</span></code></td>
<td class="cellalignment1926" headers="r2c1-t41 r1c2-t41">Specifies the case-sensitive name of a channel to use for this restore operation. If you do not specify a channel, then <code dir="ltr">RESTORE</code> uses any available channel allocated with the correct device type.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t41" headers="r1c1-t41"><a id="sthref1677"></a><a id="sthref1678"></a><a id="sthref1679"></a><code dir="ltr">FROM AUTOBACKUP</code></td>
<td class="cellalignment1926" headers="r3c1-t41 r1c2-t41">Restores a control file autobackup (see <a href="#CHDBAFDB">Example 3-21</a>).
<p>This option is only valid on the <code dir="ltr">RESTORE CONTROLFILE</code> and <code dir="ltr">RESTORE SPFILE</code> commands. When restoring either type of file in <code dir="ltr">NOCATALOG</code> mode, the <code dir="ltr">FROM AUTOBACKUP</code> clause is required.</p>
<p>RMAN begins the search on the current day or on the day specified with the <code dir="ltr"><a href="rcmsynta2014.htm#i85845">SET</a></code> <code dir="ltr">UNTIL</code>. On the first day searched, the search begins with sequence number 256 (or the sequence number specified by <code dir="ltr">MAXSEQ</code>, if provided) and counts back to sequence 0. If no autobackup is found in the current or <code dir="ltr">SET UNTIL</code> day, then RMAN checks preceding days, starting with sequence 256 and counting back to 0. The search continues up to <code dir="ltr">MAXDAYS</code> days (default of 7, maximum of 366) prior to the current or <code dir="ltr">SET UNTIL</code> day. If no autobackup is found within <code dir="ltr">MAXDAYS</code> days, then RMAN signals an error and the command stops.</p>
<p><span class="bold">See Also:</span> <a href="#CHDFEFBD">Table 3-9</a> for restrictions and usage notes.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t41" headers="r1c1-t41"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic"><a href="#BGBHBIAC"><span class="italic">autoBackupOptList</span></a></span></code></td>
<td class="cellalignment1926" headers="r4c1-t41 r1c2-t41">Specifies parameters that control the search for a control file autobackup.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t41" headers="r1c1-t41"><code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">media_handle</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r5c1-t41 r1c2-t41">Specifies the name of the control file copy or backup piece containing a control file. The <code dir="ltr"><span class="codeinlineitalic">media_handle</span></code> can be any backup piece that contains a backup of a control file: the control file backup does not need to be an autobackup.
<p><span class="bold">See Also:</span> <a href="#CHDFEFBD">Table 3-9</a> for restrictions and usage notes.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t41" headers="r1c1-t41"><code dir="ltr"><a id="sthref1680"></a><a id="sthref1681"></a><a id="sthref1682"></a><a id="sthref1683"></a>FROM TAG</code> <code dir="ltr"><span class="codeinlineitalic">tag_name</span></code></td>
<td class="cellalignment1926" headers="r6c1-t41 r1c2-t41">Overrides the default selection of the most recent backups or file copy available. The tag restricts the automatic selection to backup sets or file copies created with the specified tag. If multiple backup sets or copies have a matching tag, then RMAN selects the most recent one. Tag names are not case sensitive.
<p><span class="bold">See Also:</span> <code dir="ltr"><a href="rcmsynta007.htm#i78895">BACKUP</a></code> for a description of how a tag can be applied to an individual copy of a duplexed backup set, and for a description of the default file name format for tags.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" -->
<p class="subhead2"><a id="BGBHBIAC"></a><a id="RCMRF90310"></a><span class="italic"><a id="sthref1684"></a><a id="sthref1685"></a>autoBackupOptList</span></p>
<p>This subclause specifies parameters that control the search for a control file autobackup.</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for autoBackupOptList Subclause" summary="Describes RESTORE command autoBackupOptList parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t42">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t42">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t42" headers="r1c1-t42"><code dir="ltr"><a id="sthref1686"></a>DB_NAME</code> <code dir="ltr"><span class="codeinlineitalic">database_name</span></code></td>
<td class="cellalignment1926" headers="r2c1-t42 r1c2-t42">Provides a <code dir="ltr">DB_NAME</code> to be used in searching for control file autobackups. See <a href="#CHDBGBBD">Table 3-10</a> to determine when to set this parameter.
<p>The default value of the <a id="sthref1687"></a><a id="sthref1688"></a><code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is the <code dir="ltr">DB_NAME</code> initialization parameter setting. If no <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is set for a target database, then use either <code dir="ltr">RESTORE ... DB_NAME</code> or <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>. If the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter setting for a target database is different from <code dir="ltr">DB_NAME</code>, then use <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t42" headers="r1c1-t42"><code dir="ltr"><a id="sthref1689"></a><a id="sthref1690"></a>MAXDAYS</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r3c1-t42 r1c2-t42">Limits the search for a control file autobackup within the specified number of days earlier.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t42" headers="r1c1-t42"><code dir="ltr"><a id="sthref1691"></a>MAXSEQ</code> <code dir="ltr"><span class="codeinlineitalic">integer</span></code></td>
<td class="cellalignment1926" headers="r4c1-t42 r1c2-t42">Specifies the highest sequence number for the control file autobackup search.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r5c1-t42" headers="r1c1-t42"><code dir="ltr"><a id="sthref1692"></a><a id="sthref1693"></a>RECOVERY AREA</code> <code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">pathname</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r5c1-t42 r1c2-t42">Specifies a path to the fast recovery area to search for autobackups. <code dir="ltr">RECOVERY AREA</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST</code> are synonyms. See <a href="#CHDBGBBD">Table 3-10</a> to determine when to set this parameter.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r6c1-t42" headers="r1c1-t42"><br />
<code dir="ltr"><a id="sthref1694"></a>DB_RECOVERY_FILE_DEST</code><br />
<code dir="ltr">'</code><code dir="ltr"><span class="codeinlineitalic">pathname</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r6c1-t42 r1c2-t42"><code dir="ltr">RECOVERY AREA</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST</code> are synonyms.</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r7c1-t42" headers="r1c1-t42"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;DB_NAME</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">database_name</span></code></td>
<td class="cellalignment1926" headers="r7c1-t42 r1c2-t42">Provides a <code dir="ltr">DB_NAME</code> to be used in searching for control file autobackups. See <a href="#CHDBGBBD">Table 3-10</a> to determine when to set this parameter.
<p>The default value of the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is the <code dir="ltr">DB_NAME</code> initialization parameter setting. If no <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is set for a target database, then use either <code dir="ltr">RESTORE ... DB_NAME</code> or <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>. If the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter setting for a target database is different from <code dir="ltr">DB_NAME</code>, then use <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>.</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r8c1-t42" headers="r1c1-t42"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;DB_UNIQUE_NAME</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">db_unique_name</span></code></td>
<td class="cellalignment1926" headers="r8c1-t42 r1c2-t42">Specifies the <code dir="ltr">DB_UNIQUE_NAME</code> of the database in the specified fast recovery area that is the target of the restore operation.
<p>The default value of the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is the <code dir="ltr">DB_NAME</code> initialization parameter setting. If no <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter is set for a target database, then use either <code dir="ltr">RESTORE ... DB_NAME</code> or <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>. If the <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter setting for a target database is different from <code dir="ltr">DB_NAME</code>, then use <code dir="ltr">RESTORE ... DB_UNIQUE_NAME</code>.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1695"></a><a id="sthref1696"></a>Examples</p>
<div id="RCMRF90311" class="example">
<p class="titleinexample"><a id="CHDGADCD"></a>Example 3-18 Restoring a Tablespace</p>
<p>This example takes a tablespace offline, restores it, then performs media recovery.</p>
<pre dir="ltr">
SQL "ALTER TABLESPACE users OFFLINE IMMEDIATE"; 
RESTORE TABLESPACE users; 
RECOVER TABLESPACE users;  
SQL "ALTER TABLESPACE users ONLINE";
</pre></div>
<!-- class="example" -->
<div id="RCMRF90312" class="example">
<p class="titleinexample"><a id="CHDFEAAH"></a>Example 3-19 Setting a New Name for a Restored Data File</p>
<p>Assume that <code dir="ltr">/disk1</code>, which contains data file 9, suffers a media failure. This example specifies a new name for the data file, restores it, updates the control file to use the new name, recovers it, and then brings it online:</p>
<pre dir="ltr">
RUN
{
  SQL "ALTER DATABASE DATAFILE 9 OFFLINE";
  SET NEWNAME FOR DATAFILE 9 TO '/disk2/users01.dbf';
  RESTORE DATAFILE 9;
  SWITCH DATAFILE ALL;
  RECOVER DATAFILE 9;
  SQL "ALTER DATABASE DATAFILE 9 ONLINE";
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF90313" class="example">
<p class="titleinexample"><a id="CHDGHAJH"></a>Example 3-20 Restoring the Control File When Using a Recovery Catalog</p>
<p>Assume that you want to restore the control file backup with the tag <code dir="ltr">monday_cf_backup</code>. You start the RMAN client, connect to the target and recovery catalog databases, and run the following commands:</p>
<pre dir="ltr">
RUN
{ # SET DBID is not necessary when RMAN is connected to a recovery catalog
  STARTUP FORCE NOMOUNT;
  RESTORE CONTROLFILE FROM TAG 'monday_cf_backup';
  ALTER DATABASE MOUNT;
  RESTORE DATABASE;
  RECOVER DATABASE;
}
ALTER DATABASE OPEN RESETLOGS; # required after recovery with backup control file
</pre>
<p>RMAN restores the control file to its default location and replicates it automatically to all <code dir="ltr">CONTROL_FILES</code> locations. RMAN mounts the control file and restores and recovers the database. RMAN automatically updates the control file to reflect the structure of the restored database based on the metadata in the recovery catalog.</p>
</div>
<!-- class="example" -->
<div id="RCMRF90314" class="example">
<p class="titleinexample"><a id="CHDBAFDB"></a>Example 3-21 Recovering the Database with a Control File Autobackup</p>
<p>Assume that the control file and some data files are lost and must be restored from tape. Because RMAN does not use a recovery catalog in this scenario, the <a href="rcmsynta2014.htm#CHDFHGDI">SET</a> <code dir="ltr">DBID</code> command is necessary to identify the control file to be restored. The example restores the control file from tape, mounts the database, and then restores and recovers the database.</p>
<pre dir="ltr">
CONNECT TARGET /
STARTUP FORCE NOMOUNT;
SET DBID 36508508;  # required when restoring control file in NOCATALOG mode
RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt;
  RESTORE CONTROLFILE FROM AUTOBACKUP;
  ALTER DATABASE MOUNT;
  RESTORE DATABASE;
  RECOVER DATABASE;
}
ALTER DATABASE OPEN RESETLOGS;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90315" class="example">
<p class="titleinexample"><a id="sthref1697"></a>Example 3-22 Restoring a Control File Autobackup to a Nondefault Location</p>
<p>This example is a variation on <a href="#CHDBAFDB">Example 3-21</a>. In this scenario, the control file autobackup is located on disk in a nondefault location. RMAN starts searching for backups with a sequence number of 20, and searches backward for 5 months:</p>
<pre dir="ltr">
CONNECT TARGET /
STARTUP FORCE NOMOUNT
SET DBID 36508508;  # required when restoring control file in NOCATALOG mode
RUN
{
  SET CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK 
    TO '/disk1/prod_cf_auto_%F';
  RESTORE CONTROLFILE TO '/tmp/cf_auto.dbf' FROM AUTOBACKUP 
    MAXSEQ 20 MAXDAYS 150;
  ALTER DATABASE MOUNT;
  RESTORE DATABASE;
  RECOVER DATABASE;
}
ALTER DATABASE OPEN RESETLOGS;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90316" class="example">
<p class="titleinexample"><a id="sthref1698"></a>Example 3-23 Restoring a Server Parameter File Autobackup to the Current Location</p>
<p>The following series of commands restores the current server parameter file in <code dir="ltr">NOCATALOG</code> mode and then starts the instance with the restored server parameter file.</p>
<pre dir="ltr">
CONNECT TARGET /
SET DBID 1620189241; # set dbid to dbid of target database
STARTUP FORCE NOMOUNT; # start instance with dummy SPFILE
RUN
{
  ALLOCATE CHANNEL c1 DEVICE TYPE sbt;
  RESTORE SPFILE FROM AUTOBACKUP; # FROM AUTOBACKUP needed in NOCATALOG mode
  STARTUP FORCE; # startup with restored SPFILE
}
</pre></div>
<!-- class="example" -->
<div id="RCMRF90317" class="example">
<p class="titleinexample"><a id="CHDEFIAA"></a>Example 3-24 Previewing Backups</p>
<p>This example shows the results of a <code dir="ltr">RESTORE ... PREVIEW</code> command, which identifies the backup sets RMAN selects for use in restoring archived redo log files.</p>
<pre dir="ltr">
RMAN&gt; RESTORE ARCHIVELOG ALL DEVICE TYPE sbt PREVIEW;
 
Starting restore at 01-MAR-07
released channel: ORA_SBT_TAPE_1
allocated channel: ORA_SBT_TAPE_1
channel ORA_SBT_TAPE_1: SID=85 device type=SBT_TAPE
channel ORA_SBT_TAPE_1: Oracle Secure Backup
 
List of Backup Sets
===================
 
BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
53      1.25M      SBT_TAPE    00:00:18     01-MAR-07
        BP Key: 53   Status: AVAILABLE  Compressed: NO  Tag: TAG20070301T150155
        Handle: 2aibhej3_1_1   Media: RMAN-DEFAULT-000001
 
  List of Archived Logs in backup set 53
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    8       526376     01-MAR-07 527059     01-MAR-07
  1    9       527059     01-MAR-07 527074     01-MAR-07
  1    10      527074     01-MAR-07 527091     01-MAR-07
  1    11      527091     01-MAR-07 527568     01-MAR-07
  1    12      527568     01-MAR-07 527598     01-MAR-07
validation succeeded for backup piece
Finished restore at 01-MAR-07
</pre></div>
<!-- class="example" -->
<div id="RCMRF90318" class="example">
<p class="titleinexample"><a id="CHDDHJHH"></a>Example 3-25 Recalling Offsite Backups from Offsite Storage</p>
<p>When used with a media manager that reports information about offsite storage of backups and supports recalling offsite backups, <code dir="ltr">RESTORE ... PREVIEW RECALL</code> requests that any media needed to restore archived redo log files from backup be recalled from offsite storage.</p>
<pre dir="ltr">
RMAN&gt; RESTORE ARCHIVELOG ALL PREVIEW RECALL;

Starting restore at 10-JUN-06
using channel ORA_DISK_1
using channel ORA_SBT_TAPE_1
 
 
List of Backup Sets
===================
 
BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
31      12.75M     SBT_TAPE    00:00:02     10-JUN-06     
        BP Key: 33   Status: AVAILABLE  Compressed: NO  Tag: TAG20050610T152755
        Handle: 15gmknbs   Media: /v1,15gmknbs
 
  List of Archived Logs in backup set 31
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    1       221154     06-JUN-06 222548     06-JUN-06
  1    2       222548     06-JUN-06 222554     06-JUN-06
  1    3       222554     06-JUN-06 222591     06-JUN-06
  1    4       222591     06-JUN-06 246629     07-JUN-06
  1    5       246629     07-JUN-06 262451     10-JUN-06
 
BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
32      256.00K    SBT_TAPE    00:00:01     10-JUN-06     
        BP Key: 34   Status: AVAILABLE  Compressed: NO  Tag: TAG20050610T153105
        Handle: 17gmknhp_1_1   Media: /v1,17gmknhp_1_1
 
  List of Archived Logs in backup set 32
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    6       262451     10-JUN-06 262547     10-JUN-06
  1    7       262547     10-JUN-06 262565     10-JUN-06
 
Initiated recall for the following list of offsite backup files
==========================================================
        Handle: 15gmknbs   Media: /v1,15gmknbs
Finished restore at 10-JUN-06
</pre></div>
<!-- class="example" -->
<div id="RCMRF90319" class="example">
<p class="titleinexample"><a id="CHDHIEJA"></a>Example 3-26 Validating the Restore of a Backup</p>
<p>The following example illustrates using <code dir="ltr">RESTORE... VALIDATE</code> to confirm that backups required to restore the database are present on disk or tape, readable, and not corrupted:</p>
<pre dir="ltr">
RMAN&gt; RESTORE DATABASE VALIDATE;
 
Starting restore at 01-MAR-07
using channel ORA_DISK_1
allocated channel: ORA_SBT_TAPE_1
channel ORA_SBT_TAPE_1: SID=85 device type=SBT_TAPE
channel ORA_SBT_TAPE_1: Oracle Secure Backup
 
channel ORA_DISK_1: starting validation of datafile backup set
channel ORA_DISK_1: reading from backup piece /disk2/PROD/backupset/2007_03_01/o1_mf_nnndf_TAG20070301T161038_2ygtvzg0_.bkp
channel ORA_DISK_1: piece handle=/disk2/PROD/backupset/2007_03_01/o1_mf_nnndf_TAG20070301T161038_2ygtvzg0_.bkp tag=TAG20070301T161038
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: validation complete, elapsed time: 00:00:16
Finished restore at 01-MAR-07
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta2007.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta2009.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
