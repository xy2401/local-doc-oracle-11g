<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>RESYNC CATALOG</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1054" />
<meta name="description" content="A guide to backup and recovery of Oracle databases, including RMAN backup and recovery, RMAN data transfer, Oracle Flashback Technology, and user-managed backup and recovery" />
<meta name="dcterms.created" content="2015-05-13T7:47:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Backup and Recovery Reference" />
<meta name="dcterms.identifier" content="E10643-09" />
<meta name="dcterms.isVersionOf" content="RCMRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="rcmsynta2008.htm" title="Previous" type="text/html" />
<link rel="Next" href="rcmsynta2010.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10643.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">52/158</span> <!-- End Header --><a id="i999772"></a>
<div id="RCMRF150" class="refsect1">
<h1 class="refsect1">RESYNC CATALOG<a id="ABC1080557"></a><a id="ABC1080557SRI1"></a><a id="ABC1080557SRI12"></a><a id="ABC1080557SRI123"></a><a id="ABC1080557SRI1234"></a></h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1699"></a>Purpose</p>
<p>Use the <a id="CHDCHJDH"></a><code dir="ltr">RESYNC CATALOG</code> command to perform a full resynchronization of metadata in a recovery catalog schema with metadata in a target database control file. You can also use the <code dir="ltr">FROM CONTROLFILECOPY</code> clause to resynchronize the current control file with the RMAN metadata in a control file copy.</p>
<p>Typically, you run <code dir="ltr">RESYNC CATALOG</code> in the following situations:</p>
<ul>
<li>
<p>The recovery catalog was unavailable when you executed RMAN commands that automatically perform a resynchronization.</p>
</li>
<li>
<p>The target database is running in <code dir="ltr">ARCHIVELOG</code> mode, because the recovery catalog is <span class="italic">not</span> updated automatically when an online redo log switch occurs or when a redo log is archived.</p>
</li>
<li>
<p>You made changes to the physical structure of the target database such as adding or dropping a tablespace. As with log archiving, the recovery catalog is <span class="italic">not</span> updated automatically when the physical schema changes.</p>
</li>
<li>
<p>RMAN is connected as <code dir="ltr">TARGET</code> to a standby database. You want to update the recovery catalog with metadata about RMAN operations performed on this database.</p>
</li>
<li>
<p>RMAN is connected as <code dir="ltr">TARGET</code> to a standby database. You want to update the recovery catalog with metadata about a physical change on the primary database (see <a href="#CHDBIGGC">Example 3-29</a>).</p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1700"></a>Prerequisites</p>
<p>RMAN must be connected as <code dir="ltr">TARGET</code> to a mounted or open database and connected as <code dir="ltr">CATALOG</code> to a recovery catalog database. When running <code dir="ltr">RESYNC CATALOG</code> with multiple databases, a network connection is required for each target database.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1701"></a>Usage Notes</p>
<p><a id="sthref1702"></a>Resynchronizations are full or partial. If full, and if the target database has mounted the current control file (but not a newly created control file or a control file that is less current than a control file that was used previously), then RMAN updates all changed records for the physical schema: data files, tablespaces, redo threads, and online redo logs. If the database is open, then RMAN also obtains data about rollback segments. If the resynchronization is partial, then RMAN does not resynchronize metadata about the physical schema or rollback segments.</p>
<p>If the target control file is mounted and the catalog database is available at command execution, then RMAN automatically resynchronizes the recovery catalog as needed when you use RMAN commands. RMAN performs a full resynchronization after structural changes to database (adding or dropping database files, creating new incarnation, and so on) or after changes to the RMAN persistent configuration.</p>
<p>Starting with Oracle Database 11<span class="italic">g</span>, a single recovery catalog schema can keep track of database file names for all databases in a Data Guard environment. This catalog schema also keeps track of where the online redo logs, standby redo logs, temp files, archived redo log files, backup sets, and image copies are created for all databases. If RMAN is connected as <code dir="ltr">TARGET</code> to a standby database, then RMAN implicitly executes a full resynchronization if the standby control file contains information about a physical schema change on the primary database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV181" href="../../backup.112/e10642/rcmcatdb.htm#BRADV181"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for more information about catalog resynchronization</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1703"></a>Syntax</p>
<p class="subhead2"><a id="RCMRF90320"></a><span class="italic"><a id="sthref1704"></a><a id="sthref1705"></a>resync</span>::=</p>
<img width="548" height="93" src="img/resync.gif" alt="Description of resync.gif follows" /><br />
<a id="sthref1706" href="img_text/resync.htm">Description of the illustration resync.gif</a><br />
<br /></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1707"></a>Semantics</p>
<div class="inftblinformalwide">
<table class="cellalignment1929" title="Semantics for RESYNC CATALOG Command" summary="Describes RESYNC CATALOG parameters" dir="ltr">
<thead>
<tr class="cellalignment1920">
<th class="cellalignment1930" id="r1c1-t44">Syntax Element</th>
<th class="cellalignment1930" id="r1c2-t44">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r2c1-t44" headers="r1c1-t44"><code dir="ltr">RESYNC&nbsp;CATALOG</code></td>
<td class="cellalignment1926" headers="r2c1-t44 r1c2-t44">Updates the recovery catalog with RMAN metadata in the current control file of the target database (default).
<p>RMAN creates a snapshot control file to obtain a read-consistent view of the control file, then updates the recovery catalog with any new information from the snapshot. The <code dir="ltr">RESYNC CATALOG</code> command updates the following classes or records:</p>
<ul>
<li>
<p>Log history records, which are created when a log switch occurs. Log history records describe an online log switch, not a log archival.</p>
</li>
<li>
<p>Archived redo log records, which are associated with archived redo log files created by archiving an online redo log, copying an existing archived log, or restoring backups of archived redo log files.</p>
</li>
<li>
<p>Backup records, which are records of backup sets, backup pieces, proxy copies, and image copies.</p>
</li>
<li>
<p>Physical schema records, which are associated with data files and tablespaces. If the target database is open, then rollback segment information is also updated.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r3c1-t44" headers="r1c1-t44"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref1708"></a><a id="sthref1709"></a><a id="sthref1710"></a>FROM&nbsp;CONTROLFILECOPY</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;'</code><code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">'</code></td>
<td class="cellalignment1926" headers="r3c1-t44 r1c2-t44">Updates the current control file and recovery catalog with RMAN metadata from a control file copy (see <a href="#CHDDGFAE">Example 3-28</a>). Use <span class="italic">filename</span> to specify the name of the control file copy to use for resynchronization.
<p>The primary use for <code dir="ltr">FROM CONTROLFILECOPY</code> occurs when you re-create the control file, which causes you to lose RMAN records stored in the control file. You can then resynchronize the newly created control file with an old copy. Physical schema information is not updated when you use this option.</p>
<p><span class="bold">Note:</span> The control file copy can either be in the current database incarnation, or created in a prior incarnation (that is, prior to the most recent <code dir="ltr">OPEN</code> <code dir="ltr">RESETLOGS</code>).</p>
</td>
</tr>
<tr class="cellalignment1920">
<td class="cellalignment1926" id="r4c1-t44" headers="r1c1-t44"><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;<a id="sthref1711"></a><a id="sthref1712"></a>FROM&nbsp;DB_UNIQUE_NAME</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;{ALL&nbsp;|</code><br />
<code dir="ltr">&nbsp;&nbsp;&nbsp;</code><code dir="ltr"><span class="codeinlineitalic">db_unique_name</span></code><code dir="ltr">}</code></td>
<td class="cellalignment1926" headers="r4c1-t44 r1c2-t44">Resynchronizes the recovery catalog with control file metadata in the specified database or databases (see <a href="#CHDCACFG">Example 3-30</a>).
<p>When the <code dir="ltr">FROM DB_UNIQUE_NAME ALL</code> option is used to perform resynchronization, you must connect to the target database using password file authentication.</p>
<p>You can specify a single database with <code dir="ltr"><span class="codeinlineitalic">db_unique_name</span></code> or use <code dir="ltr">ALL</code> for all databases in the recovery catalog that share the DBID of the target database. If you specify <code dir="ltr">ALL</code>, then RMAN resynchronizes all databases in the Data Guard environment that are known to the recovery catalog.</p>
<p><span class="bold">Note:</span> You must have previously used <code dir="ltr">CONFIGURE DB_UNIQUE_NAME ... CONNECT IDENTIFIER</code> to specify a net service name to be used for an <a id="sthref1713"></a>Oracle Net connection to the database specified in <code dir="ltr">FROM DB_UNIQUE_NAME</code>.</p>
<p><a id="sthref1714"></a><a id="sthref1715"></a><a id="sthref1716"></a>When you run <code dir="ltr">RESYNC FROM DB_UNIQUE_NAME</code> for a specified database, RMAN performs both a normal resynchronization and a reverse resynchronization. In a normal resynchronization, RMAN updates the recovery catalog with metadata from the control file. In a reverse resynchronization, RMAN updates the persistent configurations in the control file if they do not match the information in the recovery catalog for the specified database.</p>
<p>For a sample use case, suppose that you recently connected RMAN as <code dir="ltr">TARGET</code> to the primary database and ran <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> to create an RMAN configuration for standby database <code dir="ltr">standby_new</code>. However, you have not yet connected RMAN as <code dir="ltr">TARGET</code> to <code dir="ltr">standby_new</code>. In this case, you can run <code dir="ltr">RESYNC CATALOG FROM DB_UNIQUE_NAME standby_new</code>. When you later connect RMAN to <code dir="ltr">standby_new</code> as <code dir="ltr">TARGET</code>, RMAN pushes the configuration from the recovery catalog to the mounted control file of <code dir="ltr">standby_new</code>.</p>
<p><span class="bold">Note:</span> The password file must be identical on all of the remote databases for this feature to work properly. You must manually copy it to all the remote databases in the configuration.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformalwide" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1717"></a><a id="sthref1718"></a>Examples</p>
<div id="RCMRF90321" class="example">
<p class="titleinexample"><a id="sthref1719"></a>Example 3-27 Resynchronizing the Recovery Catalog in ARCHIVELOG Mode</p>
<p>This example performs a full resynchronization of the target database after archiving all unarchived redo log files.</p>
<pre dir="ltr">
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT CATALOG rman@catdb

recovery catalog database Password: <span class="italic">password</span>
connected to recovery catalog database

RMAN&gt; SQL "ALTER SYSTEM ARCHIVE LOG CURRENT";
RMAN&gt; RESYNC CATALOG;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90322" class="example">
<p class="titleinexample"><a id="CHDDGFAE"></a>Example 3-28 Resynchronizing the Recovery Catalog from a Control File Copy</p>
<p>Suppose you want to retrieve some backup information from a control file copy.</p>
<p>Assume that you start the RMAN client and connect to a target database and recovery catalog. The following commands shut down and mount the target database, update the RMAN repository in the current control file with metadata from a backup control file, and then open the database.</p>
<pre dir="ltr">
STARTUP FORCE MOUNT
RESYNC CATALOG FROM CONTROLFILECOPY '/disk1/cfile.dbf';
ALTER DATABASE OPEN;
</pre></div>
<!-- class="example" -->
<div id="RCMRF90323" class="example">
<p class="titleinexample"><a id="CHDBIGGC"></a>Example 3-29 Resynchronizing the Recovery Catalog After a Structural Change</p>
<p>Suppose you have the following:</p>
<ul>
<li>
<p>A Data Guard environment containing primary database <code dir="ltr">prod</code> and standby database <code dir="ltr">standby3</code></p>
</li>
<li>
<p>Both the primary and the standby databases are registered with the catalog</p>
</li>
<li>
<p>You take a backup of the database and archive logs</p>
</li>
<li>
<p>You start SQL*Plus, connect to database <code dir="ltr">prod</code>, and add a data file to tablespace <code dir="ltr">users</code> as follows:</p>
</li>
</ul>
<pre dir="ltr">
SQL&gt; ALTER TABLESPACE users ADD DATAFILE ''?/oradata/prod/users03.dbf'' 
  2  SIZE 1M AUTOEXTEND ON 
  3  NEXT 10K MAXSIZE 10M";
</pre>
<p>The goal is to update the recovery catalog with metadata about this change. After the change is propagated to <code dir="ltr">standby3</code>, you start the RMAN client, connect to <code dir="ltr">standby3</code> as <code dir="ltr">TARGET</code>, and connect to the recovery catalog.</p>
<p>The next step is to define the connect identifiers for the standby database in your Data Guard environment with the <code dir="ltr">CONNECT IDENTIFIER</code> clause of the <code dir="ltr">CONFIGURE</code> command:</p>
<pre dir="ltr">
CONFIGURE DB_UNIQUE_NAME standby3 CONNECT IDENTIFIER 'inst2';
</pre>
<p>At this point, you use the <code dir="ltr">RESYNC CATALOG ... ALL</code> command to resynchronize the recovery catalog with changes for all the databases in the Data Guard environment. While you can resynchronize the catalog with a specific standby site's information, Oracle recommends you use the <code dir="ltr">ALL</code> option to keep the recovery catalog schema current with any database changes that may have occurred within your Data Guard environment:</p>
<pre dir="ltr">
RMAN&gt; RESYNC CATALOG FROM DB_UNIQUE_NAME ALL;
</pre>
<p>The recovery catalog is updated with metadata about the data file added to the <code dir="ltr">users</code> tablespace of database <code dir="ltr">prod</code>.</p>
</div>
<!-- class="example" -->
<div id="RCMRF90324" class="example">
<p class="titleinexample"><a id="CHDCACFG"></a>Example 3-30 Resynchronizing the Recovery Catalog with a Standby Database</p>
<p>Suppose that primary database <code dir="ltr">prod</code> and standby database <code dir="ltr">dgprod3</code> exist in a Data Guard environment. Your goal is to create an RMAN configuration for <code dir="ltr">dgprod3</code>.</p>
<p>You connect RMAN to database <code dir="ltr">prod</code> as <code dir="ltr">TARGET</code> and then connect to the recovery catalog. You use <code dir="ltr"><a href="rcmsynta010.htm#i80338">CONFIGURE</a></code> to update the persistent RMAN configuration for <code dir="ltr">dgprod3</code> in the recovery catalog as follows:</p>
<pre dir="ltr">
CONFIGURE DEFAULT DEVICE TYPE TO sbt FOR DB_UNIQUE_NAME dgprod3;
CONFIGURE DB_UNIQUE_NAME dgprod3 CONNECT IDENTIFIER 'inst3';
</pre>
<p>You have not yet performed any backups or other RMAN operations on <code dir="ltr">dgprod3</code>, so the control file of <code dir="ltr">dgprod3</code> and the recovery catalog metadata for <code dir="ltr">dgprod3</code> are not synchronized. In the same RMAN session, you synchronize the <code dir="ltr">dgprod3</code> control file with the recovery catalog as follows:</p>
<pre dir="ltr">
RESYNC CATALOG FROM DB_UNIQUE_NAME dgprod3;
</pre>
<p>RMAN updates the default device type to SBT at <code dir="ltr">dgprod3</code> and also updates the recovery catalog with the names from the <code dir="ltr">dgprod3</code> control file.</p>
</div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1919">
<tr>
<td class="cellalignment1926">
<table class="cellalignment1924">
<tr>
<td class="cellalignment1923"><a href="rcmsynta2008.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1923"><a href="rcmsynta2010.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1928">
<table class="cellalignment1922">
<tr>
<td class="cellalignment1923"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1923"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1923"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1923"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1923"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1923"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
