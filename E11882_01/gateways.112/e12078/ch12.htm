<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Gateway Configuration Using SNA Communication Protocol</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 008" />
<meta name="dcterms.created" content="2009-07-30T16:20:34Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Gateway for APPC Installation and Configuration Guide" />
<meta name="dcterms.identifier" content="E12078-01" />
<meta name="dcterms.isVersionOf" content="APPCI" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="ch11.htm" title="Previous" type="text/html" />
<link rel="Next" href="ch13.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12078.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/24</span> <!-- End Header --><a id="i1006517"></a><a id="APPCI216"></a>
<h1 class="chapter"><span class="secnum">11</span> Gateway Configuration Using SNA Communication Protocol</h1>
<p>This chapter describes how to configure the Oracle database for a gateway using the SNA protocol on your UNIX platform. It also shows you how to configure commit-confirm, should you choose to implement it.</p>
<p>This chapter provides the steps necessary to verify installation and configuration of the gateway components, including optional commit-confirm. It contains the following sections:</p>
<ul>
<li>
<p><a href="#BGBEHCGJ">Before You Begin</a></p>
</li>
<li>
<p><a href="#i1007045">Preparing to Configure a Gateway Installation/Upgrade</a></p>
</li>
<li>
<p><a href="#i1015617">Oracle Database Configuration: First-Time Gateway Installations</a></p>
</li>
<li>
<p><a href="#i1015445">Upgrading or Migrating the Oracle Database from Previous Gateways</a></p>
</li>
<li>
<p><a href="#i1015166">Configuring the Oracle Database for Gateways to Coexist</a></p>
</li>
<li>
<p><a href="#i1007404">Optional Configuration Steps to Permit Multiple Users</a></p>
</li>
<li>
<p><a href="#i1007585">Configuring the Gateway</a></p>
</li>
<li>
<p><a href="#CHDIJCGE">Configuring Commit-Confirm</a></p>
</li>
<li>
<p><a href="#i1008870">Verifying the Gateway Installation and OLTP Configuration</a></p>
</li>
<li>
<p><a href="#i1009126">Performing Postinstallation Procedures</a></p>
</li>
</ul>
<p><a id="sthref520"></a><a id="sthref521"></a><a id="sthref522"></a>Configuring the Oracle Database Gateway for APPC using SNA involves working with the following components:</p>
<ul>
<li>
<p>Oracle database</p>
</li>
<li>
<p>UNIX system</p>
</li>
<li>
<p>Network</p>
</li>
<li>
<p>OLTP</p>
</li>
</ul>
<a id="BGBEHCGJ"></a><a id="APPCI217"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.1</span> Before You Begin</h2>
<p>This chapter requires you to input parameters unique to your system to properly configure the gateway and SNA communications interface.</p>
<p>Refer to <a href="ape.htm#g635941">Appendix D, "Configuration Worksheet"</a> for a worksheet listing the installation parameters that you need to know before you can complete the configuration process. Ask your network administrator to provide you with these unique parameter names before you begin.</p>
</div>
<!-- class="sect1" -->
<a id="i1007045"></a><a id="APPCI218"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.2</span> Preparing to Configure a Gateway Installation/Upgrade</h2>
<p>There are three ways to establish the gateway-Oracle database relationship when you are installing or upgrading or migrating the gateway:</p>
<ul>
<li>
<p><a href="#i1012371">When Oracle Database and the Gateway Are Installed in the Same ORACLE_HOME</a></p>
</li>
<li>
<p><a href="#i1012376">When Oracle Database and the Gateway Are Installed on Separate Systems</a></p>
</li>
<li>
<p><a href="#i1012381">When Oracle Database and the Gateway Are on the Same System but in Different Directories</a></p>
</li>
</ul>
<p><a id="sthref523"></a><a id="sthref524"></a><a id="sthref525"></a>Depending on the location of the gateway and the Oracle database, you might need to transfer some of the gateway administrative files to the location where Oracle database is installed.</p>
<p>Follow the instructions corresponding to your combination of the gateway-Oracle database locations listed below.</p>
<p class="subhead1"><a id="i1012371"></a><a id="APPCI362"></a>When Oracle Database and the Gateway Are Installed in the Same ORACLE_HOME</p>
<p>You do not need to transfer files. Proceed to <a href="#i1015617">Section 11.3, "Oracle Database Configuration: First-Time Gateway Installations"</a>.</p>
<p class="subhead1"><a id="i1012376"></a><a id="APPCI363"></a>When Oracle Database and the Gateway Are Installed on Separate Systems</p>
<p>You need to perform the following tasks if Oracle database and the gateway are installed on separate systems:</p>
<ol>
<li>
<p>Locate the gateway administrative files in the gateway <code>$ORACLE_HOME/dg4appc/admin</code> directory. All files in this directory that have the <code>.sql</code>, <code>.pkh</code>, or <code>.pkb</code> suffixes must be copied into a similarly-named directory in the Oracle database Oracle home directory.</p>
</li>
<li>
<p>Now locate the gateway demo files and subdirectories in the <code>$ORACLE_HOME/dg4appc/demo</code> directory of the gateway. Copy the <code>pgavsn.sql</code> and <code>pgaecho.sql</code> files into a similarly named directory in Oracle database.</p>
</li>
<li>
<p>Copy the other subdirectories and files related to your installed OLTP on your remote host. For example, if you have CICS as your only OLTP, then copy the <code>$ORACLE_HOME/dg4appc/demo/CICS</code> gateway files into a similarly named directory in the Oracle database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before transferring the files from the <code>$ORACLE_HOME/dg4appc/demo</code> directory, ensure that you have generated your required TIPs. You need to transfer the TIPs as well.
<p>Refer to the <a class="olink APPUG" href="../e12071/toc.htm"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a> for information about generating TIPs using Procedural Gateway Administrative Utility (PGAU).</p>
</div>
</li>
</ol>
<p class="subhead1"><a id="i1012381"></a><a id="APPCI364"></a>When Oracle Database and the Gateway Are on the Same System but in Different Directories</p>
<p>You must change your gateway Oracle home to the Oracle home directory of Oracle database.</p>
<ol>
<li>
<p>For example, if your gateway Oracle home is set as follows:</p>
<pre>
$ echo $ORACLE_HOME
/oracle/pga/11.2
</pre>
<p>and your server Oracle home is located in the <code>/oracle/pga/11.2</code> directory, then you need to do the following:</p>
<pre>
$ ORACLE_HOME=/oracle/pga/11.2; export ORACLE_HOME
</pre></li>
<li>
<p>Now create the directories with the following commands:<a id="sthref526"></a></p>
<pre>
$ cd $ORACLE_HOME
$ mkdir dg4appc
$ mkdir dg4appc/admin
</pre></li>
<li>
<p>Use whatever file transfer mechanism is available on your system to copy all of the <code>.sql</code>, <code>.pkh</code>, and <code>.pkb</code> files from the gateway Oracle home <code>$ORACLE_HOME/dg4appc/admin</code> directory to the Oracle database Oracle home <code>$ORACLE_HOME/dg4appc/admin</code> directory.</p>
</li>
<li>
<p>You might also transfer the demo files from the gateway directory to the Oracle database directory. Copy the files and directory recursively from the gateway Oracle home <code>$ORACLE_HOME/dg4appc/demo</code> directory to the Oracle database <code>$ORACLE_HOME/dg4appc/demo</code> directory.</p>
<p>For example:</p>
<pre>
$ cp -p -R /oracle/pga/11.2/dg4appc/demo $ORACLE_HOME/dg4appc
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before transferring the files from the <code>$ORACLE_HOME/dg4appc/demo</code> directory, ensure that you have generated your required TIPs. You need to transfer the TIPs as well.
<p>Refer to the <a class="olink APPUG" href="../e12071/toc.htm"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a> for information about generating TIPs using PGAU.</p>
</div>
</li>
</ol>
<p>If this is a first-time installation, proceed with <a href="#i1015617">Section 11.3, "Oracle Database Configuration: First-Time Gateway Installations"</a>.</p>
<p>If this is an upgrade, proceed with <a href="#i1015445">Section 11.4, "Upgrading or Migrating the Oracle Database from Previous Gateways"</a>.</p>
<p>Following those steps, you might want to perform the <a href="#i1007404">Section 11.6, "Optional Configuration Steps to Permit Multiple Users"</a>.</p>
</div>
<!-- class="sect1" -->
<a id="i1015617"></a><a id="APPCI219"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.3</span> Oracle Database Configuration: First-Time Gateway Installations</h2>
<p>Follow these steps to configure your <a id="sthref527"></a>Oracle database if you have installed Oracle Database Gateway for APPC for the first time:</p>
<ol>
<li>
<p>Ensure that the <a id="sthref528"></a><a id="sthref529"></a><a id="sthref530"></a><code>UTL_RAW</code> PL/SQL package has been installed on your Oracle database. <a id="sthref531"></a><a id="sthref532"></a>All PGAU-generated TIP specifications use <code>UTL_RAW</code>, which provides routines for manipulating raw data.</p>
<ol>
<li>
<p>Use <a id="sthref533"></a>SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p>From SQL*Plus, enter the following command:</p>
<pre>
SQL&gt; DESCRIBE UTL_RAW
</pre>
<p>The <code>DESCR<a id="sthref534"></a>IBE</code> statement produces output on your screen. If you browse through the output, you should see some functions, including a compare function. If you do not see this output, then continue the <code>UTL_RAW</code> installation by performing step <a href="#i1009705">d</a> below.</p>
<p>If the <a id="sthref535"></a><a id="sthref536"></a><code>DESCRIBE</code> statement indicates success, then your Oracle database has <a id="sthref537"></a><code>UTL_RAW</code> installed and you can proceed to Step&nbsp;<a href="#i1009709">2</a>.</p>
</li>
<li>
<p>Use <a id="sthref538"></a>SQL*Plus to connect to the Oracle database as the SYS user.</p>
</li>
<li>
<p><a id="i1009705"></a>From SQL*Plus, run the <a id="sthref539"></a><a id="sthref540"></a><code>utlraw.sql</code> and <a id="sthref541"></a><a id="sthref542"></a><code>prvtrawb.plb</code> scripts in the Oracle database <code>$ORACLE_HOME/rdbms/admin</code> directory, in the following order:</p>
<pre>
SQL&gt; @$ORACLE_HOME/rdbms/admin/utlraw.sql
SQL&gt; @$ORACLE_HOME/rdbms/admin/prvtrawb.plb
</pre></li>
</ol>
</li>
<li>
<p><a id="i1009709"></a>Ensure that the <a id="sthref543"></a><a id="sthref544"></a>DBMS_OUTPUT standard PL/SQL <a id="sthref545"></a><a id="sthref546"></a><a id="sthref547"></a>package is enabled on <a id="sthref548"></a>Oracle database. The sample programs and installation verification programs on the distribution media use this standard package.</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p>From SQL*Plus, enter the following command:</p>
<pre>
SQL&gt; DESCRIBE DBMS_OUTPUT
</pre></li>
</ol>
<p>The <a id="sthref549"></a><a id="sthref550"></a><code>DESCRIBE</code> statement produces output on your screen. If you browse through that output, you should see some functions, including a <a id="sthref551"></a><a id="sthref552"></a><code>put_line</code> function.</p>
<p>If you do not see this output, then you must create the <code>DBMS_OUTPUT</code> package. Refer to the <a class="olink EXPRN" href="../../appdev.112/e14919/toc.htm"><span class="italic">Oracle Database Rules Manager and Expression Filter Developer's Guide</span></a> for more information about creating the <code>DBMS_OUTPUT</code> package. After successful installation of the <code>DBMS_OUTPUT</code> package, issue the <code>DESCRIBE</code> statement.</p>
<p>If the <code>DESCRIBE</code> statement indicates success, then your Oracle database has <code>DBMS_OUTPUT</code> created, and you can proceed to Step&nbsp;3.</p>
</li>
<li>
<p>Install the <a id="sthref553"></a><a id="sthref554"></a><code>UTL_PG</code> PL/SQL package. All <a id="sthref555"></a><a id="sthref556"></a>PGAU-generated TIP specifications use <code>UTL_PG</code>, which provides routines for performing numeric conversions to and from raw data.</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <a id="sthref557"></a><a id="sthref558"></a><code>utlpg.sql</code> and <code><a id="sthref559"></a><a id="sthref560"></a>prvtpgb.plb</code> scripts in the Oracle database <code>$ORACLE_HOME/rdbms/admin</code> directory, in the following order:</p>
<pre>
SQL&gt; @$ORACLE_HOME/rdbms/admin/utlpg.sql
SQL&gt; @$ORACLE_HOME/rdbms/admin/prvtpgb.plb
</pre></li>
</ol>
</li>
<li>
<p>I<a id="sthref561"></a>nstall the Heterogeneous Services (HS) catalogs.</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p>Enter the following command:</p>
<pre>
SQL&gt; DESCRIBE HS_FDS_CLASS
</pre>
<p>The <code>DESCRIBE</code> statement produces output on your screen. If the <code>DESCRIBE</code> statement indicates success, then heterogeneous services catalogs have been created on your Oracle database and you can proceed to Step&nbsp;5, otherwise follow the next step only if the <code>DESCRIBE</code> statement does not indicate success. Step c creates the Heterogeneous Services catalog.</p>
</li>
<li>
<p><a id="BGBCBAGC"></a>If it is necessary to create the Heterogeneous Services catalog, enter the following command:</p>
<pre>
SQL&gt; $ORACLE_HOME/rdbms/admin/caths.sql
</pre></li>
</ol>
</li>
<li>
<p><a id="BGBGGAIG"></a><a id="sthref562"></a><a id="sthref563"></a>Create a public database link to access Oracle Database Gateway for APPC:<a id="sthref564"></a></p>
<p>Use <a id="sthref565"></a>SQL*Plus to connect to the <a id="sthref566"></a>Oracle database as the <code>SYSTEM</code> user. You can use the following SQL*Plus<a id="sthref567"></a> sample whether the Oracle database and the gateway are on the same system or on different systems. In the following sample, <code>pgasrv</code> is the <code><span class="codeinlineitalic">tns_name_entry</span></code> that will be assigned to the gateway when you modify the <code><a id="sthref568"></a><a id="sthref569"></a>tnsnames.ora</code> file later in this chapter.</p>
<pre>
SQL&gt; CREATE PUBLIC DATABASE LINK PGA USING '<span class="italic">PGASRV</span>'
</pre></li>
<li>
<p>Create the gateway administrator user <a id="sthref570"></a><code>PGAADMIN</code> and install the <a id="sthref571"></a>PG DD.</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as the <code>SYSTEM</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgacr8au.sql</code> <a id="sthref572"></a><a id="sthref573"></a>script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates the <code>PGAADMIN</code> user&nbsp;ID.</p>
<p>The initial password defined for <a id="sthref574"></a><code>PGAADMIN</code> is <code>PGAADMIN</code>. Use the <a id="sthref575"></a><a id="sthref576"></a><code>ALTER USER</code> command to change the password. For more information about password issues, refer to the <a class="olink SQLRF" href="../../server.112/e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgacr8au.sql
</pre></li>
<li>
<p>Use SQL*Plus to connect to the Oracle database as user <code>PGAADMIN</code>.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgddcr8.sql</code> <a id="sthref577"></a><a id="sthref578"></a><a id="sthref579"></a>script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script installs the PG&nbsp;DD.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgddcr8.sql
</pre></li>
<li>
<p>From SQL*Plus, connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p><a id="sthref580"></a>Grant execution privileges on <a id="sthref581"></a><code>DBMS_PIPE</code> to <code>PGAADMIN</code>:<a id="sthref582"></a></p>
<pre>
SQL&gt; GRANT EXECUTE ON DBMS_PIPE TO PGAADMIN
</pre></li>
</ol>
</li>
<li>
<p>Install the <a id="sthref583"></a><a id="sthref584"></a>TIP trace access PL/SQL routines. These routines require that the <a id="sthref585"></a>DBMS_PIPES standard PL/SQL package is installed and that <a id="sthref586"></a><code>PGAADMIN</code> has execute privileges on it. For more information on <code>DBMS_PIPES</code>, refer to the <a class="olink EXPRN" href="../../appdev.112/e14919/toc.htm"><span class="italic">Oracle Database Rules Manager and Expression Filter Developer's Guide</span></a>.</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the <a id="sthref587"></a>Oracle database as user <code>PGAADMIN</code>.</p>
</li>
<li>
<p>From SQL*Plus, run the <code><a id="sthref588"></a>pgatiptr.sql</code> script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates<a id="sthref589"></a> PL/SQL routines that can be called to read and purge trace information created by PGAU-generated <a id="sthref590"></a>TIP specifications. It also creates public synonyms for these routines. The script prompts you for the necessary user&nbsp;IDs and passwords.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgatiptr.sql
</pre></li>
</ol>
</li>
<li>
<p>Install the <code>GPGLOCAL</code> package. This package is required for compilation and execution of all PGAU-generated <a id="sthref591"></a>TIP specifications. <a id="sthref592"></a><a id="sthref593"></a><a id="sthref594"></a>TIP developers should be granted execute privileges on <a id="sthref595"></a><code>GPGLOCAL</code> (refer to Step&nbsp;<a href="#i1012843">3</a> of <a href="#i1007404">"Optional Configuration Steps to Permit Multiple Users"</a>).</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as user <a id="sthref596"></a><code>PGAADMIN</code>.</p>
</li>
<li>
<p><a id="i1011541"></a>From SQL*Plus, run the <code>gpglocal.pkh</code> script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script compiles the <code>GPGLOCAL</code> package specification.<a id="sthref597"></a><a id="sthref598"></a></p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/gpglocal.pkh
</pre></li>
<li>
<p><a id="i1011545"></a>From SQL*Plus, run the <code>gpglocal.pkb</code> script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script compiles the <code>GPGLOCAL</code> package body.<a id="sthref599"></a><a id="sthref600"></a></p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/gpglocal.pkb
</pre></li>
</ol>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1015445"></a><a id="APPCI220"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.4</span> Upgrading or Migrating the Oracle Database from Previous Gateways<a id="sthref601"></a><a id="sthref602"></a></h2>
<p>Follow these instructions only if you have a previous version of the Oracle Database Gateway for APPC installed on your system and need to configure it for Release 11.2 of the gateway.</p>
<a id="i1012247"></a>
<ol>
<li>
<p>Upgrade your Oracle Database Gateway for APPC to current version levels as follows:</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p><a id="i1010080"></a>Install the <code>UTL_RAW</code> package body. From SQL*Plus, run the <code>prvtrawb.plb</code> <a id="sthref603"></a><a id="sthref604"></a>script from the <code>$ORACLE_HOME/rdbms/admin</code> directory. This script upgrades the <code>UTL_RAW</code> package body.</p>
<pre>
SQL&gt; @$ORACLE_HOME/rdbms/admin/prvtrawb.plb
</pre></li>
<li>
<p><a id="i1010098"></a>Install the <code>UTL_PG</code> package body. From SQL*Plus, run the <code>prvtpgb.plb</code> <a id="sthref605"></a><a id="sthref606"></a>script from the <code>$ORACLE_HOME/rdbms/admin</code> directory.<a id="sthref607"></a><a id="sthref608"></a> This script upgrades the <code>UTL_PG</code> package body.</p>
<pre>
SQL&gt; @$ORACLE_HOME/rdbms/admin/prvtpgb.plb
</pre>
<p>The <code>prvtrawb.plb</code> and <code>prvtpgb.plb</code> scripts should complete successfully. If they fail because specifications do not exist or were invalidated, then consider reinstalling the package specifications as directed in the following section.</p>
</li>
</ol>
</li>
</ol>
<a id="APPCI221"></a>
<div class="sect2"><a id="sthref609"></a>
<h3 class="sect2"><span class="secnum">11.4.1</span> If You Must <a id="sthref610"></a><a id="sthref611"></a>Reinstall Package Specifications</h3>
<p><a id="i1010106"></a>If the <a id="sthref612"></a><a id="sthref613"></a><code>UTL_RAW</code> or <a id="sthref614"></a><a id="sthref615"></a><code>UTL_PG</code> package has been invalidated or deinstalled, the <code>prvtrawb.plb</code> and <code>prvtpgb.plb</code> scripts might not complete successfully and you might have to reinstall <a id="sthref616"></a><a id="sthref617"></a><a id="sthref618"></a>the package specifications.</p>
<p>If you do reinstall the package specifications, any dependent objects (such as existing user TIPs and client applications) are invalidated and will subsequently need to be recompiled. The impact of this is a one-time performance delay while recompilation of the TIPs and dependent client applications proceeds.</p>
<div class="infobox-note">
<p class="notep1">Important:</p>
Before proceeding with reinstallation of the package scripts, make sure that you are in the <code>$ORACLE_HOME/dg4appc/admin</code> directory.</div>
<p>TIPs were split into separate specification and body files in release&nbsp;3.3 to avoid cascaded recompilations in later releases.</p>
<dl>
<dd><a id="sthref619"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Run the Following Scripts before Proceeding with the PGAU Upgrade</dt>
<dd>
<p>From SQL*Plus, run the <code>utlraw.sql</code> script:</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the Oracle database as the <code>SYS</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <code><a id="sthref620"></a><a id="sthref621"></a>utlraw.sql</code> and <code><a id="sthref622"></a><a id="sthref623"></a>utlpg.sql</code> scripts in Oracle database <code>$ORACLE_HOME/rdbms/admin</code> directory, in the following order, to upgrade their respective package specifications:<a id="sthref624"></a><a id="sthref625"></a><a id="sthref626"></a><a id="sthref627"></a></p>
<pre>
SQL&gt; @$ORACLE_HOME/rdbms/admin/utlraw.sql
SQL&gt; @$ORACLE_HOME/rdbms/admin/utlpg.sql
</pre></li>
</ol>
</dd>
<dd><a id="sthref628"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Repeat Installation of UTL_RAW and UTL_PG Package Body</dt>
<dd>
<p>After the scripts have run, repeat Steps <a href="#i1012247">0</a><a href="#i1010080">b</a> and <a href="#i1012247">0</a><a href="#i1010098">c</a> in <a href="#i1015445">Section 11.4, "Upgrading or Migrating the Oracle Database from Previous Gateways"</a>. Then proceed to the section titled <a href="#i1014526">"Upgrading PGAU From Previous Gateway Releases"</a>.</p>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
TIPs and dependent client applications must be recompiled after reinstallation of the package specifications. Refer to the "Compiling a TIP" section in Chapter&nbsp;3 of the <a class="olink APPUG300" href="../../gateways.112/e12071/tip.htm#APPUG300"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a> for information about compiling TIPs.</div>
</dd>
</dl>
</div>
<!-- class="sect2" -->
<a id="i1014526"></a><a id="APPCI222"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">11.4.2</span> Upgrading PGAU From Previous Gateway Releases</h3>
<p>Upgrade the <a id="sthref629"></a>PG DD as follows before executing the new PGAU:</p>
<ol>
<li>
<p>If necessary, use SQL*Plus to connect to the Oracle database as user <code>PGAADMIN</code>.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgddupgr.sql</code> <a id="sthref630"></a><a id="sthref631"></a>script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script upgrades the PG&nbsp;DD.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1015166"></a><a id="APPCI223"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.5</span> Configuring the Oracle Database for Gateways to Coexist</h2>
<p><a id="sthref632"></a>You might have an older version of the gateway already installed. Be aware that although a version&nbsp;10 gateway can communicate with a version&nbsp;9 data dictionary (PGDD), a version&nbsp;9 gateway cannot communicate with a version&nbsp;10 data dictionary. Thus, if you upgrade your data dictionary to a version&nbsp;10, no gateways which were configured with a version&nbsp;9 data dictionary will be able to communicate with it.</p>
</div>
<!-- class="sect1" -->
<a id="i1007404"></a><a id="APPCI224"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.6</span> Optional Configuration Steps<a id="sthref633"></a><a id="sthref634"></a> to Permit Multiple Users</h2>
<p>The following configuration steps are optional. Perform these steps if you want to allow users other than <a id="sthref635"></a><code>PGAADMIN</code> to perform <a id="sthref636"></a>PG DD operations using PGAU.</p>
<ol>
<li>
<p>Create <a id="sthref637"></a><a id="sthref638"></a>public synonyms for the PG DD to allow other users to access the tables:</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as the <code>SYSTEM</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <a id="sthref639"></a><a id="sthref640"></a><code>pgddcr8s.sql</code> script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates public synonyms for the PG DD.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgddcr8s.sql
</pre></li>
</ol>
</li>
<li>
<p>Create roles for accessing the PG DD, performing definitions of transactions, and generating <a id="sthref641"></a>TIP specifications. The <code>PGAADMIN</code> user can grant these roles to other users as necessary.</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as user <code>PGAADMIN</code>.</p>
</li>
<li>
<p>From SQL*Plus, run the <code><a id="sthref642"></a><a id="sthref643"></a>pgddcr8r.sql</code> script in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates two roles, <code>PGDDDEF</code> and <code>PGDDGEN</code>. The <a id="sthref644"></a><a id="sthref645"></a><code>PGDDDEF</code> role provides <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> privileges against some of the <a id="sthref646"></a>PG DD tables, and <code>SELECT</code> privileges against others, and allows execution of the PGAU <code>DEFINE</code>, <code>GENERATE</code>, <code>REDEFINE</code>, <code>REPORT</code>, and <code>UNDEFINE</code> statements. The <a id="sthref647"></a><a id="sthref648"></a><code>PGDDGEN</code> role provides select privileges against the PG DD tables, and allows execution of the PGAU <code>GENERATE</code> and <code>REPORT</code> statements only.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgddcr8r.sql
</pre></li>
</ol>
</li>
<li>
<p><a id="i1012843"></a><a id="sthref649"></a><a id="sthref650"></a><a id="sthref651"></a><a id="sthref652"></a>Grant access to PGA required packages.</p>
<p><a id="sthref653"></a><a id="sthref654"></a>TIP developers require access to the following PL/SQL packages, which are shipped with the <a id="sthref655"></a>Oracle database:</p>
<ul>
<li>
<p><a id="sthref656"></a><code>DBMS_PIPE</code> in the <code>$ORACLE_HOME/rdbms/admin<a id="sthref657"></a></code> directory</p>
</li>
<li>
<p><a id="sthref658"></a><code>UTL_RAW</code> in the <code>$ORACLE_HOME/rdbms/admin<a id="sthref659"></a></code> directory</p>
</li>
<li>
<p><a id="sthref660"></a><code>UTL_PG</code> in the <code>$ORACLE_HOME/rdbms/admin</code><a id="sthref661"></a><a id="sthref662"></a> directory</p>
</li>
</ul>
<p>Explicit grants to execute these packages must be made to TIP developers.</p>
<p>These grants can be private as in the following example:</p>
<pre>
$ sqlplus SYS/<span class="italic">pw@database_specification_string</span> 
SQL&gt; GRANT EXECUTE ON UTL_RAW TO <span class="italic">tip_developer</span>; 
SQL&gt; GRANT EXECUTE ON UTL_PG TO <span class="italic">tip_developer</span>; 
SQL&gt; GRANT EXECUTE ON DBMS_PIPE TO <span class="italic">tip_developer;</span> 
SQL&gt; CONNECT PGAADMIN/<span class="italic">pw@database_specification_string</span> 
SQL&gt; GRANT EXECUTE ON PGAADMIN.PURGE_TRACE TO <span class="italic">tip_developer</span>; 
SQL&gt; GRANT EXECUTE ON PGAADMIN.READ_TRACE TO <span class="italic">tip_developer</span>; 
SQL&gt; GRANT EXECUTE ON PGAADMIN.GPGLOCAL TO <span class="italic">tip_developer;</span> 
SQL&gt; exit
</pre>
<p>Alternatively, these grants can be public as in the following example:</p>
<pre>
$ sqlplus SYS/pw@<span class="italic">database_specification_string</span> 
SQL&gt; GRANT EXECUTE ON UTL_RAW TO PUBLIC;
SQL&gt; GRANT EXECUTE ON UTL_PG TO PUBLIC;
SQL&gt; GRANT EXECUTE ON DBMS_PIPE to PUBLIC;
SQL&gt; CONNECT PGAADMIN/<span class="italic">pw@database_specification_string</span> 
SQL&gt; GRANT EXECUTE ON PGAADMIN.PURGE_TRACE TO PUBLIC;
SQL&gt; GRANT EXECUTE ON PGAADMIN.READ_TRACE TO PUBLIC;
SQL&gt; GRANT EXECUTE ON PGAADMIN.GPGLOCAL TO PUBLIC;
SQL&gt; EXIT
</pre>
<p>You can use either private or public grants. Both are sufficient for using PGA. Public grants are easier and can be performed now. If you use private grants, then they must be issued each time a new TIP developer user&nbsp;ID is created.<a id="sthref663"></a><a id="sthref664"></a></p>
<p>SQL scripts for performing these grants are provided in the <code>$ORACLE_HOME/dg4appc/admin</code> directory. The<a id="sthref665"></a><a id="sthref666"></a> <code><a id="sthref667"></a><a id="sthref668"></a>pgddapub.sql</code> script performs these grants for public access to the packages. The <code><a id="sthref669"></a><a id="sthref670"></a><a id="sthref671"></a><a id="sthref672"></a>pgddadev.sql</code> script performs the grants for private access to the packages by a single TIP developer. If you are going to use private grants, then you must run the <code>pgddadev.sql</code> script once for each TIP developer user&nbsp;ID:</p>
<ol>
<li>
<p>Use SQL*Plus to connect to the Oracle database as user <code>PGAADMIN</code>.</p>
</li>
<li>
<p>From SQL*Plus, run the appropriate script (<code>pgddapub.sql</code> or <code>pgddadev.sql</code>) from the <code>$ORACLE_HOME/dg4appc/admin</code> directory. The script performs the necessary grants as described earlier. You are prompted for the required user&nbsp;IDs, passwords, and database specification strings.</p>
<p>If you are using private grants, then repeat this step for each user&nbsp;ID requiring access to the packages.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgddapub.sql
SQL&gt; @$ORACLE_HOME/dg4appc/admin/pgddadev.sql
</pre></li>
</ol>
</li>
<li>
<p><a id="sthref673"></a><a id="sthref674"></a>If you are upgrading from a previous release of the gateway, and if you want to upgrade your existing <a id="sthref675"></a><a id="sthref676"></a><a id="sthref677"></a>TIPs with new function and maintenance, then regenerate existing T<a id="sthref678"></a>IP specifications using the <a id="sthref679"></a>PGAU <code>GENERATE</code> statement.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <a id="sthref680"></a>PGAU has been enhanced to automatically upgrade existing PG DD entries <a id="sthref681"></a><a id="sthref682"></a>with a new attribute when a <a id="sthref683"></a>PGAU <code>GENERATE</code> command is executed. To support this enhancement, add a new privilege to the <a id="sthref684"></a><code>PGDDGEN</code> role. To do this, as the <code>PGAADMIN</code> user, use SQL*Plus to connect to the Oracle database where the PG&nbsp;DD is stored. Then issue the following SQL command:
<pre>
SQL&gt; GRANT INSERT ON PGA_DATA_VALUES TO PGDDGEN
</pre></div>
<ol>
<li>
<p>Invoke PGAU in the directory path where the PGAU control files are generated and where TIPs are stored:</p>
<pre>
$ pgau
PGAU&gt; CONNECT PGAADMIN/pgaadmin@<span class="italic">database_specification_string</span> 
PGAU&gt; GENERATE <span class="italic">tranname</span> 
PGAU&gt; EXIT
</pre></li>
</ol>
<p>For more information about the <code>GENERATE</code> command, refer to the PGAU <code>GENERATE</code> command section in Chapter 2, of the <a class="olink APPUG200" href="../../gateways.112/e12071/admin_util.htm#APPUG200"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a>.</p>
<p>Note that it is not necessary to define the PG DD entries again.</p>
</li>
<li>
<p>Invoke SQL*Plus in the same directory path where the newly-generated TIP specifications are stored.</p>
<pre>
$ sqlplus <span class="italic">tip_owner/pw@database_specification_string</span> 
SQL&gt; @<span class="italic">tipname.</span>pkh 
SQL&gt; @<span class="italic">tipname</span>.pkb
SQL&gt; exit
</pre>
<p><a id="sthref685"></a><a id="sthref686"></a><a id="sthref687"></a>PGAU <code>GENERATE</code> produces the TIP in two output files: a specification and a body. You must compile both, first the specification and then the body.</p>
<p>For more information about the <code>GENERATE</code> command, refer to the PGAU <code>GENERATE</code> command section in Chapter 2, of the <a class="olink APPUG200" href="../../gateways.112/e12071/admin_util.htm#APPUG200"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a>.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1007585"></a><a id="APPCI225"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.7</span> Configuring the Gateway</h2>
<p>To configure the gateway, perform the following steps:</p>
<ol>
<li>
<p>Tailor the Oracle Database Gateway for APPC parameters.</p>
<p>Parameters specific to the gateway are supplied in the gateway parameter file, <code><a id="sthref688"></a><a id="sthref689"></a>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code>, which is in the <a id="sthref690"></a><code>$ORACLE_HOME/dg4appc/admin</code> directory. A sample gateway parameter <a id="sthref691"></a><a id="sthref692"></a><a id="sthref693"></a>file, <a id="sthref694"></a><a id="sthref695"></a><code>initPGA.ora</code> is provided in this subdirectory.<a id="sthref696"></a><a id="sthref697"></a><a id="sthref698"></a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
In the <a id="sthref699"></a><a id="sthref700"></a><code>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file, substitute your <code>dg4appc</code> SID name for "<code><span class="codeinlineitalic">sid</span></code> " in this file name.
<p>The <code><a id="sthref701"></a><a id="sthref702"></a>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file contains both APPC and TCP/IP parameters, separated by a description. You must modify the <code><a id="sthref703"></a><a id="sthref704"></a>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file by deleting the TCP/IP parameters. Refer to <a href="apa.htm#g636937">Appendix A, "Gateway Initialization Parameters for SNA Protocol"</a> for the valid APPC parameters.</p>
</div>
<p>The parameters fall into two categories:</p>
<ul>
<li>
<p>Gateway initialization <a id="sthref705"></a><a id="sthref706"></a>parameters</p>
<p>These parameters control the general operation of the gateway in the Oracle environment.</p>
<div class="infobox-note">
<p class="notep1">Important:</p>
Before performing the following step, refer to <a href="apa.htm#g636937">Appendix A, "Gateway Initialization Parameters for SNA Protocol"</a> for information about tailoring gateway initialization and PGA parameters. Pay special attention to the information about using the <code><a id="sthref707"></a>PGA_CAPABILITY</code> parameter.</div>
</li>
<li>
<p>PGA <a id="sthref708"></a><a id="sthref709"></a>parameters</p>
<p>PGA parameters control the APPC interface portion of the gateway. Use the <a id="sthref710"></a><a id="sthref711"></a><code>SET</code> gateway initialization parameter to specify PGA parameters. Oracle recommends that you group all <code>SET</code> commands<a id="sthref712"></a><a id="sthref713"></a> for PGA parameters at the end of the <code><a id="sthref714"></a><a id="sthref715"></a>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Misspelled parameters are ignored<a id="sthref716"></a>. However, if the <code>$ORACLE_HOME/dg4appc/admin/init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file is missing, all calls to the gateway fail and return a <code>PGA-20928</code> error.</div>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CHDIJCGE"></a><a id="APPCI226"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">11.8</span> Configuring Commit-Confirm</h2>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you are planning to implement commit-confirm, read the detailed explanation of commit-confirm's capabilities in Chapter&nbsp;5 of the <a class="olink APPUG500" href="../../gateways.112/e12071/com_con.htm#APPUG500"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a>, "Implementing Commit-Confirm (SNA Only) before proceeding.</div>
<p>Follow these steps to configure the commit-confirm components. The steps for <a id="sthref717"></a>configuring commit-confirm include:</p>
<ul>
<li>
<p>Configuring the Oracle database where the gateway server will store its transaction log information</p>
</li>
<li>
<p>Configuring the gateway initialization parameters</p>
</li>
<li>
<p>Configuring the OLTP</p>
</li>
</ul>
<p>All of these steps must be performed before attempting to use any applications that use commit-confirm.<a id="sthref718"></a></p>
<a id="i1015006"></a><a id="APPCI227"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">11.8.1</span> Configuring the Oracle Database for Commit-Confirm</h3>
<p>The <a id="sthref719"></a><a id="sthref720"></a>Oracle database installation where the gateway server will store its transaction log information should ideally be on the same system where the gateway runs. The configuration of the server consists of creating the gateway DBA user, creating the commit-confirm log tables and creating the <a id="sthref721"></a>PL/SQL stored procedure used by the gateway server for logging transactions.<a id="sthref722"></a></p>
<p>The <code><a id="sthref723"></a><a id="sthref724"></a>pgaccau.sql</code> script from the <code>$ORACLE_HOME/dg4appc/admin</code> directory creates the gateway DBA user&nbsp;ID. The default user&nbsp;ID is <code>PGADBA</code> with the initial password set to <code>PGADBA</code>. If you want to change the user&nbsp;ID or initial password, you must modify the script.</p>
<ol>
<li>
<p>Use <a id="sthref725"></a>SQL*Plus to connect to the Oracle database as the <code>SYSTEM</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgaccau.sql</code> script from the <code>$ORACLE&shy;_HOME/dg4appc/admin</code> directory. This script creates the gateway DBA user&nbsp;ID. If you want to change the password at any time after running this script, you can use the <code>ALTER USER</code> command to change the password. For further information, refer to the <a class="olink SQLRF" href="../../server.112/e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
</li>
<li>
<p>Use SQL*Plus to connect to Oracle database as the <code>PGADBA</code> user.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgaccpnd.sql</code> script from the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates the <code>PGA_CC_PENDING</code> table used by the gateway server for its commit-confirm transaction log.</p>
</li>
<li>
<p>From SQL*Plus, run the <code>pgacclog.sql</code> script from the <code>$ORACLE_HOME/dg4appc/admin</code> directory. This script creates the <code>PGA_CC_LOG</code> <a id="sthref726"></a>PL/SQL stored procedure used by the gateway server for updating the <code>PGA_CC_PENDING</code> table.</p>
</li>
<li>
<p>Disconnect from Oracle database.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1015037"></a><a id="APPCI228"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">11.8.2</span> Configuring Gateway Initialization Parameters for Commit-Confirm</h3>
<p><a id="sthref727"></a><a id="sthref728"></a><a id="sthref729"></a>The gateway initialization parameters are described in <a href="apa.htm#g636937">Appendix A, "Gateway Initialization Parameters for SNA Protocol"</a>. The parameters necessary for commit-confirm support in the gateway are:</p>
<ul>
<li>
<p><code>PGA_CAPABILITY</code></p>
</li>
<li>
<p><code>PGA_LOG_DB</code></p>
</li>
<li>
<p><code>PGA_LOG_USER</code></p>
</li>
<li>
<p><code>PGA_LOG_PASS</code></p>
</li>
<li>
<p><code>PGA_RECOVERY_USER</code></p>
</li>
<li>
<p><code>PGA_RECOVERY_PASS</code></p>
</li>
<li>
<p><code>PGA_RECOVERY_TPNAME</code></p>
</li>
</ul>
<p>These parameters should be added to your <a id="sthref730"></a><a id="sthref731"></a><code>init</code><code><span class="codeinlineitalic">sid</span></code>.<code>ora</code> file, where <code><span class="codeinlineitalic">sid</span></code> is the gateway SID for your commit-confirm gateway.</p>
</div>
<!-- class="sect2" -->
<a id="i1015053"></a><a id="APPCI229"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">11.8.3</span> Configuring the OLTP for Commit-Confirm</h3>
<p>Configuration of the OLTP includes defining and installing the following:<a id="sthref732"></a><a id="sthref733"></a></p>
<ul>
<li>
<p>Commit-confirm transaction log database</p>
</li>
<li>
<p>Commit-confirm forget or recovery transaction</p>
</li>
<li>
<p>Sample commit-confirm applications provided with the gateway</p>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
A restart of the OLTP may be necessary to implement the changes required for commit-confirm support. You should plan for this with your OLTP system administrator.</div>
</li>
</ul>
<p>Detailed instructions for configuring the Transaction Server for z/OS and IMS/TM are provided in the <code>$ORACLE_HOME/dg4appc/demo/CICS/README.doc</code> and <code>$ORACLE_HOME/dg4appc/demo/IMS/README.doc</code> files, respectively.</p>
<p>Refer<a id="sthref734"></a><a id="sthref735"></a> to Chapter 5, "Implementing Commit-Confirm (SNA Only)" in the <a class="olink APPUG500" href="../../gateways.112/e12071/com_con.htm#APPUG500"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a> for detailed information about commit-confirm. You will take steps to verify configuration of commit-confirm later in this chapter, in <a href="#CHDBAABC">"Verifying OLTP Configuration for Commit-Confirm"</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1008870"></a><a id="APPCI230"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.9</span> Verifying the Gateway Installation and OLTP Configuration</h2>
<p>To verify the gateway installation and the OLTP configuration, perform the following procedures after installing Oracle Database Gateway for APPC.<a id="sthref736"></a><a id="sthref737"></a> In addition, if you chose to configure commit-confirm, follow the steps to verify the OLTP configuration for commit-confirm.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If your <a id="sthref738"></a>database link name is not <code>PGA</code>, modify the demonstration <code>.sql</code> files to give them the particular database link name that you created in Step&nbsp;<a href="#BGBGGAIG">5</a> of <a href="#i1015617">"Oracle Database Configuration: First-Time Gateway Installations"</a>. You must modify the following <code>.sql</code> files:
<ul>
<li>
<p><a id="sthref739"></a><a id="sthref740"></a><code>pgavsn.sql</code></p>
</li>
<li>
<p><code><a id="sthref741"></a><a id="sthref742"></a>pgaecho.sql</code></p>
</li>
<li>
<p><code><a id="sthref743"></a><a id="sthref744"></a>pgacics.sql</code></p>
</li>
<li>
<p><code><a id="sthref745"></a><a id="sthref746"></a>pgaidms.sql</code></p>
</li>
<li>
<p><code><a id="sthref747"></a><a id="sthref748"></a>pgaims.sql</code></p>
</li>
<li>
<p><code><a id="sthref749"></a><a id="sthref750"></a>pgamvs.sql</code></p>
</li>
</ul>
</div>
<a id="APPCI231"></a>
<div class="sect2"><a id="sthref751"></a>
<h3 class="sect2"><span class="secnum">11.9.1</span> Verifying the Gateway Installation<a id="sthref752"></a><a id="sthref753"></a></h3>
<p>To verify the gateway software installation using the <a id="sthref754"></a>database link PGA previously created, perform the following steps:</p>
<ol>
<li>
<p>Using SQL*Plus, connect to your <a id="sthref755"></a>Oracle database as <a id="sthref756"></a><code>PGAADMIN.</code></p>
</li>
<li>
<p>Run <code>$ORACLE_HOME/dg4appc/demo/<a id="sthref757"></a>pgavsn.sql</code>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/demo/pgavsn.sql
</pre>
<p>The server version number banner appears at your terminal. The following output appears:</p>
<pre>
Oracle Database Gateway for APPC.
Version 11.2.0.0.2 Thu Jun 11 14:39:15 
2009<a id="sthref758"></a>

Copyright (c) Oracle Corporation 1979,2009.  All rights reserved.
</pre>
<p>PL/SQL procedure successfully completed.</p>
</li>
<li>
<p>Run <code>$ORACLE_HOME/dg4appc/demo/<a id="sthref759"></a>pgaecho.sql</code>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/demo/pgaecho.sql
</pre>
<p>You will receive the following output:</p>
<pre>
==&gt; Congratulations, your installation was successful. &lt;==
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="APPCI232"></a>
<div class="sect2"><a id="sthref760"></a>
<h3 class="sect2"><span class="secnum">11.9.2</span> Verifying the OLTP Configuration <a id="sthref761"></a><a id="sthref762"></a><a id="sthref763"></a></h3>
<p>The procedure for verifying your OLTP configuration varies, depending on which OLTP you are using and depending upon which platform the OLTP is running on. CICS Transaction Server for z/OS, IMS/TM, APPC/MVS, and z/OS are the currently supported <a id="sthref764"></a>OLTPs. Follow the instructions in the following sections for verifying installation:</p>
<ul>
<li>
<p><a href="#BGBIGDDJ">CICS Verification</a></p>
</li>
<li>
<p><a href="#BGBFIAGD">IMS/TM Verification</a></p>
</li>
<li>
<p><a href="#BGBIBACC">APPC/MVS Verification</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Attention:</p>
If you have not completed the file transfers detailed in <a href="#i1007045">"Preparing to Configure a Gateway Installation/Upgrade"</a>, complete them now, before proceeding to the next step.</div>
<a id="BGBIGDDJ"></a><a id="APPCI233"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">11.9.2.1</span> CICS Verification <a id="sthref765"></a><a id="sthref766"></a><a id="sthref767"></a></h4>
<p>If your OLTP is <a id="sthref768"></a><a id="sthref769"></a>CICS Transaction Server for z/OS, perform the following steps to verify the CICS configuration.</p>
<ol>
<li>
<p>To verify that the <a id="sthref770"></a>FLIP transaction is installed correctly, log on to your CICS Transaction Server for z/OS and enter the following transaction, replacing <code>FLIP</code> with the transaction ID you chose for <code>FLIP</code> when you configure your CICS Transaction Server for z/OS for the gateway:</p>
<pre>
FLIP<span class="italic"> </span>THIS MESSAGE
</pre>
<p>The following output appears:</p>
<pre>
EGASSEM SIHT PILF
</pre></li>
<li>
<p>Log on to HP-UX.</p>
</li>
<li>
<p>Modify the <code>pgacics.sql</code> file, which is located at <code>$ORACLE_HOME/dg4appc/demo/CICS/pgacics.sql</code>. Customize the following three items used for accessing the gateway and the CICS Transaction Server for z/OS as described in the comments at the beginning of the file:</p>
<ul>
<li>
<p><a id="sthref771"></a>CICS transaction ID</p>
</li>
<li>
<p><a id="sthref772"></a>Side Profile name</p>
</li>
<li>
<p><a id="sthref773"></a>Logmode entry name</p>
</li>
</ul>
</li>
<li>
<p>Ensure that <a id="sthref774"></a>the SNA communication package on <a id="sthref775"></a>your system has been started.</p>
</li>
<li>
<p>Log on to your CICS Transaction Server for z/OS and run this transaction, where <code><span class="codeinlineitalic">name</span></code> is the name of the <code>CONNECTION</code> definition installed by the <code>DFHCSDUP</code> job run in the CICS configuration steps:</p>
<pre>
CEMT SET CONNECTION<span class="italic">(name)</span> ACQUIRED
</pre>
<p>This transaction activates the CICS connection to HP-UX.</p>
</li>
<li>
<p>Use SQL*Plus to connect to your Oracle database as <code>PGAADMIN</code>.</p>
</li>
<li>
<p>Run <code><a id="sthref776"></a><a id="sthref777"></a>pgacics.sql</code>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/demo/CICS/pgacics.sql
</pre>
<p>The following message appears:</p>
<pre>
==&gt; Congratulations, your gateway is communicating with CICS &lt;==
</pre></li>
</ol>
<p>Your CICS Transaction Server for z/OS installation verification is complete.</p>
</div>
<!-- class="sect3" -->
<a id="BGBFIAGD"></a><a id="APPCI234"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">11.9.2.2</span> IMS/TM Verification<a id="sthref778"></a><a id="sthref779"></a><a id="sthref780"></a></h4>
<p>If your OLTP is <a id="sthref781"></a>IMS/TM, then perform the following steps to verify the IMS/TM configuration:</p>
<ol>
<li>
<p>To verify that the <a id="sthref782"></a>FLIP transaction is installed correctly, log on to your IMS/TM system and enter the following transaction, replacing <code>FLIP</code> with the transaction ID you chose for <code>FLIP</code> when you configured your IMS/TM system for the gateway:</p>
<pre>
FLIP THIS MESSAGE
</pre>
<p>The following output appears on your terminal:</p>
<pre>
EGASSEM SIHT PILF
</pre></li>
<li>
<p>Log on to HP-UX.</p>
</li>
<li>
<p>Modify the <code>pgaims.sql</code> file, which is located at <a id="sthref783"></a><a id="sthref784"></a><code>$ORACLE_HOME/dg4appc/demo/IMS/pgaims.sql</code>. Customize the following three items used for accessing the gateway and the IMS/TM system as described in the comments at the beginning of the file:</p>
<ul>
<li>
<p>IMS/TM transaction ID</p>
</li>
<li>
<p>Side Profile Name</p>
</li>
<li>
<p>Logmode entry name</p>
</li>
</ul>
</li>
<li>
<p>Ensure that the <a id="sthref785"></a>SNA communication package on your system has been started.</p>
</li>
<li>
<p><a id="sthref786"></a>Use SQL*Plus to connect to Oracle database as <code>PGAADMIN</code>.</p>
</li>
<li>
<p>Run <code><a id="sthref787"></a><a id="sthref788"></a>pgaims.sql</code>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/demo/IMS/pgaims.sql
</pre></li>
</ol>
<p>The following message appears:</p>
<pre>
==&gt; Congratulations, your gateway is communicating with IMS/TM &lt;==
</pre>
<p>Your IMS/TM installation verification is now complete.</p>
</div>
<!-- class="sect3" -->
<a id="BGBIBACC"></a><a id="APPCI235"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">11.9.2.3</span> <a id="sthref789"></a>APPC/MVS Verification<a id="sthref790"></a></h4>
<p>If your OLTP is <a id="sthref791"></a><a id="sthref792"></a>APPC/MVS, perform the following steps to verify the APPC/MVS configuration:</p>
<ol>
<li>
<p>Verify that your APPC/MVS subsystem is active.</p>
</li>
<li>
<p>Log on to HP-UX</p>
</li>
<li>
<p>Modify the <code><a id="sthref793"></a><a id="sthref794"></a>pgamvs.sql</code> file, which is located at <code><a id="sthref795"></a>$ORACLE_HOME/dg4appc/demo/MVS/pgamvs.sql</code>. Customize the following three items used for accessing the gateway and the APPC/MVS system as described in the comments at the beginning of the file:</p>
<ul>
<li>
<p>APPC/MVS transaction ID</p>
</li>
<li>
<p>Side Profile Name</p>
</li>
<li>
<p>Logmode entry name</p>
</li>
</ul>
</li>
<li>
<p>Ensure that the <a id="sthref796"></a>SNA communication package on your system has been started.</p>
</li>
<li>
<p>Use SQL*Plus to connect to your <a id="sthref797"></a>Oracle database as <code>PGAADMIN</code>.</p>
</li>
<li>
<p>Run <code>pgamvs.sql</code>.</p>
<pre>
SQL&gt; @$ORACLE_HOME/dg4appc/demo/MVS/pgamvs.sql
</pre>
<p>The following message appears:</p>
<pre>
=&gt; Congratulations, your gateway is communicating with APPC/MVS &lt;=
</pre></li>
</ol>
<pre>
</pre>
<p>Your APPC/MVS installation verification is now complete.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDBAABC"></a><a id="APPCI236"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">11.9.3</span> Verifying OLTP Configuration for Commit-Confirm</h3>
<p>If you chose to configure commit-confirm in <a href="#CHDIJCGE">Section 11.8, "Configuring Commit-Confirm"</a>, the following section will assist you in verifying the configuration.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Refer to Chapter&nbsp;5, "Implementing Commit-Confirm" in the <a class="olink APPUG500" href="../../gateways.112/e12071/com_con.htm#APPUG500"><span class="italic">Oracle Database Gateway for APPC User's Guide</span></a> for background information on the components and capabilities of commit-confirm.</div>
<p>Samples are provided with the gateway for Transaction Server for z/OS and IMS/TM for implementing commit-confirm support. They are in the following directories, respectively: <code>$ORACLE_HOME/dg4appc/demo/CICS</code> and <code>$ORACLE_HOME/dg4appc/demo/IMS</code>. A <code>README.doc</code> file in each directory provides detailed information about installing and using the samples. JCL files for compiling and linking the sample programs are provided as well.<a id="sthref798"></a> The samples included with the gateway assist you with the following:</p>
<ul>
<li>
<p>Creating and initializing the commit-confirm transaction log databases and defining those databases to the OLTP</p>
<p>For Transaction Server for z/OS, the sample uses a VSAM file for the log database. For IMS/TM, a SHISAM/VSAM database is used.</p>
</li>
<li>
<p>Using subroutines for receiving the <a id="sthref799"></a>Oracle Global Transaction ID from the gateway and logging it into the <a id="sthref800"></a>commit-confirm transaction log database</p>
<p>These subroutines are provided in the <code><a id="sthref801"></a><a id="sthref802"></a>pgacclg.asm</code> files. They can be used in your applications to reduce the complexity of the code changes to your programs. For Transaction Server for z/OS, the subroutine provided is called using the EXEC CICS LINK interface. For IMS/TM, the subroutine provided is called using the standard <code>CALL</code> statement or its equivalent in the application programming language. Both of these subroutines are written in 370 assembler to eliminate any interlanguage interface complexities and compiler dependencies.</p>
</li>
<li>
<p>Forget and recovery transactions</p>
<p>These are provided in the <code><a id="sthref803"></a><a id="sthref804"></a>pgareco.asm</code> files. Forget and recovery transactions must be installed into your OLTP and accessible through APPC so that the gateway can invoke them to forget a transaction once it has been successfully committed, and to query transaction state during recovery processing. These transactions delete the entry for a particular Oracle <a id="sthref805"></a>Global Transaction ID from the OLTP commit-confirm transaction log database during forget processing, and query the entry for a particular Oracle Global Transaction ID from the OLTP commit-confirm transaction log database during recovery processing. For both Transaction Server for z/OS and IMS/TM, these transactions are written in 370 assembler.</p>
</li>
<li>
<p>Using the sample commit-confirm transaction log databases and subroutines</p>
<p>For Transaction Server for z/OS, a sample DB2 update transaction, <code>DB2C</code>, is provided in the <code><a id="sthref806"></a><a id="sthref807"></a>pgadb2c.cob</code> file. This is a COBOL example that updates the DB2 sample <code>EMP</code> table. For IMS/TM, a sample DLI update transaction, <code>PGAIMSU</code>, is provided in the <code>pgaimsu.cob</code> file. This is a COBOL example that updates the DLI sample <code>PARTS</code> database.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1009126"></a><a id="APPCI237"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">11.10</span> Performing Postinstallation Procedures<a id="sthref808"></a><a id="sthref809"></a></h2>
<p>The following are optional steps that you can perform as necessary. Installation of the sample applications for your OLTP is recommended to help you to fully understand how the gateway works and how it interfaces with your OLTP.</p>
<a id="APPCI238"></a>
<div class="sect2"><a id="sthref810"></a>
<h3 class="sect2"><span class="secnum">11.10.1</span> Installing Sample Applications<a id="sthref811"></a><a id="sthref812"></a><a id="sthref813"></a></h3>
<p>Oracle Database Gateway for APPC package contains the following sample PL/SQL procedures and OLTP transaction programs that demonstrate the capabilities of the gateway.</p>
<p><span class="bold">APPC/MVS</span></p>
<ul>
<li>
<p>z/OS data set information</p>
</li>
</ul>
<p><span class="bold">CICS Transaction Server for z/OS</span></p>
<ul>
<li>
<p>DB2 inquiry</p>
</li>
<li>
<p>DB2 multi-row inquiry</p>
</li>
<li>
<p>DB2 update</p>
</li>
<li>
<p>VSAM inquiry</p>
</li>
<li>
<p>VSAM update</p>
</li>
<li>
<p>DLI inquiry</p>
</li>
<li>
<p>FEPI DB2 inquiry</p>
</li>
<li>
<p>FEPI VSAM inquiry</p>
</li>
</ul>
<p><span class="bold">IMS/TM</span></p>
<ul>
<li>
<p>IMS inquiry using IVTNO and IVTNV sample transactions</p>
</li>
<li>
<p>IMS PARTS inquiry (<a id="sthref814"></a>CPI-C)</p>
</li>
<li>
<p>IMS PARTS update (CPI-C)</p>
</li>
</ul>
<p>Additional samples are added to the distribution media in later releases of the product. Wherever possible, sample applications use the sample databases provided with the database products.</p>
<p>For this release, full documentation on installing and using the sample applications is available in the following directories and files:</p>
<ul>
<li>
<p><code>$ORACLE_HOME/dg4appc/CICS/sample_CICS_applications.txt</code></p>
</li>
<li>
<p><code>$ORACLE_HOME/dg4appc/IMS/sample_IMS_applications.txt</code></p>
</li>
<li>
<p><code>$ORACLE_HOME/dg4appc/MVS/sample_MVS_applications.txt</code></p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment197">
<tr>
<td class="cellalignment204">
<table class="cellalignment202">
<tr>
<td class="cellalignment201"><a href="ch11.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment201"><a href="ch13.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment206">
<table class="cellalignment200">
<tr>
<td class="cellalignment201"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment201"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment201"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment201"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment201"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment201"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
