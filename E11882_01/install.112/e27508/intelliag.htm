<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Oracle Management Agent</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1060" />
<meta name="dcterms.created" content="2015-07-23T2:44:39Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Installation and Administration Guide" />
<meta name="dcterms.identifier" content="E27508-04" />
<meta name="dcterms.isVersionOf" content="DFSIG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="xml.htm" title="Previous" type="text/html" />
<link rel="Next" href="sr2.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e27508.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">17/24</span> <!-- End Header -->
<div id="DFSIG290" class="chapter"><a id="CEGBHHFD"></a>
<h1 class="chapter"><span class="secnum">14</span> Oracle Management Agent</h1>
<p>This chapter describes the Oracle <a id="sthref152"></a>Management Agent for BS2000/OSD and provides installation and configuration information. The reader is supposed to be familiar with Oracle Enterprise Manager.</p>
<p>The Oracle Management Agent for BS2000/OSD monitors all components on the host computer. Once installed, the Oracle Management Agent knows how to monitor default target types, such as the Oracle Database. For more information, refer to <a class="olink OEMCN" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OEMCN"><span class="italic">Oracle Enterprise Manager Concepts</span></a>.</p>
<p>This chapter describes the following sections:</p>
<ul>
<li>
<p><a href="#CHDJAEFJ">Preinstallation Issues</a></p>
</li>
<li>
<p><a href="#CHDIGGAG">Running the Installation Script</a></p>
</li>
<li>
<p><a href="#CHDCCDDF">Running the Agent</a></p>
</li>
<li>
<p><a href="#CHDJFABJ">Restrictions</a></p>
</li>
<li>
<p><a href="#CHDHAHDJ">Troubleshooting</a></p>
</li>
</ul>
<a id="CHDJAEFJ"></a>
<div id="DFSIG291" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.1</span> <a id="sthref153"></a>Preinstallation Issues</h2>
<p>The following is a list of preinstallation issues:</p>
<ul>
<li>
<p>Check if the BS2000/OSD POSIX subsystem is started</p>
</li>
<li>
<p>Check if the <span class="italic"><a id="sthref154"></a><a id="sthref155"></a>open</span>Net Server tool <code dir="ltr">netstat</code> is installed under POSIX.</p>
</li>
<li>
<p>Check if jenv v6.0 is installed</p>
</li>
<li>
<p>Check if perl v5.8 is installed</p>
<p>If one of the required software packages is not installed, then install the software package first before installing Oracle Management Agent.</p>
</li>
<li>
<p>Ensure that the user address space is 1 GB</p>
</li>
<li>
<p>Ensure that there is at least 1 GB disc space available on the POSIX file system</p>
</li>
<li>
<p>Ensure that the file <code dir="ltr">/etc/hosts</code> includes an entry with a loopback address for the localhost similar to the following example:</p>
<pre dir="ltr">
127.0.0.1 localhost local # loopback
</pre></li>
<li>
<p>Add all Oracle databases you want to monitor the file <code dir="ltr">/var/opt/oracle/oratab</code> with the following format:</p>
<pre dir="ltr">
<span class="codeinlineitalic">ORACLE_SID:ORACLE_HOME:</span>N|Y<span class="codeinlineitalic">:ORACLE_DATA</span>
</pre>
<p>The following table describes the parameters in the format:</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Parameter and Description table" summary="The following table is a list of Parameter and Description." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t2">Parameter</th>
<th class="cellalignment2620" id="r1c2-t2">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t2" headers="r1c1-t2"><code dir="ltr">ORACLE_SID</code></td>
<td class="cellalignment2621" headers="r2c1-t2 r1c2-t2">system identifier of the database</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t2" headers="r1c1-t2"><code dir="ltr">ORACLE_HOME</code></td>
<td class="cellalignment2621" headers="r3c1-t2 r1c2-t2">Oracle home directory under POSIX</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r4c1-t2" headers="r1c1-t2"><code dir="ltr">ORACLE_DATA</code></td>
<td class="cellalignment2621" headers="r4c1-t2 r1c2-t2">user ID where the database files are stored</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>Each database that should be monitored needs an entry in the <code dir="ltr">oratab</code> file. An example for a valid <code dir="ltr">oratab</code> file is:</p>
<pre dir="ltr">
# oratab file
# valid entries are of the following form:
# <span class="codeinlineitalic">ORACLE_SID:ORACLE_HOME:</span>N|Y<span class="codeinlineitalic">:ORACLE_DATA</span>
orcl:/ora11202/oracle/product/10g:N:$ORACLE
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The DBA group should have read and write access to the <code dir="ltr">oratab</code> file and the <code dir="ltr">oracle</code> directory in the <code dir="ltr">/var/opt</code> folder.</div>
</li>
<li>
<p>Check the Oracle Management Agent release number. Oracle Management Agent that ships with release 11.2 can monitor releases 10.x and 11.x. Monitoring of a Oracle9<span class="italic">i</span> is not supported.</p>
</li>
<li>
<p>Ensure that you copy the appropriate <code dir="ltr">LISTENER.ORA</code> file to the <code dir="ltr">$ORACLE_HOME/network/admin</code> directory to monitor a LISTENER.</p>
</li>
<li>
<p>Ensure that you grant access to the alert file to all users, if you want to monitor a database under a user ID different from the user ID of the Enterprise Management Agent.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDIGGAG"></a>
<div id="DFSIG292" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.2</span> Running the Installation Script</h2>
<p>It is recommended to install the Oracle Management Agent under a separate Oracle Home directory. All Oracle users should belong to the same group, for example, oracle. To start the installation enter:</p>
<pre dir="ltr">
/CALL-PROCEDURE $ORACLE1120.INSTALL.P.AGENT
</pre>
<p>You are prompted for the following:</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Parameter and Description table" summary="The following table lists the parameters and its description." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t4">Parameter</th>
<th class="cellalignment2620" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t4" headers="r1c1-t4"><code dir="ltr">EMDROOT</code></td>
<td class="cellalignment2621" headers="r2c1-t4 r1c2-t4">This is the Management Agent's home directory.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t4" headers="r1c1-t4"><code dir="ltr">EM-AGENT-PORT</code></td>
<td class="cellalignment2621" headers="r3c1-t4 r1c2-t4">The port on which the Management Agent should listen.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r4c1-t4" headers="r1c1-t4"><code dir="ltr">EM-OMS-HOST</code></td>
<td class="cellalignment2621" headers="r4c1-t4 r1c2-t4">The host name of the Oracle Management Server</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r5c1-t4" headers="r1c1-t4"><code dir="ltr">EM-OMS-HTTP-PORT</code></td>
<td class="cellalignment2621" headers="r5c1-t4 r1c2-t4">The port of the Oracle Management Server</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>To finalize the EM Agent installation login as root and execute the following script:</p>
<pre dir="ltr">
   $EMDROOT/root.sh
</pre>
<p>The installation of the Management Agent, can also be operated by a background process. In this case, the parameters <code dir="ltr">EMDROOT</code>, <code dir="ltr">EM-AGENT-PORT</code>, <code dir="ltr">EM-OMS-HOST</code> and <code dir="ltr">EM-OMS-HTTP-PORT</code> are mandatory parameters and must be specified with the following procedure call:</p>
<pre dir="ltr">
/ENTER-PROCEDURE $ORAC1120.INSTALL.P.AGENT,(EMDROOT='/u01/app/orac1120/product/emagent',EM-AGENT-PORT='1813',EM-OMS-HOST='omshost.example.com',EM-OMS-HTTP-PORT='1159'), CPU-LIMIT=300
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>The installation is logged to the <code dir="ltr">INSTALL.EMAGENT.LST</code> file.</p>
</li>
<li>
<p>It is recommended to use a CPU-LIMIT greater than 200.</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CHDCCDDF"></a>
<div id="DFSIG296" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.3</span> Running the Agent</h2>
<ul>
<li>
<p>To run the agent, start a POSIX shell and type the following command:</p>
<pre dir="ltr">
emctl start agent
</pre>
<p>If you start the Management Agent with the <code dir="ltr">emctl</code> utility in the POSIX shell, then the Management Agent inherits the <code dir="ltr">JOB-CLASS</code>, <code dir="ltr">CPU-LIMIT</code> and <code dir="ltr">RUN-PRIORITY</code> of the login process.As a consequence a defined <code dir="ltr">CPU-LIMIT</code> causes the Management Agent to terminate when the limit is reached. If you want to start the Management Agent without <code dir="ltr">CPU-LIMIT</code>, then use the BS2000 start procedure for the Management Agent. Login to the BS2000 Management Agent user ID and execute the command:</p>
<pre dir="ltr">
/ENTER-PROCEDURE ST-AGENT.PRC,JOB-NAME=EMAGENT,JOB-CLASS=&lt;ntl-j-c&gt;,CPU-LIMIT=*NO,RUN-PRIO=210
</pre></li>
<li>
<p>To stop the agent, start a POSIX shell and type the following command:</p>
<pre dir="ltr">
emctl stop agent
</pre></li>
<li>
<p>To get the status of the agent, start a POSIX shell and type the following command:</p>
<pre dir="ltr">
emctl status agent
</pre></li>
</ul>
<p>Use the Oracle Management Agent for BS2000/OSD as described in the <span class="italic">Oracle Database 11g Enterprise Manager</span> book set.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends to use the start procedure in the BS2000 environment to start the Management Agent.</div>
</div>
<!-- class="sect1" -->
<a id="CHDJFABJ"></a>
<div id="DFSIG297" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.4</span> Restrictions</h2>
<p>The following is a list of issues that might affect Oracle Enterprise Manager Agent</p>
<ul>
<li>
<p>Oracle Management Agent for BS2000/OSD can monitor servers that are running Oracle Database 10<span class="italic">g</span> or Oracle Database 11<span class="italic">g</span>.</p>
</li>
<li>
<p>The Oracle Management Agent for BS2000/OSD does not support the SNMP framework. That means, the agent is not integrated within the EMANATE master agent for BS2000/OSD. The agent does not accept any SNMP requests and does not send any SNMP trap. Therefore, the Oracle Management Agent for BS2000/OSD is not usable with third party SNMP management systems.</p>
</li>
<li>
<p>Oracle Database 10<span class="italic">g</span> and Oracle Database 11<span class="italic">g</span> for BS2000/OSD supports only a minimal set of system statistics and these may not reflect the actual performance of the system.</p>
</li>
<li>
<p>Currently, Oracle Database 11<span class="italic">g</span> for BS2000/OSD only ships with the Oracle Enterprise Manager Agent. Oracle Enterprise Manager Grid Control Console is not supported, though this release does support a remote Oracle Enterprise Manager Grid Control Console.</p>
</li>
<li>
<p>Currently, the Management Agent supports only a minimal set of host metrics and these may not reflect the actual performance and only a part of the configuration of the system.</p>
</li>
<li>
<p>The dbconsol is not supported on BS2000/OSD.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDHAHDJ"></a>
<div id="DFSIG432" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">14.5</span> Troubleshooting</h2>
<p>Typically, the Oracle Management Agent is monitored by an internal watchdog process and is restarted in case of an error. This method does not prevent from any crashes where at least one task of the thread application is kept alive and might inhibit a proper restart of the Management Agent. If the Oracle Management Agent cannot be started or restarted, then use the following instructions to resolve the issue:</p>
<pre dir="ltr">
/CALL-PROCEDURE $TSOS.SYSPRC.PTHREADS.010(ITH-SHOW)
</pre>
<p>Login to the POSIX shell, set your environment and run the utility ithshow, for example:</p>
<pre dir="ltr">
$ . /u01/app/orac1120/agent11g/.profile.oracle
$ ithshow
</pre>
<p>This utility produces an output similar to the following:</p>
<pre dir="ltr">
STARTED AT 2012-06-12-135624 BY POSIX (running) 
LLM = EMAGENT (prelinked)
MAIN = IC@#MAIN
APPLL = :POR2:$ORAQAX13.ORALOAD-ASCII.LIB
RUNTL = :BUG1:$TSOS.SYSLNK.PTHREADS.013   
PTHvers = 01.3A10 2011-04-14 09:19:23
FDs = 8 (8 ORIG FDs)
Threads = 10 (6 user threads, 4 system threads)
TYPE TSN PID JOB-TYPE PRI CPU-USED CPU-MAX ACCOUNT#
ORIG 1MYQ 3942 (X'0F66') 3 DIALOG *0 240 16.7989 32767 FSC
executing request
THRE 1MYW 3948 (X'0F6C') 3 DIALOG *0 240 21.7415 32767 FSC
executing user thread
</pre>
<p>Here you find the TSNs of the tasks involved in the <code dir="ltr">PTHREADS</code> application. You can connect to the <code dir="ltr">PTHREADS</code> application when you choose the TSN of the ORIG task as the input for the parameter TSN of the <code dir="ltr">ITH-START</code> procedure in the following format:</p>
<pre dir="ltr">
/CALL-PROCEDURE $TSOS.SYSPRC.PTHREADS.013(ITH-START),(TSN=1MYQ)
</pre>
<p>When you see the double slash prompt you can type <code dir="ltr">CANCEL-THREADED-PROGRAM</code> to cancel the <code dir="ltr">PTHREADS</code> application. If the <code dir="ltr">ORIG</code> task is already terminated, then you can terminate all other <code dir="ltr">PTHREADS</code> tasks by using the BS2000 system command</p>
<pre dir="ltr">
/CANCEL_JOB JOB-IDENTIFICATION=tsn
</pre>
<p>If the Management Agent is running on a SQ system in x86-64 mode, then you must define the proper load library in the procedure parameters as follows:</p>
<pre dir="ltr">
/CALL-PROCEDURE $TSOS.SYSPRC.PTHREADS.013(ITH-START),(START-LIBRARY=$TSOS.SKULNK.PTHREADS.013,TSN=1MYQ)
</pre>
<p>If the Management Agent terminates abnormally, then it might be possible that a process with the name <code dir="ltr">dblu</code><code dir="ltr"><span class="codeinlineitalic">user_number</span></code> stays alive. This process is a program cache and cannot be canceled with the BS2000 <code dir="ltr">CANCEL-JOB</code> command. This process can only be stopped using the POSIX command <code dir="ltr">posdbl</code>. For example, the following shows you how you can identify and stop a pending program cache in the POSIX shell:</p>
<pre dir="ltr">
$ ps -fu emuser
UID PID PPID C STIME TTY TIME CMD
EMUSER 2178 2175 0 07:48:08 pts/0 0:01 [sh]
EMUSER 4179 2178 2 14:05:16 pts/0 0:00 [ps]
EMUSER 4168 1 0 14:05:06 ? 0:00 dblu511
</pre>
<p>In this example, the process <code dir="ltr">dblu511</code> with the <code dir="ltr">pid 4168</code> is still alive. To stop this process enter the following command:</p>
<pre dir="ltr">
$ pdbl -uD
</pre></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2612">
<tr>
<td class="cellalignment2621">
<table class="cellalignment2617">
<tr>
<td class="cellalignment2616"><a href="xml.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2616"><a href="sr2.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2623">
<table class="cellalignment2615">
<tr>
<td class="cellalignment2616"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2616"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2616"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2616"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2616"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2616"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
