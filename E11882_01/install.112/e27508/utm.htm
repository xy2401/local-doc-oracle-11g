<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>openUTM Product Set</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1060" />
<meta name="dcterms.created" content="2015-07-23T2:44:39Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Installation and Administration Guide" />
<meta name="dcterms.identifier" content="E27508-04" />
<meta name="dcterms.isVersionOf" content="DFSIG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="tuning.htm" title="Previous" type="text/html" />
<link rel="Next" href="netv2.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e27508.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">11/24</span> <!-- End Header -->
<div id="DFSIG228" class="chapter"><a id="BABJHHHB"></a>
<h1 class="chapter"><span class="secnum">8</span> <a id="sthref85"></a>openUTM Product Set</h1>
<p>This chapter describes how to use the BS2000/OSD transaction monitor openUTM for coordinated interoperation with Oracle Database 11<span class="italic">g</span> Release 2 (11.2). The following areas are covered:</p>
<ul>
<li>
<p><a href="#CHDGAAGI">Operation of Oracle Database Using openUTM Programs</a></p>
</li>
<li>
<p><a href="#CHDJGFJC">Distributed openUTM Files</a></p>
</li>
<li>
<p><a href="#CHDEDIBD">Installing</a></p>
</li>
<li>
<p><a href="#CHDFCABC">Developing an Oracle Database/openUTM Application</a></p>
</li>
<li>
<p><a href="#CHDCJAHI">Troubleshooting</a></p>
</li>
</ul>
<a id="CHDGAAGI"></a>
<div id="DFSIG229" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">8.1</span> Operation of Oracle Database Using openUTM Programs</h2>
<p>Universal Transaction Monitor (openUTM) controls the execution of user programs that can be used from a large number of terminals at the same time.</p>
<p>An openUTM application consists of a structured sequence of processing stages that are supplied with access rights for the specific user. These stages, in turn, consist of openUTM transactions that are carried out either in their entirety, or not at all.</p>
<p>If several users are working under openUTM at the same time, then simultaneous access to the shared database is also usually required. The database/data communications system (DB/DC system), Oracle Database/openUTM, synchronizes access by openUTM applications to Oracle Database, and ensures that the database remains in a consistent state. In the event of system failure, the DB/DC system performs an automatic recovery, which ensures that the database remains in a consistent state that is synchronized with openUTM.</p>
<p>Synchronization of Oracle and openUTM is done through the XA interface. The XA interface is an X/Open interface for the coordination between database systems and transaction monitors. Refer to Developing Applications with Oracle XA chapter in <a class="olink ADFNS" href="../../appdev.112/e41502/toc.htm"><span class="italic">Oracle Database Advanced Application Developer's Guide</span></a> for a description of the concepts of the XA interface.</p>
</div>
<!-- class="sect1" -->
<a id="CHDJGFJC"></a>
<div id="DFSIG230" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">8.2</span> Distributed openUTM Files</h2>
<p>When you install Oracle Database, as described in <a href="install.htm#BABHCBCC">Chapter 3, " Oracle Database Installation and Deinstallation,"</a> the openUTM related software of the Oracle Database software is installed. The distributed openUTM files comprise of:</p>
<ul>
<li>
<p><code dir="ltr"><a id="sthref86"></a>XAO.LIB</code></p>
<p>This file contains the connection module for the XA interface.</p>
</li>
<li>
<p>The following files provide examples of procedures and programs:</p>
<pre dir="ltr">
UTM.DEMO.P.COMPILE.C
UTM.DEMO.P.COMPILE.COBOL
UTM.DEMO.P.KDCDEF
UTM.DEMO.P.KDCROOT
UTM.DEMO.P.PROBIND
UTM.DEMO.P.PROSTRT
UTM.DEMO.CSELEMP.PC
UTM.DEMO.SELDEP.PCO
UTM.DEMO.SELEMP.PCO
UTM.DEMO.UPDEMP.PCO
UTM.DEMO.ERRSQL.C
UTM.DEMO.ERRTXT.C
</pre></li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDEDIBD"></a>
<div id="DFSIG231" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">8.3</span> Installing</h2>
<p>Perform the following step to install after studying the <a class="olink ADFNS" href="../../appdev.112/e41502/toc.htm"><span class="italic">Oracle Database Advanced Application Developer's Guide</span></a>:</p>
<ul>
<li>
<p>Grant the <code dir="ltr">SELECT</code> privilege to the <code dir="ltr">DBA_PENDING_TRANSACTIONS</code> table for all openUTM users connecting to the Oracle Database. Use the following example to grant the <code dir="ltr">SELECT</code> privilege to user <code dir="ltr">scott</code>:</p>
<pre dir="ltr">
grant select on DBA_PENDING_TRANSACTIONS to scott;
</pre>
<p>The openUTM users are identified in the Open String with the Item <code dir="ltr">Acc</code>. Refer to <a href="#CHDIBAFD">"Defining an Open String"</a> section in this chapter.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDFCABC"></a>
<div id="DFSIG232" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">8.4</span> Developing an Oracle Database/openUTM Application</h2>
<p>Oracle Database 11<span class="italic">g</span> on BS2000 supports openUTM V6.0 or higher. openUTM supports the XA interface. Oracle Database 11<span class="italic">g</span> on BS2000 coordinates with openUTM through this XA interface.</p>
<p>The steps involved in developing an Oracle Database application for coordinated inter-operation with openUTM are described in this section. The main steps are as follows:</p>
<ol>
<li>
<p>Building the openUTM program units</p>
</li>
<li>
<p>Defining the configuration</p>
</li>
<li>
<p>Translating the KDCROOT table module and openUTM program units</p>
</li>
<li>
<p>Linking the openUTM application program</p>
</li>
<li>
<p>Starting the openUTM application</p>
</li>
</ol>
<p>In addition, this section also describes how you define open strings and how you use precompilers with the Oracle XA library.</p>
<ol>
<li>
<p>Building the openUTM program units:</p>
<p>(refer to the openUTM manual <span class="italic">Programming Applications with KDCS for COBOL, C, and C++,</span> and the <a class="olink DFSUG" href="../../server.112/e27507/toc.htm"><span class="italic">Oracle Database User's Guide for Fujitsu BS2000/OSD</span></a>)</p>
</li>
<li>
<p>Defining the configuration:</p>
<p>(refer to the openUTM manuals <span class="italic">Generating Applications</span> and <span class="italic">Administering Applications</span>)</p>
<p>An Oracle Database/openUTM application requires the following information for execution:</p>
<ul>
<li>
<p>Information about the application</p>
</li>
<li>
<p>Username/password with access protection</p>
</li>
<li>
<p>Information about the terminal and communication partners</p>
</li>
<li>
<p>Information about the transaction codes</p>
</li>
</ul>
<p>These properties collectively form the configuration, which is stored in the <code dir="ltr">KDCFILE</code> file. The configuration definition is carried out by the <code dir="ltr">KDCDEF</code> utility.</p>
<p>This section gives the descriptions for three commands that are important for connecting to the Oracle database. They are:</p>
<ul>
<li>
<p><code dir="ltr">DATABASE</code></p>
<p>When the Oracle Database/openUTM application is generated, you must specify that openUTM communicates with the Oracle Database. Enter the following command to specify openUTM communication with the database:</p>
<pre dir="ltr">
DATABASE TYPE=XA,ENTRY=XAOSWD
</pre>
<p>where <code dir="ltr">TYPE=XA</code> specifies the use of the XA interface and <code dir="ltr">ENTRY=XAOSWD</code> specifies the name of the XA switch for the Oracle database (for dynamic registration).</p>
</li>
<li>
<p><code dir="ltr">OPTION</code></p>
<p>If you specify the corresponding <code dir="ltr">GEN</code> operand in the <code dir="ltr">OPTION</code> command, then the <code dir="ltr">KDCDEF</code> utility also produces the source-code for the <code dir="ltr">KDCROOT</code> table module. The syntax of <code dir="ltr">OPTION</code> is as follows:</p>
<pre dir="ltr">
OPTION [DATA=<span class="italic">filename</span>][,GEN={KDCFILE|ROOTSRC|NO|ALL}]
[,ROOTSRC=<span class="italic">filename</span>][,SHARETAB=<span class="italic">filename</span>]
[,TEST={N[o]|Y[ES]}]
</pre></li>
<li>
<p><code dir="ltr">MAX</code></p>
<p>Another important operand is <code dir="ltr">APPLIMODE</code>, which is specified in the <code dir="ltr">MAX</code> command. This determines restart behavior after a system failure. The syntax of <code dir="ltr">MAX</code> is as follows:</p>
<pre dir="ltr">
MAX APPLINAME=<span class="italic">name</span>[,APPLIMODE={S[ECURE]|F[AST]}]
[,ASYNTASKS=<span class="italic">number</span>][...]
</pre>
<p><code dir="ltr">APPLIMODE</code>=<code dir="ltr">SECURE</code> means that openUTM continues after an application malfunction with a coordinated warm-start of the openUTM application and the Oracle database.</p>
<p>If you specify <code dir="ltr">APPLIMODE</code>=<code dir="ltr">FAST</code>, then no openUTM application restart is executed, as openUTM stores no restart information. In the event of an error, the application starts from scratch. Transactions that are still open after an openUTM-application malfunction are rolled back automatically.</p>
</li>
</ul>
<p>See the <code dir="ltr">UTM.DEMO.P.KDCDEF</code> file for an example procedure for building the <code dir="ltr">KDCFILE</code> and the <code dir="ltr">KDCROOT</code> table module.</p>
</li>
<li>
<p>Translating the <code dir="ltr">KDCROOT</code> table module and openUTM program units:</p>
<p>The source of the <code dir="ltr">KDCROOT</code> table module should be compiled with the BS2000 Assembler and the openUTM program units should be compiled with the corresponding programming language compilers. See the example procedure <code dir="ltr">UTM.DEMO.P.KDCROOT</code> for the compilation of the <code dir="ltr">KDCROOT</code> table module.</p>
</li>
<li>
<p>Linking the openUTM application program:</p>
<p>The openUTM application program is produced by linking the <code dir="ltr">KDCROOT</code> table module with the openUTM program units.</p>
<p>You must include the stub module XAOSTUB:</p>
<pre dir="ltr">
INC-MOD LIB=<span class="codeinlineitalic">ORAUID</span>.XAO.LIB,ELEM=XAOSTUB
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Instead of writing the binding procedure, you should use the example procedure <code dir="ltr">UTM.DEMO.P.PROBIND</code> and apply modifications when needed.
<p>If you must write your own binding procedure, then study the example carefully before writing one.</p>
</div>
</li>
<li>
<p>Starting the openUTM application:</p>
<p>An example procedure for starting the openUTM application can be found in the file <code dir="ltr">UTM.DEMO.P.PROSTRT</code>.</p>
<p>When starting the openUTM application, you must specify the start parameters for openUTM, as well as for the Oracle Database.</p>
<p>The openUTM start parameters are described in the openUTM manual <span class="italic">Using openUTM Applications under BS2000/OSD</span>.</p>
<p>The start parameter for using the XA interface for coordinated inter-operation with Oracle Database 10<span class="italic">g</span> is:</p>
<pre dir="ltr">
.RMXA RM="Oracle_XA",OS="&lt;ORACLE open string&gt;"
</pre></li>
</ol>
<a id="CHDIBAFD"></a>
<div id="DFSIG233" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">8.4.1</span> Defining an Open String</h3>
<p>This section describes how to construct an open string. The transaction monitor uses this string to open the database. The maximum number of characters in an open string is 256, and the maximum number of open strings is 8. Construct the string as follows:</p>
<pre dir="ltr">
Oracle_XA{+<span class="italic">required_fields</span>...}[+<span class="italic">optional_fields</span>...]
</pre>
<p>where the <code dir="ltr"><span class="codeinlineitalic">required_fields</span></code> are:</p>
<ul>
<li>
<p><code dir="ltr">Acc</code>=<code dir="ltr"><span class="codeinlineitalic">P/user/access_info</span></code></p>
</li>
<li>
<p><code dir="ltr">SesTm</code>=<code dir="ltr"><span class="codeinlineitalic">session_time_limit</span></code></p>
</li>
</ul>
<p>and the <code dir="ltr"><span class="codeinlineitalic">optional_fields</span></code> are:</p>
<ul>
<li>
<p><code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code></p>
</li>
<li>
<p><code dir="ltr">MaxCur</code>=<code dir="ltr"><span class="codeinlineitalic">maximum_no_of_open_cursors</span></code></p>
</li>
<li>
<p><code dir="ltr">SqlNet</code>=<code dir="ltr"><span class="codeinlineitalic">connect_string</span></code></p>
</li>
<li>
<p><code dir="ltr">DbgFl</code>=<code dir="ltr"><span class="codeinlineitalic">value_from_1_to_15</span></code></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Notes:</p>
<p>Remember the following:</p>
<ul>
<li>
<p>You can enter the required fields and optional fields in any order when constructing the open string.</p>
</li>
<li>
<p>All field names are case-insensitive, although their values may or may not be case-sensitive depending on the system.</p>
</li>
<li>
<p>You may not use the "+" character as part of the actual open string.</p>
</li>
</ul>
</div>
<div id="DFSIG234" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref87"></a>
<h4 class="sect3"><span class="secnum">8.4.1.1</span> Required Fields</h4>
<p>The required fields for the open string are:</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t4">Item</th>
<th class="cellalignment2620" id="r1c2-t4">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t4" headers="r1c1-t4"><code dir="ltr">Acc</code></td>
<td class="cellalignment2621" headers="r2c1-t4 r1c2-t4">Specifies user access information.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t4" headers="r1c1-t4"><code dir="ltr">P</code></td>
<td class="cellalignment2621" headers="r3c1-t4 r1c2-t4">Indicates that explicit user and password information is provided.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r4c1-t4" headers="r1c1-t4"><code dir="ltr"><span class="codeinlineitalic">user</span></code></td>
<td class="cellalignment2621" headers="r4c1-t4 r1c2-t4">A valid Oracle Database user name.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r5c1-t4" headers="r1c1-t4"><code dir="ltr"><span class="codeinlineitalic">access_info</span></code></td>
<td class="cellalignment2621" headers="r5c1-t4 r1c2-t4">The corresponding current password.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>For example, <code dir="ltr">Acc</code>=<code dir="ltr">P/scott/tiger</code> indicates that user and password information is provided. In this case, the user is <code dir="ltr">scott</code> and the password is <code dir="ltr">tiger</code>.</p>
<p>For the correct process, ensure that <code dir="ltr">scott</code> has the <code dir="ltr">SELECT</code> privilege on the <code dir="ltr">DBA_PENDING_TRANSACTIONS</code> table.</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t5">Item</th>
<th class="cellalignment2620" id="r1c2-t5">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t5" headers="r1c1-t5"><code dir="ltr">SesTm</code></td>
<td class="cellalignment2621" headers="r2c1-t5 r1c2-t5">Specifies the maximum amount of time a transaction can be inactive before it is automatically deleted by the system.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t5" headers="r1c1-t5"><code dir="ltr"><span class="codeinlineitalic">session_time_limit</span></code></td>
<td class="cellalignment2621" headers="r3c1-t5 r1c2-t5">This value should correspond to what you require as a maximum time from initiation of a global transaction and the completed commit or rollback of that transaction.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="sect3" -->
<div id="DFSIG235" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref88"></a>
<h4 class="sect3"><span class="secnum">8.4.1.2</span> Optional Fields</h4>
<p>Optional fields for the open string are described in the following table:</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t6">Item</th>
<th class="cellalignment2620" id="r1c2-t6">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t6" headers="r1c1-t6"><code dir="ltr">DB</code></td>
<td class="cellalignment2621" headers="r2c1-t6 r1c2-t6">Specifies the database name.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t6" headers="r1c1-t6"><code dir="ltr"><span class="codeinlineitalic">db_name</span></code></td>
<td class="cellalignment2621" headers="r3c1-t6 r1c2-t6">Indicates the name used in Oracle Database precompilers to identify the database.
<p>Application programs that use only the default database for the Oracle Database precompiler, that is, do not use the AT clause in their SQL statements, should omit the <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> clause in the open string.</p>
<p><span class="bold">Note:</span> This default database is represented in the <code dir="ltr">ORAENV</code> file by <code dir="ltr">ORASID</code>.</p>
<p>Applications that use explicitly&ndash;named databases should indicate that database name in their <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> field.</p>
<p>For example, <code dir="ltr">DB</code>=<code dir="ltr">payroll</code> indicates that the database name is payroll and that the application server program uses that name in AT clauses.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>For more information about precompilers, specifically Pro*C, refer to the section <a href="#CHDDEAGJ">"Using Precompilers with openUTM"</a> later in this chapter.</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t7">Item</th>
<th class="cellalignment2620" id="r1c2-t7">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t7" headers="r1c1-t7"><code dir="ltr">MaxCur</code></td>
<td class="cellalignment2621" headers="r2c1-t7 r1c2-t7">Specifies the number of cursors to be allocated when the database is opened. It serves the same purpose as the precompiler option <code dir="ltr">maxopencursors</code>.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t7" headers="r1c1-t7"><code dir="ltr"><span class="codeinlineitalic">maximum_no_of_open_cursors</span></code></td>
<td class="cellalignment2621" headers="r3c1-t7 r1c2-t7">Indicates the number of open cursors. The default is 10.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>For example, <code dir="ltr">MaxCur</code>=<code dir="ltr">5</code> indicates that the process should try to keep five open cursors cached.</p>
<p>For more information about <code dir="ltr">maxopencursors</code>, refer to the <a class="olink ZZPRE" href="../../appdev.112/e10830/toc.htm"><span class="italic">Oracle Database Programmer's Guide to the Oracle Precompilers</span></a>.</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t8">Item</th>
<th class="cellalignment2620" id="r1c2-t8">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t8" headers="r1c1-t8"><code dir="ltr">SqlNet</code></td>
<td class="cellalignment2621" headers="r2c1-t8 r1c2-t8">Specifies the SQL*Net connection string.</td>
</tr>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r3c1-t8" headers="r1c1-t8"><code dir="ltr"><span class="codeinlineitalic">connect_string</span></code></td>
<td class="cellalignment2621" headers="r3c1-t8 r1c2-t8">Indicates the string to be used to log onto the system. This can be any supported Oracle Net Services connect string.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>For example:</p>
<p><code dir="ltr">SqlNet</code>=<code dir="ltr">MADRID_FINANCE</code> indicates an entry in <code dir="ltr">TNSNAMES.ORA</code> referencing a protocol, a host, and a port number. For more information, refer to <a href="netv2.htm#CHDDIHHI">Chapter 9, " Oracle Net Services"</a> of this guide.</p>
<div class="inftblinformal">
<table class="cellalignment2619" title="Conventions Table" summary="This table summarizes conventions used in this document." dir="ltr">
<thead>
<tr class="cellalignment2613">
<th class="cellalignment2620" id="r1c1-t9">Item</th>
<th class="cellalignment2620" id="r1c2-t9">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2613">
<td class="cellalignment2621" id="r2c1-t9" headers="r1c1-t9"><code dir="ltr">DbgFl</code></td>
<td class="cellalignment2621" headers="r2c1-t9 r1c2-t9">Specifies if debugging should be enabled (debug flag). For more information refer to Debugging in the subsequent section in this chapter.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="sect3" -->
<div id="DFSIG236" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref89"></a>
<h4 class="sect3"><span class="secnum">8.4.1.3</span> Examples</h4>
<p>This section contains examples of open strings using the preceding information.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the string is longer than one line, then refer to the openUTM documentation for information about how to split up the string information.</div>
<p>For bequeath protocol:</p>
<pre dir="ltr">
Oracle_XA+Acc=P/scott/tiger+SesTm=0+DbgFl=15
</pre>
<p>For other protocols:</p>
<pre dir="ltr">
Oracle_XA+SqlNet=MADRID_FINANCE+Acc=P/scott/tiger+SesTm=0
Oracle_XA+DB=finance+SqlNet=MADRID_FINANCE+Acc=P/scott/tiger
+SesTM=0
</pre>
<p>The optional fields <code dir="ltr">LogDir</code>, <code dir="ltr">Loose_Coupling</code>, <code dir="ltr">SesWT</code>, and <code dir="ltr">Threads</code> are not supported.</p>
<p>For more information about the fields in the open string refer to the <span class="italic">Developing Applications with Oracle XA</span> section in <a class="olink ADFNS" href="../../appdev.112/e41502/toc.htm"><span class="italic">Oracle Database Advanced Application Developer's Guide</span></a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDDEAGJ"></a>
<div id="DFSIG237" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">8.4.2</span> <a id="sthref90"></a>Using Precompilers with openUTM</h3>
<p>You can choose from two options when interfacing with precompilers:</p>
<ul>
<li>
<p>Using precompilers with the default database</p>
</li>
<li>
<p>Using precompilers with a named database</p>
</li>
</ul>
<p>You should run all precompiler programs with the option <code dir="ltr">release_cursor</code> set to <code dir="ltr">no</code>. Precompiler programs may be written in C or COBOL. In the following examples, the precompiler Pro*C is used.</p>
<div id="DFSIG238" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref91"></a>
<h4 class="sect3"><span class="secnum">8.4.2.1</span> Using Pro*C with the Default Database</h4>
<p>If Pro*C applications access the default database, then ensure that the <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> field used in the open string is not present. The absence of this field indicates the default connection as defined in the <code dir="ltr">ORAENV</code> file, and only one default connection is allowed for each process.</p>
<p>The following is an example of an open string identifying a default Pro*C connection:</p>
<pre dir="ltr">
Oracle_XA+SqlNet=MADRID_FINANCE+Acc=P/scott/tiger+SesTm=0
</pre>
<p>Here, <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> is absent, indicating an empty database identifier string.</p>
<p>The following is the syntax of a select statement:</p>
<pre dir="ltr">
EXEC SQL SELECT ENAME FROM EMP;
</pre></div>
<!-- class="sect3" -->
<div id="DFSIG239" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref92"></a>
<h4 class="sect3"><span class="secnum">8.4.2.2</span> Using Pro*C with a Named Database</h4>
<p>If Pro*C applications access a named database, then include the <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> field in the open string. Any database you refer to must reference the same <code dir="ltr"><span class="codeinlineitalic">db_name</span></code> specified in the corresponding open string.</p>
<p>An application may access the default database, as well as one or more named databases, as shown in the following examples.</p>
<p>For example, suppose you want to update an employee's salary in one database, the department number <code dir="ltr">deptno</code> in another, and the manager information in a third database. You would configure the following open strings in the transaction manager:</p>
<pre dir="ltr">
Oracle_XA+SqlNet=MADRID_FINANCE1+Acc=P/scott/tiger+SesTm=0
Oracle_XA+DB=MANAGERS+SqlNet=MADRID_FINANCE2+
Acc=P/scott/tiger+SesTm=0
Oracle_XA+DB=PAYROLL+SqlNet=MADRID_FINANCE3+
Acc=P/scott/tiger+SesTm=0
</pre>
<p>There is no <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> field in the first open string.</p>
<p>In the application program, you would enter declarations such as:</p>
<pre dir="ltr">
EXEC SQL DECLARE PAYROLL DATABASE; 
EXEC SQL DECLARE MANAGERS DATABASE;
</pre>
<p>Again, the default connection corresponding to the first open string that does not contain the <code dir="ltr"><span class="codeinlineitalic">db_name</span></code> field, does not require a declaration.</p>
<p>When doing the update, enter statements similar to the following:</p>
<pre dir="ltr">
EXEC SQL AT PAYROLL update emp set sal=4500 where empno=7788;
EXEC SQL AT MANAGERS update emp set mgr=7566 where empno=7788;
EXEC SQL update emp set deptno=30 where empno=7788;
</pre>
<p>There is no AT clause in the last statement because it refers to the default database.</p>
<p>You can use a character host variable in the AT clause, as the following example shows:</p>
<pre dir="ltr">
EXEC SQL BEGIN DECLARE SECTION;
db_name1 CHARACTER(10);
db_name2 CHARACTER(10)
EXEC SQL END DECLARE SECTION;
.
.
set db_name1 = 'PAYROLL' 
set db_name2 = 'MANAGERS'
.
.
EXEC SQL AT :db_name1 UPDATE...
EXEC SQL AT :db_name2 UPDATE...
</pre>
<p>For more information, refer to the respective sections in the <a class="olink LNPCB" href="../../appdev.112/e10826/toc.htm"><span class="italic">Pro*COBOL Programmer's Guide</span></a> and <a class="olink LNPCC" href="../../appdev.112/e10825/toc.htm"><span class="italic">Pro*C/C++ Programmer's Guide</span></a> that discusses concurrent logons.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>openUTM applications must not create Oracle database connections of their own. Therefore, an openUTM user is not allowed to issue <code dir="ltr">CONNECT</code> statements within an openUTM program. Any work performed by them would be outside the global transaction, and may confuse the connection information given by openUTM.</p>
</li>
<li>
<p>SQL calls must not occur in the openUTM start exit routine, however may occur in the conversation exit routine (<code dir="ltr">Vorgangs-Exit</code>)</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDCJAHI"></a>
<div id="DFSIG240" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">8.5</span> <a id="sthref93"></a>Troubleshooting</h2>
<p>This section discusses how to recover data if there are problems or a system failure. Both trace files and recovering pending transactions are discussed in the following sections.</p>
<div id="DFSIG241" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref94"></a>
<h3 class="sect2"><span class="secnum">8.5.1</span> <a id="sthref95"></a>T<a id="sthref96"></a>race Files</h3>
<p>The Oracle XA library logs any error and tracing information to its trace file. This information is useful in supplementing the XA error codes. For example, it can indicate whether an open failure is caused by an incorrect open string, failure to find the Oracle Database instance, or a login authorization failure. The name of the trace file is:</p>
<pre dir="ltr">
ORAXALOG.<span class="italic">pid-db_name-date</span>.TRC
</pre>
<p>where</p>
<p><code dir="ltr"><span class="codeinlineitalic">pid</span></code> is the process identifier (TSN)</p>
<p><code dir="ltr"><span class="codeinlineitalic">db_name</span></code> is the database name you specified in the open string field <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code></p>
<p><code dir="ltr"><span class="codeinlineitalic">date</span></code> is the date when the trace file is created</p>
<div id="DFSIG242" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref97"></a>
<h4 class="sect3"><span class="secnum">8.5.1.1</span> Trace File Examples</h4>
<p>Examples of two types of trace files are discussed in this section.</p>
<p>The following example shows a trace file for an application's task '1234' that was opened on April 2nd 1999. The <code dir="ltr">DB</code> field for this application was not specified in the open string when the resource manager was opened</p>
<pre dir="ltr">
ORAXALOG.1234-NULL-990402.TRC
</pre>
<p>The following example shows a trace file that was created on December 15th 1998 by task <code dir="ltr">5678</code>. The <code dir="ltr">DB</code> field was specified as <code dir="ltr">FINANCE</code> in the open string when the resource manager was opened.</p>
<pre dir="ltr">
ORAXALOG.5678-FINANCE-981215.TRC
</pre>
<p>Each entry in the trace file contains information that looks like this:</p>
<pre dir="ltr">
1032.2: xa_switch rtn ORA-22
</pre>
<p>where <code dir="ltr">1032</code> is the time when the information is logged, <code dir="ltr">2</code> is the resource manager identifier, <code dir="ltr">xa_switch</code> is the module name, and <code dir="ltr">ORA-22</code> is the returned Oracle database information.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="DFSIG243" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref98"></a>
<h3 class="sect2"><span class="secnum">8.5.2</span> Debugging</h3>
<p>You can specify the <code dir="ltr">DbgFl</code> (debug flag) in the open string. For more information, refer to the <span class="italic">Oracle XA</span> chapter in <a class="olink ADFNS" href="../../appdev.112/e41502/toc.htm"><span class="italic">Oracle Database Advanced Application Developer's Guide</span></a>.</p>
<p>Depending on the debugging level (<code dir="ltr">low:DbgFl=1,high:DbgFl=15</code>) you can get more or less debug entries in the trace file <code dir="ltr">ORAXALOG</code>.<code dir="ltr"><span class="codeinlineitalic">pid-db_name-date</span></code>.<code dir="ltr">TRC</code> (refer to the preceding section).</p>
</div>
<!-- class="sect2" -->
<div id="DFSIG244" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref99"></a>
<h3 class="sect2"><span class="secnum">8.5.3</span> In-Doubt or Pending Transactions</h3>
<p>In-doubt or pending transactions are transactions that have been prepared but not yet committed to the database. Generally, openUTM resolves any in-doubt or pending transaction. However, the Database Administrator may have to override an in-doubt transaction in working with UTM-F, that is, <code dir="ltr">APPLIMODE</code>=<code dir="ltr">FAST</code>, for example when the in-doubt transaction is:</p>
<ul>
<li>
<p>Locking data that is required by other transactions</p>
</li>
<li>
<p>Not resolved in a reasonable amount of time</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Overriding in-doubt transactions can cause inconsistency between openUTM and the database. For example, if the DB transaction is committed by the Database Administrator and the openUTM application rolls back the transaction in the warm-start phase, then the Oracle Database cannot roll this committed transaction back, therefore, causing an inconsistency.</div>
</div>
<!-- class="sect2" -->
<div id="DFSIG245" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref100"></a>
<h3 class="sect2"><span class="secnum">8.5.4</span> Oracle Database SYS Account Tables</h3>
<p>There are four tables under the Oracle Database <code dir="ltr">SYS</code> account that contain transactions generated by regular Oracle Database applications and Oracle Database/openUTM applications. These are as follows:</p>
<ul>
<li>
<p><code dir="ltr">DBA_2PC_PENDING</code></p>
</li>
<li>
<p><code dir="ltr">DBA_2PC_NEIGHBORS</code></p>
</li>
<li>
<p><code dir="ltr">DBA_PENDING_TRANSACTIONS</code></p>
</li>
<li>
<p><code dir="ltr">V$GLOBAL_TRANSACTION</code></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
For detailed information about how to use these tables, refer to the sections in the <a class="olink ADMIN" href="../../server.112/e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a> that discuss failures during two-phase commit and manually overriding in-doubt transactions.</div>
<p>For transactions generated by Oracle Database/openUTM applications, the following column information applies specifically to the <code dir="ltr">DBA_2PC_NEIGHBORS</code> table:</p>
<ul>
<li>
<p>The <code dir="ltr">DBID</code> column is always <code dir="ltr">xa_orcl</code>.</p>
</li>
<li>
<p>The <code dir="ltr">DBUSER_OWNER</code> column is always <code dir="ltr"><span class="codeinlineitalic">db_namexa.oracle.com</span></code>.</p>
</li>
</ul>
<p>Remember that the <code dir="ltr"><span class="codeinlineitalic">db_name</span></code> is always specified as <code dir="ltr">DB</code>=<code dir="ltr"><span class="codeinlineitalic">db_name</span></code> in the open string. If you do not specify this field in the open string, then the value of this column is <code dir="ltr">NULLxa.oracle.com</code> for transactions that are generated by Oracle Database/openUTM applications.</p>
<p>For example, you could use the following sample SQL statement to find out more information about in-doubt transactions that are generated by Oracle Database/openUTM applications.</p>
<pre dir="ltr">
SELECT * FROM DBA_2PC_PENDING p, DBA_2PC_NEIGHBORS n 
WHERE p.LOCAL_TRAN_ID = n.LOCAL_TRAN_ID AND n.DBID = 'xa_orcl'; 
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2612">
<tr>
<td class="cellalignment2621">
<table class="cellalignment2617">
<tr>
<td class="cellalignment2616"><a href="tuning.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2616"><a href="netv2.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2623">
<table class="cellalignment2615">
<tr>
<td class="cellalignment2616"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2616"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2616"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2616"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2616"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2616"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
