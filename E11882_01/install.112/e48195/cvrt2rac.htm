<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Converting to Oracle RAC and Oracle RAC One Node from Single-Instance Oracle Databases</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1041" />
<meta name="dcterms.created" content="2015-02-05T19:13:54Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Real Application Clusters Installation Guide" />
<meta name="dcterms.identifier" content="E48195-02" />
<meta name="dcterms.isVersionOf" content="RIWIN" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="scripts.htm" title="Previous" type="text/html" />
<link rel="Next" href="apa.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e48195.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">17/22</span> <!-- End Header -->
<div id="RIWIN1106" class="appendix"><a id="BABBAHCH"></a>
<h1 class="appendix"><span class="secnum">C</span> Converting to Oracle RAC and Oracle RAC One Node from Single-Instance Oracle Databases</h1>
<p><a id="sthref610"></a><a id="sthref611"></a>This appendix describes the procedures for converting from Oracle Database 11<span class="italic">g</span> release 2 (11.2) single-instance databases to Oracle Real Application Clusters (Oracle RAC) and Oracle RAC One Node databases.</p>
<p><a id="sthref612"></a>The procedures in this appendix assume that your original single-instance database and the target Oracle RAC database are using the same release, and running on the same platform. If you are upgrading from an earlier release of Oracle RAC to Oracle RAC 11<span class="italic">g</span> release 2, then use the Oracle Database Upgrade Assistant (DBUA).</p>
<p>This appendix contains the following topics:</p>
<ul>
<li>
<p><a href="#BABCEAIG">Administrative Issues for Converting Databases to Oracle RAC</a></p>
</li>
<li>
<p><a href="#BABBBDDB">Converting to Oracle RAC and Oracle RAC One Node Using DBCA</a></p>
</li>
<li>
<p><a href="#BABGGEGJ">Converting Databases to Oracle RAC Using rconfig</a></p>
</li>
<li>
<p><a href="#BABBAAEH">Preparing to Convert with rconfig and Oracle Enterprise Manager</a></p>
</li>
<li>
<p><a href="#BABGGEGJ">Converting Databases to Oracle RAC Using rconfig</a></p>
</li>
<li>
<p><a href="#BABCHDBB">Example of rconfig XML Input Files for ConvertToRAC</a></p>
</li>
<li>
<p><a href="#BABGBIEH">Postconversion Steps</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
You must use clustered Oracle Automatic Storage Management (Oracle ASM) instances for Oracle RAC databases.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBLIC" href="../../license.112/e47877/toc.htm"><span class="italic">Oracle Database Licensing Information</span></a> for compliance requirements that apply to the license you have purchased</div>
<a id="BABCEAIG"></a>
<div id="RIWIN1107" class="sect1">
<h2 class="sect1"><span class="secnum">C.1</span> Administrative Issues for Converting Databases to Oracle RAC</h2>
<p>Note the following <a id="sthref613"></a>administrative considerations before converting single-instance databases to Oracle RAC:</p>
<ul>
<li>
<p>B<a id="sthref614"></a>ackup procedures should be available before converting from a single-instance Oracle Database to Oracle RAC. This includes taking a backup of your existing database before converting to Oracle RAC and being prepared to backup your Oracle RAC database immediately following the conversion.</p>
</li>
<li>
<p>For <a id="sthref615"></a>archiving with Oracle RAC environments, the archive file format requires a thread number.</p>
</li>
<li>
<p><a id="sthref616"></a>The archived logs from all instances of an Oracle RAC database are required for media recovery. Because of this, if you archive to a file and you do not use a cluster file system, or some other means to provide shared file systems, then you require a method of accessing the archive logs from all nodes on which the cluster database has instances.</p>
</li>
<li>
<p><a id="sthref617"></a><a id="sthref618"></a><a id="sthref619"></a>By default, all database files are migrated to Oracle Managed Files (OMF). This feature simplifies tablespace creation, ensures data file location consistency and compliance with Oracle Flexible Architecture (OFA) rules, and reduces human error with data file management.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink TDPRC217" href="../../rac.112/e17264/adminrac.htm#TDPRC217"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for information about redo logs and redo threads</div>
</div>
<!-- class="sect1" -->
<a id="BABBBDDB"></a>
<div id="RIWIN1108" class="sect1">
<h2 class="sect1"><span class="secnum">C.2</span> Converting to Oracle RAC and Oracle RAC One Node Using DBCA</h2>
<p><a id="sthref620"></a><a id="sthref621"></a>You can use Oracle Database Configuration Assistant (DBCA) to convert from single-instance Oracle databases to Oracle RAC or Oracle RAC One Node databases. DBCA automates the configuration of the control file attributes, creates the undo tablespaces and the redo logs, and creates the initialization parameter file entries for cluster-enabled environments. DBCA also configures Oracle Net Services, Oracle Clusterware resources, and the configuration for Oracle RAC database management for use by Oracle Enterprise Manager or the Server Control utility (SRVCTL).</p>
<p>Before you use DBCA to convert a single-instance database to an Oracle RAC or an Oracle RAC One Node database, ensure that your system meets the following conditions: <a id="sthref622"></a></p>
<ul>
<li>
<p>Your system uses supported hardware and operating system software. Your system is configured properly to support an Oracle RAC database.</p>
</li>
<li>
<p>The nodes have access to shared storage; either Oracle Cluster File System for Windows (OCFS for Windows) or Oracle ASM is available and accessible from all nodes.</p>
</li>
<li>
<p>Your applications have no design characteristics that preclude their use with cluster database processing.</p>
</li>
</ul>
<p><a id="sthref623"></a>If your platform supports a cluster file system, then you can use it for Oracle RAC. You can also convert to Oracle RAC and use a nonshared file system. In either case, Oracle strongly recommends that you use Oracle Universal Installer (OUI) to perform an Oracle Database 11<span class="italic">g</span> release 2 (11.2) installation that sets up the Oracle home and inventory in an identical location on each of the selected nodes in your cluster.</p>
<p>This section describes the following scenarios:</p>
<ul>
<li>
<p><a href="#BABFIJEF">Converting Oracle Database 11<span class="italic">g</span> Installations to Oracle RAC Using DBCA</a></p>
</li>
<li>
<p><a href="#CIHBHACF">Converting Single Instance on a Cluster to Oracle RAC One Node Using DBCA</a></p>
</li>
<li>
<p><a href="#BABIECBB">Converting Single Instance on a Cluster to Oracle RAC Using DBCA</a></p>
</li>
<li>
<p><a href="#CIHGFEGJ">Converting an Oracle RAC One Node Database to an Oracle RAC Database</a></p>
</li>
</ul>
<a id="BABFIJEF"></a>
<div id="RIWIN1109" class="sect2">
<h3 class="sect2"><span class="secnum">C.2.1</span> Converting Oracle Database 11<span class="italic">g</span> Installations to Oracle RAC Using DBCA</h3>
<p>To convert from a single-instance Oracle Database that is on a <a id="sthref624"></a>nonclustered computer to Oracle RAC, perform the procedures described in the following sections, and in the order shown:</p>
<ul>
<li>
<p><a href="#BABEEJHA">Use DBCA to Create an Image of the Single-Instance Database</a></p>
</li>
<li>
<p><a href="#CHDJIBFB">Complete the Oracle Clusterware Installation</a></p>
</li>
<li>
<p><a href="#BABCADHG">Validate the Cluster</a></p>
</li>
<li>
<p><a href="#BABDEBBI">Copy the Preconfigured Database Image</a></p>
</li>
<li>
<p><a href="#BABFFHCA">Install Oracle Database 11<span class="italic">g</span> Software with Oracle RAC</a></p>
</li>
</ul>
<a id="BABEEJHA"></a>
<div id="RIWIN1110" class="sect3">
<h4 class="sect3"><span class="secnum">C.2.1.1</span> Use DBCA to Create an Image of the Single-Instance Database</h4>
<p>Use DBCA to create a preconfigured image of your single-instance database by using the following procedure:</p>
<ol>
<li>
<p>Go to the <code dir="ltr">bin</code> directory in <code dir="ltr">%ORACLE_HOME%</code>, and start DBCA.</p>
</li>
<li>
<p>At the Welcome page, click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Operations page, select <span class="bold">Manage Templates</span>, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Template Management page, select <span class="bold">Create a database template</span> and <span class="bold">From an existing database (structure as well as data)</span>, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Source Database page, select the database name in the Database instance list, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Template Properties page, enter a name for your template in the Name field. Oracle recommends that you use the database name.</p>
<p>By default, the template files are generated in the directory <code dir="ltr">%ORACLE_HOME%</code><code dir="ltr">\assistants\dbca\templates</code>. You can enter a description of the file in the Description field and change the template file location in the Template data file field.</p>
<p>When you have completed the entries, click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Location of Database Related Files page, select <span class="bold">Maintain the file locations</span>, so that you can restore the database to the current directory structure, and click <span class="bold">Finish</span>.</p>
</li>
</ol>
<p>DBCA generates two files: a database structure file (<code dir="ltr"><span class="codeinlineitalic">template_name</span></code><code dir="ltr">.dbc</code>), and a database preconfigured image file (<code dir="ltr"><span class="codeinlineitalic">template_name</span></code><code dir="ltr">.dfb</code>).</p>
</div>
<!-- class="sect3" -->
<a id="CHDJIBFB"></a>
<div id="RIWIN1111" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">C.2.1.2</span> Complete the Oracle Clusterware Installation</h4>
<p>Complete the installation of Oracle Clusterware, as described in <a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your platform.</p>
</div>
<!-- class="sect3" -->
<a id="BABCADHG"></a>
<div id="RIWIN1112" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">C.2.1.3</span> Validate the Cluster</h4>
<p>Validate the cluster configuration using Cluster Verification Utility (CVU). See <a href="chklist.htm#BHADJBGF">Section 1.6, "Confirming Cluster Readiness Using Cluster Verification Utility"</a> for instructions on how to use CVU.</p>
</div>
<!-- class="sect3" -->
<a id="BABDEBBI"></a>
<div id="RIWIN1113" class="sect3">
<h4 class="sect3"><span class="secnum">C.2.1.4</span> Copy the Preconfigured Database Image</h4>
<p>Copy the preconfigured database image. This includes copying the database structure <code dir="ltr">*.dbc</code> file and the database preconfigured image <code dir="ltr">*.dfb</code> file that DBCA created in <a href="#BABEEJHA">Section C.2.1.1, "Use DBCA to Create an Image of the Single-Instance Database"</a> to a temporary location on the node in the cluster from which you plan to run DBCA.</p>
</div>
<!-- class="sect3" -->
<a id="BABFFHCA"></a>
<div id="RIWIN1114" class="sect3">
<h4 class="sect3"><span class="secnum">C.2.1.5</span> Install Oracle Database 11<span class="italic">g</span> Software with Oracle RAC</h4>
<ol>
<li>
<p>Run OUI to perform an Oracle Database installation with Oracle RAC.</p>
</li>
<li>
<p>Select <span class="bold">Cluster Installation Mode</span> on the Specify Hardware Cluster Installation page of OUI, and select the nodes to include in your Oracle RAC database.</p>
</li>
<li>
<p><a id="sthref625"></a><a id="sthref626"></a>On the OUI Database Configuration Types page, select the <span class="bold">Advanced</span> installation type.</p>
<p>After installing the Oracle Database software, OUI runs postinstallation configuration tools, such as Oracle Net Configuration Assistant (NETCA), DBCA, and so on.</p>
</li>
<li>
<p>On the DBCA Template Selection page, use the template that you copied to a temporary location in <a href="#BABDEBBI">Section C.2.1.4, "Copy the Preconfigured Database Image."</a> Use the browse option to select the template location.</p>
<p>Select the option that you want to deploy. Your choices are the following: Oracle RAC database; Oracle RAC One Node database; or Oracle single instance database.</p>
</li>
<li>
<p>After creating the Oracle RAC database, DBCA displays the Password Management page on which you must change the passwords for database users who have SYSDBA and SYSOPER privileges. When DBCA exits, the conversion process is complete.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Raw devices are not supported with OUI or DBCA in Oracle Database 11<span class="italic">g</span> release 2 (11.2). To use raw storage for your database, you must follow the instructions in <a href="#CIHDCFFA">Section C.2.3.1.2, "Manual Conversion Procedure."</a></div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink NTQRF130" href="../../win.112/e10845/external.htm#NTQRF130"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for more information about configuring user roles</p>
</li>
<li>
<p><a href="dbcacrea.htm#BGBIJGDA">Chapter 3, "Creating Oracle Real Application Clusters Databases with Oracle Database Configuration Assistant"</a> for more information about using DBCA</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CIHBHACF"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.2.2</span> Converting Single Instance on a Cluster to Oracle RAC One Node Using DBCA</h3>
<p>Use DBCA to convert a single-instance Oracle Database to Oracle RAC One Node by using the following procedure:</p>
<ol>
<li>
<p>Go to the directory <code dir="ltr">%ORACLE_HOME%\bin</code>.</p>
</li>
<li>
<p>Start DBCA:</p>
<pre dir="ltr">
C:\..\bin&gt; dbca
</pre></li>
<li>
<p>From the Welcome window, select <span class="bold">Oracle Real Application Clusters</span> database.</p>
</li>
<li>
<p>Use the template that you selected to deploy in <a href="#BABFFHCA">Section C.2.1.5, "Install Oracle Database 11<span class="italic">g</span> Software with Oracle RAC."</a></p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABIECBB"></a>
<div id="RIWIN1115" class="sect2">
<h3 class="sect2"><span class="secnum">C.2.3</span> Converting Single Instance on a Cluster to Oracle RAC Using DBCA</h3>
<p>There are three scenarios in which a <a id="sthref627"></a>single-instance database can exist on a server that is a node in a cluster:</p>
<ul>
<li>
<p>Scenario 1: The Oracle home for the single-instance database was installed on a cluster node and has Oracle RAC enabled. The steps to perform a conversion to Oracle RAC in this scenario are described in <a href="#CIHBFAEJ">Section C.2.3.1, "Single-Instance Database an Oracle RAC-Enabled Home"</a>.</p>
</li>
<li>
<p>Scenario 2: The Oracle home for the single-instance database was installed on a cluster node, but the Oracle RAC feature is disabled for this Oracle home. Refer to <a href="#CIHHGIEC">Section C.2.3.2, "Single-Instance Database Using an Oracle RAC-Disabled Home"</a> for instructions on how to convert the database to Oracle RAC in this environment.</p>
</li>
<li>
<p>Scenario 3: The Oracle home for the single-instance database was installed on only the local node in a cluster. This happens when you select the Local Installation option on the OUI Specify Hardware Cluster Installation page during the Oracle Database 11<span class="italic">g</span> release 2 (11.2) installation. The procedure to convert the single-instance database to Oracle RAC in this scenario is the same as that described in <a href="#BABFIJEF">Section C.2.1, "Converting Oracle Database 11<span class="italic">g</span> Installations to Oracle RAC Using DBCA."</a> In the last step, <a href="#BABFFHCA">"Install Oracle Database 11<span class="italic">g</span> Software with Oracle RAC"</a>, make sure that you select a new Oracle home, not the one from which the single-instance database is running.</p>
</li>
</ul>
<a id="CIHBFAEJ"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">C.2.3.1</span> Single-Instance Database an Oracle RAC-Enabled Home</h4>
<p>Perform the following procedures to convert a single-instance database on a cluster node running from an Oracle home that has the Oracle RAC option enabled.</p>
<ol>
<li id="CIHIEBCB">
<p>Use DBCA to create a preconfigured image of your single-instance database as described in <a href="#BABEEJHA">Section C.2.1.1, "Use DBCA to Create an Image of the Single-Instance Database."</a> To perform the conversion manually, shut down the single-instance database.</p>
</li>
<li id="CIHECDED">
<p>To add nodes to your cluster, follow the instructions to add and connect these nodes to the cluster as described in "Adding a Node to a Cluster on Windows Systems" in the <a class="olink CWADD90996" href="../../rac.112/e41959/adddelclusterware.htm#CWADD90996"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a>. Ensure that all nodes can access the shared storage used by Oracle Clusterware and Oracle RAC.</p>
</li>
<li>
<p>From the existing Oracle home, extend this home to the new nodes using the procedure "Adding Oracle RAC to Nodes with Oracle Clusterware Installed" as described in the <a class="olink RACAD8196" href="../../rac.112/e41960/adddelwin.htm#RACAD8196"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a>.</p>
</li>
<li>
<p>From a newly added node, configure the listeners on the additional nodes using Oracle Net Configuration Assistant (NETCA). Choose the same port number and protocol that you used on the existing node. If NETCA displays the existing node in the node list page, then do not select this node, because the listener is already configured on it.</p>
</li>
<li>
<p>Convert the database using one of the following procedures:</p>
<ul>
<li>
<p><a href="#CIHIFJFE">Automated Conversion Procedure Using DBCA</a></p>
</li>
<li>
<p><a href="#CIHDCFFA">Manual Conversion Procedure</a></p>
</li>
</ul>
</li>
</ol>
<a id="CIHIFJFE"></a>
<div class="sect4">
<h5 class="sect4"><span class="secnum">C.2.3.1.1</span> Automated Conversion Procedure Using DBCA</h5>
<p>If you used DBCA to create a preconfigured image of your single-instance database as described in <a href="#BABEEJHA">Section C.2.1.1, "Use DBCA to Create an Image of the Single-Instance Database,"</a> then perform the following steps to complete the conversion:</p>
<ol>
<li>
<p><a id="sthref628"></a>Start DBCA from the initial node. Select the names of the nodes to include as part of your cluster database. On the Template Selection page, select the preconfigured template that you created. Enter the database name and respond to the remaining DBCA prompts.</p>
</li>
<li>
<p>Specify the shared storage location for the Oracle Database data files. To use raw devices for the data files, you cannot use DBCA. Instead, follow the steps documented in <a href="#CIHDCFFA">Section C.2.3.1.2, "Manual Conversion Procedure."</a></p>
</li>
</ol>
<p>After creating the Oracle RAC database, DBCA displays the Password Management page on which you must change the passwords for the database users who have SYSDBA and SYSOPER privileges. When DBCA exits, the conversion process is complete.</p>
</div>
<!-- class="sect4" -->
<a id="CIHDCFFA"></a>
<div class="sect4">
<h5 class="sect4"><span class="secnum">C.2.3.1.2</span> Manual Conversion Procedure</h5>
<p>If you did not use DBCA to create a preconfigured image of your single-instance database as described in <a href="#BABEEJHA">Section C.2.1.1, "Use DBCA to Create an Image of the Single-Instance Database,"</a> then perform the following steps to complete the conversion:</p>
<ol>
<li>
<p><a id="sthref629"></a><a id="sthref630"></a>Create the OFA directory structure on each of the nodes that you have added.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="apa.htm#CDEBJEFD">Section D.2, "Directory Structures for Oracle RAC"</a> for more information about OFA</div>
</li>
<li>
<p>If you are converting single-instance database files on a file system to raw devices, then copy the database data files, control files, redo logs, and SPFILE to their corresponding raw devices using the <code dir="ltr">ocopy</code> command. Otherwise, continue to the next step.</p>
</li>
<li>
<p>Re-create the control files by running the <code dir="ltr">CREATE CONTROLFILE</code> SQL statement with the <code dir="ltr">REUSE</code> keyword and specify <code dir="ltr">MAXINSTANCES</code> and <code dir="ltr">MAXLOGFILES</code>, and so on, as needed for your Oracle RAC configuration. The <code dir="ltr">MAXINSTANCES</code> recommended default is 32.</p>
</li>
<li>
<p>Shut down the database instance.</p>
</li>
<li id="CIHDEBJI">
<p>If your single-instance database was using an SPFILE, then create a temporary parameter file (PFILE) from the SPFILE using the following SQL statement:</p>
<pre dir="ltr">
CREATE PFILE='pfile_name' from spfile='spfile_name'
</pre></li>
<li>
<p>Set the <code dir="ltr">CLUSTER_DATABASE</code> parameter to <code dir="ltr">TRUE</code>, set the <code dir="ltr">INSTANCE_NUMBER</code> parameter to a unique value for each instance, using the <code dir="ltr"><span class="codeinlineitalic">sid</span></code><code dir="ltr">.</code><code dir="ltr"><span class="codeinlineitalic">parameter</span></code><code dir="ltr">=</code><code dir="ltr"><span class="codeinlineitalic">value</span></code> syntax.</p>
<p>If you optimized memory usage on your single-instance database, then adjust the size of the System Global Area (SGA) to avoid swapping and paging when you convert to Oracle RAC. You should make this adjustment because Oracle RAC requires about 350 bytes for each buffer to accommodate the Global Cache Service (GCS). For example, if you have 10,000 buffers, then Oracle RAC requires about 350 multiplied by 10,000 bytes more memory. Therefore, adjust the size of the SGA by changing the <code dir="ltr">DB_CACHE_SIZE</code> and <code dir="ltr">DB_nK_CACHE_SIZE</code> parameters accordingly.</p>
</li>
<li>
<p>Start the database instance using the PFILE created in Step <a href="#CIHDEBJI">5</a>.</p>
</li>
<li>
<p><a id="sthref631"></a>If your single-instance database was using automatic undo management, then create an undo tablespace for each additional instance using the <code dir="ltr">CREATE UNDO TABLESPACE</code> SQL statement. If you are using raw devices, then ensure that the data file for the undo tablespace is on the raw device.</p>
</li>
<li>
<p>Create redo threads that have at least two redo logs for each additional instance. If you are using raw devices, then ensure that the redo log files are on raw devices. Enable the new redo threads by using an <code dir="ltr">ALTER DATABASE</code> SQL statement. Then, shut down the database instance.</p>
</li>
<li>
<p><a id="sthref632"></a>Copy the Oracle password file from the initial node, or from the node on which you are working, to the corresponding location on the additional nodes on which the cluster database will have an instance. Replace the <code dir="ltr">ORACLE_SID</code> name in each password file appropriately for each additional instance.</p>
</li>
<li>
<p>Set the <code dir="ltr">REMOTE_LISTENER</code> parameter to the single client access name (SCAN) and port.</p>
</li>
<li>
<p>Configure the net service entries for the database and instances, and address entries for the <code dir="ltr">LOCAL_LISTENER</code> for each instance and for the <code dir="ltr">REMOTE_LISTENER</code> in the <code dir="ltr">tnsnames.ora</code> file. When you have done this, copy the <code dir="ltr">tnsnames.ora</code> file to all nodes.</p>
</li>
<li>
<p>Create the SPFILE from the PFILE using the procedures in <a href="params.htm#CIHICJBD">Section 5.5, "Migrating to an SPFILE in Oracle RAC Environments."</a> If you are not using Oracle ASM or a cluster file system, then ensure that the SPFILE is on a raw device that is accessible from every node in the cluster.</p>
</li>
<li>
<p>Create the <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code><code dir="ltr">\database\init</code><code dir="ltr"><span class="codeinlineitalic">sid</span></code><code dir="ltr">.ora</code> file that contains the following entry, where <code dir="ltr"><span class="codeinlineitalic">spfile_path_name</span></code> is the complete path name of the SPFILE:</p>
<pre dir="ltr">
spfile=<span class="italic">'spfile_path_name</span>'
</pre></li>
<li>
<p>On the local node, use SQL*Plus to run <code dir="ltr">catclust.sql</code>. This script creates the dictionary views needed for Oracle RAC databases. For example:</p>
<pre dir="ltr">
SQL&gt; start %ORACLE_HOME%\rdbms\admin\catclust.sql
</pre></li>
<li>
<p>Add the configuration for the Oracle RAC or Oracle RAC One Node database and its instance-to-node mapping using SRVCTL.</p>
<ol>
<li>
<p>To add the configuration of an Oracle RAC database, use the following commands:</p>
<pre dir="ltr">
srvctl add database -d <span class="italic">db_name</span> -o <span class="italic">Oracle_home</span> -p <span class="italic">spfile_path_name</span>
srvctl add instance -d <span class="italic">db_name</span> -i <span class="italic">inst1_name</span> -n <span class="italic">node1_name</span>
srvctl add instance -d <span class="italic">db_name</span> -i <span class="italic">inst2_name</span> -n <span class="italic">node2_name</span>
...
</pre></li>
<li>
<p>To add the configuration of an Oracle RAC One Node database, use the following command:</p>
<pre dir="ltr">
srvctl add database -d <span class="italic">db_name</span> -c RACONENODE -o <span class="italic">Oracle_home</span>
-p <span class="italic">spfile_path_name</span>
</pre></li>
</ol>
</li>
<li>
<p>Start the Oracle RAC or Oracle RAC One Node database using SRVCTL:</p>
<pre dir="ltr">
C:\&gt; srvctl start database -d <span class="italic">db_name</span>
</pre></li>
</ol>
<p>After starting the database with SRVCTL, your conversion process is complete. You can run the following SQL statement to see the status of all the instances in your Oracle RAC database:</p>
<pre dir="ltr">
SQL&gt; select * from v$active_instances;
</pre></div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="CIHHGIEC"></a>
<div class="sect3">
<h4 class="sect3"><span class="secnum">C.2.3.2</span> Single-Instance Database Using an Oracle RAC-Disabled Home</h4>
<p>You can create a single-instance database on a cluster using an Oracle home with the Oracle RAC option disabled. To create an Oracle home on a cluster with Oracle RAC disabled, you can select <span class="bold">local</span> and <span class="bold">non-cluster</span> on the Node Selection Page of Oracle Universal Installer (OUI) when installing the Oracle Database software. You can also performed a one-node cluster (with Oracle RAC) installation, but later disable the Oracle RAC option.</p>
<p>Perform the following procedures to convert this type of single-instance database to an Oracle RAC or Oracle RAC One Node database:</p>
<ol>
<li id="CIHHCEDG">
<p>Use DBCA to create a preconfigured image of your single-instance database as described in <a href="#BABEEJHA">Section C.2.1.1, "Use DBCA to Create an Image of the Single-Instance Database."</a> To perform the conversion manually, shut down the single-instance database.</p>
</li>
<li>
<p>Go to the <code dir="ltr">bin</code> subdirectory in the Oracle home.</p>
</li>
<li>
<p>Enable the Oracle RAC option by renaming the <code dir="ltr">orarac11.dll.dbl</code> file using the following command:</p>
<pre dir="ltr">
C:\..\bin&gt; copy /Y orarac11.dll.dbl orarac11.dll
</pre></li>
<li>
<p>Continue with step <a href="#CIHECDED">2</a> in <a href="#CIHBFAEJ">Section C.2.3.1, "Single-Instance Database an Oracle RAC-Enabled Home."</a></p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CIHGFEGJ"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.2.4</span> Converting an Oracle RAC One Node Database to an Oracle RAC Database</h3>
<p>You can convert an Oracle RAC One Node database to an Oracle RAC database by logging in as the Oracle RAC One Node database owner and entering the following SRVCTL command:</p>
<pre dir="ltr">
C:\&gt; srvctl convert database -c RAC
</pre>
<div class="infobox-note">
<p class="notep1">Caution:</p>
By default, any named user may create a server pool. To restrict the operating system users that have this privilege, Oracle strongly recommends that you add specific users to the CRS Administrators list. See <a class="olink CWADD91105" href="../../rac.112/e41959/admin.htm#CWADD91105"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for more information about adding users to the CRS Administrators list.</div>
<p>After you run this command, you must create server pools for each database service, in addition to the database server pool. The values for <code dir="ltr">SERVER_NAMES</code> for the server pools used by the database services must be set to the node that you converted from an Oracle RAC One Node to an Oracle RAC node. You can use the CRSCTL utility or Oracle Enterprise Manager to create and configure the server pools.</p>
<p>Converting an administrator-managed Oracle RAC One Node database to an Oracle RAC database configures all database services so that the single instance is the preferred instance for that service. After you convert the database, you can add instances to your database by using the SRVCTL <code dir="ltr">add</code> <code dir="ltr">instance</code> command.</p>
<p>Converting a policy-managed Oracle RAC One Node database to an Oracle RAC database sets all database services to UNIFORM cardinality. It also results in reusing the server pool in which the database currently runs. The conversion reconfigures the database to run on all of the nodes in the server pool. The command does not start any additional instances but executing the SRVCTL <code dir="ltr">start</code> <code dir="ltr">database</code> command starts the database on all of the nodes in the server pool.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink RACAD" href="../../rac.112/e41960/toc.htm"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about policy-managed and administrator-managed databases, server pools, and database services.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABBAAEH"></a>
<div id="RIWIN1121" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">C.3</span> Preparing to Convert with rconfig and Oracle Enterprise Manager<a id="sthref633"></a><a id="sthref634"></a><a id="sthref635"></a></h2>
<p><a id="sthref636"></a>You can use <code dir="ltr">rconfig</code>, or Oracle Enterprise Manager to assist with converting a single-instance database installation to an Oracle RAC database. The first of these, <code dir="ltr">rconfig</code>, is a command-line utility. Oracle Enterprise Manager Grid Control database administration option, Convert to Cluster Database, provides a GUI-based conversion tool. The following sections describe how to use these conversion tools:</p>
<ul>
<li>
<p><a href="#BABGEEEG">Prerequisites for Converting to Oracle RAC Databases</a></p>
</li>
<li>
<p><a href="#BABDDBHB">Configuration Changes During Oracle RAC Conversion Using rconfig</a></p>
</li>
<li>
<p><a href="#BABFCAHF">Converting Databases to Oracle RAC Using rconfig or Enterprise Manager</a></p>
</li>
<li>
<p><a href="#BABCDIBJ">Converting Databases to Oracle RAC Using Oracle Enterprise Manager</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before you start the conversion, back up your existing database; you should take a backup of your database before starting any major change.</div>
<a id="BABGEEEG"></a>
<div id="RIWIN1122" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.3.1</span> Prerequisites for Converting to Oracle RAC Databases</h3>
<p>Before you convert a single-instance database to an Oracle RAC database, ensure that the following conditions are met for each cluster node that you intend to make an Oracle RAC database node:</p>
<ul>
<li>
<p>Oracle Clusterware 11<span class="italic">g</span> release 2 (11.2) is installed, configured, and running.</p>
</li>
<li>
<p>Oracle RAC 11<span class="italic">g</span> release 2 (11.2) software is installed.</p>
</li>
<li>
<p>The Oracle software has the Oracle RAC option enabled.</p>
</li>
<li>
<p>Shared storage, either Oracle Cluster File System or Oracle ASM, is available and accessible from all nodes.</p>
</li>
<li>
<p>User equivalence exists for the <code dir="ltr">oracle</code> account, or the user account used to install the Oracle software.</p>
</li>
<li>
<p>If you intend to use Oracle Enterprise Manager, then the Oracle Management Agent on each node is configured and running, and is configured with cluster and host information.</p>
</li>
<li>
<p>You have backed up your existing database.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
You must use clustered Oracle ASM instances for Oracle RAC databases. Oracle ASM is installed with the Oracle Grid Infrastructure software.</div>
</div>
<!-- class="sect2" -->
<a id="BABDDBHB"></a>
<div id="RIWIN1123" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.3.2</span> Configuration Changes During Oracle RAC Conversion Using rconfig</h3>
<p>The following changes occur when you convert a single-instance database to Oracle RAC using the <code dir="ltr">rconfig</code> utility"</p>
<ul>
<li>
<p>During the conversion, <code dir="ltr">rconfig</code> places the target Oracle RAC database into archive log mode, and enables archiving for the database. If you do not plan to use archive log space, then you can disable archive logging after the conversion has completed.</p>
</li>
<li>
<p>For the Shared Storage Type value, if you enter <span class="bold">CFS</span>, and you use a cluster file system for your single-instance database storage, then <code dir="ltr">rconfig</code> converts the environment to use Oracle Managed Files (OMF) for database storage, and places the data files in a subdirectory located under the shared storage location.</p>
</li>
<li>
<p>During the conversion, <code dir="ltr">rconfig</code> moves database files to a specified shared location, and configures them using OMF.</p>
<p>To avoid using OMF with your converted database, the single-instance database files must be located in a shared file system, and you must indicate that <code dir="ltr">rconfig</code> should not move the files.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABFCAHF"></a>
<div id="RIWIN1124" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.3.3</span> Converting Databases to Oracle RAC Using rconfig or Enterprise Manager</h3>
<p>The following list describes scenarios for converting a single-instance Oracle database to an Oracle RAC database:</p>
<ul>
<li>
<p>Converting a single-instance Oracle Database 11<span class="italic">g</span> release 2 (11.2) database to an Oracle RAC 11<span class="italic">g</span> release 2 (11.2) database, running out of the <span class="italic">same</span> Oracle home and using the same data files as the single-instance database.</p>
<p>In this scenario, run the <code dir="ltr">rconfig</code> utility from the Oracle RAC database home, or use the Convert to RAC option on the single-instance database target of Oracle Enterprise Manager Grid Control.</p>
</li>
<li>
<p>Converting a single-instance database that uses a release of Oracle Database earlier than Oracle Database 11<span class="italic">g</span> release 2 (11.2) to an Oracle RAC 11<span class="italic">g</span> release 2 (11.2) database, running out of the same Oracle home and using the same data files as the single-instance database</p>
<p>In this scenario, use OUI and DBUA to update the single-instance database to Oracle Database 11<span class="italic">g</span> release 2 (11.2). Then, use <code dir="ltr">rconfig</code> or the Oracle Enterprise Manager Convert to RAC option, as described in the preceding scenario.</p>
</li>
<li>
<p>Converting a single-instance Oracle Database 11<span class="italic">g</span> release 2 (11.2) to an Oracle RAC 11<span class="italic">g</span> release 2 (11.2) database, running out of a <span class="italic">different</span> Oracle home and using the same data files as the single-instance database.</p>
<p>In this scenario, run the <code dir="ltr">rconfig</code> utility in the target database home, or use the Convert to RAC option in the single-instance database target of Oracle Enterprise Manager Grid Control. Provide the file storage location when prompted.</p>
</li>
<li>
<p>Converting a single-instance Oracle Database 11<span class="italic">g</span> release 2 (11.2) database to an Oracle RAC 11<span class="italic">g</span> release 2 (11.2) database, running out of a <span class="italic">different</span> Oracle home, and where the host on which the single-instance database runs is <span class="italic">not</span> a node used by the Oracle RAC database.</p>
<p>In this scenario, create a clone image of the single-instance database, and move the clone image to a host that is one of the nodes used by the Oracle RAC database. Then, use <code dir="ltr">rconfig</code> or the Oracle Enterprise Manager Convert to RAC option, as described in the preceding scenario.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABCDIBJ"></a>
<div id="RIWIN1125" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">C.3.4</span> Converting Databases to Oracle RAC Using Oracle Enterprise Manager<a id="sthref637"></a><a id="sthref638"></a><a id="sthref639"></a></h3>
<p><a id="sthref640"></a>You can use Oracle Enterprise Manager Grid Control to convert a single-instance database to an Oracle RAC database. To use this feature, complete the following steps:</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" href="../../server.112/e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about upgrading existing Oracle Database installations</div>
<ol>
<li>
<p>Log in to Grid Control. From the Grid Control Home page, click the <span class="bold">Targets</span> tab.</p>
</li>
<li>
<p>On the Targets page, click the <span class="bold">Databases</span> secondary tab, and click the link in the Names column of the database to convert to Oracle RAC.</p>
</li>
<li>
<p>On the Database Instance Home page, click the <span class="bold">Change Database</span> secondary tab.</p>
</li>
<li>
<p>On the Administration page, in the Database Administration Change Database section, click <span class="bold">Convert to Cluster Database</span>.</p>
</li>
<li>
<p>Log in as the database user SYS with SYSDBA privileges to the database you want to convert, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Convert to Cluster Database: Cluster Credentials page, provide a user name and password for the <code dir="ltr">oracle</code> user and password of the target database to be converted. If the target database is using Oracle ASM, then also provide the SYSASM user and password, and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Hosts page, select the host nodes in the cluster to be cluster members in the installed Oracle RAC database. When you have completed your selection, click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the Convert to Database: Options page, select whether you want to use the existing listener and port number, or specify a new listener and port number for the cluster. Also provide a prefix for cluster database instances on the cluster.</p>
<p>When you have finished entering information, click <span class="bold">Next</span>, or click <span class="bold">Help</span> if you need assistance in deciding how to enter information.</p>
</li>
<li>
<p><a id="sthref641"></a>On the Convert to Cluster Database: Shared Storage page, either select the option to use your existing shared storage area, or select the option to have your database files copied to a new shared storage location. Also, decide if you want to use your existing fast recovery area, or copy your recovery files to a new <a id="sthref642"></a>fast recovery area using files managed by Oracle Database.</p>
<p>If you use Oracle ASM, then Oracle recommends that you place the data files and the recovery files in separate failure groups. A failure group is defined by shared hardware, such as a controller shared between two disks, or two disks that are on the same spindle. If two disks share hardware that could fail, making both disks unavailable, then theses disks are said to be in the same failure group. If you do not use Oracle ASM, then Oracle recommends that the data files and the recovery files are stored in separate locations, as with separate Oracle ASM failure groups, so that a hardware failure does not affect availability.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink OSTMG10046" href="../../server.112/e18951/asmdiskgrps.htm#OSTMG10046"><span class="italic">Oracle Automatic Storage Management Administrator's Guide</span></a> for more information about failure groups</div>
<p>When you have finished entering information, click <span class="bold">Next</span>, or click <span class="bold">Help</span> if you need assistance in deciding how to enter information.</p>
</li>
<li>
<p>On the Convert to Cluster Database: Review page, review the options you have selected. Click <span class="bold">Submit Job</span> to proceed with the conversion. To change any of the options you have selected, click <span class="bold">Back</span>. To cancel the conversion, click <span class="bold">Cancel</span>.</p>
</li>
<li>
<p>On the Confirmation page, click <span class="bold">View Job</span> to check the status of the conversion.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABGGEGJ"></a>
<div id="RIWIN1126" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">C.4</span> Converting Databases to Oracle RAC Using rconfig</h2>
<p>You can use the command-line utility <code dir="ltr">rconfig</code> to convert a single-instance database to an Oracle RAC database, or to convert it to an Oracle RAC One Node database, depending on the values you provide in the <code dir="ltr">ConvertToRAC.xml</code> file. To use this feature, complete the following steps:</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink UPGRD" href="../../server.112/e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about upgrading existing Oracle Database installations</div>
<ol>
<li>
<p>As the <code dir="ltr">oracle</code> user, go to the directory <code dir="ltr">%ORACLE_HOME%</code><code dir="ltr">\assistants\rconfig\sampleXMLs</code>, and open the file <code dir="ltr">ConvertToRAC.xml</code> using a text editor.</p>
</li>
<li id="BABIACDI">
<p>Review the <code dir="ltr">ConvertToRAC.xml</code> file, and modify the parameters as required for your system. The XML sample file contains comments that provide instructions for how to configure the file.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Set the convert option <code dir="ltr">Convert verify="ONLY"</code> to perform a test conversion to ensure that a conversion can be completed successfully.</div>
<p>When you have finished modifying parameters, save the file with the a name of the format <code dir="ltr"><span class="codeinlineitalic">filename</span></code><code dir="ltr">.xml</code>. Make a note of the name you select.</p>
</li>
<li>
<p>Go to the directory %ORACLE_HOME%<code dir="ltr">\bin</code>, and use the following command to run <code dir="ltr">rconfig</code>, where <code dir="ltr"><span class="codeinlineitalic">input.xml</span></code> is the name of the XML input file you configured in Step <a href="#BABIACDI">2</a>:</p>
<pre dir="ltr">
C:\..\bin&gt; rconfig <span class="italic">input.xml</span>
</pre>
<p>For example, if you create an input XML file called <code dir="ltr">convert.xml</code>, then you would use the following command</p>
<pre dir="ltr">
C:\...\bin&gt; rconfig.bat convert.xml
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
The <code dir="ltr">Convert verify</code> option in the <code dir="ltr">ConvertToRAC.xml</code> file has three options:
<ul>
<li>
<p><code dir="ltr">Convert verify="YES"</code>: <code dir="ltr">rconfig</code> performs checks to ensure that the prerequisites for single-instance to Oracle RAC conversion have been met before it starts conversion</p>
</li>
<li>
<p><code dir="ltr">Convert verify="NO"</code>: <code dir="ltr">rconfig</code> does not perform prerequisite checks, and starts conversion</p>
</li>
<li>
<p><code dir="ltr">Convert verify="ONLY"</code> <code dir="ltr">rconfig</code> only performs prerequisite checks; it does not start conversion after completing prerequisite checks</p>
</li>
</ul>
</div>
<p>If performing the conversion fails, then use the following procedure to recover and reattempt the conversion:</p>
<ol>
<li>
<p>Attempt to delete the database using the DBCA delete database option.</p>
</li>
<li>
<p>Restore the source database.</p>
</li>
<li>
<p>Review the conversion log, and fix any problems reported by <code dir="ltr">rconfig</code> that may have caused the conversion failure. The <code dir="ltr">rconfig</code> log files are under the <code dir="ltr">rconfig</code> directory in <code dir="ltr">%ORACLE_BASE%\cfgtoollogs</code>.</p>
</li>
<li>
<p>Reattempt the conversion.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BABCHDBB"></a>
<div id="RIWIN1127" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">C.5</span> Example of rconfig XML Input Files for ConvertToRAC</h2>
<p><a id="sthref643"></a>The following are two examples of an XML <code dir="ltr">ConvertToRAC</code> input file for the <code dir="ltr">rconfig</code> utility. <a href="#BABDFFAH">Example C-1</a> is an XML input file to convert a single-instance database with Oracle ASM to a policy-managed Oracle RAC database (using server pools) on Oracle ASM storage. <a href="#BABFGHCI">Example C-2</a> is an XML input file to convert a single-instance database with Oracle ASM to an administrator-managed Oracle RAC database.</p>
<div id="RIWIN1128" class="example">
<p class="titleinexample"><a id="BABDFFAH"></a>Example C-1 Example rconfig ConvertToRAC XML file for Policy-Managed Databases</p>
<pre dir="ltr">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;n:RConfig xmlns:n="http://www.oracle.com/rconfig/"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.oracle.com/rconfig/"&gt;
    &lt;n:ConvertToRAC&gt;   
&lt;!-- Verify does a precheck to ensure all pre-requisites are met, before the
conversion is attempted. Allowable values are: YES|NO|ONLY --&gt;
        &lt;n:Convert verify="YES"&gt;
&lt;!--Specify current OracleHome of non-rac database for SourceDBHome --&gt;
              &lt;n:SourceDBHome&gt;C:\app\oracle\product\11.2.0\db_1&lt;/n:SourceDBHome&gt;
&lt;!--Specify OracleHome where the rac database should be configured. It can be same
as SourceDBHome --&gt;
              &lt;n:TargetDBHome&gt;C:\app\oracle\product\11.2.0\db_1&lt;/n:TargetDBHome&gt;
&lt;!--Specify SID of non-rac database and credential. User with sysdba role is
required to perform conversion --&gt;
              &lt;n:SourceDBInfo SID="sales"&gt;
                &lt;n:Credentials&gt;
                  &lt;n:User&gt;sys&lt;/n:User&gt;
                  &lt;n:Password&gt;oracle&lt;/n:Password&gt;
                  &lt;n:Role&gt;sysdba&lt;/n:Role&gt;
                &lt;/n:Credentials&gt;
              &lt;/n:SourceDBInfo&gt;
&lt;!--Specify the list of existing or new server pools which are used by the Policy
Managed Cluster Database. --&gt;
              &lt;n:ServerPoolList&gt;
                &lt;n:ExistingServerPool name="custom"/&gt;
                &lt;n:NewServerPool name="newpool" cardinality="2"/&gt;
              &lt;/n:ServerPoolList&gt;
&lt;!--Specify RacOneNode along with servicename to convert database to RACOne Node
--&gt;
 &lt;!--n:RacOneNode  servicename="salesrac1service"/--&gt;
&lt;!--InstancePrefix is not required for Policy Managed database. If specified, it
will be ignored. Instance names are generated automatically based on db_unique_
name for Policy Managed dababase.--&gt;
&lt;!-- Listener details are no longer needed starting 11.2. Database is registered
with default listener and SCAN listener running from Oracle Grid Infrastructure
home. --&gt;
&lt;!--Specify the type of storage to be used by rac database. Allowable values are
CFS|ASM. The non-rac database should have same storage type. ASM credentials are
not needed for conversion. --&gt;
              &lt;n:SharedStorage type="ASM"&gt;
&lt;!--Specify Database Area Location to be configured for rac database.If this field
is left empty, current storage will be used for rac database. For CFS, this field
will have directory path. --&gt;
                &lt;n:TargetDatabaseArea&gt;+ASMDG&lt;/n:TargetDatabaseArea&gt;
&lt;!--Specify Fast Recovery Area to be configured for rac database. If this field
is left empty, current recovery area of non-rac database will be configured for
rac database. If current database is not using recovery Area, the resulting rac
database will not have a recovery area. --&gt;
                &lt;n:TargetFlashRecoveryArea&gt;+ASMDG&lt;/n:TargetFlashRecoveryArea&gt;
              &lt;/n:SharedStorage&gt;
        &lt;/n:Convert&gt;
    &lt;/n:ConvertToRAC&gt;
&lt;/n:RConfig&gt;
</pre></div>
<!-- class="example" -->
<div id="RIWIN1129" class="example">
<p class="titleinexample"><a id="BABFGHCI"></a>Example C-2 Example rconfig ConvertToRAC XML file for Administrator-Managed Databases</p>
<pre dir="ltr">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;n:RConfig xmlns:n="http://www.oracle.com/rconfig/"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.oracle.com/rconfig rconfig.xsd"&gt;
    &lt;n:ConvertToRAC&gt;   
&lt;!-- Verify does a precheck to ensure all pre-requisites are met, before the
conversion is attempted. Allowable values are: YES|NO|ONLY --&gt;
        &lt;n:Convert verify="YES"&gt;
&lt;!--Specify current OracleHome of non-rac database for SourceDBHome --&gt;
              &lt;n:SourceDBHome&gt;C:\app\oracle\product\11.2.0\db_1&lt;/n:SourceDBHome&gt;
&lt;!--Specify OracleHome where the rac database should be configured. It can be same
as SourceDBHome --&gt;
              &lt;n:TargetDBHome&gt;C:\app\oracle\product\11.2.0\db_1&lt;/n:TargetDBHome&gt;
&lt;!--Specify SID of non-rac database and credential. User with sysdba role is
required to perform conversion --&gt;
              &lt;n:SourceDBInfo SID="sales"&gt;
                &lt;n:Credentials&gt;
                  &lt;n:User&gt;sys&lt;/n:User&gt;
                  &lt;n:Password&gt;oracle&lt;/n:Password&gt;
                  &lt;n:Role&gt;sysdba&lt;/n:Role&gt;
                &lt;/n:Credentials&gt;
              &lt;/n:SourceDBInfo&gt;
&lt;!--Specify the list of nodes that should have rac instances running for the Admin
Managed Cluster Database. LocalNode should be the first node in this nodelist. --&gt;
              &lt;n:NodeList&gt;        
                &lt;n:Node name="node1"/&gt;
                &lt;n:Node name="node2"/&gt;
              &lt;/n:NodeList&gt;
&lt;!--Specify RacOneNode along with servicename to convert database to RACOne Node
--&gt;
&lt;!--n:RacOneNode  servicename="salesrac1service"/--&gt;
&lt;!--Instance Prefix tag is optional starting with 11.2. If left empty, it is
derived from db_unique_name.--&gt;
              &lt;n:InstancePrefix&gt;sales&lt;/n:InstancePrefix&gt;
&lt;!-- Listener details are no longer needed starting 11.2. Database is registered
with default listener and SCAN listener running from Oracle Grid Infrastructure
home. --&gt;
&lt;!--Specify the type of storage to be used by rac database. Allowable values are
CFS|ASM. The non-rac database should have same storage type. ASM credentials are
no needed for conversion. --&gt;
              &lt;n:SharedStorage type="ASM"&gt;
&lt;!--Specify Database Area Location to be configured for rac database.If this field
is left empty, current storage will be used for rac database. For CFS, this field
will have directory path. --&gt;
                &lt;n:TargetDatabaseArea&gt;+ASMDG&lt;/n:TargetDatabaseArea&gt;
&lt;!--Specify Fast Recovery Area to be configured for rac database. If this field
is left empty, current recovery area of non-rac database will be configured for
rac database. If current database is not using recovery Area, the resulting rac
database will not have a recovery area. --&gt;
                &lt;n:TargetFlashRecoveryArea&gt;+ASMDG&lt;/n:TargetFlashRecoveryArea&gt;
              &lt;/n:SharedStorage&gt;
        &lt;/n:Convert&gt;
    &lt;/n:ConvertToRAC&gt;
&lt;/n:RConfig&gt;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" -->
<a id="BABGBIEH"></a>
<div id="RIWIN1130" class="sect1">
<h2 class="sect1"><span class="secnum">C.6</span> Postconversion Steps</h2>
<p>After completing the <a id="sthref644"></a>conversion, note the following recommendations for Oracle RAC environments, as described in the Oracle RAC documentation:</p>
<ul>
<li>
<p>Follow the recommendations for using load balancing and transparent application failover, as described in <a class="olink RACAD076" href="../../rac.112/e41960/hafeats.htm#RACAD076"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a>.</p>
</li>
<li>
<p>Use locally managed tablespaces instead of dictionary managed tablespaces to reduce contention and manage sequences in Oracle RAC as described in <a class="olink RACAD755" href="../../rac.112/e41960/design.htm#RACAD755"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a>.</p>
</li>
<li>
<p>Follow the guidelines for using automatic segment space management as described in <a class="olink RACAD802" href="../../rac.112/e41960/storage.htm#RACAD802"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a>.</p>
</li>
</ul>
<p>The buffer cache and shared pool capacity requirements in Oracle RAC are slightly greater than the requirements for single-instance Oracle databases. Therefore, you should increase the size of the buffer cache by about 10%, and the size of the shared pool by about 15%.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2786">
<tr>
<td class="cellalignment2795">
<table class="cellalignment2791">
<tr>
<td class="cellalignment2790"><a href="scripts.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2790"><a href="apa.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2798">
<table class="cellalignment2789">
<tr>
<td class="cellalignment2790"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2790"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2790"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2790"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2790"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2790"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
