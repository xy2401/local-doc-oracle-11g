<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Configuring Server Pools and Oracle Enterprise Manager Database Control</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1041" />
<meta name="dcterms.created" content="2015-02-05T19:13:54Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Real Application Clusters Installation Guide" />
<meta name="dcterms.identifier" content="E48195-02" />
<meta name="dcterms.isVersionOf" content="RIWIN" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="params.htm" title="Previous" type="text/html" />
<link rel="Next" href="undrstnd.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e48195.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">12/22</span> <!-- End Header -->
<div id="RIWIN1035" class="chapter"><a id="sthref315"></a>
<h1 class="chapter"><span class="secnum">6</span> Configuring Server Pools and Oracle Enterprise Manager Database Control</h1>
<p><a id="sthref316"></a>This chapter describes server pool and Oracle Enterprise Manager Database Control configuration in Oracle Real Application Clusters (Oracle RAC) environments.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BHBBGEIE">Understanding Server Pools</a></p>
</li>
<li>
<p><a href="#CHDBDGGA">Understanding the Database Control Implementation for Oracle RAC</a></p>
</li>
<li>
<p><a href="#CACIAIFG">Understanding EMCA and Enterprise Manager Control with Oracle RAC</a></p>
</li>
<li>
<p><a href="#CHDCGFJG">Configuring Database Control During Installation</a></p>
</li>
<li>
<p><a href="#CHDGFAAB">Configuring Database Control with DBCA</a></p>
</li>
<li>
<p><a href="#BHBJIIDC">Configuring Database Control After Installation Using EMCA</a></p>
</li>
<li>
<p><a href="#BHBGJGBI">Managing Database Control Using EMCA</a></p>
</li>
<li>
<p><a href="#CACIHHBG">Enterprise Manager and EMCA Troubleshooting Tips</a></p>
</li>
</ul>
<a id="BHBBGEIE"></a>
<div id="RIWIN1036" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.1</span> Understanding Server Pools</h2>
<p><span class="bold">Server pools</span> are logical divisions of a cluster into groups of servers, which are allocated to host databases or other applications. Server pools are managed using <code dir="ltr">crsctl</code> and <code dir="ltr">srvctl</code> commands.</p>
<p>Each server pool name must be unique within the cluster. Two server pools cannot use the same name.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
By default, any named user may create a server pool. To restrict the operating system users that have this privilege, Oracle strongly recommends that you add specific users to the CRS Administrators list. See <a class="olink CWADD91105" href="../../rac.112/e41959/admin.htm#CWADD91105"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for more information about adding users to the CRS Administrators list.</div>
<p>There are two types of server pool management:</p>
<ul>
<li>
<p><span class="bold">Administrator-managed</span>: Database administrators define the servers on which database resources run, and place resources manually as needed. This is the management strategy used in previous releases.</p>
</li>
<li>
<p><span class="bold">Policy-managed</span>: Database administrators specify in which server pool (excluding the generic or free server pools) the database resource will run. Oracle Clusterware is responsible for placing the database resource on a server.</p>
<p>The server pool name is a required attribute. You can also provide values for the following attributes; if you do not specify them, then they are set to the default value:</p>
<ul>
<li>
<p><code dir="ltr">MIN_SIZE</code>: Minimum number of servers on which you want a resource to run. The default is <code dir="ltr">0</code>.</p>
</li>
<li>
<p><code dir="ltr">MAX_SIZE</code>: Maximum number of servers on which you want a resource to run. The default is <code dir="ltr">-1</code>, which indicates that resources can run on all available nodes in the cluster.</p>
</li>
<li>
<p><code dir="ltr">IMPORTANCE</code>: The relative importance of the server pool, used to determine how to reconfigure servers when a node joins or leaves the cluster. The default is <code dir="ltr">0</code>.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
<a id="sthref317"></a><a id="sthref318"></a><a id="sthref319"></a>Policy-managed databases that use Oracle Database 11<span class="italic">g</span> release 2 or later and are deployed in on or more server pools should access the database using the Single Client Access Name (SCAN). Using SCAN is highly recommended because the instances of the policy-managed database can run on different servers at different times; using a virtual IP (VIP) address to connect to a particular node or instances for a policy-managed database is not possible.</div>
</li>
</ul>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref320"></a>
<h3 class="sect2"><span class="secnum">6.1.1</span> Oracle RAC One Node and Server Pools</h3>
<p>Note the following about Oracle RAC One Node and server pools:</p>
<ul>
<li>
<p>Oracle RAC One Node runs only in one server pool. This server pool is treated the same as any other server pool.</p>
</li>
<li>
<p>Online relocation of an Oracle RAC One Node database instances permits planned migrations of an Oracle RAC One Node database from one node to another node. Relocations must always be within a server pool.</p>
</li>
<li>
<p>An Oracle RAC One Node database can be a Data Guard physical standby.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<div id="RIWIN1037" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref321"></a>
<h3 class="sect2"><span class="secnum">6.1.2</span> Policy-Based Cluster and Capacity Management</h3>
<p>Using policy-based server pool management, database administrators define resource requirements for the workload, including the following:</p>
<ul>
<li>
<p>Defining the number of servers or instances preferred for the application. Oracle Clusterware automatically allocates resources up to the number specified as long as they are physically available, and relocates a resource to another node as necessary.</p>
</li>
<li>
<p>Defining the number of instances required to support the application.</p>
</li>
</ul>
<p>Resources are no longer defined as belonging to a specific instance or node. Instead, the priority of resource requirements is defined.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RACAD" href="../../rac.112/e41960/toc.htm"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about policy-based management and server pools</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDBDGGA"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">6.2</span> Understanding the Database Control Implementation for Oracle RAC</h2>
<p>When you configure Database Control for Oracle RAC, you configure the Database Control for each instance in the cluster. However, by default, the Database Control console will only start on the local node, the node on which the Oracle RAC installation was started. On every other node of the cluster, only the Oracle Management Agent starts. This is because the Database Control console opens a number of connections to the database. If an instance of the console is running on every host in the cluster, then you can easily exceed the maximum number of permitted open connections on a 32-node or 64-node environment.</p>
<p>Each of the remote agents upload their respective data to the console running on the local node, where you can monitor and manage all the nodes and instances in the cluster. On each node in the Oracle home of the Oracle RAC database, the following subdirectories are created, where <code dir="ltr"><span class="codeinlineitalic">nodename</span></code> is the name of a node in the cluster, and <code dir="ltr"><span class="codeinlineitalic">DBName</span></code> is the unique name of the Oracle RAC database.</p>
<pre dir="ltr">
%ORACLE_HOME%\<span class="italic">nodename</span>_<span class="italic">DBName</span>
%ORACLE_HOME%\<span class="italic">nodename</span>_<span class="italic">DBName</span>
</pre>
<p>If you upgrade an existing Oracle RAC 10<span class="italic">g</span> release 1 database configured with Database Control to the current release, then the existing Database Control configuration is retained. A Database Control console runs on each cluster node associated with the upgraded Oracle RAC database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABHEBCH">Section 6.7.1, "Changing the Database Control Implementation for Your Oracle RAC Database"</a></div>
</div>
<!-- class="sect1" -->
<a id="CACIAIFG"></a>
<div id="RIWIN1039" class="sect1">
<h2 class="sect1"><span class="secnum">6.3</span> Understanding EMCA and Enterprise Manager Control with Oracle RAC</h2>
<p><a id="sthref322"></a><a id="sthref323"></a>When you use Enterprise Manager Configuration Assistant (EMCA) to configure Oracle Enterprise Manager Database Control for Oracle RAC with the <code dir="ltr">-cluster</code> option, you configure Database Control for each instance in the cluster. However, by default, the Database Control console starts only on the local node.</p>
<p>If the Database Control console is started on the local node, then you can use the Enterprise Manager Control (EMCTL) commands <code dir="ltr">start dbconsole</code> and <code dir="ltr">stop dbconsole</code> to start and stop the Database Control console. The commands <code dir="ltr">emctl start dbconsole</code> and <code dir="ltr">emctl stop dbconsole</code> start and stop only the Management Agent on the other nodes where the Database Control console is not running.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect1" -->
<a id="CHDCGFJG"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">6.4</span> Configuring Database Control During Installation</h2>
<p>If you create a database while installing Oracle RAC 11<span class="italic">g</span> release 2 (11.2), you have the option of configuring your database so it can be managed by Oracle Enterprise Manager Grid Control or by Oracle Enterprise Manager Database Control.</p>
<p>To select Grid Control as your management option, the Oracle Management Service must be installed on a network host. In addition, the Management Agent must be installed on the host where you are installing the database. Otherwise, the Grid Control option is unavailable and you must instead manage your database with Database Control.</p>
<p>For most of the Oracle RAC 11<span class="italic">g</span> release 2 (11.2) installation types, you must choose either Database Control or Grid Control as your management option when you create a database during the installation.</p>
<p>If you do not want to configure Enterprise Manager for your Oracle RAC database, then you must use either the Advanced database configuration option during an Enterprise or Standard Edition installation or run Oracle Database Configuration Assistant (DBCA) after the installation to create your Oracle RAC database. If you do not configure Database Control during the Oracle RAC 11<span class="italic">g</span> release 2 (11.2) installation, then the <code dir="ltr"><span class="codeinlineitalic">nodename_DBName</span></code> directory is not created in the Oracle home for your database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="racinstl.htm#CHDFGECG">Section 2.2, "Selecting an Installation Type"</a></div>
</div>
<!-- class="sect1" -->
<a id="CHDGFAAB"></a>
<div id="RIWIN1041" class="sect1">
<h2 class="sect1"><span class="secnum">6.5</span> Configuring Database Control with DBCA</h2>
<p><a id="sthref324"></a><a id="sthref325"></a>The primary method for configuring an existing Oracle Database 11<span class="italic">g</span> release 2 (11.2) database so it can be managed with Database Control is to use <a id="sthref326"></a><a id="sthref327"></a>DBCA. You can use DBCA to create a new database or to reconfigure an existing database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>"Installing Oracle Software and Building the Database" in <a class="olink ADMQS" href="../../server.112/e10897/toc.htm"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about using DBCA to create a new database instance</p>
</li>
<li>
<p><a class="olink TDPRC" href="../../rac.112/e17264/toc.htm"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for Oracle RAC examples using DBCA</p>
</li>
</ul>
</div>
<p>To use DBCA to configure your database so it can be managed with Database Control:</p>
<ol>
<li>
<p>Log in to the database host as an Administrator user.</p>
</li>
<li>
<p><a id="sthref328"></a>Click <span class="bold">Start</span>, and select <span class="bold">Programs</span>, then <span class="bold">Oracle -</span> <span class="bolditalic">Oracle_home name</span>. In the Configuration and Migration Tools folder, select <span class="bold">Database Configuration Assistant</span>.</p>
<p>The DBCA Welcome page appears.</p>
</li>
<li>
<p>Click <span class="bold">Next</span> until the Operations page is displayed. Select <span class="bold">Configure Database Options</span>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span> until the Database page is displayed. Select the database you want to configure.</p>
</li>
<li>
<p>Click <span class="bold">Next</span> until the Management Options page is displayed. Select the following options:</p>
<ul>
<li>
<p><span class="bold">Configure the Database with Enterprise Manager</span></p>
</li>
<li>
<p><span class="bold">Use Database Control for Database Management</span></p>
</li>
</ul>
</li>
<li>
<p><a id="sthref329"></a>Optionally, select the options for enabling daily backups.</p>
<p>For more information about Oracle Enterprise Manager daily backups, click <span class="bold">Help</span> on the Management Options page.</p>
</li>
<li>
<p>Click <span class="bold">Next</span> until the Finish button is available, then click <span class="bold">Finish</span> to configure the database to use Database Control.</p>
</li>
</ol>
<p>After DBCA configures the database, a new subdirectory appears in the Oracle home. This directory contains Database Control configuration and state files specific to the database you just configured. For cluster databases, the directories are named <code dir="ltr"><span class="codeinlineitalic">nodename_DBName</span></code>. For example, if the name of the local node is <code dir="ltr">node1.example.com</code> and the database unique name is <code dir="ltr">myNewDB</code>, then the directory name is:</p>
<pre dir="ltr">
node1.example.com_myNewDB
</pre></div>
<!-- class="sect1" -->
<a id="BHBJIIDC"></a>
<div id="RIWIN1042" class="sect1">
<h2 class="sect1"><span class="secnum">6.6</span> Configuring Database Control After Installation Using <a id="sthref330"></a><a id="sthref331"></a><a id="sthref332"></a>EMCA</h2>
<p>EMCA provides a command-line interface for configuring Database Control. EMCA is available in the <code dir="ltr">bin</code> directory of the Oracle home of your database.</p>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
During configuration of Database Control using EMCA, the database may become unavailable and users may not be able to connect to the database or perform operations on the database.</div>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref333"></a>
<h3 class="sect2"><span class="secnum">6.6.1</span> Using EMCA in Interactive Mode</h3>
<p>To use EMCA to configure your database for management using Database Control:</p>
<ol>
<li>
<p>Set the default Oracle home to the location of the home directory for the database you are modifying. See <a href="undrstnd.htm#CIHEBBBF">Section 7.3, "Working with Multiple Oracle Home Directories on Windows"</a> for details.</p>
</li>
<li>
<p>Change the directory to <code dir="ltr">%ORACLE_HOME%</code><code dir="ltr">\bin</code>.</p>
</li>
<li>
<p>Start EMCA by entering the following command with any of the optional command-line parameters shown in <a href="emca_ref_new.htm#CEGBJGGB">Table G-1, "EMCA Optional Command-Line Parameters"</a>:</p>
<pre dir="ltr">
%ORACLE_HOME%\bin&gt; emca.bat
</pre>
<p>Depending upon the parameters you include on the EMCA command line, you might be prompted for additional information required to configure Database Control.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To configure Database Control for a single-instance database using Oracle Automatic Storage Management (Oracle ASM), you do not have to include extra parameters in the EMCA command. Run the following command to configure Database Control for a new installation. EMCA automatically detects the Oracle ASM instance:
<pre dir="ltr">
emca -config dbcontrol db -repos create
</pre></div>
<div class="example">
<p class="titleinexample"><a id="sthref334"></a>Example 6-1 Configuring Database Control and Daily Database Backups using EMCA</p>
<p><a id="sthref335"></a><a id="sthref336"></a><a id="sthref337"></a><a id="sthref338"></a>Enter the following commands to configure Database Control for your Oracle RAC database and also to enable automatic daily backups of your database:</p>
<pre dir="ltr">
X:\&gt; cd %ORACLE_HOME%\bin

X:\..\bin&gt; emca.bat -config dbcontrol db -backup
</pre></div>
<!-- class="example" --></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect2" -->
<a id="CACBFHBB"></a>
<div id="RIWIN1046" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.6.2</span> Using EMCA in Silent Mode With an Input File</h3>
<p><a id="sthref339"></a>Instead of answering a series of prompts when you run EMCA, you can use the <code dir="ltr">-respFile</code> parameter to specify an input file. The input file you create must be in a format similar to the following example:</p>
<pre dir="ltr">
PORT=1521
SID=DB
DBSNMP_PWD=xpE234D
SYSMAN_PWD=KDOdk432
</pre>
<p>After you create an EMCA input file, you can use it on the command line as follows, where <code dir="ltr"><span class="codeinlineitalic">input_file_path</span></code> is the full path name of the input file:</p>
<pre dir="ltr">
emca -config dbcontrol db -respFile <span class="italic">input_file_path</span>
</pre>
<div class="example">
<p class="titleinexample"><a id="sthref340"></a>Example 6-2 Using a Response File with EMCA to Configure Database Control</p>
<p><a id="sthref341"></a>To configure Database Control to perform daily backups and create the Oracle Management Repository, create an input file similar to the one shown in the following example:</p>
<pre dir="ltr">
PORT=1521
SID=DB
DBSNMP_PWD=dow3l224
SYSMAN_PWD=squN3243
HOST_USER=johnson
HOST_USER_PWD=diTf32of
SYS_PWD=qlKj4352
BACKUP_SCHEDULE=06:30
</pre>
<p>After you have created the input file, enter the following command at the operating system prompt from the <code dir="ltr">bin</code> directory of the Oracle home, where <code dir="ltr"><span class="codeinlineitalic">input_file_path</span></code> is the full path name of the input file:</p>
<pre dir="ltr">
X:\..\bin&gt; emca -config dbcontrol db -repos create -backup -respFile
<span class="italic">input_file_path</span>
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BHBGJGBI"></a>
<div id="RIWIN1038" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.7</span> Managing Database Control Using EMCA</h2>
<p><a id="sthref342"></a><a id="sthref343"></a><a id="sthref344"></a>You can use DBCA to configure Grid Control or Database Control for your Oracle RAC database. However, if you prefer to use a command-line interface to configure Database Control, then you can use the Oracle Enterprise Manager Configuration Assistant (EMCA) utility.</p>
<p>The following sections describe how Database Control can be configured after installation:</p>
<ul>
<li>
<p><a href="#BABHEBCH">Changing the Database Control Implementation for Your Oracle RAC Database</a></p>
</li>
<li>
<p><a href="#CHDDACHF">Updating Database Control Configuration When Adding and Removing Nodes</a></p>
</li>
<li>
<p><a href="#CACBFHBB">Using EMCA in Silent Mode With an Input File</a></p>
</li>
<li>
<p><a href="#BABCIIBD">Changing the Ports Used by Database Control</a></p>
</li>
<li>
<p><a href="#CACIHHBG">Enterprise Manager and EMCA Troubleshooting Tips</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CHDGFAAB">Section 6.5, "Configuring Database Control with DBCA"</a></div>
<a id="BABHEBCH"></a>
<div id="RIWIN1031" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.1</span> Changing the Database Control Implementation for Your Oracle RAC Database</h3>
<p>By default, when you configure Database Control for an Oracle RAC 11<span class="bold">g</span> database, the Database Control console starts only on the local node. <a id="sthref345"></a><a id="sthref346"></a><a id="sthref347"></a>If you upgrade an existing Oracle RAC database configured with Database Control to the current release, then the existing Database Control configuration is retained. For example, if you have an Oracle RAC 10<span class="italic">g</span> release 1 (10.1) database, then the existing Database Control configuration has a Database Control console running on each cluster node. If you upgrade this database to Oracle Database 11<span class="italic">g</span> release 2, then the Database Control console is still started on each individual node.</p>
<p>You can modify the number of Database Control consoles started for your Oracle RAC database. If you have one Database Control console running in the cluster, or more than one, you can still monitor and manage every node in the cluster from a single Database Control console.</p>
<p>To modify the implementation of Database Control for your database, use the following command, where <code dir="ltr"><span class="codeinlineitalic">nodename</span></code> is the public name of the node, and <code dir="ltr"><span class="codeinlineitalic">node_list</span></code> is a comma-deliminated list of node names:</p>
<pre dir="ltr">
emca -reconfig dbcontrol &ndash;cluster &ndash;EM_NODE <span class="italic">nodename</span> -EM_NODE_LIST <span class="italic">node_list</span>
</pre>
<div class="infobox-note">
<p class="notep1">Caution:</p>
If you use the command <code dir="ltr">emca -cluster</code> to configure Database Control for Oracle RAC, then check the <code dir="ltr">TNS_ADMIN</code> environment variable on all cluster nodes. If you have a different <code dir="ltr">TNS_ADMIN</code> set for each node, then the listener for the target node cannot be configured correctly. In this case, set the same <code dir="ltr">TNS_ADMIN</code> on all cluster nodes before running the <code dir="ltr">emca -cluster</code> command.</div>
<p>You can use the <code dir="ltr">emca -reconfig dbcontrol</code> command to start a Database Control console on multiple nodes. This command performs the following actions in sequence:</p>
<ol>
<li>
<p>Starts a Database Control console on the node specified by <code dir="ltr"><span class="codeinlineitalic">nodename</span></code>, if there a Database Control console is not started.</p>
</li>
<li>
<p>Redirects the Management Agents monitoring the database instances in <code dir="ltr"><span class="codeinlineitalic">node_list</span></code> so that they upload their data to the Database Control console running on <code dir="ltr"><span class="codeinlineitalic">nodename</span></code>. Also, Management Agents monitoring the Oracle Database instances on <code dir="ltr"><span class="codeinlineitalic">nodename</span></code> upload their data to the local console. Note that if you do not enter the command options <code dir="ltr">-EM_NODE</code> or <code dir="ltr">-EM_NODE_LIST</code> at the command line, you will be prompted for them.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<code dir="ltr">-EM_NODE</code> defaults to the local node if not specified when prompted. If not specified, <code dir="ltr">-EM_NODE_LIST</code> defaults to all nodes where the database is configured.</div>
</li>
</ol>
<p>For information about the current cluster configuration, you can run the following command:</p>
<pre dir="ltr">
emca -displayConfig dbcontrol &ndash;cluster
</pre>
<p>This command prompts for the database unique name for the cluster database. It prints the current configuration to the screen, indicating the nodes that have Database Control consoles running on them and the Database Control consoles to which each Management Agent is uploading its data.</p>
<div class="example">
<p class="titleinexample"><a id="sthref348"></a>Example 6-3 Reconfiguring Database Control for an Oracle RAC Database</p>
<p>This example demonstrates how to start the Database Control console on more than one node in a cluster. If you have an eight-node cluster with nodes <code dir="ltr">node1</code>, <code dir="ltr">node2</code>, <code dir="ltr">node3</code>, <code dir="ltr">node4</code>, <code dir="ltr">node5</code>, <code dir="ltr">node6</code>, <code dir="ltr">node7</code>, and <code dir="ltr">node8</code>, then you can run the following commands in succession:</p>
<pre dir="ltr">
emca -reconfig dbcontrol &ndash;cluster &ndash;EM_NODE node1 -EM_NODE_LIST node2,node3,node4
emca -reconfig dbcontrol &ndash;cluster &ndash;EM_NODE node5 -EM_NODE_LIST node6,node7,node8
</pre>
<p>After you execute these commands, there are two Database Control consoles running, one on <code dir="ltr">node1</code> and the other on <code dir="ltr">node5</code>. From either of these consoles, you can manage and monitor all of the targets in the cluster. Additionally, the Management Agents on nodes <code dir="ltr">node1</code>, <code dir="ltr">node2</code>, <code dir="ltr">node3</code>, and <code dir="ltr">node4</code> upload their information to the Database Control console running on <code dir="ltr">node1</code>. Similarly, the Management Agents on nodes <code dir="ltr">node5</code>, <code dir="ltr">node6</code>, <code dir="ltr">node7</code>, and <code dir="ltr">node8</code> upload their information to the Database Control console running on <code dir="ltr">node5</code>.</p>
</div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect2" -->
<a id="CHDDACHF"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.2</span> Updating Database Control Configuration When Adding and Removing Nodes</h3>
<p><a id="sthref349"></a><a id="sthref350"></a>For an administrator-managed database, a common operation is the addition and deletion of cluster nodes.</p>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref351"></a>
<h4 class="sect3"><span class="secnum">6.7.2.1</span> Using EMCA After Adding Nodes to the Cluster</h4>
<p>After you add a new node, run EMCA to configure Oracle Enterprise Manager so that you can manage the newly added instance in a way consistent with the rest of the cluster database instances. Use EMCA to configure a Database Control console or Management Agent for that node by executing the following command on a node that currently has Enterprise Manager configured:</p>
<pre dir="ltr">
emca -addNode db
</pre>
<p>Because the <code dir="ltr">-addNode</code> option can be used only in an Oracle Real Application Clusters environment, you do not have to use the <code dir="ltr">-cluster</code> option on the command line. After running the command <code dir="ltr">emca -addNode db</code>, enter the node name and database unique name for the node and Oracle RAC database, for example:</p>
<pre dir="ltr">
Node name: node6
Database Unique Name: myNewDB
</pre>
<p>When configuring Oracle Enterprise Manager for a new node, run the EMCA command only after you have added the node to your cluster and Oracle RAC database. Also, run the command from a node in the cluster that has Oracle Enterprise Manager configured, because the Oracle Enterprise Manager configuration settings on the existing node are propagated to the new node when you run the command.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref352"></a>
<h4 class="sect3"><span class="secnum">6.7.2.2</span> Using EMCA After Removing Nodes from the Cluster</h4>
<p><a id="sthref353"></a><a id="sthref354"></a>To deconfigure Oracle Enterprise Manager for a specific node you are deleting from the cluster, log in to a different node from the one you plan to delete, and use the following command:</p>
<pre dir="ltr">
emca -deleteNode db
</pre>
<p>Ensure that you run the EMCA command before you delete the actual cluster node. Because this option can be used only in an Oracle Real Application Clusters environment, you do not have to use the <code dir="ltr">-cluster</code> option on the command line.</p>
<p>Running this command removes the Oracle Enterprise Manager configuration so that you can not use Oracle Enterprise Manager to manage any instances on that node.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABCIIBD"></a>
<div id="RIWIN1047" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.7.3</span> Changing the Ports Used by Database Control</h3>
<p><a id="sthref355"></a><a id="sthref356"></a><a id="sthref357"></a>When you initially install Oracle RAC 11<span class="italic">g</span> release 2 (11.2) or configure Database Control with EMCA, Database Control uses a set of default system ports. For example, by default, you access Database Control in Oracle Database 11<span class="italic">g</span> release 2 (11.2) using a web address that consists of the local host name (<code dir="ltr"><span class="codeinlineitalic">host</span></code>.<code dir="ltr"><span class="codeinlineitalic">domain</span></code>) and port 1158:</p>
<pre dir="ltr">
https://<span class="italic">host</span>.<span class="italic">domain</span>:1158/em
</pre>
<p>Port 1158 is the default port assigned to Database Control by the Internet Assigned Numbers Authority (IANA). Similarly, the default Management Agent port, as assigned by the IANA, is 3938.</p>
<p>To use ports other than the default ports, use EMCA command-line arguments when configuring Database Control using EMCA. <a href="#CHDIEFAG">Table 6-1</a> summarizes the EMCA command-line parameters that control the standard Database Control port assignments.</p>
<div class="tblformal">
<p class="titleintable"><a id="sthref358"></a><a id="CHDIEFAG"></a>Table 6-1 EMCA Command Parameters for Configuring Port Assignments</p>
<table class="cellalignment2796" title="EMCA Command Parameters for Configuring Port Assignments" summary="EMCA command options for port assignements" dir="ltr">
<thead>
<tr class="cellalignment2787">
<th class="cellalignment2794" id="r1c1-t19">Option</th>
<th class="cellalignment2794" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2787">
<td class="cellalignment2795" id="r2c1-t19" headers="r1c1-t19">
<p><code dir="ltr">-DBCONTROL_HTTP_PORT</code> <code dir="ltr"><span class="codeinlineitalic">port_number</span></code></p>
</td>
<td class="cellalignment2795" headers="r2c1-t19 r1c2-t19">
<p><a id="sthref359"></a><a id="sthref360"></a>This port number is used in the Database Control console URL. For example, if you set this port to 5570, then you can then access the Database Control console using the following URL:</p>
<pre dir="ltr">
http://<span class="italic">host</span>.<span class="italic">domain</span>:5570/em
</pre></td>
</tr>
<tr class="cellalignment2787">
<td class="cellalignment2795" id="r3c1-t19" headers="r1c1-t19">
<p>-<code dir="ltr">RMI_PORT</code> <code dir="ltr"><span class="codeinlineitalic">port_number</span></code></p>
</td>
<td class="cellalignment2795" headers="r3c1-t19 r1c2-t19">
<p>This port number is used by the <a id="sthref361"></a><a id="sthref362"></a>Remote Method Invocation (RMI) system, which is part of the Java EE software required by Database Control. The default port can be changed if the user wants to configure a specific port for Database Control console.</p>
<p>When a port other than the default port (1521) is used, use the <code dir="ltr">-RMI_PORT</code> parameter along with the <code dir="ltr">emca reconfig</code> command.</p>
</td>
</tr>
<tr class="cellalignment2787">
<td class="cellalignment2795" id="r4c1-t19" headers="r1c1-t19">
<p><code dir="ltr">-JMS_PORT</code> <code dir="ltr"><span class="codeinlineitalic">port_number</span></code></p>
</td>
<td class="cellalignment2795" headers="r4c1-t19 r1c2-t19">
<p>This port is used by the Oracle Containers for Java EE (OC4J) and <a id="sthref363"></a><a id="sthref364"></a>Java Message Service (JMS), which is part of the Java EE software required by Database Control. The default port can be changed if the user wants to configure a specific port for Database Control console.</p>
<p>When a port other than the default port (1521) is used, use the <code dir="ltr">-JMS_PORT</code> parameter along with the <code dir="ltr">emca reconfig</code> command.</p>
</td>
</tr>
<tr class="cellalignment2787">
<td class="cellalignment2795" id="r5c1-t19" headers="r1c1-t19">
<p><code dir="ltr">-AGENT_PORT</code> <code dir="ltr"><span class="codeinlineitalic">port_number</span></code></p>
</td>
<td class="cellalignment2795" headers="r5c1-t19 r1c2-t19">
<p><a id="sthref365"></a><a id="sthref366"></a>This port is used by Oracle Management Agent, which monitors and manages the database for the Database Control console.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>Alternatively, you can explicitly assign ports after configuring Database Control using the following command, where <code dir="ltr"><span class="codeinlineitalic">parameters</span></code> refers to the command-line parameters listed in <a href="#CHDIEFAG">Table 6-1</a>:</p>
<pre dir="ltr">
emca -reconfig ports [-cluster] [<span class="italic">parameters</span>]
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACIHHBG"></a>
<div id="RIWIN1048" class="sect1">
<h2 class="sect1"><span class="secnum">6.8</span> Enterprise Manager and EMCA Troubleshooting Tips</h2>
<p><a id="sthref367"></a><a id="sthref368"></a><a id="sthref369"></a>The following topics describe some troubleshooting tips to consider when using EMCA and Database Control or Grid Control:</p>
<ul>
<li>
<p><a href="#CHDEGDIJ">Updating Database Control After Changing the Database Listener Port</a></p>
</li>
<li>
<p><a href="#CHDHCHBG">Upgrading Grid Control Agents for Oracle Database 11<span class="italic">g</span> Release 2</a></p>
</li>
<li>
<p><a href="#CHDCHBCA">Updating Database Control After Changing the Host Name or IP Address</a></p>
</li>
<li>
<p><a href="#CHDCFBFD">Using EMCA After Changing the TNS_ADMIN Configuration</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="emca_ref_new.htm#CEGGFJHB">Appendix G, "Oracle Enterprise Manager Configuration Assistant Reference"</a></div>
<a id="BABCBHFB"></a>
<div id="RIWIN1049" class="sect2"><a id="CHDEGDIJ"></a>
<h3 class="sect2"><span class="secnum">6.8.1</span> Updating Database Control <a id="sthref370"></a><a id="sthref371"></a><a id="sthref372"></a>After Changing the Database Listener Port</h3>
<p><a id="sthref373"></a>If you change the listener port of the database after you have configured Database Control, then the database status appears as down in the Database Control console. To reconfigure Database Control to use the new listener port, run EMCA using the following command:</p>
<pre dir="ltr">
emca.bat -config dbcontrol db [-cluster]
</pre></div>
<!-- class="sect2" -->
<a id="CHDHCHBG"></a>
<div id="RIWIN1050" class="sect2">
<h3 class="sect2"><span class="secnum">6.8.2</span> Upgrading Grid Control Agents for Oracle Database 11<span class="italic">g</span> Release 2</h3>
<p><a id="sthref374"></a>When upgrading an Oracle Database 10<span class="italic">g</span> release 1 database instance that was configured for Oracle Enterprise Manager (either Database Control or a Grid Control Management Agent) to an Oracle Database 11<span class="italic">g</span> release 2 (11.2) database, all resources monitored by Oracle Enterprise Manager targets associated with the upgraded instances are updated automatically. This is because the upgrade involves altering the Oracle home for the instance, the port numbers, or other instance- and node-associated properties.</p>
<p>If an upgraded instance is managed by a Grid Control Agent, then the associated resource information in Grid Control might not be updated successfully during the upgrade. To update the Grid Control target information, perform the following steps:</p>
<ol>
<li>
<p>Use Grid Control to access the home page of the upgraded instance.</p>
</li>
<li>
<p>On the home page for the upgraded instance, select <span class="bold">Monitoring Configuration</span>.</p>
</li>
<li>
<p>On the Monitoring Configuration page, update the properties to the correct values as needed, for example, Oracle home, listener port, and so on.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDCHBCA"></a>
<div id="RIWIN1051" class="sect2">
<h3 class="sect2"><span class="secnum">6.8.3</span> Updating Database Control After Changing the Host Name or IP Address</h3>
<p><a id="sthref375"></a><a id="sthref376"></a><a id="sthref377"></a><a id="sthref378"></a>After changing the host name (including the domain name) or the IP address for a node, you must deconfigure Database Control on that node and then reconfigure it using EMCA with the <code dir="ltr">-repos</code> flag, as shown in the following examples:</p>
<p class="synopsis">Reconfigure Enterprise Manager, deleting the repository when removing the configuration</p>
<pre dir="ltr">
emca -deconfig dbcontrol db -repos drop
emca -config dbcontrol db -repos create
</pre>
<p class="synopsis">Reconfigure Enterprise Manager, re-creating the repository during reconfiguration</p>
<pre dir="ltr">
emca -deconfig dbcontrol db
emca -config dbcontrol db -repos recreate
</pre></div>
<!-- class="sect2" -->
<a id="CHDCFBFD"></a>
<div id="RIWIN1052" class="sect2">
<h3 class="sect2"><span class="secnum">6.8.4</span> Using EMCA After Changing the TNS_ADMIN Configuration</h3>
<p><a id="sthref379"></a><a id="sthref380"></a><a id="sthref381"></a>After you change the <a id="sthref382"></a><a id="sthref383"></a><a id="sthref384"></a><code dir="ltr">TNS_ADMIN</code> environment variable to specify a new configuration, you must update Database Control. Set the <code dir="ltr">TNS_ADMIN</code> environment variable to the new value, then run the following command:</p>
<pre dir="ltr">
emca -config dbcontrol db
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2786">
<tr>
<td class="cellalignment2795">
<table class="cellalignment2791">
<tr>
<td class="cellalignment2790"><a href="params.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2790"><a href="undrstnd.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2798">
<table class="cellalignment2789">
<tr>
<td class="cellalignment2790"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2790"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2790"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2790"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2790"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2790"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
