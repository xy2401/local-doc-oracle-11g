<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Oracle RAC Fast Application Notification</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1" />
<meta name="dcterms.created" content="2011-09-15T1:42:58Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database JDBC Developer's Guide" />
<meta name="dcterms.identifier" content="E16548-03" />
<meta name="dcterms.isVersionOf" content="JJDBC" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="apxref.htm" title="Previous" type="text/html" />
<link rel="Next" href="apxtips.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e16548.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">50/54</span> <!-- End Header --><a id="CDCBIDHF"></a><a id="JJDBC28934"></a>
<h1 class="appendix"><span class="secnum">B</span> Oracle RAC Fast Application Notification</h1>
<p>Oracle Database 11<span class="italic">g</span> Release 2 (11.2) introduces a new set of APIs for Oracle RAC Fast Application Notification (FAN) events. These APIs provide an alternative for taking advantage of the high-availability (HA) features of Oracle Database, if you do not use Universal Connection Pool or Oracle JDBC connection caching. These APIs are not a part of Oracle JDBC APIs.</p>
<p>This appendix covers the following topics:</p>
<ul>
<li>
<p><a href="#CDCBBJGJ">Overview of Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCBCDBD">Installing and Configuring Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCFEFAF">Using Oracle RAC Fast Application Notification</a></p>
</li>
<li>
<p><a href="#CDCGBIEI">Implementing a Connection Cache</a></p>
</li>
</ul>
<p>This feature depends on the Oracle Notification System (ONS) message transport mechanism. This feature requires configuring your system, servers, and clients to use ONS.</p>
<p>For using Oracle RAC Fast Application Notification, the <code>simplefan.jar</code> file must be present in the classpath, and either the <code>ons.jar</code> file must be present in the classpath or an Oracle Notification Services (ONS) client must be installed and running in the client system.</p>
<a id="CDCBBJGJ"></a><a id="JJDBC28935"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Overview of Oracle RAC Fast Application Notification</h2>
<p>The Oracle RAC Fast Application Notification (FAN) feature provides a simplified API for accessing FAN events through a callback mechanism. This mechanism enables application code to receive a callback when a FAN event occurs. These APIs are referred to as Oracle RAC FAN APIs in this appendix.</p>
<p>The Oracle RAC FAN APIs provide FAN event notification for developing more responsive applications that can take full advantage of Oracle Database HA features. If you do not want to use Universal Connection Pool, but want to work with FAN events implementing your own connection cache, then you should use Oracle RAC Fast Application Notification.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If you do not want to implement your own connection cache, then you should use Universal Connection Pooling to get all the advantages of Oracle RAC Fast Application Notification, along with many additional benefits. For more information on Universal Connection Pooling, refer to <span class="italic">Oracle Universal Connection Pool for JDBC Developer's Guide</span>.</p>
</li>
<li>
<p>Starting from Oracle Database 11<span class="italic">g</span> Release 2 (11.2), implicit connection cache has been deprecated, and replaced with Universal Connection Pool (UCP) for JDBC. Oracle recommends that you take advantage of the new architecture, which is more powerful and offers better performance. Refer to the following link for more information</p>
<pre>
<a href="http://www.oracle.com/technology/tech/java/sqlj_jdbc/index.html">http://www.oracle.com/technology/tech/java/sqlj_jdbc/index.html</a>
</pre></li>
</ul>
</div>
<p>The Oracle RAC FAN APIs enable application code to receive and respond to FAN event notifications sent by Oracle RAC. This is achieved by enabling the code to respond to FAN events in the following way:</p>
<ul>
<li>
<p>Listening for Oracle RAC service down, service up, and node down events</p>
</li>
<li>
<p>Listening for load balancing advisory events and responding to them</p>
</li>
</ul>
<p>This feature exposes a subset of FAN events, which are the notifications sent by a cluster running Oracle RAC, to inform the subscribers about the configuration changes within the cluster. The supported FAN events are the following:</p>
<ul>
<li>
<p>Service up</p>
<p>The service up events notify that the managed resources are up and available. The cluster sends service up events when a cluster managed Database service becomes active, that is, available to accept work on an instance within the cluster.</p>
</li>
<li>
<p>Service down</p>
<p>The service down events notify that the managed resources are down and currently not available for access. There are two kinds of service down events:</p>
<ul>
<li>
<p>Events indicating that a particular instance of a service is down and the instance is no longer able to accept work.</p>
</li>
<li>
<p>Events indicating that <span class="italic">all</span> instances of a service are down and the service is no longer able to accept work.</p>
</li>
</ul>
<p>When the last instance of a service goes down, then the subscriber receives both events. The events may or may not arrive together.</p>
</li>
<li>
<p>Node down</p>
<p>The node down events notify that the Oracle RAC node identified by the host identifier is down and not reachable. The cluster sends node down events when a node is no longer able to accept work.</p>
</li>
<li>
<p>Load balancing advisory</p>
<p>The load balancing advisory events provide metrics for load balancing algorithms. Load balancing advisories are sent regularly to inform subscribers of the recommended distribution of work among the available nodes.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you want to implement your own connection cache, only then you should use Oracle RAC Fast Application Notification. Otherwise, you should use Universal Connection Pooling to get all the advantages of Oracle RAC Fast Application Notification, along with many additional benefits. For more information on Universal Connection Pooling, refer to <span class="italic">Oracle Universal Connection Pool for JDBC Developer's Guide</span>.</div>
</div>
<!-- class="sect1" -->
<a id="CDCBCDBD"></a><a id="JJDBC28936"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Installing and Configuring Oracle RAC Fast Application Notification</h2>
<p>You can install the Oracle RAC FAN APIs by performing the following steps:</p>
<ol>
<li>
<p>Download the <code>simplefan.jar</code> file from the following link</p>
<pre>
<a href="http://www.oracle.com/technology/tech/java/sqlj_jdbc/index.html">http://www.oracle.com/technology/tech/java/sqlj_jdbc/index.html</a>
</pre></li>
<li>
<p>Add the <code>simplefan.jar</code> file to the classpath.</p>
</li>
<li>
<p>Perform the following in your Java code:</p>
<ol>
<li>
<p>Get an instance of the <code>FanManager</code> class by using the <code>getInstance</code> method.</p>
</li>
<li>
<p>Configure the event daemon using the <code>configure</code> method of the <code>FanManager</code> class. The <code>configure</code> method sets the following properties:</p>
<p><code>onsNodes</code>: A comma separated list of <code>host:port</code> pairs of ONS daemons that the ONS runtime in this Java VM should communicate with. The <code>host</code> in a <code>host:port</code> pair is the host name of a system running the ONS daemon. The <code>port</code> is the local port configuration parameter for that daemon.</p>
<p><code>onsWalletFile</code>: The path name of the ONS wallet file. The wallet file is the path to a local wallet file used by SSL to store SSL certificates. Same as wallet file configuration parameter to ONS daemon.</p>
<p><code>onsWalletPassword</code>: The password for accessing the ONS wallet file.</p>
</li>
</ol>
</li>
</ol>
<p>For a detailed description of the Oracle RAC FAN APIs, refer to <a class="olink JAFAN" href="../../appdev.112/e13993/toc.htm"><span class="italic">Oracle Database RAC FAN Events Java API Reference</span></a>.</p>
<a id="CDCJEDJD"></a><a id="JJDBC28937"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Configuration of ONS</h3>
<p>The Java API for Oracle RAC FAN Events depends on the Oracle Notification System (ONS) service. This section describes how to configure ONS. It covers the following topics:</p>
<ul>
<li>
<p><a href="#CDCJEGBG">Overview of ONS Configuration File</a></p>
</li>
<li>
<p><a href="#CDCGFFGI">Configuring Client-Side ONS</a></p>
</li>
</ul>
<a id="CDCJEGBG"></a><a id="JJDBC28938"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Overview of ONS Configuration File</h4>
<p>ONS configuration is controlled by the ONS configuration file, <code><span class="codeinlineitalic">ORACLE_HOME</span></code><code>/opmn/conf/<a id="sthref973"></a>ons.config</code>. This file tells the ONS daemon how it should behave. Configuration information within <code>ons.config</code> is defined in simple name and value pairs.</p>
<p>Some parameters in the <code>ons.config</code> file are required and some are optional. <a href="#CDCEAEGB">Table B-1</a> lists the required ONS configuration parameters and <a href="#CDCFJABI">Table B-2</a> lists the optional ONS configuration parameters.</p>
<div class="tblhruleformal">
<p class="titleintable"><a id="JJDBC28939"></a><a id="sthref974"></a><a id="CDCEAEGB"></a>Table B-1 Required ONS Configuration Parameters</p>
<table class="cellalignment11" title="Required ONS Configuration Parameters" summary="This table lists the required parameters in the ons.config file." dir="ltr">
<thead>
<tr class="cellalignment2">
<th class="cellalignment9" id="r1c1-t4">Parameter</th>
<th class="cellalignment9" id="r1c2-t4">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2">
<td class="cellalignment10" id="r2c1-t4" headers="r1c1-t4">
<p><code>localport</code></p>
</td>
<td class="cellalignment10" headers="r2c1-t4 r1c2-t4">
<p>The port that ONS binds to on the local host interface to talk to local clients.</p>
<p>For example, <code>localport=4100</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r3c1-t4" headers="r1c1-t4">
<p><code>remoteport</code></p>
</td>
<td class="cellalignment10" headers="r3c1-t4 r1c2-t4">
<p>The port that ONS binds to on all interfaces for talking to other ONS daemons.</p>
<p>For example, <code>remoteport=4200</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r4c1-t4" headers="r1c1-t4">
<p><code>nodes</code></p>
</td>
<td class="cellalignment10" headers="r4c1-t4 r1c2-t4">
<p>A list of other ONS daemons to talk to. Node values are given as a comma-delimited list of either host names or IP addresses plus ports. The port value that is given is the remote port that each ONS instance is listening on. In order to maintain an identical file on all nodes, the <code>host:port</code> of the current ONS node can also be listed in the nodes list. It will be ignored when reading the list.</p>
<p>For example, <code>nodes=myhost.example.com:4200,123.123.123.123:4200</code></p>
<p>The nodes listed in the nodes line correspond to the individual nodes in the Oracle RAC instance. Listing the nodes ensures that the middle-tier node can communicate with the Oracle RAC nodes. At least one middle-tier node and one node in the Oracle RAC instance must be configured to see one another. As long as one node on each side is aware of the other, all nodes are visible. You need not list every single cluster and middle-tier node in the ONS configuration file of each Oracle RAC node. In particular, if one ONS configuration file cluster node is aware of the middle tier, then all nodes in the cluster are aware of it.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<div class="tblhruleformal">
<p class="titleintable"><a id="JJDBC28940"></a><a id="sthref975"></a><a id="CDCFJABI"></a>Table B-2 Optional ONS Configuration Parameters</p>
<table class="cellalignment11" title="Optional ONS Configuration Parameters" summary="This table lists the optional parameters in the ons.config file." dir="ltr">
<thead>
<tr class="cellalignment2">
<th class="cellalignment9" id="r1c1-t5">Parameter</th>
<th class="cellalignment9" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2">
<td class="cellalignment10" id="r2c1-t5" headers="r1c1-t5">
<p><code>loglevel</code></p>
</td>
<td class="cellalignment10" headers="r2c1-t5 r1c2-t5">
<p>The level of messages that should be logged by ONS. This value is an integer that ranges from 1, which indicates least messages logged, to 9, which indicates most messages logged. The default value is 3.</p>
<p>For example, <code>loglevel=3</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r3c1-t5" headers="r1c1-t5">
<p><code>logfile</code></p>
</td>
<td class="cellalignment10" headers="r3c1-t5 r1c2-t5">
<p>A log file that ONS should use for logging messages. The default value for log file is <code>$ORACLE_HOME/opmn/logs/ons.log</code>.</p>
<p>For example, <code>logfile=/private/oraclehome/opmn/logs/myons.log</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r4c1-t5" headers="r1c1-t5">
<p><code>walletfile</code></p>
</td>
<td class="cellalignment10" headers="r4c1-t5 r1c2-t5">
<p>The wallet file used by the Oracle Secure Sockets Layer (SSL) to store SSL certificates. If a wallet file is specified to ONS, then it uses SSL when communicating with other ONS instances and require SSL certificate authentication from all ONS instances that try to connect to it. This means that if you want to turn on SSL for one ONS instance, then you must turn it on for all instances that are connected. This value should point to the directory where your <code>ewallet.p12</code> file is located.</p>
<p>For example, <code>walletfile=/private/oraclehome/opmn/conf/ssl.wlt/default</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r5c1-t5" headers="r1c1-t5">
<p><code>useocr</code></p>
</td>
<td class="cellalignment10" headers="r5c1-t5 r1c2-t5">
<p>The value, reserved for use on the server-side, to indicate ONS whether it should store all Oracle RAC nodes and port numbers in Oracle Cluster Registry (OCR) instead of the ONS configuration file or not. A value of <code>useocr=on</code> is used to store all Oracle RAC nodes and port numbers in Oracle Cluster Registry (OCR).</p>
<p>Do not use this option on the client-side.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>The <code><a id="sthref976"></a>ons.config</code> file allows blank lines and comments on lines that begin with the number sign (<code>#</code>).</p>
</div>
<!-- class="sect3" -->
<a id="CDCGFFGI"></a><a id="JJDBC28941"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Configuring Client-Side ONS</h4>
<p>You can access the client-side ONS through <code><span class="codeinlineitalic">ORACLE_HOME</span></code><code>/opmn</code>. On the client-side, there are two ways to set up ONS:</p>
<ul>
<li>
<p>Remote ONS configuration</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="fstconfo.htm#CHDGDIIB">"Remote ONS Subscription"</a></div>
</li>
<li>
<p>ONS daemon on the client-side</p>
</li>
</ul>
<p><a href="#CDCIAFHI">Example B-1</a> illustrates how a sample configuration file may look.</p>
<div class="example">
<p class="titleinexample"><a id="CDCIAFHI"></a><a id="JJDBC28942"></a>Example B-1 Example of a Sample ons.config File</p>
<pre>
# This is an example ons.config file
#
# The first three values are required
localport=4100
remoteport=4200
nodes=racnode1.example.com:4200,racnode2.example.com:4200
</pre></div>
<!-- class="example" -->
<p>After configuring ONS, you start the ONS daemon with the <code>onsctl</code> command. It is the user's responsibility to make sure that an ONS daemon is running at all times.</p>
<p class="subhead2"><a id="JJDBC28943"></a>Using the onsctl Command</p>
<p>After configuring, use <code><span class="codeinlineitalic">ORACLE_HOME</span></code><code>/opmn/bin/onsctl</code> to start, stop, reconfigure, and monitor the ONS daemon. <a href="#CDCCIFBH">Table B-3</a> is a summary of the commands that <code>onsctl</code> supports.</p>
<div class="tblformal">
<p class="titleintable"><a id="JJDBC28944"></a><a id="sthref977"></a><a id="CDCCIFBH"></a>Table B-3 onsctl Commands</p>
<table class="cellalignment8" title="onsctl Commands" summary="table" dir="ltr">
<thead>
<tr class="cellalignment2">
<th class="cellalignment9" id="r1c1-t7">Command</th>
<th class="cellalignment9" id="r1c2-t7">Effect</th>
<th class="cellalignment9" id="r1c3-t7">Output</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2">
<td class="cellalignment10" id="r2c1-t7" headers="r1c1-t7">
<p><code>start</code></p>
</td>
<td class="cellalignment10" headers="r2c1-t7 r1c2-t7">
<p>Starts the ONS daemon</p>
</td>
<td class="cellalignment10" headers="r2c1-t7 r1c3-t7">
<p><code>onsctl: ons started</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r3c1-t7" headers="r1c1-t7">
<p><code>stop</code></p>
</td>
<td class="cellalignment10" headers="r3c1-t7 r1c2-t7">
<p>Stops the ONS daemon</p>
</td>
<td class="cellalignment10" headers="r3c1-t7 r1c3-t7">
<p><code>onsctl: shutting down ons daemon...</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r4c1-t7" headers="r1c1-t7">
<p><code>ping</code></p>
</td>
<td class="cellalignment10" headers="r4c1-t7 r1c2-t7">
<p>Verifies whether or not the ONS daemon is running</p>
</td>
<td class="cellalignment10" headers="r4c1-t7 r1c3-t7">
<p><code>ons is running ...</code></p>
</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r5c1-t7" headers="r1c1-t7">
<p><code>reconfig</code></p>
</td>
<td class="cellalignment10" headers="r5c1-t7 r1c2-t7">
<p>Triggers a reload of the ONS configuration without shutting down the ONS daemon</p>
</td>
<td class="cellalignment10" headers="r5c1-t7 r1c3-t7">&nbsp;</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r6c1-t7" headers="r1c1-t7">
<p><code>help</code></p>
</td>
<td class="cellalignment10" headers="r6c1-t7 r1c2-t7">
<p>Prints a help summary message for onsctl</p>
</td>
<td class="cellalignment10" headers="r6c1-t7 r1c3-t7">&nbsp;</td>
</tr>
<tr class="cellalignment2">
<td class="cellalignment10" id="r7c1-t7" headers="r1c1-t7">
<p><code>detailed</code></p>
</td>
<td class="cellalignment10" headers="r7c1-t7 r1c2-t7">
<p>Prints a detailed help message for onsctl</p>
</td>
<td class="cellalignment10" headers="r7c1-t7 r1c3-t7">&nbsp;</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RACAD0067" href="../../rac.112/e41960/adddelunix.htm#RACAD0067"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CDCFEFAF"></a><a id="JJDBC28945"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle RAC Fast Application Notification</h2>
<p><a href="#CDCDJIAC">Example B-2</a> provides an example to use Oracle RAC Fast Application Notification in your code. This example code prints the event data to the standard output device.</p>
<p>This example code demonstrates sample usages of Oracle RAC FAN APIs by overloading the <code>handleFanEvent</code> method to accept different FAN event notifications as arguments. The example code also displays event data such as</p>
<ul>
<li>
<p>Name of the system sending the FAN event notification</p>
</li>
<li>
<p>Timestamp of the FAN event notification</p>
</li>
<li>
<p>Load status of the FAN event notification</p>
</li>
</ul>
<div class="example">
<p class="titleinexample"><a id="CDCDJIAC"></a><a id="JJDBC28946"></a>Example B-2 Example of Sample Code Using Oracle RAC FAN API</p>
<pre>
...
...Properties props = new Properties();
props.putProperty(&ldquo;serviceName&rdquo;, &ldquo;gl&rdquo;);
FanSubscription sub = FanManager.getInstance().subscribe(props);
sub.addListener(new FanEventListener()) {
  public void handleFanEvent(ServiceDownEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(event.getServiceName());
      System.out.println(event.getDatabaseUniqueName());
      System.out.println(event.getReason());
      ServiceMemberEvent me = se.getServiceMemberEvent();
      if (me != null) {
        System.out.println(me.getInstanceName());
        System.out.println(me.getNodeName());
        System.out.println(me.getServiceMemberStatus());
      }
      ServiceCompositeEvent ce = se.getServiceCompositeEvent();
      if (ce != null) {
        System.out.println(ce.getServiceCompositeStatus());
      }
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
  public void handleFanEvent(NodeDownEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(ne.getNodeName());
      System.out.println(ne.getIncarnation());
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
  public void handleFanEvent(LoadAdvisoryEvent event) {
    try {
      System.out.println(event.getTimestamp());
      System.out.println(le.getServiceName());
      System.out.println(le.getDatabaseUniqueName());
      System.out.println(le.getInstanceName());
      System.out.println(le.getPercent());
      System.out.println(le.getServiceQuality());
      System.out.println(le.getLoadStatus());
    }
    catch (Throwable t) {
      // handle all exceptions and errors
      t.printStackTrace(System.err);
    }
  }
});
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" -->
<a id="CDCGBIEI"></a><a id="JJDBC28947"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Implementing a Connection Cache</h2>
<p>You must implement your own connection cache for using Oracle RAC FAN APIs. Consider the following points before you implement a connection cache using the Oracle RAC FAN APIs:</p>
<ul>
<li>
<p>Oracle RAC FAN APIs provide a minimal subset of FAN events.</p>
</li>
<li>
<p>Oracle RAC FAN APIs support only ONS events. If you want your application to support corresponding supercluster events, then you may require additions to the subscription properties.</p>
</li>
<li>
<p>Oracle RAC FAN APIs do not enable application code to send FAN events.</p>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1">
<tr>
<td class="cellalignment10">
<table class="cellalignment6">
<tr>
<td class="cellalignment5"><a href="apxref.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5"><a href="apxtips.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment13">
<table class="cellalignment4">
<tr>
<td class="cellalignment5"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment5"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment5"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment5"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment5"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
