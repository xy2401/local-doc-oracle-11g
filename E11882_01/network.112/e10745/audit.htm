<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Auditing Under Oracle Label Security</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-19T10:59:35Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Label Security Administrator's Guide" />
<meta name="dcterms.identifier" content="E10745-04" />
<meta name="dcterms.isVersionOf" content="OLSAG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2000, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="storproc.htm" title="Previous" type="text/html" />
<link rel="Next" href="multiple.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10745.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">20/30</span> <!-- End Header -->
<div id="OLSAG073" class="chapter"><a id="i1011722"></a>
<h1 class="chapter"><span class="secnum">12</span> Auditing Under Oracle Label Security</h1>
<p>The Oracle Database audit facility lets you hold database users accountable for the operations they perform. It can track specific database objects, operations, users, and privileges. Oracle Label Security supplements this by tracking use of its own administrative operations and policy privileges. It provides the SA_AUDIT_ADMIN package to set and change the policy auditing options.</p>
<p>This chapter explains how to use Oracle Label Security <a id="sthref745"></a>auditing. It contains these topics:</p>
<ul>
<li>
<p><a href="#i1011761">Overview of Oracle Label Security Auditing</a></p>
</li>
<li>
<p><a href="#i1011800">Enabling Systemwide Auditing: AUDIT_TRAIL Initialization Parameter</a></p>
</li>
<li>
<p><a href="#i1012234">Creating and Dropping an Audit Trail View for Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1014004">Oracle Label Security Auditing Tips</a></p>
</li>
</ul>
<a id="i1011761"></a>
<div id="OLSAG074" class="sect1">
<h2 class="sect1"><span class="secnum">12.1</span> Overview of Oracle Label Security Auditing</h2>
<p><a id="i1011766"></a>Oracle Label Security auditing supplements standard <span class="italic">Oracle Database</span> auditing by tracking use of its own administrative operations and policy privileges. You can use either the SA_AUDIT_ADMIN package or Oracle Enterprise Manager to set and change the auditing options for an Oracle Label Security policy.</p>
<p>When you create a new policy, a label column for that policy is added to the database audit trail. The label column is created regardless of whether <a id="sthref746"></a>auditing is enabled or disabled, and independent of whether database auditing or operating system auditing is used. Whenever a record is written to the audit table, each policy provides a label for that record to indicate the session label. The administrator can create audit views to display these labels. Note that in the audit table, the label does not control access to the row, instead it only records the sensitivity of the row.</p>
<p>The auditing options that you specify apply only to subsequent sessions, not to the current session. You can specify audit options even if auditing is disabled. No overhead is created by making only these specifications. When you do enable Oracle Label Security auditing, the options come into effect, and overhead is created beyond that created by standard <span class="italic">Oracle Database</span> auditing.</p>
<p>Note that Oracle Label Security does not provide labels for audit data written to the operating system audit trial. All Oracle Label Security audit records are written directly to the database <a id="sthref747"></a>audit trail, even if operating system auditing is enabled. If auditing is disabled, then no Oracle Label Security audit records are generated.</p>
</div>
<!-- class="sect1" -->
<a id="i1011800"></a>
<div id="OLSAG075" class="sect1">
<h2 class="sect1"><span class="secnum">12.2</span> Enabling Systemwide Auditing: AUDIT_TRAIL Initialization Parameter</h2>
<p>For Oracle Label Security to generate audit records, you must first enable <a id="sthref748"></a>systemwide auditing by setting the <span class="italic">Oracle Database</span> <a id="sthref749"></a>AUDIT_TRAIL <a id="sthref750"></a>initialization parameter in the database's parameter file. The parameter can be set to one of the following values:</p>
<div id="OLSAG3382" class="tblformal">
<p class="titleintable"><a id="sthref751"></a><a id="g1014704"></a>Table 12-1 AUDIT_TRAIL Parameter Settings</p>
<table class="cellalignment2269" title="AUDIT_TRAIL Parameter Settings " summary="This table lists and explains the AUDIT_TRAIL parameter settings." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2272" id="r1c1-t2">Setting</th>
<th class="cellalignment2272" id="r1c2-t2">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t2" headers="r1c1-t2">
<p>DB</p>
</td>
<td class="cellalignment2268" headers="r2c1-t2 r1c2-t2">
<p>Enables database auditing and directs all audit records to the database audit trail. This approach is recommended by Oracle.</p>
<p>Note that even with AUDIT_TRAIL set to DB, some records are always sent to the operating system <a id="sthref752"></a>audit trail. These include STARTUP and SHUTDOWN statements, as well as CONNECT AS SYSOPER or <a id="sthref753"></a>SYSDBA.</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t2" headers="r1c1-t2">
<p>DB, EXTENDED</p>
</td>
<td class="cellalignment2268" headers="r3c1-t2 r1c2-t2">
<p>Does all actions of AUDIT_TRAIL=DB and also populates the SqlBind and SqlText CLOB-type columns of the AUD$ table.</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r4c1-t2" headers="r1c1-t2">
<p>OS</p>
</td>
<td class="cellalignment2268" headers="r4c1-t2 r1c2-t2">
<p>Enables operating system auditing. This directs most of your <span class="italic">Oracle Database</span> audit records to the operating system, rather than to the database; the records will not contain Oracle Label Security labels. By contrast, any Oracle Label Security auditing will go to the database, with labels.</p>
<p>If you set AUDIT_TRAIL to OS, then the Oracle Label Security-specific audit records are written to the database audit trail and the other <span class="italic">Oracle Database</span> audit records are written to the operating system audit trail (with no policy column in the operating system data).</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r5c1-t2" headers="r1c1-t2">
<p>NONE</p>
</td>
<td class="cellalignment2268" headers="r5c1-t2 r1c2-t2">
<p>Disables auditing. This is the default.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>After you have edited the parameter file, restart the database instance to enable or disable database auditing as specified.</p>
<p>Set the AUDIT_TRAIL parameter before you set audit options. If you do not set this parameter, then you are still able to set audit options. However, audit records are not written to the database until the parameter is set and the database instance is restarted.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For information about enabling and disabling systemwide auditing, setting audit options, and managing the audit trail, refer to <a class="olink ADMIN" href="../../server.112/e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a>
<p>For information about editing initialization parameters, refer to <a class="olink REFRN" href="../../server.112/e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a></p>
<p>For details about systemwide AUDIT and NOAUDIT functioning, see <a class="olink SQLRF" href="../../server.112/e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</div>
</div>
<!-- class="sect1" -->
<a id="i1011868"></a>
<div id="OLSAG076" class="sect1">
<h2 class="sect1"><span class="secnum">12.3</span> Enabling Oracle Label Security Auditing with SA_AUDIT_ADMIN</h2>
<p>After you have enabled systemwide auditing, you can use SA_AUDIT_ADMIN procedures to enable or disable Oracle Label Security auditing. To use Oracle Label Security auditing, you must have the <span class="italic">policy_type</span> role.</p>
<ul>
<li>
<p><a href="#i1011899">Auditing Options for Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1011940">Enabling Oracle Label Security Auditing with SA_AUDIT_ADMIN.AUDIT</a></p>
</li>
<li>
<p><a href="#i1012011">Disabling Oracle Label Security Auditing with SA_AUDIT_ADMIN.NOAUDIT</a></p>
</li>
<li>
<p><a href="#i1012085">Examining Audit Options with the DBA_SA_AUDIT_OPTIONS View</a></p>
</li>
</ul>
<a id="i1011899"></a>
<div id="OLSAG3383" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.1</span> Auditing Options for Oracle Label Security</h3>
<p><a id="sthref754"></a>The AUDIT and <a id="sthref755"></a>NOAUDIT options are as follows:</p>
<div id="OLSAG3384" class="tblformal">
<p class="titleintable"><a id="sthref756"></a><a id="g1022699"></a>Table 12-2 Auditing Options for Oracle Label Security</p>
<table class="cellalignment2269" title="Auditing Options for Oracle Label Security" summary="This table describes the auditing options for Oracle Label Security." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t4">Option</th>
<th class="cellalignment2267" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t4" headers="r1c1-t4">
<p>APPLY</p>
</td>
<td class="cellalignment2268" headers="r2c1-t4 r1c2-t4">
<p>Audits application of specified Oracle Label Security policies to tables and schemas</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t4" headers="r1c1-t4">
<p>REMOVE</p>
</td>
<td class="cellalignment2268" headers="r3c1-t4 r1c2-t4">
<p>Audits removal of specified Oracle Label Security policies from tables and schemas</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r4c1-t4" headers="r1c1-t4">
<p>SET</p>
</td>
<td class="cellalignment2268" headers="r4c1-t4 r1c2-t4">
<p>Audits the setting of user authorizations, and user and program privileges</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r5c1-t4" headers="r1c1-t4">
<p>PRIVILEGES</p>
</td>
<td class="cellalignment2268" headers="r5c1-t4 r1c2-t4">
<p>Audits use of all policy-specific privileges</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="sect2" -->
<a id="i1011940"></a>
<div id="OLSAG3385" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.2</span> Enabling Oracle Label Security Auditing with SA_AUDIT_ADMIN.AUDIT</h3>
<p><a id="sthref757"></a>Use the <a id="sthref758"></a>AUDIT procedure to enable policy-specific auditing.</p>
<p><span class="bold">Syntax:</span></p>
<pre>
PROCEDURE AUDIT (
     policy_name     IN VARCHAR2,
     users           IN VARCHAR2 DEFAULT NULL,
     option          IN VARCHAR2 DEFAULT NULL,
     type            IN VARCHAR2 DEFAULT NULL,
     success         IN VARCHAR2 DEFAULT NULL);
</pre>
<div class="inftblinformal">
<table class="cellalignment2266" title="Parameters used by the AUDIT procedure" summary="This table lists and describes each parameter for the SA_AUDIT_ADMIN.AUDIT procedure, along with the default behavior if the parameter is not specified." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t5">Parameter</th>
<th class="cellalignment2267" id="r1c2-t5">Description</th>
<th class="cellalignment2267" id="r1c3-t5">Default Behavior</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t5" headers="r1c1-t5"><span class="italic">policy_name</span></td>
<td class="cellalignment2268" headers="r2c1-t5 r1c2-t5">Required. Specifies the name of an existing policy. Auditing of each policy is independent of all others.</td>
<td class="cellalignment2268" headers="r2c1-t5 r1c3-t5">None</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t5" headers="r1c1-t5"><span class="italic">users</span></td>
<td class="cellalignment2268" headers="r3c1-t5 r1c2-t5">Optional. A comma-delimited list of user names to audit. If not specified, then all users are audited.</td>
<td class="cellalignment2268" headers="r3c1-t5 r1c3-t5">All users</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r4c1-t5" headers="r1c1-t5"><span class="italic">option</span></td>
<td class="cellalignment2268" headers="r4c1-t5 r1c2-t5">Optional. A comma-delimited list of options to be audited. Refer to <a href="#g1014704">Table 12-1</a>.
<p>If not specified, then all default options (that is, options not including privileges) are audited. Audit options for privileged operations should be set explicitly by specifying the PRIVILEGES option, which sets audit options for all privileges.</p>
</td>
<td class="cellalignment2268" headers="r4c1-t5 r1c3-t5">All options</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r5c1-t5" headers="r1c1-t5"><span class="italic">type</span></td>
<td class="cellalignment2268" headers="r5c1-t5 r1c2-t5">Optional. BY ACCESS or BY SESSION. If not specified, then audit records are written by session.</td>
<td class="cellalignment2268" headers="r5c1-t5 r1c3-t5">BY SESSION</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r6c1-t5" headers="r1c1-t5"><span class="italic">success</span></td>
<td class="cellalignment2268" headers="r6c1-t5 r1c2-t5">Optional. SUCCESSFUL or NOT SUCCESSFUL. If not specified, then audit is written for both.</td>
<td class="cellalignment2268" headers="r6c1-t5 r1c3-t5">SUCCESSFUL and NOT SUCCESSFUL</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>If the administrator does not specify any audit options, then all options except the privilege-related ones are audited. Auditing of privileges must be specified explicitly. For example, if the administrator enters</p>
<pre>
SA_AUDIT_ADMIN.AUDIT ('HR');
</pre>
<p>then default auditing options are set for the HR policy. When the administrator enables auditing, it will be performed on all users by session, whether successful or not.</p>
<p>When you set auditing parameters and options, the new values apply only to subsequent sessions, not to the current session.</p>
<p>Consider also a case in which one AUDIT call (with no users specified) enables auditing for APPLY operations for all users, and then a second call enables auditing of REMOVE operations for a specific user. For example:</p>
<pre>
SA_AUDIT_ADMIN.AUDIT ('HR', NULL, 'APPLY');
SA_AUDIT_ADMIN.AUDIT ('HR', 'SCOTT', 'REMOVE');
</pre>
<p>In this case, SCOTT is audited for both APPLY and REMOVE operations.</p>
</div>
<!-- class="sect2" -->
<a id="i1012011"></a>
<div id="OLSAG3386" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.3</span> Disabling Oracle Label Security Auditing with SA_AUDIT_ADMIN.NOAUDIT</h3>
<p>To disable policy-specific auditing, use the SA_AUDIT_ADMIN.<a id="sthref759"></a>NOAUDIT procedure.</p>
<p><span class="bold">Syntax:</span></p>
<pre>
PROCEDURE NOAUDIT (
     policy_name     IN VARCHAR2,
     users           IN VARCHAR2 DEFAULT NULL,
     option          IN VARCHAR2 DEFAULT NULL);
</pre>
<div class="inftblinformal">
<table class="cellalignment2266" title="Parameters used by the NOAUDIT procedure" summary="This table lists and describes each parameter for the SA_AUDIT_ADMIN.NOAUDIT procedure, along with the default behavior if the parameter is not specified." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t6">Parameter</th>
<th class="cellalignment2267" id="r1c2-t6">Description</th>
<th class="cellalignment2267" id="r1c3-t6">Default Behavior</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t6" headers="r1c1-t6"><span class="italic">policy_name</span></td>
<td class="cellalignment2268" headers="r2c1-t6 r1c2-t6">Required. Specifies the name of an existing policy.</td>
<td class="cellalignment2268" headers="r2c1-t6 r1c3-t6">None</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t6" headers="r1c1-t6"><span class="italic">users</span></td>
<td class="cellalignment2268" headers="r3c1-t6 r1c2-t6">Optional. A comma-delimited list of user names to audit. If not specified, then auditing is disabled for all users.</td>
<td class="cellalignment2268" headers="r3c1-t6 r1c3-t6">All users</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r4c1-t6" headers="r1c1-t6"><span class="italic">option</span></td>
<td class="cellalignment2268" headers="r4c1-t6 r1c2-t6">Optional. A comma-delimited list of options to be disabled.Refer to <a href="#g1022699">Table 12-2</a>. If not specified, then all default options are disabled. Privileges must be disabled explicitly.</td>
<td class="cellalignment2268" headers="r4c1-t6 r1c3-t6">All options</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>You can disable auditing for all enabled options, or only for a subset of enabled options. All auditing for the specified options is disabled for all specified users (or all users, if the <span class="italic">users</span> parameter is NULL). For example, the following statement disables auditing of the APPLY and REMOVE operations for users John, Mary, and Scott:</p>
<pre>
SA_AUDIT_ADMIN.<a id="sthref760"></a>NOAUDIT ('HR', 'JOHN, MARY, SCOTT', 'APPLY, REMOVE');
</pre>
<p>Consider also a case in which one AUDIT call enables auditing for a specific user, and a second call (with no user specified) enables auditing for all users. For example:</p>
<pre>
SA_AUDIT_ADMIN.AUDIT ('HR', 'SCOTT');
SA_AUDIT_ADMIN.AUDIT ('HR');
</pre>
<p>In this case, a subsequent call to NOAUDIT with no users specified (such as the following)</p>
<pre>
SA_AUDIT_ADMIN.NOAUDIT ('HR');
</pre>
<p>does not reverse the auditing that was set for SCOTT explicitly in the first call. So, auditing continues to be performed on SCOTT. In this way, even if NOAUDIT is set for all users, Oracle Label Security still audits any users for whom auditing was explicitly set.</p>
<p>Auditing of privileged operations must be specified explicitly. If you run NOAUDIT with no options, the Oracle Label Security will nonetheless continue to audit privileged operations. For example, if auditing is enabled and you enter</p>
<pre>
SA_AUDIT_ADMIN.NOAUDIT ('HR');
</pre>
<p>then auditing will continue to be performed on the privileged operations (such as WRITEDOWN).</p>
<p>NOAUDIT parameters and options that you set apply only to subsequent sessions, not to current sessions.</p>
<p>If you try to enable an audit option that has already been set, or if you try to disable an audit option that has not been set, then Oracle Label Security processes the statement without indicating an error. An attempt to specify an invalid option results in an error message.</p>
</div>
<!-- class="sect2" -->
<a id="i1012085"></a>
<div id="OLSAG3387" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.4</span> Examining Audit Options with the DBA_SA_AUDIT_OPTIONS View</h3>
<p>This section describes the view that displays the Oracle Label Security auditing options and privileges.</p>
<p><a id="sthref761"></a><a id="sthref762"></a>The DBA_SA_AUDIT_OPTIONS view contains the following columns:</p>
<div id="OLSAG3388" class="tblformal">
<p class="titleintable"><a id="sthref763"></a><a id="sthref764"></a>Table 12-3 Columns in the DBA_SA_AUDIT_OPTIONS View</p>
<table class="cellalignment2269" title="Columns in the DBA_SA_AUDIT_OPTIONS View " summary="This table lists the name and type of each column of the DBA_SA_AUDIT_OPTIONS view and identifies which must not be null." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t7">Name</th>
<th class="cellalignment2267" id="r1c2-t7">Null?</th>
<th class="cellalignment2267" id="r1c3-t7">Type</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t7" headers="r1c1-t7">
<p>POLICY_NAME</p>
</td>
<td class="cellalignment2268" headers="r2c1-t7 r1c2-t7">
<p>NOT NULL</p>
</td>
<td class="cellalignment2268" headers="r2c1-t7 r1c3-t7">
<p>VARCHAR2(30)</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t7" headers="r1c1-t7">
<p>USER_NAME</p>
</td>
<td class="cellalignment2268" headers="r3c1-t7 r1c2-t7">
<p>NOT NULL</p>
</td>
<td class="cellalignment2268" headers="r3c1-t7 r1c3-t7">
<p>VARCHAR2(30)</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r4c1-t7" headers="r1c1-t7">
<p>APY</p>
</td>
<td class="cellalignment2268" headers="r4c1-t7 r1c2-t7">&nbsp;</td>
<td class="cellalignment2268" headers="r4c1-t7 r1c3-t7">
<p>VARCHAR2(3)</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r5c1-t7" headers="r1c1-t7">
<p>REM</p>
</td>
<td class="cellalignment2268" headers="r5c1-t7 r1c2-t7">&nbsp;</td>
<td class="cellalignment2268" headers="r5c1-t7 r1c3-t7">
<p>VARCHAR2(3)</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r6c1-t7" headers="r1c1-t7">
<p>SET_</p>
</td>
<td class="cellalignment2268" headers="r6c1-t7 r1c2-t7">&nbsp;</td>
<td class="cellalignment2268" headers="r6c1-t7 r1c3-t7">
<p>VARCHAR2(3)</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r7c1-t7" headers="r1c1-t7">
<p>PRV</p>
</td>
<td class="cellalignment2268" headers="r7c1-t7 r1c2-t7">&nbsp;</td>
<td class="cellalignment2268" headers="r7c1-t7 r1c3-t7">
<p>VARCHAR2(30</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>Output is similar to the following:</p>
<div id="OLSAG3389" class="tblformal">
<p class="titleintable"><a id="sthref765"></a><a id="sthref766"></a>Table 12-4 DBA_SA_AUDIT_OPTIONS Sample Output</p>
<table class="cellalignment2269" title="DBA_SA_AUDIT_OPTIONS Sample Output" summary="This table shows a sample of the output from DBA_SA_AUDIT_OPTIONS." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t8">POLICY_NAME</th>
<th class="cellalignment2267" id="r1c2-t8">USER_NAME</th>
<th class="cellalignment2267" id="r1c3-t8">APY</th>
<th class="cellalignment2267" id="r1c4-t8">REM</th>
<th class="cellalignment2267" id="r1c5-t8">SET</th>
<th class="cellalignment2267" id="r1c6-t8">PRV</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t8" headers="r1c1-t8">
<p>HR</p>
</td>
<td class="cellalignment2268" headers="r2c1-t8 r1c2-t8">
<p>SCOTT</p>
</td>
<td class="cellalignment2268" headers="r2c1-t8 r1c3-t8">
<p>-/-</p>
</td>
<td class="cellalignment2268" headers="r2c1-t8 r1c4-t8">
<p>-/-</p>
</td>
<td class="cellalignment2268" headers="r2c1-t8 r1c5-t8">
<p>-/-</p>
</td>
<td class="cellalignment2268" headers="r2c1-t8 r1c6-t8">
<p>A/A</p>
</td>
</tr>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r3c1-t8" headers="r1c1-t8">
<p>HR</p>
</td>
<td class="cellalignment2268" headers="r3c1-t8 r1c2-t8">
<p>LBACSYS</p>
</td>
<td class="cellalignment2268" headers="r3c1-t8 r1c3-t8">
<p>S/S</p>
</td>
<td class="cellalignment2268" headers="r3c1-t8 r1c4-t8">
<p>S/S</p>
</td>
<td class="cellalignment2268" headers="r3c1-t8 r1c5-t8">
<p>S/S</p>
</td>
<td class="cellalignment2268" headers="r3c1-t8 r1c6-t8">
<p>-/-</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Chapter 11 of the <a class="olink DBSEG" href="../e36292/toc.htm"><span class="italic">Oracle Database Security Guide</span></a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<div id="OLSAG077" class="sect1"><a id="sthref767"></a>
<h2 class="sect1"><span class="secnum">12.4</span> Managing Policy Label Auditing</h2>
<p>This section describes procedures available to manage policy label auditing:</p>
<ul>
<li>
<p><a href="#i1012177">Policy Label Auditing with SA_AUDIT_ADMIN.AUDIT_LABEL</a></p>
</li>
<li>
<p><a href="#i1012201">Disabling Policy Label Auditing with SA_AUDIT_ADMIN.NOAUDIT_LABEL</a></p>
</li>
<li>
<p><a href="#i1012225">Finding Label Audit Status with AUDIT_LABEL_ENABLED</a></p>
</li>
</ul>
<a id="i1012177"></a>
<div id="OLSAG3390" class="sect2">
<h3 class="sect2"><span class="secnum">12.4.1</span> Policy Label Auditing with SA_AUDIT_ADMIN.AUDIT_LABEL</h3>
<p>Use the <a id="sthref768"></a>AUDIT_LABEL procedure to record policy labels during auditing. It causes the user's session label to be stored in the audit table.</p>
<p><span class="bold">Syntax:</span></p>
<pre>
PROCEDURE AUDIT_LABEL (
     policy_name     IN VARCHAR2);
</pre>
<div class="inftblinformal">
<table class="cellalignment2266" title="Parameters used by the AUDIT_LABEL procedure" summary="This table lists and describes the parameter used by SA_AUDIT_ADMIN.AUDIT_LABEL." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t10">Parameter</th>
<th class="cellalignment2267" id="r1c2-t10">Description</th>
<th class="cellalignment2267" id="r1c3-t10">Default</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t10" headers="r1c1-t10"><span class="italic">policy_name</span></td>
<td class="cellalignment2268" headers="r2c1-t10 r1c2-t10">Required. Specifies the name of an existing policy.</td>
<td class="cellalignment2268" headers="r2c1-t10 r1c3-t10">None</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="sect2" -->
<a id="i1012201"></a>
<div id="OLSAG3391" class="sect2">
<h3 class="sect2"><span class="secnum">12.4.2</span> Disabling Policy Label Auditing with SA_AUDIT_ADMIN.NOAUDIT_LABEL</h3>
<p>Use the <a id="sthref769"></a>NOAUDIT_LABEL procedure to disable auditing of policy labels.</p>
<p><span class="bold">Syntax:</span></p>
<pre>
PROCEDURE NOAUDIT_LABEL (
     policy_name     IN VARCHAR2);
</pre>
<div class="inftblinformal">
<table class="cellalignment2266" title="Parameters used by the NOAUDIT_LABEL procedure" summary="This table lists and describes the parameter used by SA_AUDIT_ADMIN.NOAUDIT_LABEL." dir="ltr">
<thead>
<tr class="cellalignment2260">
<th class="cellalignment2267" id="r1c1-t11">Parameter</th>
<th class="cellalignment2267" id="r1c2-t11">Description</th>
<th class="cellalignment2267" id="r1c3-t11">Default</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2260">
<td class="cellalignment2268" id="r2c1-t11" headers="r1c1-t11"><span class="italic">policy_name</span></td>
<td class="cellalignment2268" headers="r2c1-t11 r1c2-t11">Required. Specifies the name of an existing policy.</td>
<td class="cellalignment2268" headers="r2c1-t11 r1c3-t11">None</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="sect2" -->
<a id="i1012225"></a>
<div id="OLSAG3392" class="sect2">
<h3 class="sect2"><span class="secnum">12.4.3</span> Finding Label Audit Status with AUDIT_LABEL_ENABLED</h3>
<p>Use the <a id="sthref770"></a><a id="sthref771"></a>AUDIT_LABEL_ENABLED function to show whether labels are being recorded in audit records for the policy.</p>
<p><span class="bold">Syntax:</span></p>
<pre>
FUNCTION AUDIT_LABEL_ENABLED (policy_name IN VARCHAR2)
     RETURN boolean;
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1012234"></a>
<div id="OLSAG078" class="sect1">
<h2 class="sect1"><span class="secnum">12.5</span> Creating and Dropping an Audit Trail View for Oracle Label Security</h2>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#i1012248">Creating a View with SA_AUDIT_ADMIN.CREATE_VIEW</a></p>
</li>
<li>
<p><a href="#i1012263">Dropping a View with SA_AUDIT_ADMIN.DROP_VIEW</a></p>
</li>
</ul>
<a id="i1012248"></a>
<div id="OLSAG3393" class="sect2">
<h3 class="sect2"><span class="secnum">12.5.1</span> Creating a View with SA_AUDIT_ADMIN.CREATE_VIEW</h3>
<p>The <a id="sthref772"></a>CREATE_VIEW procedure creates an <a id="sthref773"></a><a id="sthref774"></a>audit trail view named DBA_<span class="italic">policyname</span>_AUDIT_TRAIL, which contains the specified policy's label column as well as all the entries in the audit trail written on behalf of this policy. If the view name exceeds the database limit of 30 characters, then the user can optionally specify a shorter view name.</p>
<p>Syntax (either of two):</p>
<ol>
<li>
<p>A one-parameter procedure:</p>
<pre>
PROCEDURE CREATE_VIEW (
     policy_name     IN VARCHAR2);
</pre>
<p>where <span class="italic">policy_name</span> specifies the name of an existing policy.</p>
<p>or</p>
</li>
<li>
<p>A two-parameter procedure:</p>
<pre>
PROCEDURE CREATE_VIEW (
     policy_name     IN VARCHAR2,
     view_name       IN VARCHAR2    DEFAULT NULL);
</pre>
<p>where <span class="italic">policy_name</span> specifies the name of an existing policy and <span class="italic">view_name</span> is an optional parameter, maximum 14 characters, specifying the desired view name.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1012263"></a>
<div id="OLSAG3394" class="sect2">
<h3 class="sect2"><span class="secnum">12.5.2</span> Dropping a View with SA_AUDIT_ADMIN.DROP_VIEW</h3>
<p>The <a id="sthref775"></a>DROP_VIEW procedure drops the audit trail view for the specified policy.</p>
<p>Syntax (either of two):</p>
<ol>
<li>
<p>A one-parameter procedure:</p>
<pre>
PROCEDURE DROP_VIEW (
     policy_name     IN VARCHAR2);
</pre>
<p>where <span class="italic">policy_name</span> specifies the name of an existing policy.</p>
<p>or</p>
</li>
<li>
<p>A two-parameter procedure:</p>
<pre>
PROCEDURE DROP_VIEW (
     policy_name     IN VARCHAR2,
     view_name       IN VARCHAR2    DEFAULT NULL);
</pre>
<p>where <span class="italic">policy_name</span> specifies the name of an existing policy and <span class="italic">view_name</span> is an optional parameter, maximum 14 characters, specifying an existing view's name .</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
When sa_audit_admin.create_view was used to create a pre-10i audit view, that view did not show the timestamp field for the audit records in 10i. Oracle Label Security recommends that all pre-10i Oracle Label Security audit views be dropped and re-created, by using sa_audit_admin.drop_view and sa_audit_admin.create_view.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1014004"></a>
<div id="OLSAG079" class="sect1">
<h2 class="sect1"><span class="secnum">12.6</span> Oracle Label Security Auditing Tips</h2>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#i1012287">Strategy for Setting SA_AUDIT_ADMIN Options</a></p>
</li>
<li>
<p><a href="#i1012311">Auditing Privileged Operations</a></p>
</li>
</ul>
<a id="i1012287"></a>
<div id="OLSAG3395" class="sect2">
<h3 class="sect2"><span class="secnum">12.6.1</span> Strategy for Setting SA_AUDIT_ADMIN Options</h3>
<p>Before setting any audit options, you must devise an <a id="sthref776"></a>auditing strategy that monitors events of interest, without recording extraneous events. You should periodically review this strategy, because applications, user base, configurations, and other external factors can change.</p>
<p>The Oracle Label Security options, and those provided by the <span class="italic">Oracle Database</span> audit facility, might not directly address all of your specific or application-dependent auditing requirements. However, through use of database triggers, you can audit specific events and record specific information that you cannot audit and record using the more generic audit facility.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For more information about using triggers for auditing, see <a class="olink CNCPT" href="../../server.112/e40540/toc.htm"><span class="italic">Oracle Database Concepts</span></a></div>
</div>
<!-- class="sect2" -->
<a id="i1012311"></a>
<div id="OLSAG3396" class="sect2">
<h3 class="sect2"><span class="secnum">12.6.2</span> Auditing Privileged Operations</h3>
<p>Consider auditing any operations that require Oracle Label Security privileges. Because these privileges perform sensitive operations, and because their abuse could jeopardize security, you should closely monitor their dissemination and use.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2259">
<tr>
<td class="cellalignment2268">
<table class="cellalignment2264">
<tr>
<td class="cellalignment2263"><a href="storproc.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2263"><a href="multiple.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2000, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2271">
<table class="cellalignment2262">
<tr>
<td class="cellalignment2263"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2263"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2263"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2263"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2263"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2263"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
