<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Using Oracle Label Security with a Distributed Database</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-19T10:59:36Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Label Security Administrator's Guide" />
<meta name="dcterms.identifier" content="E10745-04" />
<meta name="dcterms.isVersionOf" content="OLSAG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2000, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="audit.htm" title="Previous" type="text/html" />
<link rel="Next" href="utilities.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10745.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">21/30</span> <!-- End Header -->
<div id="OLSAG080" class="chapter"><a id="CACGACFF"></a><a id="i1012332"></a>
<h1 class="chapter"><span class="secnum">13</span> Using Oracle Label Security with a Distributed Database</h1>
<p>This chapter describes special considerations for using Oracle Label Security in a distributed configuration. It contains the following sections:</p>
<ul>
<li>
<p><a href="#i1012365">An Oracle Label Security Distributed Configuration</a></p>
</li>
<li>
<p><a href="#i1012391">Connecting to a Remote Database Under Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1012422">Establishing Session Label and Row Label for a Remote Session</a></p>
</li>
<li>
<p><a href="#i1012440">Setting Up Labels in a Distributed Environment</a></p>
</li>
<li>
<p><a href="#i1012477">Using Oracle Label Security Policies in a Distributed Environment</a></p>
</li>
<li>
<p><a href="#i1012506">Using Replication with Oracle Label Security</a></p>
</li>
</ul>
<a id="i1012365"></a>
<div id="OLSAG081" class="sect1">
<h2 class="sect1"><span class="secnum">13.1</span> An Oracle Label Security Distributed Configuration</h2>
<p>A network configuration that supports <a id="sthref777"></a>distributed databases can include multiple <span class="italic">Oracle Database</span> servers, or other database servers, running on the same or different operating systems. Each cooperative server in a distributed system communicates with other clients and servers over a network.</p>
<p><a href="#CACBCAIF">Figure 13-1, "Using Oracle Label Security with a Distributed Database"</a> illustrates a distributed database that includes clients and servers with and without Oracle Label Security. As described in this chapter, if you establish database links from the WESTERN_REGION database to the EASTERN_REGION database, then you can access data if your userid on EASTERN_REGION is authorized to see it, even if locally (on WESTERN_REGION) you do not have this access.</p>
<div id="OLSAG3397" class="figure">
<p class="titleinfigure"><a id="CACBCAIF"></a>Figure 13-1 Using Oracle Label Security with a Distributed Database</p>
<img width="569" height="575" src="img/olsag019.gif" alt="Description of Figure 13-1 follows" /><br />
<a id="sthref778" href="img_text/olsag019.htm">Description of "Figure 13-1 Using Oracle Label Security with a Distributed Database"</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="i1012391"></a>
<div id="OLSAG082" class="sect1">
<h2 class="sect1"><span class="secnum">13.2</span> Connecting to a Remote Database Under Oracle Label Security</h2>
<p><a id="sthref779"></a>Distributed databases act in the standard way with Oracle Label Security: the local user ends up connected as a particular <a id="sthref780"></a>remote user. Oracle Label Security protects the labeled data, whether you connect locally or remotely. If the remote user has the proper labels, then you can access the data. If not, then you cannot access the data.</p>
<p>The <a id="sthref781"></a>database link sets up the connection to the remote database and identifies the user who will be associated with the remote session. Your Oracle Label Security authorizations on the remote database are based on those of the remote user identified in the database link.</p>
<p>For example, local user JANE might connect as remote user AUSTEN, in the database referenced by the connect string <code>sales</code>, as follows:</p>
<pre>
CREATE DATABASE LINK sales
  CONNECT TO austen IDENTIFIED BY pride
  USING 'sales'
</pre>
<p>When JANE connects, her authorizations are based on the labels and privileges of remote user AUSTEN, because AUSTEN is the user identified in the database link. When JANE makes the first reference to the remote database, the remote session is actually established. For example, the remote session would be created if JANE enters:</p>
<pre>
SELECT * FROM emp@sales
</pre>
<p>You need not be an Oracle Label Security policy user in the local database. If you connect as a policy user on the remote database, you can access protected data.</p>
</div>
<!-- class="sect1" -->
<a id="i1012422"></a>
<div id="OLSAG083" class="sect1">
<h2 class="sect1"><span class="secnum">13.3</span> Establishing Session Label and Row Label for a Remote Session</h2>
<p>When connecting remotely, you can directly control the <a id="sthref782"></a><a id="sthref783"></a>session label and <a id="sthref784"></a>row label in effect when you establish the connection. When you connect, Oracle Label Security passes these values (for all policies) over to the remote database. Notice that:</p>
<ul>
<li>
<p>The local session label and row label are used as the default for the remote session, if they are valid for the remote user.</p>
</li>
<li>
<p>The remote session is constrained by the minimum and maximum authorizations of the remote user.</p>
</li>
<li>
<p>Although the local user's session labels are passed to the remote database, the local user's privileges are not passed. The privileges for the remote session are those associated with the remote user.</p>
</li>
</ul>
<p>Consider a local user, Diana, with a maximum level of HS, and a session level of S. On the remote database, the remote user identified in the database link has a maximum level of S.</p>
<ul>
<li>
<p>If Diana's session label is S when the database link is established, then the S label is passed over. This is a valid label. Diana can connect and read SENSITIVE data.</p>
</li>
<li>
<p>If Diana's session label is HS when the database link is established, then the HS level is passed across, but it is not valid for the remote user. Diana will pick up the remote user's default label (S).</p>
</li>
</ul>
<p>Be aware of the label at which you are running the first time you connect to the remote database. The first time you reference a database link, your local session labels are sent across to the remote system when a connection is made. Later, you can change the label, but to do so, you must run the <a id="sthref785"></a>SA_SESSION.SET_LABEL procedure on the remote database.</p>
<p>Diana can connect at level HS, set the label to S, and then perform a remote access. Connection is implicitly made when the database link is established. Her default label is S on the remote database.</p>
<p>On the local database, Diana can set her session label to her maximum level of HS, but if the label of the remote user is set to S, then she can only retrieve S data from the remote database. If she performs a distributed query, then she will get HS data from the local database, and S data from the remote database.</p>
</div>
<!-- class="sect1" -->
<a id="i1012440"></a>
<div id="OLSAG084" class="sect1">
<h2 class="sect1"><span class="secnum">13.4</span> Setting Up Labels in a Distributed Environment</h2>
<p>It is advisable to use the same <a id="sthref786"></a>label component definitions and label tags on any database that is to be protected by the policy.</p>
<ul>
<li>
<p><a href="#i1012452">Setting Label Tags in a Distributed Environment</a></p>
</li>
<li>
<p><a href="#i1012468">Setting Numeric Form of Label Components in a Distributed Environment</a></p>
</li>
</ul>
<a id="i1012452"></a>
<div id="OLSAG3398" class="sect2">
<h3 class="sect2"><span class="secnum">13.4.1</span> Setting Label Tags in a Distributed Environment</h3>
<p>In a <a id="sthref787"></a>distributed environment, you may choose to use the same label tags across multiple databases. However, if you choose <span class="italic">not</span> to use the same tags across multiple databases, then you should retrieve the character form of the label when performing remote operations. This will ensure that the labels are consistent.</p>
<p>In the following example, the character string representation of the label string is the same. However, the label tag does not match. If the retrieved label tag has a value of 11 on the WESTERN_REGION database but a tag of 2001 on the EASTERN_REGION database, then the tags have no meaning. Serious consequences can result.</p>
<div id="OLSAG3399" class="figure">
<p class="titleinfigure"><a id="sthref788"></a>Figure 13-2 Label Tags in a Distributed Database</p>
<img width="496" height="112" src="img/olsag020.gif" alt="Description of Figure 13-2 follows" /><br />
<a id="sthref789" href="img_text/olsag020.htm">Description of "Figure 13-2 Label Tags in a Distributed Database"</a><br />
<br /></div>
<!-- class="figure" -->
<p>When retrieving labels from a remote system, you should return the character string representation (rather than the numeric label tag), unless you are using the same numeric labels on both databases.</p>
<p>If you allow Oracle Label Security to automatically generate labels on different databases, then the label tags will not be identical. Character strings will have meaning, but the numeric values will not, unless you have predefined labels with the same label tags on both instances.</p>
<p>To avoid the complexities of label tags, you can convert labels to strings on retrieval (using LABEL_TO_CHAR) and use CHAR_TO_LABEL when you store labels. Operations will succeed as long as the component names are the same.</p>
</div>
<!-- class="sect2" -->
<a id="i1012468"></a>
<div id="OLSAG3400" class="sect2">
<h3 class="sect2"><span class="secnum">13.4.2</span> Setting Numeric Form of Label Components in a Distributed Environment</h3>
<p>In a distributed environment, you should use the same relative ranking of the numeric form of the level component, to ensure proper sorting of the labels.</p>
<p>In the following example, the levels in the two databases are effectively the same. Although the numeric form is different, the relative ranking of the levels numeric form is the same. As long as the relative order of the components is the same, the labels are perceived as identical.</p>
<div id="OLSAG3401" class="figure">
<p class="titleinfigure"><a id="sthref790"></a>Figure 13-3 Label Components in a Distributed Database</p>
<img width="496" height="116" src="img/olsag021.gif" alt="Description of Figure 13-3 follows" /><br />
<a id="sthref791" href="img_text/olsag021.htm">Description of "Figure 13-3 Label Components in a Distributed Database"</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1012477"></a>
<div id="OLSAG085" class="sect1">
<h2 class="sect1"><span class="secnum">13.5</span> Using Oracle Label Security Policies in a Distributed Environment</h2>
<p>Oracle Label Security supports all standard <span class="italic">Oracle Database</span> distributed configurations. Whether or not you can access protected data depends on the policies installed in each distributed database.</p>
<p>Be sure to take into account the relationships between databases in a distributed environment:</p>
<ul>
<li>
<p>If the same application runs on two databases and you want them to have the same protection, then syou must apply the same Oracle Label Security policy to both the local and the remote databases.</p>
</li>
<li>
<p>If the local and remote databases have a policy in common, then your local session label and row label will override the default labels for the remote user.</p>
</li>
<li>
<p>If the remote database has a different policy than the local database, then the remote policy can restrict access to the data independent of your local policies. On the other hand, when you make a connection as a remote user who has authorization on the remote policy, you can access any data to which the remote user has access to, regardless of your local authorizations.</p>
</li>
</ul>
<p>If the remote database has no policy applied to it, you can access its data just as you would with a standard distributed database.</p>
<p>Consider a situation in which three databases exist, with different Oracle Label Security policies in force:</p>
<dl>
<dd>Database 1 has Policy A and Policy B</dd>
<dd>Database 2 has Policy A</dd>
<dd>Database 3 had Policy C</dd>
</dl>
<p>Users authorized for Policy A can obtain protected data from Database 1 and Database 2. If the remote user is authorized for Policy C, then this user can obtain data from Database 3 as well.</p>
</div>
<!-- class="sect1" -->
<a id="i1012506"></a>
<div id="OLSAG086" class="sect1">
<h2 class="sect1"><span class="secnum">13.6</span> Using Replication with Oracle Label Security</h2>
<p>This section explains how to use the <a id="sthref792"></a>replication option with tables protected by Oracle Label Security policies. It contains these topics:</p>
<ul>
<li>
<p><a href="#i1012557">Introduction to Replication Under Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1012630">Contents of a Materialized View</a></p>
</li>
<li>
<p><a href="#i1012675">Requirements for Creating Materialized Views Under Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1012761">How to Refresh Materialized Views</a></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>For a complete explanation of replication in <span class="italic">Oracle Database</span> 11<span class="italic">g</span> Release 2 (11.2) and how to set up the replication environment, refer to <a class="olink REPLN" href="../../server.112/e10706/toc.htm"><span class="italic">Oracle Database Advanced Replication</span></a>.</p>
</li>
<li>
<p>For general information about using materialized views, refer to <a class="olink CNCPT" href="../../server.112/e40540/toc.htm"><span class="italic">Oracle Database Concepts</span></a> and<a class="olink DWHSG" href="../../server.112/e25554/toc.htm"><span class="italic">Oracle Database Data Warehousing Guide</span></a>.</p>
</li>
</ul>
</div>
</li>
</ul>
<a id="i1012557"></a>
<div id="OLSAG3402" class="sect2">
<h3 class="sect2"><span class="secnum">13.6.1</span> Introduction to Replication Under Oracle Label Security</h3>
<p>This section introduces the use of replication under Oracle Label Security. It contains the following topics:</p>
<ul>
<li>
<p><a href="#i1012574">Replication Functionality Supported by Oracle Label Security</a></p>
</li>
<li>
<p><a href="#i1012601">Row-Level Security Restriction on Replication Under Oracle Label Security</a></p>
</li>
</ul>
<a id="i1012574"></a>
<div id="OLSAG3403" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.1.1</span> Replication Functionality Supported by Oracle Label Security</h4>
<p>Oracle Label Security supports standard replication and Advanced Replication, including multimaster replication and updatable materialized views (snapshots).</p>
<p><span class="italic">Oracle Database</span> uses <a id="sthref793"></a>materialized views for replicating data. A <span class="italic">materialized view</span> is a local copy of a local or remote master table that reflects a recent state of the master table.</p>
<p>As illustrated in <a href="#i1012594">Figure 13-4, "Use of Materialized Views for Replication"</a>, a master table is a table you wish to replicate, on a node that you designate as the master node. Using a dblink account (such as <a id="sthref794"></a>REPADMIN), you can create a <a id="sthref795"></a>materialized view of the table in a different database. (This can also be done in the same database, and on the same system.) You can select rows from the remote master table, and copy them into the local materialized view. Here, <code>mvEMP</code> represents the materialized view of table <code>EMP</code>, and <code>mlog$_EMP</code> represents the materialized view log.</p>
<div id="OLSAG3404" class="figure">
<p class="titleinfigure"><a id="i1012594"></a>Figure 13-4 Use of Materialized Views for Replication</p>
<img width="496" height="112" src="img/olsag018.gif" alt="Description of Figure 13-4 follows" /><br />
<a id="sthref796" href="img_text/olsag018.htm">Description of "Figure 13-4 Use of Materialized Views for Replication"</a><br />
<br /></div>
<!-- class="figure" -->
<p>In a distributed environment, a materialized view alleviates query traffic over the network and increases data availability when a node is not available.</p>
</div>
<!-- class="sect3" -->
<a id="i1012601"></a>
<div id="OLSAG3405" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.1.2</span> Row-Level Security Restriction on Replication Under Oracle Label Security</h4>
<p>An Oracle Label Security policy applies Row Level Security (RLS) to a table if READ_CONTROL is specified as one of the policy options. Problems occur if <span class="italic">both</span> of the following conditions are true:</p>
<ul>
<li>
<p>The Oracle Label Security policy is applied to any table relevant to <a id="sthref797"></a>replication (such as the master table, materialized view, or materialized view log), and</p>
</li>
<li>
<p>The policy returns a predicate in the WHERE clause of SELECT statements.</p>
</li>
</ul>
<p>To avoid the additional predicate (and therefore avoid this problem), the users involved in a replication environment should be given the necessary Oracle Label Security privileges. To be specific, the designated users in the database link (such as REPADMIN and the materialized view owner) must have the READ or the FULL privilege. As a result, the queries used to perform the replication will not be modified by RLS.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CNCPT" href="../../server.112/e40540/toc.htm"><span class="italic">Oracle Database Concepts</span></a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1012630"></a>
<div id="OLSAG3406" class="sect2">
<h3 class="sect2"><span class="secnum">13.6.2</span> Contents of a Materialized View</h3>
<p>This section discusses the contents of materialized views.</p>
<ul>
<li>
<p><a href="#i1012645">How Materialized View Contents Are Determined</a></p>
</li>
<li>
<p><a href="#i1012661">Complete Materialized Views</a></p>
</li>
<li>
<p><a href="#i1012668">Partial Materialized Views</a></p>
</li>
</ul>
<a id="i1012645"></a>
<div id="OLSAG3407" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.2.1</span> How Materialized View Contents Are Determined</h4>
<p>Oracle Label Security performs the following steps when creating materialized views. These steps determine the contents of the view.</p>
<ol>
<li>
<p>It reads the definition of the master table in the remote database.</p>
</li>
<li>
<p>It reads the rows in the master table that meet the conditions defined in the materialized view definition.</p>
</li>
<li>
<p>It writes these rows to the materialized view in the local database.</p>
</li>
</ol>
<p>Because Oracle Label Security writes only those rows to which you have write access in the local database, the contents of the materialized view vary according to:</p>
<ul>
<li>
<p>The policy options in effect</p>
</li>
<li>
<p>The privileges you have defined in the local database</p>
</li>
<li>
<p>The session label</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="i1012661"></a>
<div id="OLSAG3408" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.2.2</span> Complete Materialized Views</h4>
<p>If you read all of the rows in the master table and have write access in the local database to each label in the materialized view, then the result is a complete materialized view of the master table. To ensure that the materialized view is complete, ensure that you have read access to all of the data in the master table and write access in the local database to all labels at which data is stored in the master table.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Never revoke privileges that you granted when you created the materialized view. If you do, then you may not be able to perform a replication refresh.</div>
</div>
<!-- class="sect3" -->
<a id="i1012668"></a>
<div id="OLSAG3409" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.2.3</span> Partial Materialized Views</h4>
<p>A partial materialized view is created when you specify a WHERE clause in the materialized view definition. This is a convenient way to pass subsets of data to a remote database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To create a partial materialized view, you must have write access to all the rows being replicated.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1012675"></a>
<div id="OLSAG3410" class="sect2">
<h3 class="sect2"><span class="secnum">13.6.3</span> Requirements for Creating Materialized Views Under Oracle Label Security</h3>
<p>Requirements for creating a materialized view depend on the type of materialized view you are creating.</p>
<ul>
<li>
<p><a href="#i1012697">Requirements for the REPADMIN Account</a></p>
</li>
<li>
<p><a href="#i1012716">Requirements for the Owner of the Materialized View</a></p>
</li>
<li>
<p><a href="#i1012749">Requirements for Creating Partial Multilevel Materialized Views</a></p>
</li>
<li>
<p><a href="#i1012755">Requirements for Creating Complete Multilevel Materialized Views</a></p>
</li>
</ul>
<a id="i1012697"></a>
<div id="OLSAG3411" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.3.1</span> Requirements for the REPADMIN Account</h4>
<p>Requirements for the <a id="sthref798"></a>REPADMIN account vary depending on the configuration. In general, however, it should meet the following requirements:</p>
<ul>
<li>
<p>It must have the FULL Oracle Label Security privilege (mandatory for all configurations).</p>
</li>
<li>
<p>It must have the SELECT privilege on the master table.</p>
</li>
<li>
<p>It must be the account that establishes the database link from the remote node to the database containing the master table.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REPLN" href="../../server.112/e10706/toc.htm"><span class="italic">Oracle Database Advanced Replication</span></a></div>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="i1012716"></a>
<div id="OLSAG3412" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.3.2</span> Requirements for the Owner of the Materialized View</h4>
<p>Remember that the privileges belonging to the owner of the <a id="sthref799"></a><a id="sthref800"></a>materialized view are used during the refresh of the materialized view. If these privileges are not sufficient, then there are two options:</p>
<ul>
<li>
<p>The materialized view can be created in the REPADMIN account, or</p>
</li>
<li>
<p>Additional privileges must be granted to the owner of the materialized view.</p>
</li>
</ul>
<p>Consider, for example, the following materialized view created by user SCOTT:</p>
<pre>
CREATE MATERIALIZED VIEW mvemp as
SELECT *
FROM EMP@link_to_master
WHERE label_to_char(sa_label) = 'HS';
</pre>
<p>Here, SCOTT should have permission to insert records at the HS level in the local database. If Oracle Label Security policies are applied on the materialized view, then SCOTT must have the FULL privilege to avoid the RLS restriction.</p>
<p>Different configurations can be set up depending on whether Oracle Label Security policies are applied on the materialized view, what privileges are granted to the owner of the materialized view, and so on. If Oracle Label Security policies are applied to the materialized view, but SCOTT should not be granted the FULL privilege, then the <a id="sthref801"></a>REPADMIN account must be used to create the materialized view. SCOTT can then be granted the SELECT privilege on that table.</p>
<p>If no policies are applied to the materialized view, then the view can be created in SCOTT's schema without any additional privileges. In this case, the materialized view should be created in such a way that a WHERE condition limits the records to those which SCOTT can read.</p>
<p>Finally, if SCOTT can be granted the FULL privilege, then the materialized view can be created in SCOTT's schema, and Oracle Label Security policies can also be applied on the materialized view.</p>
<p>Note that the master table can have Oracle Label Security policies containing any set of policy options. If SCOTT has the FULL or the READ privilege, he can select all rows, regardless of policy options.</p>
</div>
<!-- class="sect3" -->
<a id="i1012749"></a>
<div id="OLSAG3413" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.3.3</span> Requirements for Creating Partial Multilevel Materialized Views</h4>
<p>To create a partial materialized view that includes only some of the rows in a remote master table protected by Oracle Label Security, you must have sufficient privileges to WRITE in the local database at every label retrieved by your query.</p>
</div>
<!-- class="sect3" -->
<a id="i1012755"></a>
<div id="OLSAG3414" class="sect3">
<h4 class="sect3"><span class="secnum">13.6.3.4</span> Requirements for Creating Complete Multilevel Materialized Views</h4>
<p>To create a complete materialized view that includes every row in a remote master table protected by Oracle Label Security, you must be able to WRITE in the local database at the labels of all of the rows retrieved by the defined materialized view query.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1012761"></a>
<div id="OLSAG3415" class="sect2">
<h3 class="sect2"><span class="secnum">13.6.4</span> How to Refresh Materialized Views</h3>
<p>If the contents or definition of a master table changes, then refresh the <a id="sthref802"></a>materialized view so that it accurately reflects the contents of the master table. To refresh a materialized view of a remote multilevel table, you must also have privileges to write in the local database at the labels of all of the rows that the materialized view query retrieves</p>
<div class="infoboxnotewarn">
<p class="notep1">Warning:</p>
<p class="warnsp">A materialized view can potentially contain outdated rows if you refresh a partial or full materialized view but do not have READ access to all the rows in the master table, and consequently do not overwrite the rows in the original materialized view with the updated rows from the master table.</p>
</div>
<p>To ensure an accurate materialized view refresh, use the optional materialized view background processes, SNP<span class="italic">n</span>, to refresh the views automatically. These processes must have sufficient privileges both to read all of the rows in the master table and to write those rows to the materialized view, ensuring that the view is completely refreshed. Remember that the privileges used by these processes are those of the materialized view owner.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For information about SNP<span class="italic">n</span> background processes, refer to <a class="olink ADMIN" href="../../server.112/e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2259">
<tr>
<td class="cellalignment2268">
<table class="cellalignment2264">
<tr>
<td class="cellalignment2263"><a href="audit.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2263"><a href="utilities.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2000, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2271">
<table class="cellalignment2262">
<tr>
<td class="cellalignment2263"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2263"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2263"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2263"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2263"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2263"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
