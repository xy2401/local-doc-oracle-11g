<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Configuring Kerberos Authentication</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1079" />
<meta name="dcterms.created" content="2016-03-03T15:46:22Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Advanced Security Administrator's Guide" />
<meta name="dcterms.identifier" content="E40393-10" />
<meta name="dcterms.isVersionOf" content="ASOAG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="asogls.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="asoradus.htm" title="Previous" type="text/html" />
<link rel="Next" href="asossl.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40393.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">23/35</span> <!-- End Header -->
<div id="ASOAG060" class="chapter"><a id="g1012894"></a> <a id="i1007664"></a>
<h1 class="chapter"><span class="secnum">12</span> Configuring Kerberos Authentication</h1>
<p>This chapter describes how to configure Oracle Advanced Security for Oracle Database for use with Kerberos authentication, and how to configure Kerberos to authenticate Oracle database users. This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#BAJBFIFC">Enabling Kerberos Authentication</a></p>
</li>
<li>
<p><a href="#i1006510">Utilities for the Kerberos Authentication Adapter</a></p>
</li>
<li>
<p><a href="#i1006624">Configuring Interoperability with a Windows 2000 Domain Controller KDC</a></p>
</li>
<li>
<p><a href="#CHDGFGFI">Configuring Kerberos Authentication Fallback Behavior</a></p>
</li>
<li>
<p><a href="#BAJEHBGJ">Troubleshooting the Oracle Kerberos Authentication Configuration</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">See Also:</p>
<a class="olink DBIMI200" href="../../network.112/e10744/appa.htm#DBIMI200"><span class="italic">Oracle Database Enterprise User Security Administrator's Guide</span></a> for information on migrating Kerberos users to Kerberos-authenticated enterprise users</div>
<a id="BAJBFIFC"></a>
<div id="ASOAG9635" class="sect1">
<h2 class="sect1"><span class="secnum">12.1</span> Enabling Kerberos Authentication</h2>
<p>This section contains:<a id="sthref484"></a></p>
<ul>
<li>
<p><a href="#i1006156">Step 1: Install Kerberos</a></p>
</li>
<li>
<p><a href="#i1006164">Step 2: Configure a Service Principal for an Oracle Database Server</a></p>
</li>
<li>
<p><a href="#i1006220">Step 3: Extract a Service Key Table from Kerberos</a></p>
</li>
<li>
<p><a href="#i1006245">Step 4: Install an Oracle Database Server and an Oracle Client</a></p>
</li>
<li>
<p><a href="#i1006256">Step 5: Install Oracle Net Services and Oracle Advanced Security</a></p>
</li>
<li>
<p><a href="#i1006273">Step 6: Configure Oracle Net Services and Oracle Database</a></p>
</li>
<li>
<p><a href="#i1006294">Step 7: Configure Kerberos Authentication</a></p>
</li>
<li>
<p><a href="#i1006475">Step 8: Create a Kerberos User</a></p>
</li>
<li>
<p><a href="#i1006490">Step 9: Create an Externally Authenticated Oracle User</a></p>
</li>
<li>
<p><a href="#i1006496">Step 10: Get an Initial Ticket for the Kerberos/Oracle User</a></p>
</li>
</ul>
<a id="i1006156"></a>
<div id="ASOAG9636" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.1</span> Step 1: Install Kerberos</h3>
<p>Install Kerberos on the system that functions as the authentication server.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
Your Kerberos version 5 source distribution for notes about building and installing Kerberos</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
After upgrading from a 32-bit version of Oracle Database, the first use of the Kerberos authentication adapter causes an error message: <code dir="ltr">ORA-01637: Packet receive failed</code>.
<p>Workaround: After upgrading to the 64-bit version of the database and before using Kerberos external authentication method, check for a file named <code dir="ltr">/usr/tmp/oracle_service_name.RC</code> on your computer, and remove it.</p>
</div>
</div>
<!-- class="sect2" -->
<a id="i1006164"></a>
<div id="ASOAG9637" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.2</span> Step 2: Configure a Service Principal for an Oracle Database Server</h3>
<p>To enable the Oracle database server to validate the identity of clients that authenticate themselves using <a id="sthref485"></a>Kerberos, you must create a <a href="asogls.htm#i997354"><span class="xrefglossterm">service principal</span></a> for Oracle Database.</p>
<p>The name of the principal should have the following format:</p>
<pre dir="ltr">
kservice/kinstance@REALM
</pre>
<p>Each of the fields in the service principal specify the following values:</p>
<div class="inftblinformal">
<table class="cellalignment2234" title="Kerberos Service Principal Fields" summary="This table lists and describes each field in the Kerberos service principal." dir="ltr">
<thead>
<tr class="cellalignment2228">
<th class="cellalignment2235" id="r1c1-t5">Service Principal Field</th>
<th class="cellalignment2235" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r2c1-t5" headers="r1c1-t5"><a id="sthref486"></a><a id="sthref487"></a><code dir="ltr">kservice</code></td>
<td class="cellalignment2236" headers="r2c1-t5 r1c2-t5">A case-sensitive string that represents the Oracle service. This can be the same as the database service name.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r3c1-t5" headers="r1c1-t5"><a id="sthref488"></a><a id="sthref489"></a><code dir="ltr">kinstance</code></td>
<td class="cellalignment2236" headers="r3c1-t5 r1c2-t5">Typically the fully qualified DNS name of the system on which Oracle Database is running.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r4c1-t5" headers="r1c1-t5"><a id="sthref490"></a><a id="sthref491"></a><code dir="ltr">REALM</code></td>
<td class="cellalignment2236" headers="r4c1-t5 r1c2-t5">The name of the Kerberos realm with which the service principal is registered. <code dir="ltr">REALM</code> must always be uppercase and is typically the DNS domain name.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
The utility names in this section are executable programs. However, the Kerberos user name <code dir="ltr">krbuser</code> and the realm <code dir="ltr">EXAMPLE.COM</code> are examples only.</div>
<p>For example, suppose <code dir="ltr">kservice</code> is <code dir="ltr">oracle</code>, the fully qualified name of the system on which Oracle Database is running is <code dir="ltr">dbserver.example.com</code> and the realm is <code dir="ltr">EXAMPLE.COM</code>. The principal name then is:</p>
<pre dir="ltr">
oracle/dbserver.example.com@EXAMPLE.COM
</pre>
<p>It is a convention to use the DNS domain name as the name of the realm. To create the <a href="asogls.htm#i997354"><span class="xrefglossterm">service principal</span></a>, run <code dir="ltr">kadmin.local</code>. On UNIX, run this command as the root user, by using the following syntax:</p>
<pre dir="ltr">
# cd /kerberos-install-directory/sbin
# ./kadmin.local
</pre>
<p>To add a <a href="asogls.htm#i997254"><span class="xrefglossterm">principal</span></a> named <code dir="ltr">oracle/dbserver.example.com@EXAMPLE.COM</code> to the list of server principals known by Kerberos, enter the following:</p>
<pre dir="ltr">
kadmin.local:addprinc -randkey oracle/dbserver.example.com@EXAMPLE.COM
</pre></div>
<!-- class="sect2" -->
<a id="i1006220"></a>
<div id="ASOAG9638" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.3</span> Step 3: Extract a Service Key Table from Kerberos</h3>
<p>Extract the <a href="asogls.htm#i997360"><span class="xrefglossterm">service key table</span></a> from Kerberos and copy it to the Oracle database server/Kerberos client system.</p>
<p>For example, use the following steps to extract a service key table for <code dir="ltr">dbserver.example.com</code>:</p>
<ol>
<li>
<p>Enter the following to extract the service key table:</p>
<pre dir="ltr">
kadmin.local:  ktadd -k /tmp/keytab oracle/dbserver.example.com

Entry for principal oracle/dbserver.example.com with kvno 2, encryption DES-CBC-CRC added to the keytab WRFILE: 'WRFILE:/tmp/keytab

kadmin.local:  exit

oklist -k -t /tmp/keytab
</pre></li>
<li>
<p>After the service key table has been extracted, verify that the new entries are in the table in addition to the old ones. If they are not, or you need to add more, use <code dir="ltr">kadmin.local</code> to append to them.</p>
<p>If you do not enter a realm when using <code dir="ltr">ktadd</code>, it uses the default realm of the Kerberos server. <code dir="ltr">kadmin.local</code> is connected to the Kerberos server running on the <code dir="ltr">localhost</code>.</p>
</li>
<li>
<p>If the Kerberos service key table is on the same system as the Kerberos client, you can move it. If the service key table is on a different system from the Kerberos client, you must transfer the file with a program such as FTP. If using FTP, transfer the file in binary mode.</p>
<p>The following example shows how to move the service key table on a UNIX platform:</p>
<pre dir="ltr">
# mv /tmp/keytab /etc/v5srvtab
</pre>
<p>The default name of the service file is <code dir="ltr">/etc/v5srvtab</code>.</p>
</li>
<li>
<p>Verify that the owner of the Oracle database server executable can read the service key table (<code dir="ltr">/etc/v5srvtab</code> in the previous example). To do so, set the file owner to the Oracle user, or make the file readable by the group to which Oracle belongs.</p>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
<p class="warnsp">Do not make the file readable to all users. This can cause a security breach.</p>
</div>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1006245"></a>
<div id="ASOAG9639" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.4</span> Step 4: Install an Oracle Database Server and an Oracle Client</h3>
<p>Install the Oracle database server and client software.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Oracle Database operating system-specific installation documentation</div>
</div>
<!-- class="sect2" -->
<a id="i1006256"></a>
<div id="ASOAG9640" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.5</span> Step 5: Install Oracle Net Services and Oracle Advanced Security</h3>
<p>Install Oracle Net Services and Oracle Advanced Security on the Oracle database server and Oracle client systems.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Oracle Database operating system-specific installation documentation</div>
</div>
<!-- class="sect2" -->
<a id="i1006273"></a>
<div id="ASOAG9641" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.6</span> Step 6: Configure Oracle Net Services and Oracle Database</h3>
<p>Configure Oracle Net Services on the Oracle database server and client.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>Oracle Database operating system-specific installation documentation</p>
</li>
<li>
<p><a class="olink NETAG" href="../e41945/toc.htm"><span class="italic">Oracle Database Net Services Administrator's Guide</span></a>.</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1006294"></a>
<div id="ASOAG9642" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.7</span> Step 7: Configure Kerberos Authentication</h3>
<p>Perform these tasks to set required parameters in the Oracle database server and client <code dir="ltr">sqlnet.ora</code> files.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#i1006309">Step 7A: Configure Kerberos on the Client and on the Database Server</a></p>
</li>
<li>
<p><a href="#i1006378">Step 7B: Set the Initialization Parameters</a></p>
</li>
<li>
<p><a href="#i1006391">Step 7C: Set sqlnet.ora Parameters (Optional)</a></p>
</li>
</ul>
<a id="i1006309"></a>
<div id="ASOAG9643" class="sect3">
<h4 class="sect3"><span class="secnum">12.1.7.1</span> Step 7A: Configure Kerberos on the Client and on the Database Server</h4>
<p>To <a id="sthref492"></a><a id="sthref493"></a>configure Kerberos authentication service parameters on the client and on the database server:</p>
<ol>
<li>
<p>Start Oracle Net Manager.</p>
<ul>
<li>
<p>(UNIX) From <code dir="ltr"><span class="codeinlineitalic">$ORACLE_HOME</span></code><code dir="ltr">/bin</code>, enter the following command at the command line:</p>
<pre dir="ltr">
netmgr
</pre></li>
<li>
<p>(Windows) Select <span class="bold">Start</span>, <span class="bold">Programs</span>, <span class="bold">Oracle - HOME_NAME</span>, <span class="bold">Configuration and Migration Tools</span>, then <span class="bold">Net Manager</span>.</p>
</li>
</ul>
</li>
<li>
<p>Expand <span class="bold">Oracle Net Configuration</span>, and from <span class="bold">Local</span>, select <span class="bold">Profile</span>.</p>
</li>
<li>
<p>From the <span class="bold">Naming</span> list, select <span class="bold">Network Security</span>.</p>
<p>The Network Security tabbed window appears.</p>
</li>
<li>
<p>Select the <span class="bold">Authentication</span> tab.</p>
<img width="347" height="390" src="img/kerb0001.gif" alt="Description of kerb0001.gif follows" /><br />
<a id="sthref494" href="img_text/kerb0001.htm">Description of the illustration ''kerb0001.gif''</a><br />
<br /></li>
<li>
<p>From the Available Methods list, select <span class="bold">KERBEROS5</span>.</p>
</li>
<li>
<p>Move KERBEROS5 to the Selected Methods list by clicking the right arrow (<span class="bold">&gt;</span>).</p>
</li>
<li>
<p>Arrange the selected methods in order of use. To do this, select a method in the Selected Methods list, then click <span class="bold">Promote</span> or <span class="bold">Demote</span> to position it in the list. For example, if you want <code dir="ltr">KERBEROS5</code> to be the first service used, move it to the top of the list.</p>
</li>
<li>
<p>Select the <span class="bold">Other Params</span> tab.</p>
</li>
<li>
<p>From the Authentication Service list, select <span class="bold">KERBEROS(V5)</span>.</p>
<img width="349" height="393" src="img/kerb0002.gif" alt="Description of kerb0002.gif follows" /><br />
<a id="sthref495" href="img_text/kerb0002.htm">Description of the illustration ''kerb0002.gif''</a><br />
<br />
<p>The <span class="bold">Service</span> field defines the name of the service Oracle Database uses to obtain a Kerberos <a href="asogls.htm#i997363"><span class="xrefglossterm">service ticket</span></a>. When you provide the value for this field, the other fields are enabled.</p>
</li>
<li>
<p>Optionally enter values for the following fields:</p>
<ul>
<li>
<p><span class="bold">Credential Cache File</span></p>
</li>
<li>
<p><span class="bold">Configuration File</span></p>
</li>
<li>
<p><span class="bold">Realm Translation File</span></p>
</li>
<li>
<p><span class="bold">Key Table</span></p>
</li>
<li>
<p><span class="bold">Clock Skew</span></p>
</li>
</ul>
<p>See the Oracle Net Manager online Help, and <a href="#i1006391">"Step 7C: Set sqlnet.ora Parameters (Optional)"</a>, for more information about the fields and the parameters they configure.</p>
</li>
<li>
<p>From the <span class="bold">File</span> menu, select <span class="bold">Save Network Configuration</span>.</p>
<p>The <code dir="ltr">sqlnet.ora</code> file is updated with the following entries:</p>
<pre dir="ltr">
<a id="sthref496"></a><a id="sthref497"></a>SQLNET.AUTHENTICATION_SERVICES=(KERBEROS5)
<a id="sthref498"></a><a id="sthref499"></a>SQLNET.AUTHENTICATION_KERBEROS5_SERVICE=kservice
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<a id="i1006378"></a>
<div id="ASOAG9644" class="sect3">
<h4 class="sect3"><span class="secnum">12.1.7.2</span> Step 7B: Set the Initialization Parameters</h4>
<p>As Kerberos user names can be long, and Oracle user names are limited to 30 characters, Oracle recommends that you set the value of <code dir="ltr">OS_AUTHENT_PREFIX</code> to null in the initialization parameter file.</p>
<pre dir="ltr">
OS_AUTHENT_PREFIX=""
</pre>
<p>Setting this parameter to null overrides the default value of <code dir="ltr">OPS$</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database 11<span class="italic">g</span> Release 2 (11.2) enables you to create external database users that have Kerberos user names of more than 30 characters. See <a href="#i1006490">"Step 9: Create an Externally Authenticated Oracle User"</a> for more information.</div>
</div>
<!-- class="sect3" -->
<a id="i1006391"></a>
<div id="ASOAG9645" class="sect3">
<h4 class="sect3"><span class="secnum">12.1.7.3</span> Step 7C: Set sqlnet.ora Parameters (Optional)</h4>
<p>In addition to the required parameters, you can optionally set the following parameters in the <code dir="ltr">sqlnet.ora</code> file on the client and the Oracle database server:</p>
<div class="inftblinformal">
<table class="cellalignment2234" title="Optional SQLNET.ORA Parameters for Configuring Kerberos" summary="This table lists and describes additional optional sqlnet.ora parameters that you can use to configure Kerberos authentication." dir="ltr">
<thead>
<tr class="cellalignment2228">
<th class="cellalignment2235" id="r1c1-t12">Attribute</th>
<th class="cellalignment2235" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r2c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r2c1-t12 r1c2-t12"><a id="sthref500"></a><a id="sthref501"></a><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=</code><code dir="ltr"><span class="codeinlineitalic">pathname_to_credentials_cache_file</span></code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r3c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r3c1-t12 r1c2-t12">Specifies the complete path name to the Kerberos credentials cache (CC) file. The default value is operating system-dependent. For UNIX, it is <code dir="ltr">/tmp/krb5cc_</code><code dir="ltr"><span class="codeinlineitalic">userid</span></code>.
<p>You can use the following formats to specify a value for <code dir="ltr">SQLNET.KERBEROS5_CC_NAME</code>:</p>
<ul>
<li>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=</code><code dir="ltr"><span class="codeinlineitalic">complete_path_to_cc_file</span></code></p>
<p>For example:</p>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=/tmp/kcache</code></p>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=D:\tmp\kcache</code></p>
</li>
<li>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=FILE:</code><code dir="ltr"><span class="codeinlineitalic">complete_path_to_cc_file</span></code></p>
<p>For example:</p>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=FILE:/tmp/kcache</code></p>
</li>
<li>
<p><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=OSMSFT:</code></p>
<p>Use this value if you are running Windows and using a Microsoft KDC.</p>
</li>
</ul>
<p>You can also set this parameter by using the <code dir="ltr">KRB5CCNAME</code> environment variable, but the value set in the <code dir="ltr">sqlnet.ora</code> file takes precedence over the value set in <code dir="ltr">KRB5CCNAME</code>.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r4c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r4c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_CC_NAME=/usr/tmp/krbcache</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r5c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r5c1-t12 r1c2-t12"><a id="sthref502"></a><a id="sthref503"></a><code dir="ltr">SQLNET.KERBEROS5_CLOCKSKEW=</code><code dir="ltr"><span class="codeinlineitalic">number_of_seconds_accepted_as_network_delay</span></code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r6c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r6c1-t12 r1c2-t12">This parameter specifies how many seconds can pass before a Kerberos credential is considered out-of-date. It is used when a credential is actually received by either a client or a database server. An Oracle database server also uses it to decide if a credential needs to be stored to protect against a replay attack. The default is 300 seconds.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r7c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r7c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_CLOCKSKEW=1200</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r8c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r8c1-t12 r1c2-t12"><a id="sthref504"></a><a id="sthref505"></a><code dir="ltr">SQLNET.KERBEROS5_CONF=</code><code dir="ltr"><span class="codeinlineitalic">pathname_to_Kerberos_<br />
configuration_file</span></code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r9c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r9c1-t12 r1c2-t12">This parameter specifies the complete path name to the <code dir="ltr">Kerberos</code> configuration file. The configuration file contains the realm for the default KDC (key distribution center) and maps realms to KDC hosts. The default is operating system-dependent. For UNIX, it is <code dir="ltr">/krb5/krb.conf</code>.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r10c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r10c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_CONF=/krb/krb.conf</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r11c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r11c1-t12 r1c2-t12"><code dir="ltr"><a id="sthref506"></a><a id="sthref507"></a>SQLNET.KERBEROS5_CONF_MIT=[TRUE|FALSE]</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r12c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r12c1-t12 r1c2-t12">This parameter specifies whether the new MIT Kerberos configuration format is used. If the value is set to <code dir="ltr">TRUE</code>, it will parse the file according to the new configuration format rules. When the value is set to <code dir="ltr">FALSE</code>, the default (non-MIT) configuration is used. The default is <code dir="ltr">FALSE</code>.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r13c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r13c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_CONF_MIT=False</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r14c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r14c1-t12 r1c2-t12"><code dir="ltr"><a id="sthref508"></a><a id="sthref509"></a>SQLNET.KERBEROS5_KEYTAB=<br /></code><code dir="ltr"><span class="codeinlineitalic">pathname_to_Kerberos_principal/key_table</span></code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r15c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r15c1-t12 r1c2-t12">This parameter specifies the complete path name to the Kerberos principal/secret key mapping file. It is used by the Oracle database server to extract its key and decrypt the incoming authentication information from the client. The default is operating system-dependent. For UNIX, it is <code dir="ltr">/etc/v5srvtab</code>.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r16c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r16c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_KEYTAB=/etc/v5srvtab</code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r17c1-t12" headers="r1c1-t12"><span class="bold">Parameter:</span></td>
<td class="cellalignment2236" headers="r17c1-t12 r1c2-t12"><a id="sthref510"></a><a id="sthref511"></a><code dir="ltr">SQLNET.KERBEROS5_REALMS=<br /></code><code dir="ltr"><span class="codeinlineitalic">pathname_to_Kerberos_realm_translation_file</span></code></td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r18c1-t12" headers="r1c1-t12"><span class="bold">Description:</span></td>
<td class="cellalignment2236" headers="r18c1-t12 r1c2-t12">This parameter specifies the complete path name to the Kerberos realm translation file. The translation file provides a mapping from a host name or domain name to a realm. The default is operating system-dependent. For UNIX, it is <code dir="ltr">/etc/krb.realms</code>.</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r19c1-t12" headers="r1c1-t12"><span class="bold">Example:</span></td>
<td class="cellalignment2236" headers="r19c1-t12 r1c2-t12"><code dir="ltr">SQLNET.KERBEROS5_REALMS=/krb5/krb.realms</code></td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="ASOAG10204"></a>Support for Credential Cache Type 4 Format</p>
<p>Oracle Database now supports and recognizes the credential cache type 4 format. This feature is useful for those environments that use newer versions of MIT Kerberos 5 (1.3.x and above) utilities.</p>
<p>To use this feature, you need to set the following parameter in the <code dir="ltr">sqlnet.ora</code> file:</p>
<pre dir="ltr">
SQLNET.KERBEROS5_CONF_MIT = TRUE
</pre>
<p>Your Kerberos configuration file (<code dir="ltr">krb5.conf</code>) should have the following settings:</p>
<pre dir="ltr">
...
[libdefaults]
...
kdc_timesync = 1
ccache_type = 4
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006475"></a>
<div id="ASOAG9646" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.8</span> Step 8: Create a Kerberos User</h3>
<p>To create Oracle users that Kerberos can authenticate, perform this task on the Kerberos authentication server where the administration tools are installed. The realm must already exist.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The utility names in this section are executable programs. However, the Kerberos user name <code dir="ltr">krbuser</code> and realm <code dir="ltr">EXAMPLE.COM</code> are examples only. They can vary among systems.</div>
<p>Run <code dir="ltr">/krb5/admin/kadmin.local</code> as root to create a new Kerberos user, such as <code dir="ltr">krbuser</code>.</p>
<p>The following example is UNIX-specific:</p>
<pre dir="ltr">
# ./kadmin.local
kadmin.local: addprinc krbuser
Enter password for principal: "krbuser@EXAMPLE.COM": (password does not display)
Re-enter password for principal: "krbuser@EXAMPLE.COM": (password does not display)
kadmin.local: exit
</pre></div>
<!-- class="sect2" -->
<a id="i1006490"></a>
<div id="ASOAG9647" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.9</span> Step 9: Create an Externally Authenticated Oracle User</h3>
<p>Run SQL*Plus on the Oracle database server to create the Oracle user that corresponds to the Kerberos user. In the following example, <code dir="ltr">OS_AUTHENT_PREFIX</code> is set to null (<code dir="ltr">""</code>). The Oracle user name is in uppercase enclosed in double quotation marks as shown in the following example:</p>
<pre dir="ltr">
SQL&gt; CONNECT / AS SYSDBA;
SQL&gt; CREATE USER "KRBUSER@EXAMPLE.COM" IDENTIFIED EXTERNALLY; 
SQL&gt; GRANT CREATE SESSION TO "KRBUSER@EXAMPLE.COM"; 
</pre>
<p>If the user's Kerberos principal name is longer than 30 characters, and up to 1024 characters, then create the user as follows:</p>
<pre dir="ltr">
SQL&gt; CREATE USER <span class="italic">db_user_name</span> IDENTIFIED EXTERNALLY AS '<span class="italic">kerberos_principal_name</span>'
</pre>
<p>For example:</p>
<pre dir="ltr">
SQL&gt; CREATE USER KRBUSER IDENTIFIED EXTERNALLY AS 'KerberosUser@EXAMPLE.COM';
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The database administrator should ensure that two database users are not identified externally by the same Kerberos principal name.</div>
</div>
<!-- class="sect2" -->
<a id="i1006496"></a>
<div id="ASOAG061" class="sect2">
<h3 class="sect2"><span class="secnum">12.1.10</span> Step 10: Get an Initial Ticket for the Kerberos/Oracle User</h3>
<p>Before you can connect to the database, you must ask the Key Distribution Center (KDC) for an <a href="asogls.htm#i997055"><span class="xrefglossterm">initial ticket</span></a>. To do so, run the following on the client:</p>
<pre dir="ltr">
% okinit username
</pre>
<p>If, when making a database connection, a reference such as the following follows a database link, you must use the forwardable flag (<code dir="ltr">-f</code>) option:</p>
<pre dir="ltr">
sqlplus /@oracle
</pre>
<p>Executing <code dir="ltr">okinit -f</code> enables credentials that can be used across database links. Run the following commands on the Oracle client:</p>
<pre dir="ltr">
% okinit -f
Password for krbuser@EXAMPLE.COM:password
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006510"></a>
<div id="ASOAG9648" class="sect1">
<h2 class="sect1"><span class="secnum">12.2</span> Utilities for the Kerberos Authentication Adapter</h2>
<p>Three utilities are shipped with the Oracle <a id="sthref512"></a><a id="sthref513"></a><a id="sthref514"></a><a id="sthref515"></a>Kerberos authentication adapter. These utilities are intended for use on an Oracle client with Oracle Kerberos authentication support installed. Use the following utilities for these specified tasks:</p>
<ul>
<li>
<p><a href="#i1006531">Obtaining the Initial Ticket with the okinit Utility</a></p>
</li>
<li>
<p><a href="#BAJEJAFA">Displaying Credentials with the oklist Utility</a></p>
</li>
<li>
<p><a href="#i1006596">Removing Credentials from the Cache File with the okdstry Utility</a></p>
</li>
</ul>
<a id="i1006531"></a>
<div id="ASOAG062" class="sect2">
<h3 class="sect2"><span class="secnum">12.2.1</span> Obtaining the Initial Ticket with the okinit Utility</h3>
<p>The <code dir="ltr">okinit</code> utility obtains and caches Kerberos tickets. This utility is typically used to obtain the ticket-granting ticket, using a password entered by the user to decrypt the credential from the key distribution center (KDC). The ticket-granting ticket is then stored in the user's credential cache.</p>
<p>The options available with <code dir="ltr">okinit</code> are listed in <a href="#BAJEJJFF">Table 12-1</a>:</p>
<div id="ASOAG10205" class="tblruleformal">
<p class="titleintable"><a id="sthref516"></a><a id="BAJEJJFF"></a>Table 12-1 Options for the okinit Utility</p>
<table class="cellalignment2234" title="Options for the okinit Utility" summary="This table lists and describes the options you can use with the okinit command-line utility." dir="ltr">
<thead>
<tr class="cellalignment2228">
<th class="cellalignment2235" id="r1c1-t15">Option</th>
<th class="cellalignment2235" id="r1c2-t15">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r2c1-t15" headers="r1c1-t15">
<p><code dir="ltr">-f</code></p>
</td>
<td class="cellalignment2236" headers="r2c1-t15 r1c2-t15">
<p>Ask for a forwardable ticket-granting ticket. This option is necessary to follow database links.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r3c1-t15" headers="r1c1-t15">
<p><code dir="ltr">-l</code></p>
</td>
<td class="cellalignment2236" headers="r3c1-t15 r1c2-t15">
<p>Specify the lifetime of the ticket-granting ticket and all subsequent tickets. By default, the ticket-granting ticket is good for eight (8) hours, but shorter or longer-lived credentials may be desired. Note that the KDC can ignore this option or put site-configured limits on what can be specified. The lifetime value is a string that consists of a number qualified by <code dir="ltr">w</code> (weeks), <code dir="ltr">d</code> (days), <code dir="ltr">h</code> (hours), <code dir="ltr">m</code> (minutes), or <code dir="ltr">s</code> (seconds), as in the following example:</p>
<pre dir="ltr">
okinit -l 2wld6h20m30s
</pre>
<p>The example requests a ticket-granting ticket that has a life time of 2 weeks, 1 day, 6 hours, 20 minutes, and 30 seconds.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r4c1-t15" headers="r1c1-t15">
<p><code dir="ltr">-c</code></p>
</td>
<td class="cellalignment2236" headers="r4c1-t15 r1c2-t15">
<p>Specify an alternative credential cache. For UNIX, the default is <code dir="ltr">/tmp/krb5cc_</code><span class="italic">uid</span>. You can also specify the alternate credential cache by using the <code dir="ltr">SQLNET.KERBEROS5_CC_NAME</code> parameter in the <code dir="ltr">sqlnet.ora</code> file.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r5c1-t15" headers="r1c1-t15">
<p><code dir="ltr">-e</code></p>
</td>
<td class="cellalignment2236" headers="r5c1-t15 r1c2-t15">
<p>Specifies a number representing the Kerberos encryption type to use.</p>
<p>This option can be used to request a particular Kerberos encryption type key for the session. If you specify more than one encryption type, then the KDC chooses the common and strongest encryption type from the list.</p>
<p>The following values are allowed:</p>
<ul>
<li>
<p>16 for <code dir="ltr">DES3-CBC-SHA1</code></p>
</li>
<li>
<p>18 for <code dir="ltr">AES256-CTS</code></p>
</li>
</ul>
<p>The following example requests for the <code dir="ltr">DES-CBC-CRC</code> and <code dir="ltr">DES3-CBC-SHA1</code> encryption types:</p>
<pre dir="ltr">
okinit -e 1 -e 16 krbuser@REALM
</pre>
<p>Note that you can repeat the option to request multiple encryption types.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r6c1-t15" headers="r1c1-t15">
<p><code dir="ltr">-?</code></p>
</td>
<td class="cellalignment2236" headers="r6c1-t15 r1c2-t15">
<p>List command line options.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" --></div>
<!-- class="sect2" -->
<a id="BAJEJAFA"></a>
<div id="ASOAG9649" class="sect2">
<h3 class="sect2"><span class="secnum">12.2.2</span> Displaying Credentials with the oklist Utility</h3>
<p>Run the <code dir="ltr">oklist</code> utility to display the list of tickets held. Available <code dir="ltr">oklist</code> options are listed in <a href="#BAJHIIDB">Table 12-2</a>:</p>
<div id="ASOAG10206" class="tblruleformal">
<p class="titleintable"><a id="sthref517"></a><a id="BAJHIIDB"></a>Table 12-2 Options for the oklist Utility</p>
<table class="cellalignment2234" title="Options for the oklist Utility" summary="This table lists and describes the options that you can use with the oklist command-line utility." dir="ltr">
<thead>
<tr class="cellalignment2228">
<th class="cellalignment2235" id="r1c1-t16">Option</th>
<th class="cellalignment2235" id="r1c2-t16">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r2c1-t16" headers="r1c1-t16">
<p><code dir="ltr">-f</code></p>
</td>
<td class="cellalignment2236" headers="r2c1-t16 r1c2-t16">
<p>Show flags with credentials. Relevant flags are:</p>
<ul>
<li>
<p><code dir="ltr">I</code>, credential is a ticket-granting ticket</p>
</li>
<li>
<p><code dir="ltr">F</code>, credential is forwardable</p>
</li>
<li>
<p><code dir="ltr">f</code>, credential is forwarded.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r3c1-t16" headers="r1c1-t16">
<p><code dir="ltr">-c</code></p>
</td>
<td class="cellalignment2236" headers="r3c1-t16 r1c2-t16">
<p>Specify an alternative credential cache. In UNIX, the default is <code dir="ltr">/tmp/krb5cc_</code><code dir="ltr"><span class="codeinlineitalic">uid</span></code>. The alternate credential cache can also be specified by using the <code dir="ltr">SQLNET.KERBEROS5_CC_NAME</code> parameter in the <code dir="ltr">sqlnet.ora</code> file.</p>
</td>
</tr>
<tr class="cellalignment2228">
<td class="cellalignment2236" id="r4c1-t16" headers="r1c1-t16">
<p><code dir="ltr">-k</code></p>
</td>
<td class="cellalignment2236" headers="r4c1-t16 r1c2-t16">
<p>List the entries in the service table (default <code dir="ltr">/etc/v5srvtab</code>) on UNIX. The alternate service table can also be specified by using the <code dir="ltr">SQLNET.KERBEROS5_KEYTAB</code>&nbsp;parameter in the <code dir="ltr">sqlnet.ora</code> file.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblruleformal" -->
<p>The show flag option (<code dir="ltr">-f</code>) displays additional information, as shown in the following example:</p>
<pre dir="ltr">
% oklist -f
27-Jul-1999 21:57:51   28-Jul-1999 05:58:14
krbtgt/EXAMPLE.COM@EXAMPLE.COM
Flags: FI
</pre></div>
<!-- class="sect2" -->
<a id="i1006596"></a>
<div id="ASOAG9650" class="sect2">
<h3 class="sect2"><span class="secnum">12.2.3</span> Removing Credentials from the Cache File with the okdstry Utility</h3>
<p>Use the <code dir="ltr">okdstry</code> utility to remove credentials from the credentials cache file:</p>
<pre dir="ltr">
$ okdstry -f
</pre>
<p>where the <code dir="ltr">-f</code> command option lets you specify an alternative credential cache. For UNIX, the default is <code dir="ltr">/tmp/krb5cc_</code><code dir="ltr"><span class="codeinlineitalic">uid</span></code>. You can also specify the alternate credential cache by using the <code dir="ltr">SQLNET.KRB5_CC_NAME</code> parameter in the <code dir="ltr">sqlnet.ora</code> file.</p>
</div>
<!-- class="sect2" -->
<div id="ASOAG9651" class="sect2"><a id="sthref518"></a>
<h3 class="sect2"><span class="secnum">12.2.4</span> Connecting to an Oracle Database Server Authenticated by Kerberos</h3>
<p>You can now connect to an Oracle database server without using a user name or password. Enter a command similar to the following:</p>
<pre dir="ltr">
$ sqlplus /@net_service_name
</pre>
<p>where <code dir="ltr"><span class="codeinlineitalic">net_service_name</span></code> is an Oracle Net Services service name. For example:</p>
<pre dir="ltr">
$ sqlplus /@oracle_dbname
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="asointro.htm#g1011524">Chapter 1, "Introduction to Oracle Advanced Security"</a> and <a class="olink HETER" href="../../server.112/e11050/toc.htm"><span class="italic">Oracle Database Heterogeneous Connectivity User's Guide</span></a> for information about external authentication</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006624"></a>
<div id="ASOAG9652" class="sect1">
<h2 class="sect1"><span class="secnum">12.3</span> Configuring Interoperability with a Windows 2000 Domain Controller KDC</h2>
<p>Oracle Advanced Security, which complies with MIT Kerberos, can interoperate with tickets that are issued by a Kerberos Key Distribution Center (KDC) on a Windows 2000 domain controller to enable Kerberos authentication with an Oracle database. To configure Kerberos authentication that uses a Windows 2000 domain controller KDC, perform the following tasks:</p>
<ul>
<li>
<p><a href="#i1006646">Step 1: Configure Oracle Kerberos Client for a Windows 2000 Domain Controller KDC</a></p>
</li>
<li>
<p><a href="#i1006693">Step 2: Configure a Windows 2000 Domain Controller KDC for the Oracle Client</a></p>
</li>
<li>
<p><a href="#i1006728">Step 3: Configure Oracle Database for a Windows 2000 Domain Controller KDC</a></p>
</li>
<li>
<p><a href="#i1006762">Step 4: Obtain an Initial Ticket for the Kerberos/Oracle User</a></p>
</li>
</ul>
<a id="i1006646"></a>
<div id="ASOAG9653" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.1</span> Step 1: Configure Oracle Kerberos Client for a Windows 2000 Domain Controller KDC</h3>
<p>You must perform the following steps must on the Oracle Kerberos client.</p>
<div id="ASOAG9654" class="sect3"><a id="sthref519"></a>
<h4 class="sect3"><span class="secnum">12.3.1.1</span> Step 1A: Create the Client Kerberos Configuration Files</h4>
<p>Create the following Kerberos client configuration files that refer to the Windows 2000 domain controller as the Kerberos KDC. In the examples that follow, the Windows 2000 domain controller is running on a node named <code dir="ltr">sales3854.us.example.com</code>.</p>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlinebold">krb.conf</span></code> file</p>
<p>For example:</p>
<pre dir="ltr">
SALES3854.US.EXAMPLE.COM
SALES3854.US.EXAMPLE.COM sales3854.us.example.com admin server
</pre></li>
<li>
<p><code dir="ltr"><span class="codeinlinebold">krb5.conf</span></code> file</p>
<p>For example:</p>
<pre dir="ltr">
[libdefaults]
default_realm=SALES.US.EXAMPLE.COM
[realms]
SALES.US.EXAMPLE.COM= {
</pre></li>
</ul>
<pre dir="ltr">
kdc=sales3854.us.example.com:88
}
</pre>
<pre dir="ltr">
[domain_realm]
.us.example.com=SALES.US.EXAMPLE.COM
</pre>
<ul>
<li>
<p><code dir="ltr"><span class="codeinlinebold">krb5.realms</span></code> file</p>
<p>For example:</p>
<pre dir="ltr">
us.example.com SALES.US.EXAMPLE.COM
</pre></li>
</ul>
</div>
<!-- class="sect3" -->
<div id="ASOAG9655" class="sect3"><a id="sthref520"></a>
<h4 class="sect3"><span class="secnum">12.3.1.2</span> Step 2A: Specify the Oracle Configuration Parameters in the sqlnet.ora File</h4>
<p>Configuring an Oracle client to interoperate with a Windows 2000 domain controller KDC uses the same <code dir="ltr">sqlnet.ora</code> file parameters that are listed in <a href="#i1006309">"Step 7A: Configure Kerberos on the Client and on the Database Server"</a>.</p>
<p>Set the following parameters in the <code dir="ltr">sqlnet.ora</code> file on the client:</p>
<pre dir="ltr">
SQLNET.KERBEROS5_CONF=pathname_to_Kerberos_configuration_file
SQLNET.KERBEROS5_CONF_MIT=TRUE
SQLNET.AUTHENTICATION_KERBEROS5_SERVICE=Kerberos_service_name
SQLNET.AUTHENTICATION_SERVICES=(BEQ,KERBEROS5)
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Ensure that the <code dir="ltr">SQLNET.KERBEROS5_CONF_MIT</code> parameter is set to <code dir="ltr">TRUE</code> because the Windows 2000 operating system is designed to interoperate only with security services that are based on MIT Kerberos version 5.</div>
</div>
<!-- class="sect3" -->
<div id="ASOAG9656" class="sect3"><a id="sthref521"></a>
<h4 class="sect3"><span class="secnum">12.3.1.3</span> Step 3A: Specify the Listening Port Number</h4>
<p>The Windows 2000 domain controller KDC listens on UDP/TCP port 88. Ensure that the system file entry for <code dir="ltr">kerberos5</code> is set to UDP/TCP port 88 as follows:</p>
<p>For the UNIX environment, ensure that the first <code dir="ltr">kerberos5</code> entry in the <code dir="ltr">/etc/services</code> file is set to 88.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006693"></a>
<div id="ASOAG9657" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.2</span> Step 2: Configure a Windows 2000 Domain Controller KDC for the Oracle Client</h3>
<p>The following steps must be performed on the Windows 2000 domain controller.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Microsoft documentation for information about how to create users in Active Directory.</div>
<div id="ASOAG9658" class="sect3"><a id="sthref522"></a>
<h4 class="sect3"><span class="secnum">12.3.2.1</span> Step 2A: Create the User</h4>
<p>Create a new user for the Oracle client in Microsoft Active Directory.</p>
</div>
<!-- class="sect3" -->
<div id="ASOAG9659" class="sect3"><a id="sthref523"></a>
<h4 class="sect3"><span class="secnum">12.3.2.2</span> Step 2B: Create the Oracle Database Principal</h4>
<ol>
<li>
<p>Create a new user for the Oracle database in Microsoft Active Directory.</p>
<p>For example, if the Oracle database runs on the host <code dir="ltr">sales3854.us.example.com</code>, then use Active Directory to create a user with the user name <code dir="ltr">sales3854.us.example.com</code> and the password <code dir="ltr">oracle</code>.</p>
<p>Do not create a user as <code dir="ltr">host/hostname.dns.com</code>, such as <code dir="ltr">oracle/sales3854.us.example.com</code>, in Active Directory. Microsoft's KDC does not support multipart names like an MIT KDC does. An MIT KDC allows multipart names to be used for service principals because it treats all principals as user names. However, Microsoft's KDC does not.</p>
</li>
<li>
<p>Use the <code dir="ltr">Ktpass</code> command line utility to extract the keytab file with the following syntax:</p>
<pre dir="ltr">
Ktpass -princ service/hostname@NT-DNS-REALM-NAME -mapuser account -pass password -out keytab.file
</pre>
<p>Using the database user created in the previous step, the following is an example of <code dir="ltr">Ktpass</code> usage:</p>
<pre dir="ltr">
C:&gt; Ktpass -princ oracle/sales3854.us.example.com@SALES.US.COM -mapuser sales3854 -pass oracle -out C:\temp\v5srvtab
</pre>
<p>This utility is part of the Windows 2000 Support Tools and can be found on the Windows 2000 distribution media in the <code dir="ltr">\support\reskit\netmgmt\security</code> folder.</p>
</li>
<li>
<p>Copy the extracted keytab file to the host computer where the Oracle database is installed.</p>
<p>For example, the keytab that was created in the previous step can be copied to <code dir="ltr">/krb5/v5svrtab</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Detailed information about Windows 2000 interoperability with Kerberos 5 that is available at the following URL:
<pre dir="ltr">
<a href="http://technet.microsoft.com/hi-in/windowsserver/2000/bb735396(en-us).aspx">http://technet.microsoft.com/hi-in/windowsserver/2000/bb735396(en-us).aspx</a>
</pre></div>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006728"></a>
<div id="ASOAG9660" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.3</span> Step 3: Configure Oracle Database for a Windows 2000 Domain Controller KDC</h3>
<p>The following steps must be performed on the host computer where the Oracle database is installed.</p>
<div id="ASOAG9661" class="sect3"><a id="sthref524"></a>
<h4 class="sect3"><span class="secnum">12.3.3.1</span> Step 3A: Set Configuration Parameters in the sqlnet.ora File</h4>
<p>Specify values for the following parameters in the <code dir="ltr">sqlnet.ora</code> file for the database server:</p>
<pre dir="ltr">
SQLNET.KERBEROS5_CONF=pathname_to_Kerberos_configuration_file
SQLNET.KERBEROS5_KEYTAB=pathname_to_Kerberos_principal/key_table
SQLNET.KERBEROS5_CONF_MIT=TRUE
SQLNET.AUTHENTICATION_KERBEROS5_SERVICE=Kerberos_service_name
SQLNET.AUTHENTICATION_SERVICES=(BEQ,KERBEROS5)
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Ensure that the <code dir="ltr">SQLNET.KERBEROS5_CONF_MIT</code> parameter is set to <code dir="ltr">TRUE</code> because the Windows 2000 operating system is designed to interoperate only with security services that are based on MIT Kerberos version 5.</div>
</div>
<!-- class="sect3" -->
<div id="ASOAG9662" class="sect3"><a id="sthref525"></a>
<h4 class="sect3"><span class="secnum">12.3.3.2</span> Step 3B: Create an Externally Authenticated Oracle User</h4>
<p>Follow the task information for <a href="#i1006490">"Step 9: Create an Externally Authenticated Oracle User"</a> to create an externally authenticated Oracle user. Ensure that the username is created in all uppercase characters. For example, <code dir="ltr">ORAKRB@SALES.US.EXAMPLE.COM</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1006294">"Step 7: Configure Kerberos Authentication"</a> for information about using Oracle Net Manager to set the <code dir="ltr">sqlnet.ora</code> file parameters.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006762"></a>
<div id="ASOAG9663" class="sect2">
<h3 class="sect2"><span class="secnum">12.3.4</span> Step 4: Obtain an Initial Ticket for the Kerberos/Oracle User</h3>
<p>Before a client can connect to the database, the client must request an <a href="asogls.htm#i997055"><span class="xrefglossterm">initial ticket</span></a>. To request an initial ticket, follow the task information for <a href="#i1006496">"Step 10: Get an Initial Ticket for the Kerberos/Oracle User"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The user does not need to explicitly request for an initial ticket, using the <code dir="ltr">okinit</code> command, when using the Windows native cache.
<p>If the Oracle client is running on Windows 2000 or later, the Kerberos ticket is automatically retrieved when the user logs in to Windows.</p>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Microsoft documentation for details on the <code dir="ltr">Kerbtray.exe</code> utility, which can be used to display Kerberos ticket information for a system</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDGFGFI"></a>
<div id="ASOAG10654" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">12.4</span> Configuring Kerberos Authentication Fallback Behavior</h2>
<p><a id="sthref526"></a>After <a id="sthref527"></a><a id="sthref528"></a>you have configured Kerberos authentication for Oracle clients to use Kerberos authentication to authenticate to an Oracle database, there are cases where you may want to fall back to password-based authentication. An example would be if you have fixed user database links in the Oracle database.</p>
<p>To enable Kerberos authentication to fall back to password-based authentication, set the <code dir="ltr">SQLNET.FALLBACK_AUTHENTICATION</code> parameter to <code dir="ltr">TRUE</code> in the <code dir="ltr">sqlnet.ora</code> files on both the client and the server. The default of this parameter is <code dir="ltr">FALSE</code> and this means that by default, the connection fails when Kerberos authentication fails.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink NETRF2043" href="../../network.112/e10835/sqlnet.htm#NETRF2043"><span class="italic">Oracle Database Net Services Reference</span></a></div>
</div>
<!-- class="sect1" -->
<a id="BAJEHBGJ"></a>
<div id="ASOAG9664" class="sect1">
<h2 class="sect1"><span class="secnum">12.5</span> Troubleshooting the Oracle Kerberos Authentication Configuration</h2>
<p>This <a id="sthref529"></a>section lists some common configuration problems and explains how to resolve them.</p>
<ul>
<li>
<p>If you cannot get your ticket-granting ticket using <code dir="ltr">okinit</code>:</p>
<ul>
<li>
<p>Ensure that the default realm is correct by examining the <code dir="ltr">krb.conf</code> file.</p>
</li>
<li>
<p>Ensure that the KDC is running on the host specified for the realm.</p>
</li>
<li>
<p>Ensure that the KDC has an entry for the user principal and that the passwords match.</p>
</li>
<li>
<p>Ensure that the <code dir="ltr">krb.conf</code> and <code dir="ltr">krb.realms</code> files are readable by Oracle.</p>
</li>
<li>
<p>Ensure that the <code dir="ltr">TNS_ADMIN</code> environment variable is pointing to the directory containing the <code dir="ltr">sqlnet.ora</code> configuration file.</p>
</li>
</ul>
</li>
<li>
<p>If you have an initial ticket but still cannot connect:</p>
<ul>
<li>
<p>After trying to connect, check for a service ticket.</p>
</li>
<li>
<p>Check that the <code dir="ltr">sqlnet.ora</code> file on the database server side has a service name that corresponds to a service known by Kerberos.</p>
</li>
<li>
<p>Check that the clocks on all systems involved are set to times that are within a few minutes of each other or change the <code dir="ltr">SQLNET.KERBEROS5_CLOCKSKEW</code> parameter in the <code dir="ltr">sqlnet.ora</code> file.</p>
</li>
</ul>
</li>
<li>
<p>If you have a service ticket and you still cannot connect:</p>
<ul>
<li>
<p>Check the clocks on the client and database server.</p>
</li>
<li>
<p>Check that the <code dir="ltr">v5srvtab</code> file exists in the correct location and is readable by Oracle. Remember to set the <code dir="ltr">sqlnet.ora</code> parameters.</p>
</li>
<li>
<p>Check that the <code dir="ltr">v5srvtab</code> file has been generated for the service named in the <code dir="ltr">sqlnet.ora</code> file on the database server side.</p>
</li>
</ul>
</li>
<li>
<p>If everything seems to work fine, but then you issue another query and it fails:</p>
<ul>
<li>
<p>Check that the initial ticket is forwardable. You must have obtained the initial ticket by running the <code dir="ltr">okinit</code> utility.</p>
</li>
<li>
<p>Check the expiration date on the credentials. If the credentials have expired, then close the connection and run <code dir="ltr">okinit</code> to get a new initial ticket.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2227">
<tr>
<td class="cellalignment2236">
<table class="cellalignment2232">
<tr>
<td class="cellalignment2231"><a href="asoradus.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2231"><a href="asossl.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2238">
<table class="cellalignment2230">
<tr>
<td class="cellalignment2231"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2231"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2231"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2231"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2231"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2231"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
