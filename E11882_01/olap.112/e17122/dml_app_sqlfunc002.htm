<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>OLAP_CONDITION</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 742" />
<meta name="dcterms.created" content="2013-11-14T21:21:59Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="OLAP DML Reference" />
<meta name="dcterms.identifier" content="E17122-08" />
<meta name="dcterms.isVersionOf" content="OLADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="dml_app_sqlfunc001.htm" title="Previous" type="text/html" />
<link rel="Next" href="dml_app_sqlfunc003.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17122.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">552/593</span> <!-- End Header --><a id="CIHJHDCH"></a>
<hr />
<div id="OLADM941" class="refsect1">
<h1 class="refsect1">OLAP_CONDITION</h1>
<p><a id="ABC1700185"></a><code>OLAP_CONDITION</code> is a SQL <a id="ABC1697210"></a>function that dynamically executes an OLAP DML command during a query of an analytic workspace.<a id="sthref5406"></a></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li><a href="dml_app_sqlfunc001.htm#g1004021">OLAP_TABLE</a> and <a href="dml_app_sqlfunc.htm#CHDEBBGF">"Modifying an Analytic Workspace From Within a SELECT FROM OLAP_TABLE Statement"</a>.</li>
</ul>
</div>
<p>The <code>OLAP_CONDITION</code> function executes an OLAP DML command at one of three entry points in the limit map used in a call to <code>OLAP_TABLE</code> as described in <a href="#CHDFHEID">"Entry Points for OLAP_CONDITION in the OLAP_TABLE Limit Map"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot execute this function from within the OLAP Worksheet. You must execute if in a SQL tool such as SQL Worksheet.</div>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5407"></a>Returns</p>
<p>The number <code>1</code> to indicate a successful invocation of <code>OLAP_CONDITION</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5408"></a>Syntax</p>
<pre>
OLAP_CONDITION(
          r2c          IN   RAW(32),
          expression   IN   VARCHAR2,
          event        IN   NUMBER DEFAULT 1);
      RETURN NUMBER;
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5409"></a>Parameters</p>
<dl>
<dt><span class="italic">r2c</span></dt>
<dd>
<p>The name of a column specified by a <code>ROW2CELL</code> <a id="sthref5410"></a>clause in the limit map. This parameter is used by <code>OLAP_CONDITION</code> to identify a particular invocation of <code>OLAP_TABLE</code>.</p>
<p>The <code>ROW2CELL</code> column is used in the processing of the single-row functions. (See <a href="dml_app_sqlfunc003.htm#BGBGDDDF">"OLAP_EXPRESSION"</a>) <code>OLAP_CONDITION</code> simply uses it as an identifier.</p>
<p>For information on creating a <code>ROW2CELL</code> column, see <a href="dml_app_sqlfunc001.htm#CIHGCEGC">"<span class="bold">ROW2CELL Clause</span>"</a>.</p>
</dd>
<dt><span class="italic">expression</span></dt>
<dd>
<p>A single OLAP DML command to be executed within the context of the <code>OLAP_TABLE</code> function identified by the <span class="italic">r2c</span> parameter</p>
</dd>
<dt><span class="italic">event</span></dt>
<dd>
<p>The event during <code>OLAP_TABLE</code> processing that triggers the execution of the OLAP DML command specified by the <span class="italic">expression</span> parameter. This parameter can have the value 0, 1, or 2, as described in <a href="#CIHFDFAG">Table A-2</a></p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CIHJHHFF"></a>Usage Notes</p>
<p class="subhead2"><a id="CHDFHEID"></a><a id="OLADM2968"></a>Entry Points for OLAP_CONDITION in the OLAP_TABLE Limit Map</p>
<p>Parameters of <code>OLAP_CONDITION</code> identify an invocation of <code>OLAP_TABLE</code>, specify an entry point in the limit map, and provide the OLAP DML command to be executed at that entry point.</p>
<p>The target limit map must include a <code><a id="sthref5411"></a>ROW2CELL</code> column. <code>OLAP_CONDITION</code> uses this column to identify an instance of <code>OLAP_TABLE</code>. Within that instance <code>OLAP_CONDITION</code> executes the OLAP DML command at one of three possible entry points. The entry point that you specify determines whether the condition affects the data returned by the query and whether the condition remains in effect upon completion of the query.</p>
<p><code>OLAP_CONDITION</code> can be triggered at any of the following points:</p>
<ul>
<li>
<p>Before the status of the dimensions in the limit map is saved (which occurs before the result set is calculated).</p>
</li>
<li>
<p>After the result set has been calculated and before it is fetched. (Default)</p>
</li>
<li>
<p>After the result set has been fetched and the status of the dimensions in the limit map has been restored.</p>
</li>
</ul>
<p>The entry points for <code>OLAP_CONDITION</code> are described in <a href="#CIHFDFAG">Table A-2</a>. Refer to <a href="dml_app_sqlfunc001.htm#CIHIHFHJ">"Order of Processing in OLAP_TABLE"</a> to determine where each entry point occurs.</p>
<div id="OLADM2969" class="tblformal">
<p class="titleintable"><a id="sthref5412"></a><a id="CIHFDFAG"></a>Table A-2 Entry Points for OLAP_CONDITION in the OLAP_TABLE Limit Map</p>
<table class="cellalignment3098" title="Entry Points for OLAP_CONDITION in the OLAP_TABLE Limit Map " summary="The entry points in the OLAP_TABLE limit map used by the OLAP_CONDITION function" dir="ltr">
<thead>
<tr class="cellalignment3089">
<th class="cellalignment3099" id="r1c1-t19">Entry Point</th>
<th class="cellalignment3099" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment3089">
<td class="cellalignment3095" id="r2c1-t19" headers="r1c1-t19">
<p>0</p>
</td>
<td class="cellalignment3095" headers="r2c1-t19 r1c2-t19">
<p>Execute the OLAP DML command after the <code>PREDMLCMD</code> clause of the limit map is processed and before the status of the dimensions in the limit map is saved.</p>
<p>The entry point is between steps <a href="dml_app_sqlfunc001.htm#CIAECJAA">1</a> and <a href="dml_app_sqlfunc001.htm#CIAJBFFG">2</a> in <a href="dml_app_sqlfunc001.htm#CIHIHFHJ">"Order of Processing in OLAP_TABLE"</a>.</p>
<p>If <code>OLAP_CONDITION</code> limits any of the dimensions in the limit map, the limits remain in the workspace after the execution of <code>OLAP_TABLE</code> (unless a command in the <code>POSTDMLCMD</code> clause of the limit map changes the status).</p>
</td>
</tr>
<tr class="cellalignment3089">
<td class="cellalignment3095" id="r3c1-t19" headers="r1c1-t19">
<p>1</p>
</td>
<td class="cellalignment3095" headers="r3c1-t19 r1c2-t19">
<p>Execute the OLAP DML command after the conditions of the <code>WHERE</code> clause are satisfied and before the data is fetched. (Default.)</p>
<p>The entry point is between steps <a href="dml_app_sqlfunc001.htm#CIAEHGAJ">4</a> and <a href="dml_app_sqlfunc001.htm#CIABCEHE">5</a> in <a href="dml_app_sqlfunc001.htm#CIHIHFHJ">"Order of Processing in OLAP_TABLE"</a>.</p>
<p>If an OLAP DML command (other than <code>FETCH</code>) is specified in the <span class="italic">olap_command</span> parameter of <code>OLAP_TABLE</code>, it is executed after <code>OLAP_CONDITION</code> and before the data is fetched. (The use of a <code>FETCH</code> command in the <span class="italic">olap_command</span> parameter, or in <code>OLAP_CONDITION</code> itself, is not generally recommended. See <a href="dml_app_sqlfunc001.htm#CIHJADBF">"Using FETCH in the olap_command Parameter"</a>.)</p>
<p>If <code>OLAP_CONDITION</code> limits any of the dimensions in the limit map, the limits remain in effect for the duration of the query only.</p>
</td>
</tr>
<tr class="cellalignment3089">
<td class="cellalignment3095" id="r4c1-t19" headers="r1c1-t19">
<p>2</p>
</td>
<td class="cellalignment3095" headers="r4c1-t19 r1c2-t19">
<p>Execute the OLAP DML command after the data is fetched and the status of dimensions in the limit map has been restored.</p>
<p>The entry point is after step <a href="dml_app_sqlfunc001.htm#CIAGIIEA">8</a> in <a href="dml_app_sqlfunc001.htm#CIHIHFHJ">"Order of Processing in OLAP_TABLE"</a>.</p>
<p>If <code>OLAP_CONDITION</code> limits any dimensions, the <a id="sthref5413"></a>limits remain in the <a id="sthref5414"></a>analytic workspace after the query completes.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="CIHIDIHF"></a>Examples</p>
<p>Several sample queries using <code>OLAP_CONDITION</code> are shown in <a href="#CIHGDABH">Example A-11, "Queries of UNIT_COST_PRICE_VIEW Using OLAP_CONDITION"</a>. These examples use the <code>PRICE_CUBE</code> in an analytic workspace named<code>MYAW</code>. The cube has a time dimension, a product dimension, and measures for unit cost and unit price.</p>
<p>The examples are based on a view called <code>unit_cost_price_view</code>. The SQL for creating this view is shown in <a href="#CIHGHICF">Example A-10, "View of PRICE_CUBE"</a>. For information about creating views of analytic workspaces, see <a href="dml_app_sqlfunc.htm#CIHIFEAD">"Creating Relational Views Using OLAP_TABLE"</a>.</p>
<div id="OLADM2970" class="example">
<p class="titleinexample"><a id="CIHGHICF"></a>Example A-10 View of PRICE_CUBE</p>
<pre>
-- Create the logical row
SQL&gt;CREATE TYPE unit_cost_price_row AS OBJECT (
            aw_unit_cost          NUMBER,
            aw_unit_price         NUMBER,
            aw_product            VARCHAR2(50),
            aw_product_gid        NUMBER(10),
            aw_time               VARCHAR2(20),
            aw_time_gid           NUMBER(10),
            r2c                   RAW(32));

-- Create the logical table
SQL&gt;CREATE TYPE unit_cost_price_table AS TABLE OF unit_cost_price_row;

-- Create the view
SQL&gt;CREATE OR REPLACE VIEW unit_cost_price_view AS
    SELECT aw_unit_cost, aw_unit_price, aw_product, aw_product_gid,
           aw_time, aw_time_gid, r2c 
      FROM TABLE(OLAP_TABLE(
         'myaw DURATION SESSION',
         'unit_cost_price_table', 
         '',
         'MEASURE aw_unit_cost  FROM price_cube_unit_cost
          MEASURE aw_unit_price FROM price_cube_unit_price
          DIMENSION product WITH 
             HIERARCHY product_parentrel
                INHIERARCHY product_inhier
                GID aw_product_gid FROM product_gid
             ATTRIBUTE aw_product FROM product_short_description
          DIMENSION time WITH 
             HIERARCHY time_parentrel
                INHIERARCHY time_inhier
                GID aw_time_gid FROM time_gid
             ATTRIBUTE aw_time FROM time_short_description
          ROW2CELL r2c'));

-- query the view
SQL&gt;SELECT * FROM unit_cost_price_view 
             WHERE aw_product = 'Hardware'
             AND aw_time in ('2000', '2001', '2002', '2003')
             ORDER BY aw_time;

AW_UNIT_COST AW_UNIT_PRICE AW_PRODUCT AW_PRODUCT_GID AW_TIME AW_TIME_GID R2C
------------ ------------- ---------- -------------- ------- ----------- -----
   211680.12    224713.71  Hardware                3 2000             3  00...
   195591.60    207513.16  Hardware                3 2001             3  00...
   184413.05    194773.78  Hardware                3 2002             3  00...
    73457.31     77275.06  Hardware                3 2003             3  00...
</pre></div>
<!-- class="example" -->
<div id="OLADM2971" class="example">
<p class="titleinexample"><a id="CIHGDABH"></a>Example A-11 Queries of UNIT_COST_PRICE_VIEW Using OLAP_CONDITION</p>
<p>The queries in this example use <code>OLAP_CONDITION</code> to modify the query of <code>UNIT_COST_PRICE_VIEW</code> in <a href="#CIHGHICF">Example A-10, "View of PRICE_CUBE"</a>. In each query, <code>OLAP_CONDITION</code> uses a different entry point to limit the <code>TIME</code> dimension to the year 2000.</p>
<p>In the first query, <code>OLAP_CONDIITON</code> uses entry point 0. The limited data is returned by <code>OLAP_TABLE</code>, and the limit remains in effect in the analytic workspace.</p>
<pre>
SQL&gt;SELECT * FROM unit_cost_price_view 
             WHERE aw_product = 'Hardware'
             AND aw_time in ('2000', '2001', '2002', '2003')
             AND OLAP_CONDITION(r2c, 
                       'limit time to time_short_description eq ''2000''', 0)=1
             ORDER BY aw_time;

AW_UNIT_COST AW_UNIT_PRICE AW_PRODUCT AW_PRODUCT_GID AW_TIME AW_TIME_GID R2C
------------ ------------- ---------- -------------- ------- ----------- -----
   211680.12    224713.71  Hardware                3 2000             3  00...

--Check status in the analytic workspace
SQL&gt;exec dbms_aw.execute('rpr time_short_description');

TIME     TIME_SHORT_DESCRIPTION 
----     ----------------------
  3      2000 

-- Reset status
SQL&gt;exec dbms_aw.execute('allstat');
</pre>
<p>In the next query, <code>OLAP_CONDIITON</code> uses entry point 1. The limited data is returned by <code>OLAP_TABLE</code>, but the limit does not remain in effect in the analytic workspace.</p>
<p>Note that the third parameter is not required in this case, because entry point 1 is the default.</p>
<pre>
SQL&gt;SELECT * FROM unit_cost_price_view 
             WHERE aw_product = 'Hardware'
             AND aw_time in ('2000', '2001', '2002', '2003')
             AND OLAP_CONDITION(r2c, 
                       'limit time to time_short_description eq ''2000''', 1)=1
             ORDER BY aw_time;

AW_UNIT_COST AW_UNIT_PRICE AW_PRODUCT AW_PRODUCT_GID AW_TIME AW_TIME_GID R2C
------------ ------------- ---------- -------------- ------- ----------- -----
   211680.12    224713.71  Hardware                3 2000             3  00...

--Check status in the analytic workspace
SQL&gt;exec dbms_aw.execute('rpr time_short_description');

TIME     TIME_SHORT_DESCRIPTION 
----     ----------------------
 19      Jan-98 
 20      Feb-98 
 21      Mar-98 
 22      Apr-98 
.        
.        
.        
  1      1998 
  2      1999 
  3      2000 
  4      2001 
 85      2002 
102      2003 
119      2004 

-- Reset status
SQL&gt;exec dbms_aw.execute('allstat');
</pre>
<p>In the final query, <code>OLAP_CONDIITON</code> uses entry point 2. The limit does not affect the data returned by <code>OLAP_TABLE</code>, but the limit remains in effect in the analytic workspace.</p>
<pre>
SQL&gt;SELECT * FROM unit_cost_price_view 
             WHERE aw_product = 'Hardware'
             AND aw_time in ('2000', '2001', '2002', '2003')
             AND OLAP_CONDITION(r2c, 
                       'limit time to time_short_description eq ''2000''', 2)=1
             ORDER BY aw_time;

AW_UNIT_COST AW_UNIT_PRICE AW_PRODUCT AW_PRODUCT_GID AW_TIME AW_TIME_GID R2C
------------ ------------- ---------- -------------- ------- ----------- -----
   211680.12    224713.71  Hardware                3 2000             3  00...
   195591.60    207513.16  Hardware                3 2001             3  00...
   184413.05    194773.78  Hardware                3 2002             3  00...
    73457.31     77275.06  Hardware                3 2003             3  00...

--Check status in the analytic workspace
SQL&gt;exec dbms_aw.execute('rpr time_short_description');

TIME     TIME_SHORT_DESCRIPTION 
----     ----------------------
  3      2000 
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3088">
<tr>
<td class="cellalignment3095">
<table class="cellalignment3093">
<tr>
<td class="cellalignment3092"><a href="dml_app_sqlfunc001.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3092"><a href="dml_app_sqlfunc003.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3097">
<table class="cellalignment3091">
<tr>
<td class="cellalignment3092"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3092"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3092"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3092"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3092"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3092"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
