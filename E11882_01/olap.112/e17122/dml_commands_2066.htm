<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>TRIGGER command</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 742" />
<meta name="dcterms.created" content="2013-11-14T21:21:59Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="OLAP DML Reference" />
<meta name="dcterms.identifier" content="E17122-08" />
<meta name="dcterms.isVersionOf" content="OLADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="dml_commands_2065.htm" title="Previous" type="text/html" />
<link rel="Next" href="dml_commands_2067.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17122.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">540/593</span> <!-- End Header --><a id="BABGJHJH"></a>
<hr />
<div id="OLADM922" class="refsect1"><!-- infolevel="all" infotype="General" -->
<h1 class="refsect1">TRIGGER command</h1>
<p><a id="sthref5207"></a>The TRIGGER command <a id="ABC1415668"></a>associates a previously-created program to an object and identifies the object event that automatically executes the program; or disassociates a trigger program from the object.</p>
<p>To assign a trigger program to an object, the object must be the one most recently defined or considered during the current session. When it is not, you must first use a CONSIDER statement to make it the current definition.</p>
<div class="infoboxnotealso">
<p class="notep1">See also:</p>
<a href="dml_program.htm#CHDBDIIH">"Trigger Programs"</a> and the <a href="dml_functions_2140.htm#BABCJEAD">TRIGGER function</a>.</div>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5208"></a>Syntax</p>
<p class="synopsis">TRIGGER {<span class="italic">event-name</span> [<span class="italic">program-name</span>] }... | {DELETE <span class="italic">event-name</span>}... | DELETE ALL</p>
<p>where <span class="syntaxinlineitalic">event-name</span> is one of the following:</p>
<dl>
<dd><span class="syntaxinline">MAINTAIN</span></dd>
<dd><span class="syntaxinline">DELETE</span></dd>
<dd><span class="syntaxinline">PROPERTY</span></dd>
<dd><span class="syntaxinline">ASSIGN</span></dd>
<dd><span class="syntaxinline">BEFORE_UPDATE</span></dd>
<dd><span class="syntaxinline">AFTER_UPDATE</span></dd>
</dl>
<p>You can use the same keyword many times in a single TRIGGER statement; however, in this case, Oracle OLAP ignores all but the last occurrence of the keyword. See <a href="#BABBAAHG">"Multiple Occurrences of the Same Keyword"</a>, for details.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5209"></a>Parameters</p>
<dl>
<dt>MAINTAIN</dt>
<dd>
<p><a id="sthref5210"></a><a id="sthref5211"></a><a id="sthref5212"></a><a id="sthref5213"></a><a id="sthref5214"></a><a id="sthref5215"></a><a id="sthref5216"></a><a id="sthref5217"></a><a id="sthref5218"></a><a id="sthref5219"></a>Specifies that the trigger for the program is a Maintain event. A Maintain event is the execution of the MAINTAIN statement. As outlined in <a href="dml_functions_2140.htm#CEGFGHBF">Table 8-19, "Subevents for the MAINTAIN Event"</a>, the Maintain event has several subevents that correspond to the major keywords of the MAINTAIN command. Exactly when a program triggered by a Maintain event is executed is dependent on the Maintain subevent that triggered the program and the object type for which the Maintain event is defined:.</p>
<ul>
<li>
<p>Programs triggered by Maintain Add and Maintain Merge events on dimensions and composites are executed <span class="italic">after</span> the entire MAINTAIN statement executes.</p>
</li>
<li>
<p>Programs triggered by Maintain Add and Maintain Merge events on dimension surrogates are executed multiple times&shy;&mdash;once <span class="italic">after</span> each value is added or merged.</p>
</li>
<li>
<p>Programs triggered by other Maintain subevents are executed <span class="italic">before</span> the MAINTAIN statement is executed.</p>
</li>
</ul>
</dd>
<dt>DELETE</dt>
<dd>
<p><a id="sthref5220"></a><a id="sthref5221"></a><a id="sthref5222"></a><a id="sthref5223"></a><a id="sthref5224"></a><a id="sthref5225"></a><a id="sthref5226"></a><a id="sthref5227"></a><a id="sthref5228"></a><a id="sthref5229"></a>Specifies that the trigger for the program is a Delete event. A Delete event is a DELETE statement for the object. Oracle OLAP executes the specified program immediately before a DELETE statement deletes the object.</p>
</dd>
<dt>PROPERTY</dt>
<dd>
<p><a id="sthref5230"></a><a id="sthref5231"></a><a id="sthref5232"></a><a id="sthref5233"></a><a id="sthref5234"></a><a id="sthref5235"></a><a id="sthref5236"></a><a id="sthref5237"></a><a id="sthref5238"></a><a id="sthref5239"></a>Specifies that Oracle OLAP executes the specified program in response to a Property event. A Property event is the execution of a PROPERTY statement to create, modify, or delete an object property. A program that is triggered by a Property event is executed before the statement that triggered it.</p>
</dd>
<dt>ASSIGN</dt>
<dd>
<p><a id="sthref5240"></a><a id="sthref5241"></a><a id="sthref5242"></a><a id="sthref5243"></a><a id="sthref5244"></a><a id="sthref5245"></a><a id="sthref5246"></a><a id="sthref5247"></a><a id="sthref5248"></a><a id="sthref5249"></a><a id="sthref5250"></a><a id="sthref5251"></a><a id="sthref5252"></a><a id="sthref5253"></a>Specifies that Oracle OLAP executes the specified program in response to an Assign event. An Assign event is executed when SET assigns values to variable, relation, worksheet object, or a formula. A program that is triggered by SET is executed each time Oracle OLAP assigns a value to the object for which the event was defined. Thus, a program triggered by an Assign event is often executed over and over again as the assignment statements loops through an object assigning values.</p>
</dd>
<dt>UPDATE</dt>
<dd>
<p><a id="sthref5254"></a><a id="sthref5255"></a><a id="sthref5256"></a><a id="sthref5257"></a><a id="sthref5258"></a>When the object has been acquired using ACQUIRE in an analytic workspace that is attached in multiwriter mode, specifies that Oracle OLAP executes the specified program immediately after the object is updated.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
To specify processing when the entire analytic workspace is updated, create a TRIGGER_AFTER_UPDATE or TRIGGER_BEFORE_UPDATE program.</div>
</dd>
<dt><span class="italic">program-name</span></dt>
<dd>
<p>The name of the trigger program. When omitted for an event, the event does not trigger an action.</p>
</dd>
<dt>DELETE <span class="italic">event-name</span></dt>
<dd>
<p><a id="sthref5259"></a><a id="sthref5260"></a><a id="sthref5261"></a><a id="sthref5262"></a><a id="sthref5263"></a><a id="sthref5264"></a><a id="sthref5265"></a><a id="sthref5266"></a><a id="sthref5267"></a>Deletes the triggers for the specified object events. Oracle OLAP disassociates the trigger program from the specified object event.</p>
</dd>
<dt>DELETE ALL</dt>
<dd>
<p>Deletes all of the triggers for the specified object. Oracle OLAP disassociates the trigger program from all events for object.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5268"></a>Usage Notes</p>
<p class="subhead2"><a id="BABBAAHG"></a><a id="OLADM2876"></a>Multiple Occurrences of the Same Keyword</p>
<p>You can use all of the keywords in a single TRIGGER statement. However, if you use the same keyword twice in a TRIGGER statement, then Oracle OLAP recognized the last occurrence of the keyword; other occurrences are ignored.</p>
<p>For example, assume that you code the following TRIGGER statement.</p>
<pre>
TRIGGER PROPERTY progname1 PROPERTY progname2 PROPERTY progname3
</pre>
<p>When executing this TRIGGER statement, Oracle OLAP executes <code>progname3</code> immediately before a property of the object is created, modified, or deleted; Oracle OLAP does <span class="italic">not</span> execute <code>progname1</code> or <code>progname2</code>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref5269"></a>Examples</p>
<div id="OLADM2877" class="example">
<p class="titleinexample"><a id="CEGHACAG"></a>Example 10-159 Creating Triggers</p>
<p>Assume that your analytic workspace contains a <code>TEXT</code> dimension named <code>city</code> and that you want to create programs that automatically execute when a MAINTAIN statement executes against <code>city</code> or when a property is created or deleted for city. To create these triggers, you issue the following statements.</p>
<pre>
"Define the trigger programs
DEFINE trigger_maintain_move_city PROGRAM BOOLEAN
DEFINE trigger_property_city PROGRAM BOOLEAN
"Associate the trigger programs to events for the city dimension
CONSIDER city
TRIGGER PROPERTY trigger_property_city
TRIGGER MAINTAIN trigger_maintain_move_city
</pre></div>
<!-- class="example" -->
<div id="OLADM2878" class="example">
<p class="titleinexample"><a id="CEGCHEAH"></a>Example 10-160 Describing Triggers</p>
<p>Assume that you have created the triggers for <code>city</code> as described in <a href="#CEGHACAG">Example 10-159, "Creating Triggers"</a> . Later you want to see the description of the triggers, to do so you cannot issue a DESCRIBE statement for your analytic workspace. Instead, you must issue a FULLDSC statement.</p>
<pre>
DEFINE CITY DIMENSION TEXT
TRIGGER MAINTAIN TRIGGER_MAINTAIN_MOVE_CITY -
        PROPERTY TRIGGER_PROPERTY_CITY
 
DEFINE TRIGGER_MAINTAIN_MOVE_CITY PROGRAM BOOLEAN
 
DEFINE TRIGGER_PROPERTY_CITY PROGRAM BOOLEAN
</pre></div>
<!-- class="example" -->
<div id="OLADM2879" class="example">
<p class="titleinexample"><a id="sthref5270"></a>Example 10-161 Deleting Triggers</p>
<p>Assume that you have created the triggers described in <a href="#CEGHACAG">Example 10-159, "Creating Triggers"</a> . Now you want to delete the MAINTAIN trigger for <code>city</code>. To delete this trigger you issue the following statements.</p>
<pre>
CONSIDER city
TRIGGER DELETE MAINTAIN
 
</pre>
<p>When you issue a FULLDSC statement, you confirm that the MAINTAIN trigger for <code>city</code> has been deleted although the <code>trigger_maintain_move_city</code> program remains.</p>
<pre>
DEFINE CITY DIMENSION TEXT
TRIGGER PROPERTY TRIGGER_PROPERTY_CITY
 
DEFINE TRIGGER_MAINTAIN_MOVE_CITY PROGRAM BOOLEAN
 
DEFINE TRIGGER_PROPERTY_CITY PROGRAM BOOLEAN
</pre>
<p>To actually delete the <code>trigger_maintain_move_city</code> program you must issue the following statement.</p>
<pre>
DELETE TRIGGER_MAINTAIN_MOVE_CITY 
</pre></div>
<!-- class="example" -->
<div id="OLADM2880" class="example">
<p class="titleinexample"><a id="CEGHCAHC"></a>Example 10-162 A MAINTAIN Trigger Program</p>
<p>Assume that you have a dimension with the following definition in your analytic workspace.</p>
<pre>
DEFINE CITY DIMENSION TEXT
 
</pre>
<p>To create a Maintain trigger for city, you take the following steps:</p>
<ol>
<li>
<p>Define the trigger program as a user-defined function. It can have any name that you want. The following statement defines a program named <code>trigger_maintain_city</code>.</p>
<pre>
DEFINE trigger_maintain_city PROGRAM BOOLEAN
 
</pre></li>
<li>
<p>Specify the content of the program.</p>
<pre>
PROGRAM
SHOW JOINCHARS ('calltype = ' CALLTYPE)
SHOW JOINCHARS ('triggering event = ' TRIGGER(EVENT))
SHOW JOINCHARS ('triggering subevent = ' TRIGGER(SUBEVENT))
RETURN TRUE
END
 
</pre></li>
<li>
<p>Issue a TRIGGER statement to associate the trigger program with the <code>city</code> dimension as a program to be executed when a Maintain event occurs. Remember to use a CONSIDER statement to make the definition for <code>city</code> the current definition.</p>
<pre>
CONSIDER city
TRIGGER MAINTAIN TRIGGER_MAINTAIN_CITY
</pre></li>
</ol>
<p>When you issue a FULLDSC statement to see a full description of your analytic workspace, you can see the definition of <code>city</code> (including its Maintain trigger) and the <code>trigger_maintain_city</code> program.</p>
<pre>
DEFINE CITY DIMENSION TEXT
TRIGGER MAINTAIN TRIGGER_MAINTAIN_CITY
 
DEFINE TRIGGER_MAINTAIN_CITY PROGRAM BOOLEAN
PROGRAM
SHOW JOINCHARS ('calltype = ' CALLTYPE)
SHOW JOINCHARS ('triggering event = ' TRIGGER(EVENT))
SHOW JOINCHARS ('triggering subevent = ' TRIGGER(SUBEVENT))
RETURN TRUE
END
 
</pre>
<p>As illustrated in the following statements and output, when you issue MAINTAIN statements for city, the <code>trigger_maintain_city</code> program executes.</p>
<pre>
MAINTAIN city ADD 'Boston' 'Houston' 'Dallas'

calltype = TRIGGER
triggering event = MAINTAIN
triggering subevent = ADD
 
REPORT city
 
CITY
--------------
Boston
Houston
Dallas
 
MAINTAIN city MOVE 'Dallas' to 2

calltype = TRIGGER
triggering event = MAINTAIN
triggering subevent = MOVE
 
REPORT city
 
CITY
--------------
Boston
Dallas
Houston
</pre></div>
<!-- class="example" -->
<div id="OLADM2881" class="example">
<p class="titleinexample"><a id="CEGCIIGC"></a>Example 10-163 An ASSIGN Trigger on a Variable</p>
<p>Assume that your analytic workspace contains objects with the following definitions.</p>
<pre>
DEFINE geog DIMENSION TEXT
DEFINE sales VARIABLE DECIMAL &lt;geog&gt;
DEFINE percent_sales VARIABLE INTEGER &lt;geog&gt;
 
</pre>
<p>The <code>sales</code> variable contains the following values.</p>
<pre>
GEOG             SALES
-------------- ----------
North America        0.59
Europe               9.35
Asia                   NA
</pre>
<p>The <code>percent_sales</code> variable is empty.</p>
<p>Assume that you want specialized processing of values when you assign values to <code>percent_sales</code>. To handle this processing automatically, you can create an Assign trigger program for <code>percent_sales</code> by taking the following steps:</p>
<ol>
<li>
<p>Create a trigger program that executes each time you assign values to <code>percent_sales</code>.</p>
<pre>
DEFINE TRIGGER_EQ PROGRAM BOOLEAN
PROGRAM
ARGUMENT datavalue WORKSHEET
show 'description of triggering object = ' 
FULLDESCRIBE &amp;TRIGGER(NAME)
SHOW JOINCHARS ('calltype = ' CALLTYPE)
SHOW JOINCHARS ('triggering event = ' TRIGGER(EVENT))
SHOW JOINCHARS ('triggering subevent = ' TRIGGER(SUBEVENT))
SHOW JOINCHARS ('value being assigned = ' datavalue)
SHOW '  '
END
 
</pre></li>
<li>
<p>Add an assign trigger to <code>percent_sales</code> using a TRIGGER statement. Remember to first issue a CONSIDER statement to make the definition for the <code>percent_sales</code> variable the current definition.</p>
<pre>
CONSIDER percent_sales
TRIGGER ASSIGN TRIGGER_EQ
</pre></li>
<li>
<p>Assign values to <code>percent_sales</code>.</p>
<pre>
percent_sales = (sales/TOTAL(sales))*100
</pre>
<p>Assigning values to <code>percent_sales</code> triggers the execution of the <code>trigger_eq</code> program and produces the following output lines.</p>
<pre>
description of triggering object = 
DEFINE PERCENT_SALES VARIABLE INTEGER &lt;GEOG&gt;
TRIGGER ASSIGN TRIGGER_EQ
calltype = TRIGGER
triggering event = ASSIGN
triggering subevent = 
value being assigned = 6

description of triggering object = 
DEFINE PERCENT_SALES VARIABLE INTEGER &lt;GEOG&gt;
TRIGGER ASSIGN TRIGGER_EQ
calltype = TRIGGER
triggering event = ASSIGN
triggering subevent = 
value being assigned = 94

description of triggering object = 
DEFINE PERCENT_SALES VARIABLE INTEGER &lt;GEOG&gt;
TRIGGER ASSIGN TRIGGER_EQ
calltype = TRIGGER
triggering event = ASSIGN
triggering subevent = 
value being assigned = 
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
From the output you can see that Oracle OLAP called the <code>trigger_eq</code> program three times&mdash;each time it assigned a value to <code>percent_sales</code>.</div>
</li>
<li>
<p>When you issue REPORT commands for <code>sales</code> and <code>percent_sales</code> you can see the result of the calculations. The <code>percent_sales</code> variable contains values that are the percent of sales for each continent.</p>
<pre>
GEOG                  SALES
-------------- --------------------
North America                  0.59
Europe                         9.35
Asia                             NA
 
GEOG              PERCENT_SALES
-------------- --------------------
North America                     6
Europe                           94
Asia                             NA
</pre></li>
</ol>
</div>
<!-- class="example" -->
<div id="OLADM2882" class="example">
<p class="titleinexample"><a id="CEGCBJHI"></a>Example 10-164 Setting Values in an ASSIGN Trigger Program</p>
<p>Assume that you have the following objects in your analytic workspace.</p>
<pre>
DEFINE GEOGRAPHY DIMENSION TEXT WIDTH 12
LD Geography Dimension Values
 
DEFINE PRODUCT DIMENSION TEXT WIDTH 12
LD Product Dimension Values
 
DEFINE TIME DIMENSION TEXT WIDTH 12
LD Time Dimension Values
 
DEFINE CHANNEL DIMENSION TEXT WIDTH 12
LD Channel Dimension Values
 
DEFINE F.MARGIN FORMULA DECIMAL &lt;CHANNEL GEOGRAPHY PRODUCT TIME&gt;
LD Margin
EQ f.sales-f.costs
 
 
DEFINE F.COSTS VARIABLE SHORT &lt;GEOGRAPHY PRODUCT CHANNEL TIME&gt;
LD Costs
 
DEFINE F.SALES VARIABLE SHORT &lt;GEOGRAPHY PRODUCT CHANNEL TIME&gt;
LD Sales
 
</pre>
<p>Note that <code>f.costs</code>, <code>f.sales</code>, and <code>f.margin</code> all have the same dimensions.</p>
<p>Now you add an Assign trigger to <code>f.margin</code> that executes a program named <code>t.margin</code>. The definition of <code>f.margin</code> is modified to the following definition.</p>
<pre>
DEFINE F.MARGIN FORMULA DECIMAL &lt;CHANNEL GEOGRAPHY PRODUCT TIME&gt;
LD Margin
TRIGGER ASSIGN T.MARGIN
EQ f.sales-f.costs
</pre>
<p>Now you actually write the t.margin program. When an expression is assigned to the <code>f.margin</code> formula, the program uses this value to compute new values for <code>f.costs</code> and <code>f.sales</code>.</p>
<pre>
DEFINE T.MARGIN PROGRAM
PROGRAM
ARG newVal DECIMAL       " The value passed to the program by the Assign trigger
VARIABLE t.valDiff DECIMAL     " Difference between newVal and old value
VARIABLE t.costInc DECIMAL     " Amount the difference makes to costs
"show the value of newVal
SHOW 'newVal = ' NONL
SHOW newVal
" Compute the difference between the current value and the new one
t.valDiff = newVal - f.margin
" Now increase costs proportional to their existing amounts
t.costInc = (newVal - f.margin) * (f.costs/f.sales)
" Adjust the values of sales and costs to get the new value
SET1 f.costs = f.costs + t.costInc
 
SET1 f.sales =  f.sales + t.valDiff + t.costInc
 
SHOW geography NONL
SHOW ' ' NONL
SHOW product NONL
SHOW ' ' NONL
SHOW channel NONL
SHOW ' ' NONL
SHOW time NONL
SHOW ' f.costs = 'NONL
SHOW f.costs NONL
SHOW ' f.sales = 'NONL
SHOW f.sales
END
 
</pre>
<p>Now assume that you issue the following LIMIT statements to identify a subset of data and issue a REPORT statement to report on the values of f.margin.</p>
<pre>
LIMIT t0.hierdim TO 'STANDARD'
LIMIT time TO t0.levelrel EQ 'L2'
LIMIT geography TO FIRST 1
LIMIT channel TO FIRST 1
LIMIT product TO FIRST 5
REPORT DOWN time ACROSS product: f.margin
 
GEOGRAPHY: WORLD
CHANNEL: TOTALCHANNEL
               -----------------------F.MARGIN-----------------------
               -----------------------PRODUCT------------------------
TIME           TOTALPROD   AUDIODIV  PORTAUDIO    PORTCD     PORTST
-------------- ---------- ---------- ---------- ---------- ----------
Q1.96          54,713,974 29,603,546  5,379,661  2,480,914  1,615,708
Q2.96          63,919,784 34,594,087  6,331,848  2,869,265  1,931,785
Q3.96          58,303,490 31,543,152  5,792,725  2,616,515  1,795,701
Q4.96          71,197,892 38,383,878  7,059,581  3,163,804  2,232,880
Q1.97          55,489,723 29,989,262  5,368,237  2,491,475  1,607,344
Q2.97          41,687,908 22,532,979  4,070,725  1,855,992  1,245,161
 
</pre>
<p>Now you issue the following assignment statement that increase the value of <code>f.margin</code> by 10% and report it</p>
<pre>
f.margin = f.margin * 1.1
</pre>
<p>The execution of this assignment statement triggers the execution of the Assign trigger program named <code>t.margin</code>. The output of that program follows.</p>
<pre>
newVal = 60,185,371.40
WORLD TOTALPROD TOTALCHANNEL Q1.96 f.costs = 1,298,474.00 f.sales = 61,483,840.00
newVal = 32,563,900.67
WORLD AUDIODIV TOTALCHANNEL Q1.96 f.costs = 664,226.90 f.sales = 33,228,130.00
newVal = 5,917,626.67
WORLD PORTAUDIO TOTALCHANNEL Q1.96 f.costs = 97,976.04 f.sales = 6,015,603.00
newVal = 2,729,005.43
WORLD PORTCD TOTALCHANNEL Q1.96 f.costs = 34,301.53 f.sales = 2,763,307.00
newVal = 1,777,278.95
WORLD PORTST TOTALCHANNEL Q1.96 f.costs = 25,160.72 f.sales = 1,802,440.00
newVal = 70,311,762.13
WORLD TOTALPROD TOTALCHANNEL Q2.96 f.costs = 1,504,051.00 f.sales = 71,815,820.00
newVal = 38,053,495.70
WORLD AUDIODIV TOTALCHANNEL Q2.96 f.costs = 768,788.10 f.sales = 38,822,280.00
newVal = 6,965,032.86
WORLD PORTAUDIO TOTALCHANNEL Q2.96 f.costs = 114,558.20 f.sales = 7,079,591.00
newVal = 3,156,191.20
WORLD PORTCD TOTALCHANNEL Q2.96 f.costs = 39,256.88 f.sales = 3,195,448.00
newVal = 2,124,963.02
WORLD PORTST TOTALCHANNEL Q2.96 f.costs = 29,780.54 f.sales = 2,154,744.00
newVal = 64,133,838.86
WORLD TOTALPROD TOTALCHANNEL Q3.96 f.costs = 1,350,733.00 f.sales = 65,484,570.00
newVal = 34,697,467.06
WORLD AUDIODIV TOTALCHANNEL Q3.96 f.costs = 691,887.10 f.sales = 35,389,360.00
newVal = 6,371,997.63
WORLD PORTAUDIO TOTALCHANNEL Q3.96 f.costs = 103,203.70 f.sales = 6,475,202.00
newVal = 2,878,166.40
WORLD PORTCD TOTALCHANNEL Q3.96 f.costs = 35,358.18 f.sales = 2,913,525.00
newVal = 1,975,270.68
WORLD PORTST TOTALCHANNEL Q3.96 f.costs = 27,339.77 f.sales = 2,002,611.00
newVal = 78,317,681.06
WORLD TOTALPROD TOTALCHANNEL Q4.96 f.costs = 1,618,915.00 f.sales = 79,936,590.00
newVal = 42,222,265.94
WORLD AUDIODIV TOTALCHANNEL Q4.96 f.costs = 826,923.40 f.sales = 43,049,190.00
newVal = 7,765,539.34
WORLD PORTAUDIO TOTALCHANNEL Q4.96 f.costs = 123,269.50 f.sales = 7,888,809.00
newVal = 3,480,184.35
WORLD PORTCD TOTALCHANNEL Q4.96 f.costs = 41,998.90 f.sales = 3,522,183.00
newVal = 2,456,168.00
WORLD PORTST TOTALCHANNEL Q4.96 f.costs = 33,357.19 f.sales = 2,489,525.00
newVal = 61,038,695.03
WORLD TOTALPROD TOTALCHANNEL Q1.97 f.costs = 1,423,963.00 f.sales = 62,462,660.00
newVal = 32,988,187.65
WORLD AUDIODIV TOTALCHANNEL Q1.97 f.costs = 679,477.80 f.sales = 33,667,660.00
newVal = 5,905,060.56
WORLD PORTAUDIO TOTALCHANNEL Q1.97 f.costs = 158,854.40 f.sales = 6,063,915.00
newVal = 2,740,622.56
WORLD PORTCD TOTALCHANNEL Q1.97 f.costs = 53,144.41 f.sales = 2,793,767.00
newVal = 1,768,078.14
WORLD PORTST TOTALCHANNEL Q1.97 f.costs = 40,784.62 f.sales = 1,808,863.00
newVal = 45,856,698.46
WORLD TOTALPROD TOTALCHANNEL Q2.97 f.costs = 1,070,465.00 f.sales = 46,927,160.00
newVal = 24,786,276.35
WORLD AUDIODIV TOTALCHANNEL Q2.97 f.costs = 512,435.60 f.sales = 25,298,710.00
newVal = 4,477,797.64
WORLD PORTAUDIO TOTALCHANNEL Q2.97 f.costs = 118,791.70 f.sales = 4,596,590.00
newVal = 2,041,591.56
WORLD PORTCD TOTALCHANNEL Q2.97 f.costs = 39,287.77 f.sales = 2,080,879.00
newVal = 1,369,677.57
WORLD PORTST TOTALCHANNEL Q2.97 f.costs = 30,038.08 f.sales = 1,399,716.00
</pre></div>
<!-- class="example" -->
<div id="OLADM2883" class="example">
<p class="titleinexample"><a id="CEGCIBAE"></a>Example 10-165 An ASSIGN Trigger on a Formula</p>
<p>The way Oracle OLAP handles assigning values to a formula varies depending on whether or not the formula has an Assign trigger as part of its definition.</p>
<p>Assume your analytic workspace contains objects with the following definitions and values.</p>
<pre>
DEFINE geog.d DIMENSION TEXT
DEFINE time.d DIMENSION TEXT
DEFINE sales VARIABLE DECIMAL &lt;time.d geog.d&gt;
DEFINE f_modified_sales FORMULA DECIMAL &lt;time.d geog.d&gt;
  EQ sales+20
 
</pre>
<p>A report of <code>sales</code>, shows the base values.</p>
<pre>
               -------------------SALES-------------------
               ------------------TIME.D-------------------
GEOG.D          Jan2004    Feb2004    Mar2004      2004
-------------- ---------- ---------- ---------- ----------
Boston               4.00       4.66       5.91       NA
Medford              4.37       5.80       4.45       NA
San Diego            4.97       5.95       4.75       NA
Sunnydale            5.85       5.26       4.08       NA
</pre>
<p>A report of <code>f_modified_sales</code> formula displays the following report that contains the values computed by the formula.</p>
<pre>
               -------------F_MODIFIED_SALES--------------
               ------------------TIME.D-------------------
GEOG.D          Jan2004    Feb2004    Mar2004      2004
-------------- ---------- ---------- ---------- ----------
Boston              24.00      24.66      25.91         NA
Medford             24.37      25.80      24.45         NA
San Diego           24.97      25.95      24.75         NA
Sunnydale           25.85      25.26      24.08         NA
</pre>
<p>The <code>f_modified_sales</code> formula does not presently have an Assign trigger on it. Consequently, as illustrated in the following code, any attempt to assign values to <code>f_modified_sales</code> results in an error.</p>
<pre>
f_modified_sales = 3
ORA-34142: You cannot assign values to a FORMULA.
</pre>
<p>To create an Assign trigger on <code>f_modified_sales</code> take the following steps:</p>
<ol>
<li>
<p>Define the trigger program</p>
<pre>
DEFINE TRIGGER_ASSIGN_MODIFIED_SALES PROGRAM
PROGRAM
ARGUMENT datavalue NUMBER
SHOW 'description of triggering object = '
DESCRIBE &amp;TRIGGER(NAME)
SHOW JOINCHARS ('calltype = ' CALLTYPE)
SHOW JOINCHARS ('triggering event = ' TRIGGER(EVENT))
SHOW JOINCHARS ('value being assigned = ' datavalue)
SHOW '  '
END
 
</pre></li>
<li>
<p>Add the Assign trigger to the definition of the formula using the following statements.</p>
<pre>
CONSIDER f_modified_sales
TRIGGER ASSIGN trigger_assign_modified_sales
 
</pre>
<p>Issuing a <code>FULLDSC f_modified_sales</code> statement displays the new complete definition for <code>f_modified_sales</code>.</p>
<pre>
DEFINE F_MODIFIED_SALES FORMULA DECIMAL &lt;TIME.D GEOG.D&gt;
TRIGGER ASSIGN TRIGGER_ASSIGN_MODIFIED_SALES
EQ sales+20
</pre></li>
<li>
<p>Now when you issue the following statement to assign a value to <code>f_modified_sales</code>, an error does not occur. Instead, the <code>trigger_assign_modified_sales</code> trigger program executes 16 times, once for each dimension value of <code>sales</code>.</p>
<pre>
f_modified_sales = 3
 
description of triggering object = 
DEFINE F_MODIFIED_SALES FORMULA DECIMAL &lt;TIME.D GEOG.D&gt;
TRIGGER ASSIGN TRIGGER_ASSIGN_MODIFIED_SALES
EQ sales+20
calltype = TRIGGER
triggering event = ASSIGN
value being assigned = 3.00
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
... 
description of triggering object = 
...
 
</pre></li>
<li>
<p>However, as issuing a REPORT statement for <code>f_modified_sales</code> illustrates, the values calculated by a simple execution of the formula have not changed.</p>
<pre>
report f_modified_sales

               -------------F_MODIFIED_SALES--------------
               ------------------TIME.D-------------------
GEOG.D          Jan2004    Feb2004    Mar2004      2004
-------------- ---------- ---------- ---------- ----------
Boston              24.00      24.66      25.91         NA
Medford             24.37      25.80      24.45         NA
San Diego           24.97      25.95      24.75         NA
Sunnydale           25.85      25.26      24.08         NA
</pre></li>
</ol>
</div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3088">
<tr>
<td class="cellalignment3095">
<table class="cellalignment3093">
<tr>
<td class="cellalignment3092"><a href="dml_commands_2065.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3092"><a href="dml_commands_2067.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3097">
<table class="cellalignment3091">
<tr>
<td class="cellalignment3092"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3092"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3092"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3092"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3092"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3092"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
