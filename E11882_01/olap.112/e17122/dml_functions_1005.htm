<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>AGGREGATE function</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 742" />
<meta name="dcterms.created" content="2013-11-14T21:21:9Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="OLAP DML Reference" />
<meta name="dcterms.identifier" content="E17122-08" />
<meta name="dcterms.isVersionOf" content="OLADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="dml_functions_1004.htm" title="Previous" type="text/html" />
<link rel="Next" href="dml_functions_1006.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17122.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">146/593</span> <!-- End Header --><a id="i78750"></a>
<hr />
<div id="OLADM465" class="refsect1">
<h1 class="refsect1">AGGREGATE function</h1>
<p><a id="ABC1198038"></a>The AGGREGATE function calculates the data in the variable that is <span class="italic">not</span> specified as PRECOMPUTE in the specified aggmap.&nbsp;(For information about specifying precompute data, see <a href="dml_commands_1006.htm#BCFJGIGI">PRECOMPUTE</a> statement and the PRECOMPUTE clause of the <a href="dml_commands_1006.htm#i1017474">RELATION (for aggregation)</a> statement.) The aggregation is limited to those values that are currently in status.</p>
<div class="infoboxnotealso">
<p class="notep1">See also:</p>
<a href="dml_commands_1009.htm#i78745">AGGREGATE command</a></div>
<div class="infobox-note">
<p class="notep1">Note:</p>
When the variable you want to aggregate has an <a href="dml_properties001.htm#g1065884">$AGGMAP</a> property, you do not have to use the AGGREGATE function to aggregate the data that has not been precomputed.</div>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1441"></a>Return Value</p>
<p>The same data type as the aggregated variable.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1442"></a>Syntax</p>
<p class="synopsis">AGGREGATE&nbsp;(<span class="italic">var</span> ... [USING&nbsp;<span class="italic">aggmap</span>] -</p>
<p class="synopsis">[FROM <span class="italic">fromspec</span>|FROMVAR <span class="italic">textvar</span>]&nbsp;[FORCECALC FORCEORDER]&nbsp;[COUNTVAR&nbsp;<span class="italic">countvar</span>])</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1443"></a>Parameters</p>
<dl>
<dt><span class="italic">var</span></dt>
<dd>
<p>The name of the variable whose data is calculated (if necessary) and returned.</p>
</dd>
<dt>USING</dt>
<dd>
<p>This keyword indicates that the aggregation is performed using the specified aggmap.</p>
</dd>
<dt><span class="italic">aggmap</span></dt>
<dd>
<p>The name of a previously-defined aggmap that specifies how the data is aggregated. For information about aggmaps, see <a href="dml_commands_1032.htm#i78488">DEFINE AGGMAP</a>.</p>
</dd>
<dt>FROM</dt>
<dd>
<p>This keyword indicates that the detail data is obtained from a different object. A FROM clause is only one way in which you can specify the variable from which detail data should be obtained when performing aggregation. See <a href="dml_commands_1009.htm#i1013876">"Ways of Specifying Where to Obtain Detail Data for Aggregation"</a>.</p>
</dd>
<dt><span class="italic">fromspec</span></dt>
<dd>
<p>An arbitrarily dimensioned variable, formula, or relation from which the detail data for the aggregation is obtained.</p>
</dd>
<dt>FROMVAR</dt>
<dd>
<p>This keyword indicates that the detail data is obtained from different objects to perform a capstone aggregation. A FROMVAR clause is only one way in which you can specify the variable from which detail data should be obtained when performing aggregation. See <a href="dml_commands_1009.htm#i1013876">"Ways of Specifying Where to Obtain Detail Data for Aggregation"</a>.</p>
</dd>
<dt><span class="italic">textvar</span></dt>
<dd>
<p>An arbitrarily dimensioned variable used to resolve any leaf nodes. Specify <code>NA</code> to indicate that a node does not need detail data to calculate the value.</p>
</dd>
<dt>FORCECALC</dt>
<dd>
<p>Specifies that any value that is not specified in a PRECOMPUTE clause of a RELATION statement that is in the aggmap should be recalculated, even when there is a value stored in the desired cell. Use the FORCECALC keyword when you want users to be able to change detail data cells and see the changed values reflected in dynamically-computed aggregate cells.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also set an $AGGREGATE_FORCECALC property on a variable to specify this behavior as the default aggregation behavior. In this case, you do not have to include the FORCECALC keyword with the AGGREGATE function.</div>
</dd>
<dt>FORCEORDER</dt>
<dd>
<p>Specifies that the calculation must be performed in the order in which the RELATION statements are listed in the aggmap. Use this option when you have changed some values calculated by the AGGREGATE command. Otherwise, the optimization methods used by the AGGREGATE function may cause the modified values to be ignored. FORCEORDER slows performance.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also set an $AGGREGATE_FORCEORDER property on a variable to specify this behavior as the default aggregation behavior. In this case, you do not have to include the FORCEORDER keyword with the AGGREGATE function.</div>
</dd>
<dt>COUNTVAR <span class="italic">countvar</span></dt>
<dd>
<p>Indicates that Oracle OLAP should use the user-defined variable specified by <span class="italic">countvar</span> to store the non-<code>NA</code> counts of the number of leaf nodes that contributed to aggregate values calculated for RELATION (for aggregation) statements that have an AVERAGE, HAVERAGE, HWAVERAGE, or WAVERAGE operator.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Typically, you do <span class="italic">not</span> use a user-defined Countvar variable to store the counts for average aggregations. Instead, you use an Oracle OLAP-created Aggcount variable. You <span class="italic">must</span> use an Aggcount variable when the aggregation specification includes a RELATION (for aggregation) statement with an average operator that is for a compressed composite.
<p>For more information on Aggcount variables, see <a href="dml_commands_1032.htm#CIHFEAGE">"Aggcount Variables"</a>.</p>
</div>
<p>The <span class="italic">countvar</span> variable must be an <code>INTEGER</code> variable with the same dimensions in the same order as the dimensions of the variable specified by <span class="italic">var</span>. When you aggregate several variables together, you must define an <code>INTEGER</code> variable for each one to record the results.</p>
</dd>
</dl>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1444"></a>Usage Notes</p>
<p class="subhead2"><a id="OLADM1488"></a>Steps for Supporting Run-Time Calculations</p>
<p>Follow these steps when combining pre-aggregation with run-time aggregation:</p>
<ol>
<li>
<p>Create an aggmap that limits the amount of data to be precalculated.</p>
</li>
<li>
<p>Execute the AGGREGATE command with the FUNCDATA argument.</p>
</li>
<li>
<p>When you have made any changes after executing the AGGREGATE command (see <a href="#i79892">"Compiling the Aggmap"</a>), recompile the aggmap with a COMPILE statement.</p>
</li>
<li>
<p>Add an $AGGREGATE_FROM property to the data variables (see <a href="#i79901">"Using NA Values to Trigger Run-Time Calculations"</a>).</p>
</li>
<li>
<p>UPDATE and COMMIT the analytic workspace.</p>
</li>
</ol>
<p class="subhead2"><a id="i79892"></a><a id="OLADM1489"></a>Compiling the Aggmap</p>
<p>Be sure to compile the aggmap at the time you load data, either with an explicit COMPILE statement or with the FUNCDATA argument to the AGGREGATE command. Otherwise, the aggmap is recompiled at run time for each session in which the AGGREGATE function is used. Perform other calculations (such as calculating models) before you compile the aggmap.</p>
<p>You must recompile the aggmap after maintaining any of the dimensions in the aggmap definition or any of the relations that are included in the text of the aggmap.</p>
<p class="subhead2"><a id="OLADM1490"></a>Run-Time Changes to Data Values</p>
<p>When users are able to change data values at run time, then the data may get out of synchronization. You can prevent this problem in the following ways:</p>
<ul>
<li>
<p>Use an ALLOCATE statement to distribute the data in a new aggregate to the contributing values lower in the hierarchy.</p>
</li>
<li>
<p>Do not precalculate the data that is subject to run-time changes because the stored aggregates cannot be altered to reflect changes made at run time to the contributing values.</p>
</li>
</ul>
<p class="subhead2"><a id="i79901"></a><a id="OLADM1491"></a>Using NA Values to Trigger Run-Time Calculations</p>
<p>By adding an $NATRIGGER property to a variable, you can implicitly call the AGGREGATE function each time the data is queried. The following statements cause <code>sales</code> data to be aggregated using the <code>sales.aggmap</code> aggmap.</p>
<pre>
CONSIDER sales
PROPERTY '$NATRIGGER' 'AGGREGATE(sales USING sales.aggmap)'
</pre>
<p>From now on, a statement such as <code>REPORT</code> <code>SALES</code> executes the AGGREGATE function, so that computed values are returned instead of NAs.</p>
<p class="subhead2"><a id="OLADM1492"></a>Using the AGGREGATE Function after Partial Rollups</p>
<p>When your batch window is not sufficiently long to preaggregate all of the data to generate, you can perform the aggregation in stages on consecutive days and use the AGGREGATE function to calculate the balance. For each stage, you must do the following:</p>
<ol>
<li>
<p>Change the PRECOMPUTE phrase of the RELATION statement in the aggmap so that new data is aggregated.</p>
</li>
<li>
<p>Execute the AGGREGATE command with the FUNCDATA keyword.</p>
</li>
<li>
<p>Verify that the $NATRIGGER property is set on the variables so that the AGGREGATE function calculates the balance of the data.</p>
</li>
</ol>
<p class="subhead2"><a id="OLADM1493"></a>Using Multiple Aggmaps</p>
<p>Whenever possible, use only one aggmap to rollup a variable. However, in some situations, a variable requires multiple aggmaps to roll up the data in the desired manner. When a variable requires multiple aggmaps to rollup data problems are created when some data is calculated on the fly, because the metadata retained for the AGGREGATE function corresponds to the last aggmap. The AGGREGATE function needs metadata that is the union of all of the aggmaps used by the AGGREGATE command. The solution is to create an additional aggmap for use by the AGGREGATE function that correctly identifies the <code>NA</code> values. Be sure to compile this aggmap.</p>
<p>Do not use the AGGREGATE function with multiple aggmaps unless you feel comfortable answering the following question:</p>
<dl>
<dd>When the aggmap is compiled for use by the AGGREGATE function, does the status that results from each PRECOMPUTE clause accurately define the nodes within that dimension at which data has been pre-computed?</dd>
</dl>
<p><a id="i1026088"></a>When you cannot answer "yes" to this question with confidence, do not use the AGGREGATE function with multiple aggmaps.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1445"></a>Examples</p>
<p>This section contains several examples of using the AGGREGATE function. For additional aggregation examples, see the examples for the <a href="dml_commands_1006.htm#i1032719">AGGMAP</a> command.</p>
<div id="OLADM1494" class="example">
<p class="titleinexample"><a id="sthref1446"></a>Example 7-5 Using the AGGREGATE Function as the Formula of an Expression</p>
<p><a id="sthref1447"></a><a id="sthref1448"></a><a href="dml_commands_1009.htm#BCFIGIJJ">Example 9-32, "Capstone Aggregation"</a> illustrates performing the final capstone aggregation using an AGGREGATE command. You could also perform the capstone aggregation at run time as the expression of a formula.</p>
<p>Assume that your analytic workspace contains the following object definitions.</p>
<pre>
DEFINE GEOG.D DIMENSION TEXT
DEFINE GEOG.PARENTREL RELATION GEOG.D &lt;GEOG.D&gt;
DEFINE TIME.D DIMENSION TEXT
DEFINE TIME.PARENTREL RELATION TIME.D &lt;TIME.D&gt;
DEFINE SALES_JAN76 VARIABLE INTEGER &lt;GEOG.D&gt;
DEFINE SALES_FEB76 VARIABLE INTEGER &lt;GEOG.D&gt;
DEFINE SALES_MAR76 VARIABLE INTEGER &lt;GEOG.D&gt;
DEFINE SALES_CAPSTONE76 VARIABLE INTEGER &lt;GEOG.D TIME.D&gt;
DEFINE CAPSTONE_SOURCE VARIABLE TEXT &lt;TIME.D&gt;
</pre>
<p>Now you create two aggmap objects with the following definitions. Note that in this case the <code>capstone_aggmap</code> consists of a RELATION statement with a <code>PRECOMPUTE NA</code> clause.</p>
<pre>
DEFINE LEAF_AGGMAP AGGMAP
AGGMAP
RELATION geog.parentrel OPERATOR SUM
END
 
DEFINE CAPSTONE_AGGMAP AGGMAP
AGGMAP
RELATION time.parentrel OPERATOR SUM PRECOMPUTE (NA)
END
</pre>
<p>In <a href="dml_commands_1009.htm#BCFIGIJJ">Example 9-32, "Capstone Aggregation"</a>, the final capstone aggregation is performed using an AGGREGATE command. In this example, the capstone aggregation is defined as a formula named <code>f_sales_capstone76</code> that has an AGGREGATE function as the expression of the formula.</p>
<pre>
DEFINE F_SALES_CAPSTONE76 FORMULA INTEGER &lt;GEOG.D TIME.D&gt;
EQ AGGREGATE ( sales_capstone76 USING capstone_aggmap fromvar capstone_source)
 
</pre>
<p>When you report on the unaggregated variables and formulas in your analytic workspace, you see the following results.</p>
<pre>
GEOG.D          SALES_JAN76    SALES_FEB76    SALES_MAR76
-------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000
Medford                 2,000          4,000          6,000
San Diego               3,000          6,000          9,000
Sunnydale               4,000          8,000         12,000
Massachusetts              NA             NA             NA
California                 NA             NA             NA
United States              NA             NA             NA
 
               --------------------F_SALES_CAPSTONE76---------------------
               --------------------------TIME.D---------------------------
GEOG.D             Jan76          Feb76          Mar76           76Q1
-------------- -------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000          6,000
Medford                 2,000          4,000          6,000         12,000
San Diego               3,000          6,000          9,000         18,000
Sunnydale               4,000          8,000         12,000         24,000
Massachusetts              NA             NA             NA             NA
California                 NA             NA             NA             NA
United States              NA             NA             NA             NA
 
               ---------------------SALES_CAPSTONE76----------------------
               --------------------------TIME.D---------------------------
GEOG.D             Jan76          Feb76          Mar76           76Q1
-------------- -------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000             NA
Medford                 2,000          4,000          6,000             NA
San Diego               3,000          6,000          9,000             NA
Sunnydale               4,000          8,000         12,000             NA
Massachusetts              NA             NA             NA             NA
California                 NA             NA             NA             NA
United States              NA             NA             NA             NA
 
</pre>
<p>Now you aggregate the leaf variables using the following AGGREGATE statement.</p>
<pre>
AGGREGATE sales_jan76 sales_feb76 sales_mar76 USING leaf_aggmap
</pre>
<p>A report of the leaf variables shows that they are aggregated.</p>
<pre>
GEOG.D          SALES_JAN76    SALES_FEB76    SALES_MAR76
-------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000
Medford                 2,000          4,000          6,000
San Diego               3,000          6,000          9,000
Sunnydale               4,000          8,000         12,000
Massachusetts           3,000          6,000          9,000
California              7,000         14,000         21,000
United States          10,000         20,000         30,000
</pre>
<p>A report of the <code>f_sales_capstone76</code> formula shows the aggregated values for <code>76Q1</code>.</p>
<pre>
               --------------------F_SALES_CAPSTONE76---------------------
               --------------------------TIME.D---------------------------
GEOG.D             Jan76          Feb76          Mar76           76Q1
-------------- -------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000          6,000
Medford                 2,000          4,000          6,000         12,000
San Diego               3,000          6,000          9,000         18,000
Sunnydale               4,000          8,000         12,000         24,000
Massachusetts           3,000          6,000          9,000         18,000
California              7,000         14,000         21,000         42,000
United States          10,000         20,000         30,000         60,000
</pre>
<p>While a report of the <code>sales_capstone76</code> variable does not show the aggregated values for <code>76Q1</code> because they are not stored in the variable.</p>
<pre>
               ---------------------SALES_CAPSTONE76----------------------
               --------------------------TIME.D---------------------------
GEOG.D             Jan76          Feb76          Mar76           76Q1
-------------- -------------- -------------- -------------- --------------
Boston                  1,000          2,000          3,000             NA
Medford                 2,000          4,000          6,000             NA
San Diego               3,000          6,000          9,000             NA
Sunnydale               4,000          8,000         12,000             NA
Massachusetts           3,000          6,000          9,000             NA
California              7,000         14,000         21,000             NA
United States          10,000         20,000         30,000             NA
</pre></div>
<!-- class="example" -->
<div id="OLADM1495" class="example">
<p class="titleinexample"><a id="sthref1449"></a>Example 7-6 Aggregating Data on the Fly for a Report</p>
<p>The <code>units</code> variable is aggregated entirely on the fly using the <code>tp.agg</code> aggmap.</p>
<p>This is the object definitions for the variable <code>units</code>.</p>
<pre>
DEFINE units VARIABLE INTEGER &lt;time product&gt;
</pre>
<p>The parent relation for <code>time</code> contains these values.</p>
<pre>
      ---TIME.PARENTREL----
      --TIME.HIERARCHIES---
TIME       STANDARD   YTD
---------- ---------- ----------
Jan01      Q1.01      Last.Ytd
Feb01      Q1.01      Last.Ytd
Mar01      Q1.01      Last.Ytd
Q1.01      2001       NA
</pre>
<p>The parent relation for the <code>product</code> dimension contains these values.</p>
<pre>
    PRODUCT.PA
PRODUCT    RENTREL
---------- ----------
Food       Na
Snacks     Food
Drinks     Food
Popcorn    Snacks
Cookies    Snacks
Cakes      Snacks
Soda       Drinks
Juice      Drinks
</pre>
<p>In the <code>units</code> variable, data is stored only at the lowest level of each dimension hierarchy.</p>
<pre>
  -------------------UNITS-------------------
  -------------------TIME--------------------
PRODUCT     Jan01      Feb01      Mar01      Q1.01
----------- ---------- ---------- ---------- ----------
Food        NA         NA         NA         NA
Snacks      NA         NA         NA         NA
Drinks      NA         NA         NA         NA
Popcorn     2          2          4          NA
Cookies     3          6          3          NA
Cakes       4          4          2          NA
Soda        7          3          9          NA
Juice       1          3          2          NA
</pre>
<p>The aggmap specifies that all data is calculated on the fly.</p>
<pre>
DEFINE tp.agg AGGMAP
LD &lt;time product&gt; Aggmap
AGGMAP
RELATION time.parentrel PRECOMPUTE (NA)
RELATION product.parentrel PRECOMPUTE (NA)
END
</pre>
<p>The following REPORT statement uses the AGGREGATE function to calculate the data.</p>
<pre>
REPORT aggregate(units USING tp.agg)

  -------AGGREGATE(UNITS USING TP.AGG)-------
  -------------------TIME--------------------
PRODUCT     Jan01      Feb01      Mar01      Q1.01
----------- ---------- ---------- ---------- ----------
Food        17         18         20         55
Snacks       9         12          9         30
Drinks       8          6         11         25
Popcorn      2          2          4          8
Cookies      3          6          3         12
Cakes        4          4          2         10
Soda         7          3          9         19
Juice        1          3          2          6
</pre></div>
<!-- class="example" -->
<div id="OLADM1496" class="example">
<p class="titleinexample"><a id="sthref1450"></a>Example 7-7 Using $NATRIGGER to Aggregate Data</p>
<p>When the AGGREGATE function is added to <code>units</code> in the $NATRIGGER property, a simple REPORT statement displays aggregated results.</p>
<pre>
CONSIDER units
PROPERTY '$NATRIGGER' 'AGGREGATE(units USING tp.agg)'
REPORT units
 
  -------------------UNITS-------------------
  -------------------TIME--------------------
PRODUCT     Jan01      Feb01      Mar01      Q1.01
----------- ---------- ---------- ---------- ----------
Food        17         18         20         55
Snacks       9         12          9         30
</pre></div>
<!-- class="example" -->
<div id="OLADM1497" class="example">
<p class="titleinexample"><a id="i1026039"></a>Example 7-8 Calculating all but one Value on the Fly</p>
<p>The AGGREGATE function calculates the complement of the data specified in the PRECOMPUTE clause of the RELATION statement. It returns those values that are currently in status.</p>
<p>For example, when you are using an aggmap that contains this RELATION statement.</p>
<pre>
RELATION letter.letter PRECOMPUTE ('AA')
</pre>
<p>Then the AGGREGATE function calculates all aggregations <span class="italic">except</span> <code>AA</code>, as shown here<a id="sthref1451"></a>.</p>
<pre>
REPORT AGGREGATE(units USING letter.aggmap)

                 AGGREGATE(UNITS
LETTER         USING LETTER.AGGMAP)
-------------- --------------------
A                                 3
AA                               NA
AB                                3
AAB                               2
ABA                               1
ABB                               2
AAAA                              1
AABA                              2
ABAA                              1
ABBB                              1
ABBA                              1
...
</pre></div>
<!-- class="example" --></div>
<!-- class="refsubsect" --></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment3088">
<tr>
<td class="cellalignment3095">
<table class="cellalignment3093">
<tr>
<td class="cellalignment3092"><a href="dml_functions_1004.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment3092"><a href="dml_functions_1006.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment3097">
<table class="cellalignment3091">
<tr>
<td class="cellalignment3092"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment3092"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment3092"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment3092"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment3092"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment3092"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
