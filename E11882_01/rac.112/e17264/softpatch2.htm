<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Managing Oracle Software and Applying Patches</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023" />
<meta name="dcterms.created" content="2014-07-11T15:26:29Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + Real Application Clusters Guide" />
<meta name="dcterms.identifier" content="E17264-15" />
<meta name="dcterms.isVersionOf" content="TDPRC" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="rac_glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="addnodes.htm" title="Previous" type="text/html" />
<link rel="Next" href="rac_glossary.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17264.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">14/16</span> <!-- End Header -->
<div id="TDPRC404" class="chapter"><a id="CHDCHIJG"></a>
<h1 class="chapter"><span class="secnum">10</span> Managing Oracle Software and Applying Patches</h1>
<p><a id="sthref570"></a>Oracle issues product fixes for its software called patches. When you apply the patch to your Oracle software installation, it updates the executable files, libraries, and object files in the software home directory. The patch application can also update configuration files and Oracle-supplied SQL schemas. Patches are applied by using OPatch, a utility supplied by Oracle, or Enterprise Manager Grid Control.</p>
<p><a id="sthref571"></a>A group of patches form a patch set. When you apply a patch set, many different files and utilities are modified. This results in a version change for your Oracle software, for example, from Oracle Database 10.2.0.4.0 to Oracle Database 10.2.0.5.0. You use Oracle Universal Installer (OUI) to apply a patch set.</p>
<p>This chapter describes how to manage Oracle software and apply patches in Oracle Real Application Clusters (Oracle RAC) environments using the OPatch utility.</p>
<p>This chapter includes the following sections:</p>
<ul>
<li>
<p><a href="#BABFFEDG">Obtaining the Patch</a></p>
</li>
<li>
<p><a href="#BABBDEJC">Preparing to Use OPatch</a></p>
</li>
<li>
<p><a href="#BABHFJBE">Applying Patches</a></p>
</li>
<li>
<p><a href="#CHDCAJCH">Applying Patch Sets</a></p>
</li>
<li>
<p><a href="#CEGJJEAG">Troubleshooting Patch Deployment</a></p>
</li>
<li>
<p><a href="#BABFAFEB">Upgrading the Oracle Software</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a> for more information about using OPatch and applying patches to Oracle RAC</p>
</li>
<li>
<p><a class="olink ADMQS111" href="../../server.112/e10897/software.htm#ADMQS111"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
</ul>
</div>
<a id="BABFFEDG"></a>
<div id="TDPRC528" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Obtaining the Patch</h2>
<p><a id="sthref572"></a>You obtain patches and patch sets from My Oracle Support, which is the Oracle Support Services Web site, at</p>
<p><code><a href="https://support.oracle.com">https://support.oracle.com</a></code></p>
<p class="subhead2"><a id="TDPRC602"></a>To locate patches on the My Oracle Support Web site:</p>
<ol>
<li>
<p>Log in to your account on My Oracle Support.</p>
</li>
<li>
<p>At the top of the page, on the left side, select <span class="gui-object-action">Patches &amp; Updates</span>.</p>
</li>
<li>
<p>If you know the patch number, then you can enter it into the field to the right of the Patch Name or Number drop-down list. Next to the Platform drop-down list, use the <span class="gui-object-action">Select up to 5</span> drop-down list to choose the operating systems on which you plan to apply the patch.</p>
<p>If you want to search for all available patches for your system, then select <span class="gui-object-action">Product or Family (Advanced Search)</span> at the top of the page. Then supply the following information:</p>
<ul>
<li>
<p>Choose the products you want to patch (for example, Oracle Clusterware, RDMBS Server, or an individual product such as Universal Installer)</p>
</li>
<li>
<p>Specify the software release for the products you selected</p>
</li>
<li>
<p>Specify the platform on which the software is installed</p>
</li>
</ul>
<p>Click <span class="gui-object-action">Search</span> to look for available patches. The Patch Search Results page is displayed.</p>
</li>
<li>
<p>On the Patch Search Results page, select the number of the patch you want to download. A details page for that patch appears on your screen.</p>
</li>
<li>
<p>View the ReadMe file for the patch, or click Download to download the patch to your local computer. If you download the patch to a computer that is not a node in the cluster, then you must transfer the file using a binary protocol to a cluster node.</p>
<p><a id="sthref573"></a>You can also choose to add the patch to your current patch plan or create a new patch plan. A <span class="italic">patch plan</span> is a collection of patches that you want to apply as a group. To learn more about using patch plans, in the Add to Plan drop-down list select <span class="gui-object-action">Why use a Plan?</span></p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="install_rac.htm#BABIJDBA">"Verifying My Oracle Support Credentials"</a></p>
</li>
<li>
<p><a href="install_rac.htm#CBHHBCBI">"About Downloading and Installing RDBMS Patches"</a></p>
</li>
<li>
<p><a class="olink ADMQS111" href="../../server.112/e10897/software.htm#ADMQS111"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABBDEJC"></a>
<div id="TDPRC422" class="sect1">
<h2 class="sect1">Preparing to Use OPatch</h2>
<p><a id="sthref574"></a>Before you apply the patch to your Oracle RAC database, your Oracle ASM installation, or to your Oracle Clusterware installation, you must prepare the operating system environment and stage the patch locally.</p>
<p>The following section describe the steps to perform in preparation for using OPatch:</p>
<ul>
<li>
<p><a href="#BABCHEGA">Checking the ORACLE_HOME Environment Variable</a></p>
</li>
<li>
<p><a href="#BABDBGIA">Performing a Backup Before Patching Software</a></p>
</li>
<li>
<p><a href="#BABFJAEI">Staging the Patch on Each Node</a></p>
</li>
<li>
<p><a href="#BABFJBCG">Updating the PATH Environment Variable</a></p>
</li>
<li>
<p><a href="#BABFFHBE">Configuring SSH User Equivalency</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMQS1100" href="../../server.112/e10897/software.htm#ADMQS1100"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
</ul>
</div>
<a id="BABCHEGA"></a>
<div id="TDPRC423" class="sect2">
<h3 class="sect2">Checking the ORACLE_HOME Environment Variable</h3>
<p>OPatch verifies if the Oracle home is present. You must ensure that the <code>ORACLE_HOME</code> environment variable is set to the Oracle home of the product you are trying to patch.</p>
<p>Check the respective vendor documentation for the details to set the environment variable.</p>
<p class="subhead2"><a id="TDPRC424"></a>To check the current setting of the <code><span class="codeinlinebold">ORACLE_HOME</span></code> variable on Linux:</p>
<ol>
<li>
<p>In a command window, log in to the operating system as the <code>oracle</code> user.</p>
</li>
<li>
<p>Use the <code>echo</code> command to display the current setting of the <code>ORACLE_HOME</code> environment variable.</p>
<pre>
echo $ORACLE_HOME
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="install_rac.htm#CBHEDIIA">"Configuring the Operating System Environment"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABDBGIA"></a>
<div id="TDPRC425" class="sect2">
<h3 class="sect2">Performing a Backup Before Patching Software</h3>
<p><a id="sthref575"></a><a id="sthref576"></a>It is highly recommended to back up the software directory you are patching before performing any patch operation. This applies to Oracle Database or Oracle Grid Infrastructure software installation directories.</p>
<p class="subhead2"><a id="TDPRC426"></a>To back up the software installation:</p>
<ol>
<li>
<p>Back up the software installed in the specified Oracle home using:</p>
<ol>
<li>
<p>An operating system utility, such as <code>zip</code>, <code>cp -r</code>, <code>tar</code>, or <code>cpio</code>, to back up the software in the Oracle home directory to disk.</p>
</li>
<li>
<p>The Oracle Secure Backup utility to back up the software in the Oracle home directory to tape.</p>
</li>
</ol>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="install_rac.htm#CBHEDIIA">"Configuring the Operating System Environment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABFJAEI"></a>
<div id="TDPRC427" class="sect2">
<h3 class="sect2">Staging the Patch on Each Node</h3>
<p>After you down the patch from My Oracle Support, you must copy the patch to each node that runs the software being patched.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a class="olink ADMQS111" href="../../server.112/e10897/software.htm#ADMQS111"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABFJBCG"></a>
<div id="TDPRC428" class="sect2">
<h3 class="sect2">Updating the PATH Environment Variable</h3>
<p>The <code>opatch</code> binary file is located in the <code><span class="italic">Oracle_home</span>/OPatch</code> directory. You can either specify this path when executing OPatch, or you can update the <code>PATH</code> environment variable to include the <code>OPatch</code> directory.</p>
<p class="subhead2"><a id="TDPRC429"></a>To update the PATH environment variable on Oracle Linux systems:</p>
<ol>
<li>
<p>In a command window, log in to the operating system.</p>
</li>
<li>
<p>Use a shell command similar to the following to update the value of the PATH environment variable, where <code>/u01/app/oracle/product/11.2.0/dbhome_1</code> is the location of your Oracle home directory:</p>
<pre>
$ export PATH=$PATH:/u01/app/oracle/product/11.2.0/dbhome_1/OPatch
</pre>
<p>You could also modify the shell profile script for the current user to have this variable configured every time you log in.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="install_rac.htm#CBHEDIIA">"Configuring the Operating System Environment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABFFHBE"></a>
<div id="TDPRC430" class="sect2">
<h3 class="sect2">Configuring SSH User Equivalency</h3>
<p><a id="sthref577"></a>Before you patch a system, make sure the user equivalency is working. User equivalency exists when the operating system user on each node is considered to be identical. For information on configuring user equivalency, see <a href="preparing.htm#BCGFEGIF">"Configuring Operating System Users and Groups"</a>.</p>
<p class="subhead2"><a id="TDPRC431"></a>To test SSH user equivalency:</p>
<ol>
<li>
<p>On the system where you want to run OPatch, log in as the <code>oracle</code> user.</p>
</li>
<li>
<p>Use the following command to test user equivalency:</p>
<pre>
[oracle@racnode1] $ ssh racnode2 date
</pre>
<p>If the date is returned, then user equivalency between the source and destination node has been configured.</p>
</li>
<li>
<p>If you see output similar to the following, then SSH user equivalency is not enabled:</p>
<pre>
Enter passphrase for key '/home/oracle/.ssh/id_rsa': 
</pre>
<p>Enable SSH user equivalency before continuing with the patching operation.</p>
</li>
</ol>
<p class="subhead2"><a id="TDPRC432"></a>To enable SSH user equivalency:</p>
<ol>
<li>
<p>On the system where you want to run OPatch, open a command window and log in as the <code>oracle</code> user.</p>
</li>
<li>
<p>Start the SSH agent and load the SSH keys into memory using the following commands:</p>
<pre>
$ /usr/bin/ssh-agent $SHELL
$ /usr/bin/ssh-add
</pre>
<p>These commands start the <code>ssh-agent</code> on the local node, and load the RSA and DSA keys into the current session's memory so that you are not prompted to use pass phrases when issuing SSH commands.</p>
</li>
<li>
<p>At the prompt, enter the pass phrase for each key that you generated when configuring Secure Shell, for example:</p>
<pre>
[oracle@racnode1 .ssh]$ exec /usr/bin/ssh-agent $SHELL
[oracle@racnode1 .ssh]$ /usr/bin/ssh-add
Enter passphrase for /home/oracle/.ssh/id_rsa
Identity added: /home/oracle/.ssh/id_rsa (/home/oracle/.ssh/id_rsa)
Identity added: /home/oracle/.ssh/id_dsa (/home/oracle/.ssh/id_dsa)
</pre></li>
<li>
<p>To test if you have configured SSH correctly, run the following command. If you have configured SSH correctly, then you are not prompted for a password or a pass phrase.</p>
<pre>
[oracle@racnode1] $ ssh racnode2 date
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not close this command window until you have completed the patch installation. If you must close the command window in which you enabled SSH user equivalency before the patch installation is complete, then repeat Step 1 to Step 4 before starting the patch installation.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="preparing.htm#BCGFEGIF">"Configuring Operating System Users and Groups"</a></p>
</li>
<li>
<p><a class="olink CWGEN" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your specific operating system for instructions on how to configure SSH</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABHFJBE"></a>
<div id="TDPRC603" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Applying Patches</h2>
<p><a id="sthref578"></a>Patching in an Oracle RAC environment is slightly different compared to patching a single node. If OPatch detects a cluster, then it uses OUI to query the software inventory to find the local node name and node list.</p>
<p>Before you install a patch, you must stop all the applications running from the software directory that is being patched. In a cluster, you may have to shut down additional applications, depending upon which software is being patched. <a href="#BABEBBDA">Table 10-1</a> lists the applications to stop when patching Oracle software.</p>
<div id="TDPRC604" class="tblhruleformal">
<p class="titleintable"><a id="sthref579"></a><a id="BABEBBDA"></a>Table 10-1 Patching Oracle Home Directories</p>
<table class="cellalignment402" title="Patching Oracle Home Directories" summary="List of applications to stop when patching Oracle software" dir="ltr">
<thead>
<tr class="cellalignment393">
<th class="cellalignment403" id="r1c1-t11">Oracle Home Directory</th>
<th class="cellalignment403" id="r1c2-t11">Applications to Stop</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment393">
<td class="cellalignment399" id="r2c1-t11" headers="r1c1-t11">
<p>Oracle RAC Database</p>
</td>
<td class="cellalignment399" headers="r2c1-t11 r1c2-t11">
<p>Oracle RAC database, Enterprise Manager Database Control, listener, and any other applications that are running from the Oracle RAC home directory</p>
</td>
</tr>
<tr class="cellalignment393">
<td class="cellalignment399" id="r3c1-t11" headers="r1c1-t11">
<p>Oracle Grid Infrastructure</p>
</td>
<td class="cellalignment399" headers="r3c1-t11 r1c2-t11">
<p>Oracle RAC database and all applications running from the Oracle RAC home directory, any single-instance databases that use the same Oracle ASM instance as the cluster database, the Oracle ASM instance, all node applications, Oracle Clusterware, and any other applications that are running from the Grid home directory</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>This section describes the following tasks:</p>
<ul>
<li>
<p><a href="#BABJDBCH">Patching the Grid Home</a></p>
</li>
<li>
<p><a href="#BABJJDBD">All Node Patching</a></p>
</li>
<li>
<p><a href="#BABEBEHC">Rolling Patching</a></p>
</li>
<li>
<p><a href="#BABDHBIA">Minimum Downtime Patching</a></p>
</li>
</ul>
<a id="BABJDBCH"></a>
<div id="TDPRC605" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Patching the Grid Home</h3>
<p><a id="sthref580"></a><a id="sthref581"></a><a id="sthref582"></a>There are two parts to patching the Oracle Grid Infrastructure for a cluster software:</p>
<ul>
<li>
<p>Unlock the Grid home</p>
</li>
<li>
<p>Apply patches to the Grid home</p>
</li>
</ul>
<p>Before you can apply a patch or make other modifications to the software files in the Grid home, you must first unlock the Grid home.</p>
<p class="subhead2"><a id="TDPRC606"></a>To unlock the Grid home, perform the following steps:</p>
<ol>
<li>
<p>Change directory to the path <code><span class="codeinlineitalic">Grid_home</span></code><code>/crs/install</code>, where <code><span class="codeinlineitalic">Grid_home</span></code> is the path to the Grid home, and at the <code>root</code> user unlock the Grid home using commands similar to the following:</p>
<pre>
cd /u01/app/11.2.0/grid/crs/install 
perl rootcrs.pl -unlock -crshome /u01/app/11.2.0/grid
</pre>
<p>When you run the <code>rootcrs.pl</code> script with the <code>-unlock</code> flag, it stops the Oracle Clusterware stack and unlocks the files in the Grid home so they can be modified.</p>
</li>
<li>
<p>Change user to the Oracle Grid Infrastructure for a cluster software owner and apply the patch to the Grid home, using one of the patching methods described in this section.</p>
</li>
<li>
<p>After you have finished modifying the Grid home, lock it again as the <code>root</code> user using commands similar to the following:</p>
<pre>
cd /u01/app/11.2.0/grid/crs/install 
perl rootcrs.pl -patch
</pre>
<p>The <code>rootcrs.pl</code> script with the <code>-patch</code> flag locks the Grid home again and restarts the Oracle Clusterware stack.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABJJDBD"></a>
<div id="TDPRC607" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">All Node Patching</h3>
<p><a id="sthref583"></a><a id="sthref584"></a>In all node patching, all the nodes in the cluster are initially shut down and the patch is applied on all the nodes. After all the nodes have been patched, then the Oracle Clusterware stack and all its registered resources are restarted on each node. This method is typically used for very critical patches and it leads to maximum downtime. OPatch uses this method if the patch cannot be applied in a rolling fashion, and you did not specify the <code>minimize_downtime</code> option.</p>
<p class="subhead2"><a id="TDPRC608"></a>To implement all node patching:</p>
<ol>
<li>
<p>Stop all user applications that use the Oracle home directory being patched.</p>
</li>
<li>
<p>If you are patching only the Oracle RAC home directory, then shut down all Oracle RAC instances on all nodes in the cluster. To shut down all Oracle RAC instances for a cluster database, enter the following command in a command window, where <code><span class="italic">CRS_home</span></code> is the location of the Grid home directory and <code>sales</code> is the name of the database:</p>
<pre>
$ <span class="italic">CRS_home</span>/bin/srvctl stop database -d sales
</pre></li>
<li>
<p>If you are patching the Grid home directory, then you must stop all the Oracle RAC databases for the cluster and all single-instance databases in the cluster that use the ASM installation being patched.</p>
<p>When patching the Grid home directory you can use a single command to stop the Oracle Clusterware stack on all servers in the cluster. This command attempts to gracefully stop resources managed by Oracle Clusterware while attempting to stop the Oracle Clusterware stack. If any resources that Oracle Clusterware manages are still running after you run the <code>crsctl stop cluster</code> command, then the command fails. Use the <code>-f</code> option to unconditionally stop all resources and stop the Oracle Clusterware stack.Use a command similar to the following, where <code><span class="italic">CRS_home</span></code> is the home directory of your Oracle Grid Infrastructure for a cluster installation:</p>
<pre>
$ <span class="italic">CRS_home</span>/crs/bin/crsctl stop cluster -all
</pre></li>
<li>
<p>After you have stopped the database instances and Oracle Clusterware stack on each node in the cluster, use the <code>crsctl</code> utility to verify that all cluster resources have been stopped on each node.</p>
<pre>
$ <span class="italic">Grid_home</span>/bin/crsctl status resource -t
</pre></li>
<li>
<p>Set your current directory to the directory where the patch is located, for example:</p>
<pre>
$ cd <span class="italic">Oracle_home</span>/OPatch/4519934/4519934
</pre></li>
<li>
<p>Make sure the <code>ORACLE_HOME</code> environment variable points to the software directory you want to patch, for example:</p>
<pre>
$ echo $ORACLE_HOME
/u01/app/oracle/product/11.2.0/dbhome_1
</pre></li>
<li>
<p>Run OPatch by entering the following command:</p>
<pre>
opatch apply
 
</pre></li>
<li>
<p>If you applied the patch to the Grid home directory, then restart the Oracle Clusterware stack on all nodes by issuing the following command as the <code>root</code> user on any node, where <span class="italic">Grid_home</span> is the home directory of your Oracle Grid Infrastructure for a cluster installation:</p>
<pre>
# <span class="italic">Grid_home</span>/bin/crsctl start cluster -all
</pre></li>
<li>
<p>After you have restarted the Oracle Clusterware stack on all nodes, use the <code>crsctl</code> utility to verify that the cluster resources were restarted on each node.</p>
<pre>
$ <span class="italic">Grid_home</span>/bin/crsctl status resource -t
</pre>
<p>If any of the cluster resources did not restart, then use either the CRSCTL or SRVCTL utility to restart them. For example, you can use commands similar the following to restart various cluster resources, where <code><span class="italic">Grid_home</span></code> is the home directory of your Oracle Grid Infrastructure for a cluster installation and <code><span class="codeinlineitalic"><span class="italic">Oracle_home</span></span></code> is the home directory of your Oracle RAC database:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl start instance -d sales -i "sales1"
# <span class="italic">Grid_home</span>/bin/crsctl start resource myResource -n docrac2
</pre></li>
<li>
<p>Run any post-patch scripts that are mentioned in the patch instructions, for example:</p>
<pre>
$ sqlplus /nolog 
SQL&gt; connect sys/<span class="italic">password</span>@sales1 AS SYSDBA
SQL&gt; @<span class="italic">Oracle_home</span>/rdbms/admin/catbundle.sql cpu apply
SQL&gt; exit
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFFEDG">"Obtaining the Patch"</a></p>
</li>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="#BABHFJBE">"Applying Patches"</a></p>
</li>
<li>
<p><a href="#CHDCAJCH">"Applying Patch Sets"</a></p>
</li>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG334" href="../../em.112/e12255/oui7_opatch.htm#OUICG334"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
<li>
<p><a class="olink RACAD" href="../e41960/toc.htm"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about SRVCTL commands</p>
</li>
<li>
<p><a class="olink CWADD" href="../e41959/toc.htm"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about CRSCTL commands</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABEBEHC"></a>
<div id="TDPRC413" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Rolling Patching</h3>
<p><a id="sthref585"></a><a id="sthref586"></a>In rolling patching, one group of nodes is shut down, the patch is applied to those nodes, and the nodes are brought back up. This is performed group by group, separately, until all the nodes in the cluster are patched. This is the most efficient means of applying an interim patch to an Oracle RAC or Oracle Grid Infrastructure for a cluster installation. By patching groups of nodes individually, there is zero downtime for the cluster database because at least one instance is available at all times on a different node.</p>
<p>While most patches can be applied in a rolling fashion, some patches cannot be applied in this fashion. The <code>README</code> file for the patch indicates whether or not you can apply the patch using the rolling patch method. If the patch cannot be applied using the rolling patch method, then you must use either <a href="#BABDHBIA">"Minimum Downtime Patching"</a> or <a href="#BABJJDBD">"All Node Patching"</a> to apply the patch.</p>
<p class="subhead2"><a id="TDPRC536"></a>To apply a patch using the rolling patch method:</p>
<ol>
<li>
<p>In a command window, change to the directory where the unzipped patch is staged on disk, for example:</p>
<pre>
$ cd <span class="italic">Oracle_home</span>/OPatch/12419331/12419331
</pre></li>
<li>
<p>Verify the patch can be applied in a rolling fashion, using the following command:</p>
<pre>
$ opatch query -is_rolling_patch [<span class="italic">unzipped patch location</span>]
</pre>
<p>To be applied in a rolling fashion, the patch must be designated as a "rolling updatable patch" or simply "rolling patch". Refer to patch README file to find out whether the patch is rolling patch or not.</p>
</li>
<li>
<p>Stop all user applications that use the Oracle home directory for the group of nodes being patched. For example, to stop Enterprise Manager Database Control on the local node, use the following command, where <code><span class="italic">Oracle_home</span></code> is the home directory for your Oracle RAC installation:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/emctl stop dbconsole
</pre></li>
<li>
<p>If you are patching only the Oracle RAC home directory, then shut down all Oracle RAC instances in the group of nodes being patched. To shut down an instance for an Oracle RAC database, enter a command similar to the following example, where <code><span class="italic">Oracle_home</span></code> is the location of the Oracle RAC home directory, <code>sales</code> is the name of the database, and <code>sales1</code> is the name of the instance:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl stop instance -d sales -i "sales1" -f
</pre></li>
<li>
<p>If you are patching the Grid home directory, then you must stop all Oracle RAC database instances that are running on the group of nodes being patched. Additionally, stop all single-instance databases and user applications that use the ASM installation in the Grid home on the nodes being patched.</p>
<p>When patching the Grid home directory you can use a single command to stop the Oracle Clusterware stack on specific servers in the cluster. This command attempts to gracefully stop resources managed by Oracle Clusterware while attempting to stop the Oracle Clusterware stack. If any resources that Oracle Clusterware manages are still running after you run the <code>crsctl stop cluster</code> command, then the command fails. Use the <code>-f</code> option to unconditionally stop all resources and stop the Oracle Clusterware stack on the specified servers.Use a command similar to the following, where <code><span class="italic">Grid_home</span></code> is the home directory of your Oracle Grid Infrastructure for a cluster installation and <code>docrac1</code> is one of the nodes in the group of nodes being patched:</p>
<pre>
$ <span class="italic">Grid_home</span>/crs/bin/crsctl stop cluster -n docrac1
</pre></li>
<li>
<p>After you have stopped the database instances and Oracle Clusterware stack on specific nodes in the cluster, use the <code>crsctl</code> utility to verify that all cluster resources have been stopped on those nodes.</p>
<pre>
$ <span class="italic">Grid_home</span>/bin/crsctl status resource -t
</pre></li>
<li>
<p>Make sure the <code>ORACLE_HOME</code> environment variable points to the software directory you want to patch, for example:</p>
<pre>
$ echo $ORACLE_HOME
/u01/app/oracle/product/11.2.0/dbhome_1
</pre></li>
<li>
<p>If you are patching nodes individually, then use the following command to instruct OPatch to apply the patch to only the local node. If you run this command from the directory where the patch is located, then you do not need to specify the patch ID.</p>
<pre>
$ opatch apply -local
</pre>
<p>If you are patching nodes individually, then you can use a command similar to the following to instruct OPatch to apply the patch to only the next node to be patched. If you run this command from the directory where the patch is located, then you do not need to specify the patch ID.</p>
<pre>
$ opatch apply -remote_nodes docrac2
</pre>
<p>If you are patching a group of nodes, then use a command similar to the following to instruct OPatch to apply the patch to the group of nodes being patched:</p>
<pre>
$ opatch apply [-local_node docrac1] -remote_nodes docrac2,docrac3
</pre></li>
<li>
<p>After you have applied the patch to a node or group of nodes, then you can restart Oracle Clusterware and Oracle RAC on those nodes.</p>
<ol>
<li>
<p>If you applied the patch to only the Oracle home, then restart the instances and database applications on the patched nodes. For example, you would use commands similar to the following:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl start instance -d sales -i "sales1"
$ <span class="italic">Oracle_home</span>/bin/emctl start dbconsole
</pre></li>
<li>
<p>If you applied the patch to the Grid home directory, then restart the Oracle Clusterware stack on the patched nodes by issuing the following command as the <code>root</code> user one of those nodes, where <span class="italic">Grid_home</span> is the home directory of your Oracle Grid Infrastructure for a cluster installation:</p>
<pre>
# <span class="italic">Grid_home</span>/bin/crsctl start cluster -n docrac1
</pre>
<p>After you have restarted Oracle Clusterware and Oracle ASM, you can then restart any Oracle Database instances and associated applications on the patched nodes.</p>
</li>
</ol>
</li>
<li>
<p>After you have restarted the Oracle Clusterware stack on all nodes, use the <code>crsctl</code> utility to verify that the cluster resources were restarted on each node.</p>
<pre>
$ <span class="italic">Grid_home</span>/bin/crsctl status resource -t
</pre>
<p>If any of the cluster resources did not restart, then use either the CRSCTL or SRVCTL utility to restart them. For example, you can use commands similar the following to restart various cluster resources, where <code><span class="italic">Grid_home</span></code> is the home directory of your Oracle Grid Infrastructure for a cluster installation and <code><span class="codeinlineitalic"><span class="italic">Oracle_home</span></span></code> is the home directory of your Oracle RAC database:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl start instance -d sales -i "sales1"
# <span class="italic">Grid_home</span>/bin/crsctl start resource myResource -n docrac1
</pre></li>
<li>
<p>Repeat Step 3 through Step 10 for the next group of nodes.</p>
<p>If you have more than two groups of nodes to be patched, then repeat Step 3 through Step 10 for each group of nodes until all the nodes in the cluster have been patched.</p>
</li>
<li>
<p>Run any post-patch scripts that are mentioned in the patch instructions, for example:</p>
<pre>
$ sqlplus /nolog 
SQL&gt; connect sys/<span class="italic">password</span>@sales1 AS SYSDBA
SQL&gt; @<span class="italic">Oracle_home</span>/rdbms/admin/catbundle.sql cpu apply
SQL&gt; exit
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFFEDG">"Obtaining the Patch"</a></p>
</li>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="#BABHFJBE">"Applying Patches"</a></p>
</li>
<li>
<p><a href="#CHDCAJCH">"Applying Patch Sets"</a></p>
</li>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG334" href="../../em.112/e12255/oui7_opatch.htm#OUICG334"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABDHBIA"></a>
<div id="TDPRC421" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Minimum Downtime Patching</h3>
<p><a id="sthref587"></a><a id="sthref588"></a>In <a href="rac_glossary.htm#BGBDJJHD"><span class="xrefglossterm">minimum downtime patching</span></a>, one set of nodes is shut down and the patch is applied to those nodes. After the first set of nodes has been patched, the second set of nodes is shut down. The first set of nodes is then restarted and the patch is applied to the second set of nodes. After the patch has been applied to the second set of nodes, those nodes are restarted. This method leads to less downtime for Oracle RAC, compared to having all the nodes shut down at the same time.</p>
<p>When you use the minimum downtime patching method, the following actions occur:</p>
<ul>
<li>
<p>The local node is always patched first.</p>
</li>
<li>
<p>The local node is used as a base to patch the other nodes.</p>
</li>
<li>
<p>The user is prompted for the set of nodes to patch first from the remaining nodes.</p>
</li>
<li>
<p>For each node in this first set, the user is asked to stop the instance and then the patch is propagated to that node before continuing to the next node. When the initial set of nodes has been patched, the user is asked to shut down the remaining nodes.</p>
</li>
<li>
<p>After the local node is patched, the patch is propagated to the last set of nodes and the inventory is updated. The last instances are stopped on the remote nodes. You can then start up the patched nodes (the first set of nodes) before patching the remaining nodes.</p>
</li>
</ul>
<p class="subhead2"><a id="TDPRC433"></a>To apply a patch to your cluster database using the minimum downtime method:</p>
<ol>
<li>
<p>Change to the directory where the unzipped patch is staged on disk, for example:</p>
<pre>
$ cd <span class="italic">Oracle_home</span>/OPatch/12419331/12419331
</pre></li>
<li>
<p>Stop all user applications that use the Oracle RAC home directory for the group of nodes being patched. For example, to stop Enterprise Manager Database Control on the local node, use the following command, where <code><span class="italic">Oracle_home</span></code> is the home directory for your Oracle RAC installation:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/emctl stop dbconsole
</pre></li>
<li>
<p>Shut down all Oracle RAC instances on the local node. To shut down an instance for an Oracle RAC database, enter a command similar to the following example, where <code><span class="italic">Oracle_home</span></code> is the home directory for your Oracle RAC database installation, <code>sales</code> is the name of the database, and <code>sales1</code> is the name of the instance:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl stop instance -d sales -i "sales1" -f
</pre></li>
<li>
<p>Make sure the <code>ORACLE_HOME</code> environment variable points to the software directory you want to patch, for example:</p>
<pre>
$ echo $ORACLE_HOME
/u01/app/oracle/product/11.2.0/dbhome_1
</pre></li>
<li>
<p>Use the following command from within the patch directory:</p>
<pre>
$ opatch apply -minimize_downtime
</pre>
<p>If you run the OPatch command from the directory where the patch is staged on disk, then you do not need to specify the patch ID.</p>
<p>OPatch asks if you are ready to patch the local node. After you confirm that the Oracle RAC instances on the local node have been shut down, OPatch applies the patch to the Oracle home directory on the local node. You are then asked to select the next nodes to be patched.</p>
</li>
<li>
<p>After you shut down the Oracle RAC instances on the other nodes in the cluster, you can restart the Oracle RAC instance on the local node. Then, instruct OPatch that you are ready to patch the remaining nodes.</p>
</li>
<li>
<p>After all the nodes have been patched, restart the Oracle RAC instances on the other nodes in the cluster. The following command shows how to start the <code>orcl2</code> instance for the Oracle RAC database named <code>orcl</code>:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl start instance -d orcl -i "orcl2"
 
</pre></li>
<li>
<p>Verify that all the Oracle Clusterware resources were restarted on all the nodes in the cluster.</p>
<pre>
$ crsctl check cluster
</pre>
<p>If any of the cluster resources did not restart, then use either the CRSCTL or SRVCTL utility to restart them. For example, you can use commands similar the following to restart various cluster resources, where <code><span class="italic">Grid_home</span></code> is the home directory of your Oracle Grid Infrastructure for a cluster installation and <code><span class="codeinlineitalic"><span class="italic">Oracle_home</span></span></code> is the home directory of your Oracle RAC database:</p>
<pre>
$ <span class="italic">Oracle_home</span>/bin/srvctl start instance -d sales -i "sales1"
# <span class="italic">Grid_home</span>/bin/crsctl start resource myResource -n docrac1
</pre></li>
<li>
<p>Run any post-patch scripts that are mentioned in the patch instructions, for example:</p>
<pre>
$ sqlplus /nolog 
SQL&gt; connect sys/<span class="italic">password</span>@sales1 AS SYSDBA
SQL&gt; @<span class="italic">Oracle_home</span>/rdbms/admin/catbundle.sql cpu apply
SQL&gt; exit
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFFEDG">"Obtaining the Patch"</a></p>
</li>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="#BABHFJBE">"Applying Patches"</a></p>
</li>
<li>
<p><a href="#CHDCAJCH">"Applying Patch Sets"</a></p>
</li>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG334" href="../../em.112/e12255/oui7_opatch.htm#OUICG334"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDCAJCH"></a>
<div id="TDPRC419" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Applying Patch Sets</h2>
<p><a id="sthref589"></a>Patch sets are a mechanism for delivering fully tested and integrated product fixes. All the fixes in a patch set have been tested and are certified to work with each other. Because a patch set includes only low impact patches, it does not require you to certify applications or tools against the server.</p>
<p>For instructions on applying the latest patch set to your Oracle RAC database and Oracle Clusterware installations on Oracle Linux, search for "Oracle 11g release 2(11.2) Support Status and Alerts" documentation on the My Oracle Support (formerly Oracle<span class="italic">MetaLink</span>) Web site.</p>
<p>This document provides a summary of the patch sets available for Oracle 11g Release 2. Using this document, you can easily locate and view the Patch Set Notes for your platform. The Oracle Database Patch Set Notes document contains the following information:</p>
<ul>
<li>
<p>System requirements and information about how to install or reinstall the patch set</p>
</li>
<li>
<p>A list of all bugs fixed to date that are specific to Oracle Database for specified platform</p>
</li>
<li>
<p>A list of known issues relating to Oracle Database for the specified platform</p>
</li>
</ul>
<p class="subhead2"><a id="TDPRC420"></a>To locate the Patch Set notes on My Oracle Support:</p>
<ol>
<li>
<p>Log in to My Oracle Support.</p>
</li>
<li>
<p>Select the <span class="gui-object-action">Patches &amp; Updates</span> tab.</p>
</li>
<li>
<p>Select <span class="gui-object-action">Quick Links to the Latest Patchsets, Mini Packs, and Maintenance Packs</span>.</p>
</li>
<li>
<p>Under the heading Latest Oracle Server/Tools Patchsets, select <span class="gui-object-action">Oracle Database</span>.</p>
<p>A list of operating systems appears.</p>
</li>
<li>
<p>Place your cursor over the entry that matches your operating system, or use the triangular arrows to search for your operating system.</p>
<p>When you place the cursor over the entry for your operating system, for example, Linux x86, a list of database versions appears.</p>
</li>
<li>
<p>Select <span class="gui-object-action">11.2.0</span></p>
<p>The Advanced Search page appears.</p>
</li>
<li>
<p>Scroll to the bottom of this page to see the list of available patch sets.</p>
</li>
<li>
<p>Select the number in the Patch column for the patch set you want to view or download.</p>
<p>The Patchset description and download page appears.</p>
</li>
<li>
<p>Click <span class="gui-object-action">View Readme</span> to see the patch set notes.</p>
<p>On this page you can also click <span class="gui-object-action">Download</span> to download the patch to your computer.</p>
</li>
<li>
<p>If you choose to download the patch, then follow the instructions in the ReadMe file of the patch set to apply the patch set to your software.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CEGJJEAG"></a>
<div id="TDPRC435" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Troubleshooting Patch Deployment</h2>
<p>Applying patches to your Oracle RAC environment can be complicated at times. This section covers some common topics regarding troubleshooting patch deployment:</p>
<ul>
<li>
<p><a href="#CHDCEJFF">Updating the Node List for OPatch</a></p>
</li>
<li>
<p><a href="#CHDFBCEF">About OPatch Log and Trace Files</a></p>
</li>
<li>
<p><a href="#CHDHEJHE">Resolving the "Not a valid patch area" Error</a></p>
</li>
<li>
<p><a href="#CHDHIFAJ">Resolving the "Unable to remove a partially installed interim patch" Error</a></p>
</li>
</ul>
<p>If you have problems applying a patch to your Oracle RAC database, then review these solutions to common problems. If the problem you encountered is not listed, then review the log and trace files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
<li>
<p><a href="#BABBDEJC">"Preparing to Use OPatch"</a></p>
</li>
<li>
<p><a class="olink ADMQS111" href="../../server.112/e10897/software.htm#ADMQS111"><span class="italic">Oracle Database 2 Day DBA</span></a></p>
</li>
<li>
<p><a href="racmon2.htm#CACDFBFE">"Viewing Oracle RAC Database Alert Log Messages"</a></p>
</li>
<li>
<p><a href="racmon2.htm#CACECAHH">"About the Oracle Clusterware Alert Log"</a></p>
</li>
</ul>
</div>
<a id="CHDCEJFF"></a>
<div id="TDPRC436" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Updating the Node List for OPatch</h3>
<p><a id="sthref590"></a>If OPatch does not automatically detect Oracle RAC or its nodes, then investigate the contents of the inventory and ensure they are complete.</p>
<p class="subhead2"><a id="TDPRC437"></a>To update the node list for OPatch:</p>
<p>If the list of nodes for your cluster is not complete, then you can update it by using Oracle Universal Installer and the <code>-updateNodeList</code> flag, as demonstrated in the following example:</p>
<pre>
<span class="italic">Oracle_home</span>/oui/bin/runInstaller -updateNodeList 
ORACLE_ HOME=/u01/app/oracle/product/11.2.0/dbhome_1 
CLUSTER_NODES=racnode1,racnode2,racnode3 -noClusterEnabled
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a> for more information about Oracle product patching using OPatch</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDFBCEF"></a>
<div id="TDPRC438" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About OPatch Log and Trace Files</h3>
<p><a id="sthref591"></a>Logging and tracing is a common aid for debugging. OPatch maintains logs for all <code>apply</code>, <code>rollback</code>, and <code>lsinventory</code> operations. The log files are located in the <code><span class="italic">Oracle_home</span>/cfgtoollogs/opatch</code> directory. Each log file is tagged with the time stamp of the operation. Log files are named as <code><span class="codeinlineitalic">opatch_mm-dd-yyyy_hh-mm-ss.log</span></code>, where <code><span class="codeinlineitalic">mm-dd-yyyy</span></code> is the current date and <code><span class="codeinlineitalic">hh-mm-ss</span></code> is the current time. Each time you run OPatch, a new log file is created.</p>
<p>For example, if a log file is created on May 17, 2007 at 11:55 PM, then it is named as follows:</p>
<pre>
opatch_05-17-2007_23-55-00.log
</pre>
<p>OPatch also maintains an index of the commands processed by OPatch and the log files associated with it in the <code>opatch_history.txt</code> file located in the <code><span class="italic">Oracle_home</span>/cfgtoollogs/opatch</code> directory. A sample of the <code>opatch_history.txt</code> file is as follows:</p>
<pre>
Date &amp; Time : Tue Apr 26 23:00:55 PDT 2007
Oracle Home : /u01/app/oracle/product/11.2.0/dbhome_1/
OPatch Ver. : 11.2.0.0.0
Current Dir : /scratch/oui/OPatch
Command     : lsinventory
Log File    : 
/u01/app/oracle/product/11.2.0/dbhome_1/cfgtoollogs/opatch/opatch-2007_Apr_26_23-00-55-PDT_Tue.log
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDHEJHE"></a>
<div id="TDPRC439" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Resolving the "Not a valid patch area" Error</h3>
<p><a id="sthref592"></a>You might get this error if the directory that the OPatch utility is using to do the patch does not match the template for what it is checking, or if the OPatch utility is run from an invalid directory.</p>
<p>The <code><span class="codeinlineitalic">Patch_Shiphome</span></code> directory should have the following structure:</p>
<ul>
<li>
<p>An <code>etc</code> directory that has the metadata files</p>
</li>
<li>
<p>A <code>files</code> directory that has the patch files</p>
</li>
<li>
<p>The <code>etc/config/inventory.xml</code> file and the <code>actions.xml</code> file under the same directory</p>
</li>
</ul>
<p class="subhead2"><a id="TDPRC440"></a>To resolve the "Not a valid patch area" error:</p>
<ul>
<li>
<p>Perform one of the following actions:</p>
<ol>
<li>
<p>Remove the patch shiphome directory and re-create it with the proper structure (by extracting the files again).</p>
</li>
<li>
<p>Start the OPatch utility from the directory where the patch to be installed has been unzipped and staged on disk.</p>
</li>
<li>
<p>Use the following command when starting OPatch:</p>
<pre>
opatch apply /<span class="italic">Patch_Shiphome</span>
</pre>
<p>where <code><span class="codeinlineitalic">Patch_Shiphome</span></code> is the location where the patch has been staged on disk.</p>
</li>
</ol>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDHIFAJ"></a>
<div id="TDPRC441" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Resolving the "Unable to remove a partially installed interim patch" Error</h3>
<p><a id="sthref593"></a>If the patching process is interrupted, then you might get the error "Unable to remove a partially installed interim patch" when you try to install the patch a second time.</p>
<p class="subhead2"><a id="TDPRC442"></a>To resolve the partially installed patch error:</p>
<ol>
<li>
<p>Ensure that the environment variable <code>ORACLE_HOME</code> is set to the Oracle home directory you are attempting to patch.</p>
</li>
<li>
<p>Go to the <code><span class="italic">Oracle_home</span>/.patch_storage/</code><code><span class="codeinlineitalic">patch-id</span></code><code>_</code><code><span class="codeinlineitalic">timestamp</span></code> directory and run the <code>restore.sh</code> script (or <code>restore.bat</code> on Windows platforms) as follows:</p>
<pre>
<span class="italic">Oracle_home</span>/.patch_storage/<span class="italic">patch-id</span>_<span class="italic">timestamp</span>/restore.sh
</pre></li>
<li>
<p>On Linux and UNIX systems, use the <code><span class="italic">Oracle_home</span>/.patch_storage/</code><code><span class="codeinlineitalic">patch-id</span></code><code>_</code><code><span class="codeinlineitalic">timestamp</span></code><code>/make.txt</code> file (if available) to modify your operating system environment, as follows:</p>
<pre>
/bin/sh make.txt
</pre></li>
<li>
<p>Attempt to apply the patch again.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CEGJJEAG">"Troubleshooting Patch Deployment"</a></p>
</li>
<li>
<p><a class="olink OUICG008" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=OUICG008"><span class="italic">Oracle Universal Installer and OPatch User's Guide for Windows and UNIX</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFAFEB"></a>
<div id="TDPRC443" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Upgrading the Oracle Software</h2>
<p><a id="sthref594"></a><a id="sthref595"></a><a id="sthref596"></a>An upgrade modifies most, if not all, of the installed Oracle software files, whereas a patch typically modifies only a few files. Upgrades are performed when you install a new software version, or apply a patch set. You can perform rolling upgrades, or you can shut down the Oracle Database and Oracle Clusterware software to perform the upgrade.</p>
<p>With Oracle Clusterware 11<span class="italic">g</span> release 2, you perform out-of-place upgrades. To perform an out-of-place upgrade, you install the Oracle Grid Infrastructure for a cluster into a new Grid home. When performing the upgrade, you specify the location of the new Grid home instead of selecting the existing software location.</p>
<p>When performing an out-of-place upgrade, the old and new version of the software are present on the nodes at the same time, each in a different home location, but only one version of the software is active at any given time.</p>
<p>Oracle Database release 11.2.0.2 is a full patch set release. To upgrade to Oracle Database release 11.2.0.2, you install the Oracle Grid Infrastructure for a cluster and Oracle Database software into new Oracle home directories instead of applying the patch set to the existing Oracle home directories. This is different from patch set releases for previous Oracle Database releases, where the patch set was always installed in place.</p>
<p><a id="sthref597"></a>You can use Database Upgrade Assistant (DBUA) to upgrade an existing database to the current release of Oracle Database. Database Upgrade Assistant (DBUA) guides you through the upgrade process and configures your database for the new release. DBUA automates the upgrade process and makes appropriate recommendations for configuration options such as tablespaces and online redo log files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMQS024" href="../../server.112/e10897/software.htm#ADMQS024"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about using DBUA to upgrade a database</p>
</li>
<li>
<p><a class="olink CWGEN" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=CWGEN"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for more information on performing software upgrades</p>
</li>
<li>
<p><a class="olink UPGRD" href="../../server.112/e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment392">
<tr>
<td class="cellalignment399">
<table class="cellalignment397">
<tr>
<td class="cellalignment396"><a href="addnodes.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment396"><a href="rac_glossary.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment401">
<table class="cellalignment395">
<tr>
<td class="cellalignment396"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment396"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment396"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment396"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment396"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment396"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
