<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Cloning Oracle Clusterware</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1056" />
<meta name="dcterms.created" content="2015-06-03T16:55:36Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Clusterware Administration and Deployment Guide" />
<meta name="dcterms.identifier" content="E41959-04" />
<meta name="dcterms.isVersionOf" content="CWADD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="adddelclusterware.htm" title="Previous" type="text/html" />
<link rel="Next" href="crschp.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e41959.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">10/21</span> <!-- End Header -->
<div id="CWADD03202" class="chapter"><a id="BABEDGHB"></a>
<h1 class="chapter"><span class="secnum">5</span> Cloning Oracle Clusterware<a id="sthref254"></a><a id="sthref255"></a></h1>
<p><a id="sthref256"></a><a id="sthref257"></a>This chapter describes how to clone an Oracle Grid Infrastructure home and use the cloned home to create a cluster. You perform the cloning procedures in this chapter by running scripts in silent mode. The cloning procedures are applicable to Linux and UNIX systems. Although the examples in this chapter use Linux and UNIX commands, the cloning concepts and procedures apply generally to all platforms.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This chapter assumes that you are cloning an Oracle Clusterware 11<span class="italic">g</span> release 2 (11.2) installation configured as follows:
<ul>
<li>
<p>No Grid Naming Service (GNS)</p>
</li>
<li>
<p>No Intelligent Platform Management Interface specification (IPMI)</p>
</li>
<li>
<p>Voting disk and Oracle Cluster Registry (OCR) are stored in Oracle Automatic Storage Management (ASM)</p>
</li>
<li>
<p>Single Client Access Name (SCAN) resolves through DNS</p>
</li>
</ul>
</div>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#BABBDEEA">Introduction to Cloning Oracle Clusterware</a></p>
</li>
<li>
<p><a href="#BABDJIHC">Preparing the Oracle Grid Infrastructure Home for Cloning</a></p>
</li>
<li>
<p><a href="#BABDHHDB">Creating a Cluster by Cloning Oracle Clusterware</a></p>
</li>
<li>
<p><a href="#BABDAHFF">Using Cloning to Add Nodes to a Cluster</a></p>
</li>
<li>
<p><a href="#BABBCFFA">Locating and Viewing Log Files Generated During Cloning</a></p>
</li>
</ul>
<a id="BABBDEEA"></a>
<div id="CWADD92115" class="sect1">
<h2 class="sect1">Introduction to Cloning Oracle Clusterware</h2>
<p>Cloning is the process of copying an existing Oracle Clusterware installation to a different location and then updating the copied installation to work in the new environment. Changes made by one-off patches applied on the source Oracle Grid Infrastructure home are also present after cloning. During cloning, you run a script that replays the actions that installed the Oracle Grid Infrastructure home.</p>
<p>Cloning requires that you start with a successfully installed Oracle Grid Infrastructure home. You use this home as the basis for implementing a script that extends the Oracle Grid Infrastructure home to create a cluster based on the original Grid home.</p>
<p>Manually creating the cloning script can be error prone because you prepare the script without interactive checks to validate your input. Despite this, the initial effort is worthwhile for scenarios where you run a single script to configure tens or even hundreds of clusters. If you have only one cluster to install, then you should use the traditional, automated and interactive installation methods, such as Oracle Universal Installer (OUI) or the Provisioning Pack feature of Oracle Enterprise Manager.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Cloning is not a replacement for Oracle Enterprise Manager cloning that is a part of the Provisioning Pack. During Oracle Enterprise Manager cloning, the provisioning process simplifies cloning by interactively asking for details about the Oracle home. The interview questions cover such topics as the location to which you want to deploy the cloned environment, the name of the Oracle database home, a list of the nodes in the cluster, and so on.</div>
<p>The Provisioning Pack feature of Oracle Enterprise Manager Grid Control provides a framework that automates the provisioning of nodes and clusters. For data centers with many clusters, the investment in creating a cloning procedure to provision new clusters and new nodes to existing clusters is worth the effort.</p>
<p>The following list describes some situations in which cloning is useful:</p>
<ul>
<li>
<p>Cloning prepares an Oracle Grid Infrastructure home once and deploys it to many hosts simultaneously. You can complete the installation in silent mode, as a noninteractive process. You do not need to use a graphical user interface (GUI) console, and you can perform cloning from a Secure Shell (SSH) terminal session, if required.</p>
</li>
<li>
<p>Cloning enables you to create an installation (copy of a production, test, or development installation) with all patches applied to it in a single step. Once you have performed the base installation and applied all patch sets and patches on the source system, cloning performs all of these individual steps as a single procedure. This is in contrast to going through the installation process to perform the separate steps to install, configure, and patch the installation on each node in the cluster.</p>
</li>
<li>
<p>Installing Oracle Clusterware by cloning is a quick process. For example, cloning an Oracle Grid Infrastructure home to a cluster with more than two nodes requires a few minutes to install the Oracle software, plus a few minutes more for each node (approximately the amount of time it takes to run the <code dir="ltr">root.sh</code> script).</p>
</li>
<li>
<p>Cloning provides a guaranteed method of accurately repeating the same Oracle Clusterware installation on multiple clusters.</p>
</li>
</ul>
<p>A cloned installation acts the same as its source installation. For example, you can remove the cloned Oracle Grid Infrastructure home using OUI or patch it using OPatch. You can also use the cloned Oracle Grid Infrastructure home as the source for another cloning operation. You can create a cloned copy of a test, development, or production installation by using the command-line cloning scripts.</p>
<p>The default cloning procedure is adequate for most cases. However, you can also customize some aspects of cloning, for example, to specify custom port assignments or to preserve custom settings.</p>
<p>The cloning process works by copying all of the files from the source Oracle Grid Infrastructure home to the destination Oracle Grid Infrastructure home. You can clone either a local (non-shared) or shared Oracle Grid Infrastructure home. Thus, any files used by the source instance that are located outside the source Oracle Grid Infrastructure home's directory structure are not copied to the destination location.</p>
<p>The size of the binary files at the source and the destination may differ because these files are relinked as part of the cloning operation, and the operating system patch levels may also differ between these two locations. Additionally, the number of files in the cloned home would increase because several files copied from the source, specifically those being instantiated, are backed up as part of the clone operation.</p>
</div>
<!-- class="sect1" -->
<a id="BABDJIHC"></a>
<div id="CWADD92116" class="sect1">
<h2 class="sect1">Preparing the Oracle Grid Infrastructure Home for Cloning</h2>
<p>To prepare the source Oracle Grid Infrastructure home to be cloned, create a copy of an installed Oracle Grid Infrastructure home and then use it to perform the cloning procedure on other nodes. Use the following step-by-step procedure to prepare the copy of the Oracle Grid Infrastructure home:</p>
<ul>
<li>
<p><a href="#BABDDBFB">Step 1: Install Oracle Clusterware</a></p>
</li>
<li>
<p><a href="#BABCBDGJ">Step 2: Shut Down Running Software</a></p>
</li>
<li>
<p><a href="#BABFJAHF">Step 3: Create a Copy of the Oracle Grid Infrastructure Home</a></p>
</li>
</ul>
<a id="BABDDBFB"></a>
<div id="CWADD92373" class="sect2">
<h3 class="sect2">Step 1: Install Oracle Clusterware</h3>
<p>Use the detailed instructions in the <span class="italic">Oracle Grid Infrastructure Installation Guide</span> to perform the following steps on the source node:</p>
<ol>
<li>
<p>Install Oracle Clusterware 11<span class="italic">g</span> release 2 (11.2). This installation puts Oracle Cluster Registry (OCR) and the voting disk on Oracle Automatic Storage Management (Oracle ASM).</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Either install and configure the Grid Infrastructure for a cluster or install just the Oracle Clusterware software, as described in your platform-specific <a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a>.</div>
<p>If you installed and configured Grid Infrastructure for a cluster, then you must stop Oracle Clusterware before performing the cloning procedures. If you performed a software-only installation, then you do not have to stop Oracle Clusterware.</p>
</li>
<li>
<p>Install any patches that are required (for example, a Grid Infrastructure bundle patch), if necessary.</p>
</li>
<li>
<p>Apply one-off patches, if necessary.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for Oracle Clusterware installation instructions</div>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABCBDGJ"></a>
<div id="CWADD92374" class="sect2">
<h3 class="sect2">Step 2: Shut Down Running Software</h3>
<p>Before copying the source Oracle Grid Infrastructure home, shut down all of the services, databases, listeners, applications, Oracle Clusterware, and Oracle ASM instances that run on the node. Oracle recommends that you use the Server Control (SRVCTL) utility to first shut down the databases, and then the Oracle Clusterware Control (CRSCTL) utility to shut down the rest of the components.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="crsref.htm#CHDGADEH">Appendix E, "CRSCTL Utility Reference"</a> for more information about CRSCTL</p>
</li>
<li>
<p><a class="olink RACAD005" href="../../rac.112/e41960/srvctladmin.htm#RACAD005"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about SRVCTL</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABFJAHF"></a>
<div id="CWADD92375" class="sect2">
<h3 class="sect2">Step 3: Create a Copy of the Oracle Grid Infrastructure Home</h3>
<p>To keep the installed Oracle Grid Infrastructure home as a working home, make a full copy of the source Oracle Grid Infrastructure home for cloning.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
When creating the copy, a best practice is to include the release number in the name of the file.</div>
<p>Use one of the following methods to create a compressed copy of the Oracle Grid Infrastructure home.</p>
<p class="subhead2"><a id="BABIDFHG"></a><a id="CWADD92376"></a>Method 1: Create a copy of the Oracle Grid Infrastructure home and remove the unnecessary files from the copy:</p>
<ol>
<li>
<p>On the source node, create a copy of the Oracle Grid Infrastructure home. To keep the installed Oracle Grid Infrastructure home as a working home, make a full copy of the source Oracle Grid Infrastructure home and remove the unnecessary files from the copy. For example, as <code dir="ltr">root</code> on Linux systems, run the <code dir="ltr">cp</code> command:</p>
<pre dir="ltr">
# cp -prf <span class="italic">Grid_home</span> <span class="italic">copy_path</span>
</pre>
<p>The preceding command copies the entire contents of <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code> (for example, <code dir="ltr">/u01/app/grid/11.2.0</code>) to a new location (for example, <code dir="ltr">/home/grid/gridcopy</code>).</p>
</li>
<li id="BABBDFJJ">
<p>Delete unnecessary files from the copy.</p>
<p>The Oracle Grid Infrastructure home contains files that are relevant only to the source node, so you can remove the unnecessary files from the copy of the Grid Infrastructure home in the <code dir="ltr">log</code>, <code dir="ltr">crs/init</code>, <code dir="ltr">crf</code>, and <code dir="ltr">cdata</code> directories. The following example for Linux and UNIX systems shows the commands to run to remove the unnecessary files from the <span class="italic">copy</span> of the Oracle Grid Infrastructure home:</p>
<pre dir="ltr">
[root@node1 root]# cd <span class="italic">copy_path</span>
[root@node1 grid]# rm -rf crs/install/crsconfig_addparams
[root@node1 grid]# rm -rf <span class="italic">host_name</span>
[root@node1 grid]# rm -rf log/<span class="italic">host_name</span>
[root@node1 grid]# rm -rf gpnp/<span class="italic">host_name</span>
[root@node1 grid]# find gpnp -type f -exec rm -f {} \;
[root@node1 grid]# find cfgtoollogs -type f -exec rm -f {} \;
[root@node1 grid]# rm -rf crs/init/*
[root@node1 grid]# rm -rf cdata/*
[root@node1 grid]# rm -rf crf/*
[root@node1 grid]# rm -rf network/admin/*.ora
[root@node1 grid]# find . -name '*.ouibak' -exec rm {} \;
[root@node1 grid]# find . -name '*.ouibak.1' -exec rm {} \;
[root@node1 grid]# rm -rf root.sh*
</pre></li>
<li>
<p>Create a compressed copy of the previously copied Oracle Grid Infrastructure home using tar or gzip on Linux and UNIX systems. Ensure that the tool you use preserves the permissions and file timestamps. For example:</p>
<p>On Linux and UNIX systems:</p>
<pre dir="ltr">
[root@node1 root]# cd <span class="italic">copy_path</span>
[root@node1 grid]# tar -zcvpf /<span class="italic">copy_path</span>/gridHome.tgz .
</pre>
<p>In the preceding example, the <code dir="ltr">cd</code> command changes the location to the copy of the Oracle Grid Infrastructure home with the unnecessary files removed that you created in the first two steps of this procedure, and the <code dir="ltr">tar</code> command creates a file named <code dir="ltr">gridHome.tgz</code>. In the <code dir="ltr">tar</code> command, <code dir="ltr"><span class="codeinlineitalic">copy_path</span></code> represents the location of the copy of the Oracle Grid Infrastructure home.</p>
<p>On AIX or HPUX systems:</p>
<pre dir="ltr">
tar cpf - . | compress -fv &gt; temp_dir/gridHome.tar.Z
</pre>
<p>On Windows systems, use WinZip to create a zip file.</p>
</li>
</ol>
<p class="subhead2"><a id="CWADD92377"></a>Method 2: Create a compressed copy of the Oracle Grid Infrastructure home using the -X option:</p>
<ol>
<li>
<p>Create a file that lists the unnecessary files in the Oracle Grid Infrastructure home. For example, list the following file names, using the asterisk (*) wildcard, in a file called <code dir="ltr">excludeFileList</code>:</p>
<pre dir="ltr">
<span class="italic">Grid_home</span>/<span class="italic">host_name</span>
<span class="italic">Grid_home</span>/log/<span class="italic">host_name</span>
<span class="italic">Grid_home</span>/gpnp/<span class="italic">host_name</span>
<span class="italic">Grid_home</span>/crs/init/*
<span class="italic">Grid_home</span>/cdata/*
<span class="italic">Grid_home</span>/crf/*
<span class="italic">Grid_home</span>/network/admin/*.ora
<span class="italic">Grid_home</span>/root.sh*
*.ouibak
*.ouibak1
</pre></li>
<li>
<p>Use the <code dir="ltr">tar</code> command or Winzip to create a compressed copy of the Oracle Grid Infrastructure home. For example, on Linux and UNIX systems, run the following command to archive and compress the source Oracle Grid Infrastructure home:</p>
<pre dir="ltr">
tar cpfX - excludeFileList <span class="italic">Grid_home</span> | compress -fv &gt; temp_dir/gridHome.tar.Z
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not use the jar utility to copy and compress the Oracle Grid Infrastructure home.</div>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABDHHDB"></a>
<div id="CWADD92122" class="sect1">
<h2 class="sect1">Creating a Cluster by Cloning Oracle Clusterware</h2>
<p>This section explains how to create a cluster by cloning a successfully installed Oracle Clusterware environment and copying it to the nodes on the destination cluster. The procedures in this section describe how to use cloning for Linux, UNIX, and Windows systems. OCR and voting disks are not shared between the two clusters after you successfully create a cluster from a clone.</p>
<p>For example, you can use cloning to quickly duplicate a successfully installed Oracle Clusterware environment to create a cluster. <a href="#CCHBIEGG">Figure 5-1</a> shows the result of a cloning procedure in which the Oracle Grid Infrastructure home on Node 1 has been cloned to Node 2 and Node 3 on Cluster 2, making Cluster 2 a new two-node cluster.</p>
<div id="CWADD92123" class="figure">
<p class="titleinfigure"><a id="CCHBIEGG"></a>Figure 5-1 Cloning to Create a Oracle Clusterware Environment</p>
<img width="377" height="161" src="img/cwadd003.gif" alt="Description of Figure 5-1 follows" /><br />
<a id="sthref258" href="img_text/cwadd003.htm">Description of "Figure 5-1 Cloning to Create a Oracle Clusterware Environment"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The steps to create a cluster through cloning are as follows:</p>
<ul>
<li>
<p><a href="#BABJBCFB">Step 1: Prepare the New Cluster Nodes</a></p>
</li>
<li>
<p><a href="#BABHHCEH">Step 2: Deploy the Oracle Grid Infrastructure Home on the Destination Nodes</a></p>
</li>
<li>
<p><a href="#BABFIHGJ">Step 3: Run the clone.pl Script on Each Destination Node</a></p>
</li>
<li>
<p><a href="#BABJFHJG">Step 4: Launch the Configuration Wizard</a></p>
</li>
</ul>
<a id="BABJBCFB"></a>
<div id="CWADD92124" class="sect2">
<h3 class="sect2">Step 1: Prepare the New Cluster Nodes</h3>
<p>On each destination node, perform the following preinstallation steps:</p>
<ul>
<li>
<p>Specify the kernel parameters</p>
</li>
<li>
<p>Configure block devices for Oracle Clusterware devices</p>
</li>
<li>
<p>Ensure that you have set the block device permissions correctly</p>
</li>
<li>
<p>Use short, nondomain-qualified names for all of the names in the <code dir="ltr">/etc/hosts</code> file</p>
</li>
<li>
<p>Test whether the interconnect interfaces are reachable using the <code dir="ltr">ping</code> command</p>
</li>
<li>
<p>Verify that the VIP addresses are not active at the start of the cloning process by using the <code dir="ltr">ping</code> command (the <code dir="ltr">ping</code> command of the VIP address must fail)</p>
</li>
<li>
<p>Copy the following Oracle Automatic Storage Management Cluster File System tunable files from the source node to each destination node:</p>
<p>On Linux and UNIX: <code dir="ltr">/etc/sysconfig/advmtunables</code> and <code dir="ltr">/etc/sysconfig/acfstunables</code></p>
<p>On AIX: <code dir="ltr">/etc/advmtunables</code> and <code dir="ltr">/etc/acfstunables</code></p>
<p>On Solaris: <code dir="ltr">/etc/advmtunables</code> and <code dir="ltr">/etc/acfstunables</code></p>
<p>On Windows: <code dir="ltr">C:\windows\system32\drivers\advm\tunables</code> and <code dir="ltr">C:\windows\system32\drivers\acfs\tunables</code></p>
</li>
<li>
<p>On AIX systems, and on Solaris x86-64-bit systems running vendor clusterware, if you add a node to the cluster, then you must run the <code dir="ltr">rootpre.sh</code> script (located at the mount point it you install Oracle Clusterware from a DVD or in the directory where you unzip the tar file if you download the software) on the node before you add the node to the cluster</p>
</li>
<li>
<p>Run CVU to verify your hardware and operating system environment</p>
</li>
</ul>
<p>Refer to your platform-specific Oracle Clusterware installation guide for the complete preinstallation checklist.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Unlike traditional methods of installation, the cloning process does not validate your input during the preparation phase. (By comparison, during the traditional method of installation using OUI, various checks occur during the interview phase.) Thus, if you make errors during the hardware setup or in the preparation phase, then the cloned installation fails.</div>
</div>
<!-- class="sect2" -->
<a id="BABHHCEH"></a>
<div id="CWADD92125" class="sect2">
<h3 class="sect2">Step 2: Deploy the Oracle Grid Infrastructure Home on the Destination Nodes</h3>
<p>Before you begin the cloning procedure that is described in this section, ensure that you have completed the prerequisite tasks to create a copy of the Oracle Grid Infrastructure home, as described in the section titled <a href="#BABDJIHC">"Preparing the Oracle Grid Infrastructure Home for Cloning"</a>.</p>
<ol>
<li>
<p>On each destination node, deploy the copy of the Oracle Grid Infrastructure home that you created in <a href="#BABFJAHF">"Step 3: Create a Copy of the Oracle Grid Infrastructure Home"</a>, as follows:</p>
<p>If you do not have a shared Oracle Grid Infrastructure home, then restore the copy of the Oracle Grid Infrastructure home on each node in the destination cluster. Use the equivalent directory structure as the directory structure that was used in the Oracle Grid Infrastructure home on the source node. Skip this step if you have a shared Oracle Grid Infrastructure home.</p>
<p>For example, on Linux or UNIX systems, run commands similar to the following:</p>
<pre dir="ltr">
[root@node1 root]# mkdir -p <span class="italic">location_of_the_copy_of_the_Grid_home</span>
[root@node1 root]# cd <span class="italic">location_of_the_copy_of_the_Grid_home</span>
[root@node1 crs]# tar -zxvf /<span class="italic">path_name</span>/gridHome.tgz
</pre>
<p>In this example, <code dir="ltr"><span class="codeinlineitalic">path_name</span></code> represents the directory structure in which you want to install the Oracle Grid Infrastructure home. Note that you can change the Grid home location as part of the clone process.</p>
<p>On Windows systems, unzip the Oracle Grid Infrastructure home on the destination node in the equivalent directory structure as the directory structure in which the Oracle Grid Infrastructure home resided on the source node.</p>
</li>
<li>
<p>If you have not already deleted unnecessary files from the Oracle Grid Infrastructure home, then repeat step <a href="#BABBDFJJ">2</a> in <a href="#BABIDFHG">"Method 1: Create a copy of the Oracle Grid Infrastructure home and remove the unnecessary files from the copy:"</a>.</p>
</li>
<li>
<p>Create a directory for the Oracle Inventory on the destination node and, if necessary, change the ownership of all of the files in the Oracle Grid Infrastructure home to be owned by the Oracle Grid Infrastructure installation owner and by the Oracle Inventory (<code dir="ltr">oinstall</code> privilege) group. If the Oracle Grid Infrastructure installation owner is <code dir="ltr">oracle</code>, and the Oracle Inventory group is <code dir="ltr">oinstall</code>, then the following example shows the commands to do this on a Linux system:</p>
<pre dir="ltr">
[root@node1 crs]# mkdir /u01
[root@node1 crs]# chown oracle:oinstall /u01
[root@node1 crs]# mkdir -p /u01/app/oraInventory
[root@node1 crs]# mkdir -p /u01/app/11.2.0/grid
</pre>
<p>When you run the last of the preceding commands on the Grid home, it clears <code dir="ltr">setuid</code> and <code dir="ltr">setgid</code> information from the Oracle binary. It also clears <code dir="ltr">setuid</code> from the following binaries:</p>
<pre dir="ltr">
<span class="italic">Grid_home</span>/bin/extjob
<span class="italic">Grid_home</span>/bin/jssu
<span class="italic">Grid_home</span>/bin/oradism
</pre>
<p>Run the following commands to restore the cleared information:</p>
<pre dir="ltr">
chmod u+s <span class="italic">Grid_home</span>/bin/oracle
chmod g+s <span class="italic">Grid_home</span>/bin/oracle
chmod u+s <span class="italic">Grid_home</span>/bin/extjob
chmod u+s <span class="italic">Grid_home</span>/bin/jssu
chmod u+s <span class="italic">Grid_home</span>/bin/oradism
</pre></li>
<li>
<p>It is important to remove any Oracle network files from the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code> directory on both the source and destination nodes before continuing. For example, remove any <code dir="ltr">tnsnames.ora</code>, <code dir="ltr">listener.ora</code>, or <code dir="ltr">sqlnet.ora</code> files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABBCFFA">"Locating and Viewing Log Files Generated During Cloning"</a></div>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABFIHGJ"></a>
<div id="CWADD92126" class="sect2">
<h3 class="sect2">Step 3: Run the clone.pl Script on Each Destination Node</h3>
<p>To set up the new Oracle Clusterware environment, the <code dir="ltr">clone.pl</code> script requires you to provide several setup values for the script. You can provide the variable values by either supplying input on the command line when you run the <code dir="ltr">clone.pl</code> script, or by creating a file in which you can assign values to the cloning variables. The following discussions describe these options.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
After you run <code dir="ltr">clone.pl</code>, the script prompts you to run <code dir="ltr">orainstRoot.sh</code> and <code dir="ltr">root.sh</code>. Run only <code dir="ltr">orainstRoot.sh</code> and then proceed to <a href="#BABJFHJG">"Step 4: Launch the Configuration Wizard"</a>. The configuration wizard will prompt you to run <code dir="ltr">root.sh</code>.</div>
<div id="CWADD92127" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref259"></a>
<h4 class="sect3">Supplying input to the clone.pl script on the command line</h4>
<p>If you do not have a shared Oracle Grid Infrastructure home, navigate to the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/clone/bin</code> directory on each destination node and run the <code dir="ltr">clone.pl</code> script, which performs the main Oracle Clusterware cloning tasks. To run the script, you must supply input to several parameters. <a href="#CCHHHHHJ">Table 5-1</a> describes the <code dir="ltr">clone.pl</code> script parameters.</p>
<div id="CWADD92128" class="tblformalwide">
<p class="titleintable"><a id="sthref260"></a><a id="CCHHHHHJ"></a>Table 5-1 Parameters for the clone.pl Script</p>
<table class="cellalignment414" title="Parameters for the clone.pl Script" summary="parameters for the clone.pl script" dir="ltr">
<thead>
<tr class="cellalignment408">
<th class="cellalignment415" id="r1c1-t12">Parameters</th>
<th class="cellalignment415" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment408">
<td class="cellalignment416" id="r2c1-t12" headers="r1c1-t12">
<p><code dir="ltr">ORACLE_BASE=</code><code dir="ltr"><span class="codeinlineitalic">ORACLE_BASE</span></code></p>
</td>
<td class="cellalignment416" headers="r2c1-t12 r1c2-t12">
<p>The complete path to the Oracle base to be cloned. If you specify an invalid path, then the script exits. This parameter is required.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r3c1-t12" headers="r1c1-t12">
<p><code dir="ltr">ORACLE_HOME=</code><code dir="ltr"><span class="codeinlineitalic">GRID_HOME</span></code></p>
</td>
<td class="cellalignment416" headers="r3c1-t12 r1c2-t12">
<p>The complete path to the Grid Infrastructure home for cloning. If you specify an invalid path, then the script exits. This parameter is required.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r4c1-t12" headers="r1c1-t12">
<p><code dir="ltr">ORACLE_HOME_NAME=</code><code dir="ltr"><span class="codeinlineitalic">Oracle_home_name</span></code> (or) <code dir="ltr">-defaultHomeName</code></p>
</td>
<td class="cellalignment416" headers="r4c1-t12 r1c2-t12">
<p>The Oracle home name of the home to be cloned. Optionally, you can specify the <code dir="ltr">-defaultHomeName</code> flag. This parameter is not required.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r5c1-t12" headers="r1c1-t12">
<p><code dir="ltr">INVENTORY_LOCATION=</code><code dir="ltr"><span class="codeinlineitalic">location_of_inventory</span></code></p>
</td>
<td class="cellalignment416" headers="r5c1-t12 r1c2-t12">
<p>The location for the Oracle Inventory.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r6c1-t12" headers="r1c1-t12">
<pre dir="ltr">
-O'"CLUSTER_
NODES={<span class="italic">node_</span>
<span class="italic">name</span>,<span class="italic">node_</span>
<span class="italic">name</span>,...}"'
</pre></td>
<td class="cellalignment416" headers="r6c1-t12 r1c2-t12">
<p>A comma-delimited list of short node names for the nodes that are included in this new cluster.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r7c1-t12" headers="r1c1-t12">
<pre dir="ltr">
-O'"LOCAL_NODE=<span class="italic">node_name</span>"'
</pre></td>
<td class="cellalignment416" headers="r7c1-t12 r1c2-t12">
<p>The short node name for the node on which <code dir="ltr">clone.pl</code> is running.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r8c1-t12" headers="r1c1-t12">
<pre dir="ltr">
CRS=TRUE
</pre></td>
<td class="cellalignment416" headers="r8c1-t12 r1c2-t12">
<p>This parameter is necessary to set this property on the Oracle Universal Installer inventory.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r9c1-t12" headers="r1c1-t12">
<p><code dir="ltr">OSDBA_GROUP=</code><code dir="ltr"><span class="codeinlineitalic">OSDBA_privileged_group</span></code></p>
</td>
<td class="cellalignment416" headers="r9c1-t12 r1c2-t12">
<p>Specify the operating system group you want to use as the OSDBA privileged group. This parameter is optional if you do not want the default value.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r10c1-t12" headers="r1c1-t12">
<p><code dir="ltr">OSASM_GROUP=</code><code dir="ltr"><span class="codeinlineitalic">OSASM_privileged_group</span></code></p>
</td>
<td class="cellalignment416" headers="r10c1-t12 r1c2-t12">
<p>Specify the operating system group you want to use as the OSASM privileged group. This parameter is optional if you do not want the default value.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r11c1-t12" headers="r1c1-t12">
<p><code dir="ltr">OSOPER_GROUP=</code><code dir="ltr"><span class="codeinlineitalic">OSOPER_privileged_group</span></code></p>
</td>
<td class="cellalignment416" headers="r11c1-t12 r1c2-t12">
<p>Specify the operating system group you want to use as the OSOPER privileged group. This parameter is optional if you do not want the default value.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r12c1-t12" headers="r1c1-t12">
<p><code dir="ltr">-debug</code></p>
</td>
<td class="cellalignment416" headers="r12c1-t12 r1c2-t12">
<p>Specify this option to run the <code dir="ltr">clone.pl</code> script in debug mode.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r13c1-t12" headers="r1c1-t12">
<p><code dir="ltr">-help</code></p>
</td>
<td class="cellalignment416" headers="r13c1-t12 r1c2-t12">
<p>Specify this option to obtain help for the <code dir="ltr">clone.pl</code> script.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" -->
<p>For example, on Linux and UNIX systems:</p>
<pre dir="ltr">
$ perl clone.pl -silent ORACLE_BASE=/u01/app/oracle ORACLE_HOME=
/u01/app/11.2.0/grid ORACLE_HOME_NAME=OraHome1Grid
INVENTORY_LOCATION=/u01/app/oraInventory -O'"CLUSTER_NODES={node1, node2}"'
-O'"LOCAL_NODE=node1"' CRS=TRUE
</pre>
<p>On Windows systems:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not use the <code dir="ltr">-O</code> option when you run this command on Windows.</div>
<pre dir="ltr">
C:\&gt;perl clone.pl ORACLE_BASE=D:\u01\app\grid ORACLE_HOME=D:\u01\app\grid\11.2.0
ORACLE_HOME_NAME=OraHome1Grid "CLUSTER_NODES={node1, node2}"
"LOCAL_NODE=node1" CRS=TRUE
</pre>
<p>Refer to <a href="#CCHHHHHJ">Table 5-1</a> for descriptions of the various parameters in the preceding example.</p>
<p>If you have a shared Oracle Grid Infrastructure home, then append the <code dir="ltr">-cfs</code> option to the command example in this step and provide a complete path location for the cluster file system.</p>
</div>
<!-- class="sect3" -->
<div id="CWADD92129" class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref261"></a>
<h4 class="sect3">Supplying Input to the clone.pl Script in a File</h4>
<p>Because the <code dir="ltr">clone.pl</code> script is sensitive to the parameter values that it receives, you must be accurate in your use of brackets, single quotation marks, and double quotation marks. To avoid errors, create a file that is similar to the <code dir="ltr">start.sh</code> script shown in <a href="#CCHIAJGC">Example 5-1</a> in which you can specify environment variables and cloning parameters for the <code dir="ltr">clone.pl</code> script.</p>
<p><a href="#CCHIAJGC">Example 5-1</a> shows an excerpt from an example script called <code dir="ltr">start.sh</code> that calls the <code dir="ltr">clone.pl</code> script; the example is configured for a cluster named <code dir="ltr">crscluster</code>. Run the script as the operating system user that installed Oracle Clusterware.</p>
<div id="CWADD92130" class="example">
<p class="titleinexample"><a id="CCHIAJGC"></a>Example 5-1 Excerpt From the start.sh Script to Clone Oracle Clusterware</p>
<pre dir="ltr">
#!/bin/sh
ORACLE_BASE=/u01/app/oracle
GRID_HOME=/u01/app/11.2.0/grid
THIS_NODE=&amp;rsquor;hostname -s&amp;rsquor;

<span class="bold">E01</span>=ORACLE_BASE=${ORACLE_BASE}
<span class="bold">E02</span>=ORACLE_HOME=${GRID_HOME}
<span class="bold">E03</span>=ORACLE_HOME_NAME=OraGridHome1
<span class="bold">E04</span>=INVENTORY_LOCATION=${ORACLE_BASE}/oraInventory

#C00="-O'-debug'"
C01="-O'\"CLUSTER_NODES={node1,node2}\"'"
C02="-O'\"LOCAL_NODE=${THIS_NODE}\"'"

perl ${GRID_HOME}/clone/bin/clone.pl -silent $E01 $E02 $E03 $E04 $C01 $C02
</pre></div>
<!-- class="example" -->
<p>The <code dir="ltr">start.sh</code> script sets several environment variables and cloning parameters, as described in <a href="#CCHDAEDH">Table 5-2</a>. <a href="#CCHDAEDH">Table 5-2</a> describes the environment variables <code dir="ltr">E01</code>, <code dir="ltr">E02</code>, <code dir="ltr">E03</code>, and <code dir="ltr">E04</code> that are shown in bold typeface in <a href="#CCHIAJGC">Example 5-1</a>, and <code dir="ltr">C01</code> and <code dir="ltr">C02</code>.</p>
<div id="CWADD92131" class="tblformalwide">
<p class="titleintable"><a id="sthref262"></a><a id="CCHDAEDH"></a>Table 5-2 Environment Variables Passed to the clone.pl Script</p>
<table class="cellalignment414" title="Environment Variables Passed to the clone.pl Script" summary="environment variables that you can set for the clone.pl script" dir="ltr">
<thead>
<tr class="cellalignment408">
<th class="cellalignment415" id="r1c1-t14">Symbol</th>
<th class="cellalignment415" id="r1c2-t14">Variable</th>
<th class="cellalignment415" id="r1c3-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment408">
<td class="cellalignment416" id="r2c1-t14" headers="r1c1-t14">
<p><code dir="ltr">E01</code></p>
</td>
<td class="cellalignment416" headers="r2c1-t14 r1c2-t14">
<p><code dir="ltr">ORACLE_BASE</code></p>
</td>
<td class="cellalignment416" headers="r2c1-t14 r1c3-t14">
<p>The location of the Oracle base directory.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r3c1-t14" headers="r1c1-t14">
<p><code dir="ltr">E02</code></p>
</td>
<td class="cellalignment416" headers="r3c1-t14 r1c2-t14">
<p><code dir="ltr">ORACLE_HOME</code></p>
</td>
<td class="cellalignment416" headers="r3c1-t14 r1c3-t14">
<p>The location of the Oracle Grid Infrastructure home. This directory location must exist and must be owned by the Oracle operating system group: oinstall.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r4c1-t14" headers="r1c1-t14">
<p><code dir="ltr">E03</code></p>
</td>
<td class="cellalignment416" headers="r4c1-t14 r1c2-t14">
<p><code dir="ltr">ORACLE_HOME_NAME</code></p>
</td>
<td class="cellalignment416" headers="r4c1-t14 r1c3-t14">
<p>The name of the Oracle Grid Infrastructure home. This is stored in the Oracle Inventory.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r5c1-t14" headers="r1c1-t14">
<p><code dir="ltr">E04</code></p>
</td>
<td class="cellalignment416" headers="r5c1-t14 r1c2-t14">
<p><code dir="ltr">INVENTORY_LOCATION</code></p>
</td>
<td class="cellalignment416" headers="r5c1-t14 r1c3-t14">
<p>The location of the Oracle Inventory. This directory location must exist and must initially be owned by the Oracle operating system group: oinstall.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r6c1-t14" headers="r1c1-t14">
<p><code dir="ltr">C01</code></p>
</td>
<td class="cellalignment416" headers="r6c1-t14 r1c2-t14">
<p><code dir="ltr">CLUSTER_NODES</code></p>
</td>
<td class="cellalignment416" headers="r6c1-t14 r1c3-t14">
<p>This list of short node names for the nodes in the cluster.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r7c1-t14" headers="r1c1-t14">
<p><code dir="ltr">C02</code></p>
</td>
<td class="cellalignment416" headers="r7c1-t14 r1c2-t14">
<p><code dir="ltr">LOCAL_NODE</code></p>
</td>
<td class="cellalignment416" headers="r7c1-t14 r1c3-t14">
<p>The short name of the local node.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABJFHJG"></a>
<div id="CWADD92359" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 4: Launch the Configuration Wizard</h3>
<p>The Configuration Wizard helps you to prepare the <code dir="ltr">crsconfig_params</code> file, prompts you to run the <code dir="ltr">root.sh</code> script (which calls the <code dir="ltr">rootcrs.pl</code> script), relinks Oracle binaries, and runs cluster verifications.</p>
<p>Start the Configuration Wizard, as follows:</p>
<pre dir="ltr">
$ <span class="italic">Oracle_home</span>/crs/config/config.sh
</pre>
<p>Optionally, you can run the Configuration Wizard silently, as follows, providing a response file:</p>
<pre dir="ltr">
$ <span class="italic">Oracle_home</span>/crs/config/config.sh -silent -responseFile <span class="italic">file_name</span>
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWLIN362" href="../../install.112/e41961/app_nonint.htm#CWLIN362"><span class="italic">Oracle Grid Infrastructure Installation Guide for Linux</span></a> for information about preparing response files</div>
<p>To use GNS, Oracle recommends that you add GNS to the cluster after your cloned cluster is running. Add GNS using the <code dir="ltr">srvctl add gns</code> command.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RACAD7924" href="../../rac.112/e41960/srvctladmin.htm#RACAD7924"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about the <code dir="ltr">srvctl add gns</code> command</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABDAHFF"></a>
<div id="CWADD92137" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Cloning to Add Nodes to a Cluster</h2>
<p>You can also use cloning to add nodes to a cluster. <a href="#BABGHDGF">Figure 5-2</a> shows the result of a cloning procedure in which the Oracle Grid Infrastructure home on Node 1 has been cloned to Node 2 in the same cluster, making it a two-node cluster. Newly added nodes to the cluster share the same OCR and voting disks.</p>
<div id="CWADD92138" class="figure">
<p class="titleinfigure"><a id="BABGHDGF"></a>Figure 5-2 Cloning to Add Nodes to a Cluster</p>
<img width="259" height="156" src="img/cwadd03.gif" alt="Description of Figure 5-2 follows" /><br />
<a id="sthref263" href="img_text/cwadd03.htm">Description of "Figure 5-2 Cloning to Add Nodes to a Cluster"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Using <a href="#BABGHDGF">Figure 5-2</a> as an example, the following procedure explains how to add nodes to a cluster using cloning. In this procedure, Node 1 is the source node from which you obtain the cloned copy, and Node 2 is the destination node, to which you copy the clone of Node 1:</p>
<ol>
<li>
<p>Prepare Node 2 as described in <a href="#BABJBCFB">"Step 1: Prepare the New Cluster Nodes"</a>.</p>
</li>
<li>
<p>Deploy the Oracle Grid Infrastructure home on Node 2, as described in <a href="#BABHHCEH">"Step 2: Deploy the Oracle Grid Infrastructure Home on the Destination Nodes"</a>.</p>
</li>
<li>
<p>Run the <code dir="ltr">clone.pl</code> script located in the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/clone/bin</code> directory on Node 2.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CCHHHHHJ">Table 5-1</a> for more information about the parameters used in the <code dir="ltr">clone.pl</code> script</div>
<p>The following example is for Linux or UNIX systems:</p>
<pre dir="ltr">
$ perl clone.pl ORACLE_HOME=/u01/app/11.2.0/grid ORACLE_HOME_NAME=OraHome1Grid
ORACLE_BASE=/u01/app/oracle -O'"CLUSTER_NODES={node1, node2}"'
-O'"LOCAL_NODE=node2"' CRS=TRUE
SHOW_ROOTSH_CONFIRMATION=false INVENTORY_LOCATION=/u01/app/oraInventory
</pre>
<p>In the preceding command, <code dir="ltr"><span class="codeinlineitalic">node_list</span></code> is a comma-delimited list of all nodes in the cluster.</p>
<p>The following example is for Windows systems:</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not use the <code dir="ltr">-O</code> option when you run this command on Windows.</div>
<pre dir="ltr">
C:\&gt;perl clone.pl ORACLE_BASE=D:\u01\app\grid ORACLE_HOME=D:\u01\app\grid\11.2.0
ORACLE_HOME_NAME=OraHome1Grid '"CLUSTER_NODES={node1, node2}"'
'"LOCAL_NODE=node1"' CRS=TRUE
</pre>
<p>If you are prompted to run <code dir="ltr">root.sh</code>, then ignore the prompt and proceed to the next step.</p>
</li>
<li>
<p>This step does not apply to Windows.</p>
<p>In the Central Inventory directory on Node 2, run the <code dir="ltr">orainstRoot.sh</code> script as <code dir="ltr">root</code>. This script populates the <code dir="ltr">/etc/oraInst.loc</code> directory with the location of the central inventory. For example:</p>
<pre dir="ltr">
[root@node2 root]# /opt/oracle/oraInventory/orainstRoot.sh
</pre>
<p>You can run the script on more than one destination node simultaneously.</p>
</li>
<li>
<p>Run the <code dir="ltr">addNode.sh</code> (<code dir="ltr">addNode.bat</code> on Windows) script, located in the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/oui/bin</code> directory, on Node 1, as follows:</p>
<pre dir="ltr">
$ addNode.sh -silent -noCopy ORACLE_HOME=<span class="italic">Grid_home</span> "CLUSTER_NEW_NODES={node2}"
"CLUSTER_NEW_VIRTUAL_HOSTNAMES={node2-vip}" "CLUSTER_NEW_VIPS={node2-vip}"
CRS_ADDNODE=true CRS_DHCP_ENABLED=false
</pre>
<div class="infobox-note">
<p class="notep1">Notes:</p>
<ul>
<li>
<p>Because you already ran the <code dir="ltr">clone.pl</code> script on Node 2, this step only updates the inventories on the node and instantiates scripts on the local node.</p>
</li>
<li>
<p>If you use the <code dir="ltr">-noCopy</code> option with the <code dir="ltr">addNode.sh</code> script, then a copy of the password file may not exist on Node 2, in which case you must copy a correct password file to Node 2.</p>
</li>
<li>
<p>The <code dir="ltr">addNode.sh</code> script runs the <code dir="ltr">cluvfy stage -pre nodeadd</code> verification.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Copy the following two files and the <code dir="ltr">gpnp</code> directory from Node 1, on which you ran <code dir="ltr">addnode.sh</code>, to Node 2:</p>
<pre dir="ltr">
<span class="italic">Grid_home</span>/crs/install/crsconfig_addparams
<span class="italic">Grid_home</span>/crs/install/crsconfig_params
<span class="italic">Grid_home</span>/gpnp
</pre></li>
<li>
<p>On Node 2, run the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/root.sh</code> script.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The cluster in this example has only two nodes. When you add multiple nodes to a cluster, you can run <code dir="ltr">root.sh</code> concurrently on all of the nodes.</div>
<p>The following example is for a Linux or UNIX system. On Node 2, run the following command:</p>
<pre dir="ltr">
[root@node2 root]# <span class="italic">Grid_home</span>/root.sh
</pre>
<p>The <code dir="ltr">root.sh</code> script automatically configures the following node applications:</p>
<ul>
<li>
<p>Global Services Daemon (GSD)</p>
</li>
<li>
<p>Oracle Notification Service (ONS)</p>
</li>
<li>
<p>Virtual IP (VIP) resources in the Oracle Cluster Registry (OCR)</p>
</li>
<li>
<p>Single Client Access Name (SCAN) VIPs and SCAN listeners</p>
</li>
<li>
<p>Oracle ASM</p>
</li>
</ul>
<p>On Windows, run the following command on Node 2:</p>
<pre dir="ltr">
C:\&gt;Grid_home\crs\config\gridconfig.bat
</pre></li>
<li>
<p>Navigate to the <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code><code dir="ltr">/oui/bin</code> directory on the Node 1 and run the <code dir="ltr">addNode.sh</code> script using the following syntax:</p>
<pre dir="ltr">
$ ./addNode.sh -silent -noCopy "CLUSTER_NEW_NODES={node2}"
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Use the <code dir="ltr">-noCopy</code> option only if the Oracle home on the destination node is fully populated with software. Otherwise, omit the <code dir="ltr">-noCopy</code> option to copy the software to the destination node when you run the <code dir="ltr">addnode.sh</code> script.</div>
</li>
<li>
<p>Run the <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code><code dir="ltr">/root.sh</code> script on Node 2 as <code dir="ltr">root</code>, where <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code> is the Oracle RAC home.</p>
</li>
<li>
<p>Run the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/crs/install/rootcrs.pl</code> script on Node 2 as <code dir="ltr">root</code>, following the instructions generated when you ran <code dir="ltr">root.sh</code> in the previous step.</p>
</li>
<li>
<p>Run the following cluster verification utility (CVU) command on Node 1:</p>
<pre dir="ltr">
$ cluvfy stage -post nodeadd -n <span class="italic">destination_node_name</span> [-verbose]
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<code dir="ltr"><a href="cvu.htm#CJGBHBFD">"cluvfy stage [-pre | -post] nodeadd"</a></code> for more information about this CVU command</div>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BABBCFFA"></a>
<div id="CWADD92139" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Locating and Viewing Log Files Generated During Cloning</h2>
<p>The cloning script runs multiple tools, each of which can generate log files. After the <code dir="ltr">clone.pl</code> script finishes running, you can view log files to obtain more information about the status of your cloning procedures. <a href="#CCHDHACB">Table 5-3</a> lists the log files that are generated during cloning that are the key log files for diagnostic purposes.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<code dir="ltr"><span class="codeinlineitalic">Central_inventory</span></code> in <a href="#CCHDHACB">Table 5-3</a> refers to the Oracle Inventory directory.</div>
<div id="CWADD92140" class="tblformalwide">
<p class="titleintable"><a id="sthref264"></a><a id="CCHDHACB"></a>Table 5-3 Cloning Log Files and their Descriptions</p>
<table class="cellalignment414" title="Cloning Log Files and their Descriptions" summary="Log files generated during cloining, where they are located, and what their purpose is." dir="ltr">
<thead>
<tr class="cellalignment408">
<th class="cellalignment415" id="r1c1-t24">Log File Name and Location</th>
<th class="cellalignment415" id="r1c2-t24">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment408">
<td class="cellalignment416" id="r2c1-t24" headers="r1c1-t24">
<pre dir="ltr">
<span class="italic">Central_inventory</span>/logs/cloneActions/<span class="italic">timestamp</span>.log
</pre></td>
<td class="cellalignment416" headers="r2c1-t24 r1c2-t24">
<p>Contains a detailed log of the actions that occur during the OUI part of the cloning.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r3c1-t24" headers="r1c1-t24">
<pre dir="ltr">
<span class="italic">Central_inventory</span>/logs/oraInstall/<span class="italic">timestamp</span>.err
</pre></td>
<td class="cellalignment416" headers="r3c1-t24 r1c2-t24">
<p>Contains information about errors that occur when OUI is running.</p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r4c1-t24" headers="r1c1-t24">
<pre dir="ltr">
<span class="italic">Central_inventory</span>/logs/oraInstall/<span class="italic">timestamp</span>.out
</pre></td>
<td class="cellalignment416" headers="r4c1-t24 r1c2-t24">
<p>Contains other miscellaneous information.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" -->
<p><a href="#CCHHGGEI">Table 5-4</a> lists the location of the Oracle Inventory directory for various platforms.</p>
<div id="CWADD92141" class="tblformalwide">
<p class="titleintable"><a id="sthref265"></a><a id="CCHHGGEI"></a>Table 5-4 Finding the Location of the Oracle Inventory Directory</p>
<table class="cellalignment414" title="Finding the Location of the Oracle Inventory Directory" summary="Where to find the Oracle Inventory directory, whose members are granted the OINSTALL privilege of writing to the oraInventory directory, the central inventory of Oracle installations on a server." dir="ltr">
<thead>
<tr class="cellalignment408">
<th class="cellalignment415" id="r1c1-t25">Type of System</th>
<th class="cellalignment415" id="r1c2-t25">Location of the Oracle Inventory Directory</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment408">
<td class="cellalignment416" id="r2c1-t25" headers="r1c1-t25">
<p>All UNIX computers except Linux and IBM AIX</p>
</td>
<td class="cellalignment416" headers="r2c1-t25 r1c2-t25">
<p><code dir="ltr">/var/opt/oracle/oraInst.loc</code></p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r3c1-t25" headers="r1c1-t25">
<p>IBM AIX and Linux</p>
</td>
<td class="cellalignment416" headers="r3c1-t25 r1c2-t25">
<p><code dir="ltr">/etc/oraInst.loc</code></p>
</td>
</tr>
<tr class="cellalignment408">
<td class="cellalignment416" id="r4c1-t25" headers="r1c1-t25">
<p>Windows</p>
</td>
<td class="cellalignment416" headers="r4c1-t25 r1c2-t25">
<p><code dir="ltr">C:\Program Files\Oracle\Inventory</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment407">
<tr>
<td class="cellalignment416">
<table class="cellalignment412">
<tr>
<td class="cellalignment411"><a href="adddelclusterware.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment411"><a href="crschp.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment419">
<table class="cellalignment410">
<tr>
<td class="cellalignment411"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment411"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment411"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment411"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment411"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment411"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
