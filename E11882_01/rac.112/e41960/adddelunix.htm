<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Adding and Deleting Oracle RAC from Nodes on Linux and UNIX Systems</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1058" />
<meta name="dcterms.created" content="2015-06-24T11:50:39Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Real Application Clusters Administration and Deployment Guide" />
<meta name="dcterms.identifier" content="E41960-04" />
<meta name="dcterms.isVersionOf" content="RACAD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="rac_glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="cloneracwithoui.htm" title="Previous" type="text/html" />
<link rel="Next" href="adddelwin.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e41960.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">15/24</span> <!-- End Header -->
<div id="RACAD0067" class="chapter"><a id="BABJEABD"></a> <a id="BEICADHD"></a>
<h1 class="chapter"><span class="secnum">10</span> Adding and Deleting Oracle RAC from Nodes on Linux and UNIX Systems</h1>
<p>This chapter describes how to extend an existing Oracle Real Application Clusters (Oracle RAC) home to other nodes and instances in the cluster, and delete Oracle RAC from nodes and instances in the cluster. This chapter provides instructions for Linux and UNIX systems.</p>
<p>If your goal is to clone an existing Oracle RAC home to create multiple new Oracle RAC installations across the cluster, then use the cloning procedures that are described in <a href="clonerac.htm#CHDGFHCA">Chapter 8, "Cloning Oracle RAC to Nodes in a New Cluster"</a>.</p>
<p>The topics in this chapter include the following:</p>
<ul>
<li>
<p><a href="#BABCGBJD">Adding Oracle RAC to Nodes with Oracle Clusterware Installed</a></p>
</li>
<li>
<p><a href="#BEIEEAFC">Deleting Oracle RAC from a Cluster Node</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Notes:</p>
<ul>
<li>
<p>Ensure that you have a current backup of Oracle Cluster Registry (OCR) before adding or deleting Oracle RAC by running the <code dir="ltr">ocrconfig -showbackup</code> command.</p>
</li>
<li>
<p>The phrase "target node" as used in this chapter refers to the node to which you plan to extend the Oracle RAC environment.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink TDPRC394" href="../../rac.112/e17264/addnodes.htm#TDPRC394"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for additional information about configuring a new Oracle RAC cluster or scaling up an existing Oracle RAC cluster</p>
</li>
<li>
<p><a href="adddelwin.htm#CHDFAEJB">Chapter 11, "Adding and Deleting Oracle RAC from Nodes on Windows Systems"</a></p>
</li>
</ul>
</div>
<a id="BABCGBJD"></a>
<div id="RACAD7348" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Adding Oracle RAC to Nodes with Oracle Clusterware Installed</h2>
<p>Before beginning this procedure, ensure that your existing nodes have the correct path to the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code> and that the <code dir="ltr">$ORACLE_HOME</code> environment variable is set to the Oracle RAC home.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWADD1167" href="../../rac.112/e41959/adddelclusterware.htm#CWADD1167"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about extending the Oracle Clusterware home to new nodes in a cluster</div>
<p>If <a id="sthref764"></a><a id="sthref765"></a><a id="sthref766"></a>you are using a local (non-shared) Oracle home, you must extend the Oracle RAC database home that is on an existing node (<code dir="ltr">node1</code> in this procedure) to a target node (<code dir="ltr">node3</code> in this procedure).</p>
<ol>
<li>
<p>Navigate to the <code dir="ltr">$ORACLE_HOME/oui/bin</code> directory on <code dir="ltr">node1</code> and run the <code dir="ltr">addNode.sh</code> script using the following syntax:</p>
<pre dir="ltr">
$ ./addNode.sh -silent "CLUSTER_NEW_NODES={node3}"
</pre></li>
<li>
<p>Run the <code dir="ltr">$ORACLE_HOME/root.sh</code> script on <code dir="ltr">node3</code> as <code dir="ltr">root</code>.</p>
</li>
</ol>
<p>If you are using a shared Oracle home (such as storing the Oracle home on Oracle Automatic Storage Management Cluster File System (Oracle ACFS)), then you do not have to extend the Oracle RAC database home to the target nodes because the home is shared across the nodes in the cluster.</p>
<p>Instead, you must first create a mount point for the Oracle RAC database home on the target node, mount and attach the Oracle home, and update the Oracle inventory, as follows:</p>
<ol>
<li>
<p>Run the <code dir="ltr">srvctl config db -d</code> <code dir="ltr"><span class="codeinlineitalic">db_name</span></code> command on an existing node in the cluster to obtain the mount point information.</p>
</li>
<li>
<p>Run the following command as <code dir="ltr">root</code> on <code dir="ltr">node3</code> to create the mount point:</p>
<pre dir="ltr">
# mkdir -p <span class="italic">mount_point_path</span>
</pre></li>
<li>
<p>Mount the file system that hosts the Oracle RAC database home.</p>
</li>
<li>
<p>Run the following command from the <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code><code dir="ltr">/oui/bin</code> directory on the node you are adding to add the Oracle RAC database home:</p>
<pre dir="ltr">
$ ./runInstaller -attachHome ORACLE_HOME="ORACLE_HOME""CLUSTER
_NODES={<span class="italic">node_list</span>}" LOCAL_NODE="<span class="italic">node_name</span>"
</pre></li>
<li>
<p>Update the Oracle Inventory, as follows:</p>
<pre dir="ltr">
$ ./runInstaller -updateNodeList ORACLE_HOME=<span class="italic">mount_point_path</span> "CLUSTER
_NODES={<span class="italic">node_list</span>}"
</pre>
<p>In the preceding command, <code dir="ltr"><span class="codeinlineitalic">node_list</span></code> refers to a list of all nodes where the Oracle RAC database home is installed, including the node you are adding.</p>
</li>
<li>
<p>Run the <code dir="ltr"><span class="codeinlineitalic">Grid_home</span></code><code dir="ltr">/root.sh</code> script on the <code dir="ltr">node3</code> as <code dir="ltr">root</code> and run the subsequent script, as instructed.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends that you back up the OCR after you complete the node addition process.</div>
<p>You can now add an Oracle RAC database instance to the target node using either of the procedures in the following sections.</p>
<ul>
<li>
<p><a href="#CEGCAGGB">Adding Policy-Managed Oracle RAC Database Instances to Target Nodes</a></p>
</li>
<li>
<p><a href="#BEIFIBIB">Adding Administrator-Managed Oracle RAC Database Instances to Target Nodes</a></p>
</li>
</ul>
<a id="CEGCAGGB"></a>
<div id="RACAD8316" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Adding Policy-Managed Oracle RAC Database Instances to Target Nodes</h3>
<p>Before adding an Oracle RAC database instance, run the following command on an existing node to configure Oracle Enterprise Manager on the node where you plan to add the database instance:</p>
<pre dir="ltr">
$ emca -addNode db
</pre>
<p>The Oracle Enterprise Manager Configuration Assistant prompts you for database and node information.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RILIN" href="../../install.112/e41962/toc.htm"><span class="italic">Oracle Real Application Clusters Installation Guide for Linux and UNIX</span></a> for more information about configuring Oracle Enterprise Manager</div>
<p>You must manually add undo and redo logs, unless you store your policy-managed database on Oracle Automatic Storage Management (Oracle ASM) and <a href="rac_glossary.htm#BABHFFBJ"><span class="xrefglossterm">Oracle Managed Files</span></a> is enabled.</p>
<p>If there is space in a server pool to add a node and the database has been started at least once, then Oracle Clusterware adds the Oracle RAC database instance to the newly added node and no further action is necessary.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The database must have been started at least once before you can add the database instance to the newly added node.</div>
<p>If there is no space in any server pool, then the newly added node moves into the Free server pool. Use the <code dir="ltr">srvctl modify srvpool</code> command to increase the cardinality of a server pool to accommodate the newly added node, after which the node moves out of the Free server pool and into the modified server pool, and Oracle Clusterware adds the Oracle RAC database instance to the node.</p>
</div>
<!-- class="sect2" -->
<a id="BEIFIBIB"></a>
<div id="RACAD070" class="sect2">
<h3 class="sect2">Adding Administrator-Managed Oracle RAC Database Instances to Target Nodes</h3>
<div class="infobox-note">
<p class="notep1">Note:</p>
The procedures in this section only apply to administrator-managed databases. Policy-managed databases use nodes when the nodes are available in the databases' server pool.</div>
<p>You can use either Oracle Enterprise Manager or DBCA to add Oracle RAC database instances to the target nodes. To add a database instance to a target node with <a id="sthref767"></a>Oracle Enterprise Manager, see the <a class="olink TDPRC" href="../e17264/toc.htm"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for complete information.</p>
<p>This section describes using DBCA to add Oracle RAC database instances under the following topics:</p>
<ul>
<li>
<p><a href="#CEGEJAIH">Using DBCA in Interactive Mode to Add Database Instances to Target Nodes</a></p>
</li>
<li>
<p><a href="#CEGJFBJA">Using DBCA in Silent Mode to Add Database Instances to Target Nodes</a></p>
</li>
</ul>
<p>These tools guide you through the following tasks:</p>
<ul>
<li>
<p>Creating a new database instance on each target node</p>
</li>
<li>
<p>Creating and configuring high availability components</p>
</li>
<li>
<p>Creating the Oracle Net configuration for a non-default listener from the Oracle home</p>
</li>
<li>
<p>Starting the new instance</p>
</li>
<li>
<p>Creating and starting services if you entered services information on the Services Configuration page</p>
</li>
</ul>
<p>After adding the instances to the target nodes, you should perform any necessary service configuration procedures, as described in <a href="hafeats.htm#BABIAICG">Chapter 5, "Introduction to Automatic Workload Management"</a>.</p>
<a id="CEGEJAIH"></a>
<div id="RACAD7356" class="sect3">
<h4 class="sect3">Using DBCA in Interactive Mode to Add Database Instances to Target Nodes</h4>
<p><a id="sthref768"></a><a id="sthref769"></a>To add a database instance to a target node with DBCA in interactive mode, perform the following steps:</p>
<ol>
<li>
<p>Ensure that your existing nodes have the <code dir="ltr">$ORACLE_HOME</code> environment variable set to the Oracle RAC home.</p>
</li>
<li>
<p>Start DBCA by entering <code dir="ltr">dbca</code> at the system prompt from the <code dir="ltr"><span class="codeinlineitalic">Oracle_home</span></code><code dir="ltr">/bin</code> directory.</p>
<p>DBCA performs certain CVU checks while running. However, you can also run CVU from the command line to perform various verifications.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWADD1100" href="../../rac.112/e41959/cvu.htm#CWADD1100"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for more information about CVU</div>
<p>DBCA displays the <a id="sthref770"></a><a id="sthref771"></a>Welcome page for Oracle RAC. Click <span class="bold">Help</span> on any DBCA page for additional information.</p>
</li>
<li>
<p>Select <span class="bold">Oracle Real Application Clusters (RAC) database</span>, click <span class="bold">Next</span>, and DBCA displays the <a id="sthref772"></a><a id="sthref773"></a>Operations page.</p>
</li>
<li>
<p>Select <span class="bold">Instance Management</span>, click <span class="bold">Next</span>, and DBCA displays the <a id="sthref774"></a><a id="sthref775"></a>Instance Management page.</p>
</li>
<li>
<p>Select <span class="bold">Add Instance</span> and click <span class="bold">Next</span>. DBCA displays the <a id="sthref776"></a><a id="sthref777"></a>List of Cluster Databases page that shows the databases and their current status, such as <code dir="ltr">ACTIVE</code> or <code dir="ltr">INACTIVE</code>.</p>
</li>
<li>
<p>From the List of Cluster Databases page, select the active Oracle RAC database to which you want to add an instance. Enter user name and password for the database user that has <code dir="ltr">SYSDBA</code> privileges. Click <span class="bold">Next</span> and DBCA displays the List of Cluster Database Instances page showing the names of the existing instances for the Oracle RAC database that you selected.</p>
</li>
<li>
<p>Click <span class="bold">Next</span> to add a new instance and DBCA displays the <a id="sthref778"></a><a id="sthref779"></a>Adding an Instance page.</p>
</li>
<li>
<p>On the Adding an Instance page, enter the instance name in the field at the top of this page if the instance name that DBCA provides does not match your existing instance naming scheme.</p>
</li>
<li>
<p>Review file locations for undo tablespaces and redo log groups of the new instance and click <span class="bold">Finish</span> on the Instance Storage page.</p>
</li>
<li>
<p>Review the information on the Summary dialog and click <span class="bold">OK</span> or click <span class="bold">Cancel</span> to end the instance addition operation. DBCA displays a progress dialog showing DBCA performing the instance addition operation. When DBCA completes the instance addition operation, DBCA displays a dialog asking whether you want to perform another operation.</p>
</li>
<li>
<p>After you terminate your DBCA session, run the following command to verify the administrative privileges on the target node and obtain detailed information about these privileges where <code dir="ltr"><span class="codeinlineitalic">nodelist</span></code> consists of the names of the nodes on which you added database instances:</p>
<pre dir="ltr">
cluvfy comp admprv -o db_config -d <span class="italic">Oracle_home</span> -n <span class="italic">nodelist</span> [-verbose]
</pre></li>
<li>
<p>Perform any necessary service configuration procedures, as described in <a href="hafeats.htm#BABIAICG">Chapter 5, "Introduction to Automatic Workload Management"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CEGJFBJA"></a>
<div id="RACAD7357" class="sect3">
<h4 class="sect3">Using DBCA in Silent Mode to Add Database Instances to Target Nodes</h4>
<p><a id="sthref780"></a>You can use DBCA in silent mode to add instances to nodes on which you have extended an Oracle Clusterware home and an Oracle Database home. Before you run the <code dir="ltr">dbca</code> command, ensure that you have set the <code dir="ltr">ORACLE_HOME</code> environment variable correctly on the existing nodes. Run DBCA, supplying values for the variables described in <a href="#CEGGDIGA">Table 10-1</a>,as follows:</p>
<pre dir="ltr">
dbca -silent -addInstance -nodeList <span class="italic">node_name</span> -gdbName <span class="italic">gdb_name</span>
[-instanceName <span class="italic">instance_name</span> -sysDBAUserName <span class="italic">sysdba</span> -sysDBAPassword <span class="italic">password</span>]
</pre>
<div id="RACAD8195" class="tblformal">
<p class="titleintable"><a id="sthref781"></a><a id="CEGGDIGA"></a>Table 10-1 Variables in the DBCA Silent Mode Syntax</p>
<table class="cellalignment429" title="Variables in the DBCA Silent Mode Syntax" summary="This table describes the variables you use in DBCA syntax for silent mode. The variables are the same whether you are adding or deleting a node from the cluster." dir="ltr">
<thead>
<tr class="cellalignment423">
<th class="cellalignment430" id="r1c1-t10">Variable</th>
<th class="cellalignment430" id="r1c2-t10">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment423">
<td class="cellalignment431" id="r2c1-t10" headers="r1c1-t10">
<p><code dir="ltr"><span class="codeinlineitalic">node_name</span></code></p>
</td>
<td class="cellalignment431" headers="r2c1-t10 r1c2-t10">
<p>The node on which you want to add (or delete) the instance.</p>
</td>
</tr>
<tr class="cellalignment423">
<td class="cellalignment431" id="r3c1-t10" headers="r1c1-t10">
<p><code dir="ltr"><span class="codeinlineitalic">gdb_name</span></code></p>
</td>
<td class="cellalignment431" headers="r3c1-t10 r1c2-t10">
<p>Global database name.</p>
</td>
</tr>
<tr class="cellalignment423">
<td class="cellalignment431" id="r4c1-t10" headers="r1c1-t10">
<p><code dir="ltr"><span class="codeinlineitalic">instance_name</span></code></p>
</td>
<td class="cellalignment431" headers="r4c1-t10 r1c2-t10">
<p>Name of the instance. Provide an instance name only if you want to override the Oracle naming convention for Oracle RAC instance names.</p>
</td>
</tr>
<tr class="cellalignment423">
<td class="cellalignment431" id="r5c1-t10" headers="r1c1-t10">
<p><code dir="ltr"><span class="codeinlineitalic">sysdba</span></code></p>
</td>
<td class="cellalignment431" headers="r5c1-t10 r1c2-t10">
<p>Name of the Oracle user with <code dir="ltr">SYSDBA</code> privileges.</p>
</td>
</tr>
<tr class="cellalignment423">
<td class="cellalignment431" id="r6c1-t10" headers="r1c1-t10">
<p><code dir="ltr"><span class="codeinlineitalic">password</span></code></p>
</td>
<td class="cellalignment431" headers="r6c1-t10 r1c2-t10">
<p>Password for the <code dir="ltr">SYSDBA</code> user.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>Perform any necessary service configuration procedures, as described in <a href="hafeats.htm#BABIAICG">Chapter 5, "Introduction to Automatic Workload Management"</a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BEIEEAFC"></a>
<div id="RACAD7358" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Deleting Oracle RAC from a Cluster Node</h2>
<p>To remove Oracle RAC from a cluster node, you must delete the database instance and the Oracle RAC software before removing the node from the cluster.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If there are no database instances on the node you want to delete, then proceed to <a href="#CEGHEHGA">"Removing Oracle RAC"</a>.</div>
<p>This section includes the following procedures to delete nodes from clusters in an Oracle RAC environment:</p>
<ul>
<li>
<p><a href="#CEGIEDFF">Deleting Instances from Oracle RAC Databases</a></p>
</li>
<li>
<p><a href="#CEGHEHGA">Removing Oracle RAC</a></p>
</li>
<li>
<p><a href="#BEIJGIJG">Deleting Nodes from the Cluster</a></p>
</li>
</ul>
<a id="CEGIEDFF"></a>
<div id="RACAD0072" class="sect2">
<h3 class="sect2">Deleting Instances from Oracle RAC Databases</h3>
<p>The procedures for deleting database instances are different for policy-managed and administrator-managed databases. Deleting a policy-managed database instance involves reducing the number of servers in the server pool in which the database instance resides. Deleting an administrator-managed database instance involves using DBCA to delete the database instance.</p>
<p class="subhead2"><a id="RACAD7901"></a>Deleting Policy-Managed Database Instances</p>
<p>If you plan to delete the node on which the database instance resides from the cluster, then, before deleting the database instance, run the following command on a remaining node to deconfigure Oracle Enterprise Manager on the node you plan to delete:</p>
<pre dir="ltr">
$ emca -deleteNode db
</pre>
<p>The Oracle Enterprise Manager Configuration Assistant prompts you for database and node information.</p>
<p>To delete a <a id="sthref782"></a>policy-managed database, reduce the number of servers in the server pool in which a database instance resides by relocating the server on which the database instance resides to another server pool. This effectively removes the instance without having to remove the Oracle RAC software from the node or the node from the cluster.</p>
<p>For example, you can delete a policy-managed database by running the following commands on any node in the cluster:</p>
<pre dir="ltr">
$ srvctl stop instance -d db_unique_name -n <span class="italic">node_name</span>
$ srvctl relocate server -n <span class="italic">node_name</span> -g Free
</pre>
<p>The first command stops the database instance on a particular node and the second command moves the node out of its current server pool and into the Free server pool.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CEGHEHGA">"Removing Oracle RAC"</a> for information about removing the Oracle RAC software from a node</div>
<p class="subhead2"><a id="RACAD7902"></a>Deleting Instances from Administrator-Managed Databases</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Before deleting an instance from an Oracle RAC database, use either SRVCTL or Oracle Enterprise Manager to do the following:
<ul>
<li>
<p>If you have services configured, then relocate the services</p>
</li>
<li>
<p>Modify the services so that each service can run on one of the remaining instances</p>
</li>
<li>
<p>Ensure that the instance to be removed from an administrator-managed database is neither a preferred nor an available instance of any service</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="hafeats.htm#BABEDIIC">"Administering Services with Oracle Enterprise Manager"</a> and <a href="hafeats.htm#BABGDFGI">"Administering Services with SRVCTL"</a></div>
<p><a id="sthref783"></a><a id="sthref784"></a>The procedures in this section explain how to use DBCA in interactive or silent mode, to delete an instance from an Oracle RAC database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink TDPRC401" href="../../rac.112/e17264/addnodes.htm#TDPRC401"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for information about how to delete a database instance from a target node with <a id="sthref785"></a>Oracle Enterprise Manager</div>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#CEGFCBGG">Using DBCA in Interactive Mode to Delete Instances from Nodes</a></p>
</li>
<li>
<p><a href="#CEGHGFAA">Using DBCA in Silent Mode to Delete Instances from Nodes</a></p>
</li>
</ul>
<a id="CEGFCBGG"></a>
<div id="RACAD7360" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using DBCA in Interactive Mode to Delete Instances from Nodes</h4>
<p><a id="sthref786"></a>To delete an instance using DBCA in interactive mode, perform the following steps:</p>
<ol>
<li>
<p>Start DBCA.</p>
<p>Start DBCA on a node <span class="italic">other than</span> the node that hosts the instance that you want to delete. The database and the instance that you plan to delete should be running during this step.</p>
</li>
<li>
<p>On the DBCA Welcome page select <span class="bold">Oracle Real Application Clusters Database</span>, click <span class="bold">Next</span>. DBCA displays the Operations page.</p>
</li>
<li>
<p>On the DBCA Operations page, select <span class="bold">Instance Management</span> and click <span class="bold">Next</span>. DBCA displays the Instance Management page.</p>
</li>
<li>
<p>On the DBCA Instance Management page, select the instance to be deleted, select <span class="bold">Delete Instance,</span> and click <span class="bold">Next</span>.</p>
</li>
<li>
<p>On the List of Cluster Databases page, select the Oracle RAC database from which to delete the instance, as follows:</p>
<ol>
<li>
<p>On the List of Cluster Database Instances page, DBCA displays the instances that are associated with the Oracle RAC database that you selected and the status of each instance. Select the cluster database from which you will delete the instance.</p>
</li>
<li>
<p>Enter a user name and password for the database user that has <code dir="ltr">SYSDBA</code> privileges. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span> on the Confirmation dialog to proceed to delete the instance.</p>
<p>DBCA displays a progress dialog showing that DBCA is deleting the instance. During this operation, DBCA removes the instance and the instance's Oracle Net configuration. When DBCA completes this operation, DBCA displays a dialog asking whether you want to perform another operation.</p>
<p>Click <span class="bold">No</span> and exit DBCA or click <span class="bold">Yes</span> to perform another operation. If you click <span class="bold">Yes</span>, then DBCA displays the Operations page.</p>
</li>
</ol>
</li>
<li>
<p>Verify that the dropped instance's redo thread has been removed by using SQL*Plus on an existing node to query the <code dir="ltr">GV$LOG</code> view. If the redo thread is not disabled, then disable the thread. For example:</p>
<pre dir="ltr">
SQL&gt; ALTER DATABASE DISABLE THREAD 2;
</pre></li>
<li>
<p>Verify that the instance has been removed from OCR by running the following command, where <code dir="ltr"><span class="codeinlineitalic">db_unique_name</span></code> is the database unique name for your Oracle RAC database:</p>
<pre dir="ltr">
srvctl config database -d <span class="italic">db_unique_name</span>
</pre></li>
<li>
<p>If you are deleting more than one node, then repeat these steps to delete the instances from all the nodes that you are going to delete.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CEGHGFAA"></a>
<div id="RACAD7361" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using DBCA in Silent Mode to Delete Instances from Nodes</h4>
<p><a id="sthref787"></a>You can use DBCA in silent mode to delete a database instance from a node.</p>
<p>Run the following command, where the variables are the same as those shown in <a href="#CEGGDIGA">Table 10-1</a> for the DBCA command to add an instance. Provide a node name only if you are deleting an instance from a node other than the one on where DBCA is running as shown in the following example where <code dir="ltr"><span class="codeinlineitalic">password</span></code> is the password:</p>
<pre dir="ltr">
dbca -silent -deleteInstance [-nodeList <span class="italic">node_name</span>] -gdbName <span class="italic">gdb_name</span>
-instanceName <span class="italic">instance_name</span> -sysDBAUserName <span class="italic">sysdba</span> -sysDBAPassword <span class="italic">password</span>
</pre>
<p>At this point, you have accomplished the following:</p>
<ul>
<li>
<p>Deregistered the selected instance from its associated Oracle Net Services listeners</p>
</li>
<li>
<p>Deleted the selected database instance from the instance's configured node</p>
</li>
<li>
<p>Removed the Oracle Net configuration</p>
</li>
<li>
<p>Deleted the Oracle Flexible Architecture directory structure from the instance's configured node.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CEGHEHGA"></a>
<div id="RACAD7903" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Removing Oracle RAC</h3>
<p>This procedure removes <a id="sthref788"></a>Oracle RAC software from the node you are deleting from the cluster and updates inventories on the remaining nodes.</p>
<ol>
<li>
<p>If there is a listener in the Oracle RAC home on the node you are deleting, then you must disable and stop it before deleting the Oracle RAC software. Run the following commands on any node in the cluster, specifying the name of the listener and the name of the node you are deleting:</p>
<pre dir="ltr">
$ srvctl disable listener -l <span class="italic">listener_name</span> -n <span class="italic">name_of_node_to_delete</span>
$ srvctl stop listener -l <span class="italic">listener_name</span> -n <span class="italic">name_of_node_to_delete</span>
</pre></li>
<li>
<p>Run the following command from <code dir="ltr">$ORACLE_HOME/oui/bin</code> on the node that you are deleting to update the inventory on that node:</p>
<pre dir="ltr">
$ ./runInstaller -updateNodeList ORACLE_HOME=<span class="italic">Oracle_home_location</span>
"CLUSTER_NODES={<span class="italic">name_of_node_to_delete</span>}" -local
</pre></li>
<li>
<p>Depending on whether you have a shared or nonshared Oracle home, complete one of the following two procedures to remove the Oracle RAC software:</p>
<ul>
<li>
<p>For a shared home, detach the node instead of deinstalling it by running the following command from the <code dir="ltr">$ORACLE_HOME/oui/bin</code> directory on each of the nodes that you want to delete:</p>
<pre dir="ltr">
$ ./runInstaller -detachHome ORACLE_HOME=<span class="italic">Oracle_home_location</span>
</pre></li>
<li>
<p>For a nonshared home, deinstall the Oracle home from the node that you are deleting by running the following command:</p>
<pre dir="ltr">
$ORACLE_HOME/deinstall/deinstall -local
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWADD1167" href="../../rac.112/e41959/adddelclusterware.htm#CWADD1167"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for more information about deleting nodes</div>
</li>
</ul>
</li>
<li>
<p>Run the following command from the <code dir="ltr">$ORACLE_HOME/oui/bin</code> directory on any one of the remaining nodes in the cluster to update the inventories of those nodes, specifying a comma-delimited list of remaining node names:</p>
<pre dir="ltr">
$ ./runInstaller -updateNodeList ORACLE_HOME=<span class="italic">Oracle_home_location</span>
"CLUSTER_NODES={<span class="italic">remaining_node_list</span>}"
</pre>
<p>If you have a shared Oracle Grid Infrastructure home, then append the <code dir="ltr">-cfs</code> option to the command example in this step and provide a complete path location for the cluster file system.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BEIJGIJG"></a>
<div id="RACAD7362" class="sect2">
<h3 class="sect2">Deleting Nodes from the Cluster</h3>
<p>After you delete the database instance and the Oracle RAC software, you can begin the process of deleting the node from the cluster. You accomplish this by running scripts on the node you want to delete to remove the Oracle Clusterware installation and then you run scripts on the remaining nodes to update the node list.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CWADD90992" href="../../rac.112/e41959/adddelclusterware.htm#CWADD90992"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about deleting nodes from the cluster</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment422">
<tr>
<td class="cellalignment431">
<table class="cellalignment427">
<tr>
<td class="cellalignment426"><a href="cloneracwithoui.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment426"><a href="adddelwin.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment434">
<table class="cellalignment425">
<tr>
<td class="cellalignment426"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment426"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment426"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment426"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment426"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment426"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
