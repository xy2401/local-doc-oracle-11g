<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Auditing Database Activity</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 743" />
<meta name="dcterms.created" content="2013-11-26T15:10:6Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + Security Guide" />
<meta name="dcterms.identifier" content="E10575-09" />
<meta name="dcterms.isVersionOf" content="TDPSG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="tdpsg_securing_data.htm" title="Previous" type="text/html" />
<link rel="Next" href="index.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10575.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">11/12</span> <!-- End Header -->
<div id="TDPSG50000" class="chapter"><a id="BCGGIAIC"></a>
<h1 class="chapter"><span class="secnum">7</span> Auditing Database Activity</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#BCGJGGFJ">About Auditing</a></p>
</li>
<li>
<p><a href="#CEGJDHGI">Why Is Auditing Used?</a></p>
</li>
<li>
<p><a href="#CEGGHCGG">Where Are Standard Audit Activities Recorded?</a></p>
</li>
<li>
<p><a href="#BCGCCBCB">Auditing General Activities Using Standard Auditing</a></p>
</li>
<li>
<p><a href="#BCGHGJBG">Tutorial: Creating a Standard Audit Trail</a></p>
</li>
<li>
<p><a href="#BCGJJBAA">Guidelines for Auditing</a></p>
</li>
<li>
<p><a href="#BCGFHFAC">Initialization Parameters Used for Auditing</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink DBSEG006" href="../../network.112/e36292/auditing.htm#DBSEG006"><span class="italic">Oracle Database Security Guide</span></a> for other ways that you can audit user and database activities</p>
</li>
<li>
<p><a class="olink AVADM" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=AVADM"><span class="italic">Oracle Audit Vault Administrator's Guide</span></a> for information about Oracle Audit Vault, which provides advanced auditing features</p>
</li>
</ul>
</div>
<a id="BCGJGGFJ"></a>
<div id="TDPSG50051" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">About Auditing</h2>
<p><span class="bold"><a id="sthref467"></a><a id="sthref468"></a>Auditing</span> is the monitoring and recording of selected user database actions. In standard auditing, you use initialization parameters and the <code>AUDIT</code> and <code>NOAUDIT</code> SQL statements to audit SQL statements, privileges, and schema objects, and network and multitier activities.</p>
<p>There are also activities that Oracle Database always audits, regardless of whether auditing is enabled. These activities are administrative privilege connections, database startups, and database shutdowns. See <a class="olink DBSEG0622" href="../../network.112/e36292/auditing.htm#DBSEG0622"><span class="italic">Oracle Database Security Guide</span></a> for more information.</p>
<p>Another type of auditing is <a id="sthref469"></a><a id="sthref470"></a>fine-grained auditing. Fine-grained auditing enables you to audit at the most granular level, data access, and actions based on content, using Boolean measurement, such as <code>value &gt; 1000</code>. You can use fine-grained auditing to audit activities based on access to or changes in a column. You can create security policies to trigger auditing when someone accesses or alters specified elements in an Oracle database, including the contents within a specified object. You can create policies that define specific conditions that must take place for the audit to occur. For example, you can audit a particular table column to find out when and who tried to access it during a specified period of time. Furthermore, you can create alerts that are triggered when the policy is violated, and write this data to a separate audit file. <a class="olink DBSEG525" href="../../network.112/e36292/auditing.htm#DBSEG525"><span class="italic">Oracle Database Security Guide</span></a> explains how to perform fine-grained auditing.</p>
</div>
<!-- class="sect1" -->
<a id="CEGJDHGI"></a>
<div id="TDPSG50511" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Why Is Auditing Used?</h2>
<p><a id="sthref471"></a>You typically use auditing to perform the following activities:</p>
<ul>
<li>
<p><span class="bold">Enable accountability for actions.</span> These include actions taken in a particular schema, table, or row, or affecting specific content.</p>
</li>
<li>
<p><span class="bold">Deter users from inappropriate actions based on that accountability.</span></p>
</li>
<li>
<p><span class="bold">Investigate suspicious activity.</span> For example, if a user is deleting data from tables, then a security administrator might decide to audit all connections to the database and all successful and unsuccessful deletions of rows from all tables in the database.</p>
</li>
<li>
<p><span class="bold">Notify an auditor of actions by an unauthorized user.</span> For example, an unauthorized user could change or delete data, or a user has more privileges than expected, which can lead to reassessing user authorizations.</p>
</li>
<li>
<p><span class="bold">Detect problems with an authorization or access control implementation.</span> For example, you can create audit policies that you expect will never generate an audit record because the data is protected in other ways. However, if these policies do generate audit records, then you will know the other security controls are not properly implemented.</p>
</li>
<li>
<p><span class="bold">Address auditing requirements for compliance.</span> Regulations such as the following have common auditing-related requirements:</p>
<ul>
<li>
<p>Sarbanes-Oxley Act</p>
</li>
<li>
<p>Health Insurance Portability and Accountability Act (HIPAA)</p>
</li>
<li>
<p>International Convergence of Capital Measurement and Capital Standards: a Revised Framework (Basel II)</p>
</li>
<li>
<p>Japan Privacy Law</p>
</li>
<li>
<p>European Union Directive on Privacy and Electronic Communications</p>
</li>
</ul>
</li>
<li>
<p><span class="bold">Monitor and gather data about specific database activities.</span> For example, the database administrator can gather statistics about which tables are being updated, how many logical I/O operations are performed, or how many concurrent users connect at peak times.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CEGGHCGG"></a>
<div id="TDPSG50513" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Where Are Standard Audit Activities Recorded?</h2>
<p><a id="sthref472"></a><a id="sthref473"></a>Oracle Database records<a id="sthref474"></a><a id="sthref475"></a> audit activities in audit records. Audit records provide information about the operation that was audited, the user performing the operation, and the date and time of the operation. Audit records can be stored in either a data dictionary table, called the <span class="bold">database audit trail</span>, or in operating system files, called an <span class="bold">operating system audit trail</span>. Oracle Database also provides a set of data dictionary views that you can use to track suspicious activities. See <a class="olink DBSEG0635" href="../../network.112/e36292/auditing.htm#DBSEG0635"><span class="italic">Oracle Database Security Guide</span></a> for more information about these views.</p>
<p>When you use standard auditing, Oracle Database writes the audit records to either to <code>DBA_AUDIT_TRAIL</code> (the <code>SYS.AUD$</code> table), the operating system audit trail, or to the <code>DBA_COMMON_AUDIT_TRAIL</code> view, which combines standard and fine-grained audit log records.</p>
<p>In addition, the actions performed by administrators are recorded in the <code>syslog</code> audit trail when the <code>AUDIT_SYSLOG_LEVEL</code> initialization parameter is set.</p>
</div>
<!-- class="sect1" -->
<a id="BCGCCBCB"></a>
<div id="TDPSG50052" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Auditing General Activities Using Standard Auditing</h2>
<p>This section explains how to use standard auditing to audit activities performed on SQL statements, privileges, schema objects, and network or multitier activities.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BCGDDGEC">About Standard Auditing</a></p>
</li>
<li>
<p><a href="#CEGIDHAG">Enabling or Disabling the Standard Audit Trail</a></p>
</li>
<li>
<p><a href="#CEGGCIAE">Using Default Auditing for Security-Relevant SQL Statements and Privileges</a></p>
</li>
<li>
<p><a href="#CEGHGJHI">Individually Auditing SQL Statements</a></p>
</li>
<li>
<p><a href="#CEGIHJFI">Individually Auditing Privileges</a></p>
</li>
<li>
<p><a href="#CEGBCJDJ">Using Proxies to Audit SQL Statements and Privileges in a Multitier Environment</a></p>
</li>
<li>
<p><a href="#CEGIFIDG">Individually Auditing Schema Objects</a></p>
</li>
<li>
<p><a href="#CEGHGDHI">Auditing Network Activity</a></p>
</li>
<li>
<p><a href="#CEGBCJDJ">Using Proxies to Audit SQL Statements and Privileges in a Multitier Environment</a></p>
</li>
<li>
<p><a href="#BCGHGJBG">Tutorial: Creating a Standard Audit Trail</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG0623" href="../../network.112/e36292/auditing.htm#DBSEG0623"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about managing the standard audit trail</div>
<a id="BCGDDGEC"></a>
<div id="TDPSG52529" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Standard Auditing</h3>
<p><a id="sthref476"></a>In standard auditing, you enable auditing of SQL statements, privileges, schema objects, and network or multitier activities. You can audit a specific schema table if you want. To perform this type of audit, you use Database Control.</p>
<p>You can view the standard audit trail by querying the <code>DBA_AUDIT_TRAIL</code> and <code>DBA_COMMON_AUDIT_TRAIL</code> data dictionary views.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG90002" href="../../network.112/e36292/auditing.htm#DBSEG90002"><span class="italic">Oracle Database Security Guide</span></a> for a roadmap of how and why you can use the different types of audit options available</div>
</div>
<!-- class="sect2" -->
<a id="CEGIDHAG"></a>
<div id="TDPSG50521" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Enabling or Disabling the Standard Audit Trail</h3>
<p><a id="sthref477"></a>Before you perform the standard auditing procedures described in this section, you must enable standard auditing. When you enable standard auditing, you can create the audit trail in the database audit trail or write the audit activities to an operating system file. If you write to an operating system file, you can create the audit record in text or XML format.</p>
<p class="orderedlisttitle">To enable or disable the standard audit trail: &nbsp;</p>
<ol>
<li>
<p>Start Database Control.</p>
</li>
<li>
<p>Log in as <code>SYS</code> and connect with the <code>SYSDBA</code> privilege.</p>
<ul>
<li>
<p><span class="bold">User Name</span>: <code>SYS</code></p>
</li>
<li>
<p><span class="bold">Password</span>: Enter your password.</p>
</li>
<li>
<p><span class="bold">Connect As</span>: <code>SYSDBA</code></p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">Server</span> to display the Server subpage.</p>
</li>
<li>
<p>In the Database Configuration section, click <span class="bold">Initialization Parameters</span>.</p>
<p>The Initialization Parameters page appears.</p>
</li>
<li>
<p>Click <span class="bold">SPFile</span> to display the SPFile subpage.</p>
<p>If the <span class="bold">SPFile</span> tab does not display in your installation, then you did not install Oracle Database using a server parameters file. Go to the next step.</p>
</li>
<li id="BCGIAGAH">
<p>In the <span class="bold">Name</span> field, enter <code>audit_trail</code> to find the <code>AUDIT_TRAIL</code> initialization parameter, and then click <span class="bold">Go</span>.</p>
<p>You can enter the first few characters of the parameter, for example, <code>AUDIT_</code>. Alternatively, you can scroll down the list of parameters to find the <code>AUDIT_TRAIL</code> parameter.</p>
</li>
<li>
<p>In the <span class="bold">Value</span> field, select one of the following values:</p>
<ul>
<li>
<p><code>DB</code>: Enables database auditing and directs standard audit records to the database audit trail (<a id="sthref479"></a><code>SYS.AUD$</code>), except for records that are always written to the operating system audit trail. (This value is the default if you created the database using Database Configuration Assistant. Otherwise, the default is <code>NONE</code>.)</p>
</li>
<li>
<p><code>OS</code>: Enables database auditing and directs all audit records to an operating system <a id="sthref480"></a><a id="sthref481"></a>file. Writing the audit trail to operating system files is better for performance instead of sending the audit records to the <code>SYS.AUD$</code> table. If the auditor is distinct from the database administrator, you must use the <code>operating system</code> setting. Any auditing information stored in the database is viewable and modifiable by the database administrator.</p>
<p>To specify the location of the operating system audit record file, set the <code>AUDIT_FILE_DEST</code> initialization parameter. The first default directory is <code>$ORACLE_BASE/admin/$ORACLE_SID/adump</code>.</p>
</li>
<li>
<p><code>NONE</code>: Disables standard auditing.</p>
</li>
<li>
<p><code>DB, EXTENDED</code>: Performs all actions of the <a id="sthref482"></a><code>AUDIT_TRAIL=DB</code> setting and also populates the SQL bind and SQL text CLOB-type columns of the <a id="sthref483"></a><code>SYS.AUD$</code> table, when available. (These two columns are populated only when this parameter is specified.)</p>
</li>
<li>
<p><code>XML</code>: Writes to the operating system audit record file in XML format. Prints all elements of the <code>AuditRecord</code> node (as specified by the by the XML schema in <code><a href="http://xmlns.oracle.com/oracleas/schema/dbserver_audittrail-11_2.xsd">http://xmlns.oracle.com/oracleas/schema/dbserver_audittrail-11_2.xsd</a></code> XSD file) except <code>Sql_Text</code> and <code>Sql_Bind</code> to the operating system XML audit file. This <code>.xsd</code> file represents the schema definition of the XML audit file. An XML schema is a document written in the XML Schema language.</p>
</li>
<li>
<p><code>EXTENDED</code>: Specifies <code>XML, EXTENDED</code>, which performs all actions of <a id="sthref484"></a><code>XML</code> and also populates the SQL bind and SQL text CLOB-type columns of the <a id="sthref485"></a><code>SYS.AUD$</code> table, wherever possible. (These columns are populated only when this parameter is specified.)</p>
</li>
</ul>
<p>For a detailed explanation of the <code>AUDIT_TRAIL</code> initialization parameter settings, see <a class="olink DBSEG90022" href="../../network.112/e36292/auditing.htm#DBSEG90022"></a><span class="italic">Oracle Database Security Guide</span>.</p>
</li>
<li>
<p>Click <span class="bold">Apply</span>.</p>
</li>
<li>
<p>Restart the Oracle Database instance:</p>
<ol>
<li>
<p>Click the <span class="bold">Database Instance</span> link.</p>
</li>
<li>
<p>Click <span class="bold">Home</span> to display the Database Control home page.</p>
</li>
<li>
<p>Under General, click <span class="bold">Shutdown</span>.</p>
</li>
<li>
<p>In the Startup/Shutdown Credentials page, enter your credentials.</p>
<p>See <a class="olink ADMQS12037" href="../../server.112/e10897/instance.htm#ADMQS12037"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</li>
<li>
<p>After the shutdown completes, click <span class="bold">Startup</span>.</p>
</li>
</ol>
</li>
</ol>
<p>Note the following:</p>
<ul>
<li>
<p>You do not need to restart the database if you change the auditing of objects. You only need to restart the database if you made a universal change, such as turning on or off <span class="italic">all</span> auditing or changing the destination of the audit trail operating system files.</p>
</li>
<li>
<p>You do not need to set <code>AUDIT_TRAIL</code> to enable either fine-grained auditing or <code>SYS</code> auditing. (<code>SYS</code> auditing enables you to monitor the activities of a system administrator. See <a class="olink DBSEG0611" href="../../network.112/e36292/auditing.htm#DBSEG0611"><span class="italic">Oracle Database Security Guide</span></a> for more information.) For fine-grained auditing, you add and remove fine-grained auditing policies as necessary, applying them to the specific operations or objects you want to monitor. You can use the <code>AUDIT_SYS_OPERATIONS</code> parameter to enable and disable <code>SYS</code> auditing.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CEGGCIAE"></a>
<div id="TDPSG50522" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Default Auditing for Security-Relevant SQL Statements and Privileges</h3>
<p>When <a id="sthref486"></a><a id="sthref487"></a>you use Database Configuration Assistant (DBCA) to create a <a id="sthref488"></a>new database, Oracle Database configures the database to audit the most commonly used security-relevant SQL statements and privileges. It also sets the <code>AUDIT_TRAIL</code> initialization parameter to <code>DB</code>. If you decide to use a different audit trail type (for example, <code>OS</code> if you want to write the audit trail records to operating system files), then you can do that: Oracle Database continues to audit the privileges that are audited by default. If you disable auditing by setting the <code>AUDIT_TRAIL</code> parameter to <code>NONE</code>, then no auditing takes place.</p>
<p>Oracle Database<a id="sthref489"></a> audits the following privileges by default:</p>
<div class="inftblsimplewide">
<table class="cellalignment1886" title="Audited privileges" summary="Listing of commands that are audited by default, top to bottom, left to right" dir="ltr">
<tbody>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER ANY PROCEDURE</code></td>
<td class="cellalignment1883"><code>CREATE ANY LIBRARY</code></td>
<td class="cellalignment1883"><code>DROP ANY TABLE</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER ANY TABLE</code></td>
<td class="cellalignment1883"><code>CREATE ANY PROCEDURE</code></td>
<td class="cellalignment1883"><code>DROP PROFILE</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER DATABASE</code></td>
<td class="cellalignment1883"><code>CREATE ANY TABLE</code></td>
<td class="cellalignment1883"><code>DROP USER</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER PROFILE</code></td>
<td class="cellalignment1883"><code>CREATE EXTERNAL JOB</code></td>
<td class="cellalignment1883"><code>EXEMPT ACCESS POLICY</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER SYSTEM</code></td>
<td class="cellalignment1883"><code>CREATE PUBLIC DATABASE LINK</code></td>
<td class="cellalignment1883"><code>GRANT ANY OBJECT PRIVILEGE</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ALTER USER</code></td>
<td class="cellalignment1883"><code>CREATE SESSION</code></td>
<td class="cellalignment1883"><code>GRANT ANY PRIVILEGE</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>AUDIT SYSTEM</code></td>
<td class="cellalignment1883"><code>CREATE USER</code></td>
<td class="cellalignment1883"><code>GRANT ANY ROLE</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>CREATE ANY JOB</code></td>
<td class="cellalignment1883"><code>DROP ANY PROCEDURE</code></td>
<td class="cellalignment1883">&nbsp;</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblsimplewide" -->
<p>Oracle Database <a id="sthref490"></a>audits the following SQL statement shortcuts by default:</p>
<div class="inftblsimplewide">
<table class="cellalignment1886" summary="SQL statements audited by default" dir="ltr">
<tbody>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>ROLE</code></td>
<td class="cellalignment1883"><code>SYSTEM AUDIT</code></td>
<td class="cellalignment1883"><code>PUBLIC SYNONYM</code></td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883"><code>DATABASE LINK</code></td>
<td class="cellalignment1883"><code>PROFILE</code></td>
<td class="cellalignment1883"><code>SYSTEM GRANT</code></td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblsimplewide" -->
<p>To individually control the auditing of SQL statements and privileges, use the <code>AUDIT</code> and <code>NOAUDIT</code> statements.</p>
<p>Oracle strongly recommends that you audit the database. Auditing is an effective method of enforcing strong internal controls so that your site can meet its regulatory compliance requirements, as defined in the <a id="sthref491"></a><a id="sthref492"></a>Sarbanes-Oxley Act. This enables you to monitor business operations and catch any activities that may deviate from company policy. Doing so translates into tightly controlled access to your database and the application software. By enabling auditing by default, you can generate an audit record for audit and compliance personnel.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If your applications use the default audit settings from Oracle Database 10<span class="italic">g</span> Release 2 (10.2), then you can revert to these audit settings until you modify the applications to use the Release 11<span class="italic">g</span> audit settings. To do so, run the <code>undoaud.sql</code> script.
<p>After you have modified your applications to conform to the Release 11<span class="italic">g</span> audit settings, then you can manually update your database to use the audit configuration that suits your business needs, or you can run the <code>secconf.sql</code> script to apply the Release 11g default audit settings.</p>
<p>The <code>undoaud.sql</code> and <code>secconf.sql</code> scripts are in the <code>$ORACLE_HOME/rdbms/admin</code> directory. The <code>undoaud.sql</code> script affects audit settings only, and the <code>secconf.sql</code> script affects both audit and password settings. They have no effect on other security settings.</p>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for detailed information about the SQL statements described in this section</p>
</li>
<li>
<p><a class="olink REFRN10006" href="../../server.112/e40402/initparams017.htm#REFRN10006"></a><span class="italic">Oracle Database Reference</span> for detailed information about the <code>AUDIT_TRAIL</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CEGHGJHI"></a>
<div id="TDPSG50523" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Individually Auditing SQL Statements</h3>
<p><a id="sthref493"></a><a id="sthref494"></a>The SQL statements that you can audit are in the following categories:</p>
<ul>
<li>
<p><span class="bold"><a id="sthref495"></a><a id="sthref496"></a>DDL statements.</span> For example, enabling the auditing of tables (<code>AUDIT</code> <code>TABLE</code>) audits all <a id="sthref497"></a><code>CREATE</code> and <a id="sthref498"></a><code>DROP</code> <code>TABLE</code> statements</p>
</li>
<li>
<p><span class="bold"><a id="sthref499"></a><a id="sthref500"></a>DML statements.</span> For example, enabling the auditing of <code>SELECT</code> <code>TABLE</code> audits all <code>SELECT</code> ... <code>FROM</code> <code>TABLE/VIEW</code> statements, regardless of the table or view</p>
</li>
</ul>
<p>Statement auditing can be broad or focused, for example, by auditing the activities of all database users or of only a select list of users.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG225" href="../../network.112/e36292/auditing.htm#DBSEG225"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about auditing SQL statements</div>
</div>
<!-- class="sect2" -->
<a id="CEGIHJFI"></a>
<div id="TDPSG50524" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Individually Auditing Privileges</h3>
<p><a id="sthref501"></a><a id="sthref502"></a>Privilege auditing is a way to audit statements that can use a system privilege. For example, you can audit the <code>SELECT ANY TABLE</code> privilege if you want to audit all the <code>SELECT</code> statements that will use the <code>SELECT ANY TABLE</code> privilege. You can audit the use of any system privilege. Similar to statement auditing, privilege auditing can audit the activities of all database users or of only a specified list. As with SQL statement auditing, you use the <code>AUDIT</code> and <code>NOAUDIT</code> statements to enable and disable privilege auditing. In addition, you must have the <code>AUDIT SYSTEM</code> system privilege before you can enable auditing.</p>
<p><a id="sthref503"></a><a id="sthref504"></a>Privilege audit options match the corresponding system privileges. For example, the option to audit use of the <code>DELETE ANY TABLE</code> privilege is <code>DELETE ANY TABLE</code>. For example:</p>
<pre>
AUDIT DELETE ANY TABLE BY ACCESS WHENEVER NOT SUCCESSFUL;
</pre>
<p>To audit all successful and unsuccessful uses of the <code>DELETE ANY TABLE</code> system privilege, enter the following statement:</p>
<pre>
AUDIT DELETE ANY TABLE BY ACCESS;
</pre>
<p>To audit all unsuccessful <code>SELECT</code>, <code>INSERT</code>, and <code>DELETE</code> statements on all tables and unsuccessful uses of the <code>EXECUTE PROCEDURE</code> system privilege, by all database users, and by individual audited statement, issue the following statement:</p>
<pre>
AUDIT SELECT TABLE, INSERT TABLE, DELETE TABLE, EXECUTE PROCEDURE BY ACCESS WHENEVER NOT SUCCESSFUL;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG325" href="../../network.112/e36292/auditing.htm#DBSEG325"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about auditing privileges</div>
</div>
<!-- class="sect2" -->
<a id="CEGBCJDJ"></a>
<div id="TDPSG50525" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Proxies to Audit SQL Statements and Privileges in a Multitier Environment</h3>
<p><a id="sthref505"></a><a id="sthref506"></a>You can audit the <a id="sthref507"></a><a id="sthref508"></a>activities <a id="sthref509"></a><a id="sthref510"></a>of a client in a multitier environment by specifying a proxy in the Add Audited Statements or Add Audited Privileges page in Database Control. You can use the SQL <code>AUDIT</code> statement to audit the activities of a client in a multitier environment. To do so, use the <code>BY</code> <code><span class="codeinlineitalic">user</span></code> clause in the <code>AUDIT</code> statement.</p>
<p>For example, to audit <code>SELECT TABLE</code> statements issued by the proxy application user <code>jackson</code>:</p>
<pre>
AUDIT SELECT TABLE BY jackson;
</pre>
<p>Afterward, user <code>jackson</code> can connect using the <code>appserve</code> proxy user as follows:</p>
<pre>
CONNECT appserve[jackson]
Enter password: <span class="italic">password</span>
</pre>
<p>The middle tier can also set the user client identity in a database session, enabling the auditing of user actions through the middle-tier application. The user client identity then shows up in the audit trail.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG725" href="../../network.112/e36292/auditing.htm#DBSEG725"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about auditing in a multitier environment</div>
</div>
<!-- class="sect2" -->
<a id="CEGIFIDG"></a>
<div id="TDPSG50526" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Individually Auditing Schema Objects</h3>
<p><a id="sthref511"></a><a id="sthref512"></a>Schema object auditing can audit all <code>SELECT</code> and DML statements permitted by object privileges, such as <code>SELECT</code> or <code>DELETE</code> statements on a particular table. The <code>GRANT</code> and <code>REVOKE</code> statements that control those privileges are also audited.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG425" href="../../network.112/e36292/auditing.htm#DBSEG425"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about auditing schema objects</div>
</div>
<!-- class="sect2" -->
<a id="CEGHGDHI"></a>
<div id="TDPSG50527" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Auditing Network Activity</h3>
<p><a id="sthref513"></a><a id="sthref514"></a>You can use the <code>AUDIT</code> statement to audit unexpected errors in network protocol or internal errors in the network layer. The types of errors uncovered by network auditing are not connection failures, but can have several other possible causes. One possible cause is an internal event set by a database engineer for testing purposes. Other causes include conflicting configuration settings for encryption, such as the network not finding the information required to create or process expected encryption.</p>
<p class="orderedlisttitle">To enable network auditing: &nbsp;</p>
<ol>
<li>
<p>Start SQL*Plus and log on with administrative privileges, such as <code>SYSTEM</code>, or as a security administrator. For example:</p>
<pre>
sqlplus system
Enter password: <span class="italic">password</span>
</pre>
<p>SQL*Plus starts, connects to the default database, and then displays a prompt.</p>
<p>For detailed information about starting SQL*Plus, see <a class="olink ADMQS0361" href="../../server.112/e10897/em_manage.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a>.</p>
</li>
<li>
<p>Enter the following statement:</p>
<pre>
AUDIT NETWORK;
</pre>
<p>To disable network auditing, enter the following:</p>
<pre>
NOAUDIT NETWORK;
</pre></li>
<li>
<p>Exit SQL*Plus:</p>
<pre>
EXIT
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DBSEG11013" href="../../network.112/e36292/auditing.htm#DBSEG11013"><span class="italic">Oracle Database Security Guide</span></a> for detailed information about auditing network activity</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BCGHGJBG"></a>
<div id="TDPSG50528" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Tutorial: Creating a Standard Audit Trail</h2>
<p><a id="ABC6639514"></a><a id="ABC6639514SRI1"></a>Suppose you wanted to audit <code>SELECT</code> statements on the <code>OE.CUSTOMERS</code> table. In this tutorial, you enable standard auditing, enable auditing for the <code>SELECT</code> SQL statement, run the <code>SELECT</code> SQL statement on the <code>OE.CUSTOMERS</code> table, and then check its audit file.</p>
<p>In this tutorial:</p>
<ul>
<li>
<p><a href="#BCGEHEGI">Step 1: Log In and Enable Standard Auditing</a></p>
</li>
<li>
<p><a href="#BCGGIJGF">Step 2: Enable Auditing for SELECT Statements on the OE.CUSTOMERS Table</a></p>
</li>
<li>
<p><a href="#BCGHBCAG">Step 3: Test the Audit Settings</a></p>
</li>
<li>
<p><a href="#BCGFFHEH">Step 4: Optionally, Remove the Components for This Tutorial</a></p>
</li>
<li>
<p><a href="#BCGJGFHB">Step 5: Remove the SEC_ADMIN Security Administrator Account</a></p>
</li>
</ul>
<a id="BCGEHEGI"></a>
<div id="TDPSG55281" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 1: Log In and Enable Standard Auditing</h3>
<p>First, log in, and, if necessary, enable standard auditing.</p>
<p class="orderedlisttitle">To enable standard auditing: &nbsp;</p>
<ol>
<li>
<p>Start Database Control.</p>
</li>
<li>
<p>Log in as <code>SYS</code>.</p>
<ul>
<li>
<p><span class="bold">User Name</span>: <code>SYS</code></p>
</li>
<li>
<p><span class="bold">Password</span>: Enter your password.</p>
</li>
<li>
<p><span class="bold">Connect As</span>: <code>SYSDBA</code></p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">Server</span> to display the Server subpage.</p>
</li>
<li>
<p>In the Database Configuration section, click <span class="bold">Initialization Parameters</span>.</p>
<p>The Initialization Parameters page appears.</p>
</li>
<li>
<p>Click <span class="bold">SPFile</span> to display the SPFile subpage.</p>
<p>If the <span class="bold">SPFile</span> tab does not display in your installation, then you did not install Oracle Database using a server parameters file. Go to the next step.</p>
</li>
<li id="BCGJEJIJ">
<p>In the <span class="bold">Name</span> field, enter <code>AUDIT_TRAIL</code> to find the <code>AUDIT_TRAIL</code> parameter, and then click <span class="bold">Go</span>.</p>
<p>You can enter the first few characters of the parameter, for example, <code>AUDIT</code>. Alternatively, you can scroll down the list of parameters to find the <code>AUDIT_TRAIL</code> parameter. To sort the list of parameters in alphabetical order, click the <span class="bold">Name</span> column.</p>
</li>
<li>
<p>In the <span class="bold">Value</span> field, make a note of the current setting, and then change it to <code>DB_EXTENDED</code>.</p>
<p>By default, the <code>AUDIT_TRAIL</code> parameter is set to <code>DB</code>, which enables database auditing and directs all audit records to the database audit trail (<a id="sthref517"></a><code>SYS.AUD$</code>), except for records that are always written to the operating system audit trail. <code>DB_EXTENDED</code> has this functionality, plus it records SQL text and SQL bind variables.</p>
</li>
<li>
<p>Click <span class="bold">Apply</span>.</p>
</li>
<li>
<p>Restart the Oracle Database instance.</p>
<p>From a command line, enter the following commands:</p>
<pre>
sqlplus sys as sysoper
Enter password: <span class="italic">password</span>

SQL&gt; SHUTDOWN IMMEDIATE
SQL&gt; RESTART
</pre>
<p>At this point, you can check the <code>AUDIT_TRAIL</code> setting by entering the following command:</p>
<pre>
SQL&gt; SHOW PARAMETER AUDIT_TRAIL

NAME                     TYPE            VALUE
------------------------ --------------- ---------------------------------\
audit_trail              string          DB_EXTENDED 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BCGGIJGF"></a>
<div id="TDPSG55282" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 2: Enable Auditing for SELECT Statements on the OE.CUSTOMERS Table</h3>
<p>Next, enable auditing for <code>SELECT</code> statements on the <code>OE.CUSTOMERS</code> table.</p>
<p class="orderedlisttitle">To enable auditing of SELECT statements for the OE.CUSTOMERS table: &nbsp;</p>
<ol>
<li>
<p>Ensure that the sample user <code>sec_admin</code> exists.</p>
<p>Log on as <code>SYSTEM</code>, and then from the Database Control home page, click <span class="bold">Server</span> to display the Server subpage. Select <span class="bold">Users</span> under Security, and check the list of accounts for <code>sec_admin</code>. <a href="tdpsg_privileges.htm#CIHHIJCB">"Step 1: Create a Security Administrator Account"</a> explains how to create the <code>sec_admin</code> security administrator account. If you still have Oracle Database Vault enabled, then you must recreate the account using the Database Vault Account Manager account.</p>
</li>
<li>
<p>In SQL*Plus, log in as user <code>OE</code> and then grant <code>sec_admin</code> the <code>SELECT</code> privilege on the <code>OE.CUSTOMERS</code> table.</p>
<pre>
sqlplus oe
Enter password: <span class="italic">password</span>
Connected.

SQL&gt; GRANT SELECT ON CUSTOMERS TO sec_admin;
</pre></li>
<li>
<p>Log in to Database Control as user <code>SYS</code> with the <code>SYSDBA</code> privilege.</p>
</li>
<li>
<p>Click <span class="bold">Server</span> to display the Server subpage.</p>
</li>
<li>
<p>In the Security section, click <span class="bold">Audit Settings</span>.</p>
<p>The Audit Settings page appears.</p>
</li>
<li>
<p>Select the <span class="bold">Audited Objects</span> subpage.</p>
</li>
<li>
<p>Click <span class="bold">Add</span>.</p>
<p>The Add Audited Object page appears.</p>
</li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<p><span class="bold">Object Type</span>: Select <code>Table</code>.</p>
</li>
<li>
<p><span class="bold">Table</span>: Enter <code>OE.CUSTOMERS</code>.</p>
</li>
<li>
<p><span class="bold">Available Statements</span>: Select <code>SELECT</code>, and then click <span class="bold">Move</span> to move it to the Selected Statements list.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>Log out of Database Control.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BCGHBCAG"></a>
<div id="TDPSG55283" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 3: Test the Audit Settings</h3>
<p>At this stage, auditing is enabled and any <code>SELECT</code> statements performed on the <code>OE.CUSTOMERS</code> table are written to the to <code>DBA_AUDIT_TRAIL</code> data dictionary view. Now, you are ready to test the audit settings.</p>
<p class="orderedlisttitle">To test the audit settings: &nbsp;</p>
<ol>
<li>
<p>Start SQL*Plus, and connect as user <code>sec_admin</code>.</p>
<pre>
sqlplus sec_admin
Enter password: <span class="italic">password</span>
</pre></li>
<li id="BCGEDHIH">
<p>Enter the following <code>SELECT</code> statement to create an alert in the audit trail:</p>
<pre>
SELECT COUNT(*) FROM OE.CUSTOMERS;
</pre></li>
<li>
<p>Enter the following statement to view the <code>DBA_AUDIT_TRAIL</code> view:</p>
<pre>
SELECT USERNAME, SQL_TEXT, TIMESTAMP 
FROM DBA_AUDIT_TRAIL 
WHERE SQL_TEXT LIKE 'SELECT %';
</pre>
<p>For this <code>SELECT</code> statement, enter the text for the <code>SQL_TEXT</code> column (<code>'SELECT %'</code>) using the same case that you used when you entered the <code>SELECT</code> statement in Step <a href="#BCGEDHIH">2</a>. In other words, if you entered that <code>SELECT</code> statement in lowercase letters, then enter <code>'select %'</code> when you query the <code>DBA_AUDIT_TRAIL</code> view, not <code>'SELECT %'</code>.</p>
<p>Output similar to the following appears:</p>
<pre>
USERNAME          SQL_TEXT                                TIMESTAMP
----------------- --------------------------------------- ------------------
SEC_ADMIN         SELECT COUNT(*) FROM OE.CUSTOMERS       31-MAR-10
</pre></li>
<li>
<p>Exit SQL*Plus:</p>
<pre>
EXIT
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BCGFFHEH"></a>
<div id="TDPSG55284" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 4: Optionally, Remove the Components for This Tutorial</h3>
<p>Optionally, remove the audit settings that you created earlier.</p>
<p class="orderedlisttitle">To remove the audit settings in Database Control: &nbsp;</p>
<ol>
<li>
<p>Log in to Database Control as user <code>SYS</code> with the <code>SYSDBA</code> privilege.</p>
</li>
<li>
<p>Click <span class="bold">Server</span> to display the Server subpage.</p>
</li>
<li>
<p>In the Security section, click <span class="bold">Audit Settings</span>.</p>
<p>The Audit Settings page appears.</p>
</li>
<li>
<p>Select the <span class="bold">Audited Objects</span> subpage.</p>
</li>
<li>
<p>Under Schema, enter <code>OE</code>.</p>
</li>
<li>
<p>Under Object Name, enter <code>CUSTOMERS</code>.</p>
</li>
<li>
<p>Click <span class="bold">Search</span>.</p>
</li>
<li>
<p>Select the box next to the <code>OE.CUSTOMERS</code> audited schema, and then click <span class="bold">Remove</span>.</p>
<p>A Confirmation dialog box appears.</p>
</li>
<li>
<p>Select <span class="bold">Yes</span>.</p>
</li>
<li>
<p>Click the <span class="bold">Database Instance</span> link to return to the Database home page.</p>
</li>
<li>
<p>Select the <span class="bold">Server</span> subpage, and then under Database Configuration, select <span class="bold">Initialization Parameters</span>.</p>
</li>
<li>
<p>Select the <span class="bold">SPFile</span> subpage.</p>
</li>
<li>
<p>Find the <code>AUDIT_TRAIL</code> parameter and then set it to the original value. Click <span class="bold">Apply</span>.</p>
</li>
<li>
<p>Exit Database Control.</p>
</li>
<li>
<p>Restart the database:</p>
<pre>
sqlplus sys as sysoper
Enter password: <span class="italic">password</span>

SQL&gt; SHUTDOWN IMMEDIATE
SQL&gt; RESTART
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BCGJGFHB"></a>
<div id="TDPSG55285" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 5: Remove the SEC_ADMIN Security Administrator Account</h3>
<p><a id="sthref521"></a><a id="sthref522"></a>This is the last example in this guide. If you no longer need the <code>sec_admin</code> administrator account, then you should remove it.</p>
<p class="orderedlisttitle">To remove the sec_admin security administrator account: &nbsp;</p>
<ol>
<li>
<p>Log in to Database Control as user <code>SYSTEM</code>.</p>
<p>If Oracle Database Vault is enabled, then you must log on as the Database Vault Account Manager.</p>
</li>
<li>
<p>In the Database Control home page, click <span class="bold">Server</span> to display the Server subpage.</p>
</li>
<li>
<p>In the Security section, click <span class="bold">Users</span>.</p>
<p>The Users page appears.</p>
</li>
<li>
<p>In the <span class="bold">Name</span> field, enter <code>sec_admin</code>.</p>
</li>
<li>
<p>Click <span class="bold">Search</span>.</p>
</li>
<li>
<p>Select the selection box next to the <code>sec_admin</code> user account, and then click <span class="bold">Delete</span>.</p>
<p>A Confirmation dialog box appears.</p>
</li>
<li>
<p>Select <span class="bold">Yes</span>.</p>
</li>
<li>
<p>Exit Database<a id="sthref524"></a><a id="sthref525"></a> Control.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BCGJJBAA"></a>
<div id="TDPSG60068" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Guidelines for Auditing</h2>
<p>This<a id="sthref526"></a> section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDBEBEE">Guideline for Using Default Auditing of SQL Statements and Privileges</a></p>
</li>
<li>
<p><a href="#i1010870">Guidelines for Managing Audited Information</a></p>
</li>
<li>
<p><a href="#i1007821">Guidelines for Auditing Typical Database Activity</a></p>
</li>
<li>
<p><a href="#i1007822">Guidelines for Auditing Suspicious Database Activity</a></p>
</li>
</ul>
<a id="CHDBEBEE"></a>
<div id="TDPSG60681" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Guideline for Using Default Auditing of SQL Statements and Privileges</h3>
<p>When <a id="sthref527"></a>you create a new database, you can enable the auditing of a select set of SQL statements and privileges. Oracle recommends that you enable default auditing. Auditing is an effective method of enforcing strong internal controls so that your site meets its regulatory compliance requirements. See <a href="#CEGGCIAE">"Using Default Auditing for Security-Relevant SQL Statements and Privileges"</a> for more information about default auditing.</p>
</div>
<!-- class="sect2" -->
<a id="i1010870"></a>
<div id="TDPSG60682" class="sect2">
<h3 class="sect2">Guidelines for Managing Audited Information</h3>
<p>Although <a id="sthref528"></a><a id="sthref529"></a>auditing has a minimal impact on database performance, limit the number of audited events as much as possible. This minimizes the performance impact on the execution of audited statements and the size of the audit trail, making it easier to analyze and understand.</p>
<p>Follow these guidelines when devising an auditing strategy:</p>
<ol>
<li>
<p><span class="bold">Evaluate your reason for auditing.</span></p>
<p>After you understand of the reasons for auditing, you can devise an appropriate auditing strategy and avoid unnecessary auditing.</p>
<p>For example, suppose you are auditing to investigate suspicious database activity. This information by itself is not specific enough. What types of suspicious database activity do you suspect or have you noticed? A more focused auditing purpose might be to audit unauthorized deletions from arbitrary tables in the database. This purpose narrows the type of action being audited and the type of object being affected by the suspicious activity.</p>
</li>
<li>
<p><span class="bold">Audit knowledgeably.</span></p>
<p>Audit the minimum number of statements, users, or objects required to get the targeted information. This prevents unnecessary audit information from cluttering the meaningful information. Balance your need to gather sufficient security information with your ability to store and process it.</p>
<p>For example, if you are auditing to gather information about database activity, then determine exactly what types of activities you want to track, audit only the activities of interest, and audit only for the amount of time necessary to gather the information that you want. As another example, do not audit <span class="italic">objects</span> if you are only interested in logical I/O information for each session.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1007821"></a>
<div id="TDPSG60683" class="sect2">
<h3 class="sect2">Guidelines for Auditing Typical Database Activity</h3>
<p>When <a id="sthref530"></a><a id="sthref531"></a>your purpose for auditing is to gather historical information about particular database activities, follow these guidelines:</p>
<ol>
<li>
<p><span class="bold">Audit only pertinent actions.</span></p>
<p>To avoid cluttering meaningful information with useless audit records and to reduce the amount of audit trail administration, audit only the targeted database activities. You can audit specific actions by using fine-grained auditing. <a class="olink DBSEG525" href="../../network.112/e36292/auditing.htm#DBSEG525"><span class="italic">Oracle Database Security Guide</span></a> describes fine-grained auditing in detail.</p>
</li>
<li>
<p><span class="bold">Archive audit records and purge the audit trail.</span></p>
<p>After you collect the required information, archive the audit records of interest, and purge the audit trail of this information.</p>
<p>To archive audit records, you copy the relevant records to a database table, for example, using <code>INSERT INTO</code> <code><span class="codeinlineitalic">table</span></code> <code>SELECT ... FROM SYS.AUD$ ...</code> for the standard audit trail. (Fine-grained audit records are in the <code>SYS.FGA_LOG$</code> table.) Alternatively, you can export the audit trail table to an operating system<a id="sthref532"></a><a id="sthref533"></a> file. <a class="olink SUTIL200" href="../../server.112/e22490/dp_export.htm#SUTIL200"><span class="italic">Oracle Database Utilities</span></a> explains how to export tables by using Oracle Data Pump.</p>
<p>To purge audit records, you delete standard audit records from the <code>SYS.AUD$</code> table and fine-grained audit records from the <code>SYS.FGA_LOG$</code> table. For example, to delete <span class="italic">all</span> audit records from the standard audit trail, enter the following statement:</p>
<pre>
DELETE FROM SYS.AUD$;
</pre>
<p>Alternatively, to delete all audit records from the standard audit trail generated as a result of auditing the table <code>emp</code>, enter the following statement:</p>
<pre>
DELETE FROM SYS.AUD$ WHERE OBJ$NAME='EMP';
</pre></li>
<li>
<p><span class="bold">Follow the privacy considerations of your company.</span></p>
<p>Privacy regulations often lead to additional business privacy policies. Most privacy laws require businesses to monitor access to personally identifiable information (PII), and this type of monitoring is implemented by auditing. A business-level privacy policy should address all relevant aspects of data access and user accountability, including technical, legal, and company policy concerns.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1007822"></a>
<div id="TDPSG60684" class="sect2">
<h3 class="sect2">Guidelines for Auditing Suspicious Database Activity</h3>
<p>When <a id="sthref534"></a><a id="sthref535"></a>you audit to monitor suspicious database activity, follow these guidelines:</p>
<ol>
<li>
<p><span class="bold">Audit general information, and then audit specific information.</span></p>
<p>When you start to audit for suspicious database activity, often not much information is available to target specific users or schema objects. Therefore, set audit options more generally at first, that is, by using the standard audit options described in <a href="#BCGCCBCB">"Auditing General Activities Using Standard Auditing"</a>.</p>
<p>After you have recorded and analyzed the preliminary audit information, disable general auditing, and then audit specific actions. You can use fine-grained auditing, described in <a class="olink DBSEG525" href="../../network.112/e36292/auditing.htm#DBSEG525"><span class="italic">Oracle Database Security Guide</span></a>, to audit specific actions. Continue this process until you gather enough evidence to draw conclusions about the origin of the suspicious database activity.</p>
</li>
<li>
<p><span class="bold">Protect the audit trail.</span></p>
<p>When auditing for suspicious database activity, protect the audit trail so that audit information cannot be added, changed, or deleted without being audited. You audit the standard audit trail by using the <code>AUDIT</code> SQL statement. For example:</p>
<pre>
sqlplus sys as sysdba 
Enter password: <span class="italic">password</span>

SQL&gt; AUDIT SELECT ON SYS.AUD$ BY ACCESS; 
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BCGFHFAC"></a>
<div id="TDPSG50514" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Initialization Parameters Used for Auditing</h2>
<p><a href="#BCGEICEJ">Table 7-1</a> lists initialization parameters that you can use to secure auditing.</p>
<div id="TDPSG94425" class="tblhruleformalwide">
<p class="titleintable"><a id="sthref536"></a><a id="BCGEICEJ"></a>Table 7-1 Initialization Parameters Used for Auditing</p>
<table class="cellalignment1881" title="Initialization Parameters Used for Auditing" summary="Initialization Parameters Used for Auditing" dir="ltr">
<thead>
<tr class="cellalignment1875">
<th class="cellalignment1882" id="r1c1-t14">Initialization Parameter</th>
<th class="cellalignment1882" id="r1c2-t14">Default Setting</th>
<th class="cellalignment1882" id="r1c3-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1875">
<td class="cellalignment1883" id="r2c1-t14" headers="r1c1-t14">
<p><code>AUDIT_TRAIL</code><a id="sthref537"></a></p>
</td>
<td class="cellalignment1883" headers="r2c1-t14 r1c2-t14">
<p><code>DB</code></p>
</td>
<td class="cellalignment1883" headers="r2c1-t14 r1c3-t14">
<p>Enables or disables auditing. See <a href="#CEGIDHAG">"Enabling or Disabling the Standard Audit Trail"</a> for detailed information. For a full listing of the <code>AUDIT_TRAIL</code> parameters and an example of setting them, see <a class="olink DBSEG66232" href="../../network.112/e36292/auditing.htm#DBSEG66232"><span class="italic">Oracle Database Security Guide</span></a>.</p>
</td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883" id="r3c1-t14" headers="r1c1-t14">
<p><code>AUDIT_FILE_DEST</code><a id="sthref538"></a></p>
</td>
<td class="cellalignment1883" headers="r3c1-t14 r1c2-t14">
<p><code><span class="codeinlineitalic">ORACLE_BASE</span></code><code>/admin/</code><code><span class="codeinlineitalic">ORACLE_SID</span></code><code>/adump</code></p>
<p>or</p>
<p><code><span class="codeinlineitalic">ORACLE_HOME</span></code><code>/rdbms/audit</code></p>
</td>
<td class="cellalignment1883" headers="r3c1-t14 r1c3-t14">
<p>Specifies the operating system directory into which the audit trail is written when the <code>AUDIT_TRAIL</code> initialization parameter is set to <code>OS</code>, <code>XML</code>, or <code>XML,EXTENDED</code>. Oracle Database writes the audit records in XML format if the <code>AUDIT_TRAIL</code> initialization parameter is set to <code>XML</code>.</p>
<p>Oracle Database also writes mandatory auditing information to this location, and if the <code>AUDIT_SYS_OPERATIONS</code> initialization parameter is set, writes audit records for user <code>SYS</code>.</p>
</td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883" id="r4c1-t14" headers="r1c1-t14">
<p><code>AUDIT_SYS_OPERATIONS</code><a id="sthref539"></a></p>
</td>
<td class="cellalignment1883" headers="r4c1-t14 r1c2-t14">
<p><code>FALSE</code></p>
</td>
<td class="cellalignment1883" headers="r4c1-t14 r1c3-t14">
<p>Enables or disables the auditing of top-level operations directly issued by user <code>SYS</code>, and users connecting with <code>SYSDBA</code> or <code>SYSOPER</code> privilege. Oracle Database writes the audit records to the audit trail of the operating system. If you set the <code>AUDIT_TRAIL</code> initialization parameter to <code>XML</code> or <code>XML, EXTENDED</code>, it writes the audit records in XML format.</p>
<p>On UNIX systems, if you have also set the <code>AUDIT_SYSLOG_LEVEL</code> parameter, then it overrides the <code>AUDIT_TRAIL</code> parameter, which writes the <code>SYS</code> audit records to the system audit log using the <code>SYSLOG</code> utility.</p>
</td>
</tr>
<tr class="cellalignment1875">
<td class="cellalignment1883" id="r5c1-t14" headers="r1c1-t14">
<p><code>AUDIT_SYSLOG_LEVEL</code><a id="sthref540"></a></p>
</td>
<td class="cellalignment1883" headers="r5c1-t14 r1c2-t14">
<p>No default setting</p>
</td>
<td class="cellalignment1883" headers="r5c1-t14 r1c3-t14">
<p>On UNIX systems, writes the <code>SYS</code> and standard <code>OS</code> audit records to the system audit log using the <code>SYSLOG</code> utility.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" -->
<p>To modify an initialization parameter, see <a href="tdpsg_install_config.htm#CEGFIJIJ">"Modifying the Value of an Initialization Parameter"</a>. For detailed information about initialization parameters, see <a class="olink REFRN" href="../e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a> and <a class="olink ADMIN00202" href="../../server.112/e25494/create.htm#ADMIN00202"><span class="italic">Oracle Database Administrator's Guide</span></a>.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1874">
<tr>
<td class="cellalignment1883">
<table class="cellalignment1879">
<tr>
<td class="cellalignment1878"><a href="tdpsg_securing_data.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1878"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1885">
<table class="cellalignment1877">
<tr>
<td class="cellalignment1878"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1878"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1878"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1878"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1878"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1878"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
