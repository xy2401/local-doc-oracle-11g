<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Instantiation and Oracle Streams Replication</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 732" />
<meta name="dcterms.created" content="2013-06-04T12:45:23Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Streams Replication Administrator's Guide" />
<meta name="dcterms.identifier" content="E10705-10" />
<meta name="dcterms.isVersionOf" content="STREP" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2003, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="capply.htm" title="Previous" type="text/html" />
<link rel="Next" href="conflict.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10705.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">12/27</span> <!-- End Header -->
<div id="STREP012" class="chapter"><a id="g1012655"></a><a id="i1007780"></a>
<h1 class="chapter"><span class="secnum">8</span> Instantiation and Oracle Streams Replication</h1>
<p><a id="sthref250"></a>This chapter contains conceptual information about instantiation and Oracle Streams replication. It also contains instructions for preparing database objects for instantiation, performing instantiations, setting instantiation system change numbers (SCNs), and monitoring instantiations.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#i1007138">Overview of Instantiation and Oracle Streams Replication</a></p>
</li>
<li>
<p><a href="#i1007217">Capture Rules and Preparation for Instantiation</a></p>
</li>
<li>
<p><a href="#BABFCIJD">Oracle Data Pump and Oracle Streams Instantiation</a></p>
</li>
<li>
<p><a href="#BABDGBCG">Recovery Manager (RMAN) and Oracle Streams Instantiation</a></p>
</li>
<li>
<p><a href="#i1009604">Setting Instantiation SCNs at a Destination Database</a></p>
</li>
<li>
<p><a href="#i1012704">Monitoring Instantiation</a></p>
</li>
</ul>
<a id="i1007138"></a>
<div id="STREP113" class="sect1">
<h2 class="sect1">Overview of Instantiation and Oracle Streams Replication<a id="sthref251"></a><a id="sthref252"></a></h2>
<p>In an Oracle Streams environment that replicates a database object within a single database or between multiple databases, a source database is the database where changes to the object are generated, and a destination database is the database where these changes are dequeued by an apply process. If a capture process or synchronous capture captures, or will capture, such changes, and the changes will be applied locally or propagated to other databases and applied at destination databases, then you must <span class="bold">instantiate</span> these source database objects before you can replicate changes to the objects. If a database where changes to the source database objects will be applied is a different database than the source database, then the destination database must have a copy of these database objects.</p>
<p>In Oracle Streams, the following general steps instantiate a database object:</p>
<a id="i1007968"></a>
<ol>
<li id="BABEBICJ">
<p>Prepare the database object for instantiation at the source database.</p>
</li>
<li>
<p>If a copy of the database object does not exist at the destination database, then create a database object physically at the destination database based on a database object at the source database. You can use export/import, transportable tablespaces, or RMAN to copy database objects for instantiation. If the database object already exists at the destination database, then this step is not necessary.</p>
</li>
<li id="i1007983">
<p>Set the instantiation system change number (SCN) for the database object at the destination database. An instantiation SCN instructs an apply process at the destination database to apply only changes that committed at the source database after the specified&nbsp;SCN.</p>
</li>
</ol>
<p>All of these instantiation steps can be performed automatically when you use one of the following Oracle-supplied procedures in the <code>DBMS_STREAMS_ADM</code> package that configure replication environments:</p>
<ul>
<li>
<p><a class="olink ARPLS825" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS825"><code>MAINTAIN_GLOBAL</code></a></p>
</li>
<li>
<p><a class="olink ARPLS826" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS826"><code>MAINTAIN_SCHEMAS</code></a></p>
</li>
<li>
<p><a class="olink ARPLS863" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS863"><code>MAINTAIN_SIMPLE_TTS</code></a></p>
</li>
<li>
<p><a class="olink ARPLS827" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS827"><code>MAINTAIN_TABLES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS864" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS864"><code>MAINTAIN_TTS</code></a></p>
</li>
</ul>
<p>In some cases, Step <a href="#BABEBICJ">1</a> and Step <a href="#i1007983">3</a> are completed automatically. For example, when you add rules for a database object to the positive rule set of a capture process by running a procedure in the <code>DBMS_STREAMS_ADM</code> package, the database object is prepared for instantiation automatically.</p>
<p>Also, when you use export/import, transportable tablespaces, or the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command to copy database objects from a source database to a destination database, instantiation SCNs can be set for these database objects automatically.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The RMAN <code>DUPLICATE</code> command can instantiate an entire database, but this command does not set instantiation SCNs for database objects.</div>
<p>If the database object being instantiated is a table, then the tables at the source and destination database do not need to be an exact match. However, if some or all of the table data is replicated between the two databases, then the data that is replicated should be consistent when the table is instantiated. Whenever you plan to replicate changes to a database object, you must always prepare the database object for instantiation at the source database and set the instantiation SCN for the database object at the destination database. By preparing an object for instantiation, you are setting the lowest SCN for which changes to the object can be applied at destination databases. This SCN is called the ignore SCN. You should prepare a database object for instantiation after a capture process or synchronous capture has been configured to capture changes to the database object.</p>
<p><a id="sthref253"></a><a id="sthref254"></a>When you instantiate tables using export/import, transportable tablespaces, or RMAN, any supplemental log group specifications are retained for the instantiated tables. That is, after instantiation, log group specifications for imported tables at the import database are the same as the log group specifications for these tables at the export database. If you do not want to retain supplemental log group specifications for tables at the import database, then you can drop specific supplemental log groups after import.</p>
<p>Database supplemental logging specifications are not retained during export/import, even if you perform a full database export/import. However, the RMAN <code>DUPLICATE</code> command retains database supplemental logging specifications at the instantiated database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>During an export for an Oracle Streams instantiation, ensure that no data definition language (DDL) changes are made to objects being exported.</p>
</li>
<li>
<p>When you export a database or schema that contains rules with non-<code>NULL</code> action contexts, the database or the default tablespace of the schema that owns the rules must be writeable. If the database or tablespace is read-only, then export errors result.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STRMS213" href="../../server.112/e17069/strms_adapply.htm#STRMS213"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the oldest SCN for an apply process</p>
</li>
<li>
<p><a href="config_simple.htm#CACJHHAA">"Configuring Replication Using the DBMS_STREAMS_ADM Package"</a></p>
</li>
<li>
<p><a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a> for information about adding and dropping supplemental log groups</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1007217"></a>
<div id="STREP115" class="sect1">
<h2 class="sect1">Capture Rules and Preparation for Instantiation<a id="sthref255"></a><a id="sthref256"></a><a id="sthref257"></a><a id="sthref258"></a><a id="sthref259"></a></h2>
<p>The following subprograms in the <code>DBMS_CAPTURE_ADM</code> package prepare database objects for instantiation:</p>
<ul>
<li>
<p>The <code>PREPARE_TABLE_INSTANTIATION</code> procedure prepares a single table for instantiation when changes to the table will be captured by a capture process.</p>
</li>
<li>
<p>The <code>PREPARE_SYNC_INSTANTIATION</code> function prepares a single table or multiple tables for instantiation when changes to the table or tables will be captured by a synchronous capture.</p>
</li>
<li>
<p>The <code>PREPARE_SCHEMA_INSTANTIATION</code> procedure prepares for instantiation all of the database objects in a schema and all database objects added to the schema in the future. This procedure should only be used when changes will be captured by a capture process.</p>
</li>
<li>
<p>The <code>PREPARE_GLOBAL_INSTANTIATION</code> procedure prepares for instantiation all of the database objects in a database and all database objects added to the database in the future. This procedure should only be used when changes will be captured by a capture process.</p>
</li>
</ul>
<p>These procedures record the lowest system change number (SCN) of each object for instantiation. SCNs after the lowest SCN for an object can be used for instantiating the object.</p>
<p>If you use a capture process to capture changes, then these procedures also populate the Oracle Streams data dictionary for the relevant capture processes, propagations, and apply processes that capture, propagate, or apply changes made to the table, schema, or database being prepared for instantiation. In addition, if you use a capture process to capture changes, then these procedures optionally can enable supplemental logging for key columns or all columns in the tables that are being prepared for instantiation.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Replication with synchronous capture does not use the Oracle Streams data dictionary and does not require supplemental logging.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#i1009355">"Preparing Database Objects for Instantiation at a Source Database"</a></p>
</li>
<li>
<p><a href="prep_rep.htm#BABHBEAF">"Procedures That Automatically Specify Supplemental Logging"</a></p>
</li>
<li>
<p><a class="olink STRMS138" href="../../server.112/e17069/strms_adcapture.htm#STRMS138"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the Oracle Streams data dictionary</p>
</li>
</ul>
</div>
<a id="BABEIIEJ"></a>
<div id="STREP319" class="sect2">
<h3 class="sect2">DBMS_STREAMS_ADM Package Procedures Automatically Prepare Objects<a id="sthref260"></a></h3>
<p>When you add rules to the positive rule set for a capture process or synchronous capture by running a procedure in the <code>DBMS_STREAMS_ADM</code> package, a procedure or function in the <code>DBMS_CAPTURE_ADM</code> package is run automatically on the database objects where changes will be captured. <a href="#BABBJHGD">Table 8-1</a> lists which procedure or function is run in the <code>DBMS_CAPTURE_ADM</code> package when you run a procedure in the <code>DBMS_STREAMS_ADM</code> package.</p>
<div id="STREP320" class="tblhruleformal">
<p class="titleintable"><a id="sthref261"></a><a id="BABBJHGD"></a>Table 8-1 DBMS_CAPTURE_ADM Package Procedures That Are Run Automatically</p>
<table class="cellalignment1563" title="DBMS_CAPTURE_ADM Package Procedures That Are Run Automatically" summary="This table lists procedures that run automatically in DBMS_CAPTURE_ADM package when you run a procedure in the DBMS_STREAMS_ADM package." dir="ltr">
<thead>
<tr class="cellalignment1552">
<th class="cellalignment1564" id="r1c1-t7">When you run this procedure in the DBMS_STREAMS_ADM package</th>
<th class="cellalignment1564" id="r1c2-t7">This procedure or function in the DBMS_CAPTURE_ADM package is run automatically</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r2c1-t7" headers="r1c1-t7">
<p><code>ADD_TABLE_RULES</code></p>
<p><code>ADD_SUBSET_RULES</code></p>
</td>
<td class="cellalignment1558" headers="r2c1-t7 r1c2-t7">
<p><code>PREPARE_TABLE_INSTANTIATION</code> when rules are added to a capture process rule set</p>
<p><code>PREPARE_SYNC_INSTANTIATION</code> when rules are added to a synchronous capture rule set</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r3c1-t7" headers="r1c1-t7">
<p><code>ADD_SCHEMA_RULES</code></p>
</td>
<td class="cellalignment1558" headers="r3c1-t7 r1c2-t7">
<p><code>PREPARE_SCHEMA_INSTANTIATION</code></p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r4c1-t7" headers="r1c1-t7">
<p><code>ADD_GLOBAL_RULES</code></p>
</td>
<td class="cellalignment1558" headers="r4c1-t7 r1c2-t7">
<p><code>PREPARE_GLOBAL_INSTANTIATION</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>Multiple calls to prepare for instantiation are allowed. If you are using downstream capture, and the downstream capture process uses a database link from the downstream database to the source database, then the database objects are prepared for instantiation automatically when you run one of these procedures in the <code>DBMS_STREAMS_ADM</code> package. However, if the downstream capture process does not use a database link from the downstream database to the source database, then you must prepare the database objects for instantiation manually.</p>
<p>When capture process rules are created by the <code>DBMS_RULE_ADM</code> package instead of the <code>DBMS_STREAMS_ADM</code> package, you must run the appropriate procedure manually to prepare each table, schema, or database whose changes will be captured for instantiation, if you plan to apply changes that result from the capture process rules with an apply process.</p>
<p>In addition, some procedures automatically run these procedures. For example, the <a class="olink ARPLS827" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS827"><code>DBMS_STREAMS_ADM.MAINTAIN_TABLES</code></a> procedure automatically runs the <a class="olink ARPLS308" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS308"><code>ADD_TABLE_RULES</code></a> procedure.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A synchronous capture only captures changes based on rules created by the <code>ADD_TABLE_RULES</code> or <code>ADD_SUBSET_RULES</code> procedures.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="config_simple.htm#CACJHHAA">"Configuring Replication Using the DBMS_STREAMS_ADM Package"</a></div>
</div>
<!-- class="sect2" -->
<div id="STREP321" class="sect2"><a id="sthref262"></a>
<h3 class="sect2">When Preparing for Instantiation Is Required</h3>
<p>Whenever you add, or modify the condition of, a capture process, propagation, or apply process rule for a database object that is in a positive rule set, you must run the appropriate procedure to prepare the database object for instantiation at the source database if any of the following conditions are met:</p>
<ul>
<li>
<p>One or more rules are added to the positive rule set for a capture process that instruct the capture process to capture changes made to the object.</p>
</li>
<li>
<p>One or more conditions of rules in the positive rule set for a capture process are modified to instruct the capture process to capture changes made to the object.</p>
</li>
<li>
<p>One or more rules are added to the positive rule set for a propagation that instruct the propagation to propagate changes made to the object.</p>
</li>
<li>
<p>One or more conditions of rules in the positive rule set for a propagation are modified to instruct the propagation to propagate changes made to the object.</p>
</li>
<li>
<p>One or more rules are added to the positive rule set for an apply process that instruct the apply process to apply changes that were made to the object at the source database.</p>
</li>
<li>
<p>One or more conditions of rules in the positive rule set for an apply process are modified to instruct the apply process to apply changes that were made to the object at the source database.</p>
</li>
</ul>
<p>Whenever you remove, or modify the condition of, a capture process, propagation, or apply process rule for a database object that is in a negative rule set, you must run the appropriate procedure to prepare the database object for instantiation at the source database if any of the following conditions are met:</p>
<ul>
<li>
<p>One or more rules are removed from the negative rule set for a capture process to instruct the capture process to capture changes made to the object.</p>
</li>
<li>
<p>One or more conditions of rules in the negative rule set for a capture process are modified to instruct the capture process to capture changes made to the object.</p>
</li>
<li>
<p>One or more rules are removed from the negative rule set for a propagation to instruct the propagation to propagate changes made to the object.</p>
</li>
<li>
<p>One or more conditions of rules in the negative rule set for a propagation are modified to instruct the propagation to propagate changes made to the object.</p>
</li>
<li>
<p>One or more rules are removed from the negative rule set for an apply process to instruct the apply process to apply changes that were made to the object at the source database.</p>
</li>
<li>
<p>One or more conditions of rules in the negative rule set for an apply process are modified to instruct the apply process to apply changes that were made to the object at the source database.</p>
</li>
</ul>
<p>When any of these conditions are met for changes to a positive or negative rule set, you must prepare the relevant database objects for instantiation at the source database to populate any relevant Oracle Streams data dictionary that requires information about the source object, even if the object already exists at a remote database where the rules were added or changed.</p>
<p>The relevant Oracle Streams data dictionaries are populated asynchronously for both the local dictionary and all remote dictionaries. The procedure that prepares for instantiation adds information to the redo log at the source database. The local Oracle Streams data dictionary is populated with the information about the object when a capture process captures these redo entries, and any remote Oracle Streams data dictionaries are populated when the information is propagated to them.</p>
<p>Synchronous captures do not use Oracle Streams data dictionaries. However, when you are capturing changes to a database object with synchronous capture, you must prepare the database object for instantiation when you add rules for the database object to the synchronous capture rule set. Preparing the database object for instantiation is required when rules are added because it records the lowest SCN for instantiation for the database object. Preparing the database object for instantiation is not required when synchronous capture rules are modified, but modifications cannot change the database object name or schema in the rule condition.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#i1009355">"Preparing Database Objects for Instantiation at a Source Database"</a></p>
</li>
<li>
<p><a class="olink STRMS138" href="../../server.112/e17069/strms_adcapture.htm#STRMS138"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the Oracle Streams data dictionary</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABEAFCJ"></a>
<div id="STREP322" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Supplemental Logging Options During Preparation for Instantiation<a id="sthref263"></a><a id="sthref264"></a></h3>
<p>If a replication environment uses a capture process to capture changes, then supplemental logging is required. Supplemental logging places additional column data into a redo log whenever an operation is performed. The procedures in the <code>DBMS_CAPTURE_ADM</code> package that prepare database objects for instantiation include <code>PREPARE_TABLE_INSTANTIATION</code>, <code>PREPARE_SCHEMA_INSTANTIATION</code>, and <code>PREPARE_GLOBAL_INSTANTIATION</code>. These procedures have a <code>supplemental_logging</code> parameter which controls the supplemental logging specifications for the database objects being prepared for instantiation.</p>
<p><a href="#BABGIDGH">Table 8-2</a> describes the values for the <code>supplemental_logging</code> parameter for each procedure.</p>
<div id="STREP323" class="tblhruleformalwide">
<p class="titleintable"><a id="sthref265"></a><a id="BABGIDGH"></a>Table 8-2 Supplemental Logging Options During Preparation for Instantiation</p>
<table class="cellalignment1563" title="Supplemental Logging Options During Preparation for Instantiation" summary="This table describes the results of each setting of the supplemental_logging parameter in the procedures that prepare database objects for instantiation." dir="ltr">
<thead>
<tr class="cellalignment1552">
<th class="cellalignment1564" id="r1c1-t11">Procedure</th>
<th class="cellalignment1564" id="r1c2-t11">supplemental_logging Parameter Setting</th>
<th class="cellalignment1564" id="r1c3-t11">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r2c1-t11" headers="r1c1-t11">
<p><code>PREPARE_TABLE_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r2c1-t11 r1c2-t11">
<p><code>keys</code></p>
</td>
<td class="cellalignment1558" headers="r2c1-t11 r1c3-t11">
<p>The procedure enables supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the table being prepared for instantiation. The procedure places the logged columns for the table in three separate log groups: the primary key columns in an unconditional log group, the unique key columns and bitmap index columns in a conditional log group, and the foreign key columns in a conditional log group.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r3c1-t11" headers="r1c1-t11">
<p><code>PREPARE_TABLE_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r3c1-t11 r1c2-t11">
<p><code>all</code></p>
</td>
<td class="cellalignment1558" headers="r3c1-t11 r1c3-t11">
<p>The procedure enables supplemental logging for all columns in the table being prepared for instantiation. The procedure places all of the columns for the table in an unconditional log group.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r4c1-t11" headers="r1c1-t11">
<p><code>PREPARE_SCHEMA_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r4c1-t11 r1c2-t11">
<p><code>keys</code></p>
</td>
<td class="cellalignment1558" headers="r4c1-t11 r1c3-t11">
<p>The procedure enables supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the tables in the schema being prepared for instantiation and for any table added to this schema in the future. Primary key columns are logged unconditionally. Unique key, bitmap index, and foreign key columns are logged conditionally.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r5c1-t11" headers="r1c1-t11">
<p><code>PREPARE_SCHEMA_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r5c1-t11 r1c2-t11">
<p><code>all</code></p>
</td>
<td class="cellalignment1558" headers="r5c1-t11 r1c3-t11">
<p>The procedure enables supplemental logging for all columns in the tables in the schema being prepared for instantiation and for any table added to this schema in the future. The columns are logged unconditionally.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r6c1-t11" headers="r1c1-t11">
<p><code>PREPARE_GLOBAL_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r6c1-t11 r1c2-t11">
<p><code>keys</code></p>
</td>
<td class="cellalignment1558" headers="r6c1-t11 r1c3-t11">
<p>The procedure enables database supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the tables in the database being prepared for instantiation and for any table added to the database in the future. Primary key columns are logged unconditionally. Unique key, bitmap index, and foreign key columns are logged conditionally.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r7c1-t11" headers="r1c1-t11">
<p><code>PREPARE_GLOBAL_INSTANTIATION</code></p>
</td>
<td class="cellalignment1558" headers="r7c1-t11 r1c2-t11">
<p><code>all</code></p>
</td>
<td class="cellalignment1558" headers="r7c1-t11 r1c3-t11">
<p>The procedure enables supplemental logging for all columns in all of the tables in the database being prepared for instantiation and for any table added to the database in the future. The columns are logged unconditionally.</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r8c1-t11" headers="r1c1-t11">
<p>Any Prepare Procedure</p>
</td>
<td class="cellalignment1558" headers="r8c1-t11 r1c2-t11">
<p><code>none</code></p>
</td>
<td class="cellalignment1558" headers="r8c1-t11 r1c3-t11">
<p>The procedure does not enable supplemental logging for any columns in the tables being prepared for instantiation.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" -->
<p>If the <code>supplemental_logging</code> parameter is not specified when one of prepare procedures is run, then <code>keys</code> is the default. Some procedures in the <code>DBMS_STREAMS_ADM</code> package prepare tables for instantiation when they add rules to a positive capture process rule set. In this case, the default supplemental logging option, <code>keys</code>, is specified for the tables being prepared for instantiation.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>When <code>all</code> is specified for the <code>supplemental_logging</code> parameter, supplemental logging is not enabled for columns of the following types: LOB, <code>LONG</code>, <code>LONG</code> <code>RAW</code>, user-defined type, and Oracle-supplied type.</p>
</li>
<li>
<p>Specifying <code>keys</code> for the <code>supplemental_logging</code> parameter does not enable supplemental logging of bitmap join index columns.</p>
</li>
<li>
<p>Oracle Database 10<span class="italic">g</span> Release 2 introduced the <code>supplemental_logging</code> parameter for the prepare procedures. By default, running these procedures enables supplemental logging. Before this release, these procedures did not enable supplemental logging. If you remove an Oracle Streams environment, or if you remove certain database objects from an Oracle Streams environment, then you can also remove the supplemental logging enabled by these procedures to avoid unnecessary logging.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#i1009355">"Preparing Database Objects for Instantiation at a Source Database"</a></p>
</li>
<li>
<p><a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></p>
</li>
<li>
<p><a href="#BABEIIEJ">"DBMS_STREAMS_ADM Package Procedures Automatically Prepare Objects"</a></p>
</li>
<li>
<p><a href="#i1009356">"Aborting Preparation for Instantiation at a Source Database"</a> for information about removing supplemental logging enabled by the prepare procedures</p>
</li>
<li>
<p><a class="olink SQLRF0021" href="../../server.112/e41084/sql_elements001.htm#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1009355"></a>
<div id="STREP114" class="sect2">
<h3 class="sect2">Preparing Database Objects for Instantiation at a Source Database<a id="sthref266"></a><a id="sthref267"></a><a id="sthref268"></a><a id="sthref269"></a><a id="sthref270"></a><a id="sthref271"></a><a id="sthref272"></a></h3>
<p>If you use the <code>DBMS_STREAMS_ADM</code> package to create rules for a capture process or a synchronous capture, then any objects referenced in the system-created rules are prepared for instantiation automatically. If you use the <code>DBMS_RULE_ADM</code> package to create rules for a capture process, then you must prepare the database objects referenced in these rules for instantiation manually. In this case, you should prepare a database object for instantiation after a capture process has been configured to capture changes to the database object. Synchronous captures ignore rules created by the <code>DBMS_RULE_ADM</code> package.</p>
<p>See <a href="#i1007217">"Capture Rules and Preparation for Instantiation"</a> for information about the PL/SQL subprograms that prepare database objects for instantiation. If you run one of these procedures while a long running transaction is modifying one or more database objects being prepared for instantiation, then the procedure waits until the long running transaction is complete before it records the ignore&nbsp;SCN for the objects. The ignore SCN is the SCN below which changes to an object cannot be applied at destination databases. Query the <a class="olink REFRN30415" href="../../server.112/e40402/dynviews_3084.htm#REFRN30415"><code>V$STREAMS_TRANSACTION</code></a> dynamic performance view to monitor long running transactions being processed by a capture process or apply process.</p>
<p>The following sections contain examples that prepare database objects for instantiation:</p>
<ul>
<li>
<p><a href="#BABFHACF">Preparing Tables for Instantiation</a></p>
</li>
<li>
<p><a href="#BABIBAJJ">Preparing the Database Objects in a Schema for Instantiation</a></p>
</li>
<li>
<p><a href="#BABIBAIE">Preparing All of the Database Objects in a Database for Instantiation</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS212" href="../../server.112/e17069/strms_adapply.htm#STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the instantiation SCN and ignore SCN for an apply process</div>
<a id="BABFHACF"></a>
<div id="STREP324" class="sect3">
<h4 class="sect3">Preparing Tables for Instantiation</h4>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CIHBBEHG">Preparing a Table for Instantiation Using DBMS_STREAMS_ADM When a Capture Process Is Used</a></p>
</li>
<li>
<p><a href="#BABDFDFJ">Preparing a Table for Instantiation Using DBMS_CAPTURE_ADM When a Capture Process Is Used</a></p>
</li>
<li>
<p><a href="#CIHCGFII">Preparing Tables for Instantiation Using DBMS_STREAMS_ADM When a Synchronous Capture Is Used</a></p>
</li>
<li>
<p><a href="#BABCFJCF">Preparing Tables for Instantiation Using DBMS_CAPTURE_ADM When a Synchronous Capture Is Used</a></p>
</li>
</ul>
<a id="CIHBBEHG"></a>
<div id="STREP325" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing a Table for Instantiation Using DBMS_STREAMS_ADM When a Capture Process Is Used</h5>
<p>The example in this section prepares a table for instantiation using the <code>DBMS_STREAMS_ADM</code> package when a capture process captures changes to the table. To prepare the <code>hr.regions</code> table for instantiation and enable supplemental logging for any primary key, unique key, bitmap index, and foreign key columns in the table, add rules for the <code>hr.regions</code> table to the positive rule set for a capture process using a procedure in the <code>DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then the procedure that you run prepares this table for instantiation automatically.</p>
<p>The following procedure adds rules to the positive rule set of a capture process named <code>strm01_capture</code> and prepares the <code>hr.regions</code> table for instantiation:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name     =&gt; 'hr.regions',   
    streams_type   =&gt; 'capture',
    streams_name   =&gt; 'strm01_capture',
    queue_name     =&gt; 'strmadmin.strm01_queue',
    include_dml    =&gt; TRUE,
    include_ddl    =&gt; TRUE,
    inclusion_rule =&gt; TRUE);
END;
/
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
</div>
<!-- class="sect4" -->
<a id="BABDFDFJ"></a>
<div id="STREP326" class="sect4">
<h5 class="sect4">Preparing a Table for Instantiation Using DBMS_CAPTURE_ADM When a Capture Process Is Used</h5>
<p>The example in this section prepares a table for instantiation using the <code>DBMS_CAPTURE_ADM</code> package when a capture process captures changes to the table. To prepare the <code>hr.regions</code> table for instantiation and enable supplemental logging for any primary key, unique key, bitmap index, and foreign key columns in the table, run the following procedure:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.PREPARE_TABLE_INSTANTIATION(
    table_name           =&gt; 'hr.regions',
    supplemental_logging =&gt; 'keys');
END;
/
</pre>
<p>The default value for the <code>supplemental_logging</code> parameter is <code>keys</code>. Therefore, if this parameter is not specified, then supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the table that is being prepared for instantiation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
</div>
<!-- class="sect4" -->
<a id="CIHCGFII"></a>
<div id="STREP327" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing Tables for Instantiation Using DBMS_STREAMS_ADM When a Synchronous Capture Is Used</h5>
<p>The example in this section prepares all of the tables in the <code>hr</code> schema for instantiation using the <code>DBMS_STREAMS_ADM</code> package when a synchronous capture captures changes to the tables.Add rules for the <code>hr.jobs_transport</code> and <code>hr.regions_transport</code> tables to the positive rule set for a synchronous capture using a procedure in the <code>DBMS_STREAMS_ADM</code> package. The procedure that you run prepares the tables for instantiation automatically.</p>
<p>The following procedure adds a rule to the positive rule set of a synchronous capture named <code>sync_capture</code> and prepares the <code>hr.regions</code> table for instantiation:</p>
<pre>
BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name   =&gt; 'hr.regions',
    streams_type =&gt; 'sync_capture',
    streams_name =&gt; 'sync_capture',
    queue_name   =&gt; 'strmadmin.streams_queue');
END;
/
</pre></div>
<!-- class="sect4" -->
<a id="BABCFJCF"></a>
<div id="STREP328" class="sect4">
<h5 class="sect4">Preparing Tables for Instantiation Using DBMS_CAPTURE_ADM When a Synchronous Capture Is Used</h5>
<p>The example in this section prepares all of the tables in the <code>hr</code> schema for instantiation using the <code>DBMS_CAPTURE_ADM</code> package when a synchronous capture captures changes to the tables. To prepare the tables in the <code>hr</code> schema for instantiation, run the following function:</p>
<pre>
SET SERVEROUTPUT ON
DECLARE
  tables       DBMS_UTILITY.UNCL_ARRAY;
  prepare_scn  NUMBER;
  BEGIN
    tables(1) := 'hr.departments';
    tables(2) := 'hr.employees';
    tables(3) := 'hr.countries';
    tables(4) := 'hr.regions';
    tables(5) := 'hr.locations';
    tables(6) := 'hr.jobs';
    tables(7) := 'hr.job_history';
    prepare_scn := DBMS_CAPTURE_ADM.PREPARE_SYNC_INSTANTIATION(
                      table_names =&gt; tables);
  DBMS_OUTPUT.PUT_LINE('Prepare SCN = ' || prepare_scn);
END;
/
</pre></div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="BABIBAJJ"></a>
<div id="STREP329" class="sect3">
<h4 class="sect3">Preparing the Database Objects in a Schema for Instantiation</h4>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CIHFBJCE">Preparing the Database Objects in a Schema for Instantiation Using DBMS_STREAMS_ADM</a></p>
</li>
<li>
<p><a href="#CIHHBCEF">Preparing the Database Objects in a Schema for Instantiation Using DBMS_CAPTURE_ADM</a></p>
</li>
</ul>
<a id="CIHFBJCE"></a>
<div id="STREP330" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing the Database Objects in a Schema for Instantiation Using DBMS_STREAMS_ADM</h5>
<p>The example in this section prepares the database objects in a schema for instantiation using the <code>DBMS_STREAMS_ADM</code> package when a capture process captures changes to these objects.</p>
<p>To prepare the database objects in the <code>hr</code> schema for instantiation and enable supplemental logging for the all columns in the tables in the <code>hr</code> schema, run the following procedure, add rules for the <code>hr</code> schema to the positive rule set for a capture process using a procedure in the <code>DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then the procedure that you run prepares the objects in the <code>hr</code> schema for instantiation automatically.</p>
<p>The following procedure adds rules to the positive rule set of a capture process named <code>strm01_capture</code> and prepares the <code>hr</code> schema, and all of its database objects, for instantiation:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_SCHEMA_RULES(
    schema_name     =&gt;  'hr',
    streams_type    =&gt;  'capture',
    streams_name    =&gt;  'strm01_capture',
    queue_name      =&gt;  'strm01_queue',
    include_dml     =&gt;  TRUE,
    include_ddl     =&gt;  TRUE,
    inclusion_rule  =&gt;  TRUE);
END;
/
</pre>
<p>If the specified capture process does not exist, then this procedure creates it.</p>
<p>In addition, supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the tables that are being prepared for instantiation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
<a id="CIHHBCEF"></a>
<div id="STREP331" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing the Database Objects in a Schema for Instantiation Using DBMS_CAPTURE_ADM</h5>
<p>The example in this section prepares the database objects in a schema for instantiation using the <code>DBMS_CAPTURE_ADM</code> package when a capture process captures changes to these objects. To prepare the database objects in the <code>hr</code> schema for instantiation and enable supplemental logging for the all columns in the tables in the <code>hr</code> schema, run the following procedure:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.PREPARE_SCHEMA_INSTANTIATION(
    schema_name          =&gt; 'hr',
    supplemental_logging =&gt; 'all');
END;
/
</pre>
<p>After running this procedure, supplemental logging is enabled for all of the columns in the tables in the <code>hr</code> schema and for all of the columns in the tables added to the <code>hr</code> schema in the future.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
</div>
<!-- class="sect4" --></div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="BABIBAIE"></a>
<div id="STREP332" class="sect3">
<h4 class="sect3">Preparing All of the Database Objects in a Database for Instantiation</h4>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CIHDHFAH">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_STREAMS_ADM</a></p>
</li>
<li>
<p><a href="#CIHIECIB">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_CAPTURE_ADM</a></p>
</li>
</ul>
<a id="CIHDHFAH"></a>
<div id="STREP333" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_STREAMS_ADM</h5>
<p>The example in this section prepares the database objects in a database for instantiation using the <code>DBMS_STREAMS_ADM</code> package when a capture process captures changes to these objects. To prepare all of the database objects in a database for instantiation, run the <code>ADD_GLOBAL_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_RULES(
    streams_type   =&gt; 'capture',
    streams_name   =&gt; 'capture_db',
    queue_name     =&gt; 'strmadmin.streams_queue',
    include_dml    =&gt; TRUE,
    include_ddl    =&gt; TRUE,
    inclusion_rule =&gt; TRUE);
END;
/
</pre>
<p>If the specified capture process does not exist, then this procedure creates it.</p>
<p>In addition, supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the tables that are being prepared for instantiation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
<a id="CIHIECIB"></a>
<div id="STREP334" class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_CAPTURE_ADM</h5>
<p>The example in this section prepares the database objects in a database for instantiation using the <code>DBMS_CAPTURE_ADM</code> package when a capture process captures changes to these objects. To prepare all of the database objects in a database for instantiation, run the following procedure:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.PREPARE_GLOBAL_INSTANTIATION(
    supplemental_logging =&gt; 'none');
END;
/
</pre>
<p>Because <code>none</code> is specified for the <code>supplemental_logging</code> parameter, this procedure does not enable supplemental logging for any columns. However, you can specify supplemental logging manually using an <code>ALTER</code> <code>TABLE</code> or <code>ALTER</code> <code>DATABASE</code> statement.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#i1008208">"Specifying Supplemental Logging"</a></div>
</div>
<!-- class="sect4" --></div>
<!-- class="sect4" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1009356"></a>
<div id="STREP335" class="sect2">
<h3 class="sect2">Aborting Preparation for Instantiation at a Source Database<a id="sthref273"></a><a id="sthref274"></a><a id="sthref275"></a><a id="sthref276"></a><a id="sthref277"></a></h3>
<p>The following procedures in the <code>DBMS_CAPTURE_ADM</code> package abort preparation for instantiation:</p>
<ul>
<li>
<p><code>ABORT_TABLE_INSTANTIATION</code> reverses the effects of <code>PREPARE_TABLE_INSTANTIATION</code> and removes any supplemental logging enabled by the <code>PREPARE_TABLE_INSTANTIATION</code> procedure.</p>
</li>
<li>
<p><code>ABORT_SYNC_INSTANTIATION</code> reverses the effects of <code>PREPARE_SYNC_INSTANTIATION</code></p>
</li>
<li>
<p><code>ABORT_SCHEMA_INSTANTIATION</code> reverses the effects of <code>PREPARE_SCHEMA_INSTANTIATION</code> and removes any supplemental logging enabled by the <code>PREPARE_SCHEMA_INSTANTIATION</code> and <code>PREPARE_TABLE_INSTANTIATION</code> procedures.</p>
</li>
<li>
<p><code>ABORT_GLOBAL_INSTANTIATION</code> reverses the effects of <code>PREPARE_GLOBAL_INSTANTIATION</code> and removes any supplemental logging enabled by the <code>PREPARE_GLOBAL_INSTANTIATION</code>, <code>PREPARE_SCHEMA_INSTANTIATION</code>, and <code>PREPARE_TABLE_INSTANTIATION</code> procedures.</p>
</li>
</ul>
<p>These procedures remove data dictionary information related to the potential instantiation of the relevant database objects.</p>
<p>For example, to abort the preparation for instantiation of the <code>hr.regions</code> table, run the following procedure:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.ABORT_TABLE_INSTANTIATION(
    table_name  =&gt; 'hr.regions');
END;
/
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABFCIJD"></a>
<div id="STREP336" class="sect1">
<h2 class="sect1">Oracle Data Pump and Oracle Streams Instantiation<a id="sthref278"></a><a id="sthref279"></a></h2>
<p>The following sections contain information about performing Oracle Streams instantiations using Oracle Data Pump:</p>
<ul>
<li>
<p><a href="#CIHBDFJE">Data Pump Export and Object Consistency</a></p>
</li>
<li>
<p><a href="#CIHIBCIH">Oracle Data Pump Import and Oracle Streams Instantiation</a></p>
</li>
<li>
<p><a href="#i1013467">Instantiating Objects Using Data Pump Export/Import</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STRMS125" href="../../server.112/e17069/man_advanced.htm#STRMS125"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about performing a full database export/import on a database using Oracle Streams</p>
</li>
<li>
<p><a class="olink SUTIL100" href="../../server.112/e22490/dp_overview.htm#SUTIL100"><span class="italic">Oracle Database Utilities</span></a> for more information about Data Pump</p>
</li>
</ul>
</div>
<a id="CIHBDFJE"></a>
<div id="STREP337" class="sect2">
<h3 class="sect2">Data Pump Export and Object Consistency</h3>
<p>During export, Oracle Data Pump automatically uses Oracle Flashback to ensure that the exported data and the exported procedural actions for each database object are consistent to a single point in time. When you perform an instantiation in an Oracle Streams environment, some degree of consistency is required. Using the Data Pump Export utility is sufficient to ensure this consistency for Oracle Streams instantiations.</p>
<p>If you are using an export dump file for other purposes in addition to an Oracle Streams instantiation, and these other purposes have more stringent consistency requirements than those provided by Data Pump's default export, then you can use the Data Pump Export utility parameters <code>FLASHBACK_SCN</code> or <code>FLASHBACK_TIME</code> for Oracle Streams instantiations. For example, if an export includes objects with foreign key constraints, then more stringent consistency might be required.</p>
</div>
<!-- class="sect2" -->
<a id="CIHIBCIH"></a>
<div id="STREP338" class="sect2">
<h3 class="sect2">Oracle Data Pump Import and Oracle Streams Instantiation</h3>
<p>The following sections provide information about Oracle Data Pump import and Oracle Streams instantiation:</p>
<ul>
<li>
<p><a href="#CIHEJBJD">Instantiation SCNs and Data Pump Imports</a></p>
</li>
<li>
<p><a href="#CIHFBFJG">Instantiation SCNs and Oracle Streams Tags Resulting from Data Pump Imports</a></p>
</li>
<li>
<p><a href="#i1007357">The STREAMS_CONFIGURATION Data Pump Import Utility Parameter</a></p>
</li>
</ul>
<a id="CIHEJBJD"></a>
<div id="STREP339" class="sect3">
<h4 class="sect3">Instantiation SCNs and Data Pump Imports</h4>
<p>During a Data Pump import, an instantiation SCN is set at the import database for each database object that was prepared for instantiation at the export database before the Data Pump export was performed. The instantiation SCN settings are based on metadata obtained during Data Pump export.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS212" href="../../server.112/e17069/strms_adapply.htm#STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
</div>
<!-- class="sect3" -->
<a id="CIHFBFJG"></a>
<div id="STREP340" class="sect3">
<h4 class="sect3">Instantiation SCNs and Oracle Streams Tags Resulting from Data Pump Imports</h4>
<p>A Data Pump import session can set its Oracle Streams tag to the hexadecimal equivalent of <code>'00'</code> to avoid cycling the changes made by the import. Redo entries resulting from such an import have this tag value.</p>
<p>Whether the import session tag is set to the hexadecimal equivalent of <code>'00'</code> depends on the export that is being imported. Specifically, the import session tag is set to the hexadecimal equivalent of <code>'00'</code> in either of the following cases:</p>
<ul>
<li>
<p>The Data Pump export was in <code>FULL</code> or <code>SCHEMA</code> mode.</p>
</li>
<li>
<p>The Data Pump export was in <code>TABLE</code> or <code>TABLESPACE</code> mode and at least one table included in the export was prepared for instantiation at the export database before the export was performed.</p>
</li>
</ul>
<p>If neither one of these conditions is true for a Data Pump export that is being imported, then the import session tag is <code>NULL</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If you perform a network import using Data Pump, then an implicit export is performed in the same mode as the import. For example, if the network import is in schema mode, then the implicit export is in schema mode also.</p>
</li>
<li>
<p>The import session tag is not set if the Data Pump import is performed in <code>TRANSPORTABLE</code> <code>TABLESPACE</code> mode. An import performed in this mode does not generate any redo data for the imported data. Therefore, setting the session tag is not required.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="rep_tags.htm#g1014437">Chapter 10, "Oracle Streams Tags"</a></div>
</div>
<!-- class="sect3" -->
<a id="i1007357"></a>
<div id="STREP341" class="sect3">
<h4 class="sect3">The STREAMS_CONFIGURATION Data Pump Import Utility Parameter<a id="sthref280"></a><a id="sthref281"></a><a id="sthref282"></a><a id="sthref283"></a></h4>
<p>The <code>STREAMS_CONFIGURATION</code> Data Pump Import utility parameter specifies whether to import any general Oracle Streams metadata that is present in the export dump file. This import parameter is relevant only if you are performing a full database import. By default, the <code>STREAMS_CONFIGURATION</code> Import utility parameter is set to <code>y</code>. Typically, specify <code>y</code> if an import is part of a backup or restore operation.</p>
<p>The following objects are imported regardless of the <code>STREAMS_CONFIGURATION</code> setting if the information is present in the export dump file:</p>
<ul>
<li>
<p><code>ANYDATA</code> queues and their queue tables</p>
</li>
<li>
<p>Queue subscribers</p>
</li>
<li>
<p>Advanced Queuing agents</p>
</li>
<li>
<p>Rules, including their positive and negative rule sets and evaluation contexts. All rules are imported, including Oracle Streams rules and non-Oracle Streams rules. Oracle Streams rules are rules generated by the system when certain procedures in the <code>DBMS_STREAMS_ADM</code> package are run, while non-Oracle Streams rules are rules created using the <code>DBMS_RULE_ADM</code> package.</p>
<p>If the <code>STREAMS_CONFIGURATION</code> parameter is set to <code>n</code>, then information about Oracle Streams rules is not imported into the following data dictionary views: <code>ALL_STREAMS_RULES</code>, <code>ALL_STREAMS_GLOBAL_RULES</code>, <code>ALL_STREAMS_SCHEMA_RULES</code>, <code>ALL_STREAMS_TABLE_RULES</code>, <code>DBA_STREAMS_RULES</code>, <code>DBA_STREAMS_GLOBAL_RULES</code>, <code>DBA_STREAMS_SCHEMA_RULES</code>, and <code>DBA_STREAMS_TABLE_RULES</code>. However, regardless of the <code>STREAMS_CONFIGURATION</code> parameter setting, information about these rules is imported into the <code>ALL_RULES</code>, <code>ALL_RULE_SETS</code>, <code>ALL_RULE_SET_RULES</code>, <code>DBA_RULES</code>, <code>DBA_RULE_SETS</code>, <code>DBA_RULE_SET_RULES</code>, <code>USER_RULES</code>, <code>USER_RULE_SETS</code>, and <code>USER_RULE_SET_RULES</code> data dictionary views.</p>
</li>
</ul>
<p>When the <code>STREAMS_CONFIGURATION</code> Import utility parameter is set to <code>y</code>, the import includes the following information, if the information is present in the export dump file;&nbsp;when the <code>STREAMS_CONFIGURATION</code> Import utility parameter is set to <code>n</code>, the import does not include the following information:</p>
<ul>
<li>
<p>Capture processes that capture local changes, including the following information for each capture process:</p>
<ul>
<li>
<p>Name of the capture process</p>
</li>
<li>
<p>State of the capture process</p>
</li>
<li>
<p>Capture process parameter settings</p>
</li>
<li>
<p>Queue owner and queue name of the queue used by the capture process</p>
</li>
<li>
<p>Rule set owner and rule set name of each positive and negative rule set used by the capture process</p>
</li>
<li>
<p>Capture user for the capture process</p>
</li>
<li>
<p>The time that the status of the capture process last changed. This information is recorded in the <code>DBA_CAPTURE</code> data dictionary view.</p>
</li>
<li>
<p>If the capture process disabled or aborted, then the error number and message of the error that was the cause. This information is recorded in the <code>DBA_CAPTURE</code> data dictionary view.</p>
</li>
</ul>
</li>
<li>
<p>Synchronous captures, including the following information for each synchronous capture:</p>
<ul>
<li>
<p>Name of the synchronous capture</p>
</li>
<li>
<p>Queue owner and queue name of the queue used by the synchronous capture</p>
</li>
<li>
<p>Rule set owner and rule set name of each rule set used by the synchronous capture</p>
</li>
<li>
<p>Capture user for the synchronous capture</p>
</li>
</ul>
</li>
<li>
<p>If any tables have been prepared for instantiation at the export database, then these tables are prepared for instantiation at the import database.</p>
</li>
<li>
<p>If any schemas have been prepared for instantiation at the export database, then these schemas are prepared for instantiation at the import database.</p>
</li>
<li>
<p>If the export database has been prepared for instantiation, then the import database is prepared for instantiation.</p>
</li>
<li>
<p>The state of each <code>ANYDATA</code> queue that is used by an Oracle Streams client, either started or stopped. Oracle Streams clients include capture processes, synchronous captures, propagations, apply process, and messaging clients. <code>ANYDATA</code> queues themselves are imported regardless of the <code>STREAMS_CONFIGURATION</code> Import utility parameter setting.</p>
</li>
<li>
<p>Propagations, including the following information for each propagation:</p>
<ul>
<li>
<p>Name of the propagation</p>
</li>
<li>
<p>Queue owner and queue name of the source queue</p>
</li>
<li>
<p>Queue owner and queue name of the destination queue</p>
</li>
<li>
<p>Destination database link</p>
</li>
<li>
<p>Rule set owner and rule set name of each positive and negative rule set used by the propagation</p>
</li>
<li>
<p>Oracle Scheduler jobs related to Oracle Streams propagations</p>
</li>
</ul>
</li>
<li>
<p>Apply processes, including the following information for each apply process:</p>
<ul>
<li>
<p>Name of the apply process</p>
</li>
<li>
<p>State of the apply process</p>
</li>
<li>
<p>Apply process parameter settings</p>
</li>
<li>
<p>Queue owner and queue name of the queue used by the apply process</p>
</li>
<li>
<p>Rule set owner and rule set name of each positive and negative rule set used by the apply process</p>
</li>
<li>
<p>Whether the apply process applies captured LCRs in a buffered queue or messages in a persistent queue</p>
</li>
<li>
<p>Apply user for the apply process</p>
</li>
<li>
<p>Message handler used by the apply process, if one exists</p>
</li>
<li>
<p>DDL handler used by the apply process, if one exists.</p>
</li>
<li>
<p>Precommit handler used by the apply process, if one exists</p>
</li>
<li>
<p>Tag value generated in the redo log for changes made by the apply process</p>
</li>
<li>
<p>Apply database link, if one exists</p>
</li>
<li>
<p>Source database for the apply process</p>
</li>
<li>
<p>The information about apply progress in the <code>DBA_APPLY_PROGRESS</code> data dictionary view, including applied message number, oldest message number (oldest SCN), apply time, and applied message create time</p>
</li>
<li>
<p>Apply errors</p>
</li>
<li>
<p>The time that the status of the apply process last changed. This information is recorded in the <code>DBA_APPLY</code> data dictionary view</p>
</li>
<li>
<p>If the apply process disabled or aborted, then the error number and message of the error that was the cause. This information is recorded in the <code>DBA_APPLY</code> data dictionary view.</p>
</li>
</ul>
</li>
<li>
<p>DML handlers (including both statement DML handlers and procedure DML handlers)</p>
</li>
<li>
<p>Error handlers</p>
</li>
<li>
<p>Update conflict handlers</p>
</li>
<li>
<p>Substitute key columns for apply tables</p>
</li>
<li>
<p>Instantiation SCN for each apply object</p>
</li>
<li>
<p>Ignore SCN for each apply object</p>
</li>
<li>
<p>Messaging clients, including the following information for each messaging client:</p>
<ul>
<li>
<p>Name of the messaging client</p>
</li>
<li>
<p>Queue owner and queue name of the queue used by the messaging client</p>
</li>
<li>
<p>Rule set owner and rule set name of each positive and negative rule set used by the messaging client</p>
</li>
<li>
<p>Message notification settings</p>
</li>
</ul>
</li>
<li>
<p>Some data dictionary information about Oracle Streams rules. The rules themselves are imported regardless of the setting for the <code>STREAMS_CONFIGURATION</code> parameter.</p>
</li>
<li>
<p>Data dictionary information about Oracle Streams administrators, messaging clients, message rules, extra attributes included in logical change records (LCRs) captured by a capture process or synchronous capture, and extra attributes used in message rules</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Downstream capture processes are not included in an import regardless of the <code>STREAMS_CONFIGURATION</code> setting.</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1013467"></a>
<div id="STREP342" class="sect2">
<h3 class="sect2">Instantiating Objects Using Data Pump Export/Import<a id="sthref284"></a><a id="sthref285"></a></h3>
<p>The example in this section describes the steps required to instantiate objects in an Oracle Streams environment using Oracle Data Pump export/import. This example makes the following assumptions:</p>
<ul>
<li>
<p>You want to capture changes to all of the database objects in the <code>hr</code> schema at a source database and apply these changes at a separate destination database.</p>
</li>
<li>
<p>The <code>hr</code> schema exists at the source database but does not exist at the destination database. For the purposes of this example, you can drop the <code>hr</code> user at the destination database using the following SQL statement:</p>
<pre>
DROP USER hr CASCADE;
</pre>
<p>The Data Pump import re-creates the user and the user's database objects at the destination database.</p>
</li>
<li>
<p>You have configured an Oracle Streams administrator at the source database and the destination database named <code>strmadmin</code>. At each database, the Oracle Streams administrator is granted <code>DBA</code> role.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
The example in this section uses the command line Data Pump utility. You can also use the <code>DBMS_DATAPUMP</code> package for Oracle Streams instantiations.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a></p>
</li>
<li>
<p><a class="olink SUTIL100" href="../../server.112/e22490/dp_overview.htm#SUTIL100"><span class="italic">Oracle Database Utilities</span></a> for more information about Data Pump</p>
</li>
<li>
<p><a class="olink STREX" href="../e12862/toc.htm"><span class="italic">Oracle Streams Extended Examples</span></a> for examples that use the <code>DBMS_DATAPUMP</code> package for Oracle Streams instantiations</p>
</li>
</ul>
</div>
<p>Given these assumptions, complete the following steps to instantiate the <code>hr</code> schema using Data Pump export/import:</p>
<a id="i1013665"></a>
<ol>
<li>
<p>In SQL*Plus, connect to the source database as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li id="BABEHFJC">
<p>Create a directory object to hold the export dump file and export log file:</p>
<pre>
CREATE DIRECTORY DPUMP_DIR AS '/usr/dpump_dir';
</pre></li>
<li>
<p>Prepare the database objects in the <code>hr</code> schema for instantiation. See <a href="#BABIBAJJ">"Preparing the Database Objects in a Schema for Instantiation"</a> for instructions.</p>
</li>
<li>
<p>While still connected to the source database as the Oracle Streams administrator, determine the current system change number (SCN) of the source database:</p>
<pre>
SELECT DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER FROM DUAL;
</pre>
<p>The SCN value returned by this query is specified for the <code>FLASHBACK_SCN</code> Data Pump export parameter in Step <a href="#i1014585">5</a>. Because the <code>hr</code> schema includes foreign key constraints between tables, the <code>FLASHBACK_SCN</code> export parameter, or a similar export parameter, must be specified during export. In this example, assume that the query returned <code>876606</code>.</p>
<p>After you perform this query, ensure that no DDL changes are made to the objects being exported until after the export is complete.</p>
</li>
<li id="i1014585">
<p>On a command line, use Data Pump to export the <code>hr</code> schema at the source database.</p>
<p>Perform the export by connecting as an administrative user who is granted <code>EXP_FULL_DATABASE</code> role. This user also must have <code>READ</code> and <code>WRITE</code> privilege on the directory object created in Step <a href="#BABEHFJC">2</a>. This example connects as the Oracle Streams administrator <code>strmadmin</code>.</p>
<p>The following is a sample Data Pump export command:</p>
<pre>
expdp strmadmin SCHEMAS=hr DIRECTORY=DPUMP_DIR DUMPFILE=hr_schema_dp.dmp 
FLASHBACK_SCN=876606
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL200" href="../../server.112/e22490/dp_export.htm#SUTIL200"><span class="italic">Oracle Database Utilities</span></a> for information about performing a Data Pump export</div>
</li>
<li>
<p>In SQL*Plus, connect to the destination database as the Oracle Streams administrator.</p>
</li>
<li id="i1013790">
<p>Create a directory object to hold the import dump file and import log file:</p>
<pre>
CREATE DIRECTORY DPUMP_DIR AS '/usr/dpump_dir';
</pre></li>
<li>
<p>Transfer the Data Pump export dump file <code>hr_schema_dp.dmp</code> to the destination database. You can use the <code>DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer the file to the destination database. After the file transfer, the export dump file should reside in the directory that corresponds to the directory object created in Step <a href="#i1013790">7</a>.</p>
</li>
<li id="i1014723">
<p>On a command line at the destination database, use Data Pump to import the export dump file <code>hr_schema_dp.dmp</code>. Ensure that no changes are made to the tables in the schema being imported at the destination database until the import is complete. Performing the import automatically sets the instantiation SCN for the <code>hr</code> schema and all of its database objects at the destination database.</p>
<p>Perform the import by connecting as an administrative user who is granted <code>IMP_FULL_DATABASE</code> role. This user also must have <code>READ</code> and <code>WRITE</code> privilege on the directory object created in Step <a href="#i1013790">7</a>. This example connects as the Oracle Streams administrator <code>strmadmin</code>.</p>
<p>The following is a sample import command:</p>
<pre>
impdp strmadmin SCHEMAS=hr DIRECTORY=DPUMP_DIR DUMPFILE=hr_schema_dp.dmp
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Any table supplemental log groups for the tables exported from the export database are retained when the tables are imported at the import database. You can drop these supplemental log groups if necessary.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL300" href="../../server.112/e22490/dp_import.htm#SUTIL300"><span class="italic">Oracle Database Utilities</span></a> for information about performing a Data Pump import</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABDGBCG"></a>
<div id="STREP139" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Recovery Manager (RMAN) and Oracle Streams Instantiation<a id="sthref286"></a><a id="sthref287"></a></h2>
<p>The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command can instantiate a tablespace or set of tablespaces, and the RMAN <code>DUPLICATE</code> and <code>CONVERT</code> <code>DATABASE</code> commands can instantiate an entire database. Using RMAN for instantiation usually is faster than other instantiation methods.</p>
<p>The following sections contain information about using these RMAN commands for instantiation:</p>
<ul>
<li>
<p><a href="#i1008748">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN</a></p>
</li>
<li>
<p><a href="#i1008848">Instantiating an Entire Database Using RMAN</a></p>
</li>
</ul>
<a id="i1008748"></a>
<div id="STREP343" class="sect2">
<h3 class="sect2">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN<a id="sthref288"></a><a id="sthref289"></a><a id="sthref290"></a><a id="sthref291"></a></h3>
<p>The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command uses Data Pump and an RMAN-managed auxiliary instance to export the database objects in a tablespace or tablespace set while the tablespace or tablespace set remains online in the source database. RMAN automatically starts an auxiliary instance with a system-generated name. The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command produces a Data Pump export dump file and data files for the tablespace or tablespaces.</p>
<p>You can use Data Pump to import the dump file at the destination database, or you can use the <code>ATTACH_TABLESPACES</code> procedure in the <code>DBMS_STREAMS_TABLESPACE_ADM</code> package to attach the tablespace or tablespaces to the destination database. Also, instantiation SCN values for the database objects in the tablespace or tablespaces are set automatically at the destination database when the tablespaces are imported or attached.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command does not support user-managed auxiliary instances.</div>
<p>The examples in this section describe the steps required to instantiate the database objects in a tablespace using transportable tablespace or RMAN. These instantiation options usually are faster than export/import. The following examples instantiate the database objects in a tablespace:</p>
<ul>
<li>
<p><a href="#BABEICGE">"Instantiating Objects Using Transportable Tablespace"</a> uses the transportable tablespace feature to complete the instantiation. Data Pump exports the tablespace at the source database and imports the tablespace at the destination database. The tablespace is read-only during the export.</p>
</li>
<li>
<p><a href="#BABIJHIC">"Instantiating Objects Using Transportable Tablespace From Backup With RMAN"</a> uses the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command to generate a Data Pump export dump file and data files for a tablespace or set of tablespaces at the source database while the tablespace or tablespaces remain online. Either Data Pump import or the <code>ATTACH_TABLESPACES</code> procedure in the <code>DBMS_STREAMS_TABLESPACE_ADM</code> package can add the tablespace or tablespaces to the destination database.</p>
</li>
</ul>
<p>These examples instantiate a tablespace set that includes a tablespace called <code>jobs_tbs</code>, and a tablespace called <code>regions_tbs</code>. To run the examples, connect to the source database in SQL*Plus as an administrative user and create the new tablespaces:</p>
<pre>
CREATE TABLESPACE jobs_tbs DATAFILE '/usr/oracle/dbs/jobs_tbs.dbf' SIZE 5 M;

CREATE TABLESPACE regions_tbs DATAFILE '/usr/oracle/dbs/regions_tbs.dbf' SIZE 5 M;
</pre>
<p>Place the new table <code>hr.jobs_transport</code> in the <code>jobs_tbs</code> tablespace:</p>
<pre>
CREATE TABLE hr.jobs_transport TABLESPACE jobs_tbs AS 
  SELECT * FROM hr.jobs;
</pre>
<p>Place the new table <code>hr.regions_transport</code> in the <code>regions_tbs</code> tablespace:</p>
<pre>
CREATE TABLE hr.regions_transport TABLESPACE regions_tbs AS 
  SELECT * FROM hr.regions;
</pre>
<p>Both of the examples make the following assumptions:</p>
<ul>
<li>
<p>You want to capture all of the changes to the <code>hr.jobs_transport</code> and <code>hr.regions_transport</code> tables at a source database and apply these changes at a separate destination database.</p>
</li>
<li>
<p>The <code>hr.jobs_transport</code> table exists at a source database, and a single self-contained tablespace named <code>jobs_tbs</code> contains the table. The <code>jobs_tbs</code> tablespace is stored in a single data file named <code>jobs_tbs.dbf</code>.</p>
</li>
<li>
<p>The <code>hr.regions_transport</code> table exists at a source database, and a single self-contained tablespace named <code>regions_tbs</code> contains the table. The <code>regions_tbs</code> tablespace is stored in a single data file named <code>regions_tbs.dbf</code>.</p>
</li>
<li>
<p>The <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces do not contain data from any other schemas.</p>
</li>
<li>
<p>The <code>hr.jobs_transport</code> table, the <code>hr.regions_transport</code> table, the <code>jobs_tbs</code> tablespace, and the <code>regions_tbs</code> tablespace do not exist at the destination database.</p>
</li>
<li>
<p>You have configured an Oracle Streams administrator at both the source database and the destination database named <code>strmadmin</code>, and you have granted this Oracle Streams administrator <code>DBA</code> role at both databases.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="man_comp.htm#BABEHCGE">"Checking for Consistency After Instantiation"</a></p>
</li>
<li>
<p><a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a></p>
</li>
<li>
<p><a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus</p>
</li>
</ul>
</div>
<a id="BABEICGE"></a>
<div id="STREP344" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Instantiating Objects Using Transportable Tablespace</h4>
<p>This example uses transportable tablespace to instantiate the database objects in a tablespace set. In addition to the assumptions listed in <a href="#i1008748">"Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN"</a>, this example makes the following assumptions:</p>
<ul>
<li>
<p>The Oracle Streams administrator at the source database is granted the <code>EXP_FULL_DATABASE</code> role to perform the transportable tablespaces export. The <code>DBA</code> role is sufficient because it includes the <code>EXP_FULL_DATABASE</code> role. In this example, the Oracle Streams administrator performs the transportable tablespaces export.</p>
</li>
<li>
<p>The Oracle Streams administrator at the destination database is granted the <code>IMP_FULL_DATABASE</code> role to perform the transportable tablespaces import. The <code>DBA</code> role is sufficient because it includes the <code>IMP_FULL_DATABASE</code> role. In this example, the Oracle Streams administrator performs the transportable tablespaces export.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN01101" href="../../server.112/e25494/tspaces.htm#ADMIN01101"><span class="italic">Oracle Database Administrator's Guide</span></a> for more information about using transportable tablespaces and for information about limitations that might apply</div>
<p>Complete the following steps to instantiate the database objects in the <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces using transportable tablespace:</p>
<a id="i1013992"></a>
<ol>
<li>
<p>In SQL*Plus, connect to the source database as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Create a directory object to hold the export dump file and export log file:</p>
<pre>
CREATE DIRECTORY TRANS_DIR AS '/usr/trans_dir';
</pre></li>
<li>
<p>Prepare the <code>hr.jobs_transport</code> and <code>hr.regions_transport</code> tables for instantiation. See <a href="#BABFHACF">"Preparing Tables for Instantiation"</a> for instructions.</p>
</li>
<li>
<p>Make the tablespaces that contain the objects you are instantiating read-only. In this example, the <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces contain the database objects.</p>
<pre>
ALTER TABLESPACE jobs_tbs READ ONLY;

ALTER TABLESPACE regions_tbs READ ONLY;
</pre></li>
<li id="i1008809">
<p>On a command line, use the Data Pump Export utility to export the <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces at the source database using transportable tablespaces export parameters. The following is a sample export command that uses transportable tablespaces export parameters:</p>
<pre>
expdp strmadmin TRANSPORT_TABLESPACES=jobs_tbs, regions_tbs 
DIRECTORY=TRANS_DIR DUMPFILE=tbs_ts.dmp
</pre>
<p>When you run the export command, ensure that you connect as an administrative user who was granted <code>EXP_FULL_DATABASE</code> role and has <code>READ</code> and <code>WRITE</code> privileges on the directory object.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about performing an export</div>
</li>
<li>
<p>In SQL*Plus, connect to the destination database as the Oracle Streams administrator.</p>
</li>
<li id="i1014027">
<p>Create a directory object to hold the import dump file and import log file:</p>
<pre>
CREATE DIRECTORY TRANS_DIR AS '/usr/trans_dir';
</pre></li>
<li>
<p>Transfer the data files for the tablespaces and the export dump file <code>tbs_ts.dmp</code> to the destination database. You can use the <code>DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer these files to the destination database. After the file transfer, the export dump file should reside in the directory that corresponds to the directory object created in Step <a href="#i1014027">7</a>.</p>
</li>
<li>
<p>On a command line at the destination database, use the Data Pump Import utility to import the export dump file <code>tbs_ts.dmp</code> using transportable tablespaces import parameters. Performing the import automatically sets the instantiation SCN for the <code>hr.jobs_transport</code> and <code>hr.regions_transport</code> tables at the destination database.</p>
<p>The following is an example import command:</p>
<pre>
impdp strmadmin DIRECTORY=TRANS_DIR DUMPFILE=tbs_ts.dmp 
TRANSPORT_DATAFILES=/usr/orc/dbs/jobs_tbs.dbf,/usr/orc/dbs/regions_tbs.dbf
</pre>
<p>When you run the import command, ensure that you connect as an administrative user who was granted <code>IMP_FULL_DATABASE</code> role and has <code>READ</code> and <code>WRITE</code> privileges on the directory object.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about performing an import</div>
</li>
<li>
<p>If necessary, at both the source database and the destination database, connect as the Oracle Streams administrator and put the tablespaces into read/write mode:</p>
<pre>
ALTER TABLESPACE jobs_tbs READ WRITE;

ALTER TABLESPACE regions_tbs READ WRITE;
</pre></li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Any table supplemental log groups for the tables exported from the export database are retained when tables are imported at the import database. You can drop these supplemental log groups if necessary.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="man_comp.htm#BABEHCGE">"Checking for Consistency After Instantiation"</a></div>
</div>
<!-- class="sect3" -->
<a id="BABIJHIC"></a>
<div id="STREP143" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Instantiating Objects Using Transportable Tablespace From Backup With RMAN</h4>
<p>The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command uses Data Pump and an RMAN-managed auxiliary instance to export the database objects in a tablespace or tablespace set while the tablespace or tablespace set remains online in the source database. The RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command produces a Data Pump export dump file and data files, and you can use these files to perform a Data Pump import of the tablespace or tablespaces at the destination database. You can also use the <code>ATTACH_TABLESPACES</code> procedure in the <code>DBMS_STREAMS_TABLESPACE_ADM</code> package to attach the tablespace or tablespaces at the destination database.</p>
<p>In addition to the assumptions listed in <a href="#i1008748">"Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN"</a>, this example makes the following assumptions:</p>
<ul>
<li>
<p>The source database is <code>tts1.example.com</code>.</p>
</li>
<li>
<p>The destination database is <code>tts2.example.com</code>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV05141" href="../../backup.112/e10642/rcmttbsb.htm#BRADV05141"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions on using the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command</div>
<p>Complete the following steps to instantiate the database objects in the <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces using transportable tablespaces and RMAN:</p>
<ol>
<li>
<p>Create a backup of the source database that includes the tablespaces being instantiated, if a backup does not exist. RMAN requires a valid backup for tablespace cloning. In this example, create a backup of the source database that includes the <code>jobs_tbs</code> and <code>regions_tbs</code> tablespaces if one does not exist.</p>
</li>
<li>
<p>In SQL*Plus, connect to the source database <code>tts1.example.com</code> as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Optionally, create a directory object to hold the export dump file and export log file:</p>
<pre>
CREATE DIRECTORY SOURCE_DIR AS '/usr/db_files';
</pre>
<p>This step is optional because the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command creates a directory object named <code>STREAMS_DIROBJ_DPDIR</code> on the auxiliary instance if the <code>DATAPUMP</code> <code>DIRECTORY</code> parameter is omitted when you run this command in Step <a href="#BABIIBDE">9</a>.</p>
</li>
<li>
<p>Prepare the <code>hr.jobs_transport</code> and <code>hr.regions_transport</code> tables for instantiation. See <a href="#BABFHACF">"Preparing Tables for Instantiation"</a> for instructions.</p>
</li>
<li>
<p>Determine the until SCN for the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command:</p>
<pre>
SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  until_scn NUMBER;
BEGIN
  until_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Until SCN: ' || until_scn);
END;
/
</pre>
<p>Make a note of the until SCN returned. You will use this number in Step <a href="#BABIIBDE">9</a>. For this example, assume that the returned until SCN is&nbsp;<code>7661956</code>.</p>
<p>Optionally, you can skip this step. In this case, do not specify the until clause in the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command in Step <a href="#BABIIBDE">9</a>. When no until clause is specified, RMAN uses the last archived redo log file to determine the until SCN automatically.</p>
</li>
<li>
<p>In SQL*Plus, connect to the source database tts1.net as an administrative user.</p>
</li>
<li>
<p>Archive the current online redo log:</p>
<pre>
ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></li>
<li>
<p>Start the RMAN client, and connect to the source database <code>tts1.example.com</code> as <code>TARGET</code>.</p>
<p>See <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code>CONNECT</code> command</p>
</li>
<li id="BABIIBDE">
<p>At the source database <code>tts1.example.com</code>, use the RMAN <code>TRANSPORT</code> <code>TABLESPACE</code> command to generate the dump file for the tablespace set:</p>
<pre>
RMAN&gt; RUN
      { 
        TRANSPORT TABLESPACE 'jobs_tbs', 'regions_tbs'
        UNTIL SCN 7661956
        AUXILIARY DESTINATION '/usr/aux_files'
        DATAPUMP DIRECTORY SOURCE_DIR 
        DUMP FILE 'jobs_regions_tbs.dmp' 
        EXPORT LOG 'jobs_regions_tbs.log'
        IMPORT SCRIPT 'jobs_regions_tbs_imp.sql'
        TABLESPACE DESTINATION '/orc/dbs';
      }
</pre>
<p>The <code>TRANSPORT</code> <code>TABLESPACE</code> command places the files in the following directories on the computer system that runs the source database:</p>
<ul>
<li>
<p>The directory that corresponds to the <code>SOURCE_DIR</code> directory object (<code>/usr/db_files</code>) contains the export dump file and export log file.</p>
</li>
<li>
<p>The <code>/orc/dbs</code> directory contains the generated data files for the tablespaces and the import script. You use this script to complete the instantiation by attaching the tablespace at the destination database.</p>
</li>
</ul>
</li>
<li id="BABGEIIA">
<p>Modify the import script, if necessary. You might need to modify one or both of the following items in the script:</p>
<ul>
<li>
<p>You might want to change the method used to make the exported tablespaces part of the destination database. The import script includes two ways to make the exported tablespaces part of the destination database: a Data Pump import command (<code>impdp</code>), and a script for attaching the tablespaces using the <code>ATTACH_TABLESPACES</code> procedure in the <code>DBMS_STREAMS_TABLESPACE_ADM</code> package.</p>
<p>The default script uses the attach tablespaces method. The Data Pump import command is commented out. To use Data Pump import, remove the comment symbols (<code>/*</code> and <code>*/</code>) surrounding the impdp command, and either surround the attach tablespaces script with comments or remove the attach tablespaces script. The attach tablespaces script starts with <code>SET</code> <code>SERVEROUTPUT</code> <code>ON</code> and continues to the end of the file.</p>
</li>
<li>
<p>You might need to change the directory paths specified in the script. In Step <a href="#BABJGHAC">11</a>, you will transfer the import script (<code>jobs_regions_tbs_imp.sql</code>), the Data Pump export dump file (<code>jobs_regions_tbs.dmp</code>), and the generated data file for each tablespace (<code>jobs_tbs.dbf</code> and <code>regions_tbs.dbf</code>) to one or more directories on the computer system running the destination database. Ensure that the directory paths specified in the script are the correct directory paths.</p>
</li>
</ul>
</li>
<li id="BABJGHAC">
<p>Transfer the import script (<code>jobs_regions_tbs_imp.sql</code>), the Data Pump export dump file (<code>jobs_regions_tbs.dmp</code>), and the generated data file for each tablespace (<code>jobs_tbs.dbf</code> and <code>regions_tbs.dbf</code>) to the destination database. You can use the <code>DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer the file to the destination database. After the file transfer, these files should reside in the directories specified in the import script.</p>
</li>
<li>
<p>In SQL*Plus, connect to the destination database <code>tts2.example.com</code> as the Oracle Streams administrator.</p>
</li>
<li>
<p>Run the import script:</p>
<pre>
SET ECHO ON
SPOOL jobs_tbs_imp.out
@jobs_tbs_imp.sql
</pre>
<p>When the script completes, check the <code>jobs_tbs_imp.out</code> spool file to ensure that all actions finished successfully.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="man_comp.htm#BABEHCGE">"Checking for Consistency After Instantiation"</a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1008848"></a>
<div id="STREP345" class="sect2">
<h3 class="sect2">Instantiating an Entire Database Using RMAN<a id="sthref292"></a></h3>
<p>The Recovery Manager (RMAN) <code>DUPLICATE</code> command creates a copy of the target database in another location. The command uses an RMAN auxiliary instance to restore backups of the target database files and create a new database. In an Oracle Streams instantiation, the target database is the source database and the new database that is created is the destination database. The RMAN <code>DUPLICATE</code> command requires that the source and destination database run on the same platform.</p>
<p>The RMAN <code>CONVERT</code> <code>DATABASE</code> command generates the data files and an initialization parameter file for a new destination database on a different platform. It also generates a script that creates the new destination database. These files can instantiate an entire destination database that runs on a different platform than the source database but has the same endian format as the source database.</p>
<p>The RMAN <code>DUPLICATE</code> and <code>CONVERT</code> <code>DATABASE</code> commands do not set the instantiation SCN values for the database objects. The instantiation SCN values must be set manually during instantiation.</p>
<p>The examples in this section describe the steps required to instantiate an entire database using the RMAN <code>DUPLICATE</code> command or <code>CONVERT</code> <code>DATABASE</code> command. To use one of these RMAN commands for full database instantiation, complete the following general steps:</p>
<ol>
<li>
<p>Copy the entire source database to the destination site using the RMAN command.</p>
</li>
<li>
<p>Remove the Oracle Streams configuration at the destination site using the <code>REMOVE_STREAMS_CONFIGURATION</code> procedure in the <code>DBMS_STREAMS_ADM</code> package.</p>
</li>
<li id="i1008857">
<p>Configure Oracle Streams destination site, including configuration of one or more apply processes to apply changes from the source database.</p>
</li>
</ol>
<p>You can complete this process without stopping any running capture processes or propagations at the source database.</p>
<p>Follow the instructions in one of these sections:</p>
<ul>
<li>
<p><a href="#BABCHBEE">Instantiating an Entire Database on the Same Platform Using RMAN</a></p>
</li>
<li>
<p><a href="#BABFJJCE">Instantiating an Entire Database on Different Platforms Using RMAN</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>To configure an Oracle Streams replication environment that replicates all of the supported changes for an entire database, you can use the <code>PRE_INSTANTIATION_SETUP</code> and <code>POST_INSTANTIATION_SETUP</code> procedures in the <code>DBMS_STREAMS_ADM</code> package. See <a href="config_simple.htm#CACGFIJH">"Configuring Two-Database Global Replication with Local Capture"</a> for instructions.</p>
</li>
<li>
<p>Oracle recommends that you do not use RMAN for instantiation in an environment where distributed transactions are possible. Doing so can cause in-doubt transactions that must be corrected manually. Use export/import or transportable tablespaces for instantiation instead.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a> for information about configuring an Oracle Streams administrator</div>
<a id="BABCHBEE"></a>
<div id="STREP346" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Instantiating an Entire Database on the Same Platform Using RMAN<a id="sthref293"></a><a id="sthref294"></a></h4>
<p>The example in this section instantiates an entire database using the RMAN <code>DUPLICATE</code> command. The example makes the following assumptions:</p>
<ul>
<li>
<p>You want to capture all of the changes made to a source database named <code>dpx1.example.com</code>, propagate these changes to a separate destination database named <code>dpx2.example.com</code>, and apply these changes at the destination database.</p>
</li>
<li>
<p>You have configured an Oracle Streams administrator at the source database named <code>strmadmin</code>. See <a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a>.</p>
</li>
<li>
<p>The <code>dpx1.example.com</code> and <code>dpx2.example.com</code> databases run on the same platform.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV010" href="../../backup.112/e10642/rcmdupdb.htm#BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions about using the RMAN <code>DUPLICATE</code> command</div>
<p>Complete the following steps to instantiate an entire database using RMAN when the source and destination databases run on the same platform:</p>
<ol>
<li id="BABDJCJA">
<p>Create a backup of the source database if one does not exist. RMAN requires a valid backup for duplication. In this example, create a backup of <code>dpx1.example.com</code> if one does not exist.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A backup of the source database is not necessary if you use the <code>FROM</code> <code>ACTIVE</code> <code>DATABASE</code> option when you run the RMAN <code>DUPLICATE</code> command. For large databases, the <code>FROM</code> <code>ACTIVE</code> <code>DATABASE</code> option requires significant network resources. This example does not use this option.</div>
</li>
<li>
<p>In SQL*Plus, connect to the source database <code>dpx1.example.com</code> as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Create an <code>ANYDATA</code> queue to stage the changes from the source database if such a queue does not already exist. This queue will stage changes that will be propagated to the destination database after it has been configured.</p>
<p>For example, the following procedure creates a queue named <code>streams_queue</code>:</p>
<pre>
EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre>
<p>Remain connected as the Oracle Streams administrator in SQL*Plus at the source database through Step <a href="#i1012121">9</a>.</p>
</li>
<li>
<p>Create a database link from <code>dpx1.example.com</code> to <code>dpx2.example.com</code>:</p>
<pre>
CREATE DATABASE LINK dpx2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'dpx2.example.com';
</pre></li>
<li id="i1008892">
<p>Create a propagation from the source queue at the source database to the destination queue at the destination database. The destination queue at the destination database does not exist yet, but creating this propagation ensures that logical change records (LCRs) enqueued into the source queue will remain staged there until propagation is possible. In addition to captured LCRs, the source queue will stage internal messages that will populate the Oracle Streams data dictionary at the destination database.</p>
<p>The following procedure creates the <code>dpx1_to_dpx2</code> propagation:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES(
    streams_name            =&gt; 'dpx1_to_dpx2', 
    source_queue_name       =&gt; 'strmadmin.streams_queue',
    destination_queue_name  =&gt; 'strmadmin.streams_queue@dpx2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'dpx1.example.com',
    inclusion_rule          =&gt; TRUE,
    queue_to_queue          =&gt; TRUE);
END;
/
</pre></li>
<li id="i1008910">
<p>Stop the propagation you created in Step <a href="#i1008892">5</a>.</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.STOP_PROPAGATION(
    propagation_name  =&gt; 'dpx1_to_dpx2');
END;
/
</pre></li>
<li id="i1008922">
<p>Prepare the entire source database for instantiation, if it has not been prepared for instantiation previously. See <a href="#BABIBAIE">"Preparing All of the Database Objects in a Database for Instantiation"</a> for instructions.</p>
<p>If there is no capture process that captures all of the changes to the source database, then create this capture process using the <code>ADD_GLOBAL_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then running this procedure automatically prepares the entire source database for instantiation. If such a capture process already exists, then ensure that the source database has been prepared for instantiation by querying the <code>DBA_CAPTURE_PREPARED_DATABASE</code> data dictionary view.</p>
</li>
<li>
<p>If you created a capture process in Step <a href="#i1008922">7</a>, then start the capture process:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.START_CAPTURE(
    capture_name  =&gt; 'capture_db');
END;
/
</pre></li>
<li id="i1012121">
<p>Determine the until SCN for the RMAN <code>DUPLICATE</code> command:</p>
<pre>
SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  until_scn NUMBER;
BEGIN
  until_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Until SCN: ' || until_scn);
END;
/
</pre>
<p>Make a note of the until SCN returned. You will use this number in Step <a href="#i1013027">14</a>. For this example, assume that the returned until SCN is&nbsp;<code>3050191</code>.</p>
</li>
<li>
<p>In SQL*Plus, connect to the source database <code>dpx1.example.com</code> as an administrative user.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li id="BABICCHI">
<p>Archive the current online redo log:</p>
<pre>
ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></li>
<li>
<p>Prepare your environment for database duplication, which includes preparing the destination database as an auxiliary instance for duplication. See <a class="olink BRADV010" href="../../backup.112/e10642/rcmdupdb.htm#BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions.</p>
</li>
<li>
<p>Start the RMAN client, and connect to the source database <code>dpx1.example.com</code> as <code>TARGET</code> and to the destination database <code>dpx2.example.com</code> as <code>AUXILIARY</code>.</p>
<p>See <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code>CONNECT</code> command.</p>
</li>
<li id="i1013027">
<p>Use the RMAN <code>DUPLICATE</code> command with the <code>OPEN</code> <code>RESTRICTED</code> option to instantiate the source database at the destination database. The <code>OPEN</code> <code>RESTRICTED</code> option is required. This option enables a restricted session in the duplicate database by issuing the following SQL statement: <code>ALTER</code> <code>SYSTEM</code> <code>ENABLE</code> <code>RESTRICTED</code> <code>SESSION</code>. RMAN issues this statement immediately before the duplicate database is opened.</p>
<p>You can use the <code>UNTIL</code> <code>SCN</code> clause to specify an SCN for the duplication. Use the until SCN determined in Step <a href="#i1012121">9</a> for this clause. The until SCN specified for the RMAN <code>DUPLICATE</code> command must be higher than the SCN when the database was prepared for instantiation in Step&nbsp;<a href="#i1008922">7</a>. Also, archived redo logs must be available for the until SCN specified and for higher SCN values. Therefore, Step&nbsp;<a href="#BABICCHI">11</a> archived the redo log containing the until SCN.</p>
<p>Ensure that you use <code>TO</code> <code><span class="codeinlineitalic">database_name</span></code> in the <code>DUPLICATE</code> command to specify the name of the duplicate database. In this example, the duplicate database name is <code>dpx2</code>. Therefore, the <code>DUPLICATE</code> command for this example includes <code>TO</code> <code>dpx2</code>.</p>
<p>The following is an example of an RMAN <code>DUPLICATE</code> command:</p>
<pre>
RMAN&gt; RUN
      { 
        SET UNTIL SCN 3050191;
        ALLOCATE AUXILIARY CHANNEL dpx2 DEVICE TYPE sbt; 
        DUPLICATE TARGET DATABASE TO dpx2 
        NOFILENAMECHECK
        OPEN RESTRICTED;
      }
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RCMRF126" href="../../backup.112/e10643/rcmsynta020.htm#RCMRF126"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code>DUPLICATE</code> command</div>
</li>
<li>
<p>At the destination database, connect as an administrative user in SQL*Plus and rename the database global name. After the RMAN <code>DUPLICATE</code> command, the destination database has the same global name as the source database.</p>
<pre>
ALTER DATABASE RENAME GLOBAL_NAME TO DPX2.EXAMPLE.COM;
</pre></li>
<li>
<p>At the destination database, connect as an administrative user in SQL*Plus and run the following procedure:</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Ensure that you are connected to the destination database, not the source database, when you run this procedure because it removes the local Oracle Streams configuration.</div>
<pre>
EXEC DBMS_STREAMS_ADM.REMOVE_STREAMS_CONFIGURATION();
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Any supplemental log groups for the tables at the source database are retained at the destination database, and the <code>REMOVE_STREAMS_CONFIGURATION</code> procedure does not drop them. You can drop these supplemental log groups if necessary.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS508" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS508"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code>REMOVE_STREAMS_CONFIGURATION</code> procedure</div>
</li>
<li>
<p>At the destination database, use the <code>ALTER</code> <code>SYSTEM</code> statement to disable the <code>RESTRICTED</code> <code>SESSION</code>:</p>
<pre>
ALTER SYSTEM DISABLE RESTRICTED SESSION;
</pre></li>
<li>
<p>At the destination database, connect as the Oracle Streams administrator. See <a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a>.</p>
</li>
<li>
<p>At the destination database, create the queue specified in Step <a href="#i1008892">5</a>.</p>
<p>For example, the following procedure creates a queue named <code>streams_queue</code>:</p>
<pre>
EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre></li>
<li>
<p>At the destination database, configure the Oracle Streams environment.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not start any apply processes at the destination database until after you set the global instantiation SCN in Step <a href="#i1012288">22</a>.</div>
</li>
<li>
<p>At the destination database, create a database link from the destination database to the source database:</p>
<pre>
CREATE DATABASE LINK dpx1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'dpx1.example.com';
</pre>
<p>This database link is required because the next step runs the <code>SET_GLOBAL_INSTANTIATION_SCN</code> procedure with the recursive parameter set to <code>TRUE</code>.</p>
</li>
<li id="i1012288">
<p>At the destination database, set the global instantiation SCN for the source database. The RMAN <code>DUPLICATE</code> command duplicates the database up to one less than the SCN value specified in the <code>UNTIL</code> <code>SCN</code> clause. Therefore, you should subtract one from the until SCN value that you specified when you ran the <code>DUPLICATE</code> command in Step <a href="#i1013027">14</a>. In this example, the until SCN was set to <code>3050191</code>. Therefore, the instantiation SCN should be set to <code>3050191</code> <code>-</code> <code>1</code>, or&nbsp;<code>3050190</code>.</p>
<p>For example, to set the global instantiation SCN to <code>3050190</code> for the <code>dpx1.example.com</code> source database, run the following procedure:</p>
<pre>
BEGIN
  DBMS_APPLY_ADM.SET_GLOBAL_INSTANTIATION_SCN(
    source_database_name   =&gt;  'dpx1.example.com',
    instantiation_scn      =&gt;  3050190,
    recursive              =&gt;  TRUE);
END;
/
</pre>
<p>Notice that the <code>recursive</code> parameter is set to <code>TRUE</code> to set the instantiation SCN for all schemas and tables in the destination database.</p>
</li>
<li>
<p>At the destination database, you can start any apply processes that you configured.</p>
</li>
<li>
<p>At the source database, start the propagation you stopped in Step <a href="#i1008910">6</a>:</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.START_PROPAGATION(
    queue_name  =&gt; 'dpx1_to_dpx2');
END;
/
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="man_comp.htm#BABEHCGE">"Checking for Consistency After Instantiation"</a></div>
</div>
<!-- class="sect3" -->
<a id="BABFJJCE"></a>
<div id="STREP347" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Instantiating an Entire Database on Different Platforms Using RMAN<a id="sthref295"></a><a id="sthref296"></a></h4>
<p>The example in this section instantiates an entire database using the RMAN <code>CONVERT</code> <code>DATABASE</code> command. The example makes the following assumptions:</p>
<ul>
<li>
<p>You want to capture all of the changes made to a source database named <code>cvx1.example.com</code>, propagate these changes to a separate destination database named <code>cvx2.example.com</code>, and apply these changes at the destination database.</p>
</li>
<li>
<p>You have configured an Oracle Streams administrator at the source database named <code>strmadmin</code>. See <a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a>.</p>
</li>
<li>
<p>The <code>cvx1.example.com</code> and <code>cvx2.example.com</code> databases run on different platforms, and the platform combination is supported by the RMAN <code>CONVERT</code> <code>DATABASE</code> command. You can use the <code>DBMS_TDB</code> package to determine whether a platform combination is supported.</p>
</li>
</ul>
<p>The RMAN <code>CONVERT</code> <code>DATABASE</code> command produces converted data files, an initialization parameter file (PFILE), and a SQL script. The converted data files and PFILE are for use with the destination database, and the SQL script creates the destination database on the destination platform.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV05432" href="../../backup.112/e10642/rcmxplat.htm#BRADV05432"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions about using the RMAN <code>CONVERT</code> <code>DATABASE</code> command</div>
<p>Complete the following steps to instantiate an entire database using RMAN when the source and destination databases run on different platforms:</p>
<ol>
<li>
<p>Create a backup of the source database if one does not exist. RMAN requires a valid backup. In this example, create a backup of <code>cvx1.example.com</code> if one does not exist.</p>
</li>
<li>
<p>In SQL*Plus, connect to the source database <code>cvx1.example.com</code> as the Oracle Streams administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Create an <code>ANYDATA</code> queue to stage the changes from the source database if such a queue does not already exist. This queue will stage changes that will be propagated to the destination database after it has been configured.</p>
<p>For example, the following procedure creates a queue named <code>streams_queue</code>:</p>
<pre>
EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre>
<p>Remain connected as the Oracle Streams administrator in SQL*Plus at the source database through Step <a href="#BABHHGCB">8</a>.</p>
</li>
<li>
<p>Create a database link from <code>cvx1.example.com</code> to <code>cvx2.example.com</code>:</p>
<pre>
CREATE DATABASE LINK cvx2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'cvx2.example.com';
</pre></li>
<li id="BABHGGGA">
<p>Create a propagation from the source queue at the source database to the destination queue at the destination database. The destination queue at the destination database does not exist yet, but creating this propagation ensures that logical change records (LCRs) enqueued into the source queue will remain staged there until propagation is possible. In addition to captured LCRs, the source queue will stage internal messages that will populate the Oracle Streams data dictionary at the destination database.</p>
<p>The following procedure creates the <code>cvx1_to_cvx2</code> propagation:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES(
    streams_name            =&gt; 'cvx1_to_cvx2', 
    source_queue_name       =&gt; 'strmadmin.streams_queue',
    destination_queue_name  =&gt; 'strmadmin.streams_queue@cvx2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'cvx1.example.com',
    inclusion_rule          =&gt; TRUE,
    queue_to_queue          =&gt; TRUE);
END;
/
</pre></li>
<li id="BABCHJGG">
<p>Stop the propagation you created in Step <a href="#BABHGGGA">5</a>.</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.STOP_PROPAGATION(
    propagation_name  =&gt; 'cvx1_to_cvx2');
END;
/
</pre></li>
<li id="BABDFIEB">
<p>Prepare the entire source database for instantiation, if it has not been prepared for instantiation previously. See <a href="#BABIBAIE">"Preparing All of the Database Objects in a Database for Instantiation"</a> for instructions.</p>
<p>If there is no capture process that captures all of the changes to the source database, then create this capture process using the <code>ADD_GLOBAL_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then running this procedure automatically prepares the entire source database for instantiation. If such a capture process already exists, then ensure that the source database has been prepared for instantiation by querying the <code>DBA_CAPTURE_PREPARED_DATABASE</code> data dictionary view.</p>
</li>
<li id="BABHHGCB">
<p>If you created a capture process in Step <a href="#BABDFIEB">7</a>, then start the capture process:</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.START_CAPTURE(
    capture_name  =&gt; 'capture_db');
END;
/
</pre></li>
<li>
<p>In SQL*Plus, connect to the source database as an administrative user.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Archive the current online redo log:</p>
<pre>
ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></li>
<li>
<p>Prepare your environment for database conversion, which includes opening the source database in read-only mode. Complete the following steps:</p>
<ol>
<li>
<p>If the source database is open, then shut it down and start it in read-only mode.</p>
</li>
<li>
<p>Run the <code>CHECK_DB</code> and <code>CHECK_EXTERNAL</code> functions in the <code>DBMS_TDB</code> package. Check the results to ensure that the conversion is supported by the RMAN <code>CONVERT</code> <code>DATABASE</code> command.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV05432" href="../../backup.112/e10642/rcmxplat.htm#BRADV05432"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for more information about these steps</div>
</li>
<li id="BABHCABH">
<p>Determine the current SCN of the source database:</p>
<pre>
SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  current_scn NUMBER;
BEGIN
  current_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Current SCN: ' || current_scn);
END;
/
</pre>
<p>Make a note of the SCN value returned. You will use this number in Step <a href="#BABHBCGH">24</a>. For this example, assume that the returned value is&nbsp;<code>46931285</code>.</p>
</li>
<li>
<p>Start the RMAN client, and connect to the source database <code>cvx1.example.com</code> as <code>TARGET</code>.</p>
<p>See <a class="olink RCMRF114" href="../../backup.112/e10643/rcmsynta011.htm#RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code>CONNECT</code> command.</p>
</li>
<li>
<p>Run the <code>CONVERT</code> <code>DATABASE</code> command.</p>
<p>Ensure that you use <code>NEW</code> <code>DATABASE</code> <code><span class="codeinlineitalic">database_name</span></code> in the <code>CONVERT</code> <code>DATABASE</code> command to specify the name of the destination database. In this example, the destination database name is <code>cvx2</code>. Therefore, the <code>CONVERT</code> <code>DATABASE</code> command for this example includes <code>NEW</code> <code>DATABASE</code> <code>cvx2</code>.</p>
<p>The following is an example of an RMAN <code>CONVERT</code> <code>DATABASE</code> command for a destination database that is running on the <code>Linux</code> <code>IA</code> <code>(64-bit)</code> platform:</p>
<pre>
CONVERT DATABASE NEW DATABASE 'cvx2'
          TRANSPORT SCRIPT '/tmp/convertdb/transportscript.sql'     
          TO PLATFORM 'Linux IA (64-bit)'
          DB_FILE_NAME_CONVERT '/home/oracle/dbs','/tmp/convertdb';
</pre></li>
<li>
<p>Transfer the data files, PFILE, and SQL script produced by the RMAN <code>CONVERT</code> <code>DATABASE</code> command to the computer system that will run the destination database.</p>
</li>
<li>
<p>On the computer system that will run the destination database, modify the SQL script so that the destination database always opens with restricted session enabled.</p>
<p>The following is a sample script with the necessary modifications in bold font:</p>
<pre>
-- The following commands will create a new control file and use it
-- to open the database.
-- Data used by Recovery Manager will be lost.
-- The contents of online logs will be lost and all backups will
-- be invalidated. Use this only if online logs are damaged.
 
-- After mounting the created controlfile, the following SQL
-- statement will place the database in the appropriate
-- protection mode:
--  ALTER DATABASE SET STANDBY DATABASE TO MAXIMIZE PERFORMANCE
 
STARTUP NOMOUNT PFILE='init_00gd2lak_1_0.ora'
CREATE CONTROLFILE REUSE SET DATABASE "CVX2" RESETLOGS  NOARCHIVELOG
    MAXLOGFILES 32
    MAXLOGMEMBERS 2
    MAXDATAFILES 32
    MAXINSTANCES 1
    MAXLOGHISTORY 226
LOGFILE
  GROUP 1 '/tmp/convertdb/archlog1'  SIZE 25M,
  GROUP 2 '/tmp/convertdb/archlog2'  SIZE 25M
DATAFILE
  '/tmp/convertdb/systemdf',
  '/tmp/convertdb/sysauxdf',
  '/tmp/convertdb/datafile1',
  '/tmp/convertdb/datafile2',
  '/tmp/convertdb/datafile3'
CHARACTER SET WE8DEC
;
 
<span class="bold">-- NOTE: This ALTER SYSTEM statement is added to enable restricted session.</span>

<span class="bold">ALTER SYSTEM ENABLE RESTRICTED SESSION;</span>

-- Database can now be opened zeroing the online logs.
ALTER DATABASE OPEN RESETLOGS;
 
-- No tempfile entries found to add.
--
 
set echo off
prompt ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
prompt * Your database has been created successfully!
prompt * There are many things to think about for the new database. Here
prompt * is a checklist to help you stay on track:
prompt * 1. You may want to redefine the location of the directory objects.
prompt * 2. You may want to change the internal database identifier (DBID) 
prompt *    or the global database name for this database. Use the 
prompt *    NEWDBID Utility (nid).
prompt ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
SHUTDOWN IMMEDIATE 
<span class="bold">-- NOTE: This startup has the UPGRADE parameter.</span>
<span class="bold">-- It already has restricted session enabled, so no change is needed.</span>
STARTUP UPGRADE PFILE='init_00gd2lak_1_0.ora'
@@ ?/rdbms/admin/utlirp.sql 
SHUTDOWN IMMEDIATE 
<span class="bold">-- NOTE: The startup below is generated without the RESTRICT clause.</span>
<span class="bold">-- Add the RESTRICT clause.</span>
STARTUP <span class="bold">RESTRICT</span> PFILE='init_00gd2lak_1_0.ora'
-- The following step will recompile all PL/SQL modules.
-- It may take serveral hours to complete.
@@ ?/rdbms/admin/utlrp.sql 
set feedback 6;
</pre>
<p>Other changes to the script might be necessary. For example, the data file locations and PFILE location might need to be changed to point to the correct locations on the destination database computer system.</p>
</li>
<li>
<p>At the destination database, connect as an administrative user in SQL*Plus and run the following procedure:</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
Ensure that you are connected to the destination database, not the source database, when you run this procedure because it removes the local Oracle Streams configuration.</div>
<pre>
EXEC DBMS_STREAMS_ADM.REMOVE_STREAMS_CONFIGURATION();
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Any supplemental log groups for the tables at the source database are retained at the destination database, and the <code>REMOVE_STREAMS_CONFIGURATION</code> procedure does not drop them. You can drop these supplemental log groups if necessary.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS508" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS508"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the <code>REMOVE_STREAMS_CONFIGURATION</code> procedure</div>
</li>
<li>
<p>In SQL*Plus, connect to the destination database <code>cvx2.example.com</code> as the Oracle Streams administrator.</p>
</li>
<li>
<p>Drop the database link from the source database to the destination database that was cloned from the source database:</p>
<pre>
DROP DATABASE LINK cvx2.example.com;
</pre></li>
<li>
<p>At the destination database, use the <code>ALTER</code> <code>SYSTEM</code> statement to disable the <code>RESTRICTED</code> <code>SESSION</code>:</p>
<pre>
ALTER SYSTEM DISABLE RESTRICTED SESSION;
</pre></li>
<li>
<p>At the destination database, create the queue specified in Step <a href="#BABHGGGA">5</a>.</p>
<p>For example, the following procedure creates a queue named <code>streams_queue</code>:</p>
<pre>
EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre></li>
<li>
<p>At the destination database, connect as the Oracle Streams administrator and configure the Oracle Streams environment. See <a href="prep_rep.htm#BABHEJGG">"Configuring an Oracle Streams Administrator on All Databases"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Do not start any apply processes at the destination database until after you set the global instantiation SCN in Step <a href="#BABHBCGH">24</a>.</div>
</li>
<li>
<p>At the destination database, create a database link to the source database:</p>
<pre>
CREATE DATABASE LINK cvx1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'cvx1.example.com';
</pre>
<p>This database link is required because the next step runs the <code>SET_GLOBAL_INSTANTIATION_SCN</code> procedure with the recursive parameter set to <code>TRUE</code>.</p>
</li>
<li id="BABHBCGH">
<p>At the destination database, set the global instantiation SCN for the source database to the SCN value returned in Step <a href="#BABHCABH">12</a>.</p>
<p>For example, to set the global instantiation SCN to <code>46931285</code> for the <code>cvx1.example.com</code> source database, run the following procedure:</p>
<pre>
BEGIN
  DBMS_APPLY_ADM.SET_GLOBAL_INSTANTIATION_SCN(
    source_database_name   =&gt;  'cvx1.example.com',
    instantiation_scn      =&gt;  46931285,
    recursive              =&gt;  TRUE);
END;
/
</pre>
<p>Notice that the <code>recursive</code> parameter is set to <code>TRUE</code> to set the instantiation SCN for all schemas and tables in the destination database.</p>
</li>
<li>
<p>At the destination database, you can start any apply processes that you configured.</p>
</li>
<li>
<p>At the source database, start the propagation you stopped in Step <a href="#BABCHJGG">6</a>:</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.START_PROPAGATION(
    propagation_name  =&gt; 'cvx1_to_cvx2');
END;
/
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="man_comp.htm#BABEHCGE">"Checking for Consistency After Instantiation"</a></div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1009604"></a>
<div id="STREP117" class="sect1">
<h2 class="sect1">Setting Instantiation SCNs at a Destination Database<a id="sthref297"></a><a id="sthref298"></a><a id="sthref299"></a><a id="sthref300"></a></h2>
<p>An instantiation system change number (SCN) instructs an apply process at a destination database to apply changes that committed after a specific SCN at a source database. You can set instantiation SCNs in one of the following ways:</p>
<ul>
<li>
<p>Export the relevant database objects at the source database and import them at the destination database. In this case, the export/import creates the database objects at the destination database, populates them with the data from the source database, and sets the relevant instantiation SCNs. You can use Data Pump export/import for instantiations. See <a href="#i1009393">"Setting Instantiation SCNs Using Export/Import"</a> for information about the instantiation SCNs that are set for different types of export/import operations.</p>
</li>
<li>
<p>Perform a metadata only export/import using Data Pump. If you use Data Pump export/import, then set the <code>CONTENT</code> parameter to <code>METADATA_ONLY</code> during export at the source database or import at the destination database, or both. Instantiation SCNs are set for the database objects, but no data is imported. See <a href="#i1009393">"Setting Instantiation SCNs Using Export/Import"</a> for information about the instantiation SCNs that are set for different types of export/import operations.</p>
</li>
<li>
<p>Use transportable tablespaces to copy the objects in one or more tablespaces from a source database to a destination database. An instantiation SCN is set for each schema in these tablespaces and for each database object in these tablespaces that was prepared for instantiation before the export. See <a href="#i1008748">"Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN"</a>.</p>
</li>
<li>
<p>Set the instantiation SCN using the <code>SET_TABLE_INSTANTIATION_SCN</code>, <code>SET_SCHEMA_INSTANATIATION_SCN</code>, and <code>SET_GLOBAL_INSTANTIATION_SCN</code> procedures in the <code>DBMS_APPLY_ADM</code> package. See <a href="#i1009455">"Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package"</a>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS212" href="../../server.112/e17069/strms_adapply.htm#STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
<a id="i1009393"></a>
<div id="STREP348" class="sect2">
<h3 class="sect2">Setting Instantiation SCNs Using Export/Import<a id="sthref301"></a><a id="sthref302"></a><a id="sthref303"></a><a id="sthref304"></a><a id="sthref305"></a><a id="sthref306"></a><a id="sthref307"></a></h3>
<p>This section discusses setting instantiation SCNs by performing an export/import. The information in this section applies to both metadata export/import operations and to export/import operations that import rows. You can specify a more stringent degree of consistency by using an export parameter such as <code>FLASHBACK_SCN</code> or <code>FLASHBACK_TIME</code>.</p>
<p>The following sections describe how the instantiation SCNs are set for different types of export/import operations. These sections refer to <span class="bold">prepared tables</span>. Prepared tables are tables that have been prepared for instantiation using the <code>PREPARE_TABLE_INSTANTIATION</code> procedure, <code>PREPARE_SYNC_INSTANTIATION</code> function, <code>PREPARE_SCHEMA_INSTANTIATION</code> procedure, or <code>PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code>DBMS_CAPTURE_ADM</code> package. A table must be a prepared table before export in order for an instantiation SCN to be set for it during import. However, the database and schemas do not need to be prepared before the export in order for their instantiation SCNs to be set for them during import.</p>
<div id="STREP349" class="sect3"><a id="sthref308"></a>
<h4 class="sect3">Full Database Export and Full Database Import</h4>
<p>A full database export and full database import sets the following instantiation SCNs at the import database:</p>
<ul>
<li>
<p>The database, or global, instantiation SCN</p>
</li>
<li>
<p>The schema instantiation SCN for each imported user</p>
</li>
<li>
<p>The table instantiation SCN for each prepared table that is imported</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<div id="STREP350" class="sect3"><a id="sthref309"></a>
<h4 class="sect3">Full Database or User Export and User Import</h4>
<p>A full database or user export and user import sets the following instantiation SCNs at the import database:</p>
<ul>
<li>
<p>The schema instantiation SCN for each imported user</p>
</li>
<li>
<p>The table instantiation SCN for each prepared table that is imported</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<div id="STREP351" class="sect3"><a id="sthref310"></a>
<h4 class="sect3">Full Database, User, or Table Export and Table Import</h4>
<p>Any export that includes one or more tables and a table import sets the table instantiation SCN for each prepared table that is imported at the import database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If a non-<code>NULL</code> instantiation SCN already exists for a database object at a destination database that performs an import, then the import updates the instantiation SCN for that database object.</p>
</li>
<li>
<p>During an export for an Oracle Streams instantiation, ensure that no data definition language (DDL) changes are made to objects being exported.</p>
</li>
<li>
<p>Any table supplemental logging specifications for the tables exported from the export database are retained when the tables are imported at the import database.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFCIJD">"Oracle Data Pump and Oracle Streams Instantiation"</a> and <a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about using export/import</p>
</li>
<li>
<p><a href="ptrep_config.htm#BABIIHJA">Part I, "Configuring Oracle Streams Replication"</a> for more information about performing export/import operations to set instantiation SCNs when configuring an Oracle Streams environment</p>
</li>
<li>
<p><a href="#i1009355">"Preparing Database Objects for Instantiation at a Source Database"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1009455"></a>
<div id="STREP352" class="sect2">
<h3 class="sect2">Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package<a id="sthref311"></a><a id="sthref312"></a><a id="sthref313"></a></h3>
<p>You can set an instantiation SCN at a destination database for a specified table, a specified schema, or an entire database using one of the following procedures in the <code>DBMS_APPLY_ADM</code> package:</p>
<ul>
<li>
<p><a class="olink ARPLS325" href="../../appdev.112/e40758/d_apply.htm#ARPLS325"><code>SET_TABLE_INSTANTIATION_SCN</code></a></p>
</li>
<li>
<p><a class="olink ARPLS589" href="../../appdev.112/e40758/d_apply.htm#ARPLS589"><code>SET_SCHEMA_INSTANTIATION_SCN</code></a></p>
</li>
<li>
<p><a class="olink ARPLS538" href="../../appdev.112/e40758/d_apply.htm#ARPLS538"><code>SET_GLOBAL_INSTANTIATION_SCN</code></a></p>
</li>
</ul>
<p>If you set the instantiation SCN for a schema using <code>SET_SCHEMA_INSTANTIATION_SCN</code>, then you can set the <code>recursive</code> parameter to <code>TRUE</code> when you run this procedure to set the instantiation SCN for each table in the schema. Similarly, if you set the instantiation SCN for a database using <code>SET_GLOBAL_INSTANTIATION_SCN</code>, then you can set the <code>recursive</code> parameter to <code>TRUE</code> when you run this procedure to set the instantiation SCN for the schemas in the database and for each table owned by these schemas.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<ul>
<li>
<p>If you set the <code>recursive</code> parameter to <code>TRUE</code> in the <code>SET_SCHEMA_INSTANTIATION_SCN</code> procedure or the <code>SET_GLOBAL_INSTANTIATION_SCN</code> procedure, then a database link from the destination database to the source database is required. This database link must have the same name as the global name of the source database and must be accessible to the user who executes the procedure.</p>
</li>
<li>
<p>When setting an instantiation SCN for a database object, always specify the name of the schema and database object at the source database, even if a rule-based transformation or apply handler is configured to change the schema name or database object name.</p>
</li>
<li>
<p>If a relevant instantiation SCN is not present, then an error is raised during apply.</p>
</li>
<li>
<p>These procedures can set an instantiation SCN for changes captured by capture processes and synchronous captures.</p>
</li>
</ul>
</div>
<p><a href="#g1015725">Table 8-3</a> lists each procedure and the types of statements for which they set an instantiation SCN.</p>
<div id="STREP353" class="tblhruleformalwide">
<p class="titleintable"><a id="sthref314"></a><a id="g1015725"></a>Table 8-3 Set Instantiation SCN Procedures and the Statements They Cover</p>
<table class="cellalignment1563" title="Set Instantiation SCN Procedures and the Statements They Cover" summary="This table lists each set instantiation procedure, what each procedure sets an instaniation SCN for, and examples of SQL statements that are covered by each set instantiation procedure." dir="ltr">
<thead>
<tr class="cellalignment1552">
<th class="cellalignment1564" id="r1c1-t61">Procedure</th>
<th class="cellalignment1564" id="r1c2-t61">Sets Instantiation SCN for</th>
<th class="cellalignment1564" id="r1c3-t61">Examples</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r2c1-t61" headers="r1c1-t61">
<p><code>SET_TABLE_INSTANTIATION_SCN</code></p>
</td>
<td class="cellalignment1558" headers="r2c1-t61 r1c2-t61">
<p>DML and DDL statements on tables, except <code>CREATE</code> <code>TABLE</code></p>
<p>DDL statements on table indexes and table triggers</p>
</td>
<td class="cellalignment1558" headers="r2c1-t61 r1c3-t61">
<p><code>UPDATE</code></p>
<p><code>ALTER</code> <code>TABLE</code></p>
<p><code>DROP</code> <code>TABLE</code></p>
<p><code>CREATE</code>, <code>ALTER</code>, or <code>DROP</code> <code>INDEX</code> on a table</p>
<p><code>CREATE</code>, <code>ALTER</code>, or <code>DROP</code> <code>TRIGGER</code> on a table</p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r3c1-t61" headers="r1c1-t61">
<p><code>SET_SCHEMA_INSTANTIATION_SCN</code></p>
</td>
<td class="cellalignment1558" headers="r3c1-t61 r1c2-t61">
<p>DDL statements on users, except <code>CREATE</code> <code>USER</code></p>
<p>DDL statements on all database objects that have a non-<code>PUBLIC</code> owner, except for those DDL statements handled by a table-level instantiation SCN</p>
</td>
<td class="cellalignment1558" headers="r3c1-t61 r1c3-t61">
<p><code>CREATE</code> <code>TABLE</code></p>
<p><code>ALTER</code> <code>USER</code></p>
<p><code>DROP</code> <code>USER</code></p>
<p><code>CREATE</code> <code>PROCEDURE</code></p>
</td>
</tr>
<tr class="cellalignment1552">
<td class="cellalignment1558" id="r4c1-t61" headers="r1c1-t61">
<p><code>SET_GLOBAL_INSTANTIATION_SCN</code></p>
</td>
<td class="cellalignment1558" headers="r4c1-t61 r1c2-t61">
<p>DDL statements on database objects other than users with no owner</p>
<p>DDL statements on database objects owned by public</p>
<p><code>CREATE</code> <code>USER</code> statements</p>
</td>
<td class="cellalignment1558" headers="r4c1-t61 r1c3-t61">
<p><code>CREATE</code> <code>USER</code></p>
<p><code>CREATE</code> <code>TABLESPACE</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformalwide" -->
<div id="STREP354" class="sect3"><a id="sthref315"></a>
<h4 class="sect3">Setting the Instantiation SCN While Connected to the Source Database</h4>
<p>The user who runs the examples in this section must have access to a database link from the source database to the destination database. In these examples, the database link is <code>hrdb2.example.com</code>. The following example sets the instantiation SCN for the <code>hr.departments</code> table at the <code>hrdb2.example.com</code> database to the current SCN by running the following procedure at the source database <code>hrdb1.example.com</code>:</p>
<pre>
DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@HRDB2.EXAMPLE.COM(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre>
<p>The following example sets the instantiation SCN for the <code>oe</code> schema and all of its objects at the <code>hrdb2.example.com</code> database to the current source database SCN by running the following procedure at the source database <code>hrdb1.example.com</code>:</p>
<pre>
DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_SCHEMA_INSTANTIATION_SCN@HRDB2.EXAMPLE.COM(
    source_schema_name    =&gt; 'oe',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn,
    recursive             =&gt; TRUE);
END;
/
</pre>
<p>Because the <code>recursive</code> parameter is set to <code>TRUE</code>, running this procedure sets the instantiation SCN for each database object in the <code>oe</code> schema.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When you set the <code>recursive</code> parameter to <code>TRUE</code>, a database link from the destination database to the source database is required, even if you run the procedure while you are connected to the source database. This database link must have the same name as the global name of the source database and must be accessible to the current user.</div>
</div>
<!-- class="sect3" -->
<div id="STREP355" class="sect3"><a id="sthref316"></a>
<h4 class="sect3">Setting the Instantiation SCN While Connected to the Destination Database</h4>
<p>The user who runs the examples in this section must have access to a database link from the destination database to the source database. In these examples, the database link is <code>hrdb1.example.com</code>. The following example sets the instantiation SCN for the <code>hr.departments</code> table at the <code>hrdb2.example.com</code> database to the current source database SCN at <code>hrdb1.example.com</code> by running the following procedure at the destination database <code>hrdb2.example.com</code>:</p>
<pre>
DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER@HRDB1.EXAMPLE.COM;
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre>
<p>The following example sets the instantiation SCN for the <code>oe</code> schema and all of its objects at the <code>hrdb2.example.com</code> database to the current source database SCN at <code>hrdb1.example.com</code> by running the following procedure at the destination database <code>hrdb2.example.com</code>:</p>
<pre>
DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER@HRDB1.EXAMPLE.COM;
  DBMS_APPLY_ADM.SET_SCHEMA_INSTANTIATION_SCN(
    source_schema_name    =&gt; 'oe',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn,
    recursive             =&gt; TRUE);
END;
/
</pre>
<p>Because the <code>recursive</code> parameter is set to <code>TRUE</code>, running this procedure sets the instantiation SCN for each database object in the <code>oe</code> schema.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If an apply process applies changes to a remote non-Oracle database, then set the <code>apply_database_link</code> parameter to the database link used for remote apply when you set the instantiation&nbsp;SCN.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="ptrep_config.htm#BABIIHJA">Part I, "Configuring Oracle Streams Replication"</a> for more information when to set instantiation SCNs when you are configuring an Oracle Streams environment</p>
</li>
<li>
<p><a class="olink STREX" href="../e12862/toc.htm"><span class="italic">Oracle Streams Extended Examples</span></a> for detailed examples that uses the <code>SET_TABLE_INSTANTIATION_SCN</code> procedure</p>
</li>
<li>
<p>The information about the <code>DBMS_APPLY_ADM</code> package in the <a class="olink ARPLS300" href="../../appdev.112/e40758/d_apply.htm#ARPLS300"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about which instantiation SCN can be used for a DDL LCR</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1012704"></a>
<div id="STREP160" class="sect1">
<h2 class="sect1">Monitoring Instanti<a id="sthref317"></a><a id="sthref318"></a>ation</h2>
<p>The following sections contain queries that you can run to determine which database objects are prepared for instantiation at a source database and the instantiation SCN for database objects at a destination database:</p>
<ul>
<li>
<p><a href="#i1012601">Determining Which Database Objects Are Prepared for Instantiation</a></p>
</li>
<li>
<p><a href="#i1012657">Determining the Tables for Which an Instantiation SCN Has Been Set</a></p>
</li>
</ul>
<a id="i1012601"></a>
<div id="STREP356" class="sect2">
<h3 class="sect2">Determining Which Database Objects Are Prepared for Instantiation<a id="sthref319"></a><a id="sthref320"></a><a id="sthref321"></a><a id="sthref322"></a></h3>
<p>See <a href="#i1007217">"Capture Rules and Preparation for Instantiation"</a> for information about preparing database objects for instantiation.</p>
<p>To determine which database objects have been prepared for instantiation, query the following data dictionary views:</p>
<ul>
<li>
<p><code>DBA_CAPTURE_PREPARED_TABLES</code></p>
</li>
<li>
<p><code>DBA_SYNC_CAPTURE_PREPARED_TABS</code></p>
</li>
<li>
<p><code>DBA_CAPTURE_PREPARED_SCHEMAS</code></p>
</li>
<li>
<p><code>DBA_CAPTURE_PREPARED_DATABASE</code></p>
</li>
</ul>
<p>For example, to list all of the tables that have been prepared for instantiation by the <code>PREPARE_TABLE_INSTANTIATION</code> procedure, the SCN for the time when each table was prepared, and the time when each table was prepared, run the following query:</p>
<pre>
COLUMN TABLE_OWNER HEADING 'Table Owner' FORMAT A15
COLUMN TABLE_NAME HEADING 'Table Name' FORMAT A15
COLUMN SCN HEADING 'Prepare SCN' FORMAT 99999999999
COLUMN TIMESTAMP HEADING 'Time Ready for|Instantiation'

SELECT TABLE_OWNER, 
       TABLE_NAME, 
       SCN, 
       TO_CHAR(TIMESTAMP, 'HH24:MI:SS MM/DD/YY') TIMESTAMP
  FROM DBA_CAPTURE_PREPARED_TABLES;
</pre>
<p>Your output looks similar to the following:</p>
<pre>
                                                  Time Ready for
Table Owner     Table Name            Prepare SCN Instantiation
--------------- --------------- ----------------- -----------------
HR              COUNTRIES                  196655 12:59:30 02/28/02
HR              DEPARTMENTS                196658 12:59:30 02/28/02
HR              EMPLOYEES                  196659 12:59:30 02/28/02
HR              JOBS                       196660 12:59:30 02/28/02
HR              JOB_HISTORY                196661 12:59:30 02/28/02
HR              LOCATIONS                  196662 12:59:30 02/28/02
HR              REGIONS                    196664 12:59:30 02/28/02
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1009355">"Preparing Database Objects for Instantiation at a Source Database"</a></div>
</div>
<!-- class="sect2" -->
<a id="i1012657"></a>
<div id="STREP357" class="sect2">
<h3 class="sect2">Determining the Tables for Which an Instantiation SCN Has Been Set<a id="sthref323"></a></h3>
<p>An instantiation SCN is set at a destination database. It controls which captured logical change records (LCRs) for a database object are ignored by an apply process and which captured LCRs for a database object are applied by an apply process. If the commit SCN of an LCR for a table from a source database is less than or equal to the instantiation SCN for that table at a destination database, then the apply process at the destination database discards the LCR. Otherwise, the apply process applies the LCR. The LCRs can be captured by a capture process or a synchronous capture. See <a href="#i1009604">"Setting Instantiation SCNs at a Destination Database"</a>.</p>
<p>To determine which database objects have a set instantiation SCN, query the following corresponding data dictionary views:</p>
<ul>
<li>
<p><code>DBA_APPLY_INSTANTIATED_OBJECTS</code></p>
</li>
<li>
<p><code>DBA_APPLY_INSTANTIATED_SCHEMAS</code></p>
</li>
<li>
<p><code>DBA_APPLY_INSTANTIATED_GLOBAL</code></p>
</li>
</ul>
<p>The following query lists each table for which an instantiation SCN has been set at a destination database and the instantiation SCN for each table:</p>
<pre>
COLUMN SOURCE_DATABASE HEADING 'Source Database' FORMAT A20
COLUMN SOURCE_OBJECT_OWNER HEADING 'Object Owner' FORMAT A15
COLUMN SOURCE_OBJECT_NAME HEADING 'Object Name' FORMAT A15
COLUMN INSTANTIATION_SCN HEADING 'Instantiation SCN' FORMAT 99999999999

SELECT SOURCE_DATABASE, 
       SOURCE_OBJECT_OWNER, 
       SOURCE_OBJECT_NAME, 
       INSTANTIATION_SCN 
  FROM DBA_APPLY_INSTANTIATED_OBJECTS
  WHERE APPLY_DATABASE_LINK IS NULL;
</pre>
<p>Your output looks similar to the following:</p>
<pre>
Source Database     Object Owner    Object Name     Instantiation SCN
-------------------- --------------- --------------- -----------------
DBS1.EXAMPLE.COM     HR              REGIONS                    196660
DBS1.EXAMPLE.COM     HR              COUNTRIES                  196660
DBS1.EXAMPLE.COM     HR              LOCATIONS                  196660
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also display instantiation SCNs for changes that are applied to remote non-Oracle databases. This query does not display these instantiation SCNs because it lists an instantiation SCN only if the <code>APPLY_DATABASE_LINK</code> column is <code>NULL</code>.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1009604">"Setting Instantiation SCNs at a Destination Database"</a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1551">
<tr>
<td class="cellalignment1558">
<table class="cellalignment1556">
<tr>
<td class="cellalignment1555"><a href="capply.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1555"><a href="conflict.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2003, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1560">
<table class="cellalignment1554">
<tr>
<td class="cellalignment1555"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1555"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1555"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1555"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1555"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1555"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
