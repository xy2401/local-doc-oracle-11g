<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Datetime Data Types and Time Zone Support</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 070" />
<meta name="dcterms.created" content="2013-07-05T0:14:27Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Globalization Support Guide" />
<meta name="dcterms.identifier" content="E10729-08" />
<meta name="dcterms.isVersionOf" content="NLSPG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="ch3globenv.htm" title="Previous" type="text/html" />
<link rel="Next" href="ch5lingsort.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10729.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">8/21</span> <!-- End Header --><a id="g1020462"></a><a id="NLSPG004"></a><a id="i1007717"></a>
<h1 class="chapter"><span class="secnum">4</span> Datetime Data Types and Time Zone Support</h1>
<p>This chapter includes the following topics:</p>
<ul>
<li>
<p><a href="#i1005943">Overview of Datetime and Interval Data Types and Time Zone Support</a></p>
</li>
<li>
<p><a href="#i1005946">Datetime and Interval Data Types</a></p>
</li>
<li>
<p><a href="#i1006312">Datetime and Interval Arithmetic and Comparisons</a></p>
</li>
<li>
<p><a href="#i1006333">Datetime SQL Functions</a></p>
</li>
<li>
<p><a href="#i1006532">Datetime and Time Zone Parameters and Environment Variables</a></p>
</li>
<li>
<p><a href="#i1006667">Choosing a Time Zone File</a></p>
</li>
<li>
<p><a href="#CACFFHCJ">Upgrading the Time Zone File and Timestamp with Time Zone Data</a></p>
</li>
<li>
<p><a href="#CHDCDCBH">Clients and Servers Operating with Different Versions of Time Zone Files</a></p>
</li>
<li>
<p><a href="#i1006705">Setting the Database Time Zone</a></p>
</li>
<li>
<p><a href="#i1006728">Setting the Session Time Zone</a></p>
</li>
<li>
<p><a href="#i1007699">Converting Time Zones With the AT TIME ZONE Clause</a></p>
</li>
<li>
<p><a href="#i1006760">Support for Daylight Saving Time</a></p>
</li>
</ul>
<a id="i1005943"></a><a id="NLSPG236"></a>
<div class="sect1">
<h2 class="sect1">Overview of Datetime and Interval Data Types and Time Zone Support</h2>
<p>Businesses conduct transactions across different time zones. Oracle Database datetime and interval data types and time zone support make it possible to store consistent information about the time of events and transactions.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This chapter describes Oracle Database datetime and interval data types. It does not attempt to describe ANSI data types or other kinds of data types unless noted.</div>
</div>
<!-- class="sect1" -->
<a id="i1005946"></a><a id="NLSPG237"></a>
<div class="sect1">
<h2 class="sect1">Datetime and Interval Data Types</h2>
<p>The <span class="bold"><a id="sthref264"></a><a id="sthref265"></a>datetime data types</span> are <code>DATE</code>, <code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE,</code> and <code>TIMESTAMP WITH LOCAL TIME ZONE</code>. Values of datetime data types are sometimes called <span class="bold">datetimes</span>.</p>
<p>The <span class="bold"><a id="sthref266"></a><a id="sthref267"></a>interval data types</span> are <code>INTERVAL YEAR TO MONTH</code> and <code>INTERVAL DAY TO SECOND</code>. Values of interval data types are sometimes called <span class="bold">intervals</span>.</p>
<p>Both datetimes and intervals are made up of fields. The values of these fields determine the value of the data type. The fields that apply to all Oracle Database datetime and interval data types are:</p>
<ul>
<li>
<p><code>YEAR</code></p>
</li>
<li>
<p><code>MONTH</code></p>
</li>
<li>
<p><code>DAY</code></p>
</li>
<li>
<p><code>HOUR</code></p>
</li>
<li>
<p><code>MINUTE</code></p>
</li>
<li>
<p><code>SECOND</code></p>
</li>
</ul>
<p><code>TIMESTAMP WITH TIME ZONE</code> also includes these fields:</p>
<ul>
<li>
<p><code>TIMEZONE_HOUR</code></p>
</li>
<li>
<p><code>TIMEZONE_MINUTE</code></p>
</li>
<li>
<p><code>TIMEZONE_REGION</code></p>
</li>
<li>
<p><code>TIMEZONE_ABBR</code></p>
</li>
</ul>
<p><code>TIMESTAMP WITH LOCAL TIME ZONE</code> does not store time zone information internally, but you can see local time zone information in SQL output if the <code>TZH:TZM</code> or <code>TZR</code> <code>TZD</code> format elements are specified.</p>
<p>The following sections describe the datetime data types and interval data types in more detail:</p>
<ul>
<li>
<p><a href="#i1005983">Datetime Data Types</a></p>
</li>
<li>
<p><a href="#i1006226">Interval Data Types</a></p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink SQLRF00200" href="../../server.112/e41084/sql_elements001.htm#SQLRF00200"><span class="italic">Oracle Database SQL Language Reference</span></a> for the valid values of the datetime and interval fields</p>
</li>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about format elements</p>
</li>
</ul>
</div>
</li>
</ul>
<a id="i1005983"></a><a id="NLSPG238"></a>
<div class="sect2">
<h3 class="sect2">Datetime Data Types</h3>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#i1006006">DATE Data Type</a></p>
</li>
<li>
<p><a href="#i1006050">TIMESTAMP Data Type</a></p>
</li>
<li>
<p><a href="#i1006081">TIMESTAMP WITH TIME ZONE Data Type</a></p>
</li>
<li>
<p><a href="#i1006169">TIMESTAMP WITH LOCAL TIME ZONE Data Type</a></p>
</li>
<li>
<p><a href="#i1006203">Inserting Values into Datetime Data Types</a></p>
</li>
<li>
<p><a href="#i1007248">Choosing a TIMESTAMP Data Type</a></p>
</li>
</ul>
<a id="i1006006"></a><a id="NLSPG239"></a>
<div class="sect3">
<h4 class="sect3">DATE Data Type</h4>
<p>The <code><a id="sthref268"></a><a id="sthref269"></a>DATE</code> data type stores date and time information. Although date and time information can be represented in both character and number data types, the <code>DATE</code> data type has special associated properties. For each <code>DATE</code> value, Oracle Database stores the following information: century, year, month, date, hour, minute, and second.</p>
<p>You can specify a date value by:</p>
<ul>
<li>
<p>Specifying the date value as a literal</p>
</li>
<li>
<p>Converting a character or numeric value to a date value with the <code>TO_DATE</code> function</p>
</li>
</ul>
<p>A date can be specified as an ANSI date literal or as an Oracle Database date value.</p>
<p>An ANSI date literal contains no time portion and must be specified in exactly the following format:</p>
<pre>
DATE 'YYYY-MM-DD'
</pre>
<p>The following is an example of an ANSI date literal:</p>
<pre>
DATE '1998-12-25'
</pre>
<p>Alternatively, you can specify an Oracle Database date value as shown in the following example:</p>
<pre>
TO_DATE('1998-DEC-25 17:30','YYYY-MON-DD HH24:MI','NLS_DATE_LANGUAGE=AMERICAN')
</pre>
<p>The default date format for an Oracle Database date value is derived from the <code>NLS_DATE_FORMAT</code> and <code>NLS_DATE_LANGUAGE</code> initialization parameters. The date format in the example includes a two-digit number for the day of the month, an abbreviation of the month name, the last two digits of the year, and a 24-hour time designation. The specification for <code>NLS_DATE_LANGUAGE</code> is included because '<code>DEC'</code> is not a valid value for <code>MON</code> in all locales.</p>
<p>Oracle Database automatically converts character values that are in the default date format into date values when they are used in date expressions.</p>
<p>If you specify a date value without a time component, then the default time is midnight. If you specify a date value without a date, then the default date is the first day of the current month.</p>
<p>Oracle Database <code>DATE</code> columns always contain fields for both date and time. If your queries use a date format without a time portion, then you must ensure that the time fields in the <code>DATE</code> column are set to midnight. You can use the <code>TRUNC</code> (date) SQL function to ensure that the time fields are set to midnight, or you can make the query a test of greater than or less than (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, or <code>&gt;)</code> instead of equality or inequality (<code>=</code> or <code>!=)</code>. Otherwise, Oracle Database may not return the query results you expect.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF00202" href="../../server.112/e41084/sql_elements001.htm#SQLRF00202"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code>DATE</code> data type</p>
</li>
<li>
<p><a href="ch3globenv.htm#i1006817">"NLS_DATE_FORMAT"</a></p>
</li>
<li>
<p><a href="ch3globenv.htm#i1006894">"NLS_DATE_LANGUAGE"</a></p>
</li>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about literals, format elements such as <code>MM</code>, and the <code>TO_DATE</code> function</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i1006050"></a><a id="NLSPG240"></a>
<div class="sect3">
<h4 class="sect3">TIMESTAMP Data Type</h4>
<p>The <code><a id="sthref270"></a><a id="sthref271"></a>TIMESTAMP</code> data type is an extension of the <code>DATE</code> data type. It stores year, month, day, hour, minute, and second values. It also stores fractional seconds, which are not stored by the <code>DATE</code> data type.</p>
<p>Specify the <code>TIMESTAMP</code> data type as follows:</p>
<pre>
TIMESTAMP [(<span class="codeinlineitalic">fractional_seconds_precision)</span>]
</pre>
<p><code><span class="codeinlineitalic">fractional_seconds_precision</span></code> is optional and specifies the number of digits in the fractional part of the <code>SECOND</code> datetime field. It can be a number in the range 0 to 9. The default is 6.</p>
<p>For example, <code>'26-JUN-02 09:39:16.78'</code> shows 16.78 seconds. The fractional seconds precision is 2 because there are 2 digits in '<code>78</code>'.</p>
<p>You can specify the <code>TIMESTAMP</code> literal in a format like the following:</p>
<pre>
TIMESTAMP 'YYYY-MM-DD HH24:MI:SS.FF'
</pre>
<p>Using the example format, specify <code>TIMESTAMP</code> as a literal as follows:</p>
<pre>
TIMESTAMP '1997-01-31 09:26:50.12'
</pre>
<p>The value of <code>NLS_TIMESTAMP_FORMAT</code> initialization parameter determines the timestamp format when a character string is converted to the <code>TIMESTAMP</code> data type. <code>NLS_DATE_LANGUAGE</code> determines the language used for character data such as <code>MON</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF00203" href="../../server.112/e41084/sql_elements001.htm#SQLRF00203"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code>TIMESTAMP</code> data type</p>
</li>
<li>
<p><a href="ch3globenv.htm#i1007035">"NLS_TIMESTAMP_FORMAT"</a></p>
</li>
<li>
<p><a href="ch3globenv.htm#i1006894">"NLS_DATE_LANGUAGE"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i1006081"></a><a id="NLSPG241"></a>
<div class="sect3">
<h4 class="sect3">TIMESTAMP WITH TIME ZONE Data Type</h4>
<p><code><a id="sthref272"></a><a id="sthref273"></a>TIMESTAMP WITH TIME ZONE</code> is a variant of <code>TIMESTAMP</code> that includes a time zone region name or time zone offset in its value. The time zone offset is the difference (in hours and minutes) between local time and UTC<a id="sthref274"></a><a id="sthref275"></a><a id="sthref276"></a> (Coordinated Universal Time, formerly Greenwich Mean Time). Specify the <code>TIMESTAMP WITH TIME ZONE</code> data type as follows:</p>
<pre>
TIMESTAMP [(<span class="codeinlineitalic">fractional_seconds_precision</span>)] WITH TIME ZONE
</pre>
<p><code><span class="codeinlineitalic">fractional_seconds_precision</span></code> is optional and specifies the number of digits in the fractional part of the <code>SECOND</code> datetime field.</p>
<p>You can specify <code>TIMESTAMP WITH TIME ZONE</code> as a literal as follows:</p>
<pre>
TIMESTAMP '1997-01-31 09:26:56.66 +02:00'
</pre>
<p>Two <code>TIMESTAMP WITH TIME ZONE</code> values are considered identical if they represent the same instant in UTC, regardless of the <code>TIME ZONE</code> offsets stored in the data. For example, the following expressions have the same value:</p>
<pre>
TIMESTAMP '1999-01-15 8:00:00 -8:00'
TIMESTAMP '1999-01-15 11:00:00 -5:00'
</pre>
<p>You can replace the UTC offset with the <code>TZR</code> (time zone region) format element. The following expression specifies <code>America/Los_Angeles</code> for the time zone region:</p>
<pre>
TIMESTAMP '1999-01-15 8:00:00 America/Los_Angeles'
</pre>
<p>To eliminate the ambiguity of boundary cases when the time switches from Standard Time to Daylight Saving Time, use both the <code>TZR</code> format element and the corresponding <code>TZD</code> format element. The <code>TZD</code> format element is an abbreviation of the time zone region with Daylight Saving Time information included. Examples are <code>PST</code> for U. S. Pacific Standard Time and <code>PDT</code> for U. S. Pacific Daylight Time. The following specification ensures that a Daylight Saving Time value is returned:</p>
<pre>
TIMESTAMP '1999-10-29 01:30:00 America/Los_Angeles PDT'
</pre>
<p>If you do not add the <code>TZD</code> format element, and the datetime value is ambiguous, then Oracle Database returns an error if you have the <code>ERROR_ON_OVERLAP_TIME</code> session parameter set to <code>TRUE</code>. If <code>ERROR_ON_OVERLAP_TIME</code> is set to <code>FALSE</code> (the default value), then Oracle Database interprets the ambiguous datetime as Standard Time.</p>
<p>The default date format for the <code>TIMESTAMP WITH TIME ZONE</code> data type is determined by the value of the <code>NLS_TIMESTAMP_TZ_FORMAT</code> initialization parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF00204" href="../../server.112/e41084/sql_elements001.htm#SQLRF00204"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code>TIMESTAMP WITH TIME ZONE</code> data type</p>
</li>
<li>
<p><a href="#i1006050">"TIMESTAMP Data Type"</a> for more information about fractional seconds precision</p>
</li>
<li>
<p><a href="#i1006760">"Support for Daylight Saving Time"</a></p>
</li>
<li>
<p><a href="ch3globenv.htm#i1007084">"NLS_TIMESTAMP_TZ_FORMAT"</a></p>
</li>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about format elements</p>
</li>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about setting the <code>ERROR_ON_OVERLAP_TIME</code> session parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i1006169"></a><a id="NLSPG242"></a>
<div class="sect3">
<h4 class="sect3">TIMESTAMP WITH LOCAL TIME ZONE Data Type</h4>
<p><code><a id="sthref277"></a><a id="sthref278"></a>TIMESTAMP WITH LOCAL TIME ZONE</code> is another variant of <code>TIMESTAMP</code>. It differs from <code>TIMESTAMP WITH TIME ZONE</code> as follows: data stored in the database is normalized to the database time zone, and the time zone offset is not stored as part of the column data. When users retrieve the data, Oracle Database returns it in the users' local session time zone. The time zone offset is the difference (in hours and minutes) between local time and UTC<a id="sthref279"></a><a id="sthref280"></a><a id="sthref281"></a> (Coordinated Universal Time, formerly Greenwich Mean Time).</p>
<p>Specify the <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type as follows:</p>
<pre>
TIMESTAMP [(<span class="codeinlineitalic">fractional_seconds_precision</span>)] WITH LOCAL TIME ZONE
</pre>
<p><code><span class="codeinlineitalic">fractional_seconds_precision</span></code> is optional and specifies the number of digits in the fractional part of the <code>SECOND</code> datetime field.</p>
<p>There is no literal for <code>TIMESTAMP WITH LOCAL TIME ZONE</code>, but <code>TIMESTAMP</code> literals and <code>TIMESTAMP WITH TIME ZONE</code> literals can be inserted into a <code>TIMESTAMP WITH LOCAL TIME ZONE</code> column.</p>
<p>The default date format for <code>TIMESTAMP WITH LOCAL TIME ZONE</code> is determined by the value of the <code>NLS_TIMESTAMP_FORMAT</code> initialization parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF00205" href="../../server.112/e41084/sql_elements001.htm#SQLRF00205"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type</p>
</li>
<li>
<p><a href="#i1006050">"TIMESTAMP Data Type"</a> for more information about fractional seconds precision</p>
</li>
<li>
<p><a href="ch3globenv.htm#i1007035">"NLS_TIMESTAMP_FORMAT"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i1006203"></a><a id="NLSPG243"></a>
<div class="sect3">
<h4 class="sect3">Inserting Values into Datetime Data Types</h4>
<p>You can insert <a id="sthref282"></a><a id="sthref283"></a>values into a datetime column in the following ways:</p>
<ul>
<li>
<p>Insert a character string whose format is based on the appropriate NLS format value</p>
</li>
<li>
<p>Insert a literal</p>
</li>
<li>
<p>Insert a literal for which implicit conversion is performed</p>
</li>
<li>
<p>Use the <code>TO_TIMESTAMP</code>, <code>TO_TIMESTAMP_TZ</code>, or <code>TO_DATE</code> SQL function</p>
</li>
</ul>
<p>The following examples show how to insert data into datetime data types.</p>
<div class="example">
<p class="titleinexample"><a id="NLSPG751"></a><a id="sthref284"></a>Example 4-1 Inserting Data into a DATE Column</p>
<p>Set the date format.</p>
<pre>
SQL&gt; ALTER SESSION SET NLS_DATE_FORMAT='DD-MON-YYYY HH24:MI:SS';
</pre>
<p>Create a table <code>table_dt</code> with columns <code>c_id</code> and <code>c_dt</code>. The <code>c_id</code> column is of <code>NUMBER</code> data type and helps to identify the method by which the data is entered. The <code>c_dt</code> column is of <code>DATE</code> data type.</p>
<pre>
SQL&gt; CREATE TABLE table_dt (c_id NUMBER, c_dt DATE);
</pre>
<p>Insert a date as a character string.</p>
<pre>
SQL&gt; INSERT INTO table_dt VALUES(1, '01-JAN-2003');
</pre>
<p>Insert the same date as a <code>DATE</code> literal.</p>
<pre>
SQL&gt; INSERT INTO table_dt VALUES(2, DATE '2003-01-01');
</pre>
<p>Insert the date as a <code>TIMESTAMP</code> literal. Oracle Database drops the time zone information.</p>
<pre>
SQL&gt; INSERT INTO table_dt VALUES(3, TIMESTAMP '2003-01-01 00:00:00 America/Los_Angeles');
</pre>
<p>Insert the date with the <code>TO_DATE</code> function.</p>
<pre>
SQL&gt; INSERT INTO table_dt VALUES(4, TO_DATE('01-JAN-2003', 'DD-MON-YYYY'));
</pre>
<p>Display the data.</p>
<pre>
SQL&gt; SELECT * FROM table_dt;

C_ID       C_DT
---------- --------------------
1          01-JAN-2003 00:00:00
2          01-JAN-2003 00:00:00
3          01-JAN-2003 00:00:00
4          01-JAN-2003 00:00:00
</pre></div>
<!-- class="example" -->
<div class="example">
<p class="titleinexample"><a id="NLSPG752"></a><a id="sthref285"></a>Example 4-2 Inserting Data into a TIMESTAMP Column</p>
<p>Set the timestamp format.</p>
<pre>
SQL&gt; ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YY HH:MI:SSXFF';
</pre>
<p>Create a table <code>table_ts</code> with columns <code>c_id</code> and <code>c_ts</code>. The <code>c_id</code> column is of <code>NUMBER</code> data type and helps to identify the method by which the data is entered. The <code>c_ts</code> column is of <code>TIMESTAMP</code> data type.</p>
<pre>
SQL&gt; CREATE TABLE table_ts(c_id NUMBER, c_ts TIMESTAMP);
</pre>
<p>Insert a date and time as a character string.</p>
<pre>
SQL&gt; INSERT INTO table_ts VALUES(1, '01-JAN-2003 2:00:00');
</pre>
<p>Insert the same date and time as a <code>TIMESTAMP</code> literal.</p>
<pre>
SQL&gt; INSERT INTO table_ts VALUES(2, TIMESTAMP '2003-01-01 2:00:00');
</pre>
<p>Insert the same date and time as a <code>TIMESTAMP WITH TIME ZONE</code> literal. Oracle Database converts it to a <code>TIMESTAMP</code> value, which means that the time zone information is dropped.</p>
<pre>
SQL&gt; INSERT INTO table_ts VALUES(3, TIMESTAMP '2003-01-01 2:00:00 -08:00');
</pre>
<p>Display the data.</p>
<pre>
SQL&gt; SELECT * FROM table_ts;

C_ID        C_TS
----------  -----------------------------
1           01-JAN-03 02:00:00.000000 AM
2           01-JAN-03 02:00:00.000000 AM
3           01-JAN-03 02:00:00.000000 AM
</pre>
<p>Note that the three methods result in the same value being stored.</p>
</div>
<!-- class="example" -->
<div class="example">
<p class="titleinexample"><a id="NLSPG753"></a><a id="sthref286"></a>Example 4-3 Inserting Data into the TIMESTAMP WITH TIME ZONE Data Type</p>
<p>Set the timestamp format.</p>
<pre>
SQL&gt; ALTER SESSION SET NLS_TIMESTAMP_TZ_FORMAT='DD-MON-RR HH:MI:SSXFF AM TZR';
</pre>
<p>Set the time zone to <code>'-07:00'</code>.</p>
<pre>
SQL&gt; ALTER SESSION SET TIME_ZONE='-7:00';
</pre>
<p>Create a table <code>table_tstz</code> with columns <code>c_id</code> and <code>c_tstz</code>. The <code>c_id</code> column is of <code>NUMBER</code> data type and helps to identify the method by which the data is entered. The <code>c_tstz</code> column is of <code>TIMESTAMP WITH TIME ZONE</code> data type.</p>
<pre>
SQL&gt; CREATE TABLE table_tstz (c_id NUMBER, c_tstz TIMESTAMP WITH TIME ZONE);
</pre>
<p>Insert a date and time as a character string.</p>
<pre>
SQL&gt; INSERT INTO table_tstz VALUES(1, '01-JAN-2003 2:00:00 AM -07:00');
</pre>
<p>Insert the same date and time as a <code>TIMESTAMP</code> literal. Oracle Database converts it to a <code>TIMESTAMP WITH TIME ZONE</code> literal, which means that the session time zone is appended to the <code>TIMESTAMP</code> value.</p>
<pre>
SQL&gt; INSERT INTO table_tstz VALUES(2, TIMESTAMP '2003-01-01 2:00:00');
</pre>
<p>Insert the same date and time as a <code>TIMESTAMP WITH TIME ZONE</code> literal.</p>
<pre>
SQL&gt; INSERT INTO table_tstz VALUES(3, TIMESTAMP '2003-01-01 2:00:00 -8:00');
</pre>
<p>Display the data.</p>
<pre>
SQL&gt; SELECT * FROM table_tstz;

C_ID        C_TSTZ
----------  ------------------------------------
1           01-JAN-03 02:00.00:000000 AM -07:00
2           01-JAN-03 02:00:00.000000 AM -07:00
3           01-JAN-03 02:00:00.000000 AM -08:00
</pre>
<p>Note that the time zone is different for method 3, because the time zone information was specified as part of the <code>TIMESTAMP WITH TIME ZONE</code> literal.</p>
</div>
<!-- class="example" -->
<div class="example">
<p class="titleinexample"><a id="NLSPG754"></a><a id="sthref287"></a>Example 4-4 Inserting Data into the TIMESTAMP WITH LOCAL TIME ZONE Data Type</p>
<p>Consider data that is being entered in Denver, Colorado, U.S.A., whose time zone is UTC-7.</p>
<pre>
SQL&gt; ALTER SESSION SET TIME_ZONE='-07:00';
</pre>
<p>Create a table <code>table_tsltz</code> with columns <code>c_id</code> and <code>c_tsltz</code>. The <code>c_id</code> column is of <code>NUMBER</code> data type and helps to identify the method by which the data is entered. The <code>c_tsltz</code> column is of <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type.</p>
<pre>
SQL&gt; CREATE TABLE table_tsltz (c_id NUMBER, c_tsltz TIMESTAMP WITH LOCAL TIME ZONE);
</pre>
<p>Insert a date and time as a character string.</p>
<pre>
SQL&gt; INSERT INTO table_tsltz VALUES(1, '01-JAN-2003 2:00:00');
</pre>
<p>Insert the same data as a <code>TIMESTAMP WITH LOCAL TIME ZONE</code> literal.</p>
<pre>
SQL&gt; INSERT INTO table_tsltz VALUES(2, TIMESTAMP '2003-01-01 2:00:00');
</pre>
<p>Insert the same data as a <code>TIMESTAMP WITH TIME ZONE</code> literal. Oracle Database converts the data to a <code>TIMESTAMP WITH LOCAL TIME ZONE</code> value. This means the time zone that is entered (<code>-08:00</code>) is converted to the session time zone value (<code>-07:00</code>).</p>
<pre>
SQL&gt; INSERT INTO table_tsltz VALUES(3, TIMESTAMP '2003-01-01 2:00:00 -08:00');
</pre>
<p>Display the data.</p>
<pre>
SQL&gt; SELECT * FROM table_tsltz;

C_ID        C_TSLTZ
----------  ------------------------------------
1           01-JAN-03 02.00.00.000000 AM
2           01-JAN-03 02.00.00.000000 AM
3           01-JAN-03 03.00.00.000000 AM
</pre>
<p>Note that the information that was entered as UTC-8 has been changed to the local time zone, changing the hour from <code>2</code> to <code>3</code>.</p>
</div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1006333">"Datetime SQL Functions"</a> for more information about the <code>TO_TIMESTAMP</code> or <code>TO_TIMESTAMP_TZ</code> SQL functions</div>
</div>
<!-- class="sect3" -->
<a id="i1007248"></a><a id="NLSPG244"></a>
<div class="sect3">
<h4 class="sect3">Choosing a <a id="sthref288"></a><a id="sthref289"></a><a id="sthref290"></a><a id="sthref291"></a>TIMESTAMP Data Type</h4>
<p>Use the <code>TIMESTAMP</code> data type when you need a datetime value to record the time of an event without the time zone. For example, you can store information about the times when workers punch a time card in and out of their assembly line workstations. Because this is always a local time it is then not needed to store the timezone part. The <code>TIMESTAMP</code> data type uses 7 or 11 bytes of storage.</p>
<p>Use the <code>TIMESTAMP WITH TIME ZONE</code> data type when the datetime value represents a future local time or the time zone information needs to be recorded with the value. Consider a scheduled appointment in a local time. The future local time may need to be adjusted if the time zone definition, such as daylight saving rule, changes. Otherwise, the value can become incorrect. This data type is most immune to such impact.</p>
<p>The <code>TIMESTAMP WITH TIME ZONE</code> data type requires 13 bytes of storage, or two more bytes of storage than the <code>TIMESTAMP</code> and <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data types because it stores time zone information. The time zone is stored as a time zone region name or as an offset from UTC. The data is available for display or calculations without additional processing. A <code>TIMESTAMP WITH TIME ZONE</code> column cannot be used as a primary key. If an index is created on a <code>TIMESTAMP WITH TIME ZONE</code> column, it becomes a function-based index.</p>
<p>The <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type stores the timestamp without time zone information. It normalizes the data to the database time zone every time the data is sent to and from a client. It requires 11 bytes of storage.</p>
<p>The <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type is appropriate when the original time zone is of no interest, but the relative times of events are important and daylight saving adjustment does not have to be accurate. The time zone conversion that this data type performs to and from the database time zone is asymmetrical, due to the daylight saving adjustment. Because this data type does not preserve the time zone information, it does not distinguish values near the adjustment in fall, whether they are daylight saving time or standard time. This confusion between distinct instants can cause an application to behave unexpectedly, especially if the adjustment takes place during the normal working hours of a user.</p>
<p>Note that some regions, such as Brazil and Israel, that update their Daylight Saving Transition dates frequently and at irregular periods, are particularly susceptible to time zone adjustment issues. If time information from these regions is key to your application, you may want to consider using one of the other datetime types.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006226"></a><a id="NLSPG245"></a>
<div class="sect2">
<h3 class="sect2">Interval Data Types</h3>
<p>Interval data types store time durations. They are used primarily with analytic functions. For example, you can use them to calculate a moving average of stock prices. You must use interval data types to determine the values that correspond to a particular percentile. You can also use <a id="sthref292"></a><a id="sthref293"></a>interval data types to update historical tables.</p>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#i1006253">INTERVAL YEAR TO MONTH Data Type</a></p>
</li>
<li>
<p><a href="#i1006272">INTERVAL DAY TO SECOND Data Type</a></p>
</li>
<li>
<p><a href="#i1006291">Inserting Values into Interval Data Types</a></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DWHSG" href="../e25554/toc.htm"><span class="italic">Oracle Database Data Warehousing Guide</span></a> for more information about analytic functions, including moving averages and inverse percentiles</div>
</li>
</ul>
<a id="i1006253"></a><a id="NLSPG246"></a>
<div class="sect3">
<h4 class="sect3">INTERVAL YEAR TO MONTH Data Type</h4>
<p><code><a id="sthref294"></a><a id="sthref295"></a>INTERVAL YEAR TO MONTH</code> stores a period of time using the <code>YEAR</code> and <code>MONTH</code> datetime fields. Specify <code>INTERVAL YEAR TO MONTH</code> as follows:</p>
<pre>
INTERVAL YEAR [(<span class="codeinlineitalic">year_precision</span>)] TO MONTH
</pre>
<p><code><span class="codeinlineitalic">year_precision</span></code> is the number of digits in the <code>YEAR</code> datetime field. Accepted values are 0 to 9. The default value of <code><span class="codeinlineitalic">year_precision</span></code> is 2.</p>
<p>Interval values can be specified as literals. There are many ways to specify interval literals. The following is one example of specifying an interval of 123 years and 2 months. The year precision is 3.</p>
<pre>
INTERVAL '123-2' YEAR(3) TO MONTH
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF00206" href="../../server.112/e41084/sql_elements001.htm#SQLRF00206"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about specifying interval literals with the <code>INTERVAL YEAR TO MONTH</code> data type</div>
</div>
<!-- class="sect3" -->
<a id="i1006272"></a><a id="NLSPG247"></a>
<div class="sect3">
<h4 class="sect3">INTERVAL DAY TO SECOND Data Type</h4>
<p><code><a id="sthref296"></a><a id="sthref297"></a>INTERVAL DAY TO SECOND</code> stores a period of time in terms of days, hours, minutes, and seconds. Specify this data type as follows:</p>
<pre>
INTERVAL DAY [(<span class="codeinlineitalic">day_precision</span>)] TO SECOND [(<span class="codeinlineitalic">fractional_seconds_precision</span>)]
</pre>
<p><code><span class="codeinlineitalic">day_precision</span></code> is the number of digits in the <code>DAY</code> datetime field. Accepted values are 0 to 9. The default is 2.</p>
<p><code><span class="codeinlineitalic">fractional_seconds_precision</span></code> is the number of digits in the fractional part of the <code>SECOND</code> datetime field. Accepted values are 0 to 9. The default is 6.</p>
<p>The following is one example of specifying an interval of 4 days, 5 hours, 12 minutes, 10 seconds, and 222 thousandths of a second. The fractional second precision is 3.</p>
<pre>
INTERVAL '4 5:12:10.222' DAY TO SECOND(3)
</pre>
<p>Interval values can be specified as literals. There are many ways to specify interval literals.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF00207" href="../../server.112/e41084/sql_elements001.htm#SQLRF00207"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about specifying interval literals with the <code>INTERVAL DAY TO SECOND</code> data type</div>
</div>
<!-- class="sect3" -->
<a id="i1006291"></a><a id="NLSPG248"></a>
<div class="sect3">
<h4 class="sect3">Inserting Values into Interval Data Types</h4>
<p>You can insert <a id="sthref298"></a><a id="sthref299"></a>values into an interval column in the following ways:</p>
<ul>
<li>
<p>Insert an interval as a literal. For example:</p>
<pre>
INSERT INTO table1 VALUES (INTERVAL '4-2' YEAR TO MONTH);
</pre>
<p>This statement inserts an interval of 4 years and 2 months.</p>
<p>Oracle Database recognizes literals for other ANSI interval types and converts the values to Oracle Database interval values.</p>
</li>
<li>
<p>Use the <code>NUMTODSINTERVAL</code>, <code>NUMTOYMINTERVAL</code>, <code>TO_DSINTERVAL</code>, and <code>TO_YMINTERVAL</code> SQL functions.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1006333">"Datetime SQL Functions"</a></div>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006312"></a><a id="NLSPG249"></a>
<div class="sect1">
<h2 class="sect1">Datetime and Interval Arithmetic and Comparisons</h2>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#i1009109">Datetime and Interval Arithmetic</a></p>
</li>
<li>
<p><a href="#i1009114">Datetime Comparisons</a></p>
</li>
<li>
<p><a href="#i1009119">Explicit Conversion of Datetime Data Types</a></p>
</li>
</ul>
<a id="i1009109"></a><a id="NLSPG250"></a>
<div class="sect2">
<h3 class="sect2">Datetime and Interval Arithmetic</h3>
<p>You can perform arithmetic operations on date (<code>DATE</code>), timestamp (<code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE</code>, and <code>TIMESTAMP WITH LOCAL TIME ZONE</code>) and interval (<code>INTERVAL DAY TO SECOND</code> and <code>INTERVAL YEAR TO MONTH</code>) data. You can maintain the most precision in arithmetic operations by using a timestamp data type with an interval data type.</p>
<p>You can use <code>NUMBER</code> constants in arithmetic operations on date and timestamp values. Oracle Database internally converts timestamp values to date values before doing arithmetic operations on them with <code>NUMBER</code> constants. This means that information about fractional seconds is lost during operations that include both date and timestamp values. Oracle Database interprets <code>NUMBER</code> constants in datetime and interval expressions as number of days.</p>
<p>Each <code>DATE</code> value contains a time component. The result of many date operations includes a fraction. This fraction means a portion of one day. For example, 1.5 days is 36 hours. These fractions are also returned by Oracle Database built-in SQL functions for common operations on <code>DATE</code> data. For example, the built-in <code>MONTHS_BETWEEN</code> SQL function returns the number of months between two dates. The fractional portion of the result represents that portion of a 31-day month.</p>
<p>Oracle Database performs all timestamp arithmetic in UTC time. For <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data, Oracle Database converts the datetime value from the database time zone to UTC and converts back to the database time zone after performing the arithmetic. For <code>TIMESTAMP WITH TIME ZONE</code> data, the datetime value is always in UTC, so no conversion is necessary.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF00208" href="../../server.112/e41084/sql_elements001.htm#SQLRF00208"><span class="italic">Oracle Database SQL Language Reference</span></a> for detailed information about datetime and interval arithmetic operations</p>
</li>
<li>
<p><a href="#i1006333">"Datetime SQL Functions"</a> for information about which functions cause implicit conversion to <code>DATE</code></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1009114"></a><a id="NLSPG251"></a>
<div class="sect2">
<h3 class="sect2">Datetime Comparisons</h3>
<p>When you compare date and timestamp values, Oracle Database converts the data to the more precise data type before doing the comparison. For example, if you compare data of <code>TIMESTAMP WITH TIME ZONE</code> data type with data of <code>TIMESTAMP</code> data type, Oracle Database converts the <code>TIMESTAMP</code> data to <code>TIMESTAMP WITH TIME ZONE</code>, using the session time zone.</p>
<p>The order of precedence for converting date and timestamp data is as follows:</p>
<ol>
<li>
<p><code>DATE</code></p>
</li>
<li>
<p><code>TIMESTAMP</code></p>
</li>
<li>
<p><code>TIMESTAMP WITH LOCAL TIME ZONE</code></p>
</li>
<li>
<p><code>TIMESTAMP WITH TIME ZONE</code></p>
</li>
</ol>
<p>For any pair of data types, Oracle Database converts the data type that has a smaller number in the preceding list to the data type with the larger number.</p>
</div>
<!-- class="sect2" -->
<a id="i1009119"></a><a id="NLSPG252"></a>
<div class="sect2">
<h3 class="sect2">Explicit Conversion of Datetime Data Types</h3>
<p>If you want to do explicit conversion of datetime data types, use the <code>CAST</code> SQL function. You can explicitly convert <code>DATE</code>, <code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE</code>, and <code>TIMESTAMP WITH LOCAL TIME ZONE</code> to another data type in the list.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF00613" href="../../server.112/e41084/functions023.htm#SQLRF00613"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006333"></a><a id="NLSPG253"></a>
<div class="sect1">
<h2 class="sect1">Datetime SQL Functions</h2>
<p>Datetime functions operate on date (<code>DATE</code>), timestamp (<code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE</code>, and <code>TIMESTAMP WITH LOCAL TIME ZONE</code>) and interval (<code>INTERVAL DAY TO SECOND</code>, <code>INTERVAL YEAR TO MONTH</code>) values.</p>
<p>Some of the datetime functions were designed for the Oracle Database <code>DATE</code> data type. If you provide a timestamp value as their argument, then Oracle Database internally converts the input type to a <code>DATE</code> value. Oracle Database does not perform internal conversion for the <code>ROUND</code> and <code>TRUNC</code> functions.</p>
<p><a href="#g1010956">Table 4-1</a> shows the datetime functions that were designed for the Oracle <code>DATE</code> datatype. It contains cross-references to more detailed descriptions of the functions.</p>
<div class="tblhruleformal">
<p class="titleintable"><a id="NLSPG755"></a><a id="sthref300"></a><a id="g1010956"></a>Table 4-1 Datetime Functions Designed for the DATE Data Type</p>
<table class="cellalignment1914" title="Datetime Functions Designed for the DATE Data Type " summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1905">
<th class="cellalignment1915" id="r1c1-t15">Function</th>
<th class="cellalignment1915" id="r1c2-t15">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r2c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00603" href="../../server.112/e41084/functions011.htm#SQLRF00603"><code>ADD_MONTHS</code></a></p>
</td>
<td class="cellalignment1911" headers="r2c1-t15 r1c2-t15">
<p>Retur<a id="sthref301"></a><a id="sthref302"></a>ns the date <code><span class="codeinlineitalic">d</span></code> plus <code><span class="codeinlineitalic">n</span></code> months</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r3c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00654" href="../../server.112/e41084/functions084.htm#SQLRF00654"><code>LAST_DAY</code></a></p>
</td>
<td class="cellalignment1911" headers="r3c1-t15 r1c2-t15">
<p>Returns th<a id="sthref303"></a><a id="sthref304"></a>e last day of the month that contains <code><span class="codeinlineitalic">date</span></code></p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r4c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00669" href="../../server.112/e41084/functions102.htm#SQLRF00669"><code>MONTHS_BETWEEN</code></a></p>
</td>
<td class="cellalignment1911" headers="r4c1-t15 r1c2-t15">
<p>Returns <a id="sthref305"></a><a id="sthref306"></a>the number of months between <code><span class="codeinlineitalic">date1</span></code> and <code><span class="codeinlineitalic">date2</span></code></p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r5c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00671" href="../../server.112/e41084/functions105.htm#SQLRF00671"><code>NEW_TIME</code></a></p>
</td>
<td class="cellalignment1911" headers="r5c1-t15 r1c2-t15">
<p>Returns t<a id="sthref307"></a><a id="sthref308"></a>he date and time in <code><span class="codeinlineitalic">zone2</span></code> time zone when the date and time in <code><span class="codeinlineitalic">zone1</span></code> time zone are <code><span class="codeinlineitalic">date</span></code></p>
<p><span class="bold">Note:</span> This function takes as input only a limited number of time zones. You can have access to a much greater number of time zones by combining the <code>FROM_TZ</code> function and the datetime expression.</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r6c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00672" href="../../server.112/e41084/functions106.htm#SQLRF00672"><code>NEXT_DAY</code></a></p>
</td>
<td class="cellalignment1911" headers="r6c1-t15 r1c2-t15">
<p>Retur<a id="sthref309"></a><a id="sthref310"></a>ns the date of the first weekday named by <code><span class="codeinlineitalic">char</span></code> that is later than <code><span class="codeinlineitalic">date</span></code></p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r7c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF00699" href="../../server.112/e41084/functions154.htm#SQLRF00699"><code>ROUND(date)</code></a></p>
</td>
<td class="cellalignment1911" headers="r7c1-t15 r1c2-t15">
<p>Retur<a id="sthref311"></a><a id="sthref312"></a>ns <code><span class="codeinlineitalic">date</span></code> rounded to the unit specified by the <code><span class="codeinlineitalic">fmt</span></code> format model</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r8c1-t15" headers="r1c1-t15">
<p><a class="olink SQLRF06151" href="../../server.112/e41084/functions220.htm#SQLRF06151"><code>TRUNC(date)</code></a></p>
</td>
<td class="cellalignment1911" headers="r8c1-t15 r1c2-t15">
<p>Retur<a id="sthref313"></a><a id="sthref314"></a>ns <code><span class="codeinlineitalic">date</span></code> with the time portion of the day truncated to the unit specified by the <code><span class="codeinlineitalic">fmt</span></code> format model</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p><a href="#g1010984">Table 4-2</a> describes additional datetime functions and contains cross-references to more detailed descriptions.</p>
<div class="tblhruleformal">
<p class="titleintable"><a id="NLSPG756"></a><a id="sthref315"></a><a id="g1010984"></a>Table 4-2 Additional Datetime Functions</p>
<table class="cellalignment1914" title="Additional Datetime Functions " summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1905">
<th class="cellalignment1915" id="r1c1-t16">Datetime Function</th>
<th class="cellalignment1915" id="r1c2-t16">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r2c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00628" href="../../server.112/e41084/functions044.htm#SQLRF00628"><code>CURRENT_DATE</code></a></p>
</td>
<td class="cellalignment1911" headers="r2c1-t16 r1c2-t16">
<p>Returns the<a id="sthref316"></a><a id="sthref317"></a> current date in the session time zone in a value in the Gregorian calendar, of the <code>DATE</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r3c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00629" href="../../server.112/e41084/functions045.htm#SQLRF00629"><code>CURRENT_TIMESTAMP</code></a></p>
</td>
<td class="cellalignment1911" headers="r3c1-t16 r1c2-t16">
<p>Returns the c<a id="sthref318"></a><a id="sthref319"></a>urrent date and time in the session time zone as a <code>TIMESTAMP WITH TIME ZONE</code> value</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r4c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00630" href="../../server.112/e41084/functions048.htm#SQLRF00630"><code>DBTIMEZONE</code></a></p>
</td>
<td class="cellalignment1911" headers="r4c1-t16 r1c2-t16">
<p>Returns the value<a id="sthref320"></a><a id="sthref321"></a> of the database time zone. The value is a time zone offset or a time zone region name</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r5c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00639" href="../../server.112/e41084/functions059.htm#SQLRF00639"><code>EXTRACT</code> (datetime)</a></p>
</td>
<td class="cellalignment1911" headers="r5c1-t16 r1c2-t16">
<p>Extracts an<a id="sthref322"></a><a id="sthref323"></a>d returns the value of a specified datetime field from a datetime or interval value expression</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r6c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00644" href="../../server.112/e41084/functions068.htm#SQLRF00644"><code>FROM_TZ</code></a></p>
</td>
<td class="cellalignment1911" headers="r6c1-t16 r1c2-t16">
<p>Conve<a id="sthref324"></a><a id="sthref325"></a>rts a <code>TIMESTAMP</code> value at a time zone to a <code>TIMESTAMP WITH TIME ZONE</code> value</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r7c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00660" href="../../server.112/e41084/functions092.htm#SQLRF00660"><code>LOCALTIMESTAMP</code></a></p>
</td>
<td class="cellalignment1911" headers="r7c1-t16 r1c2-t16">
<p>Returns <a id="sthref326"></a><a id="sthref327"></a>the current date and time in the session time zone in a value of the <code>TIMESTAMP</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r8c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00682" href="../../server.112/e41084/functions117.htm#SQLRF00682"><code>NUMTODSINTERVAL</code></a></p>
</td>
<td class="cellalignment1911" headers="r8c1-t16 r1c2-t16">
<p>Convert<a id="sthref328"></a><a id="sthref329"></a>s number <code><span class="codeinlineitalic">n</span></code> to an <code>INTERVAL DAY TO SECOND</code> literal</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r9c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF00683" href="../../server.112/e41084/functions118.htm#SQLRF00683"><code>NUMTOYMINTERVAL</code></a></p>
</td>
<td class="cellalignment1911" headers="r9c1-t16 r1c2-t16">
<p>Conv<a id="sthref330"></a><a id="sthref331"></a>erts number <code><span class="codeinlineitalic">n</span></code> to an <code>INTERVAL YEAR TO MONTH</code> literal</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r10c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06105" href="../../server.112/e41084/functions162.htm#SQLRF06105"><code>SESSIONTIMEZONE</code></a></p>
</td>
<td class="cellalignment1911" headers="r10c1-t16 r1c2-t16">
<p>Retur<a id="sthref332"></a><a id="sthref333"></a>ns the value of the current session's time zone</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r11c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06119" href="../../server.112/e41084/functions186.htm#SQLRF06119"><code>SYS_EXTRACT_UTC</code></a></p>
</td>
<td class="cellalignment1911" headers="r11c1-t16 r1c2-t16">
<p>Extr<a id="sthref334"></a><a id="sthref335"></a>acts the UTC from a datetime with time zone offset</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r12c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06124" href="../../server.112/e41084/functions191.htm#SQLRF06124"><code>SYSDATE</code></a></p>
</td>
<td class="cellalignment1911" headers="r12c1-t16 r1c2-t16">
<p>Returns the date and time of the operating system on which the database resides, taking into account the time zone of the database<a id="sthref336"></a><a id="sthref337"></a> server's operating system that was in effect when the database was started</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r13c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06125" href="../../server.112/e41084/functions192.htm#SQLRF06125"><code>SYSTIMESTAMP</code></a></p>
</td>
<td class="cellalignment1911" headers="r13c1-t16 r1c2-t16">
<p>Return<a id="sthref338"></a><a id="sthref339"></a>s the system date, including fractional seconds and time zone of the system on which the database resides</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r14c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06128" href="../../server.112/e41084/functions199.htm#SQLRF06128"><code>TO_CHAR</code> (datetime)</a></p>
</td>
<td class="cellalignment1911" headers="r14c1-t16 r1c2-t16">
<p>Converts a<a id="sthref340"></a><a id="sthref341"></a> datetime or interval value of <code>DATE</code>, <code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE</code>, or <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type to a value of <code>VARCHAR2</code> data type in the format specified by the <code><span class="codeinlineitalic">fmt</span></code> date format</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r15c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06133" href="../../server.112/e41084/functions204.htm#SQLRF06133"><code>TO_DSINTERVAL</code></a></p>
</td>
<td class="cellalignment1911" headers="r15c1-t16 r1c2-t16">
<p>Converts a ch<a id="sthref342"></a><a id="sthref343"></a>aracter string of <code>CHAR</code>, <code>VARCHAR2</code>, <code>NCHAR</code>, or <code>NVARCHAR2</code> data type to a value of <code>INTERVAL DAY TO SECOND</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r16c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06137" href="../../server.112/e41084/functions208.htm#SQLRF06137"><code>TO_NCHAR</code> (datetime)</a></p>
</td>
<td class="cellalignment1911" headers="r16c1-t16 r1c2-t16">
<p>Converts a datetime or interval value of <code>DATE</code>, <code>TIMESTAMP</code>, <code>TIMESTAMP WITH TIME ZONE</code>, <code>TIMESTAMP WITH LOCAL TIME ZONE</code>, <code>INTERVAL MONTH TO YEAR</code>, or <code>INTERVAL DAY TO SECOND</code> data type from the database character set to the national character set</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r17c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06142" href="../../server.112/e41084/functions213.htm#SQLRF06142"><code>TO_TIMESTAMP</code></a></p>
</td>
<td class="cellalignment1911" headers="r17c1-t16 r1c2-t16">
<p>Convert<a id="sthref344"></a><a id="sthref345"></a>s a character string of <code>CHAR</code>, <code>VARCHAR2</code>, <code>NCHAR</code>, or <code>NVARCHAR2</code> data type to a value of <code>TIMESTAMP</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r18c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06143" href="../../server.112/e41084/functions214.htm#SQLRF06143"><code>TO_TIMESTAMP_TZ</code></a></p>
</td>
<td class="cellalignment1911" headers="r18c1-t16 r1c2-t16">
<p>Converts a c<a id="sthref346"></a><a id="sthref347"></a>haracter string of <code>CHAR</code>, <code>VARCHAR2</code>, <code>NCHAR</code>, or <code>NVARCHAR2</code> data type to a value of the <code>TIMESTAMP WITH TIME ZONE</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r19c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06144" href="../../server.112/e41084/functions215.htm#SQLRF06144"><code>TO_YMINTERVAL</code></a></p>
</td>
<td class="cellalignment1911" headers="r19c1-t16 r1c2-t16">
<p>Conve<a id="sthref348"></a><a id="sthref349"></a>rts a character string of <code>CHAR</code>, <code>VARCHAR2</code>, <code>NCHAR</code>, or <code>NVARCHAR2</code> data type to a value of the <code>INTERVAL YEAR TO MONTH</code> data type</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r20c1-t16" headers="r1c1-t16">
<p><a class="olink SQLRF06152" href="../../server.112/e41084/functions222.htm#SQLRF06152"><code>TZ_OFFSET</code></a></p>
</td>
<td class="cellalignment1911" headers="r20c1-t16 r1c2-t16">
<p>Returns the time zone offset that corresponds to the entered value, based o<a id="sthref350"></a><a id="sthref351"></a>n the date that the statement is executed</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p><a href="#CBBICFDB">Table 4-3</a> describes functions that are used in the Daylight Saving Time (DST) upgrade process, and are only available when preparing or updating windows. For more detailed information, see <a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>.</p>
<div class="tblformal">
<p class="titleintable"><a id="NLSPG757"></a><a id="sthref352"></a><a id="CBBICFDB"></a>Table 4-3 Time Zone Conversion Functions</p>
<table class="cellalignment1916" title="Time Zone Conversion Functions" summary="Timezone Functions" dir="ltr">
<thead>
<tr class="cellalignment1905">
<th class="cellalignment1915" id="r1c1-t17">Time Zone Function</th>
<th class="cellalignment1915" id="r1c2-t17">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r2c1-t17" headers="r1c1-t17">
<p><a class="olink SQLRF30032" href="../../server.112/e41084/functions121.htm#SQLRF30032"><code>ORA_DST_AFFECTED</code></a></p>
</td>
<td class="cellalignment1911" headers="r2c1-t17 r1c2-t17">
<p>Enables yo<a id="sthref353"></a><a id="sthref354"></a>u to verify whether the data in a column is affected by upgrading the DST rules from one version to another version</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r3c1-t17" headers="r1c1-t17">
<p><a class="olink SQLRF30034" href="../../server.112/e41084/functions122.htm#SQLRF30034"><code>ORA_DST_CONVERT</code></a></p>
</td>
<td class="cellalignment1911" headers="r3c1-t17 r1c2-t17">
<p>Enables you to upgrade your TSTZ column data from one version to<a id="sthref355"></a><a id="sthref356"></a> another</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r4c1-t17" headers="r1c1-t17">
<p><a class="olink SQLRF30033" href="../../server.112/e41084/functions123.htm#SQLRF30033"><code>ORA_DST_ERROR</code></a></p>
</td>
<td class="cellalignment1911" headers="r4c1-t17 r1c2-t17">
<p>Enables you to<a id="sthref357"></a><a id="sthref358"></a> verify that there are no errors when upgrading a datetime value</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect1" -->
<a id="i1006532"></a><a id="NLSPG254"></a>
<div class="sect1">
<h2 class="sect1">Datetime and Time Zone Parameters and Environment Variables</h2>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#i1006547">Datetime Format Parameters</a></p>
</li>
<li>
<p><a href="#CBBEEAFB">Time Zone Environment Variables</a></p>
</li>
<li>
<p><a href="#i1009078">Daylight Saving Time Session Parameter</a></p>
</li>
<li>
<p><a href="#CBBGDFFJ">Daylight Saving Time Upgrade Parameter</a></p>
</li>
</ul>
<a id="i1006547"></a><a id="NLSPG255"></a>
<div class="sect2">
<h3 class="sect2">Datetime Format Parameters</h3>
<p><a href="#g1011052">Table 4-4</a> contains the names and descriptions of the datetime <a id="sthref359"></a>format parameters.</p>
<div class="tblformal">
<p class="titleintable"><a id="NLSPG758"></a><a id="sthref360"></a><a id="g1011052"></a>Table 4-4 Datetime Format Parameters</p>
<table class="cellalignment1916" title="Datetime Format Parameters " summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1905">
<th class="cellalignment1915" id="r1c1-t19">Parameter</th>
<th class="cellalignment1915" id="r1c2-t19">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r2c1-t19" headers="r1c1-t19">
<p><code>NLS_DATE_FORMAT</code></p>
</td>
<td class="cellalignment1911" headers="r2c1-t19 r1c2-t19">
<p>Defines the <a id="sthref361"></a>default date f<a id="sthref362"></a><a id="sthref363"></a>ormat to use with the <code>TO_CHAR<a id="sthref364"></a></code> and <code>TO_DATE<a id="sthref365"></a></code> functions</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r3c1-t19" headers="r1c1-t19">
<p><code>NLS_TIMESTAMP_FORMAT</code></p>
</td>
<td class="cellalignment1911" headers="r3c1-t19 r1c2-t19">
<p>Defines the <a id="sthref366"></a><a id="sthref367"></a>default timestamp format to use with the <code>TO_CHAR</code> and <code>TO_TIMESTAMP</code> functions</p>
</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r4c1-t19" headers="r1c1-t19">
<p><code>NLS_TIMESTAMP_TZ_FORMAT</code></p>
</td>
<td class="cellalignment1911" headers="r4c1-t19 r1c2-t19">
<p>Defines th<a id="sthref368"></a><a id="sthref369"></a>e default timestamp with time zone format to use with the <code>TO_CHAR</code> and <code>TO_TIMESTAMP_TZ</code> functions</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>Their default values are derived from <code>NLS_TERRITORY</code>.</p>
<p>You can specify their values by setting them in the initialization parameter file. If you change the values in the initialization parameter file, you need to restart the instance for the change to take effect. You can also specify their values for a client as client environment variables. For Java clients, the value of <code>NLS_TERRITORY</code> is derived from the default locale of JRE. The values specified in the initialization parameter file are not used for JDBC sessions.</p>
<p>To change their values during a session, use the <code>ALTER SESSION</code> statement.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="ch3globenv.htm#i1006741">"Date and Time Parameters"</a> for more information, including examples</p>
</li>
<li>
<p><a href="ch3globenv.htm#i1006817">"NLS_DATE_FORMAT"</a></p>
</li>
<li>
<p><a href="ch3globenv.htm#i1007035">"NLS_TIMESTAMP_FORMAT"</a></p>
</li>
<li>
<p><a href="ch3globenv.htm#i1007084">"NLS_TIMESTAMP_TZ_FORMAT"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CBBEEAFB"></a><a id="NLSPG256"></a>
<div class="sect2">
<h3 class="sect2">Time Zone Environment Variables</h3>
<p>The <a id="sthref370"></a><a id="sthref371"></a><a id="sthref372"></a><a id="sthref373"></a><a id="sthref374"></a>time zone environment variables are:</p>
<ul>
<li>
<p><code>ORA_TZFILE</code>, which enables you to specify a time zone on the client and Oracle Database server. Note that when you specify <code>ORA_TZFILE</code> on Oracle Database server, the only time when this environment variable takes effect is during the creation of the database.</p>
</li>
<li>
<p><code>ORA_SDTZ</code>, which specifies the default session time zone.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#i1006667">"Choosing a Time Zone File"</a></p>
</li>
<li>
<p><a href="#i1006728">"Setting the Session Time Zone"</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1009078"></a><a id="NLSPG257"></a>
<div class="sect2">
<h3 class="sect2">Daylight Saving Time Session Parameter</h3>
<p><code><a id="sthref375"></a><a id="sthref376"></a><a id="sthref377"></a>ERROR_ON_OVERLAP_TIME</code> is a session parameter that determines how Oracle Database handles an ambiguous datetime boundary value. Ambiguous datetime values can occur when the time changes between Daylight Saving Time and standard time.</p>
<p>The possible values are <code>TRUE</code> and <code>FALSE</code>. When <code>ERROR_ON_OVERLAP_TIME</code> is <code>TRUE</code>, then an error is returned when Oracle Database encounters an ambiguous datetime value. When <code>ERROR_ON_OVERLAP_TIME</code> is <code>FALSE</code>, then ambiguous datetime values are assumed to be the standard time representation for the region. The default value is <code>FALSE</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#i1006760">"Support for Daylight Saving Time"</a></p>
</li>
<li>
<p><a class="olink SQLRF53052" href="../../server.112/e41084/statements_2013.htm#SQLRF53052"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CBBGDFFJ"></a><a id="NLSPG759"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Daylight Saving Time Upgrade Parameter</h3>
<p><code>DST_UPGRADE_INSERT_CONV</code> is <a id="sthref378"></a><a id="sthref379"></a><a id="sthref380"></a><a id="sthref381"></a>an initialization parameter that is only used during the upgrade window of the Daylight Saving Time (DST) upgrade process. It is only applicable to tables with <code>TIMESTAMP</code> <code>WITH</code> <code>TIME ZONE</code> columns because those are the only ones that are modified during the DST upgrade.</p>
<p>During the upgrade window of the DST patching process (which is described in the <code>DBMS_DST</code> package), tables with <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> data undergo conversion to the new time zone version. Columns in tables that have not yet been converted will still have the <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> reflecting the previous time zone version. In order to present the data in these columns as though they had been converted to the new time zone version when you issue <code>SELECT</code> statements, Oracle adds by default conversion operators over the columns to convert them to the new version. Adding the conversion operator may, however, slow down queries and disable usage of indexes on the <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> columns. Hence, Oracle provides a parameter, <code>DST_UPGRADE_INSERT_CONV</code>, that specifies whether or not internal operators are allocated on top of <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> columns of tables that have not been upgraded. By default, its value is <code>TRUE</code>. If users know that the conversion process will not affect the <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> columns, then this parameter can be set to <code>FALSE</code>.</p>
<p>Oracle strongly recommends that you set this parameter to <code>TRUE</code> throughout the DST patching process. By default, this parameter is set to <code>TRUE</code>. However, if set to <code>TRUE</code>, query performance may be degraded on unconverted tables. Note that this only applies during the upgrade window.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink REFRN" href="../e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a></p>
</li>
<li>
<p><a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006667"></a><a id="NLSPG258"></a>
<div class="sect1">
<h2 class="sect1">Choosing a Time Zone File</h2>
<p>The Oracle Database <a id="sthref382"></a><a id="sthref383"></a>time zone files contain the valid time zone names. The following information is also included for each time zone:</p>
<ul>
<li>
<p>Offset from Coordinated Universal Time (UTC)</p>
</li>
<li>
<p>Transition times for Daylight Saving Time</p>
</li>
<li>
<p>Abbreviations for standard time and Daylight Saving Time</p>
</li>
</ul>
<p>Oracle Database supplies multiple versions of time zone files, and there are two types of file associated with each one: a large file, which contains all the time zones defined in the database, and a small file, which contains only the most commonly used time zones. The large versions are designated as <code>timezlrg_&lt;version_number&gt;.dat</code>, while the small versions are designated as <code>timezone_&lt;version_number&gt;.dat</code>. The files are located in the <code>oracore/zoneinfo</code> subdirectory under the Oracle Database home directory, so, for example, the default time zone file is the highest version time zone file in this subdirectory. For example, in Oracle Database 11<span class="italic">g</span>, release 2, the default file is <code>$ORACLE_HOME/oracore<a id="sthref384"></a><a id="sthref385"></a>/zoneinfo/timezlrg_14.dat</code>, which contains all the time zones defined in the database.</p>
<p>Examples of time zone files are:</p>
<pre>
$ORACLE_HOME/oracore/zoneinfo/timezlrg_4.dat   -- large version 4
$ORACLE_HOME/oracore/zoneinfo/timezone_4.dat   -- small version 4
$ORACLE_HOME/oracore/zoneinfo/timezlrg_5.dat   -- large version 5
$ORACLE_HOME/oracore/zoneinfo/timezone_5.dat   -- small version 5
</pre>
<p>During the database creation process, you choose the time zone version for the server. This version is fixed, but you can, however, go through the upgrade process to achieve a higher version. You can use different versions of time zone files on the client and server, but Oracle recommends that you do not. This is because there is a performance penalty when a client on one version communicates with a server on a different version. The performance penalty arises because the <code>TIMESTAMP</code> <code>WITH</code> <code>TIME ZONE</code> (TSTZ) data is transferred using a local timestamp instead of UTC.</p>
<p>On the server, Oracle Database always uses a large file. On the client, you can use either a large or a small file. If you use a large time zone file on the client, then you should continue to use it unless you are sure that no information will be missing if you switch to a smaller one. If you use a small file, you have to make sure that the client does not query data that is not present in the small time zone file. Otherwise, you get an error.</p>
<p>You can enable the use of a specific time zone file in the client or on the server. If you want to enable a time zone file on the server, there are two situations. One is that you go through a time zone upgrade to the target version. See <a href="#CACFFHCJ">"Upgrading the Time Zone File and Timestamp with Time Zone Data"</a> for more information. Another is when you are creating a new database, in that case, you can set the <code>ORA_TZFILE</code> environment variable to point to the time zone file of your choice.</p>
<p>To enable a specific time zone file on the client, you can set <code>ORA_TZFILE</code> to whatever time zone file you want. If <code>ORA_TZFILE</code> is not set, Oracle Database automatically picks up and use the file with the latest time zone version. See <a class="olink LNOCI16761" href="../../appdev.112/e10646/oci10new.htm#LNOCI16761"><span class="italic">Oracle Call Interface Programmer's Guide</span></a> for more information on how to upgrade Daylight Saving Time on the client.</p>
<p>Oracle Database <a id="sthref386"></a>time zone data is derived from the public domain information available at <code><a href="ftp://elsie.nci.nih.gov/pub/">ftp://elsie.nci.nih.gov/pub/</a></code>. Oracle Database time zone data may not reflect the most recent data available at this site.</p>
<p>You can obtain a list of time <a id="sthref387"></a><a id="sthref388"></a><a id="sthref389"></a><a id="sthref390"></a>zone names and time zone abbreviations from the time zone file that is installed with your database by entering the following statement:</p>
<pre>
SELECT TZNAME, TZABBREV 
FROM V$TIMEZONE_NAMES
ORDER BY TZNAME, TZABBREV;
</pre>
<p>For the default time zone file, this statement results in output similar to the following:</p>
<pre>
TZNAME               TZABBREV
-------------------- ----------
Africa/Abidjan       GMT
Africa/Abidjan       LMT
...
Africa/Algiers       CEST
Africa/Algiers       CET
Africa/Algiers       LMT
Africa/Algiers       PMT
Africa/Algiers       WET
Africa/Algiers       WEST
...
WET                  LMT
WET                  WEST
WET                  WET

2137 rows selected.
</pre>
<p>In the above output, 2 time zone abbreviations are associated with the Africa/Abidjan time zone, and 6 abbreviations are associated with the Africa/Algiers time zone. The following table shows some of the time zone abbreviations and their meanings.</p>
<div class="inftblinformal">
<table class="cellalignment1914" title="Time zone abbreviations" summary="This table is described in the preceding text" dir="ltr">
<thead>
<tr class="cellalignment1905">
<th class="cellalignment1915" id="r1c1-t24">Time Zone Abbreviation</th>
<th class="cellalignment1915" id="r1c2-t24">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r2c1-t24" headers="r1c1-t24">LMT</td>
<td class="cellalignment1911" headers="r2c1-t24 r1c2-t24">Local Mean Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r3c1-t24" headers="r1c1-t24">PMT</td>
<td class="cellalignment1911" headers="r3c1-t24 r1c2-t24">Paris Mean Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r4c1-t24" headers="r1c1-t24">WET</td>
<td class="cellalignment1911" headers="r4c1-t24 r1c2-t24">Western European Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r5c1-t24" headers="r1c1-t24">WEST</td>
<td class="cellalignment1911" headers="r5c1-t24 r1c2-t24">Western European Summer Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r6c1-t24" headers="r1c1-t24">CET</td>
<td class="cellalignment1911" headers="r6c1-t24 r1c2-t24">Central Europe Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r7c1-t24" headers="r1c1-t24">CEST</td>
<td class="cellalignment1911" headers="r7c1-t24 r1c2-t24">Central Europe Summer Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r8c1-t24" headers="r1c1-t24">EET</td>
<td class="cellalignment1911" headers="r8c1-t24 r1c2-t24">Eastern Europe Time</td>
</tr>
<tr class="cellalignment1905">
<td class="cellalignment1911" id="r9c1-t24" headers="r1c1-t24">EEST</td>
<td class="cellalignment1911" headers="r9c1-t24 r1c2-t24">Eastern Europe Summer Time</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>Note that an abbreviation can be associated with multiple time zones. For example, CET is associated with both Africa/Algiers and Africa/Casablanca, as well as time zones in Europe.</p>
<p>If you want a list of time zones without repeating the time zone name for each abbreviation, use the following query:</p>
<pre>
SELECT UNIQUE TZNAME
FROM V$TIMEZONE_NAMES;
</pre>
<p>For example, version 11 contains output similar to the following:</p>
<pre>
TZNAME
--------------------
Africa/Addis_Ababa
Africa/Bissau
Africa/Ceuta
...
Turkey
US/East-Indiana
US/Samoa
</pre>
<p>The default time zone file contains more than 350 unique time zone names. The small time zone file contains more than 180 unique time zone names.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="ch13custlocale.htm#CACHAEFG">"Customizing Time Zone Data"</a></p>
</li>
<li>
<p><a href="applocaledata.htm#i637736">"Time Zone Region Names"</a> for a list of valid Oracle Database time zone names</p>
</li>
<li>
<p><code>$ORACLE_HOME/oracore/zoneinfo/timezdif.csv</code>, provided with your Oracle Database software installation, for a full list of time zones changed since Oracle9<span class="italic">i</span></p>
</li>
<li>
<p><a class="olink UPGRD12399" href="../../server.112/e23633/upgrade.htm#UPGRD12399"><span class="italic">Oracle Database Upgrade Guide</span></a> for upgrade information</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CACFFHCJ"></a><a id="NLSPG259"></a>
<div class="sect1">
<h2 class="sect1">Upgrading the Time Zone File and Timestamp with Time Zone Data</h2>
<p>The time <a id="sthref391"></a><a id="sthref392"></a>zone files that are supplied with the Oracle Database are updated periodically to reflect changes in transition rules for various time zone regions. To find which Time Zone File your database currently uses, query <code>V$TIMEZONE_FILE</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database 9<span class="italic">i</span> includes version 1 of the time zone files, and Oracle Database 10<span class="italic">g</span> includes version 2. For Oracle Database 11<span class="italic">g</span>, release 2, all time zone files from versions 1 to 14 are included. Various patches and patch sets, which are released separately for these releases, may update the time zone file version as well.</div>
<a id="NLSPG260"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref393"></a>
<h3 class="sect2">Daylight Saving Time (DST) Transition Rules Changes</h3>
<p>Governments can an<a id="sthref394"></a>d do change the rules for when Daylight Saving Time takes effect or how it is handled. When this occurs, Oracle provides a new set of transition rules for handling timestamp with time zone data.</p>
<p>Transition periods for the beginning or ending of Daylight Saving Time can potentially introduce problems (such as data loss) when handling timestamps with time zone data. Because of this, there are certain rules for dealing with the transition, and, in this release, these transition rules have changed. In addition, Oracle has significantly improved the way of dealing with this transition by providing a new package called <code>DBMS_DST</code>.</p>
<p>The changes to DST transition rules may affect existing data of <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> data type, because of the way Oracle Database stores this data internally. When users enter timestamps with time zone, Oracle Database converts the data to UTC, based on the transition rules in the time zone file, and stores the data together with the ID of the original time zone on disk. When data is retrieved, the reverse conversion from UTC takes place. For example, when the version 2 transition rules were in effect, the value <code>TIMESTAMP</code> <code>'2007-11-02 12:00:00 America/Los_Angeles'</code>, would have been stored as UTC value <code>'2007-11-02 20:00:00'</code> <span class="italic">plus</span> the time zone ID for <code>'America/Los_Angeles'</code>. The time in Los Angeles would have been UTC <span class="italic">minus</span> eight hours (PST). Under version 3 of the transition rules, the offset for the same day is <span class="italic">minus</span> seven hours (PDT). Beginning with year 2007, the DST has been in effect longer (until the first Sunday of November, which is November 4th in 2007). Now, when users retrieve the same timestamp and the new offset is added to the stored UTC time, they receive <code>TIMESTAMP</code> <code>'2007-11-02 13:00:00 America/Los_Angeles'</code>. There is a one hour difference compared to the data previous to version 3 taking effect.</p>
<p>See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information regarding the <code>DBMS_DST</code> package.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
For any time zone region whose transition rules have been updated, the upgrade process discussed throughout this section, <a href="#CACFFHCJ">"Upgrading the Time Zone File and Timestamp with Time Zone Data"</a>, affects only timestamps that point to the future relative to the effective date of the corresponding DST rule change. For example, no timestamp before year 2007 is affected by the version 3 change to the 'America/Los_Angeles' time zone region.</div>
</div>
<!-- class="sect2" -->
<a id="NLSPG760"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref395"></a>
<h3 class="sect2">Preparing to Upgrade the Time Zone File and Timestamp with Time Zone Data</h3>
<p>Before you actually upgrade any data, you should verify what the impact of the upgrade is likely to be. In general, you can consider the upgrade process to have two separate subprocesses. The first is to create a prepare window and the second is to create an upgrade window. The prepare window is the time where you check how much data has to be updated in the database, while the upgrade window is the time when the upgrade actually occurs.</p>
<p>While not required, Oracle strongly recommends you perform the prepare window step. In addition to finding out how much data will have to be modified during the upgrade, thus giving you an estimate of how much time the upgrade will take, you will also see any semantic errors that you may encounter. See <a href="#CHDBDEBI">"Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data"</a>.</p>
<p>You can create a prepare window to find the affected data using the following steps:</p>
<ol>
<li>
<p>Install the desired (latest) time zone file to which you will be later migrating into <code>$ORACLE_HOME/oracore/zoneinfo</code>. The desired (latest) version of <code>timezlrg_&lt;version_number&gt;.dat</code> is required, while <code>timezone_&lt;version_number&gt;.dat</code> may also be added at your discretion. These files can be found on My Oracle Support.</p>
</li>
<li>
<p>You can optionally create an error table as well as a table that contains affected timestamp with time zone information by using <code>DBMS_DST.CREATE_ERROR_TABLE</code> and <code>DBMS_DST.CREATE_AFFECTED_TABLE</code>, respectively, If you do not, Oracle Database uses the pre-built <code>sys.dst$affected_tables</code> and <code>sys.dst$error_table</code>. These tables are used in step 4.</p>
<pre>
EXEC DBMS_DST.CREATE_AFFECTED_TABLE('my_affected_tables');
EXEC DBMS_DST.CREATE_ERROR_TABLE('my_error_table');
</pre></li>
<li>
<p>Invoke <code>DBMS_DST.BEGIN_PREPARE(&lt;new_version&gt;)</code>, which is the version you chose in Step 1. See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information regarding <code>DBMS_DST</code> privilege information.</p>
</li>
<li>
<p>Check the affected data by invoking <code>DBMS_DST.FIND_AFFECTED_TABLES</code>, and verifying the affected columns by querying <code>sys.dst$affected_tables</code>. Also, it is particularly important to check <code>sys.dst$affected_tables.error_count</code> for possible errors. If the error count is greater than 0, you can check what kind of errors might expect during the upgrade by checking <code>sys.dst$error_table</code>. See <a href="#CHDBDEBI">"Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data"</a>.</p>
</li>
<li>
<p>End the prepare window by invoking <code>DBMS_DST.END_PREPARE</code>.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Note that only one DBA should run the prepare window at one time. Also, make sure to correct all errors before running the upgrade.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can find the matrix of available patches for updating your time zone files by going to My Oracle Support at <code><a href="http://support.oracle.com">http://support.oracle.com</a></code> and reading Document ID 412160.1.</div>
</div>
<!-- class="sect2" -->
<a id="NLSPG261"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref396"></a>
<h3 class="sect2">Steps to Upgrade Time Zone File and Timestamp with Time Zone Data</h3>
<p>Upgrading a time zone file <a id="sthref397"></a>and timestamp with time zone data contains the following steps:</p>
<ol>
<li>
<p>If you have not already done so, download the desired (latest) version of <code>timezlrg_&lt;version_number&gt;.dat</code> and install it in <code>$ORACLE_HOME/oracore/zoneinfo</code>. In addition, you can optionally download <code>timezone_&lt;version_number&gt;.dat</code> from My Oracle Support and put it in the same location.</p>
</li>
<li>
<p>Shut down the database. In Oracle RAC, you must shut down all instances.</p>
</li>
<li>
<p>Start up the database in <code>UPGRADE</code> mode. Note that, in Oracle RAC, only one instance should be started. See <a class="olink UPGRD" href="../e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for an explanation of <code>UPGRADE</code> mode.</p>
</li>
<li>
<p>Execute <code>DBMS_DST.BEGIN_UPGRADE(&lt;new_version&gt;)</code>. Optionally, you can have two other parameters that you can specify to <code>TRUE</code> if you do not want to ignore semantic errors during the upgrade of dictionary tables that contain timestamp with time zone data. If you specify <code>TRUE</code> for either or both of these parameters, the errors are populated into <code>sys.dst$error_table</code> by default. In this case, you might want to truncate the error table before you begin the <code>BEGIN_UPGRADE</code> procedure. See <span class="italic">Oracle Database PL/SQL Packages and Types Reference</span> for more information.</p>
</li>
<li>
<p>If the <code>BEGIN_UPGRADE</code> execution fails, an ORA-56927 error (Starting an upgrade window failed) is raised.</p>
<p>After <code>BEGIN_UPGRADE</code> finishes executing with errors, check <code>sys.dst$error_table</code> to determine if the dictionary conversion was successful. If successful, there will not be any rows in the table. If there are errors, correct these errors manually and rerun <code>DBMS_DST.BEGIN_UPGRADE(&lt;new_version&gt;)</code>. See <a href="#CHDBDEBI">"Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data"</a>.</p>
</li>
<li>
<p>Restart the database in normal mode.</p>
</li>
<li>
<p>Truncate the error and trigger tables (by default, <code>sys.dst$error_table</code> and <code>sys.dst$trigger_table</code>).</p>
<p>The trigger table records the disabled TSTZ table triggers during the upgrade process, which is passed as a parameter to <code>DBMS_DST.UPGRADE_*</code> procedures. Note that you can optionally create your own trigger table by calling <code>DBMS_DST.CREATE_TRIGGER_TABLE</code>. During <code>DBMS_DST.UPGRADE_*</code>, Oracle Database first disables the triggers on a TSTZ table before performing the upgrade of its affected TSTZ data. Oracle Database also saves the information from those triggers in <code>sys.dst$trigger_table</code>. After completing the upgrade of the affected TSTZ data in the table, those disabled triggers are enabled by reading from <code>sys.dst$trigger_table</code> and then removed from <code>sys.dst$trigger_table</code>. If any fatal error occurs, such as an unexpected instance shutdown during the upgrade process, you should check <code>sys.dst$trigger_table</code> to see if any trigger has not been restored to its previous active state before the upgrade.</p>
</li>
<li>
<p>Upgrade the TSTZ data in all tables by invoking <code>DBMS_DST.UPGRADE_DATABASE</code>.</p>
</li>
<li>
<p>Verify that all tables have finished being upgraded by querying the <code>DBA_TSTZ_TABLES</code> view, as shown in <a href="#CBBHHBHG">"Example of Updating Daylight Saving Time Behavior"</a>. Then look at <code>dst$error_table</code> to see if there were any errors. If there were errors, correct the errors and rerun <code>DBMS_DST.UPGRADE_TABLE</code> on the relevant tables. Or, if you do not think those errors are important, re-run with the parameters set to ignore errors.</p>
</li>
<li>
<p>End the upgrade window by invoking <code>DBMS_DST.END_UPGRADE</code>.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
Tables containing timestamp with time zone columns need to be in a state where they can be updated. So, as an example, the columns cannot have validated and disabled check constraints as this prevents updating.
<p>Oracle recommends that you use the parallel option if a table size is greater than 2 Gigabytes. Oracle also recommends that you allow Oracle to handle any semantic errors that may arise.</p>
<p>Note that, when you issue a <code>CREATE</code> statement for error, trigger, or affected tables, you need to pass the table name only, not the schema name. This is because the tables will be created in the current invoker's schema.</p>
</div>
<a id="CBBHHBHG"></a><a id="NLSPG761"></a>
<div class="sect3">
<h4 class="sect3">Example of Updating Daylight Saving Time Behavior</h4>
<p>This example illustrates updating DST behavior to Oracle Database 11<span class="italic">g</span>, release 2. First, assume that your current database is using time zone version 3, and also assume you have an existing table <code>t</code>, which contains timestamp with time zone data.</p>
<pre>
CONNECT scott/tiger
DROP TABLE t;
CREATE TABLE t (c NUMBER, mark VARCHAR(25), ts TIMESTAMP WITH TIME ZONE);
 
INSERT INTO t VALUES(1, 'not_affected', 
                    to_timestamp_tz('22-sep-2006 13:00:00 america/los_angeles',
                                     'dd-mon-yyyy hh24:mi:ss tzr tzd'));
INSERT INTO t VALUES(4, 'affected_err_exist',
                     to_timestamp_tz('11-mar-2007 00:30:00 america/st_johns',
                                     'dd-mon-yyyy hh24:mi:ss tzr tzd'));
INSERT INTO t VALUES(6, 'affected_no_err',
                     to_timestamp_tz('11-mar-2007 01:30:00 america/st_johns',
                                     'dd-mon-yyyy hh24:mi:ss tzr tzd'));
INSERT INTO t VALUES(14, 'affected_err_dup', 
                     to_timestamp_tz('21-sep-2006 23:30:00 egypt',
                                     'dd-mon-yyyy hh24:mi:ss tzr tzd'));
COMMIT;
 
</pre>
<p>Then, optionally, you can start a prepare window to check the affected data and potential semantic errors where there is an overlap or non-existing time. To do this, you should start a window for preparation to migrate to version 4. It is assumed that you have the necessary privileges. These privileges are controlled with the <code>DBMS_DST</code> package. See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information.</p>
<p>As an example, first, prepare the window.</p>
<pre>
conn / AS SYSDBA
set serveroutput on
EXEC DBMS_DST.BEGIN_PREPARE(4);
 
A prepare window has been successfully started.
 
PL/SQL procedure successfully completed.
 
</pre>
<p>Note that the argument 4 causes version 4 to be used in this statement. After this window is successfully started, you can check the status of the DST in <code>DATABASE_PROPERTIES</code>, as in the following:</p>
<pre>
SELECT PROPERTY_NAME, SUBSTR(property_value, 1, 30) value
FROM DATABASE_PROPERTIES
WHERE NAME LIKE 'DST_%'
ORDER BY PROPERTY_NAME;
 
</pre>
<p>You will see output resembling the following:</p>
<pre>
PROPERTY_NAME                  VALUE
---------------------------    ---------
DST_PRIMARY_TT_VERSION         3
DST_SECONDARY_TT_VERSION       4
DST_UPGRADE_STATE              PREPARE
</pre>
<p>Next, you can invoke <code>DBMS_DST.FIND_AFFECTED_TABLES</code> to find all the tables in the database that are affected if you upgrade from version 3 to version 4. This table contains the table owner, table name, column name, row count, and error count. Here, you have the choice of using the defaults for error tables (<code>sys.dst$error_table</code>) and affected tables (<code>sys.dst$affected_table</code>) or you can create your own. In this example, we create our own tables by using <code>DBMS_DST.CREATE_ERROR_TABLE</code> and <code>DBMS_DST.CREATE_AFFECTED_TABLE</code> and then pass to <code>FIND_AFFECTED_TABLES</code>, as in the following:</p>
<pre>
EXEC DBMS_DST.CREATE_AFFECTED_TABLE('scott.my_affected_tables');
EXEC DBMS_DST.CREATE_ERROR_TABLE('scott.my_error_table');
 
</pre>
<p>It is a good idea to make sure that there are no rows in these tables. You can do this by truncating the tables, as in the following:</p>
<pre>
TRUNCATE TABLE scott.my_affected_tables;
TRUNCATE TABLE scott.my_error_table;
</pre>
<p>Then, you can invoke <code>FIND_AFFECTED_TABLES</code> to see which tables are impacted during the upgrade:</p>
<pre>
EXEC DBMS_DST.FIND_AFFECTED_TABLES(affected_tables  =&gt; 'scott.my_affected_tables',
                                   log_errors       =&gt; TRUE,
                                   log_errors_table =&gt; 'scott.my_error_table');
</pre>
<p>Then, check the affected tables:</p>
<pre>
SELECT * FROM scott.my_affected_tables;
 
TABLE_OWNER   TABLE_NAME   COLUMN_NAM   ROW_COUNT  ERROR_COUNT
-----------   ----------   ----------   ---------  -----------
SCOTT         T            TS                   3            2
 
</pre>
<p>Then, check the error table:</p>
<pre>
SELECT * FROM scott.my_error_table;
 
TABLE_OWNER   TABLE_NAME  COLUMN_NAME   ROWID                ERROR_NUMBER
-----------   ----------  -----------   ------------------   ------------
SCOTT         T           TS            AAAPW3AABAAANzoAAB           1878
SCOTT         T           TS            AAAPW3AABAAANzoAAE           1883
 
</pre>
<p>These errors can be corrected by seeing <a href="#CHDBDEBI">"Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data"</a>. Then, end the prepare window, as in the following statement:</p>
<pre>
EXEC DBMS_DST.END_PREPARE;
 
A prepare window has been successfully ended.
 
PL/SQL procedure successfully completed.
 
</pre>
<p>After this, you can check the DST status in <code>DATABASE_PROPERTIES</code>:</p>
<pre>
SELECT PROPERTY_NAME, SUBSTR(property_value, 1, 30) value
FROM DATABASE_PROPERTIES
WHERE PROPERTY_NAME LIKE 'DST_%'
ORDER BY PROPERTY_NAME;
 
PROPERTY_NAME                 VALUE
------------------------      --------
DST_PRIMARY_TT_VERSION        3
DST_SECONDARY_TT_VERSION      0
DST_UPGRADE_STATE             NONE
 
</pre>
<p>Next, you can use the upgrade window to upgrade the affected data. To do this, first, start an upgrade window. Note that the database needs to be opened in <code>UPGRADE</code> mode before you can execute <code>DBMS_DST.BEGIN_UPGRADE</code>. In Oracle RAC, only one instance can be started. <code>BEGIN_UPGRADE</code> upgrades all dictionary tables in one transaction, so the invocation will either succeed or fail as one whole. During the procedure's execution, all user tables with TSTZ data are marked as an upgrade in progress. See <a class="olink UPGRD" href="../e23633/toc.htm"><span class="italic">Oracle Database Upgrade Guide</span></a> for more information.</p>
<p>Also, only <code>SYSDBA</code> can start an upgrade window. If you do not open the database in <code>UPGRADE</code> mode and invoke <code>BEGIN_UPGRADE</code>, you will see the following error:</p>
<pre>
EXEC DBMS_DST.BEGIN_UPGRADE(4);
BEGIN DBMS_DST.BEGIN_UPGRADE(4); END;
 
*
ERROR at line 1:
ORA-56926: database must be in UPGRADE mode in order to start an upgrade window
ORA-06512: at "SYS.DBMS_SYS_ERROR", line 79
ORA-06512: at "SYS.DBMS_DST", line 1021
ORA-06512: at line 1
 
</pre>
<p>So, <code>BEGIN_UPGRADE</code> upgrades system tables that contain TSTZ data and marks user tables (containing TSTZ data) with the <code>UPGRADE_IN_PROGRESS</code> property. This can be checked in <code>ALL_TSTZ_TABLES</code>, and is illustrated later in this example.</p>
<p>There are two parameters in <code>BEGIN_UPGRADE</code> that are for handling semantic errors: <code>error_on_overlap_time</code> (error number ORA-1883) and <code>error_on_nonexisting_time</code> (error number ORA-1878). If the parameters use the default setting of <code>FALSE</code>, Oracle converts the data using a default conversion and does not signal an error. See <a href="#CHDBDEBI">"Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data"</a> for more information regarding what they mean, and how to handle errors.</p>
<p>The following call can automatically correct semantic errors based on some default values when you upgrade the dictionary tables. If you do not ignore semantic errors, and you do have such errors in the dictionary tables, <code>BEGIN_UPGRADE</code> will fail. These semantic errors are populated into <code>sys.dst$error_table</code>.</p>
<pre>
EXEC DBMS_DST.BEGIN_UPGRADE(4);
An upgrade window has been successfully started.
 
PL/SQL procedure successfully completed.
 
</pre>
<p>After this, you can check the DST status in <code>DATABASE_PROPERTIES</code>, as in the following:</p>
<pre>
SELECT PROPERTY_NAME, SUBSTR(property_value, 1, 30) value
FROM DATABASE_PROPERTIES
WHERE PROPERTY_NAME LIKE 'DST_%'
ORDER BY PROPERTY_NAME;
 
PROPERTY_NAME               VALUE
------------------------    --------
DST_PRIMARY_TT_VERSION             4
DST_SECONDARY_TT_VERSION           3
DST_UPGRADE_STATE            UPGRADE
 
</pre>
<p>Then, check which user tables are marked with <code>UPGRADE_IN_PROGRESS</code>:</p>
<pre>
SELECT OWNER, TABLE_NAME, UPGRADE_IN_PROGRESS FROM ALL_TSTZ_TABLES;
 
OWNER   TABLE_NAME                      UPGRADE_IN_PROGRESS
-----   -------------------------       -------------------
SYS     WRI$_OPTSTAT_AUX_HISTORY        NO
SYS     WRI$_OPTSTAT_OPR                NO
SYS     OPTSTAT_HIST_CONTROL$           NO
SYS     SCHEDULER$_JOB                  NO
SYS     KET$_AUTOTASK_STATUS            NO
SYS     AQ$_ALERT_QT_S                  NO
SYS     AQ$_KUPC$DATAPUMP_QUETAB_S      NO
DBSNMP  MGMT_DB_FEATURE_LOG             NO
WMSYS   WM$VERSIONED_TABLES             NO
SYS     WRI$_OPTSTAT_IND_HISTORY        NO
SYS     OPTSTAT_USER_PREFS$             NO
SYS     FGR$_FILE_GROUP_FILES           NO
SYS     SCHEDULER$_WINDOW               NO
SYS     WRR$_REPLAY_DIVERGENCE          NO
SCOTT   T                               YES
IX      AQ$_ORDERS_QUEUETABLE_S         YES
...
 
</pre>
<p>In this output, dictionary tables (in the <code>SYS</code> schema) have already been upgraded by <code>BEGIN_UPGRADE</code>. User tables, such as <code>SCOTT.T</code>, have not been and are in progress.</p>
<p>Now you can perform an upgrade of user tables using <code>DBMS_DST.UPGRADE_DATABASE</code>. All tables need to be upgraded, otherwise, you will not be able to end the upgrade window using the <code>END_UPGRADE</code> procedure. Before this step, you must restart the database in <code>normal</code> mode. An example of the syntax is as follows:</p>
<pre>
VAR numfail number
BEGIN
   DBMS_DST.UPGRADE_DATABASE(:numfail,
            parallel                  =&gt; TRUE,
            log_errors                =&gt; TRUE,
            log_errors_table          =&gt; 'SYS.DST$ERROR_TABLE',
            log_triggers_table        =&gt; 'SYS.DST$TRIGGER_TABLE',
            error_on_overlap_time     =&gt; TRUE,
            error_on_nonexisting_time =&gt; TRUE);
DBMS_OUTPUT.PUT_LINE('Failures:'|| :numfail);
END;
/
</pre>
<p>If there are any errors, you should correct them and use <code>UPGRADE_TABLE</code> on the individual tables. In that case, you may need to handle tables related to materialized views, such as materialized view base tables, materialized view log tables, and materialized view container tables. There are a couple of considerations to keep in mind when upgrading these tables. First, the base table and its materialized view log table have to be upgraded atomically. Next, the materialized view container table has to be upgraded after all its base tables and the materialized view log tables have been upgraded. In general, Oracle recommends that you handle semantic errors by letting Oracle Database take the default action.</p>
<p>For the sake of this example, let us assume there were some errors in <code>SCOTT.T</code> after you ran <code>UPGRADE_DATABASE</code>. In that case, you can check these errors by issuing:</p>
<pre>
SELECT * FROM scott.error_table;
 
TABLE_OWNER   TABLE_NAME  COLUMN_NAME   ROWID                ERROR_NUMBER
-----------   ----------  -----------   ------------------   ------------
SCOTT         T           TS            AAAO2XAABAAANrgAAD           1878
SCOTT         T           TS            AAAO2XAABAAANrgAAE           1878
 
</pre>
<p>From this output, you can see that error number 1878 has occurred. This error means that an error has been thrown for a non-existing time.</p>
<p>To continue with this example, assume that <code>SCOTT.T</code> has a materialized view log <code>scott.mlog$_t</code>, and that there is a single materialized view on <code>SCOTT.T</code>. Then, assume that this 1878 error has been corrected.</p>
<p>Finally, you can upgrade the table, materialized view log and materialized view as follows:</p>
<pre>
BEGIN
  DBMS_DST.UPGRADE_TABLE(:numfail,
           table_list                =&gt; 'SCOTT.t, SCOTT.mlog$_T',
           parallel                  =&gt; TRUE,
           continue_after_errors     =&gt; FALSE,
           log_errors                =&gt; TRUE,
           log_errors_table          =&gt; 'SYS.DST$ERROR_TABLE',
           error_on_overlap_time     =&gt; FALSE,
           error_on_nonexisting_time =&gt; TRUE,
           log_triggers_table        =&gt; 'SYS.DST$TRIGGER_TABLE',
           atomic_upgrade            =&gt; TRUE);
 
 DBMS_OUTPUT.PUT_LINE('Failures:'|| :numfail);
END;
/

BEGIN
  DBMS_DST.UPGRADE_TABLE(:numfail, 
           table_list                =&gt; 'SCOTT.MYMV_T',
           parallel                  =&gt; TRUE,
           continue_after_errors     =&gt; FALSE,
           log_errors                =&gt; TRUE, 
           log_errors_table          =&gt; 'SYS.DST$ERROR_TABLE',
           error_on_overlap_time     =&gt; FALSE,
           error_on_nonexisting_time =&gt; TRUE,
           log_triggers_table        =&gt; 'SYS.DST$TRIGGER_TABLE',
           atomic_upgrade            =&gt; TRUE);
 
  DBMS_OUTPUT.PUT_LINE('Failures:'|| :numfail);
END;
/ 
</pre>
<p>The <code>atomic_upgrade</code> parameter enables you to combine the upgrade of the table with its materialized view log. See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information.</p>
<p>After all the tables are upgraded, you can invoke <code>END_UPGRADE</code> to end an upgrade window, as in the following:</p>
<pre>
BEGIN
  DBMS_DST.END_UPGRADE(:numfail OUT BINARY_INTEGER);
END;
/
</pre>
<p>If no other table was upgraded successfully, the <code>END_UPGRADE</code> statement fails.</p>
<p>See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information regarding the <code>DBMS_DST</code> package.</p>
</div>
<!-- class="sect3" -->
<a id="CHDBDEBI"></a><a id="NLSPG762"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Error Handling when Upgrading Time Zone File and Timestamp with Time Zone Data</h4>
<p>There are three major semantic errors that can occur during an upgrade. The first is when an existing time becomes a non-existing time, the second is when a time becomes duplicated, and the third is when a duplicate time becomes a non-duplicate time.</p>
<p>As an example of the first case, consider the change from Pacific Standard Time (PST) to Pacific Daylight Saving Time (PDT) in 2007. This change takes place on Mar-11-2007 at 2AM according to version 4 when the clock moves forward one hour to 3AM and produces a gap between 2AM and 3AM. In version 2, this time change occurs on Apr-01-2007. If you upgrade the time zone file from version 2 to version 4, any time in the interval between 2AM and 3AM on Mar-11-2007 is not valid, and raises an error (ORA-1878) if <code>ERROR_ON_NONEXISTING_TIME</code> is set to <code>TRUE</code>. Therefore, there is a non-existing time problem. When <code>ERROR_ON_NONEXISTING_TIME</code> is set to <code>FALSE</code>, which is the default value for this parameter, the error is not reported and Oracle preserves UTC time in this case. For example, "Mar-11-2007 02:30 PST" in version 2 becomes "Mar-11-2007 03:30 PDT" in version 4 as they both are translated to the same UTC timestamp.</p>
<p>An example of the second case occurs when changing from PDT to PST. For example, in version 4 for 2007, the change occurs on Nov-04-2007, when the time falls back from 2AM to 1AM. This means that times in the interval &lt;1AM, 2AM&gt; on Nov-04-2007 can appear twice, once with PST and once with PDT. In version 2, this transition occurs on Oct-28-2007 at 2AM. Thus, any timestamp within &lt;1AM, 2AM&gt; on Nov-04-2007, which is uniquely identified in version 2, results in an error (ORA-1883) in version 4, if <code>ERROR_ON_OVERLAP_TIME</code> is set to <code>TRUE</code>. If you leave this parameter on its default setting of <code>FALSE</code>, then the UTC timestamp value is preserved and no error is raised. In this situation, if you change the version from 2 to 4, timestamp "Nov-04-2007 01:30 PST" in version 2 becomes "Nov-04-2007 01:30 PST" in version 4.</p>
<p>The third case happens when a duplicate time becomes a non-duplicate time. Consider the transition from PDT to PST in 2007, for example, where &lt;1AM, 2AM&gt; on Oct-28-2007 in version 2 is the overlapped interval. Then both "Oct-28-2007 01:30 PDT" and "Oct-28-2007 01:30 PST" are valid timestamps in version 2. If <code>ERROR_ON_OVERLAP_TIME</code> is set to <code>TRUE</code>, an ORA-1883 error is raised during an upgrade from version 2 to version 4. If <code>ERROR_ON_OVERLAP_TIME</code> is set to <code>FALSE</code> (the default value of this parameter), however, the LOCAL time is preserved and no error is reported. In this case, both "Oct-28-2007 01:30 PDT" and "Oct-28-2007 01:30 PST" in version 2 convert to the same "Oct-28-2007 01:30 PDT" in version 4. Note that setting <code>ERROR_ON_OVERLAP_TIME</code> to <code>FALSE</code> can potentially cause some time sequences to be reversed. For example, a job (Job A) scheduled at "Oct-28-2007 01:45 PDT" in version 2 is supposed to be executed before a job (Job B) scheduled at "Oct-28-2007 01:30 PST". After the upgrade to version 4, Job A is scheduled at "Oct-28-2007 01:45 PDT" and Job B remains at "Oct-28-2007 01:30 PDT", resulting in Job B being executed before Job A. Even though unchained scheduled jobs are not guaranteed to be executed in a certain order, this issue should be kept in mind when setting up scheduled jobs.</p>
<p>See <a class="olink ARPLS234" href="../../appdev.112/e40758/d_dst.htm#ARPLS234"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information regarding how to use these parameters.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDCDCBH"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Clients and Servers Operating with Different Versions of Time Zone Files</h2>
<p>In Oracle Database 11<span class="italic">g</span>, Release 11.2 (or higher), you can use different versions of time zone file on the client and server; this mode of operation was not supported prior to 11.2. Both client and server must be 11.2 or higher to operate in such a mixed mode. For the ramifications of working in such a mode, see <a class="olink LNOCI16761" href="../../appdev.112/e10646/oci10new.htm#LNOCI16761"><span class="italic">Oracle Call Interface Programmer's Guide</span></a>.</p>
<p>OCI, JDBC, Pro*C, and SQL*Plus clients can now continue to communicate with the database server without having to update client-side time zone files. For other products, if not explicitly stated in the product-specific documentation, it should be assumed that such clients cannot operate with a database server with a different time zone file than the client. Otherwise, computations on the <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> values that are region ID based may give inconsistent results on the client. This is due to different daylight saving time (DST) rules in effect for the time zone regions affected between the different time zone file versions at the client and on the server.</p>
<p>Note if an application connects to different databases directly or via database links, it is recommended that all databases be on the same time zone file version. Otherwise, computations on the <code>TIMESTAMP</code> <code>WITH</code> <code>TIMEZONE</code> values on these different databases may give inconsistent results. This is due to different DST rules in effect for the time zone regions affected between the different time zone file versions across the different database servers.</p>
</div>
<!-- class="sect1" -->
<a id="i1006705"></a><a id="NLSPG262"></a>
<div class="sect1">
<h2 class="sect1">Setting the Database Time Zone</h2>
<p>Set the <a id="sthref398"></a><a id="sthref399"></a>database time zone when the database is created by using the <code>SET TIME_ZONE</code> clause of the <code>CREATE DATABASE</code> statement. If you do not set the database time zone, then it defaults to the time zone of the server's operating system.</p>
<p>The time zone may be set to a named region or an absolute offset from UTC. To set the time zone to a named region, use a statement similar to the following example:</p>
<pre>
CREATE DATABASE db01
...
SET TIME_ZONE='Europe/London';
</pre>
<p>To set the time zone to an offset from UTC, use a statement similar to the following example:</p>
<pre>
CREATE DATABASE db01
...
SET TIME_ZONE='-05:00';
</pre>
<p>The range of valid offsets is -12:00 to +14:00.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The database time zone is relevant only for <code>TIMESTAMP WITH LOCAL TIME ZONE</code> columns. Oracle recommends that you set the database time zone to UTC (0:00) to avoid data conversion and improve performance when data is transferred among databases. This is especially important for distributed databases, replication, and exporting and importing.</div>
<p>You can change the database time zone by using the <code>SET TIME_ZONE</code> clause of the <code>ALTER DATABASE</code> statement. For example:</p>
<pre>
ALTER DATABASE SET TIME_ZONE='Europe/London';
ALTER DATABASE SET TIME_ZONE='-05:00';
</pre>
<p>The <code>ALTER DATABASE SET TIME_ZONE</code> statement returns an error if the database contains a table with a <code>TIMESTAMP WITH LOCAL TIME ZONE</code> column and the column contains data.</p>
<p>The change does not take effect until the database has been shut down and restarted.</p>
<p>You can find out the database time zone by entering the following query:</p>
<pre>
SELECT dbtimezone FROM DUAL;
</pre></div>
<!-- class="sect1" -->
<a id="i1006728"></a><a id="NLSPG263"></a>
<div class="sect1">
<h2 class="sect1">Setting the Session Time Zone</h2>
<p>You can set the default <a id="sthref400"></a><a id="sthref401"></a>session time zone with the <code><a id="sthref402"></a><a id="sthref403"></a>ORA_SDTZ</code> environment variable. When users retrieve <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data, Oracle Database returns it in the users' session time zone. The session time zone also takes effect when a <code>TIMESTAMP</code> value is converted to the <code>TIMESTAMP WITH TIME ZONE</code> or <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Setting the session time zone does not affect the value returned by the <code>SYSDATE<a id="sthref404"></a><a id="sthref405"></a></code> and <code>SYSTIMESTAMP</code> SQL function. <code>SYSDATE</code> returns the date and time of the operating system on which the database resides, taking into account the time zone of the database server's operating system that was in effect when the database was started.</div>
<p>The <code>ORA_SDTZ</code> environment variable can be set to the following values:</p>
<ul>
<li>
<p>Operating system local time zone (<code>'<a id="sthref406"></a>OS_TZ'</code>)</p>
</li>
<li>
<p>Database time zone (<code>'<a id="sthref407"></a>DB_TZ'</code>)</p>
</li>
<li>
<p>Absolute offset from UTC (for example, <code>'-05:00'</code>)</p>
</li>
<li>
<p>Time zone region name (for example, <code>'Europe/London'</code>)</p>
</li>
</ul>
<p>To set <code>ORA_SDTZ</code>, use statements similar to one of the following in a UNIX environment (C shell):</p>
<pre>
% setenv ORA_SDTZ 'OS_TZ'
% setenv ORA_SDTZ 'DB_TZ'
% setenv ORA_SDTZ 'Europe/London'
% setenv ORA_SDTZ '-05:00'
</pre>
<p>You can change the time zone for a specific SQL session with the <code>SET TIME_ZONE</code> clause of the <code>ALTER SESSION</code> statement.</p>
<p><code>TIME_ZONE</code> can be set to the following values:</p>
<ul>
<li>
<p>Default local time zone when the session was started (<code>local</code>)</p>
</li>
<li>
<p>Database time zone (<code>dbtimezone</code>)</p>
</li>
<li>
<p>Absolute offset from UTC (for example, <code>'+10:00'</code>)</p>
</li>
<li>
<p>Time zone region name (for example, <code>'Asia/Hong_Kong'</code>)</p>
</li>
</ul>
<p>Use <code>ALTER SESSION</code> statements similar to the following:</p>
<pre>
ALTER SESSION SET TIME_ZONE=local;
ALTER SESSION SET TIME_ZONE=dbtimezone;
ALTER SESSION SET TIME_ZONE='Asia/Hong_Kong';
ALTER SESSION SET TIME_ZONE='+10:00';
</pre>
<p>You can find out the current session time zone by entering the following query:</p>
<pre>
SELECT sessiontimezone FROM DUAL;
</pre></div>
<!-- class="sect1" -->
<a id="i1007699"></a><a id="NLSPG264"></a>
<div class="sect1">
<h2 class="sect1">Converting Time Zones With the AT TIME ZONE Clause</h2>
<p>A datetime SQL expression can be one of the following:</p>
<ul>
<li>
<p>A datetime column</p>
</li>
<li>
<p>A compound expression that yields a datetime value</p>
</li>
</ul>
<p>A datetime expression can include an <code>AT LOCAL</code> clause or an <code><a id="sthref408"></a>AT TIME ZONE</code> clause. If you include an <code><a id="sthref409"></a>AT LOCAL</code> clause, then the result is returned in the current session time zone. If you include the <code>AT TIME ZONE</code> clause, then use one of the following settings with the clause:</p>
<ul>
<li>
<p>Time zone offset: The string '<code>(+|-)HH:MM'</code> specifies a time zone as an offset from UTC. For example, <code>'-07:00'</code> specifies the time zone that is 7 hours behind UTC. For example, if the UTC time is 11:00 a.m., then the time in the <code>'-07:00'</code> time zone is 4:00 a.m.</p>
</li>
<li>
<p><code>DBTIMEZONE</code>: Oracle Database uses the database time zone established (explicitly or by default) during database creation.</p>
</li>
<li>
<p><code>SESSIONTIMEZONE</code>: Oracle Database uses the session time zone established by default or in the most recent <code>ALTER SESSION</code> statement.</p>
</li>
<li>
<p>Time zone region name: Oracle Database returns the value in the time zone indicated by the time zone region name. For example, you can specify <code>Asia/Hong_Kong</code>.</p>
</li>
<li>
<p>An expression: If an expression returns a character string with a valid time zone format, then Oracle Database returns the input in that time zone. Otherwise, Oracle Database returns an error.</p>
</li>
</ul>
<p>The following example converts the <a id="sthref410"></a><a id="sthref411"></a>datetime value in the <code>America/New_York</code> time zone to the datetime value in the <code>America/Los_Angeles</code> time zone.</p>
<div class="example">
<p class="titleinexample"><a id="NLSPG764"></a><a id="sthref412"></a>Example 4-5 Converting a Datetime Value to Another Time Zone</p>
<pre>
SELECT FROM_TZ(CAST(TO_DATE('1999-12-01 11:00:00',
     'YYYY-MM-DD HH:MI:SS') AS TIMESTAMP), 'America/New_York')
     AT TIME ZONE 'America/Los_Angeles' "West Coast Time"
FROM DUAL;

West Coast Time
----------------------------------------------------------
01-DEC-99 08.00.00.000000 AM AMERICA/LOS_ANGELES
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF00644" href="../../server.112/e41084/functions068.htm#SQLRF00644"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect1" -->
<a id="i1006760"></a><a id="NLSPG265"></a>
<div class="sect1">
<h2 class="sect1">Support for Daylight Saving Time</h2>
<p>Oracle Database automatically determines whether <a id="sthref413"></a>Daylight Saving Time is in effect for a specified time zone and returns the corresponding local time. Normally, date/time values are sufficient to allow Oracle Database to determine whether Daylight Saving Time is in effect for a specified time zone. The periods when Daylight Saving Time begins or ends are boundary cases. For example, in the Eastern region of the United States, the time changes from 01:59:59 a.m. to 3:00:00 a.m. when Daylight Saving Time goes into effect. The interval between 02:00:00 and 02:59:59 a.m. does not exist. Values in that interval are invalid. When Daylight Saving Time ends, the time changes from 02:00:00 a.m. to 01:00:01 a.m. The interval between 01:00:01 and 02:00:00 a.m. is repeated. Values from that interval are ambiguous because they occur twice.</p>
<p>To resolve these boundary cases, Oracle Database uses the <code>TZR</code> and <code>TZD</code> format elements. <code>TZR</code> represents the time zone region in datetime input strings. Examples are '<code>Australia/North</code>', '<code>UTC</code>', and '<code>Singapore</code>'. <code>TZD</code> represents an abbreviated form of the time zone region with Daylight Saving Time information. Examples are '<code>PST</code>' for U. S. Pacific Standard Time and '<code>PDT</code>' for U. S. Pacific Daylight Time. To see a list of valid values for the <code>TZR</code> and <code>TZD</code> format elements, query the <code>TZNAME</code> and <code>TZABBREV</code> columns of the <code>V$TIMEZONE_NAMES</code> dynamic performance view.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information regarding the session parameter <code>ERROR_ON_OVERLAP_TIME</code></p>
</li>
<li>
<p><a href="applocaledata.htm#i637736">"Time Zone Region Names"</a> for a list of valid time zones</p>
</li>
</ul>
</div>
<a id="i1006783"></a><a id="NLSPG266"></a>
<div class="sect2">
<h3 class="sect2">Examples: The Effect of Daylight Saving Time on Datetime Calculations</h3>
<p>The <code>TIMESTAMP</code> data type does not accept time zone values and does not calculate Daylight Saving Time.</p>
<p>The <code>TIMESTAMP WITH TIME ZONE</code> and <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data types have the following behavior:</p>
<ul>
<li>
<p>If a time zone region is associated with the datetime value, then the database server knows the Daylight Saving Time rules for the region and uses the rules in calculations.</p>
</li>
<li>
<p>Daylight Saving Time is not calculated for regions that do not use Daylight Saving Time.</p>
</li>
</ul>
<p>The rest of this section contains examples that use datetime data types. The examples use the <code>global_orders</code> table. It contains the <code>orderdate1</code> column of <code>TIMESTAMP</code> data type and the <code>orderdate2</code> column of <code>TIMESTAMP WITH TIME ZONE</code> data type. The <code>global_orders</code> table is created as follows:</p>
<pre>
CREATE TABLE global_orders ( orderdate1 TIMESTAMP(0),
                      orderdate2 TIMESTAMP(0) WITH TIME ZONE);
INSERT INTO global_orders VALUES ( '28-OCT-00 11:24:54 PM',
                            '28-OCT-00 11:24:54 PM America/New_York');
</pre>
<div class="example">
<p class="titleinexample"><a id="i1006793"></a><a id="NLSPG765"></a>Example 4-6 Comparing Daylight Saving Time Calculations Using TIMESTAMP WITH TIME ZONE and TIMESTAMP</p>
<pre>
SELECT orderdate1 + INTERVAL '8' HOUR, orderdate2 + INTERVAL '8' HOUR 
       FROM global_orders;
</pre>
<p>The following output results:</p>
<pre>
ORDERDATE1+INTERVAL'8'HOUR      ORDERDATE2+INTERVAL'8'HOUR
--------------------------      --------------------------
29-OCT-00 07.24.54.000000 AM    29-OCT-00 06.24.54.000000 AM AMERICA/NEW_YORK
</pre>
<p>This example shows the effect of adding 8 hours to the columns. The time period includes a Daylight Saving Time boundary (a change from Daylight Saving Time to standard time). The <code>orderdate1</code> column is of <code>TIMESTAMP</code> data type, which does not use Daylight Saving Time information and thus does not adjust for the change that took place in the 8-hour interval. The <code>TIMESTAMP WITH TIME ZONE</code> data type does adjust for the change, so the <code>orderdate2</code> column shows the time as one hour earlier than the time shown in the <code>orderdate1</code> column.</p>
</div>
<!-- class="example" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
If you have created a <code>global_orders</code> table for the previous examples, then drop the <code>global_orders</code> table before you try <a href="#i1006829">Example 4-7</a> through <a href="#i1006863">Example 4-8</a>.</div>
<div class="example">
<p class="titleinexample"><a id="i1006829"></a><a id="NLSPG766"></a>Example 4-7 Comparing Daylight Saving Time Calculations Using TIMESTAMP WITH LOCAL TIME ZONE and TIMESTAMP</p>
<p>The <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type uses the value of <code>TIME_ZONE</code> that is set for the session environment. The following statements set the value of the <code>TIME_ZONE</code> session parameter and create a <code>global_orders</code> table. The <code>global_orders</code> table has one column of <code>TIMESTAMP</code> data type and one column of <code>TIMESTAMP WITH LOCAL TIME ZONE</code> data type.</p>
<pre>
ALTER SESSION SET TIME_ZONE='America/New_York';
CREATE TABLE global_orders ( orderdate1 TIMESTAMP(0),
                             orderdate2 TIMESTAMP(0) WITH LOCAL TIME ZONE );
INSERT INTO global_orders VALUES ( '28-OCT-00 11:24:54 PM',
                                   '28-OCT-00 11:24:54 PM' );
</pre>
<p>Add 8 hours to both columns.</p>
<pre>
SELECT orderdate1 + INTERVAL '8' HOUR, orderdate2 + INTERVAL '8' HOUR 
FROM global_orders;
</pre>
<p>Because a time zone region is associated with the datetime value for <code>orderdate2</code>, the Oracle Database server uses the Daylight Saving Time rules for the region. Thus the output is the same as in <a href="#i1006793">Example 4-6</a>. There is a one-hour difference between the two calculations because Daylight Saving Time is not calculated for the <code>TIMESTAMP</code> data type, and the calculation crosses a Daylight Saving Time boundary.</p>
</div>
<!-- class="example" -->
<div class="example">
<p class="titleinexample"><a id="i1006863"></a><a id="NLSPG767"></a>Example 4-8 Daylight Saving Time Is Not Calculated for Regions That Do Not Use Daylight Saving Time</p>
<p>Set the time zone region to UTC. UTC does not use Daylight Saving Time.</p>
<pre>
ALTER SESSION SET TIME_ZONE='UTC';
</pre>
<p>Truncate the <code>global_orders</code> table.</p>
<pre>
TRUNCATE TABLE global_orders;
</pre>
<p>Insert values into the <code>global_orders</code> table.</p>
<pre>
INSERT INTO global_orders VALUES ( '28-OCT-00 11:24:54 PM',
                                 TIMESTAMP '2000-10-28 23:24:54 ' );
</pre>
<p>Add 8 hours to the columns.</p>
<pre>
SELECT orderdate1 + INTERVAL '8' HOUR, orderdate2 + INTERVAL '8' HOUR 
FROM global_orders;
</pre>
<p>The following output results.</p>
<pre>
ORDERDATE1+INTERVAL'8'HOUR                 ORDERDATE2+INTERVAL'8'HOUR
--------------------------                 ---------------------------
29-OCT-00 07.24.54.000000000 AM            29-OCT-00 07.24.54.000000000 AM UTC
</pre>
<p>The times are the same because Daylight Saving Time is not calculated for the UTC time zone region.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1904">
<tr>
<td class="cellalignment1911">
<table class="cellalignment1909">
<tr>
<td class="cellalignment1908"><a href="ch3globenv.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1908"><a href="ch5lingsort.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1996, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1913">
<table class="cellalignment1907">
<tr>
<td class="cellalignment1908"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1908"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1908"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1908"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1908"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1908"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
