<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Tuning SQL Statements</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 040" />
<meta name="dcterms.created" content="2011-11-21T13:27:44Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + Performance Tuning Guide" />
<meta name="dcterms.identifier" content="E10822-04" />
<meta name="dcterms.isVersionOf" content="TDPPT" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="tdppt_sqlid.htm" title="Previous" type="text/html" />
<link rel="Next" href="tdppt_sqlopt.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e10822.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">19/21</span> <!-- End Header --><a id="CAEBFCFJ"></a><a id="TDPPT160"></a>
<h1 class="chapter"><span class="secnum">10</span> Tuning SQL Statements</h1>
<p>A SQL statement expresses the data you want Oracle Database to retrieve. For example, a SQL statement can retrieve the names of employees in a department. When Oracle Database executes the SQL statement, the <span class="bold">query optimizer</span> (also called the <span class="bold">optimizer</span>) first determines the best and most efficient way to retrieve the results.</p>
<p>The optimizer determines whether it is more efficient to read all data in the table, called a full table scan, or use an index. It compares the cost of all possible approaches and chooses the approach with the least cost. The access method for physically executing a SQL statement is called an execution plan<a id="sthref373"></a>, which the optimizer is responsible for generating. The determination of an execution plan is an important step in the processing of any SQL statement, and can greatly affect execution time.</p>
<p>The query optimizer can also help you tune SQL statements. By using SQL Tuning Advisor<a id="sthref374"></a> and SQL Access Advisor<a id="sthref375"></a>, you can run the query optimizer in advisory mode to examine a SQL statement or set of statements and determine how to improve their efficiency. SQL Tuning Advisor and SQL Access Advisor can make various recommendations, such as creating SQL profiles, restructuring SQL statements, creating additional indexes or materialized views, and refreshing optimizer statistics. Additionally, Oracle Enterprise Manager (Enterprise Manager) enables you to accept and implement many of these recommendations easily.</p>
<p>SQL Access Advisor is primarily responsible for making schema modification recommendations, such as adding or dropping indexes and materialized views. SQL Tuning Advisor makes other types of recommendations, such as creating SQL profiles and restructuring SQL statements. If significant performance improvements can be gained by creating a new index, then SQL Tuning Advisor may recommend it. However, such recommendations should be verified by running SQL Access Advisor using a SQL workload that contains a set of representative SQL statements.</p>
<p>This chapter describes how to tune SQL statements using SQL Tuning Advisor and contains the following sections:</p>
<ul>
<li>
<p><a href="#CACHECBD">Tuning SQL Statements Using SQL Tuning Advisor</a></p>
</li>
<li>
<p><a href="#CBBGEAJI">Managing SQL Tuning Sets</a></p>
</li>
<li>
<p><a href="#CHDDAGBE">Managing SQL Profiles</a></p>
</li>
<li>
<p><a href="#CACCFCIG">Managing SQL Execution Plans</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdppt_sqlid.htm#BABFHBFJ">Chapter 9, "Identifying High-Load SQL Statements"</a></p>
</li>
<li>
<p><a href="tdppt_sqlopt.htm#BABGHCAE">Chapter 11, "Optimizing Data Access Paths"</a> for information about SQL Access Advisor</p>
</li>
</ul>
</div>
<a id="CACHECBD"></a><a id="TDPPT161"></a>
<div class="sect1">
<h2 class="sect1">Tuning SQL Statements Using SQL Tuning Advisor</h2>
<p>You can use SQL Tuning Advisor to tune one or more SQL statements. When tuning multiple statements, SQL Tuning Advisor does not recognize interdependencies between the SQL statements. Instead, SQL Tuning Advisor provides a convenient way to obtain tuning advice for a large number of SQL statements.</p>
<p>Oracle Database can generate SQL tuning reports automatically. Automatic SQL Tuning runs during system <span class="bold">maintenance windows</span> as an automated maintenance task, searching for ways to improve the execution plans of high-load SQL statements. A maintenance window is a contiguous time interval during which automated maintenance tasks are run.</p>
<a id="CACFDJHE"></a><a id="TDPPT310"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Tuning SQL Manually Using SQL Tuning Advisor</h3>
<p>As described in <a href="tdppt_sqlid.htm#BABFHBFJ">Chapter 9, "Identifying High-Load SQL Statements"</a>, Automatic Database Diagnostic Monitor (ADDM) automatically identifies high-load SQL statements. If ADDM identifies such statements, then click <span class="bold">Schedule/Run SQL Tuning Advisor</span> on the Recommendation Detail page to run SQL Tuning Advisor.</p>
<p class="orderedlisttitle">To tune SQL statements manually using SQL Tuning Advisor<a id="sthref377"></a><a id="sthref378"></a>:&nbsp;</p>
<ol>
<li>
<p>On the Database Home page, under Related Links, click <span class="bold">Advisor Central</span>.</p>
<p>The Advisor Central page appears.</p>
</li>
<li>
<p>Under Advisors, click <span class="bold">SQL Advisors</span>.</p>
<p>The SQL Advisors page appears.</p>
</li>
<li>
<p>Under SQL Tuning Advisor, click <span class="bold">SQL Tuning Advisor</span>.</p>
<p>The Schedule SQL Tuning Advisor page appears.</p>
<img width="759" height="402" src="img/sql_tuning_advisor_empty.gif" alt="Description of sql_tuning_advisor_empty.gif follows" /><br />
<a id="sthref379" href="img_text/sql_tuning_advisor_empty.htm">Description of the illustration sql_tuning_advisor_empty.gif</a><br />
<br /></li>
<li>
<p>In the <span class="bold">Name</span> field, enter a name for the SQL tuning task.</p>
<p>If unspecified, then SQL Tuning Advisor uses a system-generated name.</p>
</li>
<li>
<p>Do one of the following:</p>
<ul>
<li>
<p>To run a SQL tuning task for one or more high-load SQL statements, under SQL Tuning Advisor Data Source Links, click <span class="bold">Top Activity</span>.</p>
<p>The Top Activity page appears.</p>
<p>Under Top SQL, select the SQL statement you want to tune and click <span class="bold">Schedule SQL Tuning Advisor</span>. See <a href="tdppt_sqlid.htm#BABECDJG">"Identifying High-Load SQL Statements Using Top SQL"</a> to learn how to identify high-load SQL statements using the Top Activity page.</p>
</li>
<li>
<p>To run a SQL tuning task for historical SQL statements from the Automatic Workload Repository (AWR), under SQL Tuning Advisor Data Source Links, click <span class="bold">Historical SQL (AWR)</span>.</p>
<p>The Historical SQL (AWR) page appears.</p>
<p>Under Historical SQL (AWR), click the band below the chart, and select the 24-hour interval for which you want to view SQL statements that ran on the database. Under Detail for Selected 24 Hour Interval, select the SQL statement you want to tune, and click <span class="bold">Schedule SQL Tuning Advisor</span>.</p>
</li>
<li>
<p>To run a SQL tuning task for a SQL tuning set, click <span class="bold">SQL Tuning Sets</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>Select the SQL tuning set that contains the SQL statements you want to tune and then click <span class="bold">Schedule SQL Tuning Advisor</span>. See <a href="#CHDFABIG">"Creating a SQL Tuning Set"</a> to learn how to create SQL tuning sets.</p>
</li>
</ul>
<p>The Schedule SQL Tuning Advisor page reappears.</p>
</li>
<li>
<p>To display the SQL text of the selected statement, expand <span class="bold">SQL Statements</span>.</p>
<img width="460" height="95" src="img/sql_tuning_sql_statements.gif" alt="Description of sql_tuning_sql_statements.gif follows" /><br />
<a id="sthref380" href="img_text/sql_tuning_sql_statements.htm">Description of the illustration sql_tuning_sql_statements.gif</a><br />
<br /></li>
<li>
<p>Under Scope, select the scope of tuning to perform. Do one of the following:</p>
<ul>
<li>
<p>Select <span class="bold">Limited</span>.</p>
<p>A limited scope<a id="sthref381"></a> takes approximately 1 second to tune each SQL statement but does not recommend a SQL profile.</p>
</li>
<li>
<p>Select <span class="bold">Comprehensive</span>, and then set a time limit (in minutes) for each SQL statement in the <span class="bold">Time Limit per Statement</span> field, and a total time limit (in minutes) in the <span class="bold">Total Time Limit</span> field. Note that setting the time limit too small may affect the quality of the recommendations.</p>
<p>Comprehensive mode may take several minutes to tune a single SQL statement. This mode is both time and resource intensive because each query must be hard-parsed. Thus, you should only use comprehensive scope for high-load SQL statements that have a significant impact on the entire system.</p>
</li>
</ul>
<p>See <a href="#CHDDAGBE">"Managing SQL Profiles"</a> to learn more about SQL profiles.</p>
</li>
<li>
<p>Under Schedule, do one of the following:</p>
<ul>
<li>
<p>Select <span class="bold">Immediately</span> and then click <span class="bold">Submit</span> to run the SQL tuning task immediately.</p>
<p>The Processing: SQL Tuning Advisor Task page appears.</p>
</li>
<li>
<p>Select <span class="bold">Later</span> to schedule a specific time in the future, and then click <span class="bold">OK</span>.</p>
</li>
</ul>
</li>
<li>
<p>On the Database Home page, under Related Links, click <span class="bold">Advisor Central</span>.</p>
<p>The Advisor Central page appears.</p>
<p>Under Advisor Tasks, the Results sections lists the result of advisors.</p>
<img width="683" height="150" src="img/sta_advisor_results.gif" alt="Description of sta_advisor_results.gif follows" /><br />
<a id="sthref382" href="img_text/sta_advisor_results.htm">Description of the illustration sta_advisor_results.gif</a><br />
<br /></li>
<li>
<p>Select a result from the table and then click <span class="bold">View Result</span>.</p>
<p>The Recommendations for SQL ID page appears.</p>
<img width="728" height="229" src="img/rec_for_sql_id.gif" alt="Description of rec_for_sql_id.gif follows" /><br />
<a id="sthref383" href="img_text/rec_for_sql_id.htm">Description of the illustration rec_for_sql_id.gif</a><br />
<br />
<p>If you used a SQL tuning set, then multiple recommendations may be shown. To help you decide whether to implement a recommendation, an estimated benefit of implementing the recommendation is displayed in the Benefit (%) column. The Rationale column displays an explanation of why the recommendation is made.</p>
</li>
<li>
<p>To implement the recommendation, do one of the following:<a id="sthref384"></a></p>
<ul>
<li>
<p>If an automated solution is recommended, then click <span class="bold">Implement</span>.</p>
<p><a id="sthref385"></a>A confirmation page appears. Click <span class="bold">Yes</span> to confirm the change.</p>
</li>
<li>
<p>If a manual solution is recommended, then consider implementing the recommendation.</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CACHCGFG"></a><a id="TDPPT311"></a>
<div class="sect2">
<h3 class="sect2">Viewing Automatic SQL Tuning Results</h3>
<p><a id="sthref386"></a><a id="sthref387"></a>By analyzing data in the Automatic Workload Repository (AWR), the database can identify routine maintenance tasks. The automated maintenance tasks infrastructure (known as <span class="bold">AutoTask</span>) schedules these tasks to run in maintenance windows.</p>
<p>Maintenance windows are Oracle Scheduler time intervals that belong to the window group named <code>MAINTENANCE_WINDOW_GROUP</code>. By default, one window is scheduled for each day of the week. You can customize attributes of these maintenance windows, including start and end times, frequency, and days of the week.</p>
<p>By default, AutoTask runs the following automated maintenance tasks in all maintenance windows:</p>
<ul>
<li>
<p>Optimizer Statistics Collection</p>
</li>
<li>
<p>Segment Advisor</p>
</li>
<li>
<p>SQL Tuning Advisor</p>
</li>
</ul>
<p>You can view the results of automated execution of SQL Tuning Advisor on observed high-load SQL statements.</p>
<p class="orderedlisttitle">To view automatic SQL tuning results<a id="sthref389"></a><a id="sthref390"></a>:&nbsp;</p>
<ol>
<li>
<p>On the Database Home page, under Related Links, click <span class="bold">Advisor Central</span>.</p>
<p>The Advisor Central page appears.</p>
</li>
<li>
<p>Under Advisors, click <span class="bold">SQL Advisors</span>.</p>
<p>The SQL Advisors page appears.</p>
</li>
<li>
<p>Under SQL Tuning Advisor, click <span class="bold">Automatic SQL Tuning Results</span>.</p>
<p>The Automatic SQL Tuning Result Summary page appears.</p>
<p>The top half of the page includes sections for the status and activity summary of the SQL Tuning task.</p>
<img width="681" height="266" src="img/sql_tuning_auto_result.gif" alt="Description of sql_tuning_auto_result.gif follows" /><br />
<a id="sthref391" href="img_text/sql_tuning_auto_result.htm">Description of the illustration sql_tuning_auto_result.gif</a><br />
<br /></li>
<li>
<p>In the Time Period list, select <span class="bold">All</span> and then click <span class="bold">Go</span>.</p>
<p>The Overall Task Statistics and Profile Effect Statistics sections are refreshed.</p>
<img width="797" height="575" src="img/sql_tuning_auto_stats.gif" alt="Description of sql_tuning_auto_stats.gif follows" /><br />
<a id="sthref392" href="img_text/sql_tuning_auto_stats.htm">Description of the illustration sql_tuning_auto_stats.gif</a><br />
<br /></li>
<li>
<p>Optionally, in the Task Status section, click <span class="bold">Configure</span> to change the attributes of the Automatic SQL Tuning task.</p>
<p>The Automated Maintenance Tasks Configuration page appears.</p>
<p>In this page, you can enable or disable the <a id="sthref393"></a>Automatic SQL Tuning task and specify which days it should run. Click <span class="bold">Apply</span> or <span class="bold">Revert</span> to return to the previous page.</p>
</li>
<li>
<p>In the Task Activity Summary section, leave <span class="bold">All</span> selected for the <span class="bold">Time Period</span> and then click <span class="bold">View Report</span>.</p>
<p>The Automatic SQL Tuning Result Details page appears.</p>
<p>The page lists SQL statements that have been automatically selected by the database as candidates for SQL tuning.</p>
<img width="1215" height="453" src="img/sql_tuning_result_details.gif" alt="Description of sql_tuning_result_details.gif follows" /><br />
<a id="sthref394" href="img_text/sql_tuning_result_details.htm">Description of the illustration sql_tuning_result_details.gif</a><br />
<br /></li>
<li>
<p><a id="sthref395"></a>Under Recommendations, select a SQL statement and then click <span class="bold">View Recommendations</span>.</p>
<p>The Recommendations for SQL ID page appears.</p>
<img width="747" height="497" src="img/sql_tuning_recommend.gif" alt="Description of sql_tuning_recommend.gif follows" /><br />
<a id="sthref396" href="img_text/sql_tuning_recommend.htm">Description of the illustration sql_tuning_recommend.gif</a><br />
<br />
<p>This page can include recommendations for SQL profiles and indexes. See <a href="#CACFDJHE">"Tuning SQL Manually Using SQL Tuning Advisor"</a> to learn how to implement recommendations made by SQL Tuning Advisor.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CBBGEAJI"></a><a id="TDPPT164"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing SQL Tuning Sets</h2>
<p>A <span class="bold">SQL tuning set</span><a id="sthref397"></a> is a database object that includes one or more SQL statements and their execution statistics and context. You can use the set as an input for advisors such as SQL Tuning Advisor, SQL Access Advisor, and SQL Performance Analyzer. You can load SQL statements into a SQL tuning set from different SQL sources, such as AWR, the cursor cache, or high-load SQL statements that you identify.</p>
<p>A SQL tuning set includes the following:</p>
<ul>
<li>
<p>A set of SQL statements</p>
</li>
<li>
<p>Associated execution context such as:</p>
<ul>
<li>
<p>User schema</p>
</li>
<li>
<p>Application module name and action</p>
</li>
<li>
<p>List of bind values</p>
</li>
<li>
<p>Cursor compilation environment</p>
</li>
</ul>
</li>
<li>
<p>Associated basic execution statistics such as:</p>
<ul>
<li>
<p>Elapsed time and CPU time</p>
</li>
<li>
<p>Buffer gets</p>
</li>
<li>
<p>Disk reads</p>
</li>
<li>
<p>Rows processed</p>
</li>
<li>
<p>Cursor fetches</p>
</li>
<li>
<p>Number of executions and number of complete executions</p>
</li>
<li>
<p>Optimizer cost</p>
</li>
<li>
<p>Command type</p>
</li>
</ul>
</li>
<li>
<p>Associated execution plans and row source statistics for each SQL statement (optional)</p>
</li>
</ul>
<p>SQL statements can be filtered using the application module name and action, or any of the execution statistics. In addition, SQL statements can be ranked based on any combination of execution statistics.</p>
<p>SQL tuning sets are transportable, enabling SQL workloads to be transferred between databases for remote performance diagnostics and tuning. When high-load SQL statements are identified on a production system, it may not be desirable to perform investigation and tuning activities directly on this system. This feature enables you to transport the high-load SQL statements to a test system, where they can be safely analyzed and tuned. For information about transporting SQL tuning sets, see <a class="olink PFGRF94868" href="../../server.112/e41573/sql_tune.htm#PFGRF94868"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
<p>Using Enterprise Manager, you can manage SQL tuning sets by doing the following:</p>
<ul>
<li>
<p><a href="#CHDFABIG">Creating a SQL Tuning Set</a></p>
</li>
<li>
<p><a href="#CBBFDADC">Dropping a SQL Tuning Set</a></p>
</li>
<li>
<p><a href="#CBBFCEAA">Transporting SQL Tuning Sets</a></p>
</li>
</ul>
<a id="CHDFABIG"></a><a id="TDPPT162"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating a SQL Tuning Set</h3>
<p>This section describes how to create a SQL tuning set with Enterprise Manager.</p>
<p class="orderedlisttitle">To create a SQL tuning set<a id="sthref399"></a>:&nbsp;</p>
<ol>
<li>
<p>Specify the initial options for the SQL tuning set, as described in <a href="#CBBIFBHD">"Creating a SQL Tuning Set: Options"</a>.</p>
</li>
<li>
<p>Select the load method to use for collecting and loading SQL statements into the SQL tuning set, as described in <a href="#CBBFGJFI">"Creating a SQL Tuning Set: Load Method"</a>.</p>
</li>
<li>
<p>Specify the filter options for the SQL tuning set, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
<li>
<p>Schedule and submit a job to collect the SQL statements and load them into the SQL tuning set, as described in <a href="#CBBDAJGE">"Creating a SQL Tuning Set: Schedule"</a>.</p>
</li>
</ol>
<a id="CBBIFBHD"></a><a id="TDPPT165"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating a SQL Tuning Set: Options</h4>
<p>The first step in creating a SQL tuning set is to specify options for the set such as name, owner, and description.</p>
<p class="orderedlisttitle">To specify options for creating a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Database Performance page, under Additional Monitoring Links, click <span class="bold">SQL Tuning Sets</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>The Create SQL Tuning Set: Options page appears.</p>
</li>
<li>
<p>Enter the following details:</p>
<ul>
<li>
<p>In <span class="bold">SQL Tuning Set Name</span>, enter a name for the SQL tuning set.</p>
</li>
<li>
<p>In <span class="bold">Owner</span>, enter the owner of the SQL tuning set.</p>
</li>
<li>
<p>In <span class="bold">Description</span>, enter a description of the SQL tuning set.</p>
</li>
</ul>
</li>
<li>
<p>Optionally, to create an empty SQL tuning set and add SQL statements to it at a later time, complete the following steps:</p>
<ol>
<li>
<p>Select <span class="bold">Create an empty SQL tuning set</span>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Review page appears.</p>
</li>
<li>
<p>Review your SQL tuning set options and click <span class="bold">Submit</span>.</p>
<p>The empty SQL tuning set is created. You can add SQL statements to it later.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Load Methods page appears.</p>
<img width="731" height="237" src="img/sts_load_methods.gif" alt="Description of sts_load_methods.gif follows" /><br />
<a id="sthref401" href="img_text/sts_load_methods.htm">Description of the illustration sts_load_methods.gif</a><br />
<br /></li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBFGJFI">"Creating a SQL Tuning Set: Load Method"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CBBFGJFI"></a><a id="TDPPT166"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating a SQL Tuning Set: Load Method</h4>
<p>After options are specified for the SQL tuning set, select the load method<a id="sthref402"></a> to use for collecting and loading SQL statements into the SQL tuning set, as described in the following sections:</p>
<ul>
<li>
<p><a href="#CBBGBBGC">Loading Active SQL Statements Incrementally from the Cursor Cache</a></p>
</li>
<li>
<p><a href="#CBBJCJFB">Loading SQL Statements from the Cursor Cache</a></p>
</li>
<li>
<p><a href="#CBBGICCD">Loading SQL Statements from AWR Snapshots</a></p>
</li>
<li>
<p><a href="#CBBCEIDD">Loading SQL Statements from AWR Baselines</a></p>
</li>
<li>
<p><a href="#CBBEJBGD">Loading SQL Statements from a User-Defined Workload</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Before selecting the load method for the SQL tuning set, create a SQL tuning set and specify the initial options, as described in <a href="#CBBIFBHD">"Creating a SQL Tuning Set: Options"</a></div>
<a id="CBBGBBGC"></a><a id="TDPPT167"></a>
<div class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Loading Active SQL Statements Incrementally from the Cursor Cache</h5>
<p>You can load active SQL statements from the cursor cache into the SQL tuning set incrementally over a specified period of time. This technique enables you to not only collect current and recent SQL statements stored in the SQL cache, but also SQL statements that will run during a specified time period in the future.</p>
<p class="orderedlisttitle">To load active SQL statements incrementally from the cursor cache:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Load Methods page, select <span class="bold">Incrementally capture active SQL statements over a period of time from the cursor cache</span>.</p>
</li>
<li>
<p>In the <span class="bold">Duration</span> field, specify how long active SQL statements will be captured.</p>
</li>
<li>
<p>In the <span class="bold">Frequency</span> field, specify how often active SQL statements will be captured during the specified duration.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Filter Options page appears.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CBBJCJFB"></a><a id="TDPPT168"></a>
<div class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Loading SQL Statements from the Cursor Cache</h5>
<p>You can load SQL statements from the cursor cache into the SQL tuning set. However, because only current and recent SQL statements are in the SQL cache, collecting these statements only once may result in a SQL tuning set this is not representative of the entire database workload.</p>
<p class="orderedlisttitle">To load SQL statements from the cursor cache:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Load Methods page, select <span class="bold">Load SQL statements one time only</span>.</p>
</li>
<li>
<p>From the Data Source list, select <span class="bold">Cursor Cache</span>.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Filter Options page is shown.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CBBGICCD"></a><a id="TDPPT169"></a>
<div class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Loading SQL Statements from AWR Snapshots</h5>
<p>You can load SQL statements captured in AWR snapshots. This is useful when you want to collect SQL statements for specific snapshot periods of interest that can be used for later comparison or tuning purposes.</p>
<p class="orderedlisttitle">To load SQL statements from AWR snapshots:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Load Methods page, select <span class="bold">Load statements one time only</span>.</p>
</li>
<li>
<p>In the <span class="bold">Data Source</span> list, select <span class="bold">AWR Snapshots</span>.</p>
</li>
<li>
<p>In the <span class="bold">AWR Snapshots</span> field, select the snapshots to include. Do one of the following:</p>
<ul>
<li>
<p>Select either <span class="bold">ALL</span> or a time period such as <span class="bold">Last 24 hours</span> and then go to Step <a href="#CACCEBEE">5</a>.</p>
<p>Only snapshots that are captured and stored in AWR in the specified time will be included.</p>
</li>
<li>
<p>Select <span class="bold">Customize</span> and then go to Step <a href="#CACGCDCJ">4</a>.</p>
<p>Only snapshots that are captured and stored in AWR during a customized time period that you specify will be included.</p>
</li>
</ul>
</li>
<li>
<p><a id="CACGCDCJ"></a>To select a customized time period of snapshots, complete the following steps:</p>
<ol>
<li>
<p>Select <span class="bold">Customize</span> and then click <span class="bold">Go</span>.</p>
<p>The Select Time Period window opens.</p>
</li>
<li>
<p>For the starting snapshot, select <span class="bold">Period Start Time</span> and then click the snapshot icon below the Active Session graph that corresponds to the desired start time.</p>
</li>
<li>
<p>For the ending snapshot, select <span class="bold">Period End Time</span> and then click the snapshot icon below the Active Session graph that corresponds to the desired end time.</p>
</li>
<li>
<p>Click <span class="bold">Select</span>.</p>
</li>
</ol>
<p>In this example, the snapshot taken on February 17, 2009 at 12:10 p.m. is selected as the start time, and the snapshot taken on February 17, 2009 at 1:30 p.m. is selected as the end time.</p>
<img width="876" height="259" src="img/sts_load_time_period.gif" alt="Description of sts_load_time_period.gif follows" /><br />
<a id="sthref406" href="img_text/sts_load_time_period.htm">Description of the illustration sts_load_time_period.gif</a><br />
<br /></li>
<li>
<p><a id="CACCEBEE"></a>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Filter Options page is shown.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CBBCEIDD"></a><a id="TDPPT155"></a>
<div class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Loading SQL Statements from AWR Baselines</h5>
<p>You can load SQL statements captured in AWR baselines. This technique is useful when you want to collect SQL statements that are representative of a time period during known performance levels that can be used for later comparison or tuning purposes.</p>
<p class="orderedlisttitle">To load SQL statements from AWR baselines:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Load Methods page, select <span class="bold">Load SQL statements one time only</span>.</p>
</li>
<li>
<p>In the <span class="bold">Data Source</span> field, select <span class="bold">AWR Baseline</span>.</p>
</li>
<li>
<p>In the <span class="bold">AWR Baseline</span> field, select the baseline to include.</p>
<img width="387" height="84" src="img/sts_load_baseline.gif" alt="Description of sts_load_baseline.gif follows" /><br />
<a id="sthref408" href="img_text/sts_load_baseline.htm">Description of the illustration sts_load_baseline.gif</a><br />
<br /></li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Filter Options page is shown.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect4" -->
<a id="CBBEJBGD"></a><a id="TDPPT156"></a>
<div class="sect4"><!-- infolevel="all" infotype="General" -->
<h5 class="sect4">Loading SQL Statements from a User-Defined Workload</h5>
<p>You can load SQL statements by importing from a table or view. This technique is useful if the workload you want to analyze is not currently running on the database or captured in an existing AWR snapshot or AWR baseline.</p>
<p>There are no restrictions on which schema the workload resides in, the name of the table, or the number of tables that you can define. The only requirement is that the format of the table must match format of the <code>USER_WORKLOAD</code> table.</p>
<p class="orderedlisttitle">To load SQL statements from a user-defined workload:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Load Methods page, select <span class="bold">Load statements one time only</span>.</p>
</li>
<li>
<p>In the <span class="bold">Data Source</span> field, select <span class="bold">User-Defined Workload</span>.</p>
</li>
<li>
<p>In the <span class="bold">User-Defined Workload</span> field, select the table or view to include.</p>
<img width="537" height="84" src="img/sts_load_workload.gif" alt="Description of sts_load_workload.gif follows" /><br />
<a id="sthref410" href="img_text/sts_load_workload.htm">Description of the illustration sts_load_workload.gif</a><br />
<br /></li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Filter Options page is shown.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="CBBDDHFG"></a><a id="TDPPT157"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating a SQL Tuning Set: Filter Options</h4>
<p>After the load method is selected, you can apply filters to reduce the scope of the SQL statements found in the SQL tuning set. While using filters is optional, it can be very beneficial due to the following:</p>
<ul>
<li>
<p>Using filters directs the various advisors that use the SQL tuning set as a workload source, such as SQL Tuning Advisor, SQL Access Advisor, and SQL Performance Analyzer, to make recommendations based on a specific subset of SQL statements, which may lead to better recommendations.</p>
</li>
<li>
<p>Using filters removes extraneous SQL statements from the SQL tuning set, which may greatly reduce processing time when it is used as a workload source for the various advisors.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Before you can specify the filter options for the SQL tuning set, do the following:
<ul>
<li>
<p>Create a SQL tuning set and specify the initial options, as described in <a href="#CBBIFBHD">"Creating a SQL Tuning Set: Options"</a></p>
</li>
<li>
<p>Select the load method, as described in <a href="#CBBFGJFI">"Creating a SQL Tuning Set: Load Method"</a></p>
</li>
</ul>
</div>
<p class="orderedlisttitle">To specify filter options for a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Filter Options page, specify the values of filter conditions that you want use in the search in the <span class="bold">Value</span> column, and an operator or a condition in the <span class="bold">Operator</span> column.</p>
<p>Only the SQL statements that meet all of the specified filter conditions will be added to the SQL tuning set. Unspecified filter values will not be included as filter conditions in the search.</p>
<p>By default, the following filter conditions are displayed:</p>
<ul>
<li>
<p>Parsing Schema Name</p>
</li>
<li>
<p>SQL Text</p>
</li>
<li>
<p>SQL ID</p>
</li>
<li>
<p>Elapsed Time (sec)</p>
</li>
</ul>
</li>
<li>
<p>To add filter conditions, under Filter Conditions, select the filter condition you want to add and click <span class="bold">Add a Filter or Column</span>.</p>
<p>After the desired filter conditions have been added, specify their values in the <span class="bold">Value</span> column, and an operator or a condition in the <span class="bold">Operator</span> column.</p>
</li>
<li>
<p>To remove any unused filter conditions, click the icon in the <span class="bold">Remove</span> column for the corresponding filter condition you want to remove.</p>
</li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Schedule page appears.</p>
</li>
<li>
<p>Proceed to the next step, as described in <a href="#CBBDAJGE">"Creating a SQL Tuning Set: Schedule"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CBBDAJGE"></a><a id="TDPPT158"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Creating a SQL Tuning Set: Schedule</h4>
<p>After the filter options are specified for the SQL tuning set, you can schedule and submit a job to collect the SQL statements and load them into the SQL tuning set.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Before you can schedule a job to create the SQL tuning set, do the following:
<ul>
<li>
<p>Create a SQL Tuning Set and specify the initial options, as described in <a href="#CBBIFBHD">"Creating a SQL Tuning Set: Options"</a>.</p>
</li>
<li>
<p>Select the load method, as described in <a href="#CBBFGJFI">"Creating a SQL Tuning Set: Load Method"</a>.</p>
</li>
<li>
<p>Specify the filter options, as described in <a href="#CBBDDHFG">"Creating a SQL Tuning Set: Filter Options"</a>.</p>
</li>
</ul>
</div>
<p class="orderedlisttitle">To schedule and submit a job to create a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Create SQL Tuning Set: Schedule page, under Job Parameters, enter a name in the <span class="bold">Job Name</span> field if you do not want to use the system-generated job name.</p>
</li>
<li>
<p>In the <span class="bold">Description</span> field, enter a description of the job.</p>
</li>
<li>
<p>Under Schedule, do one of the following:</p>
<ul>
<li>
<p><span class="bold">Immediately</span> to run the job immediately after it has been submitted</p>
</li>
<li>
<p><span class="bold">Later</span> to run the job at a later time as specified using the Time Zone, Date, and Time fields</p>
</li>
</ul>
<img width="650" height="352" src="img/sts_schedule.gif" alt="Description of sts_schedule.gif follows" /><br />
<a id="sthref413" href="img_text/sts_schedule.htm">Description of the illustration sts_schedule.gif</a><br />
<br /></li>
<li>
<p>Click <span class="bold">Next</span>.</p>
<p>The Create SQL Tuning Set: Review page appears.</p>
<img width="569" height="238" src="img/sts_review.gif" alt="Description of sts_review.gif follows" /><br />
<a id="sthref414" href="img_text/sts_review.htm">Description of the illustration sts_review.gif</a><br />
<br /></li>
<li>
<p>Review the SQL Tuning Set options that you have selected.</p>
<p>To view the SQL statements used by the job, expand <span class="bold">Show SQL</span>.</p>
</li>
<li>
<p>Click <span class="bold">Submit</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>If the job was scheduled to run immediately, then a message is displayed to inform you that the job and the SQL tuning set were created successfully. If the job was scheduled to run at a later time, a message is displayed to inform you that the job was created successfully.</p>
</li>
<li>
<p>To view details about the job, such as operation status, click <span class="bold">View Job Details</span>.</p>
<p>The View Job page appears to display details about the job.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CBBFDADC"></a><a id="TDPPT195"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Dropping a SQL Tuning Set</h3>
<p>This section describes how to drop a SQL tuning set. To conserve storage space, you may want to periodically drop unused SQL tuning sets stored in the database.</p>
<p class="orderedlisttitle">To drop a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Database Performance page, under Additional Monitoring Links, click <span class="bold">SQL Tuning Sets</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>Existing SQL tuning sets are displayed on this page.</p>
</li>
<li>
<p>Select the SQL tuning set you want to drop and then click <span class="bold">Drop</span>.</p>
<p>The Confirmation page appears to verify that you want to drop the selected SQL tuning set.</p>
</li>
<li>
<p>Click <span class="bold">Yes</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>A confirmation message is displayed to indicate that the SQL tuning set was successfully dropped.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CBBFCEAA"></a><a id="TDPPT159"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Transporting SQL Tuning Sets</h3>
<p>You can transport SQL tuning sets from one system to another by first exporting a SQL tuning set from one database, and then importing it into another database.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CBBEGDGC">Exporting a SQL Tuning Set</a></p>
</li>
<li>
<p><a href="#CBBECFBI">Importing a SQL Tuning Set</a></p>
</li>
</ul>
<a id="CBBEGDGC"></a><a id="TDPPT193"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Exporting a SQL Tuning Set</h4>
<p>This section describes how to export a SQL tuning set, enabling it to be transported to another system.</p>
<p class="orderedlisttitle">To export a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Database Performance page, under Additional Monitoring Links, click <span class="bold">SQL Tuning Sets</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>Existing SQL Tuning Sets are displayed on this page.</p>
</li>
<li>
<p>Select the SQL tuning set you want to export and then click <span class="bold">Export</span>.</p>
<p>The Export SQL Tuning Set page appears.</p>
<img width="619" height="611" src="img/sts_export.gif" alt="Description of sts_export.gif follows" /><br />
<a id="sthref417" href="img_text/sts_export.htm">Description of the illustration sts_export.gif</a><br />
<br /></li>
<li>
<p>In the <span class="bold">Directory Object</span> field, select a directory where the export file will be created.</p>
<p>For example, to use the Oracle Data Pump directory, select <code>DATA_PUMP_DIR</code>. The Directory Name field refreshes automatically to indicate the selected directory.</p>
</li>
<li>
<p>In the <span class="bold">Export File</span> field, enter a name for the file to be database.</p>
<p>Alternatively, you can accept the name generated by the database.</p>
</li>
<li>
<p>In the <span class="bold">Log File</span> field, enter a name for the log file for the export operation.</p>
<p>Alternatively, you can accept the name generated by the database.</p>
</li>
<li>
<p>Select a tablespace to temporarily store the data for the export operation.</p>
<p>By default, <code>SYSAUX</code> is used.</p>
</li>
<li>
<p>Under Job Parameters, in the <span class="bold">Job Name</span> field, enter a name for the job.</p>
<p>Alternatively, you can accept the name generated by the database.</p>
</li>
<li>
<p>Under Schedule, do one of the following:</p>
<ul>
<li>
<p>Select <span class="bold">Immediately</span> to run the job immediately after it has been submitted.</p>
</li>
<li>
<p>Select <span class="bold">Later</span> to run the job at a later time as specified by selecting or entering values in the <span class="bold">Time Zone</span>, <span class="bold">Date</span>, and <span class="bold">Time</span> fields.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>A confirmation message indicates that the job was created successfully.</p>
</li>
<li>
<p>Transport the export file to another system using the mechanism of choice, such as Oracle Data Pump or a database link.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CBBECFBI"></a><a id="TDPPT194"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Importing a SQL Tuning Set</h4>
<p>Before a SQL tuning set can be imported, you must first export a SQL tuning set from another system and transport it to your current system. For more information, see <a href="#CBBEGDGC">"Exporting a SQL Tuning Set"</a>.</p>
<p class="orderedlisttitle">To import a SQL tuning set:&nbsp;</p>
<ol>
<li>
<p>On the Database Performance page, under Additional Monitoring Links, click <span class="bold">SQL Tuning Sets</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
</li>
<li>
<p>Click <span class="bold">Import</span>.</p>
<p>The Import SQL Tuning Set page appears.</p>
</li>
<li>
<p>In <span class="bold">Directory Object</span>, select the directory containing the file to be imported.</p>
<p>The directory should contain the export file that was transported to your current system. For example, if the file resides in the Data Pump directory, then select <code>DATA_PUMP_DIR</code>. The Directory Name field refreshes automatically to indicate the selected directory.</p>
</li>
<li>
<p>In the <span class="bold">Import File</span> field, enter the name of the dump file that will be imported.</p>
</li>
<li>
<p>In the <span class="bold">Log File</span> field, enter a name for the log file for the import operation.</p>
</li>
<li>
<p>To replace an existing SQL tuning set with the one that you are importing, select <span class="bold">Replace the existing SQL tuning set if one exists</span>.</p>
</li>
<li>
<p>Select a tablespace to temporarily store the data for the import operation.</p>
<p>By default, <code>SYSAUX</code> is used.</p>
</li>
<li>
<p>Under Job Parameters, in the <span class="bold">Job Name</span> field, enter a name for the job.</p>
<p>Alternatively, you can accept the name generated by the system.</p>
</li>
<li>
<p>Under Schedule, do one of the following:</p>
<ul>
<li>
<p>Select <span class="bold">Immediately</span> to run the job immediately after it has been submitted.</p>
</li>
<li>
<p>Select <span class="bold">Later</span> to run the job at a later time as specified by selecting or entering values in the <span class="bold">Time Zone</span>, <span class="bold">Date</span>, and <span class="bold">Time</span> fields.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>The SQL Tuning Sets page appears.</p>
<p>A confirmation message is displayed to indicate that the job was successfully created. If the job is scheduled to run immediately, then the imported SQL tuning set will be shown on this page. You may need to refresh to see the SQL tuning set.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDDAGBE"></a><a id="TDPPT163"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing SQL Profiles</h2>
<p>A <span class="bold">SQL profile</span> is a set of auxiliary information that is built during automatic tuning of a SQL statement. A SQL profile is to a SQL statement what statistics are to a table.</p>
<p>When running a SQL Tuning Advisor task with a limited scope, the optimizer makes estimates about cardinality, selectivity, and cost that are sometimes significantly off, resulting in poor execution plans. To address this problem, consider running a SQL Tuning Advisor task with a comprehensive scope to collect additional information using sampling and partial execution techniques into a SQL profile. The database can use the profile to verify and, if necessary, adjust optimizer estimates.</p>
<p>During SQL profiling, the optimizer uses the execution history of the SQL statement to create appropriate settings for optimizer parameters. After SQL profiling completes, the optimizer uses the information in the SQL profile and regular database statistics to generate execution plans. The additional information enables the database to produce well-tuned plans for corresponding SQL statements.</p>
<p>After running a SQL Tuning Advisor task with a comprehensive scope, a SQL profile may be recommended. If you accept the recommendation, then the database creates the SQL profile and enables it for the SQL statement.</p>
<p>In some cases, you may want to disable a SQL profile. For example, you may want to test the performance of a SQL statement without using a SQL profile to determine if the SQL profile is actually beneficial. If the SQL statement is performing poorly after the SQL profile is disabled, then you should enable it again to avoid performance degradation. If the SQL statement is performing optimally after you have disabled the SQL profile, then you may want to remove the SQL profile from your database.</p>
<p class="orderedlisttitle">To enable, disable, or delete a SQL profile<a id="sthref420"></a><a id="sthref421"></a><a id="sthref422"></a>:&nbsp;</p>
<ol>
<li>
<p>On the Performance page, click <span class="bold">Top Activity</span>.</p>
<p>The Top Activity page appears.</p>
</li>
<li>
<p>Under Top SQL, click the <span class="bold">SQL ID</span> link of the SQL statement that is using a SQL profile.</p>
<p>The SQL Details page appears.</p>
</li>
<li>
<p>Click the <span class="bold">Plan Control</span> tab.</p>
<p>A list of SQL profiles is displayed under SQL Profiles and Outlines.</p>
</li>
<li>
<p>Select the SQL profile you want to manage. Do one of the following:</p>
<ul>
<li>
<p>To enable a SQL profile that is disabled, click <span class="bold">Disable/Enable</span>.</p>
</li>
<li>
<p>To disable a SQL profile that is enabled, click <span class="bold">Disable/Enable</span>.</p>
</li>
<li>
<p>To remove a SQL profile, click <span class="bold">Delete</span>.</p>
</li>
</ul>
<p>A confirmation page appears.</p>
</li>
<li>
<p>Click <span class="bold">Yes</span> to continue, or <span class="bold">No</span> to cancel the action.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink PFGRF02605" href="../../server.112/e41573/sql_tune.htm#PFGRF02605"><span class="italic">Oracle Database Performance Tuning Guide</span></a> to learn how to manage SQL profiles using an API</div>
</div>
<!-- class="sect1" -->
<a id="CACCFCIG"></a><a id="TDPPT335"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing SQL Execution Plans</h2>
<p><span class="bold">SQL plan management</span> is a preventative mechanism that records and evaluates execution plans of SQL statements over time. The database builds <span class="bold">SQL plan baselines</span> consisting of a set of efficient plans. If the same SQL statement runs repeatedly, and if the optimizer generates a new plan differing from the baseline, then the database compares the plan with the baseline and chooses the best one.</p>
<p>SQL plan management avoids SQL performance regression. Events such as new optimizer statistics, changes to initialization parameters, database upgrades, and so on can cause changes to execution plans. These changes can cause SQL performance regressions that are difficult and time-consuming to fix manually. SQL plan baselines preserve performance of SQL statements, regardless of changes in the database.</p>
<p>You can have the database capture SQL plan baselines automatically or you can load SQL execution plans manually.</p>
<p class="orderedlisttitle">To capture SQL plan baselines automatically:&nbsp;</p>
<ol>
<li>
<p>Access the Database Home page.</p>
<p>See <a class="olink ADMQS033" href="../../server.112/e10897/em_manage.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</li>
<li>
<p>Select <span class="bold">Performance</span>, then <span class="bold">SQL</span>, and then <span class="bold">SQL Plan Control</span>.</p>
<p>If the Database Login page appears, then log in as a user with administrator privileges. The SQL Profile subpage of the SQL Plan Control page appears.</p>
</li>
<li>
<p>Click <span class="bold">SQL Plan Baseline</span>.</p>
<p>The SQL Plan Baseline subpage appears.</p>
<img width="703" height="226" src="img/sql_plan_control.gif" alt="Description of sql_plan_control.gif follows" /><br />
<a id="sthref424" href="img_text/sql_plan_control.htm">Description of the illustration sql_plan_control.gif</a><br />
<br /></li>
<li>
<p>Under Settings, click the link next to <span class="bold">Capture SQL Plan Baselines</span>.</p>
<p>The Initialization Parameters page appears.</p>
</li>
<li>
<p>In the <span class="bold">Value</span> column of the table, select <span class="bold">TRUE</span> and then click <span class="bold">OK</span>.</p>
<p>You are returned to the SQL Plan Baseline subpage, which now shows <span class="bold">Capture SQL Baselines</span> set to <span class="bold">TRUE</span>.</p>
<p>Because you configured baselines to be captured, the database automatically keeps a history of execution plans for all SQL statements executed more than once.</p>
</li>
</ol>
<p>To load SQL execution plans manually, the Capture SQL Baselines setting must be FALSE.</p>
<p class="orderedlisttitle">To manually load SQL execution plans:&nbsp;</p>
<ol>
<li>
<p>Access the Database Home page.</p>
<p>See <a class="olink ADMQS033" href="../../server.112/e10897/em_manage.htm#ADMQS033"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information.</p>
</li>
<li>
<p>Select <span class="bold">Performance</span>, then <span class="bold">SQL</span>, and then <span class="bold">SQL Plan Control</span>.</p>
</li>
<li>
<p>Click <span class="bold">SQL Plan Baseline</span>.</p>
<p>The SQL Plan Baseline subpage appears.</p>
</li>
<li>
<p>Click <span class="bold">Load</span>.</p>
<p>The SQL Plan Control page appears.</p>
<img width="614" height="576" src="img/sql_plan_load.gif" alt="Description of sql_plan_load.gif follows" /><br />
<a id="sthref426" href="img_text/sql_plan_load.htm">Description of the illustration sql_plan_load.gif</a><br />
<br /></li>
<li>
<p>Select the SQL plan baselines to be loaded by completing the following steps:</p>
<ol>
<li>
<p>Under Load SQL Plan Baselines, select <span class="bold">Load plans from SQL Tuning Set (STS)</span>.</p>
<p>In this example, load plans from the SQL tuning set that you created in <a href="#CHDFABIG">"Creating a SQL Tuning Set"</a>.</p>
</li>
<li>
<p>In <span class="bold">Job Name</span>, enter a name for the job. For example, enter <code>SPM_LOAD_TEST</code>.</p>
</li>
<li>
<p>Under Schedule, select <span class="bold">Immediately</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
<p>The SQL Profile subpage of the SQL Plan Control page appears.</p>
<p>The table displays a list of SQL plans that are stored as SQL plan baselines.</p>
<img width="772" height="474" src="img/sql_baselines.gif" alt="Description of sql_baselines.gif follows" /><br />
<a id="sthref427" href="img_text/sql_baselines.htm">Description of the illustration sql_baselines.gif</a><br />
<br /></li>
<li>
<p>Optionally, fix the execution plan of a baseline to prevent the database from using an alternative SQL plan baseline. Complete the following steps:</p>
<ol>
<li>
<p>Select a SQL plan baseline that is not fixed.</p>
</li>
<li>
<p>Select <span class="bold">Fixed - Yes</span> from the list preceding the baseline table.</p>
</li>
<li>
<p>Click <span class="bold">Go</span>.</p>
</li>
</ol>
<p>The table is refreshed to show the SQL execution plan with the value <code>YES</code> in the Fixed column of the table.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink PFGRF007" href="../../server.112/e41573/optplanmgmt.htm#PFGRF007"><span class="italic">Oracle Database Performance Tuning Guide</span></a> to learn how to use SQL plan management</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1738">
<tr>
<td class="cellalignment1745">
<table class="cellalignment1743">
<tr>
<td class="cellalignment1742"><a href="tdppt_sqlid.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1742"><a href="tdppt_sqlopt.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1747">
<table class="cellalignment1741">
<tr>
<td class="cellalignment1742"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1742"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1742"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1742"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1742"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1742"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
