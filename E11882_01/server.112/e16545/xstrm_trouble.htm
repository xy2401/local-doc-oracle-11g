<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Troubleshooting XStream</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 735" />
<meta name="dcterms.created" content="2013-07-02T6:44:43Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database XStream Guide" />
<meta name="dcterms.identifier" content="E16545-09" />
<meta name="dcterms.isVersionOf" content="XSTRM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2009, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="xstrm_mon.htm" title="Previous" type="text/html" />
<link rel="Next" href="xstrm_pt_plsql.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e16545.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">12/22</span> <!-- End Header -->
<div id="XSTRM1641" class="chapter"><a id="BABJJCEG"></a>
<h1 class="chapter"><span class="secnum">7</span> Troubleshooting XStream</h1>
<p><a id="sthref310"></a><a id="sthref311"></a>This chapter describes common problems you might encounter while using XStream and explains how to solve them.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CIACIECE">Diagnosing Problems with XStream</a></p>
</li>
<li>
<p><a href="#CIADFDJJ">Problems and Solutions for XStream</a></p>
</li>
<li>
<p><a href="#CIABGGEA">How to Get More Help with XStream</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="xstrm_cncpt.htm#BCEBDGFJ">Chapter 2, "XStream Concepts"</a></p>
</li>
<li>
<p><a href="xstrm_use.htm#CHDCFEHI">Chapter 3, "XStream Use Cases"</a></p>
</li>
<li>
<p><a href="xstrm_config.htm#CBDIJEFE">Chapter 4, "Configuring XStream"</a></p>
</li>
<li>
<p><a href="xstrm_man.htm#CHDFDFHB">Chapter 5, "Managing XStream"</a></p>
</li>
<li>
<p><a href="xstrm_mon.htm#CHDDBGIA">Chapter 6, "Monitoring XStream"</a></p>
</li>
</ul>
</div>
<a id="CIACIECE"></a>
<div id="XSTRM72610" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Diagnosing Problems with XStream<a id="sthref312"></a></h2>
<p>With XStream, an Oracle Streams apply process can function as an outbound server or an inbound server. An XStream configuration can also include other components, such as capture processes, queues, propagations, rules, and rule-based transformations.</p>
<p>To diagnose problems with XStream, you can use many of the same techniques that are used to diagnose problems with Oracle Streams components. These techniques include the following:</p>
<ul>
<li>
<p>Viewing Oracle Streams alerts</p>
</li>
<li>
<p>Using the Streams configuration report and health check script</p>
</li>
<li>
<p>Handling performance problems because of an unavailable destination</p>
</li>
<li>
<p>Checking the trace files and alert log for problems</p>
</li>
</ul>
<p>See <a class="olink STRMS015" href="../../server.112/e17069/strms_trouble.htm#STRMS015"><span class="italic">Oracle Streams Concepts and Administration</span></a> for detailed information about these topics.</p>
</div>
<!-- class="sect1" -->
<a id="CIADFDJJ"></a>
<div id="XSTRM72611" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Problems and Solutions for XStream</h2>
<p>In general, you can troubleshoot XStream outbound servers and inbound servers in the same way that you troubleshoot Oracle Streams apply processes. In addition, an XStream Out environment includes capture processes and queues, and might include other components, such as propagations, rules, and rule-based transformations. To troubleshoot these components, see the troubleshooting documentation in <a class="olink STRMS1016" href="../../server.112/e17069/pt_trouble.htm#STRMS1016"><span class="italic">Oracle Streams Concepts and Administration</span></a>.</p>
<p>This section describes common problems and solutions for XStream.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#BABBHHGH">An OCI Client Application Cannot Attach to the Outbound Server</a></p>
</li>
<li>
<p><a href="#BABIEFIJ">Changes Are Failing to Reach the Client Application in XStream Out</a></p>
</li>
<li>
<p><a href="#BABCHHAG">LCRs Streaming from an Outbound Server Are Missing Extra Attributes</a></p>
</li>
<li>
<p><a href="#BABDEDEI">The XStream Out Client Application Is Unresponsive</a></p>
</li>
<li>
<p><a href="#BABEFJDC">XStream In Cannot Identify an Inbound Server</a></p>
</li>
<li>
<p><a href="#CIAIHHHD">Changes Are Not Being Applied by an Inbound Server</a></p>
</li>
</ul>
<a id="BABBHHGH"></a>
<div id="XSTRM1643" class="sect2">
<h3 class="sect2">An OCI Client Application Cannot Attach to the Outbound Server<a id="sthref313"></a><a id="sthref314"></a></h3>
<p>An XStream client application cannot attach to an outbound server using the Oracle Call Interface (OCI) <code>OCIXStreamOutAttach()</code> function.</p>
<p>The following sections describe possible problems and their solutions.</p>
<p class="subhead2"><a id="XSTRM72612"></a>Problem 1: Client Application Not Connected as Connect User</p>
<p>The client application is not connected as the outbound server's connect user to the outbound server's database. The client application connected to the database as a different user.</p>
<p class="subhead2"><a id="XSTRM72613"></a>Solution 1</p>
<p class="itemizedlisttitle">To correct problem 1:&nbsp;</p>
<ul>
<li>
<p>Modify the client application to connect to the database as the connect user before attaching to the outbound server.</p>
</li>
</ul>
<p class="subhead2"><a id="XSTRM72614"></a>Problem 2: Client Application Not Passing Service Handle</p>
<p>The client application is not passing a service handle to the outbound server.</p>
<p class="subhead2"><a id="XSTRM72615"></a>Solution 2</p>
<p class="itemizedlisttitle">To correct problem 2:&nbsp;</p>
<ul>
<li>
<p>Modify the client application so that it passes a service handle using <code>OCISvcCtx</code> and not <code>OCIServer</code>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink LNOCI" href="../../appdev.112/e10646/toc.htm"></a>
<ul>
<li>
<p><a href="xstrm_cncpt.htm#BCEBGHCJ">"XStream and Security"</a></p>
</li>
<li>
<p><a href="xstrm_oci.htm#CIHIGIFE">"OCIXStreamOutAttach()"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABIEFIJ"></a>
<div id="XSTRM1644" class="sect2">
<h3 class="sect2">Changes Are Failing to Reach the Client Application in XStream Out<a id="sthref317"></a><a id="sthref318"></a></h3>
<p>In an XStream Out configuration, database changes that should be captured and streamed to the XStream client application are not reaching the client application.</p>
<p>The following sections describe possible problems and their solutions.</p>
<p class="subhead2"><a id="XSTRM72616"></a>Problem 1: Capture Process Has Fallen Behind<a id="sthref319"></a></p>
<p>The capture process has fallen behind.</p>
<p class="orderedlisttitle">To determine whether the capture process has fallen behind:&nbsp;</p>
<ol>
<li>
<p>Connect to the outbound server database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre>
COLUMN CAPTURE_NAME HEADING 'Capture|Name' FORMAT A15
COLUMN CREATE_MESSAGE HEADING 'Last LCR|Create Time'
COLUMN ENQUEUE_MESSAGE HEADING 'Last|Enqueue Time'

SELECT CAPTURE_NAME,
       TO_CHAR(CAPTURE_MESSAGE_CREATE_TIME, 'HH24:MI:SS MM/DD/YY') CREATE_MESSAGE,
       TO_CHAR(ENQUEUE_MESSAGE_CREATE_TIME, 'HH24:MI:SS MM/DD/YY') ENQUEUE_MESSAGE
  FROM V$STREAMS_CAPTURE;
</pre>
<p>This query displays the time when the capture process last created a logical change record (LCR) and the time when the capture process last enqueued an LCR. If the times returned are before the time when the database changes were made, then the capture process must catch up and capture the changes.</p>
</li>
</ol>
<p class="subhead2"><a id="XSTRM72617"></a>Solution 1</p>
<p>No action is required. Normally, the capture process will catch up on its own without the need for intervention.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="xstrm_dp_views.htm#CHDFHEJG">"V$XSTREAM_CAPTURE"</a></p>
</li>
<li>
<p><a class="olink STREP145" href="../../server.112/e10705/man_gen_rep.htm#STREP145"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a></p>
</li>
</ul>
</div>
<p class="subhead2"><a id="XSTRM72618"></a>Problem 2: Rules or Rule-Based Transformation Excluding Changes<a id="sthref321"></a></p>
<p>Rules or rule-based transformations are excluding the changes that should be captured.</p>
<p>Rules determine which LCRs are captured by a capture process, sent from a source queue to a destination queue by a propagation, and sent to an XStream client application by an outbound server. If the rules are not configured properly, then the client application might not receive the LCRs it should receive. The client application might also receive LCRs that it should not receive.</p>
<p>Rule-based transformations modify the contents of LCRs. Therefore, if the expected change data is not reaching the client application, it might be because a rule-based transformation modified the data or deleted the data. For example, a <code>DELETE_COLUMN</code> declarative rule-based transformation removes a column from an LCR.</p>
<p class="subhead2"><a id="XSTRM72619"></a>Solution 2</p>
<p class="itemizedlisttitle">To correct problem 2:&nbsp;</p>
<ul>
<li>
<p>Check the rules and rule-based transformations that are configured for each component in the stream from the capture process to the client application, and correct any problems.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS" href="../e17069/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
<p class="subhead2"><a id="XSTRM72620"></a>Problem 3: LCRs Blocked in the Stream<a id="sthref323"></a></p>
<p>If the capture process has not fallen behind, and there are no problems with rules or rule-based transformations, then LCRs might be blocked in the stream for some other reason. For example, a propagation or outbound server might be disabled, a database link might be broken, or there might be another problem.</p>
<p>You can track an LCR through a stream using one of the following methods:</p>
<ul>
<li>
<p>Setting the <code>message_tracking_frequency</code> capture process parameter to <code>1</code> or another relatively low value</p>
</li>
<li>
<p>Running the <code>SET_MESSAGE_TRACKING</code> procedure in the <code>DBMS_STREAMS_ADM</code> package</p>
</li>
</ul>
<p>After using one of these methods, use the <code>V$STREAMS_MESSAGE_TRACKING</code> view to monitor the progress of LCRs through the stream. By tracking an LCR through the stream, you can determine where the LCR is blocked.</p>
<p class="subhead2"><a id="XSTRM72621"></a>Solution 3</p>
<p class="itemizedlisttitle">To correct problem 3:&nbsp;</p>
<ul>
<li>
<p>Take the appropriate action based on the reason that the LCR is blocked. For example, if a propagation is disabled, then enable it.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STREP145" href="../../server.112/e10705/man_gen_rep.htm#STREP145"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for more information about tracking LCRs through a stream</p>
</li>
<li>
<p><a class="olink ARPLS306" href="../../appdev.112/e40758/d_cap_a.htm#ARPLS306"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>message_tracking_frequency</code> capture process parameter</p>
</li>
<li>
<p><a class="olink STRMS1016" href="../../server.112/e17069/pt_trouble.htm#STRMS1016"><span class="italic">Oracle Streams Concepts and Administration</span></a> about troubleshooting Oracle Streams components</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABCHHAG"></a>
<div id="XSTRM1647" class="sect2">
<h3 class="sect2">LCRs Streaming from an Outbound Server Are Missing Extra Attributes<a id="sthref325"></a><a id="sthref326"></a></h3>
<p>LCRs streaming from an outbound server are expected to include extra attributes, but these attributes are not included in the LCRs.</p>
<p>LCRs can contain the following extra attributes related to database changes:</p>
<ul>
<li>
<p><code>row_id</code></p>
</li>
<li>
<p><code>serial#</code></p>
</li>
<li>
<p><code>session#</code></p>
</li>
<li>
<p><code>thread#</code></p>
</li>
<li>
<p><code>tx_name</code></p>
</li>
<li>
<p><code>username</code></p>
</li>
</ul>
<p>By default, a capture process does not capture these extra attributes. If you want extra attributes to be included in LCRs streamed from an outbound server to an XStream client application, but the LCRs do not contain values for extra attributes, then make sure the capture process that captures changes for the outbound server is configured to capture values for the extra attributes.</p>
<p>The following sections describe the possible problem and its solution.</p>
<p class="subhead2"><a id="XSTRM72622"></a>Problem: Capture Process Not Configured to Capture Extra Attributes<a id="sthref327"></a><a id="sthref328"></a></p>
<p>The capture process is not configured to capture the required extra attributes.</p>
<p class="orderedlisttitle">To display the extra attributes currently being captured by the capture processes in a database:&nbsp;</p>
<ol>
<li>
<p>Connect to the database running the capture process as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre>
COLUMN CAPTURE_NAME HEADING 'Capture Process' FORMAT A30
COLUMN ATTRIBUTE_NAME HEADING 'Attribute Name' FORMAT A30
 
SELECT CAPTURE_NAME, ATTRIBUTE_NAME
  FROM DBA_CAPTURE_EXTRA_ATTRIBUTES
  WHERE INCLUDE = 'YES'
  ORDER BY CAPTURE_NAME;
</pre>
<p>If an extra attribute is not displayed by this query, then it is not being captured.</p>
</li>
</ol>
<p class="subhead2"><a id="XSTRM72623"></a>Solution</p>
<p class="orderedlisttitle">To solve the problem, configure the capture process to capture the required extra attributes:&nbsp;</p>
<ol>
<li>
<p>Connect to the outbound server database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the <code>INCLUDE_EXTRA_ATTRIBUTE</code> procedure in the <code>DBMS_CAPTURE_ADM</code> package.</p>
</li>
</ol>
<div id="XSTRM72624" class="example">
<p class="titleinexample"><a id="sthref331"></a>Example 7-1 Including the tx_name Attribute for the Capture Process xcapture</p>
<pre>
BEGIN
  DBMS_CAPTURE_ADM.INCLUDE_EXTRA_ATTRIBUTE(
    capture_name   =&gt; 'xcapture',
    attribute_name =&gt; 'tx_name',
    include        =&gt; TRUE);
END;
/
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STRMS302" href="../../server.112/e17069/strms_capture.htm#STRMS302"><span class="italic">Oracle Streams Concepts and Administration</span></a></div>
</div>
<!-- class="sect2" -->
<a id="BABDEDEI"></a>
<div id="XSTRM1648" class="sect2">
<h3 class="sect2">The XStream Out Client Application Is Unresponsive<a id="sthref332"></a><a id="sthref333"></a><a id="sthref334"></a><a id="sthref335"></a><a id="sthref336"></a></h3>
<p>The XStream client application in an XStream Out configuration is unresponsive.</p>
<p>The following sections describe the possible problem and its solution.</p>
<p class="subhead2"><a id="XSTRM72625"></a>Problem 1: Streams Pool Size Is Too Small</p>
<p>The Streams pool size might be too small.</p>
<p class="orderedlisttitle">To determine whether the Streams pool size is too small:&nbsp;</p>
<ol>
<li>
<p>Connect to the outbound server database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following queries at the database that contains the outbound server:</p>
<ul>
<li>
<p>Query the <code>V$PROPAGATION_RECEIVER</code> view.:</p>
<pre>
SELECT STATE FROM V$PROPAGATION_RECEIVER;
</pre>
<p>If the state is <code>WAITING</code> <code>FOR</code> <code>MEMORY</code>, then consider increasing the Streams pool size.</p>
</li>
<li>
<p>Query the <code>V$STREAMS_POOL_STATISTICS</code> view.:</p>
<pre>
SELECT TOTAL_MEMORY_ALLOCATED/CURRENT_SIZE FROM V$STREAMS_POOL_STATISTICS;
</pre>
<p>If the value returned is .90 or greater, then consider increasing the Streams pool size.</p>
</li>
<li>
<p>If the outbound server receives changes from a capture process that is running on the same database, then query the <code>V$STREAMS_CAPTURE</code> view.:</p>
<pre>
SELECT STATE FROM V$STREAMS_CAPTURE;
</pre>
<p>If the state is <code>WAITING</code> <code>FOR</code> <code>BUFFER</code> <code>QUEUE</code> <code>TO</code> <code>SHRINK</code>, then increase the Streams pool size.</p>
</li>
</ul>
</li>
</ol>
<p class="subhead2"><a id="XSTRM72626"></a>Solution 1</p>
<p class="itemizedlisttitle">To correct problem 1:&nbsp;</p>
<ul>
<li>
<p>Increase the Streams pool size by modifying the <code>STREAMS_POOL_SIZE</code> initialization parameter or by modifying other initialization parameters related to memory.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="xstrm_dp_views.htm#CHDFHEJG">"V$XSTREAM_CAPTURE"</a></p>
</li>
<li>
<p><a class="olink STREP202" href="../../server.112/e10705/prep_rep.htm#STREP202"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a></p>
</li>
<li>
<p><a class="olink ADMIN00202" href="../../server.112/e25494/create.htm#ADMIN00202"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about setting initialization parameters</p>
</li>
</ul>
</div>
<p class="subhead2"><a id="XSTRM72627"></a>Problem 2: Programming Errors</p>
<p>If there is enough memory in the Streams pool, then check your client application for programming errors.</p>
<p class="subhead2"><a id="XSTRM72628"></a>Solution 2</p>
<p class="itemizedlisttitle">To correct problem 2:&nbsp;</p>
<ul>
<li>
<p>Correct the programming errors.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABEFJDC"></a>
<div id="XSTRM1659" class="sect2">
<h3 class="sect2">XStream In Cannot Identify an Inbound Server<a id="sthref340"></a></h3>
<p>If an XStream In configuration cannot identify an inbound server, then the following error is returned:</p>
<pre>
ORA-26840: STREAMS unable to identify an apply for the source database "<span class="italic">%s</span>"
</pre>
<p>The following sections describe the possible problem and its solution.</p>
<p class="subhead2"><a id="XSTRM72629"></a>Problem: Multiple Subscribers to the Inbound Server's Queue<a id="sthref341"></a></p>
<p>The <code>ORA-26840</code> error indicates that there are multiple subscribers to the queue used by the inbound server. Subscribers can include inbound servers, outbound servers, apply processes, and propagations.</p>
<p class="orderedlisttitle">To determine whether there are multiple subscribers to the inbound server's queue:&nbsp;</p>
<ol>
<li>
<p>Connect to the inbound server database as the XStream administrator.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre>
SELECT APPLY_NAME SUBSCRIBER, QUEUE_NAME FROM DBA_APPLY UNION
  SELECT PROPAGATION_NAME, SOURCE_QUEUE_NAME
  FROM DBA_PROPAGATION
  ORDER BY QUEUE_NAME;
</pre>
<p>You can add a <code>WHERE</code> clause to the query to limit the output to the inbound server's queue.</p>
</li>
</ol>
<p class="subhead2"><a id="XSTRM72630"></a>Solution</p>
<p class="itemizedlisttitle">To correct the problem:&nbsp;</p>
<ul>
<li>
<p>If the query returns multiple subscribers to the inbound server's queue, then reconfigure the subscribers so that the inbound server is the only subscriber.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="xstrm_config.htm#CBDIJEFE">Chapter 4, "Configuring XStream"</a></div>
</div>
<!-- class="sect2" -->
<a id="CIAIHHHD"></a>
<div id="XSTRM72670" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Changes Are Not Being Applied by an Inbound Server</h3>
<p>In an XStream In configuration, database changes are sent in the form of LCRs from the XStream client application to an inbound server.</p>
<p>The following sections describe the possible problem and its solution.</p>
<p class="subhead2"><a id="XSTRM72671"></a>Problem: LCRs Blocked During Apply<a id="sthref344"></a></p>
<p>If the inbound server is not applying the changes, then the LCRs are blocked during apply. For example, the inbound server might be disabled, an apply handler might be processing LCRs incorrectly, or there might be another problem.</p>
<p>You can track an LCR during apply by an inbound server using the following methods:</p>
<ul>
<li>
<p>If the client application uses the XStream OCI API, then use the <code>OCI_LCR_ATTR_MESSAGE_TRACKING_LABEL</code> attribute in the <code>OCILCRAttributesSet</code> function to set tracking label, and use the <code>OCIXStreamInLCRSend</code> function to send LCRs.</p>
<p>The following is sample code for setting message tracking for LCRs using the OCI API:</p>
<pre>
static void set_msg_tracking(myctx_t  *ctx, void *lcr, oratext *label)
{
 oci_t      *ocip = ctx-&gt;ocip;
 oratext    *attr_names[] = {OCI_LCR_ATTR_MESSAGE_TRACKING_LABEL};
 ub2         attr_names_lens[] =
                            
{sizeof(OCI_LCR_ATTR_MESSAGE_TRACKING_LABEL)-1};
 ub2         dty[] = {SQLT_CHR};
 OCIInd      ind[] = {OCI_IND_NOTNULL};
 void       *data[1];
 ub2         data_lens[1];
 
 data[0] = label;
 data_lens[0] = strlen(label);
 
 OCICALL(ocip,
         OCILCRAttributesSet(ocip-&gt;svcp, ocip-&gt;errp, 1, attr_names,
                             attr_names_lens, dty, data, ind, data_lens,
                             lcr, OCI_DEFAULT));
}
 
/*---------------------------------------------------------------------
* send_lcr - Send the given lcr and bump up lcr position.
*---------------------------------------------------------------------*/
static void send_lcr(myctx_t  *ctx, void *lcr, ub1 lcrtype)
{
 oci_t      *ocip = ctx-&gt;ocip;
 
 set_msg_tracking(ctx, lcr, "<span class="italic">tracking_label</span>");
 
 OCICALL(ocip,
         OCIXStreamInLCRSend(ocip-&gt;svcp, ocip-&gt;errp, lcr, lcrtype,
                             0, OCI_DEFAULT));
 ctx-&gt;lcr_pos++;
}
</pre>
<p>Using this sample code, to enable message tracking, add the <code>set_msg_tracking</code> procedure to the client application, call <code>set_msg_tracking</code> from the <code>send_lcr</code> procedure when LCRs should be tracked. Replace <span class="italic">tracking_label</span> with the string you want to use for the tracking label.</p>
</li>
<li>
<p>If the client application uses the XStream Java API, then use the <code>setMessageTrackingLabel</code> method.</p>
<p>The following is sample code for setting message tracking for LCRs using the Java API:</p>
<pre>
{
   ((AbstractLCR)lcr).setMessageTrackingLabel("<span class="italic">tracking_label</span>");
}
</pre>
<p>Replace <span class="italic">tracking_label</span> with the string you want to use for the tracking label.</p>
</li>
</ul>
<p>After using one of these methods, use the <code>V$STREAMS_MESSAGE_TRACKING</code> view to monitor the progress of LCRs through a stream. By tracking an LCR, you can determine where the LCR is blocked.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the LCRs originated from an XStream Out configuration, then the easiest way to track the LCRs is by using the methods described in <a href="#BABIEFIJ">"Changes Are Failing to Reach the Client Application in XStream Out"</a>.</div>
<p class="subhead2"><a id="XSTRM72672"></a>Solution</p>
<p class="itemizedlisttitle">To correct the problem:&nbsp;</p>
<ul>
<li>
<p>Take the appropriate action based on the reason that the LCR is blocked. For example, if the inbound server is disabled, then enable it.</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIABGGEA"></a>
<div id="XSTRM72631" class="sect1">
<h2 class="sect1">How to Get More Help with XStream</h2>
<p>You can check My Oracle Support at <code><a href="http://support.oracle.com">http://support.oracle.com</a></code> for more solutions to your problem.</p>
<p>You can visit <code><a href="http://www.oracle.com/support/contact.html">http://www.oracle.com/support/contact.html</a></code> for more information about Oracle Support.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1341">
<tr>
<td class="cellalignment1348">
<table class="cellalignment1346">
<tr>
<td class="cellalignment1345"><a href="xstrm_mon.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1345"><a href="xstrm_pt_plsql.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2009, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1350">
<table class="cellalignment1344">
<tr>
<td class="cellalignment1345"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1345"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1345"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1345"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1345"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1345"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
