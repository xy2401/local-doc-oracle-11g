<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Managing Staging and Propagation</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 732" />
<meta name="dcterms.created" content="2013-06-04T12:39:36Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Streams Concepts and Administration" />
<meta name="dcterms.identifier" content="E17069-08" />
<meta name="dcterms.isVersionOf" content="STRMS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="strms_glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="strms_mcap.htm" title="Previous" type="text/html" />
<link rel="Next" href="strms_mapply.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17069.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">25/57</span> <!-- End Header -->
<div id="STRMS011" class="chapter"><a id="g1025168"></a><a id="BABHDADF"></a>
<h1 class="chapter"><span class="secnum">16</span> Managing Staging and Propagation</h1>
<p><a id="sthref698"></a><a id="sthref699"></a><a id="sthref700"></a>The following topics describe managing <a href="strms_glossary.htm#CHDJDEHJ"><span class="xrefglossterm">ANYDATA queue</span></a>s and <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>s:</p>
<ul>
<li>
<p><a href="#i1006123">Managing Queues</a></p>
</li>
<li>
<p><a href="#i1011128">Managing Oracle Streams Propagations and Propagation Jobs</a></p>
</li>
</ul>
<p>Each task described in this chapter should be completed by an Oracle Streams administrator that has been granted the appropriate privileges, unless specified otherwise.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_prop.htm#g1016256">Chapter 3, "Oracle Streams Staging and Propagation"</a></p>
</li>
<li>
<p><a class="olink STREP200" href="../../server.112/e10705/prep_rep.htm#STREP200"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about creating an Oracle Streams administrator</p>
</li>
<li>
<p><a href="strms_qpmon.htm#i1006780">"Monitoring Queues and Messaging"</a></p>
</li>
<li>
<p><a href="strms_qpmon.htm#i1006969">"Monitoring Oracle Streams Propagations and Propagation Jobs"</a></p>
</li>
<li>
<p><a href="strms_trprop.htm#BCEJCHJJ">Chapter 32, "Troubleshooting Propagation"</a></p>
</li>
</ul>
</div>
<a id="i1006123"></a>
<div id="STRMS101" class="sect1">
<h2 class="sect1">Managing Queues</h2>
<p>An <code>ANYDATA</code> queue stages <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s whose payloads are of <code>ANYDATA</code> type. Therefore, an <code>ANYDATA</code> queue can stage a message with a payload of nearly any type, if the payload is wrapped in an <code>ANYDATA</code> wrapper. Each Oracle Streams <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>, <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, and <a href="strms_glossary.htm#CHDDGHHB"><span class="xrefglossterm">messaging client</span></a> is associated with one <code>ANYDATA</code> queue, and each Oracle Streams <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> is associated with one <code>ANYDATA</code> <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> and one <code>ANYDATA</code> <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>.</p>
<p>This section contains instructions for completing the following tasks related to queues:</p>
<ul>
<li>
<p><a href="#i1006228">Enabling a User to Perform Operations on a Secure Queue</a></p>
</li>
<li>
<p><a href="#i1006289">Disabling a User from Performing Operations on a Secure Queue</a></p>
</li>
<li>
<p><a href="#i1007877">Removing a Queue</a></p>
</li>
</ul>
<a id="i1006228"></a>
<div id="STRMS678" class="sect2">
<h3 class="sect2">Enabling a User to Perform Operations on a Secure Queue<a id="sthref701"></a><a id="sthref702"></a><a id="sthref703"></a><a id="sthref704"></a><a id="sthref705"></a></h3>
<p>For a user to perform <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> operations, such as enqueue and dequeue, on a <a href="strms_glossary.htm#CHDGHFGG"><span class="xrefglossterm">secure queue</span></a>, the user must be configured as a secure queue user of the queue. If you use the <code>SET_UP_QUEUE</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to create the secure queue, then the queue owner and the user specified by the <code>queue_user</code> parameter are configured as secure users of the queue automatically. If you want to enable other users to perform operations on the queue, then you can configure these users in one of the following ways:</p>
<ul>
<li>
<p>Run <code>SET_UP_QUEUE</code> and specify a <code>queue_user</code>. Queue creation is skipped if the queue already exists, but a new queue user is configured if one is specified.</p>
</li>
<li>
<p>Associate the user with an Oracle Streams Advanced Queuing (AQ) agent manually.</p>
</li>
</ul>
<p>The following example illustrates associating a user with an Oracle Streams AQ agent manually. Suppose you want to enable the <code>oe</code> user to perform queue operations on a queue named <code>streams_queue</code>. The following steps configure the <code>oe</code> user as a secure queue user of <code>streams_queue</code>:</p>
<ol>
<li>
<p>In SQL*Plus, connect as an administrative user who can create Oracle Streams AQ agents and alter users.</p>
<p>See <a class="olink ADMIN00102" href="../../server.112/e25494/dba.htm#ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.</p>
</li>
<li>
<p>Create an agent:</p>
<pre>
EXEC DBMS_AQADM.CREATE_AQ_AGENT(agent_name =&gt; 'streams_queue_agent');
</pre></li>
<li>
<p>If the user must be able to dequeue <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s from queue, then make the agent a subscriber of the secure queue:</p>
<pre>
DECLARE
  subscriber SYS.AQ$_AGENT;
BEGIN
  subscriber :=  SYS.AQ$_AGENT('streams_queue_agent', NULL, NULL);  
  DBMS_AQADM.ADD_SUBSCRIBER(
    queue_name          =&gt;  'strmadmin.streams_queue',
    subscriber          =&gt;  subscriber,
    rule                =&gt;  NULL,
    transformation      =&gt;  NULL);
END;
/
</pre></li>
<li>
<p>Associate the user with the agent:</p>
<pre>
BEGIN
  DBMS_AQADM.ENABLE_DB_ACCESS(
    agent_name  =&gt; 'streams_queue_agent',
    db_username =&gt; 'oe');
END;
/
</pre></li>
<li>
<p>Grant the user <code>EXECUTE</code> privilege on the <code>DBMS_STREAMS_MESSAGING</code> package or the <code>DBMS_AQ</code> package, if the user is not already granted these privileges:</p>
<pre>
GRANT EXECUTE ON DBMS_STREAMS_MESSAGING TO oe;

GRANT EXECUTE ON DBMS_AQ TO oe;
</pre></li>
</ol>
<p>When these steps are complete, the <code>oe</code> user is a secure user of the <code>streams_queue</code> queue and can perform operations on the queue. You still must grant the user specific privileges to perform queue operations, such as enqueue and dequeue privileges.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_adqueue.htm#i1006985">"Secure Queues"</a></p>
</li>
<li>
<p><a class="olink ARPLS" href="../../appdev.112/e40758/toc.htm"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about Oracle Streams AQ agents and using the <code>DBMS_AQADM</code> package</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1006289"></a>
<div id="STRMS679" class="sect2">
<h3 class="sect2">Disabling a User from Performing Operations on a Secure Queue<a id="sthref706"></a><a id="sthref707"></a><a id="sthref708"></a><a id="sthref709"></a></h3>
<p>You might want to disable a user from performing <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> operations on a <a href="strms_glossary.htm#CHDGHFGG"><span class="xrefglossterm">secure queue</span></a> for the following reasons:</p>
<ul>
<li>
<p>You dropped a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> or a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>, but you did not drop the queue that was used by the capture process or synchronous capture, and you do not want the user who was the <a href="strms_glossary.htm#CBAEBCEE"><span class="xrefglossterm">capture user</span></a> to be able to perform operations on the remaining secure queue.</p>
</li>
<li>
<p>You dropped an <a href="strms_glossary.htm#CHDJBHJC"><span class="xrefglossterm">apply process</span></a>, but you did not drop the queue that was used by the apply process, and you do not want the user who was the <a href="strms_glossary.htm#CHDGCCIF"><span class="xrefglossterm">apply user</span></a> to be able to perform operations on the remaining secure queue.</p>
</li>
<li>
<p>You used the <code>ALTER_APPLY</code> procedure in the <code>DBMS_APPLY_ADM</code> package to change the <code>apply_user</code> for an apply process, and you do not want the old <code>apply_user</code> to be able to perform operations on the apply process's queue.</p>
</li>
<li>
<p>You enabled a user to perform operations on a secure queue by completing the steps described in <a href="#i1006228">Enabling a User to Perform Operations on a Secure Queue</a>, but you no longer want this user to be able to perform operations on the secure queue.</p>
</li>
</ul>
<p>To disable a secure queue user, you can revoke <code>ENQUEUE</code> and <code>DEQUEUE</code> privilege on the queue from the user, or you can run the <code>DISABLE_DB_ACCESS</code> procedure in the <code>DBMS_AQADM</code> package. For example, suppose you want to disable the <code>oe</code> user from performing queue operations on a queue named <code>streams_queue</code>.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
If an Oracle Streams AQ agent is used for multiple secure queues, then running <code>DISABLE_DB_ACCESS</code> for the agent prevents the user associated with the agent from performing operations on all of these queues.</div>
<ol>
<li>
<p>Run the following procedure to disable the <code>oe</code> user from performing queue operations on the secure queue <code>streams_queue</code>:</p>
<pre>
BEGIN
  DBMS_AQADM.DISABLE_DB_ACCESS(
    agent_name  =&gt; 'streams_queue_agent',
    db_username =&gt; 'oe');
END;
/
</pre></li>
<li>
<p>If the agent is no longer needed, you can drop the agent:</p>
<pre>
BEGIN
  DBMS_AQADM.DROP_AQ_AGENT(
    agent_name  =&gt; 'streams_queue_agent');
END;
/
</pre></li>
<li>
<p>Revoke privileges on the queue from the user, if the user no longer needs these privileges.</p>
<pre>
BEGIN
  DBMS_AQADM.REVOKE_QUEUE_PRIVILEGE (
   privilege   =&gt; 'ALL',
   queue_name  =&gt; 'strmadmin.streams_queue',
   grantee     =&gt; 'oe');
END;
/
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_adqueue.htm#i1006985">"Secure Queues"</a></p>
</li>
<li>
<p><a class="olink ARPLS" href="../../appdev.112/e40758/toc.htm"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about Oracle Streams AQ agents and using the <code>DBMS_AQADM</code> package</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1007877"></a>
<div id="STRMS680" class="sect2">
<h3 class="sect2">Removing a Queue<a id="sthref710"></a><a id="sthref711"></a><a id="sthref712"></a></h3>
<p>You use the <code>REMOVE_QUEUE</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to remove an existing <code>ANYDATA</code> queue. When you run the <code>REMOVE_QUEUE</code> procedure, it waits until any existing <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s in the <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> are consumed. Next, it stops the queue, which means that no further enqueues into the queue or dequeues from the queue are allowed. When the queue is stopped, it drops the queue.</p>
<p>You can also drop the <a href="strms_glossary.htm#CHDFFJJB"><span class="xrefglossterm">queue table</span></a> for the queue if it is empty and is not used by another queue. To do so, specify <code>TRUE</code>, the default, for the <code>drop_unused_queue_table</code> parameter.</p>
<p>In addition, you can drop any <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a>s that use the queue by setting the <code>cascade</code> parameter to <code>TRUE</code>. By default, the <code>cascade</code> parameter is set to <code>FALSE</code>.</p>
<p>For example, to remove an <code>ANYDATA</code> queue named <code>streams_queue</code> in the <code>strmadmin</code> schema and drop its empty queue table, run the following procedure:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.REMOVE_QUEUE(
    queue_name              =&gt; 'strmadmin.streams_queue',
    cascade                 =&gt; FALSE,
    drop_unused_queue_table =&gt; TRUE);
END;
/
</pre>
<p>In this case, because the <code>cascade</code> parameter is set to <code>FALSE</code>, this procedure drops the <code>streams_queue</code> only if no Oracle Streams clients use the queue. If the <code>cascade</code> parameter is set to <code>FALSE</code> and any Oracle Streams client uses the queue, then an error is raised.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1011128"></a>
<div id="STRMS691" class="sect1">
<h2 class="sect1">Managing Oracle Streams Propagations and Propagation Jobs<a id="sthref713"></a><a id="sthref714"></a></h2>
<p>A <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> propagates <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s from an Oracle Streams <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> to an Oracle Streams <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>. This section provides instructions for completing the following tasks:</p>
<ul>
<li>
<p><a href="#BABCCDIA">Starting a Propagation</a></p>
</li>
<li>
<p><a href="#BABFCEJG">Stopping a Propagation</a></p>
</li>
<li>
<p><a href="#i1006659">Altering the Schedule of a Propagation Job</a></p>
</li>
<li>
<p><a href="#i1006737">Specifying the Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#i1006760">Adding Rules to the Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#i1006812">Removing a Rule from the Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#i1006832">Removing a Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#i1006875">Dropping a Propagation</a></p>
</li>
</ul>
<p>In addition, you can use the features of Oracle Streams Advanced Queuing (AQ) to manage Oracle Streams propagations.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_prop.htm#i1006210">"Message Propagation Between Queues"</a></p>
</li>
<li>
<p><a class="olink TDPII141" href="../../server.112/e17516/tdpii_adcont.htm#TDPII141"><span class="italic">Oracle Database 2 Day + Data Replication and Integration Guide</span></a> and the Oracle Enterprise Manager online Help for instructions on managing propagations with Enterprise Manager</p>
</li>
<li>
<p><a class="olink ADQUE0800" href="../../server.112/e11013/aq_admin.htm#ADQUE0800"><span class="italic">Oracle Streams Advanced Queuing User's Guide</span></a> for more information about managing propagations with the features of Oracle Streams AQ</p>
</li>
</ul>
</div>
<a id="BABCCDIA"></a>
<div id="STRMS692" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Starting a Propagation<a id="sthref715"></a><a id="sthref716"></a><a id="sthref717"></a></h3>
<p>You run the <code>START_PROPAGATION</code> procedure in the <code>DBMS_PROPAGATION_ADM</code> package to start an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>. For example, the following procedure starts a propagation named <code>strm01_propagation</code>:</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.START_PROPAGATION(
    propagation_name =&gt; 'strm01_propagation');
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="BABFCEJG"></a>
<div id="STRMS693" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Stopping a Propagation<a id="sthref718"></a><a id="sthref719"></a><a id="sthref720"></a></h3>
<p>You run the <code>STOP_PROPAGATION</code> procedure in the <code>DBMS_PROPAGATION_ADM</code> package to stop an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>. For example, the following procedure stops a propagation named <code>strm01_propagation</code>:</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.STOP_PROPAGATION(
    propagation_name =&gt; 'strm01_propagation',
    force            =&gt; FALSE);
END;
/
</pre>
<p>To clear the statistics for the propagation when it is stopped, set the <code>force</code> parameter to <code>TRUE</code>. If there is a problem with a propagation, then stopping the propagation with the <code>force</code> parameter set to <code>TRUE</code> and restarting the propagation might correct the problem. If the <code>force</code> parameter is set to <code>FALSE</code>, then the statistics for the propagation are not cleared.</p>
</div>
<!-- class="sect2" -->
<a id="i1006659"></a>
<div id="STRMS696" class="sect2">
<h3 class="sect2">Altering the Schedule of a Propagation Job<a id="sthref721"></a><a id="sthref722"></a></h3>
<p>To alter the schedule of an existing <a href="strms_glossary.htm#CHDHGEHC"><span class="xrefglossterm">propagation job</span></a>, use the <code>ALTER_PROPAGATION_SCHEDULE</code> procedure in the <code>DBMS_AQADM</code> package. The following sections contain examples that alter the schedule of a propagation job for a queue-to-queue <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> and for a queue-to-dblink propagation. These examples set the propagation job to propagate <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s every 15 minutes (900 seconds), with each propagation lasting 300 seconds, and a 25-second wait before new messages in a completely propagated <a href="strms_glossary.htm#CHDIDCDI"><span class="xrefglossterm">queue</span></a> are propagated.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#BABEJJFA">Altering the Schedule of a Propagation Job for a Queue-to-Queue Propagation</a></p>
</li>
<li>
<p><a href="#BABIBCBF">Altering the Schedule of a Propagation Job for a Queue-to-Dblink Propagation</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADQUE0800" href="../../server.112/e11013/aq_admin.htm#ADQUE0800"><span class="italic">Oracle Streams Advanced Queuing User's Guide</span></a> for more information about using the <code>ALTER_PROPAGATION_SCHEDULE</code> procedure</p>
</li>
<li>
<p><a href="strms_prop.htm#CHDCJIJF">"Queue-to-Queue Propagations"</a></p>
</li>
<li>
<p><a href="strms_adprop.htm#i1006935">"Propagation Jobs"</a></p>
</li>
</ul>
</div>
<a id="BABEJJFA"></a>
<div id="STRMS697" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Altering the Schedule of a Propagation Job for a Queue-to-Queue Propagation<a id="sthref723"></a><a id="sthref724"></a></h4>
<p>To alter the schedule of a propagation job for a queue-to-queue propagation that propagates messages from the <code>strmadmin.strm_a_queue</code> source queue to the <code>strmadmin.strm_b_queue</code> <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a> using the <code>dbs2.example.com</code> database link, run the following procedure:</p>
<pre>
BEGIN
  DBMS_AQADM.ALTER_PROPAGATION_SCHEDULE(
   queue_name        =&gt; 'strmadmin.strm_a_queue',
   destination       =&gt; 'dbs2.example.com',
   duration          =&gt; 300,
   next_time         =&gt; 'SYSDATE + 900/86400',
   latency           =&gt; 25,
   destination_queue =&gt; 'strmadmin.strm_b_queue'); 
END;
/
</pre>
<p>Because each queue-to-queue propagation has its own propagation job, this procedure alters only the schedule of the propagation that propagates messages between the two queues specified. The <code>destination_queue</code> parameter must specify the name of the destination queue to alter the <a href="strms_glossary.htm#CBADGHAI"><span class="xrefglossterm">propagation schedule</span></a> of a queue-to-queue propagation.</p>
</div>
<!-- class="sect3" -->
<a id="BABIBCBF"></a>
<div id="STRMS698" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Altering the Schedule of a Propagation Job for a Queue-to-Dblink Propagation</h4>
<p>To alter the schedule of a propagation job for a queue-to-dblink propagation that propagates messages from the <code>strmadmin.streams_queue</code> source queue using the <code>dbs3.example.com</code> database link, run the following procedure:</p>
<pre>
BEGIN
  DBMS_AQADM.ALTER_PROPAGATION_SCHEDULE(
   queue_name  =&gt; 'strmadmin.streams_queue',
   destination =&gt; 'dbs3.example.com',
   duration    =&gt; 300,
   next_time   =&gt; 'SYSDATE + 900/86400',
   latency     =&gt; 25); 
END;
/
</pre>
<p>Because the propagation is a queue-to-dblink propagation, the <code>destination_queue</code> parameter is not specified. Completing this task affects all queue-to-dblink propagations that propagate messages from the source queue to all destination queues that use the <code>dbs3.example.com</code> database link.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006737"></a>
<div id="STRMS701" class="sect2">
<h3 class="sect2">Specifying the Rule Set for a Propagation<a id="sthref725"></a><a id="sthref726"></a></h3>
<p>You can specify one <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> and one <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for a <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>. The propagation propagates a <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a> if it evaluates to <code>TRUE</code> for at least one <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> in the positive rule set and discards a change if it evaluates to <code>TRUE</code> for at least one rule in the negative rule set. The negative rule set is evaluated before the positive rule set.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#BABHFCCA">Specifying a Positive Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#BABIAIIC">Specifying a Negative Rule Set for a Propagation</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_rules.htm#g1049257">Chapter 5, "How Rules Are Used in Oracle Streams"</a></p>
</li>
<li>
<p><a href="strms_adrules.htm#BABEBHGC">Chapter 11, "Advanced Rule Concepts"</a></p>
</li>
</ul>
</div>
<a id="BABHFCCA"></a>
<div id="STRMS702" class="sect3">
<h4 class="sect3">Specifying a Positive Rule Set for a Propagation</h4>
<p>You specify an existing <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> as the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> for an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> using the <code>rule_set_name</code> parameter in the <code>ALTER_PROPAGATION</code> procedure. This procedure is in the <code>DBMS_PROPAGATION_ADM</code> package.</p>
<p>For example, the following procedure sets the positive rule set for a propagation named <code>strm01_propagation</code> to <code>strm02_rule_set</code>.</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.ALTER_PROPAGATION(
    propagation_name  =&gt; 'strm01_propagation',
    rule_set_name     =&gt; 'strmadmin.strm02_rule_set');
END;
/
</pre></div>
<!-- class="sect3" -->
<a id="BABIAIIC"></a>
<div id="STRMS703" class="sect3">
<h4 class="sect3">Specifying a Negative Rule Set for a Propagation</h4>
<p>You specify an existing <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> as the <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> using the <code>negative_rule_set_name</code> parameter in the <code>ALTER_PROPAGATION</code> procedure. This procedure is in the <code>DBMS_PROPAGATION_ADM</code> package.</p>
<p>For example, the following procedure sets the negative rule set for a propagation named <code>strm01_propagation</code> to <code>strm03_rule_set</code>.</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.ALTER_PROPAGATION(
    propagation_name        =&gt; 'strm01_propagation',
    negative_rule_set_name  =&gt; 'strmadmin.strm03_rule_set');
END;
/
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006760"></a>
<div id="STRMS704" class="sect2">
<h3 class="sect2">Adding Rules to the Rule Set for a Propagation<a id="sthref727"></a></h3>
<p>To add <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s to the <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> of a <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>, you can run one of the following procedures:</p>
<ul>
<li>
<p><a class="olink ARPLS316" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS316"><code>DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS394" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS394"><code>DBMS_STREAMS_ADM.ADD_SUBSET_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS317" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS317"><code>DBMS_STREAMS_ADM.ADD_SCHEMA_PROPAGATION_RULES</code></a></p>
</li>
<li>
<p><a class="olink ARPLS318" href="../../appdev.112/e40758/d_streams_adm.htm#ARPLS318"><code>DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES</code></a></p>
</li>
</ul>
<p>Excluding the <code>ADD_SUBSET_PROPAGATION_RULES</code> procedure, these procedures can add rules to the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> or <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for a propagation. The <code>ADD_SUBSET_PROPAGATION_RULES</code> procedure can add rules only to the positive rule set for a propagation.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#BABEBGHC">Adding Rules to the Positive Rule Set for a Propagation</a></p>
</li>
<li>
<p><a href="#BABHHGAA">Adding Rules to the Negative Rule Set for a Propagation</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_prop.htm#i1006210">"Message Propagation Between Queues"</a></p>
</li>
<li>
<p><a href="strms_rules.htm#i1006169">"System-Created Rules"</a></p>
</li>
</ul>
</div>
<a id="BABEBGHC"></a>
<div id="STRMS705" class="sect3">
<h4 class="sect3">Adding Rules to the Positive Rule Set for a Propagation</h4>
<p>The following example runs the <code>ADD_TABLE_PROPAGATION_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to add rules to the positive rule set of an existing propagation named <code>strm01_propagation</code>:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.locations',
    streams_name            =&gt; 'strm01_propagation',
    source_queue_name       =&gt; 'strmadmin.strm_a_queue',
    destination_queue_name  =&gt; 'strmadmin.strm_b_queue@dbs2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'dbs1.example.com',
    inclusion_rule          =&gt; TRUE);
END;
/
</pre>
<p>Running this procedure performs the following actions:</p>
<ul>
<li>
<p>Creates two rules. One rule evaluates to <code>TRUE</code> for row LCRs that contain the results of DML changes to the <code>hr.locations</code> table. The other rule evaluates to <code>TRUE</code> for DDL LCRs that contain DDL changes to the <code>hr.locations</code> table. The rule names are system generated.</p>
</li>
<li>
<p>Specifies that both rules evaluate to <code>TRUE</code> only for LCRs whose changes originated at the <code>dbs1.example.com</code> <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a>.</p>
</li>
<li>
<p>Adds the two rules to the positive rule set associated with the propagation because the <code>inclusion_rule</code> parameter is set to <code>TRUE</code>.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="BABHHGAA"></a>
<div id="STRMS706" class="sect3">
<h4 class="sect3">Adding Rules to the Negative Rule Set for a Propagation</h4>
<p>The following example runs the <code>ADD_TABLE_PROPAGATION_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to add rules to the negative rule set of an existing propagation named <code>strm01_propagation</code>:</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.departments',
    streams_name            =&gt; 'strm01_propagation',
    source_queue_name       =&gt; 'strmadmin.strm_a_queue',
    destination_queue_name  =&gt; 'strmadmin.strm_b_queue@dbs2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'dbs1.example.com',
    inclusion_rule          =&gt; FALSE);
END;
/
</pre>
<p>Running this procedure performs the following actions:</p>
<ul>
<li>
<p>Creates two rules. One rule evaluates to <code>TRUE</code> for row LCRs that contain the results of DML changes to the <code>hr.departments</code> table, and the other rule evaluates to <code>TRUE</code> for DDL LCRs that contain DDL changes to the <code>hr.departments</code> table. The rule names are system generated.</p>
</li>
<li>
<p>Specifies that both rules evaluate to <code>TRUE</code> only for LCRs whose changes originated at the <code>dbs1.example.com</code> source database.</p>
</li>
<li>
<p>Adds the two rules to the negative rule set associated with the propagation because the <code>inclusion_rule</code> parameter is set to <code>FALSE</code>.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006812"></a>
<div id="STRMS707" class="sect2">
<h3 class="sect2">Removing a Rule from the Rule Set for a Propagation<a id="sthref728"></a><a id="sthref729"></a></h3>
<p>You remove a <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a> from the <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> for an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> by running the <code>REMOVE_RULE</code> procedure in the <code>DBMS_STREAMS_ADM</code> package. For example, the following procedure removes a rule named <code>departments3</code> from the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> of a propagation named <code>strm01_propagation</code>.</p>
<pre>
BEGIN
  DBMS_STREAMS_ADM.REMOVE_RULE(
    rule_name        =&gt; 'departments3',
    streams_type     =&gt; 'propagation',
    streams_name     =&gt; 'strm01_propagation',
    drop_unused_rule =&gt; TRUE,
    inclusion_rule   =&gt; TRUE);
END;
/
</pre>
<p>In this example, the <code>drop_unused_rule</code> parameter in the <code>REMOVE_RULE</code> procedure is set to <code>TRUE</code>, which is the default setting. Therefore, if the rule being removed is not in any other rule set, then it will be dropped from the database. If the <code>drop_unused_rule</code> parameter is set to <code>FALSE</code>, then the rule is removed from the rule set, but it is not dropped from the database even if it is not in any other rule set.</p>
<p>If the <code>inclusion_rule</code> parameter is set to <code>FALSE</code>, then the <code>REMOVE_RULE</code> procedure removes the rule from the <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for the propagation, not the positive rule set.</p>
<p>To remove all of the rules in the rule set for the propagation, then specify <code>NULL</code> for the <code>rule_name</code> parameter when you run the <code>REMOVE_RULE</code> procedure.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="strms_rules.htm#i1016002">"Oracle Streams Client with One or More Empty Rule Sets"</a></div>
</div>
<!-- class="sect2" -->
<a id="i1006832"></a>
<div id="STRMS708" class="sect2">
<h3 class="sect2">Removing a Rule Set for a Propagation<a id="sthref730"></a><a id="sthref731"></a></h3>
<p>You remove a <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> from a <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a> using the <code>ALTER_PROPAGATION</code> procedure in the <code>DBMS_PROPAGATION_ADM</code> package. This procedure can remove the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a>, <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a>, or both. Specify <code>TRUE</code> for the <code>remove_rule_set</code> parameter to remove the positive rule set for the propagation. Specify <code>TRUE</code> for the <code>remove_negative_rule_set</code> parameter to remove the negative rule set for the propagation.</p>
<p>For example, the following procedure removes both the positive and the negative rule set from a propagation named <code>strm01_propagation</code>.</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.ALTER_PROPAGATION(
    propagation_name         =&gt; 'strm01_propagation',
    remove_rule_set          =&gt; TRUE,
    remove_negative_rule_set =&gt; TRUE);
END;
/
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
If a propagation does not have a positive or negative rule set, then the propagation propagates all <a href="strms_glossary.htm#CHDFHHGJ"><span class="xrefglossterm">message</span></a>s in the <a href="strms_glossary.htm#CHDCGACA"><span class="xrefglossterm">source queue</span></a> to the <a href="strms_glossary.htm#CHDHJHJD"><span class="xrefglossterm">destination queue</span></a>.</div>
</div>
<!-- class="sect2" -->
<a id="i1006875"></a>
<div id="STRMS709" class="sect2">
<h3 class="sect2">Dropping a Propagation<a id="sthref732"></a><a id="sthref733"></a></h3>
<p>You run the <code>DROP_PROPAGATION</code> procedure in the <code>DBMS_PROPAGATION_ADM</code> package to drop an existing <a href="strms_glossary.htm#CHDEICIC"><span class="xrefglossterm">propagation</span></a>. For example, the following procedure drops a propagation named <code>strm01_propagation</code>:</p>
<pre>
BEGIN
  DBMS_PROPAGATION_ADM.DROP_PROPAGATION(
    propagation_name      =&gt; 'strm01_propagation',
    drop_unused_rule_sets =&gt; TRUE);
END;
/
</pre>
<p>Because the <code>drop_unused_rule_sets</code> parameter is set to <code>TRUE</code>, this procedure also drops any <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a>s used by the propagation <code>strm01_propagation</code>, unless a rule set is used by another <a href="strms_glossary.htm#CHDDDJGJ"><span class="xrefglossterm">Oracle Streams client</span></a>. If the <code>drop_unused_rule_sets</code> parameter is set to <code>TRUE</code>, then both the <a href="strms_glossary.htm#CHDEEDIJ"><span class="xrefglossterm">positive rule set</span></a> and <a href="strms_glossary.htm#CHDBHJHI"><span class="xrefglossterm">negative rule set</span></a> for the propagation might be dropped. If this procedure drops a rule set, then it also drops any <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s in the rule set that are not in another rule set.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When you drop a propagation, the <a href="strms_glossary.htm#CHDHGEHC"><span class="xrefglossterm">propagation job</span></a> used by the propagation is dropped automatically, if no other propagations are using the propagation job.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1624">
<tr>
<td class="cellalignment1631">
<table class="cellalignment1629">
<tr>
<td class="cellalignment1628"><a href="strms_mcap.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1628"><a href="strms_mapply.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1633">
<table class="cellalignment1627">
<tr>
<td class="cellalignment1628"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1628"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1628"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1628"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1628"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1628"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
