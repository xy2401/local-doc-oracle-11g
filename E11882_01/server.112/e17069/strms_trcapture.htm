<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Troubleshooting Implicit Capture</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 732" />
<meta name="dcterms.created" content="2013-06-04T12:39:40Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Streams Concepts and Administration" />
<meta name="dcterms.identifier" content="E17069-08" />
<meta name="dcterms.isVersionOf" content="STRMS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2002, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="strms_glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="strms_trouble.htm" title="Previous" type="text/html" />
<link rel="Next" href="strms_trprop.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17069.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">42/57</span> <!-- End Header -->
<div id="STRMS1024" class="chapter"><a id="CACCGFEH"></a>
<h1 class="chapter"><span class="secnum">31</span> Troubleshooting Implicit Capture</h1>
<p><a id="sthref1338"></a><a id="sthref1339"></a><a id="sthref1340"></a><a id="sthref1341"></a>The following topics describe identifying and resolving common problems with <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>es and <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a>s in an Oracle Streams environment:</p>
<ul>
<li>
<p><a href="#i1006114">Troubleshooting Capture Process Problems</a></p>
</li>
<li>
<p><a href="#CACJBFJH">Troubleshooting Synchronous Capture Problems</a></p>
</li>
</ul>
<a id="i1006114"></a>
<div id="STRMS1025" class="sect1">
<h2 class="sect1">Troubleshooting Capture Process Problems<a id="sthref1342"></a><a id="sthref1343"></a></h2>
<p>If a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> is not capturing changes as expected, or if you are having other problems with a capture process, then use the following checklist to identify and resolve capture problems:</p>
<ul>
<li>
<p><a href="#CACDBACA">Is Capture Process Creation or Data Dictionary Build Taking a Long Time?</a></p>
</li>
<li>
<p><a href="#CACGICCI">Is the Capture Process Enabled?</a></p>
</li>
<li>
<p><a href="#CEGHAHHA">Is the Capture Process Waiting for Redo?</a></p>
</li>
<li>
<p><a href="#CEGDDCHH">Is the Capture Process Paused for Flow Control?</a></p>
</li>
<li>
<p><a href="#i1006193">Is the Capture Process Current?</a></p>
</li>
<li>
<p><a href="#i1010961">Are Required Redo Log Files Missing?</a></p>
</li>
<li>
<p><a href="#i1009976">Is a Downstream Capture Process Waiting for Redo Data?</a></p>
</li>
<li>
<p><a href="#i1010814">Are You Trying to Configure Downstream Capture Incorrectly?</a></p>
</li>
<li>
<p><a href="#CACDHFHB">Are You Trying to Configure Downstream Capture without Proper Authentication?</a></p>
</li>
<li>
<p><a href="#i1011046">Are More Actions Required for Downstream Capture without a Database Link?</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_capture.htm#CACGECDI">"Implicit Capture with an Oracle Streams Capture Process"</a></p>
</li>
<li>
<p><a class="olink STREP209" href="../../server.112/e10705/ccap.htm#STREP209"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring a capture process</p>
</li>
<li>
<p><a href="strms_mcap.htm#BEHJFCDD">"Managing a Capture Process"</a></p>
</li>
<li>
<p><a href="strms_cpmon.htm#CFFBEDGE">"Monitoring a Capture Process"</a></p>
</li>
</ul>
</div>
<a id="CACDBACA"></a>
<div id="STRMS1026" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Is Capture Process Creation or Data Dictionary Build Taking a Long Time?<a id="sthref1344"></a><a id="sthref1345"></a><a id="sthref1346"></a><a id="sthref1347"></a></h3>
<p>If capture process creation or a data dictionary build is taking an inordinately long time, then it might be because one or more in-flight transactions have not yet committed. An in-flight transaction is one that is active during capture process creation or a data dictionary build.</p>
<p>To determine whether there are in-flight transactions, check the alert log for the following messages:</p>
<pre>
wait for inflight txns at this scn
Done with waiting for inflight txns at this scn
</pre>
<p>If you see only the first message in the alert log, then the capture process creation or data dictionary build is waiting for the inflight transactions and will complete after all of the in-flight transactions have committed.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink STREP209" href="../../server.112/e10705/ccap.htm#STREP209"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring a capture process</p>
</li>
<li>
<p><a href="strms_adcapture.htm#i1006795">"Capture Process Creation"</a></p>
</li>
<li>
<p><a href="strms_trouble.htm#i1007184">"Checking the Trace Files and Alert Log for Problems"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CACGICCI"></a>
<div id="STRMS1027" class="sect2">
<h3 class="sect2">Is the Capture Process Enabled?<a id="sthref1348"></a><a id="sthref1349"></a><a id="sthref1350"></a></h3>
<p>A <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> captures changes only when it is enabled.</p>
<p>You can check whether a capture process is enabled, disabled, or aborted by querying the <code>DBA_CAPTURE</code> data dictionary view. For example, to check whether a capture process named <code>capture</code> is enabled, run the following query:</p>
<pre>
SELECT STATUS FROM DBA_CAPTURE WHERE CAPTURE_NAME = 'CAPTURE';
</pre>
<p>If the capture process is disabled, then your output looks similar to the following:</p>
<pre>
STATUS
--------
DISABLED
</pre>
<p>If the capture process is disabled, then try restarting it. If the capture process is aborted, then you might need to correct an error before you can restart it successfully.</p>
<p>To determine why the capture process aborted, query the <code>DBA_CAPTURE</code> data dictionary view or check the trace file for the capture process. The following query shows when the capture process aborted and the error that caused it to abort:</p>
<pre>
COLUMN CAPTURE_NAME HEADING 'Capture|Process|Name' FORMAT A10
COLUMN STATUS_CHANGE_TIME HEADING 'Abort Time'
COLUMN ERROR_NUMBER HEADING 'Error Number' FORMAT 99999999
COLUMN ERROR_MESSAGE HEADING 'Error Message' FORMAT A40

SELECT CAPTURE_NAME, STATUS_CHANGE_TIME, ERROR_NUMBER, ERROR_MESSAGE
  FROM DBA_CAPTURE WHERE STATUS='ABORTED';
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mcap.htm#i1006296">"Starting a Capture Process"</a></p>
</li>
<li>
<p><a href="strms_trouble.htm#i1007184">"Checking the Trace Files and Alert Log for Problems"</a></p>
</li>
<li>
<p><a href="ap_other.htm#i1006602">"Capture Processes and Oracle Real Application Clusters"</a> for information about restarting a capture process in an Oracle Real Application Clusters (Oracle RAC) environment</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CEGHAHHA"></a>
<div id="STRMS1031" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Is the Capture Process Waiting for Redo?</h3>
<p>If an enabled capture process is not capturing changes as expected, then the capture process might be in <code>WAITING</code> <code>FOR</code> <code>REDO</code> state.</p>
<p>To check the state of each capture process in a database, run the following query:</p>
<pre>
COLUMN CAPTURE_NAME HEADING 'Capture Name' FORMAT A30
COLUMN STATE HEADING 'State' FORMAT A30
 
SELECT CAPTURE_NAME, STATE FROM V$STREAMS_CAPTURE;
</pre>
<p>If the capture process state is <code>WAITING</code> <code>FOR</code> <code>REDO</code>, then the capture process is waiting for new redo log files to be added to the capture process session. This state is possible if a redo log file is missing or if there is no activity at a source database. For a downstream capture process, this state is possible if the capture process is waiting for new log files to be added to its session.</p>
<p>Additional information might be displayed along with the state information when you query the <code>V$STREAMS_CAPTURE</code> view. The additional information can help you to determine why the capture process is waiting for redo. For example, a statement similar to the following might appear for the <code>STATE</code> column when you query the view:</p>
<pre>
WAITING FOR REDO: LAST SCN MINED 8077284
</pre>
<p>In this case, the output only identifies the last system change number (SCN) scanned by the capture process. In other cases, the output might identify the redo log file name explicitly. Either way, the additional information can help you identify the redo log file for which the capture process is waiting. To correct the problem, make any missing redo log files available to the capture process.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1009976">"Is a Downstream Capture Process Waiting for Redo Data?"</a></div>
</div>
<!-- class="sect2" -->
<a id="CEGDDCHH"></a>
<div id="STRMS1032" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Is the Capture Process Paused for Flow Control?</h3>
<p>If an enabled capture process is not capturing changes as expected, then the capture process might be in <code>PAUSED</code> <code>FOR</code> <code>FLOW</code> <code>CONTROL</code> state.</p>
<p>To check the state of each capture process in a database, run the following query:</p>
<pre>
COLUMN CAPTURE_NAME HEADING 'Capture Name' FORMAT A30
COLUMN STATE HEADING 'State' FORMAT A30
 
SELECT CAPTURE_NAME, STATE FROM V$STREAMS_CAPTURE;
</pre>
<p>If the capture process state is <code>PAUSED</code> <code>FOR</code> <code>FLOW</code> <code>CONTROL</code>, then the capture process cannot enqueue logical change records (LCRs) either because of low memory or because propagations and apply processes are consuming messages at a slower rate than the capture process is creating them. This state indicates flow control that is used to reduce the spilling of captured LCRs when propagation or apply has fallen behind or is unavailable.</p>
<p>If a capture process is in this state, then check for the following issues:</p>
<ul>
<li>
<p>An apply process is disabled or is performing slowly.</p>
</li>
<li>
<p>A propagation is disabled or is performing poorly.</p>
</li>
<li>
<p>There is not enough memory in the Streams pool.</p>
</li>
</ul>
<p>You can query the <code>V$STREAMS_APPLY_READER</code> view to monitor the LCRs being received by the apply process. You can also query <code>V$STREAMS_APPLY_SERVER</code> view to determine whether all apply servers are applying LCRs and executing transactions.</p>
<p>Also, you can query the <code>PUBLISHER_STATE</code> column in the <code>V$BUFFERED_PUBLISHERS</code> view to determine the exact reason why the capture process is paused for flow control.</p>
<p>To correct the problem, perform one or more of the following actions:</p>
<ul>
<li>
<p>If any propagation or apply process is disabled, then enable the propagation or apply process.</p>
</li>
<li>
<p>If the apply reader is not receiving data fast enough, then try removing propagation and apply process rules or simplifying the rule conditions.</p>
</li>
<li>
<p>If there is not enough memory in the Streams pool at the capture process database, then try increasing the size of the Streams pool.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_mprop.htm#g1025168">Chapter 16, "Managing Staging and Propagation"</a></p>
</li>
<li>
<p><a href="strms_mapply.htm#g1026098">Chapter 17, "Managing Oracle Streams Information Consumption"</a></p>
</li>
<li>
<p><a href="strms_adcca.htm#BGBJBDHJ">Chapter 12, "Combined Capture and Apply Optimization"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1006193"></a>
<div id="STRMS1033" class="sect2">
<h3 class="sect2">Is the Capture Process Current?<a id="sthref1351"></a><a id="sthref1352"></a><a id="sthref1353"></a></h3>
<p>If a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> has not captured recent changes, then the cause might be that the capture process has fallen behind. To check, you can query the <code>V$STREAMS_CAPTURE</code> dynamic performance view. If capture process latency is high, then you might be able to improve performance by adjusting the setting of the <code>parallelism</code> capture process parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_cpmon.htm#i1006631">"Determining Redo Log Scanning Latency for Each Capture Process"</a></p>
</li>
<li>
<p><a href="strms_cpmon.htm#i1006661">"Determining Message Enqueuing Latency for Each Capture Process"</a></p>
</li>
<li>
<p><a href="strms_capture.htm#i1006718">"Capture Process Subcomponents"</a></p>
</li>
<li>
<p><a href="strms_mcap.htm#i1006402">"Setting a Capture Process Parameter"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1010961"></a>
<div id="STRMS1034" class="sect2">
<h3 class="sect2">Are Required Redo Log Files Missing?<a id="sthref1354"></a><a id="sthref1355"></a></h3>
<p>When a <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a> is started or restarted, it might need to scan redo log files that were generated before the log file that contains the <a href="strms_glossary.htm#CHDIJJCD"><span class="xrefglossterm">start SCN</span></a>. You can query the <code>DBA_CAPTURE</code> data dictionary view to determine the <a href="strms_glossary.htm#CHDCJHGI"><span class="xrefglossterm">first SCN</span></a> and start SCN for a capture process. Removing required redo log files before they are scanned by a capture process causes the capture process to abort and results in the following error in a capture process trace file:</p>
<pre>
ORA-01291: missing logfile
</pre>
<p>If you see this error, then try restoring any missing redo log files and restarting the capture process. You can check the <code>V$LOGMNR_LOGS</code> dynamic performance view to determine the missing SCN range, and add the relevant redo log files. A capture process needs the redo log file that includes the <a href="strms_glossary.htm#CHDJHFCB"><span class="xrefglossterm">required checkpoint SCN</span></a> and all subsequent redo log files. You can query the <code>REQUIRED_CHECKPOINT_SCN</code> column in the <code>DBA_CAPTURE</code> data dictionary view to determine the required checkpoint SCN for a capture process.</p>
<p><a id="sthref1356"></a><a id="sthref1357"></a><a id="sthref1358"></a>If you are using the fast recovery area feature of Recovery Manager (RMAN) on a <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> in an Oracle Streams environment, then RMAN might delete archived redo log files that are required by a capture process. RMAN might delete these files when the disk space used by the recovery-related files is nearing the specified disk quota for the fast recovery area. To prevent this problem in the future, complete one or more of the following actions:</p>
<ul>
<li>
<p>Increase the disk quota for the fast recovery area. Increasing the disk quota makes it less likely that RMAN will delete a required archived redo log file, but it will not always prevent the problem.</p>
</li>
<li>
<p>Configure the source database to store archived redo log files in a location other than the fast recovery area. A <a href="strms_glossary.htm#CHDDGCGH"><span class="xrefglossterm">local capture process</span></a> will be able to use the log files in the other location if the required log files are missing in the fast recovery area. In this case, a database administrator must manage the log files manually in the other location.</p>
</li>
</ul>
<p>RMAN always ensures that archived redo log files are backed up before it deletes them. If RMAN deletes an archived redo log file that is required by a capture process, then RMAN records this action in the alert log.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_adcapture.htm#i1007010">"ARCHIVELOG Mode and a Capture Process"</a></p>
</li>
<li>
<p><a href="strms_capture.htm#i1009464">"First SCN and Start SCN"</a></p>
</li>
<li>
<p><a href="strms_cpmon.htm#i1012129">"Displaying the Registered Redo Log Files for Each Capture Process"</a></p>
</li>
<li>
<p><a class="olink BRADV8183" href="../../backup.112/e10642/rcmconfb.htm#BRADV8183"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for more information about the fast recovery area feature</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1009976"></a>
<div id="STRMS176" class="sect2">
<h3 class="sect2">Is a Downstream Capture Process Waiting for Redo Data?</h3>
<p>If a <a href="strms_glossary.htm#CHDHEBHD"><span class="xrefglossterm">downstream capture process</span></a> is not capturing changes, then it might be waiting for redo data to scan. Redo log files can be registered implicitly or explicitly for a downstream capture process. Redo log files registered implicitly typically are registered in one of the following ways:</p>
<ul>
<li>
<p>For a <a href="strms_glossary.htm#CBAJHHEI"><span class="xrefglossterm">real-time downstream capture process</span></a>, redo transport services use the log writer process (LGWR) to transfer the redo data from the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> to the standby redo log at the <a href="strms_glossary.htm#CHDBJECA"><span class="xrefglossterm">downstream database</span></a>. Next, the archiver at the downstream database registers the redo log files with the downstream capture process when it archives them.</p>
</li>
<li>
<p>For an <a href="strms_glossary.htm#CBAFGBGE"><span class="xrefglossterm">archived-log downstream capture process</span></a>, redo transport services transfer the archived redo log files from the source database to the downstream database and register the archived redo log files with the downstream capture process.</p>
</li>
</ul>
<p>If redo log files are registered explicitly for a downstream capture process, then you must manually transfer the redo log files to the downstream database and register them with the downstream capture process.</p>
<p>Regardless of whether the redo log files are registered implicitly or explicitly, the downstream capture process can capture changes made to the source database only if the appropriate redo log files are registered with the downstream capture process. You can query the <code>V$STREAMS_CAPTURE</code> dynamic performance view to determine whether a downstream capture process is waiting for a redo log file. For example, run the following query for a downstream capture process named <code>strm05_capture</code>:</p>
<pre>
SELECT STATE FROM V$STREAMS_CAPTURE WHERE CAPTURE_NAME='STRM05_CAPTURE';
</pre>
<p>If the capture process state is either <code>WAITING</code> <code>FOR</code> <code>DICTIONARY</code> <code>REDO</code> or <code>WAITING</code> <code>FOR</code> <code>REDO</code>, then verify that the redo log files have been registered with the downstream capture process by querying the <code>DBA_REGISTERED_ARCHIVED_LOG</code> and <code>DBA_CAPTURE</code> data dictionary views. For example, the following query lists the redo log files currently registered with the <code>strm05_capture</code> downstream capture process:</p>
<pre>
COLUMN SOURCE_DATABASE HEADING 'Source|Database' FORMAT A15
COLUMN SEQUENCE# HEADING 'Sequence|Number' FORMAT 9999999
COLUMN NAME HEADING 'Archived Redo Log|File Name' FORMAT A30
COLUMN DICTIONARY_BEGIN HEADING 'Dictionary|Build|Begin' FORMAT A10
COLUMN DICTIONARY_END HEADING 'Dictionary|Build|End' FORMAT A10

SELECT r.SOURCE_DATABASE,
       r.SEQUENCE#, 
       r.NAME, 
       r.DICTIONARY_BEGIN, 
       r.DICTIONARY_END 
  FROM DBA_REGISTERED_ARCHIVED_LOG r, DBA_CAPTURE c
  WHERE c.CAPTURE_NAME = 'STRM05_CAPTURE' AND 
        r.CONSUMER_NAME = c.CAPTURE_NAME;
</pre>
<p>If this query does not return any rows, then no redo log files are registered with the capture process currently. If you configured redo transport services to transfer redo data from the source database to the downstream database for this capture process, then ensure that the redo transport services are configured correctly. If the redo transport services are configured correctly, then run the <code>ALTER</code> <code>SYSTEM</code> <code>ARCHIVE</code> <code>LOG</code> <code>CURRENT</code> statement at the source database to archive a log file. If you did not configure redo transport services to transfer redo data, then ensure that the method you are using for log file transfer and registration is working properly. You can register log files explicitly using an <code>ALTER</code> <code>DATABASE</code> <code>REGISTER</code> <code>LOGICAL</code> <code>LOGFILE</code> statement.</p>
<p>If the downstream capture process is waiting for redo, then it also is possible that there is a problem with the network connection between the source database and the downstream database. There also might be a problem with the log file transfer method. Check your network connection and log file transfer method to ensure that they are working properly.</p>
<p>If you configured a real-time downstream capture process, and no redo log files are registered with the capture process, then try switching the log file at the source database. You might need to switch the log file more than once if there is little or no activity at the source database.</p>
<p>Also, if you plan to use a downstream capture process to capture changes to historical data, then consider the following additional issues:</p>
<ul>
<li>
<p>Both the source database that generates the redo log files and the database that runs a downstream capture process must be Oracle Database 10<span class="italic">g</span> or later databases.</p>
</li>
<li>
<p>The start of a data dictionary build must be present in the oldest redo log file added, and the capture process must be configured with a <a href="strms_glossary.htm#CHDCJHGI"><span class="xrefglossterm">first SCN</span></a> that matches the start of the data dictionary build.</p>
</li>
<li>
<p>The database objects for which the capture process will capture changes must be prepared for <a href="strms_glossary.htm#CHDCCEJE"><span class="xrefglossterm">instantiation</span></a> at the source database, not at the downstream database. In addition, you cannot specify a time in the past when you prepare objects for instantiation. Objects are always prepared for instantiation at the current database SCN, and only changes to a database object that occurred after the object was prepared for instantiation can be captured by a capture process.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_capture.htm#i1013269">"Local Capture and Downstream Capture"</a></p>
</li>
<li>
<p><a href="strms_capture.htm#i1014290">Capture Process States</a></p>
</li>
<li>
<p><a class="olink STREP209" href="../../server.112/e10705/ccap.htm#STREP209"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring a capture process</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i1010814"></a>
<div id="STRMS1035" class="sect2">
<h3 class="sect2">Are You Trying to Configure Downstream Capture Incorrectly?<a id="sthref1359"></a></h3>
<p>To create a <a href="strms_glossary.htm#CHDHEBHD"><span class="xrefglossterm">downstream capture process</span></a>, you must use one of the following procedures:</p>
<ul>
<li>
<p><code>DBMS_CAPTURE_ADM.CREATE_CAPTURE</code></p>
</li>
<li>
<p><code>DBMS_STREAMS_ADM.MAINTAIN_GLOBAL</code></p>
</li>
<li>
<p><code>DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS</code></p>
</li>
<li>
<p><code>DBMS_STREAMS_ADM.MAINTAIN_SIMPLE_TTS</code></p>
</li>
<li>
<p><code>DBMS_STREAMS_ADM.MAINTAIN_TABLES</code></p>
</li>
<li>
<p><code>DBMS_STREAMS_ADM.MAINTAIN_TTS</code></p>
</li>
<li>
<p><code>PRE_INSTANTIATION_SETUP</code> and <code>POST_INSTANTIATION_SETUP</code> in the <code>DBMS_STREAMS_ADM</code> package</p>
</li>
</ul>
<p>The procedures in the <code>DBMS_STREAMS_ADM</code> package can configure a downstream capture process as well as the other Oracle Streams components in an Oracle Streams replication environment.</p>
<p>If you try to create a downstream capture process without using one of these procedures, then Oracle returns the following error:</p>
<pre>
ORA-26678: Streams capture process must be created first
</pre>
<p>To correct the problem, use one of these procedures to create the downstream capture process.</p>
<p>If you are trying to create a <a href="strms_glossary.htm#CHDDGCGH"><span class="xrefglossterm">local capture process</span></a> using a procedure in the <code>DBMS_STREAMS_ADM</code> package, and you encounter this error, then make sure the database name specified in the <code>source_database</code> parameter of the procedure you are running matches the global name of the local database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STREP209" href="../../server.112/e10705/ccap.htm#STREP209"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring a capture process</div>
</div>
<!-- class="sect2" -->
<a id="CACDHFHB"></a>
<div id="STRMS1036" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Are You Trying to Configure Downstream Capture without Proper Authentication?</h3>
<p>If authentication is not configured properly between the source database and the downstream capture database, redo data transfer fails with one of the following errors:</p>
<pre>
ORA-16191: Primary log shipping client not logged on standby
 
ORA-1017: Invalid username/password; login denied
</pre>
<p>Redo transport sessions are authenticated using either the Secure Sockets Layer (SSL) protocol or a remote login password file. The password file must be the same at the source database and the downstream capture database.</p>
<p>To correct the problem, perform one of the following actions:</p>
<ul>
<li>
<p>If the source database has a remote login password file, then copy it to the appropriate directory on the downstream capture database system. After copying the file, you might need to restart both databases for the change to take effect.</p>
</li>
<li>
<p>Turn off the case sensitivity option by setting the initialization parameter <code>SEC_CASE_SENSITIVE_LOGON</code> to <code>FALSE</code>. Next, create the password file on the source and downstream capture database systems using <code>ORAPWD</code>. Make sure the password is the same on both systems, and set the <code>ignorecase</code> argument to&nbsp;<code>Y</code>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SBYDB00424" href="../../server.112/e41134/create_ps.htm#SBYDB00424"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for detailed information about authentication requirements for redo transport</div>
</div>
<!-- class="sect2" -->
<a id="i1011046"></a>
<div id="STRMS1037" class="sect2">
<h3 class="sect2">Are More Actions Required for Downstream Capture without a Database Link?</h3>
<p>When downstream capture is configured with a database link, the database link can be used to perform operations at the <a href="strms_glossary.htm#CHDHFBJG"><span class="xrefglossterm">source database</span></a> and obtain information from the source database automatically. When downstream capture is configured without a database link, these actions must be performed manually, and the information must be obtained manually. If you do not complete these actions manually, then errors result when you try to create the downstream <a href="strms_glossary.htm#CHDBHECD"><span class="xrefglossterm">capture process</span></a>.</p>
<p>Specifically, the following actions must be performed manually when you configure downstream capture without a database link:</p>
<ul>
<li>
<p>In certain situations, you must run the <code>DBMS_CAPTURE_ADM.BUILD</code> procedure at the source database to extract the data dictionary at the source database to the redo log before a capture process is created.</p>
</li>
<li>
<p>You must prepare the source database objects for <a href="strms_glossary.htm#CHDCCEJE"><span class="xrefglossterm">instantiation</span></a>.</p>
</li>
<li>
<p>You must obtain the <a href="strms_glossary.htm#CHDCJHGI"><span class="xrefglossterm">first SCN</span></a> for the <a href="strms_glossary.htm#CHDHEBHD"><span class="xrefglossterm">downstream capture process</span></a> and specify the first SCN using the <code>first_scn</code> parameter when you create the capture process with the <code>CREATE_CAPTURE</code> procedure in the <code>DBMS_CAPTURE_ADM</code> package.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink STREP209" href="../../server.112/e10705/ccap.htm#STREP209"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring a capture process</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACJBFJH"></a>
<div id="STRMS1038" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Troubleshooting Synchronous Capture Problems</h2>
<p>If a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a> is not capturing changes as expected, then use this section to identify and resolve synchronous capture problems.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_capture.htm#CACIDGBI">"Implicit Capture with Synchronous Capture"</a></p>
</li>
<li>
<p><a class="olink STREP208" href="../../server.112/e10705/ccap.htm#STREP208"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for information about configuring synchronous capture</p>
</li>
<li>
<p><a href="strms_mcap.htm#BEHJAHDA">"Managing a Synchronous Capture"</a></p>
</li>
<li>
<p><a href="strms_cpmon.htm#CFFGCIJJ">"Monitoring a Synchronous Capture"</a></p>
</li>
</ul>
</div>
<a id="CACGFHGH"></a>
<div id="STRMS1039" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Is a Synchronous Capture Failing to Capture Changes to Tables?</h3>
<p>If a <a href="strms_glossary.htm#CBACHEDJ"><span class="xrefglossterm">synchronous capture</span></a> is not capturing changes to tables as you expected, then the <a href="strms_glossary.htm#CHDIFFCF"><span class="xrefglossterm">rule</span></a>s in the synchronous capture <a href="strms_glossary.htm#CHDCHGGB"><span class="xrefglossterm">rule set</span></a> might not be configured properly. To avoid problems, always use the <code>ADD_TABLE_RULES</code> or <code>ADD_SUBSET_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to add rules to a synchronous capture rules set.</p>
<p>The following are common reasons why a synchronous capture is not capturing changes as expected:</p>
<ul>
<li>
<p>Global rules or schema rules are being used to try to control the behavior of the synchronous capture. A synchronous capture ignores <a href="strms_glossary.htm#CHDEJCHD"><span class="xrefglossterm">global rule</span></a>s and <a href="strms_glossary.htm#CHDFAGCF"><span class="xrefglossterm">schema rule</span></a>s in its rule set. A synchronous capture only captures changes that satisfy <a href="strms_glossary.htm#CHDEGGGH"><span class="xrefglossterm">table rule</span></a>s and <a href="strms_glossary.htm#CHDBCGAG"><span class="xrefglossterm">subset rule</span></a>s.</p>
</li>
<li>
<p>The <code>DBMS_RULE_ADM</code> package was used to configure the rules for a synchronous capture. A synchronous capture does not behave correctly when</p>
<ul>
<li>
<p>The <code>DBMS_RULE_ADM</code> package is used to create rules that are added to a synchronous capture rule set.</p>
</li>
<li>
<p>The <code>DBMS_RULE_ADM</code> package is used to add rules to a synchronous capture rule set.</p>
</li>
</ul>
</li>
</ul>
<p>If a synchronous capture is not capturing changes to tables as expected, then complete the following steps to identify and correct problems:</p>
<ol>
<li>
<p>Query the <code>DBA_SYNC_CAPTURE_TABLES</code> data dictionary view to determine the tables for which a synchronous capture is capturing changes. The synchronous capture captures changes to a table only if the <code>ENABLED</code> column is set to <code>YES</code> for the table.</p>
</li>
<li>
<p>If the <code>DBA_SYNC_CAPTURE_TABLES</code> view does not list tables for which a synchronous capture should capture changes, then use the <code>ADD_TABLE_RULES</code> or <code>ADD_SUBSET_RULES</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to add rules for the tables.</p>
</li>
</ol>
<p>If the <code>DBA_SYNC_CAPTURE_TABLES</code> view shows <code>ENABLED</code> for a table, and a synchronous capture still does not capture changes to the table, then there might be a problem with the rule condition in the rule for the table. In this case, check the rule condition and correct any errors, or drop the rule and re-create it using the <code>ADD_TABLE_RULES</code> or <code>ADD_SUBSET_RULES</code> procedure.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle recommends that you use the <code>REMOVE_RULE</code> procedure in the <code>DBMS_STREAMS_ADM</code> package to remove a rule from a synchronous capture rule set or drop a rule used by synchronous capture. However, you can also use the <code>REMOVE_RULE</code> or <code>DROP_RULE</code> procedure in the <code>DBMS_RULE_ADM</code> package to perform these actions.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="strms_cpmon.htm#CFFHGGFH">"Displaying the Tables For Which Synchronous Capture Captures Changes"</a></p>
</li>
<li>
<p><a href="strms_mcap.htm#BEHDCGAJ">"Adding Rules to a Rule Set for a Synchronous Capture"</a></p>
</li>
<li>
<p><a href="strms_rumon.htm#i1008394">"Displaying the Condition for Each Rule in a Rule Set"</a></p>
</li>
<li>
<p><a href="strms_mcap.htm#BEHICDDC">"Removing a Rule from a Rule Set for a Synchronous Capture"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1624">
<tr>
<td class="cellalignment1631">
<table class="cellalignment1629">
<tr>
<td class="cellalignment1628"><a href="strms_trouble.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1628"><a href="strms_trprop.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1633">
<table class="cellalignment1627">
<tr>
<td class="cellalignment1628"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1628"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1628"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1628"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1628"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1628"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
