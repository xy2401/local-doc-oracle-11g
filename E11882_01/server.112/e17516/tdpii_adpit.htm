<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Administering a Materialized View Replication Environment</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 033" />
<meta name="dcterms.created" content="2011-07-28T22:40:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database 2 Day + Data Replication and Integration Guide" />
<meta name="dcterms.identifier" content="E17516-08" />
<meta name="dcterms.isVersionOf" content="TDPII" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="tdpii_reppit.htm" title="Previous" type="text/html" />
<link rel="Next" href="tdpii_messaging.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17516.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">11/14</span> <!-- End Header --><a id="BABFHCBC"></a><a id="TDPII061"></a>
<h1 class="chapter"><span class="secnum">8</span> Administering a Materialized View Replication Environment</h1>
<p><a id="sthref542"></a><a id="sthref543"></a>This chapter describes how to manage, monitor, and troubleshoot a materialized view replication environment.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#CIHCJIBF">Managing a Materialized View Replication Environment</a></p>
</li>
<li>
<p><a href="#CIHJBJJC">Monitoring a Materialized View Replication Environment</a></p>
</li>
<li>
<p><a href="#CIHHICBI">Troubleshooting a Materialized View Replication Environment</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHHGGIB">Chapter 7, "Replicating Data Using Materialized Views"</a></p>
</li>
<li>
<p><a href="tdpii_intro2ii.htm#CFHHDHIJ">Chapter 1, "Introduction to Data Replication and Integration"</a></p>
</li>
</ul>
</div>
<a id="CIHCJIBF"></a><a id="TDPII062"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing a Materialized View Replication Environment<a id="sthref544"></a></h2>
<p>After materialized views are configured, they can be refreshed to synchronize them with their master tables. This section includes instructions for refreshing materialized views and adding materialized views to a refresh group.</p>
<p>Sometimes, materialized views are no longer needed at a materialized view site. This section also includes information about dropping materialized views and cleaning up materialized view support at a master site.</p>
<p>The following topics describe managing a materialized view replication environment:</p>
<ul>
<li>
<p><a href="#BABEDJGH">Refreshing Materialized Views</a></p>
</li>
<li>
<p><a href="#BABGEEHA">Adding Materialized Views to a Refresh Group</a></p>
</li>
<li>
<p><a href="#BABJIDJJ">Dropping a Materialized View</a></p>
</li>
<li>
<p><a href="#BABHFCEE">Tutorial: Cleaning Up Materialized View Support at a Master Site</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CIHJBJJC">"Monitoring a Materialized View Replication Environment"</a></p>
</li>
<li>
<p><a href="#CIHHICBI">"Troubleshooting a Materialized View Replication Environment"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHHGGIB">Chapter 7, "Replicating Data Using Materialized Views"</a></p>
</li>
</ul>
</div>
<a id="BABEDJGH"></a><a id="TDPII108"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Refreshing Materialized Views<a id="sthref545"></a><a id="sthref546"></a></h3>
<p>Refreshing materialized views synchronizes them with their master tables. Changes made to a master table since the last refresh of a materialized view are applied to the materialized view during refresh. If a materialized view is updatable, then changes made to the materialized view since its last refresh are also applied to the master table during refresh.</p>
<p>If a group of materialized views is used for a specific purpose, such as an application, then it is usually best to place these materialized views in a refresh group. When you refresh the refresh group, the materialized views in the refresh group are refreshed to a consistent point in time. You can also refresh materialized views individually, but then the materialized views are not consistent to a point in time.</p>
<p>The following topics describe refreshing materialized views:</p>
<ul>
<li>
<p><a href="#BABGBBIJ">Refreshing a Refresh Group</a></p>
</li>
<li>
<p><a href="#BABDECCF">Refreshing a Materialized View</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a></p>
</li>
</ul>
</div>
<a id="BABGBBIJ"></a><a id="TDPII109"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Refreshing a Refresh Group<a id="sthref547"></a><a id="sthref548"></a></h4>
<p>When you refresh a refresh group, all of the materialized views in the refresh group are refreshed to a consistent point in time.</p>
<p class="orderedlisttitle">To refresh a refresh group:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Refresh Groups in the Materialized View Site section.</p>
</li>
<li>
<p>On the Refresh Groups page, use the search tool to list the refresh group to refresh.</p>
</li>
<li>
<p>Select the refresh group in the list.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
<p>The Edit Refresh Group page appears, showing the General subpage.</p>
<img width="652" height="461" src="img/tdpii_edit_ref_grp.gif" alt="Description of tdpii_edit_ref_grp.gif follows" /><br />
<a id="sthref550" href="img_text/tdpii_edit_ref_grp.htm">Description of the illustration tdpii_edit_ref_grp.gif</a><br />
<br /></li>
<li>
<p>Click <span class="bold">Refresh Now</span> in the Refresh section.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also use the following procedures in the <a class="olink REPMA018" href="../../server.112/e10707/rarrefreshpac.htm#REPMA018"><code>DBMS_REFRESH.REFRESH</code></a> procedure to refresh a refresh group.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#CHDJEFDH">"Configuring a Refresh Group"</a></p>
</li>
<li>
<p><a href="#BABBJIBF">"Viewing Information About Refresh Groups"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="BABDECCF"></a><a id="TDPII110"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Refreshing a Materialized View</h4>
<p>Refreshing a materialized view makes it consistent with its master table. If the materialized view is part of a refresh group, then it is usually best to refresh the refresh group instead of the materialized view individually. Refreshing the refresh group ensures that all of the materialized views in the refresh group are consistent to a point in time.</p>
<p class="orderedlisttitle">To refresh a materialized view:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Materialized Views in the Materialized View Site section.</p>
</li>
<li>
<p>On the Materialized Views page, use the search tool to list the materialized view to refresh.</p>
<p>To list all materialized views, leave the Schema and Object Name fields blank and click <span class="bold">Go</span>.</p>
</li>
<li>
<p>Select the materialized view in the list.</p>
<img width="900" height="424" src="img/tdpii_mvs.gif" alt="Description of tdpii_mvs.gif follows" /><br />
<a id="sthref552" href="img_text/tdpii_mvs.htm">Description of the illustration tdpii_mvs.gif</a><br />
<br /></li>
<li>
<p>Select <span class="bold">Refresh</span> in the Actions list.</p>
</li>
<li>
<p>Click <span class="bold">Go</span> to open the Refresh Materialized View page for the selected materialized view.</p>
<img width="666" height="513" src="img/tdpii_refresh_mv.gif" alt="Description of tdpii_refresh_mv.gif follows" /><br />
<a id="sthref553" href="img_text/tdpii_refresh_mv.htm">Description of the illustration tdpii_refresh_mv.gif</a><br />
<br /></li>
<li>
<p>Adjust the options if necessary.</p>
<p>Typically, you can use the default values.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>On the confirmation page, click <span class="bold">Yes</span> to refresh the materialized view.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also use the <a class="olink ARPLS027" href="../../appdev.112/e40758/d_mview.htm#ARPLS027"><code>DBMS_MVIEW.REFRESH</code></a> procedure to refresh a materialized view.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABGEEHA"></a><a id="TDPII115"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Adding Materialized Views to a Refresh Group<a id="sthref554"></a><a id="sthref555"></a><a id="sthref556"></a><a id="sthref557"></a></h3>
<p>When two or more materialized views must be consistent to a point in time, the materialized views should belong to the same refresh group.</p>
<p class="orderedlisttitle">To add materialized views to a refresh group:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Refresh Groups in the Materialized View Site section.</p>
</li>
<li>
<p>On the Refresh Groups page, use the search tool to list the refresh group to modify.</p>
</li>
<li>
<p>Select the refresh group.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
</li>
<li>
<p>On the Edit Refresh Group page, click <span class="bold">Materialized Views</span>.</p>
</li>
<li>
<p>On the Materialized Views subpage, click <span class="bold">Add</span>.</p>
</li>
<li>
<p>On the Search and Select: Materialized View page, use the search tool to list the materialized views to add to the refresh group.</p>
<img width="710" height="364" src="img/tdpii_select_mv.gif" alt="Description of tdpii_select_mv.gif follows" /><br />
<a id="sthref559" href="img_text/tdpii_select_mv.htm">Description of the illustration tdpii_select_mv.gif</a><br />
<br /></li>
<li>
<p>Select the materialized views to add to the refresh group.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>On the Edit Refresh Group page, click <span class="bold">Apply</span> to finish adding the materialized views to the refresh group.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also use the <a class="olink REPMA018" href="../../server.112/e10707/rarrefreshpac.htm#REPMA018"><code>DBMS_REFRESH.ADD</code></a> procedure to add materialized views to a refresh group.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
<li>
<p><a href="#BABGBBIJ">"Refreshing a Refresh Group"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#CHDJEFDH">"Configuring a Refresh Group"</a></p>
</li>
<li>
<p><a href="#BABBJIBF">"Viewing Information About Refresh Groups"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABJIDJJ"></a><a id="TDPII113"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Dropping a Materialized View<a id="sthref560"></a></h3>
<p>When a materialized view is no longer needed at a materialized view site, you can drop the materialized view. If possible, then you should drop the materialized view when the materialized view site can connect to the master site. Information about the materialized view is removed automatically from the master site when a network connection is established.</p>
<p>If you must drop a materialized view when the materialized view site cannot connect to the master site, then information about the materialized view must be removed from the master site manually. See <a href="#BABHFCEE">"Tutorial: Cleaning Up Materialized View Support at a Master Site"</a> to learn how to remove this information after you drop the materialized view.</p>
<p class="orderedlisttitle">To drop a materialized view:&nbsp;</p>
<ol>
<li>
<p>On Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Materialized Views in the Materialized View Site section.</p>
</li>
<li>
<p>On the Materialized Views page, use the search tool to list the materialized view to drop.</p>
<p>To list all materialized views, leave the Schema and Object Name fields blank and click <span class="bold">Go</span>.</p>
</li>
<li>
<p>Select the materialized view in the list.</p>
<img width="900" height="424" src="img/tdpii_mvs.gif" alt="Description of tdpii_mvs.gif follows" /><br />
<a id="sthref562" href="img_text/tdpii_mvs.htm">Description of the illustration tdpii_mvs.gif</a><br />
<br /></li>
<li>
<p>Click <span class="bold">Delete</span>.</p>
</li>
<li>
<p>On the confirmation page, click <span class="bold">Yes</span> to delete the materialized view.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also use the <a class="olink SQLRF01523" href="../../server.112/e41084/statements_8021.htm#SQLRF01523"><code>DROP</code> <code>MATERIALIZED</code> <code>VIEW</code></a> SQL statement to drop a materialized view.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHHAHHA">"About Materialized View Replication"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABHFCEE"></a><a id="TDPII107"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Tutorial: Cleaning Up Materialized View Support at a Master Site<a id="sthref563"></a><a id="sthref564"></a><a id="sthref565"></a></h3>
<p>If you dropped a materialized view while the materialized view site was not connected to the master site over the network, then you should clean up materialized view support at the master site. Cleaning up materialized view support includes the following actions:</p>
<ul>
<li>
<p>Unregistering the materialized view</p>
<p>Unregistering the materialized view removes information about the materialized view in the data dictionary at the master site.</p>
</li>
<li>
<p>Either purging the materialized view log or dropping the materialized view log</p>
<p>If the master table for the materialized view is the master table for other materialized views, then you should purge the materialized view log of information for the materialized view that was dropped. If the master table for the materialized view is not a master table for any other materialized views, then you can drop the materialized view log.</p>
</li>
</ul>
<p>Oracle Database automatically tracks which rows in a materialized view log have been used during the refreshes of materialized views, and purges these rows from the log so that the log size does not increase endlessly. Because multiple materialized views can use the same materialized view log, rows already used to refresh one materialized view might still be needed to refresh another materialized view. Oracle Database does not delete rows from the log until all materialized views have used them. If you drop a materialized view without cleaning up the master site, then the materialized view log for the materialized view can become very large.</p>
<p>The example in this topic cleans up the following materialized view support:</p>
<ul>
<li>
<p>The master site is <code>ii1.example.com</code>.</p>
</li>
<li>
<p>The materialized view site is <code>ii2.example.com</code>.</p>
</li>
<li>
<p>The name of the materialized view is <code>employees_mvr</code>.</p>
</li>
<li>
<p>The owner of the materialized view is <code>hr</code>.</p>
</li>
</ul>
<p class="orderedlisttitle">To clean up support for this materialized view at the master site:&nbsp;</p>
<ol>
<li>
<p>On a command line, open SQL*Plus and connect to the master site <code>ii1.example.com</code> as an administrative user, such as the replication administrator or <code>SYSTEM</code>. By default, the user name of the replication administrator is <code>repadmin</code>.</p>
<p>See <a class="olink ADMQS0361" href="../../server.112/e10897/em_manage.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.</p>
</li>
<li>
<p>Either purge or drop the materialized view log for the master table of the materialized view:</p>
<ul>
<li>
<p><a id="sthref567"></a>If the master table is also the master table for other materialized views in addition to the one that was dropped, then purge the materialized view log of information for the materialized view that was dropped:</p>
<pre>
BEGIN
   DBMS_MVIEW.PURGE_MVIEW_FROM_LOG (
      mviewowner =&gt; 'hr',
      mviewname  =&gt; 'employees_mvr', 
      mviewsite  =&gt; 'ii2.example.com');
END;
/
</pre></li>
<li>
<p><a id="sthref568"></a>If the master table is not a master table for any materialized views other than the one that was dropped, then drop the materialized view log on the master table:</p>
<pre>
DROP MATERIALIZED VIEW LOG ON hr.employees;
</pre></li>
</ul>
</li>
<li>
<p><a id="sthref569"></a><a id="sthref570"></a>Unregister the materialized view:</p>
<pre>
BEGIN
   DBMS_MVIEW.UNREGISTER_MVIEW (
      mviewowner =&gt; 'hr',
      mviewname  =&gt; 'employees_mvr',
      mviewsite  =&gt; 'ii2.example.com');
END;
/
</pre></li>
</ol>
<p>If you are not sure about the materialized view owner, name, or materialized view site, then you can query the <a class="olink REFRN20183" href="../../server.112/e40402/statviews_2024.htm#REFRN20183"><code>ALL_REGISTERED_MVIEWS</code></a> data dictionary view to obtain this information.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABJIDJJ">Dropping a Materialized View</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHHAHHA">"About Materialized View Replication"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHJBJJC"></a><a id="TDPII063"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Monitoring a Materialized View Replication Environment<a id="sthref571"></a><a id="sthref572"></a><a id="sthref573"></a></h2>
<p>This section describes using Enterprise Manager and SQL*Plus to view information about a materialized view replication environment. It describes viewing this information at both materialized view sites and master sites.</p>
<p>The following topics describe monitoring a materialized view replication environment:</p>
<ul>
<li>
<p><a href="#BABBAIAF">Viewing an Overview of the Replication Components at a Database</a></p>
</li>
<li>
<p><a href="#BABDEGAE">Viewing Information About Materialized Views</a></p>
</li>
<li>
<p><a href="#BABBBICG">Determining Which Materialized Views Are Currently Refreshing</a></p>
</li>
<li>
<p><a href="#BABHDIJF">Viewing Information About Materialized View Groups</a></p>
</li>
<li>
<p><a href="#BABGFIFJ">Viewing Information About Deferred Transactions for Updatable Materialized Views</a></p>
</li>
<li>
<p><a href="#BABBJIBF">Viewing Information About Refresh Groups</a></p>
</li>
<li>
<p><a href="#BABEDAHG">Viewing Materialized View Logs at a Master Site</a></p>
</li>
<li>
<p><a href="#BABGAHFF">Viewing the Materialized Views for a Master Site</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHHGGIB">Chapter 7, "Replicating Data Using Materialized Views"</a></p>
</li>
<li>
<p><a href="#CIHCJIBF">"Managing a Materialized View Replication Environment"</a></p>
</li>
<li>
<p><a href="#CIHHICBI">"Troubleshooting a Materialized View Replication Environment"</a></p>
</li>
</ul>
</div>
<a id="BABBAIAF"></a><a id="TDPII112"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing an Overview of the Replication Components at a Database<a id="sthref574"></a><a id="sthref575"></a></h3>
<p>The Advanced Replication: Administration page in Enterprise Manager provides an overview of the replication components at a database.</p>
<p class="orderedlisttitle">To view an overview of the replication components at a database:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
</ol>
<img width="868" height="512" src="img/tdpii_adv_rep_main.gif" alt="Description of tdpii_adv_rep_main.gif follows" /><br />
<a id="sthref577" href="img_text/tdpii_adv_rep_main.htm">Description of the illustration tdpii_adv_rep_main.gif</a><br />
<br />
<p>Each replication component is associated with a number that shows the quantity of the component at the current database. Click a number to view more information about these components and to manage these components.</p>
<p>If you are viewing a materialized view site, then you can monitor the following components:</p>
<ul>
<li>
<p><span class="bold">Scheduled Links</span> in the General section shows the number of scheduled links at the materialized view site. Scheduled links are used to push deferred transactions automatically. See <a href="tdpii_reppit.htm#CHDEJIJC">"About Scheduled Links and Deferred Transactions"</a>.</p>
</li>
<li>
<p><span class="bold">Materialized View Groups</span> in the Materialized View Site section shows the number of materialized view groups at the materialized view site. Organizing materialized views into groups makes it easier to manage them. In addition, materialized views must be placed in a materialized view group for them to be updatable. See <a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a> for information about materialized view groups.</p>
</li>
<li>
<p><span class="bold">Materialized Views</span> in the Materialized View Site section shows the number of materialized views at the materialized view site. See <a href="tdpii_reppit.htm#BEHHAHHA">"About Materialized View Replication"</a> for information about materialized views.</p>
</li>
<li>
<p><span class="bold">Refresh Groups</span> in the Materialized View Site section shows the number of refresh groups at the materialized view site. When a refresh group is refreshed, the materialized views in the refresh group are consistent to the same point in time. See <a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a>.</p>
</li>
</ul>
<p>If you are viewing a master site for one or more materialized view sites, then you can monitor the following components:</p>
<ul>
<li>
<p><span class="bold">Master Groups</span> in the Multimaster Replication section shows the number of master groups at the master site. A materialized view group at a materialized view site can be based on a master group. See <a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a> for information about master groups and materialized view groups.</p>
</li>
<li>
<p><span class="bold">Materialized View Logs</span> in the Master Site section shows the number of materialized view logs at a master site. Materialized view logs enable a fast refresh of materialized views. See <a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a> for information about materialized view logs.</p>
</li>
<li>
<p><span class="bold">Error Transactions</span> in the General section shows the number of error transactions at the master site. Error transactions can occur when updatable materialized views are refreshed and conflicts are encountered that cannot be resolved. See <a href="tdpii_reppit.htm#CHDJHGAD">"About Conflicts and Updatable Materialized Views"</a>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHHGGIB">Chapter 7, "Replicating Data Using Materialized Views"</a></p>
</li>
<li>
<p><a href="#CIHCJIBF">"Managing a Materialized View Replication Environment"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABDEGAE"></a><a id="TDPII114"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing Information About Materialized Views<a id="sthref578"></a></h3>
<p>A materialized view contains a complete or partial copy of a table from a single point in time. In a replication environment, a materialized view is typically in a different database than the table on which it is based.</p>
<p class="orderedlisttitle">To view information about materialized views:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Materialized Views in the Materialized View Site section to open the Materialized Views page.</p>
</li>
<li>
<p>Use the search tool to list the materialized views that you want to view. To list all materialized views, leave the Schema and Object Name fields blank and click <span class="bold">Go</span>.</p>
<img width="900" height="424" src="img/tdpii_mvs.gif" alt="Description of tdpii_mvs.gif follows" /><br />
<a id="sthref580" href="img_text/tdpii_mvs.htm">Description of the illustration tdpii_mvs.gif</a><br />
<br />
<p>The Materialized Views page contains important information about each materialized view listed, including its master table, master site (in the Master Link columns), and the last time it was refreshed.</p>
</li>
<li>
<p>For detailed information about a materialized view, select it and click <span class="bold">View</span> to open the View Materialized View page.</p>
</li>
</ol>
<img width="693" height="664" src="img/tdpii_view_mv.gif" alt="Description of tdpii_view_mv.gif follows" /><br />
<a id="sthref581" href="img_text/tdpii_view_mv.htm">Description of the illustration tdpii_view_mv.gif</a><br />
<br />
<p>The View Materialized View page contains detailed information about the materialized view. The information is organized into the following sections: General, Refresh, Storage, Index Storage, Options, and Master Information.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also query the <a class="olink REFRN20139" href="../../server.112/e40402/statviews_1153.htm#REFRN20139"><code>ALL_MVIEWS</code></a> data dictionary view for information about materialized views.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHHAHHA">"About Materialized View Replication"</a></p>
</li>
<li>
<p><a href="#CIHCJIBF">"Managing a Materialized View Replication Environment"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABBBICG"></a><a id="TDPII097"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Determining Which Materialized Views Are Currently Refreshing<a id="sthref582"></a><a id="sthref583"></a></h3>
<p>Refreshing a materialized view synchronizes data in the materialized view with data in its master table. You can query the <a class="olink REFRN30157" href="../../server.112/e40402/dynviews_2070.htm#REFRN30157"><code>V$MVREFRESH</code></a> dynamic performance view to determine which materialized views are currently refreshing.</p>
<p>Before shutting down a database that contains materialized views, it is best to check if any materialized views are currently refreshing. If any materialized views are refreshing, then wait until all of the refreshes are complete before shutting down the database.</p>
<p class="orderedlisttitle">To determine which materialized views at a materialized view site are currently refreshing:&nbsp;</p>
<ol>
<li>
<p>Open SQL*Plus and connect to the materialized view site as the materialized view administrator.</p>
<p>See <a class="olink ADMQS0361" href="../../server.112/e10897/em_manage.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.</p>
</li>
<li>
<p><a id="sthref585"></a>Run the following query:</p>
<pre>
COLUMN CURRMVOWNER HEADING 'Owner' FORMAT A15
COLUMN CURRMVNAME HEADING 'Materialized|View' FORMAT A25
 
SELECT CURRMVOWNER, CURRMVNAME FROM V$MVREFRESH;
</pre>
<p>The output will be similar to the following:</p>
<pre>
<span class="bold">                Materialized</span>
<span class="bold">Owner           View</span>
<span class="bold">--------------- -------------------------</span>
<span class="bold">HR              COUNTRIES_MV</span>
<span class="bold">HR              EMPLOYEES_MV</span>
</pre></li>
</ol>
<p>The <code>V$MVREFRESH</code> dynamic performance view does not contain information about updatable materialized views when the deferred transactions of the materialized views are being pushed to their masters.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="#BABEDJGH">"Refreshing Materialized Views"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABHDIJF"></a><a id="TDPII116"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing Information About Materialized View Groups<a id="sthref586"></a><a id="sthref587"></a><a id="sthref588"></a></h3>
<p>Materialized view groups make it easy to manage materialized views that are logically related. For example, you might add all of the materialized views in a schema or all of the materialized views used by an application to a materialized view group. Also, for materialized views to be updatable, they must belong to a materialized view group.</p>
<p class="orderedlisttitle">To view information about the materialized view groups at a materialized view site:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Materialized View Groups in the Materialized View Site section.</p>
<p>The Materialized View Groups page appears, listing the names of the materialized view groups at the materialized view site.</p>
</li>
<li>
<p>To view detailed information about a materialized view group, click the name of the materialized view group to open the View Materialized View Group page.</p>
</li>
</ol>
<img width="652" height="276" src="img/tdpii_view_mv_group.gif" alt="Description of tdpii_view_mv_group.gif follows" /><br />
<a id="sthref590" href="img_text/tdpii_view_mv_group.htm">Description of the illustration tdpii_view_mv_group.gif</a><br />
<br />
<p>The View Materialized View Group page includes the following information:</p>
<ul>
<li>
<p>In the Link To Master field, the name of the database link to the master site. The master site contains the master tables of the materialized views in the materialized view group.</p>
</li>
<li>
<p>In the Propagation Mode field, Asynchronous is displayed because the propagation sends messages according to a propagation schedule.</p>
</li>
<li>
<p>In the Description field, a description of the materialized view group if the group has a description.</p>
</li>
<li>
<p>In the Objects section, a list of the database objects in the materialized view group and information about each database object</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also query the following data dictionary views for information about materialized view groups:
<ul>
<li>
<p><a class="olink REPMA126" href="../../server.112/e10707/rarrcatviews.htm#REPMA126"><code>ALL_REPGROUP</code></a></p>
</li>
<li>
<p><a class="olink REPMA127" href="../../server.112/e10707/rarrcatviews.htm#REPMA127"><code>ALL_REPSITES</code></a></p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHFGHIE">"About Master Sites, Master Tables, and Materialized View Sites"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHCEFGC">"Replicating Read/Write Data Using Materialized Views"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABGFIFJ"></a><a id="TDPII131"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing Information About Deferred Transactions for Updatable Materialized Views<a id="sthref591"></a><a id="sthref592"></a></h3>
<p>At a materialized view site, deferred transactions include changes to updatable materialized views. The deferred transactions are stored at the materialized view site so that they can be sent to the master site and applied to master tables. Deferred transactions for a materialized view are always pushed when a materialized view is refreshed. A scheduled link determines when the deferred transactions are pushed to the master site independent of the refresh process.</p>
<p class="orderedlisttitle">To view information about deferred transactions for updatable materialized views:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Deferred Transactions in the General section to open the Administration: Deferred Transactions page.</p>
<img width="647" height="132" src="img/tdpii_def_trans.gif" alt="Description of tdpii_def_trans.gif follows" /><br />
<a id="sthref594" href="img_text/tdpii_def_trans.htm">Description of the illustration tdpii_def_trans.gif</a><br />
<br />
<p>The Administration: Deferred Transactions page contains the transaction ID and the following information for each deferred transaction:</p>
<ul>
<li>
<p>The Destination field shows the master site to which the deferred transaction will be pushed.</p>
</li>
<li>
<p>The Start Time field shows when the deferred transaction was placed in the deferred transaction queue at the materialized view site.</p>
</li>
<li>
<p>The Number of Calls field typically shows the number of individual rows changed in the transaction.</p>
</li>
</ul>
</li>
<li>
<p>Click a transaction ID in the Transaction ID column to open the Deferred Transaction page and view more information about the transaction.</p>
<img width="768" height="215" src="img/tdpii_def_tran.gif" alt="Description of tdpii_def_tran.gif follows" /><br />
<a id="sthref595" href="img_text/tdpii_def_tran.htm">Description of the illustration tdpii_def_tran.gif</a><br />
<br />
<p>The Deferred Transaction page shows the materialized view and the type of operation that changed it. For example, <code>REP_UPDATE</code> designates an update operation.</p>
</li>
<li>
<p>To view detailed information about a specific change in the deferred transaction, select the change and click <span class="bold">Details</span>.</p>
<img width="706" height="210" src="img/tdpii_def_change.gif" alt="Description of tdpii_def_change.gif follows" /><br />
<a id="sthref596" href="img_text/tdpii_def_change.htm">Description of the illustration tdpii_def_change.gif</a><br />
<br />
<p>This page shows each column in the materialized view, along with its original value and, where appropriate, its new value. When there is a new value for a column, then the change modified the column value from the original value to the new value.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#CHDEJIJC">"About Scheduled Links and Deferred Transactions"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHCEFGC">"Replicating Read/Write Data Using Materialized Views"</a></p>
</li>
<li>
<p><a class="olink REPMA026" href="../../server.112/e10707/rardeftranviews.htm#REPMA026"><span class="italic">Oracle Database Advanced Replication Management API Reference</span></a> for information about the data dictionary views related to deferred transactions</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABBJIBF"></a><a id="TDPII117"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing Information About Refresh Groups<a id="sthref597"></a><a id="sthref598"></a><a id="sthref599"></a></h3>
<p>When you refresh a refresh group, all of the materialized views in the refresh group are refreshed to a consistent point in time.</p>
<p class="orderedlisttitle">To view information about the refresh groups at a materialized view site:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Refresh Groups in the Materialized View Site section.</p>
<p>The Refresh Groups page appears.</p>
</li>
<li>
<p>Use the search tool to list the refresh groups that you want to view. To list all refresh groups, ensure that the Schema and Object Name fields are blank, and click <span class="bold">Go</span>.</p>
<img width="726" height="324" src="img/tdpii_refresh_groups.gif" alt="Description of tdpii_refresh_groups.gif follows" /><br />
<a id="sthref601" href="img_text/tdpii_refresh_groups.htm">Description of the illustration tdpii_refresh_groups.gif</a><br />
<br />
<p>The Refresh Groups page lists the names of the refresh groups at the materialized view site. It also contains the following information for each refresh group:</p>
<ul>
<li>
<p>The Broken column shows whether the refresh job is working properly. <span class="bold">No</span> means that the job is working properly. <span class="bold">Yes</span> means that the job is broken. If 16 attempts to refresh a refresh group fail, then the refresh job is considered broken. If the refresh job is broken, see <a href="#BABGAEFH">"Correcting Problems with Materialized View Refresh"</a>.</p>
</li>
<li>
<p>The Next Date column shows the next date and time when the refresh group will be automatically refreshed.</p>
</li>
<li>
<p>The Interval column shows the time interval between automatic refreshes of the refresh group.</p>
</li>
</ul>
</li>
<li>
<p>For detailed information about a refresh group, select it and click <span class="bold">View</span> to open the View Refresh Group page.</p>
</li>
</ol>
<img width="569" height="361" src="img/tdpii_view_refresh_group.gif" alt="Description of tdpii_view_refresh_group.gif follows" /><br />
<a id="sthref602" href="img_text/tdpii_view_refresh_group.htm">Description of the illustration tdpii_view_refresh_group.gif</a><br />
<br />
<p>The View Refresh Group page contains detailed information about the refresh group. The information is organized into the following sections: General, Refresh, and Materialized Views.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also query the <a class="olink REFRN20178" href="../../server.112/e40402/statviews_2020.htm#REFRN20178"><code>ALL_REFRESH</code></a> data dictionary view for information about refresh groups.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#CHDJEFDH">"Configuring a Refresh Group"</a></p>
</li>
<li>
<p><a href="#BABGBBIJ">"Refreshing a Refresh Group"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABEDAHG"></a><a id="TDPII118"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing Materialized View Logs at a Master Site<a id="sthref603"></a><a id="sthref604"></a><a id="sthref605"></a><a id="sthref606"></a></h3>
<p>Materialized view logs keep track of changes to master tables so that a fast refresh of materialized views is possible.</p>
<p class="orderedlisttitle">To view information about the materialized view logs at a master site:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the master site as an administrative user, such as the replication administrator or <code>SYSTEM</code>. By default, the user name of the replication administrator is <code>repadmin</code>.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Materialized View Logs in the Master Site section.</p>
<p>The Materialized View Logs page appears.</p>
</li>
<li>
<p>Use the search tool to list the materialized view logs that you want to view.</p>
<p>To list all materialized view logs, ensure that the Schema and Object Name fields are blank, and click <span class="bold">Go</span>.</p>
<p>The Materialized View Logs page lists the schema, underlying log table, and master table for each materialized view log listed.</p>
</li>
<li>
<p>For detailed information about a materialized view log, select it and click <span class="bold">View</span> to open the View Materialized View Log page.</p>
</li>
</ol>
<img width="748" height="525" src="img/tdpii_view_mv_log.gif" alt="Description of tdpii_view_mv_log.gif follows" /><br />
<a id="sthref608" href="img_text/tdpii_view_mv_log.htm">Description of the illustration tdpii_view_mv_log.gif</a><br />
<br />
<p>The View Materialized View Log page contains detailed information about the materialized view log. The information is organized into the following sections: General, Options, and Storage.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also query the <a class="olink REFRN20137" href="../../server.112/e40402/statviews_1151.htm#REFRN20137"><code>ALL_MVIEW_LOGS</code></a> data dictionary view for information about materialized view logs.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#CHDCDIAG">"Configuring Materialized View Logs at the Master Site"</a></p>
</li>
<li>
<p><a href="#BABCGIBA">"Preventing Materialized View Logs From Becoming Too Large"</a></p>
</li>
<li>
<p><a href="#BABHFCEE">"Tutorial: Cleaning Up Materialized View Support at a Master Site"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABGAHFF"></a><a id="TDPII119"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Viewing the Materialized Views for a Master Site<a id="sthref609"></a><a id="sthref610"></a></h3>
<p>When you configure a materialized view at a materialized view site, it registers the materialized view at the master site. You can query the <a class="olink REFRN20183" href="../../server.112/e40402/statviews_2024.htm#REFRN20183"><code>ALL_REGISTERED_MVIEWS</code></a> data dictionary view to show the following information about each materialized view registered at a master site:</p>
<ul>
<li>
<p>The owner of the materialized view</p>
</li>
<li>
<p>The name of the materialized view</p>
</li>
<li>
<p>The materialized view site that contains the materialized view</p>
</li>
<li>
<p>Whether the materialized view is updatable or read-only</p>
</li>
</ul>
<p class="orderedlisttitle">To show this information:&nbsp;</p>
<ol>
<li>
<p>Open SQL*Plus and connect to the master site as an administrative user, such as the replication administrator or <code>SYSTEM</code>. By default, the user name of the replication administrator is <code>repadmin</code>.</p>
<p>See <a class="olink ADMQS0361" href="../../server.112/e10897/em_manage.htm#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.</p>
</li>
<li>
<p>Run the following query:</p>
<pre>
COLUMN OWNER HEADING 'Owner' FORMAT A20
COLUMN NAME HEADING 'Name' FORMAT A20
COLUMN MVIEW_SITE HEADING 'Materialized|View Site' FORMAT A15
COLUMN UPDATABLE HEADING 'Updatable?' FORMAT A10
 
SELECT OWNER, NAME, MVIEW_SITE, UPDATABLE
  FROM ALL_REGISTERED_MVIEWS;
</pre>
<p>The output will be similar to the following:</p>
<pre>
 <span class="bold">                                         Materialize               </span>
<span class="bold">Owner                Name                 View Site       Updatable?</span>
<span class="bold">-------------------- -------------------- --------------- ----------</span>
<span class="bold">HR                   COUNTRIES_MV         II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   DEPARTMENTS_MV       II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   EMPLOYEES_MV         II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   JOBS_MV              II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   JOB_HISTORY_MV       II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   LOCATIONS_MV         II2.EXAMPLE.COM YES</span>
<span class="bold">HR                   REGIONS_MV           II2.EXAMPLE.COM YES</span>
</pre></li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHFGHIE">"About Master Sites, Master Tables, and Materialized View Sites"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHIGFCF">"About Replication Groups and Updatable Materialized Views"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHHICBI"></a><a id="TDPII064"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Troubleshooting a Materialized View Replication Environment<a id="sthref612"></a><a id="sthref613"></a><a id="sthref614"></a></h2>
<p>This section describes the most common problems in a materialized view replication environment. It also describes how to correct these problems.</p>
<p>The following topics describe troubleshooting a materialized view replication environment:</p>
<ul>
<li>
<p><a href="#BABGAEFH">Correcting Problems with Materialized View Refresh</a></p>
</li>
<li>
<p><a href="#BABCGIBA">Preventing Materialized View Logs From Becoming Too Large</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink REPLN008" href="../../server.112/e10706/reptrouble.htm#REPLN008"><span class="italic">Oracle Database Advanced Replication</span></a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHHGGIB">Chapter 7, "Replicating Data Using Materialized Views"</a></p>
</li>
<li>
<p><a href="#CIHCJIBF">"Managing a Materialized View Replication Environment"</a></p>
</li>
<li>
<p><a href="#CIHJBJJC">"Monitoring a Materialized View Replication Environment"</a></p>
</li>
</ul>
</div>
<a id="BABGAEFH"></a><a id="TDPII132"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Correcting Problems with Materialized View Refresh<a id="sthref615"></a><a id="sthref616"></a><a id="sthref617"></a></h3>
<p>If one or more materialized views at a materialized view site cannot refresh, then the following are typical causes and solutions:</p>
<ul>
<li>
<p>A network problem is preventing one or more materialized views from refreshing. If you have multiple refresh groups and multiple materialized views at a materialized view site, and none of them can refresh, then a network problem is the most likely cause. In this case, correct the network problem, and refresh the relevant materialized views. See <a class="olink ADMQS004" href="../../server.112/e10897/network.htm#ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.</p>
</li>
<li>
<p>A master site for the materialized views is down. A materialized view cannot refresh if its master site is not open. If you have a materialized view site with materialized views that use multiple master sites, and only the materialized views for a particular master site cannot refresh, then a master site problem is the most likely cause. In this case, check the database at the master site. If it is down, then start it, and refresh the relevant materialized views. See <a class="olink ADMQS05144" href="../../server.112/e10897/instance.htm#ADMQS05144"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about starting a database.</p>
</li>
<li>
<p>A database link is broken. If all of the materialized views in a materialized view group cannot refresh, then the database link used to refresh the materialized views might be broken. If a database link is broken, then you can correct the problem by deleting the database link and re-creating it.</p>
</li>
</ul>
<p class="orderedlisttitle">To re-create a broken database link:&nbsp;</p>
<ol>
<li>
<p>Log in to Enterprise Manager as an administrative user, such as <code>SYSTEM</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Schema</span> to open the Schema subpage.</p>
</li>
<li>
<p>Click <span class="bold">Database Links</span> in the Database Objects section.</p>
<p>The Database Links page appears.</p>
</li>
<li>
<p>Use the search tool to list the database link used by the materialized views.</p>
<p>The database link name should be the same as the global name of the master site for the materialized views.</p>
</li>
<li>
<p>Select the database link.</p>
</li>
<li>
<p>Click <span class="bold">View</span>.</p>
</li>
<li>
<p>On the View Database Link page, click <span class="bold">Test</span> to see if the database link is active. If it is active, then the materialized view refresh problems are caused by a different issue. If the database link is not active, then follow Steps <a href="#BABDEHBA">9</a> through <a href="#BABBFAAB">13</a> to delete it and re-create it.</p>
</li>
<li>
<p><a id="BABDEHBA"></a>Click <span class="bold">OK</span> to return to the Database Links page.</p>
</li>
<li>
<p>Select the database link.</p>
</li>
<li>
<p>Click <span class="bold">Delete</span>.</p>
</li>
<li>
<p>Click <span class="bold">Yes</span> on the confirmation page to delete the database link.</p>
</li>
<li>
<p><a id="BABBFAAB"></a>Follow the instructions in <a href="tdpii_common_ii.htm#BGBGIACD">"Tutorial: Creating a Database Link"</a> to re-create the database link.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="#BABEDJGH">"Refreshing Materialized Views"</a></p>
</li>
<li>
<p><a class="olink REPLN008" href="../../server.112/e10706/reptrouble.htm#REPLN008"><span class="italic">Oracle Database Advanced Replication</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABCGIBA"></a><a id="TDPII121"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Preventing Materialized View Logs From Becoming Too Large<a id="sthref619"></a><a id="sthref620"></a><a id="sthref621"></a></h3>
<p>Materialized view logs keep track of changes to master tables at master sites. When a fast refresh is performed on a materialized view, the changes in the materialized view log are applied to the materialized view. After changes are applied to all of the materialized views that use the materialized view log, the changes are deleted from the materialized view log.</p>
<p>A materialized view log can become too large when one or more materialized views that use the materialized view log do not refresh for a relatively long period of time. This situation can slow refresh performance for other materialized views. The following are typical causes and solutions:</p>
<ul>
<li>
<p>A network problem is preventing one or more materialized views that use the materialized view log from refreshing. In this case, correct the network problem and refresh the relevant materialized views. See <a class="olink ADMQS004" href="../../server.112/e10897/network.htm#ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.</p>
</li>
<li>
<p>A materialized view was dropped at a materialized view site when the materialized view site was not connected to the network. When a materialized view is dropped and a network connection is available, information about the materialized view is removed from the master site automatically. However, when a network connection is not available, information about the materialized view remains at the master site and must be cleaned up manually. See <a href="#BABHFCEE">"Tutorial: Cleaning Up Materialized View Support at a Master Site"</a>.</p>
</li>
<li>
<p>Materialized views are not being refreshed often enough. Materialized views can be refreshed manually, or they can be refreshed automatically when they are in a refresh group.</p>
<p>If you refresh materialized views manually, then you might need to refresh them more often if materialized view logs are becoming too large. See <a href="#BABDECCF">"Refreshing a Materialized View"</a>.</p>
<p>If materialized views are in a refresh group that is not refreshing often enough, then you can make the refresh interval shorter for the refresh group.</p>
</li>
</ul>
<p class="orderedlisttitle">To modify the refresh interval for a refresh group:&nbsp;</p>
<ol>
<li>
<p>In Enterprise Manager, log in to the materialized view site as the materialized view administrator. The default user name for the materialized view administrator is <code>mvadmin</code>.</p>
</li>
<li>
<p>Go to the Database Home page.</p>
</li>
<li>
<p>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</p>
</li>
<li>
<p>Click <span class="bold">Manage</span> in the Advanced Replication section.</p>
<p>The Advanced Replication: Administration page appears, showing the Overview subpage.</p>
</li>
<li>
<p>Click the number associated with Refresh Groups in the Materialized View Site section.</p>
</li>
<li>
<p>On the Refresh Groups page, use the search tool to list the refresh group to modify.</p>
</li>
<li>
<p>Select the refresh group.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
<p>The Edit Refresh Group page appears, showing the General subpage.</p>
<img width="652" height="461" src="img/tdpii_edit_ref_grp.gif" alt="Description of tdpii_edit_ref_grp.gif follows" /><br />
<a id="sthref623" href="img_text/tdpii_edit_ref_grp.htm">Description of the illustration tdpii_edit_ref_grp.gif</a><br />
<br /></li>
<li>
<p><a id="BABDGGEE"></a>In the Refresh section, click <span class="bold">Change</span> for the Interval field.</p>
</li>
<li>
<p>Shorten the interval using the Every field and list.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p><a id="BABHDHGI"></a>On the Edit Refresh Group page, click <span class="bold">Apply</span> to save your changes.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can also use the <a class="olink REPMA018" href="../../server.112/e10707/rarrefreshpac.htm#REPMA018"><code>DBMS_REFRESH.CHANGE</code></a> procedure to change the refresh interval for a refresh group.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="tdpii_reppit.htm#BEHBEBJA">"About Materialized View Refresh"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHBGDFD">"About Refresh Groups"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#BEHFGHIE">"About Master Sites, Master Tables, and Materialized View Sites"</a></p>
</li>
<li>
<p><a href="tdpii_reppit.htm#CHDCDIAG">"Configuring Materialized View Logs at the Master Site"</a></p>
</li>
<li>
<p><a class="olink REPLN008" href="../../server.112/e10706/reptrouble.htm#REPLN008"><span class="italic">Oracle Database Advanced Replication</span></a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1402">
<tr>
<td class="cellalignment1409">
<table class="cellalignment1407">
<tr>
<td class="cellalignment1406"><a href="tdpii_reppit.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1406"><a href="tdpii_messaging.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1411">
<table class="cellalignment1405">
<tr>
<td class="cellalignment1406"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1406"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1406"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1406"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1406"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1406"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
