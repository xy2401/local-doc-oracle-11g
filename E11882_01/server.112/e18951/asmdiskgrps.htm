<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Administering Oracle ASM Disk Groups</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 047" />
<meta name="dcterms.created" content="2012-02-03T20:20:15Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Automatic Storage Management Administrator's Guide" />
<meta name="dcterms.identifier" content="E18951-03" />
<meta name="dcterms.isVersionOf" content="OSTMG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2007, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="ostmg_gloss.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="asminst.htm" title="Previous" type="text/html" />
<link rel="Next" href="asmfilesystem.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e18951.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">10/40</span> <!-- End Header --><a id="g1040709"></a><a id="OSTMG137"></a>
<h1 class="chapter"><span class="secnum">4</span> Administering Oracle ASM Disk Groups</h1>
<p><a id="sthref208"></a><a id="sthref209"></a>This chapter describes how to administer Oracle Automatic Storage Management (Oracle ASM) disk groups. This information includes how to create, alter, drop, mount, and dismount Oracle ASM disk groups. The database instances that use Oracle ASM can continue operating while you administer disk groups.</p>
<p>The examples in this chapter use SQL statements. These examples assume that SQL*Plus is run from the Oracle grid home where Oracle ASM is installed and the Oracle environmental variables are set to this home. The examples also assume that the Oracle ASM instance is running. This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDIABGJ">Disk Group Attributes</a></p>
</li>
<li>
<p><a href="#i1007979">Creating Disk Groups</a></p>
</li>
<li>
<p><a href="#i1019476">Altering Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDHDDBE">Oracle ASM Disk Discovery</a></p>
</li>
<li>
<p><a href="#CHDGGGAD">Managing Capacity in Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDHDGDI">Oracle ASM Mirroring and Disk Group Redundancy</a></p>
</li>
<li>
<p><a href="#i1014729">Performance and Scalability Considerations for Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDDIGBJ">Disk Group Compatibility</a></p>
</li>
<li>
<p><a href="#CHDICHHE">Managing Oracle ASM File Access Control for Disk Groups</a></p>
</li>
<li>
<p><a href="#i1019481">Mounting and Dismounting Disk Groups</a></p>
</li>
<li>
<p><a href="#BABCGJHG">Checking the Internal Consistency of Disk Group Metadata</a></p>
</li>
<li>
<p><a href="#i1020539">Dropping Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDJAGHE">Renaming Disks Groups</a></p>
</li>
</ul>
<p>For information about starting up an Oracle ASM instance, refer to <a href="asminst.htm#i1013975">"Starting Up an Oracle ASM Instance"</a>.</p>
<p>For information about administering Oracle ASM disk groups with Oracle Enterprise Manager, refer to <a href="asm_em.htm#CACHBFDE">Chapter 9, "Administering Oracle ASM with Oracle Enterprise Manager"</a>.</p>
<p>For information about administering Oracle ASM disk groups with Oracle ASM Configuration Assistant (ASMCA), refer to <a href="asmca.htm#CHDEIHJA">Chapter 11, "Oracle ASM Configuration Assistant"</a>.</p>
<p>For information about administering Oracle ASM disk groups with ASMCMD, refer to <a href="asm_util.htm#BJEGEAAJ">Chapter 12, "Oracle ASM Command-Line Utility"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The Oracle Cloud Storage page on the Oracle Technology Network Web site at <code><a href="http://www.oracle.com/technetwork/database/cloud-storage/index.html">http://www.oracle.com/technetwork/database/cloud-storage/index.html</a></code> for more information about Oracle ASM</div>
<a id="CHDIABGJ"></a><a id="OSTMG94106"></a>
<div class="sect1">
<h2 class="sect1">Disk Group Attributes</h2>
<p><a id="sthref210"></a><a id="sthref211"></a>Disk group attributes are parameters that are bound to a disk group, rather than an Oracle ASM instance.</p>
<p>Disk group attributes can be set when a disk group is created or altered, unless otherwise noted in the following list.</p>
<ul>
<li>
<p><a id="sthref212"></a>ACCESS_CONTROL.ENABLED</p>
<p>This attribute can only be set when altering a disk group.</p>
<p>For information about the <code>ACCESS_CONTROL.ENABLED</code> attribute, see <a href="#CHDHEFFA">"Setting Disk Group Attributes for Oracle ASM File Access Control"</a>.</p>
</li>
<li>
<p><a id="sthref213"></a>ACCESS_CONTROL.UMASK</p>
<p>This attribute can only be set when altering a disk group.</p>
<p>For information about the <code>ACCESS_CONTROL.UMASK</code> attribute, see <a href="#CHDHEFFA">"Setting Disk Group Attributes for Oracle ASM File Access Control"</a>.</p>
</li>
<li>
<p><a id="sthref214"></a>AU_SIZE</p>
<p>This attribute can only be set when creating a disk group.</p>
<p>For information about allocation unit size and extents, see <a href="asmcon.htm#BABCIIAA">"Allocation Units"</a>, <a href="asmcon.htm#BABCGDBF">"Extents"</a>, and <a href="#CHDHIDEH">"Specifying the Allocation Unit Size"</a>. For an example of the use of the <code>AU_SIZE</code> attribute, see <a href="#CHDDEHJH">Example 4-1, "Creating the DATA disk group"</a>.</p>
</li>
<li>
<p><a id="sthref215"></a>CELL.SMART_SCAN_CAPABLE</p>
<p>This attribute is only applicable to Oracle Exadata storage.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">Oracle Exadata documentation</span></div>
</li>
<li>
<p><a id="sthref216"></a>COMPATIBLE.ASM</p>
<p>For information about the <code>COMPATIBLE.ASM</code> attribute, see <a href="#BABGEICD">"COMPATIBLE.ASM"</a>.</p>
</li>
<li>
<p><a id="sthref217"></a>COMPATIBLE.RDBMS</p>
<p>For information about the <code>COMPATIBLE.RDBMS</code> attribute, see <a href="#BABCAJJD">"COMPATIBLE.RDBMS"</a>.</p>
</li>
<li>
<p><a id="sthref218"></a>COMPATIBLE.ADVM</p>
<p>For information about the <code>COMPATIBLE.ADVM</code> attribute, see <a href="#CHDFFADC">"COMPATIBLE.ADVM"</a> and <a href="asmfilesystem.htm#CACHFACJ">"Overview of Oracle ASM Dynamic Volume Manager"</a>.</p>
</li>
<li>
<p><a id="sthref219"></a>CONTENT.TYPE</p>
<p>The <code>CONTENT.TYPE</code> attribute identifies the disk group type: <code>data</code>, <code>recovery</code>, or <code>system</code>. The type value determines the distance to the nearest neighbor disk in the failure group where Oracle ASM mirrors copies of the data. The default value is <code>data</code> which specifies a distance of 1 to the nearest neighbor disk. A value of <code>recovery</code> specifies a distance of 3 to the nearest neighbor disk and a value of <code>system</code> specifies a distance of 5.</p>
<p>The attribute can be specified when creating or altering a disk group. If <code>CONTENT.TYPE</code> attribute is set or changed using <code>ALTER</code> <code>DISKGROUP</code>, then the new configuration does not take effect until a disk group rebalance is explicitly run.</p>
<p>The <code>CONTENT.TYPE</code> attribute is only valid for disk groups that are set to normal or high redundancy. The <code>COMPATIBLE.ASM</code> attribute must be set to <code>11.2.0.3</code> or higher to enable the <code>CONTENT.TYPE</code> attribute for the disk group.</p>
<p>The attribute can be set with SQL, ASMCMD, or ASMCA. For example:</p>
<pre>
SQL&gt; CREATE DISKGROUP data NORMAL REDUNDANCY
        FAILGROUP controller1 DISK
        '/devices/diska1' NAME diska1,
...
        ATTRIBUTE 
        'compatible.asm' = '11.2.0.3', 
        'content.type' = 'recovery',
...

SQL&gt; ALTER DISKGROUP data SET ATTRIBUTE 'content.type' = 'data';
</pre>
<p>This attribute is primarily intended for use with Oracle Exadata storage.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">Oracle Exadata documentation</span></div>
</li>
<li>
<p><a id="sthref220"></a>DISK_REPAIR_TIME</p>
<p>This attribute can only be set when altering a disk group.</p>
<p>For information about the <code>DISK_REPAIR_TIME</code> attribute, see <a href="#CHDBCBGF">"Oracle ASM Fast Mirror Resync"</a>.</p>
</li>
<li>
<p><a id="sthref221"></a>IDP.BOUNDARY and <a id="sthref222"></a>IDP.TYPE</p>
<p>These attributes are intended for use with Oracle Exadata storage.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">Oracle Exadata documentation</span></div>
</li>
<li>
<p><a id="sthref223"></a>SECTOR_SIZE</p>
<p>This attribute can only be set when creating a disk group.</p>
<p>For information about the <code>SECTOR_SIZE</code> attribute, see <a href="#CHDBBEGB">"Specifying the Sector Size for Drives"</a>.</p>
</li>
<li>
<p><a id="sthref224"></a><a id="sthref225"></a>STORAGE.TYPE</p>
<p>The <code>STORAGE.TYPE</code> disk group attribute specifies the type of the disks in the disk group. The possible values are <code>AXIOM</code>, <code>ZFSSA</code>, and <code>OTHER</code>. If the attribute is set to <code>AXIOM</code> or <code>ZFSSA</code>, then all disks in the disk group must be of that type. If the attribute is set to <code>OTHER</code>, then any types of disks can be in the disk group.</p>
<p>If the <code>STORAGE.TYPE</code> disk group attribute is set to <code>AXIOM</code> or <code>ZFSSA</code>, then functionality for Hybrid Columnar Compression (HCC) can be enabled for Pillar Axiom or ZFS storage.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
ZFS storage must be added through Direct NFS (dNFS) and Pillar Axiom storage must be added as SCSI/Fiber Channel.</div>
<p>To set the <code>STORAGE.TYPE</code> attribute, the <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group attributes must be set to <code>11.2.0.3</code> or higher. For information about disk group compatibility attributes, refer to <a href="#CHDDIGBJ">"Disk Group Compatibility"</a>.</p>
<p>The <code>STORAGE.TYPE</code> attribute can be set when creating a disk group or when altering a disk group. The attribute cannot be set when clients are connected to the disk group. For example, the attribute cannot be set when an Oracle ADVM volume is enabled on the disk group.</p>
<p>The attribute is not visible in the <code>V$ASM_ATTRIBUTE</code> view or with the ASMCMD <code>lsattr</code> command until the attribute has been set.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink CNCPT89198" href="../../server.112/e40540/tablecls.htm#CNCPT89198"><span class="italic">Oracle Database Concepts</span></a> for more information about Hybrid Columnar Compression. Hybrid Columnar Compression is a feature of certain Oracle storage systems.</div>
</li>
</ul>
<p>In addition to the disk group attributes listed in this section, template attributes are also assigned to a disk group. For information about template attributes, see <a href="asmfiles.htm#i1019485">"Managing Disk Group Templates"</a>.</p>
<p>You can display disk group attributes with the <code>V$ASM_ATTRIBUTE</code> view and the ASMCMD <code>lsattr</code> command. For an example of the use of the <code>V$ASM_ATTRIBUTE</code> view, see <a href="asmviews.htm#BABJEAAJ">Example 6-1</a>. For information about the <code>lsattr</code> command, see <a href="asm_util004.htm#CIHGBCHG">"lsattr"</a>.</p>
</div>
<!-- class="sect1" -->
<a id="i1007979"></a><a id="OSTMG10040"></a>
<div class="sect1">
<h2 class="sect1">Creating Disk Groups</h2>
<p><a id="sthref226"></a><a id="sthref227"></a>This section contains information about creating disk groups. You can use the <code>CREATE</code> <code>DISKGROUP</code> SQL statement to create a disk group.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDBDAGI">Using the CREATE DISKGROUP SQL Statement</a></p>
</li>
<li>
<p><a href="#CHDHHABI">Example: Creating a Disk Group</a></p>
</li>
<li>
<p><a href="#CHDGJEHJ">Creating Disk Groups for a New Oracle Installation</a></p>
</li>
<li>
<p><a href="#CHDHIDEH">Specifying the Allocation Unit Size</a></p>
</li>
<li>
<p><a href="#CHDBBEGB">Specifying the Sector Size for Drives</a></p>
</li>
<li>
<p><a href="#CHDBGAFB">Oracle Cluster Registry and Voting Files in Oracle ASM Disk Groups</a></p>
</li>
</ul>
<a id="CHDBDAGI"></a><a id="OSTMG10202"></a>
<div class="sect2">
<h3 class="sect2">Using the CREATE DISKGROUP SQL Statement</h3>
<p><a id="sthref228"></a><a id="sthref229"></a>The <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><code>CREATE DISKGROUP</code></a> SQL statement is used to create disk groups. When creating a disk group, you:</p>
<ul>
<li>
<p><a id="sthref230"></a><a id="sthref231"></a>Assign a unique name to the disk group.</p>
<p>The specified disk group name is not case sensitive and is always converted to uppercase when stored internally.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle does not recommend using identifiers for database object names that must be quoted. While these quoted identifiers may be valid as names in the SQL CREATE statement, such as <code>CREATE</code> <code>DISKGROUP</code> "<code>1DATA</code>", the names may not be valid when using other tools that manage the database object.</div>
</li>
<li>
<p><a id="sthref232"></a><a id="sthref233"></a>Specify the redundancy level of the disk group.</p>
<p>For Oracle ASM to mirror files, specify the redundancy level as <code>NORMAL REDUNDANCY</code> (2-way mirroring by default for most file types) or <code>HIGH REDUNDANCY</code> (3-way mirroring for all files). Specify <code>EXTERNAL REDUNDANCY</code> if you do not want mirroring by Oracle ASM. For example, you might choose <code>EXTERNAL REDUNDANCY</code> to use storage array protection features.</p>
<p>After a disk group is created, you cannot alter the redundancy level of the disk group. To change the redundancy level, you must create another disk group with the appropriate redundancy and then move the files to the new disk group.</p>
<p>Oracle recommends that you create failure groups of equal size to maintain space balance and even distribution of mirror data.</p>
<p>For more information about redundancy levels, refer to <a href="#BABBEJAF">"Mirroring, Redundancy, and Failure Group Options"</a>.</p>
</li>
<li>
<p><a id="sthref234"></a><a id="sthref235"></a>Specify the disks that are to be formatted as Oracle ASM disks belonging to the disk group.</p>
<p>The disks can be specified using operating system dependent wildcard characters in search strings that Oracle ASM then uses to find the disks. You can specify names for the disks with the <code>NAME</code> clause or use the system-generated names.</p>
</li>
<li>
<p><a id="sthref236"></a><a id="sthref237"></a>Optionally specify the disks as belonging to specific failure groups.</p>
<p>For information about failure groups, refer to <a href="asmcon.htm#i1021951">"Understanding Oracle ASM Concepts"</a> and <a href="#BABBEJAF">"Mirroring, Redundancy, and Failure Group Options"</a>.</p>
</li>
<li>
<p><a id="sthref238"></a><a id="sthref239"></a>Optionally specify the type of failure group.</p>
<p>For information about <code>QUORUM</code> and <code>REGULAR</code> failure groups, refer to <a href="#CHDBGAFB">"Oracle Cluster Registry and Voting Files in Oracle ASM Disk Groups"</a>.</p>
</li>
<li>
<p><a id="sthref240"></a><a id="sthref241"></a>Optionally specify disk group attributes, such as software compatibility or allocation unit size.</p>
</li>
</ul>
<p>Oracle ASM programmatically determines the size of each disk. If for some reason this is not possible, or to restrict the amount of space used on a disk, you can specify a <code>SIZE</code> clause for each disk. Oracle ASM creates operating system&ndash;independent names for the disks in a disk group that you can use to reference the disks in other SQL statements. Optionally, you can provide your own name for a disk using the <code>NAME</code> clause. Disk names are available in the <code>V$ASM_DISK</code> view.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
A disk cannot belong to multiple disk groups.</div>
<p>The Oracle ASM instance ensures that any disk in a newly created disk group is addressable and is not currently a member of another disk group. You must use <code>FORCE</code> only when adding a disk that was dropped with <code>FORCE</code>. If a disk is dropped with <code>NOFORCE</code>, then you can add it with <code>NOFORCE</code>. For example, a disk might have failed and was dropped from its disk group. After the disk is repaired, it is no longer part of any disk group, but Oracle ASM still recognizes that the disk had been a member of a disk group. You must use the <code>FORCE</code> flag to include the disk in a new disk group. In addition, the disk must be addressable, and the original disk group must not be mounted. Otherwise, the operation fails.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Use caution when using the <code>FORCE</code> option to add a previously used disk to a disk group; you might cause another disk group to become unusable.</div>
<p>The <code>CREATE DISKGROUP</code> statement mounts the disk group for the first time, and adds the disk group name to the <code>ASM_DISKGROUPS</code> initialization parameter if a server parameter file is being used. If a text initialization parameter file is being used and you want the disk group to be automatically mounted at instance startup, then you must remember to add the disk group name to the <code>ASM_DISKGROUPS</code> initialization parameter before you shut down and restart the Oracle ASM instance. You can also create disk groups with Oracle Enterprise Manager. Refer to <a href="asm_em.htm#CIADICDC">"Creating Disk Groups"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><code>CREATE DISKGROUP</code></a> SQL statement in the <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect2" -->
<a id="CHDHHABI"></a><a id="OSTMG94107"></a>
<div class="sect2">
<h3 class="sect2">Example: Creating a Disk Group</h3>
<p>The following examples assume that the <code>ASM_DISKSTRING</code> initialization parameter is set to the '<code>/devices/*</code>' string. Oracle ASM disk discovery identifies disks in the <code>/devices</code> directory, including the following disks:</p>
<p>Controller 1:</p>
<br />
<code>/devices/diska1</code><br />
<code>/devices/diska2</code><br />
<code>/devices/diska3</code><br />
<code>/devices/diska4</code><br />
<br />
Controller 2:<br />
<code>/devices/diskb1</code><br />
<code>/devices/diskb2</code><br />
<code>/devices/diskb3</code><br />
<code>/devices/diskb4</code><br />
<p>The SQL statement in <a href="#CHDDEHJH">Example 4-1</a> creates a disk group named <code>data</code> with normal redundancy consisting of two failure groups <code>controller1</code> or <code>controller2</code> with four disks in each failure group. The <code>data</code> disk group is typically used to store database data files.</p>
<div class="example">
<p class="titleinexample"><a id="CHDDEHJH"></a><a id="OSTMG94108"></a>Example 4-1 Creating the DATA disk group</p>
<pre>
CREATE DISKGROUP data NORMAL REDUNDANCY
  FAILGROUP controller1 DISK
    '/devices/diska1' NAME diska1,
    '/devices/diska2' NAME diska2,
    '/devices/diska3' NAME diska3,
    '/devices/diska4' NAME diska4
  FAILGROUP controller2 DISK
    '/devices/diskb1' NAME diskb1,
    '/devices/diskb2' NAME diskb2,
    '/devices/diskb3' NAME diskb3,
    '/devices/diskb4' NAME diskb4
  ATTRIBUTE 'au_size'='4M',
    'compatible.asm' = '11.2', 
    'compatible.rdbms' = '11.2',
    'compatible.advm' = '11.2';
</pre></div>
<!-- class="example" -->
<p>In <a href="#CHDDEHJH">Example 4-1</a>, the <code>NAME</code> clauses enable you to explicitly assign names to the disks rather than the default system-generated names. The system-generated names are in the form <code><span class="codeinlineitalic">diskgroup_nnnn</span></code>, where <code><span class="codeinlineitalic">nnnn</span></code> is the disk number for the disk in the disk group. For ASMLib disks, the disk name defaults to the ASMLib name that is the user label of the disk; for example, <code>mydisk</code> is the default Oracle ASM disk name for <code>ORCL:mydisk</code>.</p>
<p>When creating the disk group in <a href="#CHDDEHJH">Example 4-1</a>, the values of following <a id="sthref242"></a><a id="sthref243"></a><a id="sthref244"></a><a id="sthref245"></a><a id="sthref246"></a><a id="sthref247"></a>disk group attributes were explicitly set:</p>
<ul>
<li>
<p><code>AU_SIZE</code></p>
<p>Specifies the size of the allocation unit for the disk group. For information about allocation unit size and extents, see <a href="asmcon.htm#BABCGDBF">"Extents"</a>.</p>
<p>You can view the value of the <code>AU_SIZE</code> disk group attribute in the <code>ALLOCATION_UNIT_SIZE</code> column of the <code>V$ASM_DISKGROUP</code> view.</p>
</li>
<li>
<p><code>COMPATIBLE</code>.<code>ASM</code></p>
<p>Determines the minimum software version for any Oracle ASM instance that uses a disk group. For information about the <code>COMPATIBLE.ASM</code> attribute, see <a href="#BABGEICD">"COMPATIBLE.ASM"</a>.</p>
</li>
<li>
<p><code>COMPATIBLE</code>.<code>RDBMS</code></p>
<p>Determines the minimum software version for any database instance that uses a disk group. For information about the <code>COMPATIBLE.RDBMS</code> attribute, see <a href="#BABCAJJD">"COMPATIBLE.RDBMS"</a>.</p>
</li>
<li>
<p><code>COMPATIBLE</code>.<code>ADVM</code></p>
<p>Determines whether the disk group can contain Oracle ASM volumes. For information about the <code>COMPATIBLE.ADVM</code> attribute, see <a href="#CHDFFADC">"COMPATIBLE.ADVM"</a>.</p>
</li>
</ul>
<p>In <a href="#CHDGBABC">Example 4-2</a>, the <code>fra</code> disk group (typically created for the fast recovery area) is created with the default disk group attribute values. Names are not specified for the Oracle ASM disks and failure groups are not explicitly specified. This example assumes that <code>diskc1</code> through <code>diskc9</code> are present in the <code>/devices</code> directory.</p>
<div class="example">
<p class="titleinexample"><a id="CHDGBABC"></a><a id="OSTMG94109"></a>Example 4-2 Creating the FRA disk group</p>
<pre>
CREATE DISKGROUP fra NORMAL REDUNDANCY
  DISK '/devices/diskc*';
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For information about using ASMLib when creating disk groups, refer to the Oracle ASMLib page on the Oracle Technology Network Web site at <code><a href="http://www.oracle.com/technetwork/topics/linux/asmlib/index-101839.html">http://www.oracle.com/technetwork/topics/linux/asmlib/index-101839.html</a></code></div>
</div>
<!-- class="sect2" -->
<a id="CHDGJEHJ"></a><a id="OSTMG10206"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating Disk Groups for a New Oracle Installation</h3>
<p><a id="sthref248"></a><a id="sthref249"></a>This section describes the basic procedure to follow when creating disk groups during a new installation of Oracle Restart and Oracle Database. This information also applies to an Oracle Grid Infrastructure installation.</p>
<p>The procedure assumes that the <code>data</code> disk group is used for the storage of the database data files and the <code>fra</code> disk group is used for storage of the fast recovery area files. Detailed information about installation with Oracle Universal Installer (OUI) and database creation with Database Configuration Assistant (DBCA) is available in the installation guides for your specific operating system.</p>
<ol>
<li>
<p>Install Oracle Restart with OUI, following the screen prompts.</p>
<p>During the installation, create the <code>data</code> disk group for storing database files such as the data and control files.</p>
<p>This OUI process is similar to creating a disk group with Oracle ASM Configuration Assistant (ASMCA). For information about using ASMCA to create disk groups, see <a href="asmca.htm#CHDJIBAJ">"Managing Disk Groups with Oracle ASM Configuration Assistant"</a>.</p>
<p>Note that the <code>data</code> disk group is the disk group used for storing Oracle Cluster Registry (OCR) and voting files in an Oracle Grid Infrastructure installation. See <a href="#CHDBGAFB">"Oracle Cluster Registry and Voting Files in Oracle ASM Disk Groups"</a></p>
</li>
<li>
<p>After Oracle Restart is installed, use ASMCA to create the <code>fra</code> disk group for storing the fast recovery area files.</p>
<p>Create the <code>fra</code> disk group to hold the fast recovery area files.</p>
<p>At this time, you can also update the <code>data</code> disk group if necessary. For information about using ASMCA to create or alter disk groups, see <a href="asmca.htm#CHDJIBAJ">"Managing Disk Groups with Oracle ASM Configuration Assistant"</a>.</p>
<p>You can also create the <code>fra</code> disk group with SQL*Plus or ASMCMD commands run from the Oracle Restart home. For information, see <a href="#CHDBDAGI">"Using the CREATE DISKGROUP SQL Statement"</a> and <a href="asm_util004.htm#CIHGEBEI">"mkdg"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink BRADV8183" href="../../backup.112/e10642/rcmconfb.htm#BRADV8183"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for information about configuring the fast recovery area</p>
</li>
<li>
<p><a class="olink ADMIN11103" href="../../server.112/e25494/create.htm#ADMIN11103"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about specifying a fast recovery area</p>
</li>
</ul>
</div>
</li>
<li>
<p>Install the Oracle Database software with OUI, following the screen prompts.</p>
</li>
<li>
<p>After the database software has been installed, run DBCA to create a database, following the screen prompts.</p>
<p>During the creation of the database, make the appropriate selections to use Oracle ASM for storage of data files and fast recovery area files. When prompted:</p>
<ul>
<li>
<p>Store database data files in the <code>data</code> disk group</p>
</li>
<li>
<p>Store fast recovery area files in the <code>fra</code> disk group</p>
</li>
</ul>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for your operating system for detailed information about installation of Oracle Grid Infrastructure and Oracle Restart</p>
</li>
<li>
<p><a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Database Installation Guide</span></a> for your operating system for detailed information about installation of an Oracle Database</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDHIDEH"></a><a id="OSTMG10205"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Specifying the Allocation Unit Size</h3>
<p><a id="sthref250"></a><a id="sthref251"></a>Oracle recommends that the allocation unit (AU) size for a disk group be set to 4 megabytes (MB). In addition to this AU size recommendation, the operating system (OS) I/O size should be set to the largest possible size.</p>
<p>Some benefits of a 4 MB allocation unit are:</p>
<ul>
<li>
<p>Increased I/O through the I/O subsystem if the I/O size is increased to the AU size.</p>
</li>
<li>
<p>Reduced SGA size to manage the extent maps in the database instance.</p>
</li>
<li>
<p>Faster datafile initialization if the I/O size is increased to the AU size.</p>
</li>
<li>
<p>Increased file size limits.</p>
</li>
<li>
<p>Reduced database open time.</p>
</li>
</ul>
<p>The allocation unit size is specified with the disk group attribute <code>AU_SIZE</code>. The AU size cannot be altered after a disk group is created. <a href="#CHDDEHJH">Example 4-1</a> shows how the <code>AU_SIZE</code> is specified with the <code>CREATE</code> <code>DISKGROUP</code> SQL statement.</p>
</div>
<!-- class="sect2" -->
<a id="CHDBBEGB"></a><a id="OSTMG10203"></a>
<div class="sect2">
<h3 class="sect2">Specifying the Sector Size for Drives</h3>
<p><a id="sthref252"></a><a id="sthref253"></a>You can use the optional <code>SECTOR_SIZE</code> disk group attribute with the <code>CREATE</code> <code>DISKGROUP</code> SQL statement to specify disks with the sector size set to the value of <code>SECTOR_SIZE</code> for the disk group. Oracle ASM provides support for 4 KB sector disk drives without negatively affecting performance. The <code>SECTOR_SIZE</code> disk group attribute can be set only during disk group creation.</p>
<p>The values for <code>SECTOR_SIZE</code> can be set to 512, 4096, or 4K if the disks support those values. The default value is platform dependent. The <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group attributes must be set to 11.2 or higher to set the sector size to a value other than the default value.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Automatic Storage Management Cluster File System (Oracle ACFS) does not support 4 KB sector drives. There is a performance penalty for Oracle ACFS when using 4 KB sector disk drives in 512 sector emulation mode.</div>
<p><a id="sthref254"></a><a id="sthref255"></a>The following validations apply to the sector size disk group attribute.</p>
<ul>
<li>
<p>Oracle ASM prevents disks of different sector sizes from being added to the same disk group. This validation occurs during <code>CREATE</code> <code>DISKGROUP</code>, <code>ALTER</code> <code>DISKGROUP</code> <code>ADD</code> <code>DISK</code>, and <code>ALTER</code> <code>DISKGROUP</code> <code>MOUNT</code> operations.</p>
</li>
<li>
<p>If the <code>SECTOR_SIZE</code> attribute is explicitly specified when creating a disk group, then Oracle ASM attempts to verify that all disks discovered through disk search strings have a sector size equal to the specified value. If one or more disks were found to have a sector size different from the specified value, or if Oracle ASM was not able to verify a disk sector size, then the create operation fails.</p>
<p>Oracle ASM also attempts to verify disk sector size during the mount operation and the operation fails if one or more disks have a sector size different than the value of the <code>SECTOR_SIZE</code> attribute.</p>
</li>
<li>
<p>If the <code>SECTOR_SIZE</code> attribute is not specified when creating a disk group and Oracle ASM can verify that all discovered disks have the same sector value, then that value is assumed for the disk group sector size that is created. If the disks have different sector sizes, the create operation fails.</p>
</li>
<li>
<p>When new disks are added to an existing disk group using the <code>ALTER</code> <code>DISKGROUP</code> .. <code>ADD</code> <code>DISK</code> SQL statement, you must ensure that the new disks to be added have the same value as the <code>SECTOR_SIZE</code> disk group attribute. If the new disks have different sector sizes, the alter operation fails.</p>
</li>
<li>
<p>You can determine the sector size value that has either been assumed or explicitly set for a successful disk group creation by querying the <code>V$ASM_ATTRIBUTE</code> view or run the ASMCMD <code>lsattr</code> command. You can also query the <code>SECTOR_SIZE</code> column in the <code>V$ASM_DISKGROUP</code> view.</p>
<pre>
SQL&gt; SELECT name, value FROM V$ASM_ATTRIBUTE 
     WHERE name = 'sector_size' AND group_number = 1;
NAME                        VALUE
--------------------------- -----------------------
sector_size                 512

SQL&gt; SELECT group_number, sector_size FROM V$ASM_DISKGROUP 
     WHERE group_number = 1;

GROUP_NUMBER SECTOR_SIZE
------------ -----------
           1         512
</pre></li>
<li>
<p>Not all disks support all of the possible <code>SECTOR_SIZE</code> values. The sector size attribute setting must be compatible with the physical hardware.</p>
</li>
</ul>
<p>As shown in <a href="#CHDFFDAD">Example 4-3</a>, you can use the <code>SECTOR_SIZE</code> attribute with the <code>CREATE</code> <code>DISKGROUP</code> SQL statement to specify the sector size of the disk drive on which the Oracle ASM disk group is located.</p>
<div class="example">
<p class="titleinexample"><a id="CHDFFDAD"></a><a id="OSTMG94110"></a>Example 4-3 Creating a disk group of 4K sector size</p>
<pre>
CREATE DISKGROUP data NORMAL REDUNDANCY
FAILGROUP controller1 DISK
'/devices/diska1',
'/devices/diska2',
'/devices/diska3',
'/devices/diska4'
FAILGROUP controller2 DISK
'/devices/diskb1',
'/devices/diskb2',
'/devices/diskb3',
'/devices/diskb4'
ATTRIBUTE 'compatible.asm' = '11.2', 'compatible.rdbms' = '11.2',
          'sector_size'='4096';
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the disk group attributes and the <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><code>CREATE DISKGROUP</code></a> SQL statement</p>
</li>
<li>
<p><a class="olink SQLRF01602" href="../../server.112/e41084/clauses004.htm#SQLRF01602"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <code>BLOCKSIZE</code> keyword</p>
</li>
<li>
<p><a class="olink REFRN003" href="../../server.112/e40402/dynviews_part.htm#REFRN003"><span class="italic">Oracle Database Reference</span></a> for details about the <code>V$ASM_ATTRIBUTE</code> and <code>V$ASM_DISKGROUP</code> views</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDBGAFB"></a><a id="OSTMG10204"></a>
<div class="sect2">
<h3 class="sect2">Oracle Cluster Registry and Voting Files in Oracle ASM Disk Groups</h3>
<p><a id="sthref256"></a><a id="sthref257"></a><a id="sthref258"></a><a id="sthref259"></a><a id="sthref260"></a>You can store Oracle Cluster Registry (OCR) and voting files in Oracle ASM disk groups. The voting files and OCR are two important components of Oracle Clusterware.</p>
<p>Voting files manage information about node membership. OCR is a system that manages cluster and Oracle Real Application Clusters (Oracle RAC) database configuration information. A <a id="sthref261"></a><a id="sthref262"></a>quorum failure group is a special type of failure group and disks in these failure groups do not contain user data. A quorum failure group is not considered when determining redundancy requirements in respect to storing user data. However, a quorum failure group counts when mounting a disk group. For information about failure groups, see <a href="#CHDDBHCH">"Oracle ASM Failure Groups"</a>.</p>
<p>You can manage and monitor OCR and voting files with the following:</p>
<ul>
<li>
<p>The CRSCTL and <code>ocrconfig</code> command-line tools</p>
<p>The CRSCTL and <code>ocrconfig</code> commands enable the placement of OCR storage and Cluster Synchronization Services (CSS) voting files inside the disk groups managed by Oracle ASM.</p>
</li>
<li>
<p><code>CREATE</code>/<code>ALTER</code> <code>DISKGROUP</code> SQL Statements</p>
<p>The SQL keywords <code>QUORUM</code> and <code>REGULAR</code> enable the specification of disk and failure groups when creating or altering disk groups.</p>
<p>See <a href="#CHDBIHEH">Example 4-4</a>.</p>
</li>
<li>
<p><code>V$ASM</code> views</p>
<p>The <code>FAILGROUP_TYPE</code> column in both the <code>V$ASM_DISK</code> and <code>V$ASM_DISK_STAT</code> views specifies failure group type. The value for this column is <code>REGULAR</code> for regular failure groups and <code>QUORUM</code> for quorum failure groups.</p>
<p>The <code>VOTING_FILE</code> column in both the <code>V$ASM_DISK</code> and <code>V$ASM_DISK_STAT</code> views specifies whether a disk contains a voting file. The value for this column is either <code>Y</code> if the disk contains a voting file or <code>N</code> if not.</p>
<p>Note that the value of <code>USABLE_FILE_MB</code> in <code>V$ASM_DISKGROUP</code> and <code>V$ASM_DISKGROUP_STAT</code> does not consider any free space that is present in <code>QUORUM</code> disks because that space is not available for client data files.</p>
<p>See <a href="asmviews.htm#i1009568">"Views Containing Oracle ASM Disk Group Information"</a>.</p>
</li>
</ul>
<p>The <code>QUORUM</code> and <code>REGULAR</code> keywords provide an additional qualifier for failure group or disk specifications when creating or altering a disk group. <code>QUORUM</code> disks (or disks in <code>QUORUM</code> failure groups) cannot have client data files, whereas <code>REGULAR</code> disks (or disks in non-quorum failure groups) have no such restriction.</p>
<p>You can use these keywords before the keyword <code>FAILGROUP</code> if a failure group is being explicitly specified. If the failure group is implicitly implied, you can use these keywords (<code>QUORUM</code>/<code>REGULAR</code>) before the keyword <code>DISK</code>. When failure groups are explicitly specified, it is an error to specify these keywords (<code>QUORUM</code>/<code>REGULAR</code>) immediately before the keyword <code>DISK</code>. <code>REGULAR</code> is the default failure group type.</p>
<p>When performing operations on existing disks or failure groups, the qualifier specified in the SQL must match the qualifier that was specified when the disks or failure groups were added to the disk group.</p>
<p><a href="#CHDBIHEH">Example 4-4</a> shows the creation of a disk group with a <code>QUORUM</code> failure group. For Oracle Clusterware files a minimum of three disk devices or three failure groups is required with a normal redundancy disk group. A <code>QUORUM</code> failure group is not considered when determining redundancy requirements in respect to storing user data.</p>
<p>The <code>COMPATIBLE.ASM</code> disk group compatibility attribute must be set to <code>11.2</code> or greater to store OCR or voting files in a disk group.</p>
<div class="example">
<p class="titleinexample"><a id="CHDBIHEH"></a><a id="OSTMG94111"></a>Example 4-4 Using the QUORUM keyword</p>
<pre>
CREATE DISKGROUP ocr_data NORMAL REDUNDANCY
   FAILGROUP fg1 DISK '/devices/diskg1'
   FAILGROUP fg2 DISK '/devices/diskg2'
   QUORUM FAILGROUP fg3 DISK '/devices/diskg3'
   ATTRIBUTE 'compatible.asm' = '11.2.0.0.0';
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink GINST" href="http://www.oracle.com/pls/topic/lookup?ctx=db112&amp;id=GINST"><span class="italic">Oracle Grid Infrastructure Installation Guide</span></a> for information about configuring voting files and Oracle Cluster Registry (OCR)</p>
</li>
<li>
<p><a class="olink CWADD833" href="../../rac.112/e41959/votocr.htm#CWADD833"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about administering voting files and Oracle Cluster Registry (OCR) using CRSCTL and <code>ocrconfig</code> commands</p>
</li>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about the <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><code>CREATE DISKGROUP</code></a> and <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> SQL statements</p>
</li>
<li>
<p><a class="olink REFRN003" href="../../server.112/e40402/dynviews_part.htm#REFRN003"><span class="italic">Oracle Database Reference</span></a> for details about the <code>V$ASM</code>* dynamic performance views</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1019476"></a><a id="OSTMG10070"></a>
<div class="sect1">
<h2 class="sect1">Altering Disk Groups</h2>
<p><a id="sthref263"></a><a id="sthref264"></a><a id="sthref265"></a><a id="sthref266"></a><a id="sthref267"></a><a id="sthref268"></a>You can use the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER</code> <code>DISKGROUP</code></a> SQL statement to alter a disk group configuration. You can add, resize, or drop disks while the database remains online. Whenever possible, multiple operations in a single <code>ALTER</code> <code>DISKGROUP</code> statement are recommended. Grouping operations in a single <code>ALTER</code> <code>DISKGROUP</code> statement can reduce rebalancing operations.</p>
<p>Oracle ASM automatically rebalances when the configuration of a disk group changes. By default, the <code>ALTER</code> <code>DISKGROUP</code> statement does not wait until the operation is complete before returning. Query the <code>V$ASM_OPERATION</code> view to monitor the status of this operation.</p>
<p>Use the <code>REBALANCE</code> <code>WAIT</code> clause to cause the <code>ALTER</code> <code>DISKGROUP</code> statement processing to wait until the rebalance operation is complete before returning. This is especially useful in scripts. The statement also accepts a <code>REBALANCE</code> <code>NOWAIT</code> clause that invokes the default behavior of conducting the rebalance operation asynchronously in the background.</p>
<p>You can interrupt a rebalance running in wait mode by typing <code>CTRL-C</code> on most platforms. This causes the statement to return immediately with the message <code>ORA-01013: user requested cancel of current operation</code>, and then to continue the operation asynchronously. Typing <code>CTRL-C</code> does not cancel the rebalance operation or any disk add, drop, or resize operations.</p>
<p>To control the speed and resource consumption of the rebalance operation, you can include the <code>REBALANCE</code> <code>POWER</code> clause in statements that add, drop, or resize disks. Refer to <a href="#BABCCEAB">"Manually Rebalancing Disk Groups"</a> for more information about this clause.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDFBFJD">Managing Volumes in a Disk Group</a></p>
</li>
<li>
<p><a href="#CHDBIFGA">Adding Disks to a Disk Group</a></p>
</li>
<li>
<p><a href="#CHDFJADJ">Dropping Disks from Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDICBEB">Intelligent Data Placement</a></p>
</li>
<li>
<p><a href="#CHDCJFAF">Resizing Disks in Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDJDHHE">Undropping Disks in Disk Groups</a></p>
</li>
<li>
<p><a href="#BABCCEAB">Manually Rebalancing Disk Groups</a></p>
</li>
<li>
<p><a href="#i1027260">Tuning Rebalance Operations</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> SQL statement in the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
<a id="CHDFBFJD"></a><a id="OSTMG10072"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Managing Volumes in a Disk Group</h3>
<p>You can create an Oracle ASM Dynamic Volume Manager (Oracle ADVM) volume in a disk group. The volume device associated with the dynamic volume can then be used to host an Oracle ACFS file system.</p>
<p>The compatibility parameters <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.ADVM</code> must be set to 11.2 or higher for the disk group. See <a href="#CHDCACGC">"Disk Group Compatibility Attributes"</a>.</p>
<p>The <code>ALTER</code> <code>DISKGROUP</code> <code>VOLUME</code> SQL statements enable you to manage Oracle ADVM volumes, including the functionality to add, modify, resize, disable, enable, and drop volumes. The following are examples of the <code>ALTER</code> <code>DISKGROUP</code> <code>VOLUME</code> statement.</p>
<div class="example">
<p class="titleinexample"><a id="OSTMG94112"></a><a id="sthref269"></a>Example 4-5 Managing volumes with ALTER DISKGROUP VOLUME statements</p>
<pre>
SQL&gt; ALTER DISKGROUP data ADD VOLUME volume1 SIZE 10G;
Diskgroup altered.

SQL&gt; ALTER DISKGROUP data RESIZE VOLUME volume1 SIZE 15G;
Diskgroup altered.

SQL&gt; ALTER DISKGROUP data DISABLE VOLUME volume1;
Diskgroup altered.

SQL&gt; ALTER DISKGROUP data ENABLE VOLUME volume1;
Diskgroup altered.

SQL&gt; ALTER DISKGROUP ALL DISABLE VOLUME ALL;
Diskgroup altered.

SQL&gt; ALTER DISKGROUP data DROP VOLUME volume1;
Diskgroup altered.
</pre></div>
<!-- class="example" -->
<p>If the volume is hosting an Oracle ACFS file system, then you cannot resize that volume with the SQL <code>ALTER</code> <code>DISKGROUP</code> statement. Instead you must use the <code>acfsutil</code> <code>size</code> command. For information, see <a href="asmfs_util010.htm#CACBACBA">"acfsutil size"</a>.</p>
<p>For information about Oracle ADVM, see <a href="asmfilesystem.htm#CACHFACJ">"Overview of Oracle ASM Dynamic Volume Manager"</a>. For information about managing Oracle ADVM volumes with ASMCMD, see <a href="asm_util007.htm#CIHDACEH">"ASMCMD Volume Management Commands"</a>. For information about managing Oracle ADVM volumes with ASMCA, see <a href="asmca.htm#CHDGCJFH">"Managing Oracle ADVM Volumes with Oracle ASM Configuration Assistant"</a>. For information about managing Oracle ADVM volumes with Oracle Enterprise Manager, see <a href="asmfs_em.htm#CHDBHGCF">"Managing Oracle ACFS with Oracle Enterprise Manager"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> SQL statement in the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect2" -->
<a id="CHDBIFGA"></a><a id="OSTMG10071"></a>
<div class="sect2">
<h3 class="sect2">Adding Disks to a Disk Group</h3>
<p>You can use the <code>ADD</code> clause of the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> statement to add a disk or a failure group to a disk group. You can use the same syntax with the <code>ALTER DISKGROUP</code> statement that you use to add a disk or failure group with the <code>CREATE</code> <code>DISKGROUP</code> statement. For an example of the <code>CREATE</code> <code>DISKGROUP</code> SQL statement, refer to <a href="#CHDDEHJH">Example 4-1</a>. After you add new disks, the new disks gradually begin to accommodate their share of the workload as rebalancing progresses.</p>
<p>Oracle ASM behavior when adding disks to a disk group is best illustrated through<a href="#CHDDFBIH">"Adding Disks to a Disk Group with SQL Statements"</a>. You can also add disks to a disk group with Oracle Enterprise Manager, described in <a href="asm_em.htm#CIAEDBGF">"Adding Disks to Disk Groups"</a>.</p>
<a id="CHDDFBIH"></a><a id="OSTMG94113"></a>
<div class="sect3">
<h4 class="sect3">Adding Disks to a Disk Group with SQL Statements</h4>
<p>The statements presented in this example demonstrate the interactions of disk discovery with the <code>ADD</code> <code>DISK</code> operation.</p>
<p>Assume that disk discovery identifies the following disks in directory <code>/devices</code>:</p>
<br />
<code>/devices/diska1</code> -- member of <code>data1</code><br />
<code>/devices/diska2</code> -- member of <code>data1</code><br />
<code>/devices/diska3</code> -- member of <code>data1</code><br />
<code>/devices/diska4</code> -- member of <code>data1</code><br />
<code>/devices/diska5</code> -- candidate disk<br />
<code>/devices/diska6</code> -- candidate disk<br />
<code>/devices/diska7</code> -- candidate disk<br />
<code>/devices/diska8</code> -- candidate disk<br />
<br />
<code>/devices/diskb1</code> -- member of <code>data1</code><br />
<code>/devices/diskb2</code> -- member of <code>data1</code><br />
<code>/devices/diskb3</code> -- member of <code>data1</code><br />
<code>/devices/diskb4</code> -- member of <code>data2</code><br />
<br />
<code>/devices/diskc1</code> -- member of <code>data2</code><br />
<code>/devices/diskc2</code> -- member of <code>data2</code><br />
<code>/devices/diskc3</code> -- member of <code>data3</code><br />
<code>/devices/diskc4</code> -- candidate disk<br />
<br />
<code>/devices/diskd1</code> -- candidate disk<br />
<code>/devices/diskd2</code> -- candidate disk<br />
<code>/devices/diskd3</code> -- candidate disk<br />
<code>/devices/diskd4</code> -- candidate disk<br />
<code>/devices/diskd5</code> -- candidate disk<br />
<code>/devices/diskd6</code> -- candidate disk<br />
<code>/devices/diskd7</code> -- candidate disk<br />
<code>/devices/diskd8</code> -- candidate disk<br />
<p>You can query the <code>V$ASM_DISK</code> view to display the status of Oracle ASM disks. See <a href="asmviews.htm#i1009568">"Views Containing Oracle ASM Disk Group Information"</a>.</p>
<p>The following statement would fail because <code>/devices/diska1</code> - <code>/devices/diska4</code> already belong to the disk group <code>data1</code>.</p>
<pre>
ALTER DISKGROUP data1 ADD DISK
     '/devices/diska*';
</pre>
<p>The following statement successfully adds disks <code>/devices/diska5</code> through <code>/devices/diska8</code> to <code>data1</code>. Because no <code>FAILGROUP</code> clauses are included in the <code>ALTER DISKGROUP</code> statement, each disk is assigned to its own failure group. The <code>NAME</code> clauses assign names to the disks, otherwise they would have been assigned system-generated names.</p>
<pre>
ALTER DISKGROUP data1 ADD DISK
     '/devices/diska5' NAME diska5,
     '/devices/diska6' NAME diska6,
     '/devices/diska7' NAME diska7,
     '/devices/diska8' NAME diska8;
</pre>
<p>The following statement would fail because the search string matches disks that are contained in other disk groups. Specifically, <code>/devices/diska4</code> belongs to disk group <code>data1</code> and <code>/devices/diskb4</code> belongs to disk group <code>data2</code>.</p>
<pre>
ALTER DISKGROUP data1 ADD DISK
     '/devices/disk*4';
</pre>
<p>The following statement would successfully add <code>/devices/diskd1</code> through <code>/devices/diskd8</code> to disk group <code>data1</code>. This statement runs with a rebalance power of 5, and does not return until the rebalance operation is complete.</p>
<pre>
ALTER DISKGROUP data1 ADD DISK
      '/devices/diskd*'
       REBALANCE POWER 5 WAIT;
</pre>
<p>If <code>/devices/diskc3</code> was previously a member of a disk group that no longer exists, then you could use the <code>FORCE</code> option to add the disk as a member of another disk group. For example, the following use of the <code>FORCE</code> clause enables <code>/devices/diskc3</code> to be added to <code>data2</code>, even though it is a current member of <code>data3</code>. For this statement to succeed, <code>data3</code> cannot be mounted.</p>
<pre>
ALTER DISKGROUP data2 ADD DISK
     '/devices/diskc3' FORCE;
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDFJADJ"></a><a id="OSTMG10222"></a>
<div class="sect2">
<h3 class="sect2">Dropping Disks from Disk Groups</h3>
<p><a id="sthref270"></a><a id="sthref271"></a>To drop disks from a disk group, use the <code>DROP</code> <code>DISK</code> clause of the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> statement. You can also drop all of the disks in specified failure groups using the <code>DROP</code> <code>DISKS</code> <code>IN</code> <code>FAILGROUP</code> clause.</p>
<p>When a disk is dropped, the disk group is rebalanced by moving all of the file extents from the dropped disk to other disks in the disk group. A drop disk operation might fail if not enough space is available on the other disks. The best approach is to perform both the add and drop operation with the same <code>ALTER</code> <code>DISKGROUP</code> statement. This has the benefit of rebalancing data extents only one time and ensuring that there is enough space for the rebalance operation to succeed.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
The <code>ALTER</code> <code>DISKGROUP</code><code>...</code><code>DROP</code> <code>DISK</code> SQL statement returns to SQL prompt before the drop and rebalance operations are complete. Do not reuse, remove, or disconnect the dropped disk until the <code>HEADER_STATUS</code> column for this disk in the <code>V$ASM_DISK</code> view changes to <code>FORMER</code>. You can query the <code>V$ASM_OPERATION</code> view to determine the amount of time remaining for the drop/rebalance operation to complete. For more information, refer to the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a> and the <a class="olink REFRN30173" href="../../server.112/e40402/dynviews_1031.htm#REFRN30173"><span class="italic">Oracle Database Reference</span></a>.</div>
<p>If you specify the <code>FORCE</code> clause for the drop operation, the disk is dropped even if Oracle ASM cannot read or write to the disk. You cannot use the <code>FORCE</code> flag when dropping a disk from an external redundancy disk group.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
A <code>DROP</code> <code>FORCE</code> operation leaves data at reduced redundancy until the subsequent rebalance operation completes. This increases your exposure to data loss if there is a subsequent disk failure during rebalancing. Use <code>DROP</code> <code>FORCE</code> with caution.</div>
<p>You can also drop disks from a disk group with Oracle Enterprise Manager. See <a href="asm_em.htm#CIABDHEH">"Dropping Disks from Disk Groups"</a>.</p>
<p>The statements in <a href="#CHDJIJEH">Example 4-6</a> demonstrate how to drop disks from the disk group <code>data1</code> described in <a href="#CHDDFBIH">"Adding Disks to a Disk Group with SQL Statements"</a>. The first example drops <code>diska5</code> from disk group <code>data1</code>. The second example drops <code>diska5</code> from disk group <code>data1</code>, and also illustrates how multiple actions are possible with one <code>ALTER DISKGROUP</code> statement.</p>
<div class="example">
<p class="titleinexample"><a id="CHDJIJEH"></a><a id="OSTMG94114"></a>Example 4-6 Dropping disks from disk groups</p>
<pre>
ALTER DISKGROUP data1 DROP DISK diska5;

ALTER DISKGROUP data1 DROP DISK diska5
     ADD FAILGROUP failgrp1 DISK '/devices/diska9' NAME diska9;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHDICBEB"></a><a id="OSTMG13790"></a>
<div class="sect2">
<h3 class="sect2">Intelligent Data Placement</h3>
<p><a id="sthref272"></a><a id="sthref273"></a><a id="sthref274"></a><a id="sthref275"></a><a id="sthref276"></a><a id="sthref277"></a>Intelligent Data Placement enables you to specify disk regions on Oracle ASM disks for best performance. Using the disk region settings, you can ensure that frequently accessed data is placed on the outermost (hot) tracks which have greater speed and higher bandwidth. In addition, files with similar access patterns are located physically close, reducing latency. Intelligent Data Placement also enables the placement of primary and mirror extents into different hot or cold regions.</p>
<p>Intelligent Data Placement settings can be specified for a file or in disk group templates. The disk region settings can be modified after the disk group has been created. The disk region setting can improve I/O performance by placing more frequently accessed data in regions furthest from the spindle, while reducing your cost by increasing the usable space on a disk.</p>
<p>Intelligent Data Placement works best for the following:</p>
<ul>
<li>
<p>Databases with data files that are accessed at different rates. A database that accesses all data files in the same way is unlikely to benefit from Intelligent Data Placement.</p>
</li>
<li>
<p>Disk groups that are more than 25% full. If the disk group is only 25% full, the management overhead is unlikely to be worth any benefit.</p>
</li>
<li>
<p>Disks that have better performance at the beginning of the media relative to the end. Because Intelligent Data Placement leverages the geometry of the disk, it is well suited to JBOD (just a bunch of disks). In contrast, a storage array with LUNs composed of concatenated volumes masks the geometry from Oracle ASM.</p>
</li>
</ul>
<p>The <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group attributes must be set to 11.2 or higher to use Intelligent Data Placement.</p>
<p>Intelligent Data Placement can be managed with the <code>ALTER</code> <code>DISKGROUP</code> <code>ADD</code> or <code>MODIFY</code> <code>TEMPLATE</code> SQL statements and the <code>ALTER</code> <code>DISKGROUP</code> <code>MODIFY</code> <code>FILE</code> SQL statement.</p>
<ul>
<li>
<p>The <code>ALTER</code> <code>DISKGROUP</code> <code>TEMPLATE</code> SQL statement includes a disk region clause for setting <code><span class="codeinlineitalic">hot</span></code>/<code><span class="codeinlineitalic">mirrorhot</span></code> or <code><span class="codeinlineitalic">cold</span></code>/<code><span class="codeinlineitalic">mirrorcold</span></code> regions in a template:</p>
<pre>
ALTER DISKGROUP data ADD TEMPLATE datafile_hot
  ATTRIBUTE ( 
    HOT
    MIRRORHOT);
</pre></li>
<li>
<p>The <code>ALTER</code> <code>DISKGROUP</code> ... <code>MODIFY</code> <code>FILE</code> SQL statement that sets disk region attributes for <code><span class="codeinlineitalic">hot</span></code>/<code><span class="codeinlineitalic">mirrorhot</span></code> or <code><span class="codeinlineitalic">cold</span></code>/<code><span class="codeinlineitalic">mirrorcold</span></code> regions:</p>
<pre>
ALTER DISKGROUP <span class="italic">data</span> MODIFY FILE '+data/orcl/datafile/users.259.679156903'
  ATTRIBUTE ( 
    HOT
    MIRRORHOT);
</pre>
<p><a id="sthref278"></a><a id="sthref279"></a><a id="sthref280"></a>When you modify the disk region settings for a file, this action applies to new extensions of the file, but existing file contents are not affected until a rebalance operation. To apply the new Intelligent Data Placement policy for existing file contents, you can manually initiate a rebalance. A rebalance operation uses the last specified policy for the file extents. For information on the rebalance operation, see <a href="#BABCCEAB">"Manually Rebalancing Disk Groups"</a>.</p>
</li>
</ul>
<p>Oracle ASM Configuration Assistant (ASMCA) supports Intelligent Data Placement with template creation during disk group alterations. See <a href="asmca.htm#CHDJIBAJ">"Managing Disk Groups with Oracle ASM Configuration Assistant"</a>.</p>
<p>Oracle Enterprise Manager supports Intelligent Data Placement from the <span class="bold">Templates</span> page launched from the disk group page. See <a href="asm_em.htm#CBBGIHCF">"Managing Disk Group Templates with Oracle Enterprise Manager"</a>.</p>
<p>To display information about Intelligent Data Placement regions, see <a href="asmviews.htm#CHDJJGCI">"Viewing Disk Region Information"</a> and <a href="asm_util004.htm#CIHFIHBA">"iostat"</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDCJFAF"></a><a id="OSTMG94115"></a>
<div class="sect2">
<h3 class="sect2">Resizing Disks in Disk Groups</h3>
<p><a id="sthref281"></a><a id="sthref282"></a>The <code>RESIZE</code> clause of <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> enables you to perform the following operations:</p>
<ul>
<li>
<p>Resize all disks in the disk group</p>
</li>
<li>
<p>Resize specific disks</p>
</li>
<li>
<p>Resize all of the disks in a specified failure group</p>
</li>
</ul>
<p>If you do not specify a new size in the <code>SIZE</code> clause, then Oracle ASM uses the size of the disk as returned by the operating system. The new size is written to the Oracle ASM disk header and if the size of the disk is increasing, then the new space is immediately available for allocation. If the size is decreasing, rebalancing must relocate file extents beyond the new size limit to available space below the limit. If the rebalance operation can successfully relocate all extents, then the new size is made permanent, otherwise the rebalance fails.</p>
<p>The following example resizes all of the disks in failure group <code>failgrp1</code> of disk group <code>data1</code>. If the new size is greater than disk capacity, the statement fails.</p>
<div class="example">
<p class="titleinexample"><a id="OSTMG94116"></a><a id="sthref283"></a>Example 4-7 Resizing disks in disk groups</p>
<pre>
ALTER DISKGROUP data1 
     RESIZE DISKS IN FAILGROUP failgrp1 SIZE 100G;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHDJDHHE"></a><a id="OSTMG94117"></a>
<div class="sect2">
<h3 class="sect2">Undropping Disks in Disk Groups</h3>
<p><a id="sthref284"></a><a id="sthref285"></a>The <code>UNDROP DISKS</code> clause of the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> statement enables you to cancel all pending drops of disks within disk groups. If a drop disk operation has completed, then this statement cannot be used to restore it. This statement cannot be used to restore disks that are being dropped as the result of a <a class="olink SQLRF01517" href="../../server.112/e41084/statements_8013.htm#SQLRF01517"><code>DROP DISKGROUP</code></a> statement, or for disks that are being dropped using the <code>FORCE</code> clause.</p>
<p>The following example cancels the dropping of disks from disk group <code>data1</code>:</p>
<div class="example">
<p class="titleinexample"><a id="OSTMG94118"></a><a id="sthref286"></a>Example 4-8 Undropping disks in disk groups</p>
<pre>
ALTER DISKGROUP data1 UNDROP DISKS;
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="BABCCEAB"></a><a id="OSTMG10080"></a>
<div class="sect2">
<h3 class="sect2">Manually Rebalancing Disk Groups</h3>
<p><a id="sthref287"></a><a id="sthref288"></a>You can manually rebalance the files in a disk group using the <code>REBALANCE</code> clause of the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> statement. This would normally not be required, because Oracle ASM automatically rebalances disk groups when their configuration changes. You might want to do a manual rebalance operation to control the speed of what would otherwise be an automatic rebalance operation.</p>
<p>The <code>POWER</code> clause of the <code>ALTER</code> <code>DISKGROUP</code> ... <code>REBALANCE</code> statement specifies the degree of parallelism, and thus the speed of the rebalance operation. It can be set to a minimum value of 0 which halts a rebalancing operation until the statement is either implicitly or explicitly re-run. A higher value increases the speed of the rebalance operation.</p>
<p>The default rebalance power is set by the <code>ASM_POWER_LIMIT</code> initialization parameter. The range of values for the <code>POWER</code> clause is the same for the <code>ASM_POWER_LIMIT</code> initialization parameter. For information about the <code>ASM_POWER_LIMIT</code> initialization parameter, refer to <a href="asminst.htm#BHCDHJFA">"ASM_POWER_LIMIT"</a>.</p>
<p>The power level of an ongoing rebalance operation can be changed by entering the rebalance statement with a new level.</p>
<p>The <code>ALTER DISKGROUP...REBALANCE</code> command by default returns immediately so that you can run other commands while the rebalance operation takes place asynchronously in the background. You can query the <code>V$ASM_OPERATION</code> view for the status of the rebalance operation.</p>
<p>To cause the <code>ALTER DISKGROUP...REBALANCE</code> command to wait until the rebalance operation is complete before returning, add the <code>WAIT</code> keyword to the <code>REBALANCE</code> clause. The wait functionality is especially useful in scripts. The command also accepts a <code>NOWAIT</code> keyword, which invokes the default behavior of conducting the rebalance operation asynchronously. You can interrupt a rebalance running in wait mode by typing <code>CTRL-C</code> on most platforms. This causes the command to return immediately with the message <code>ORA-01013: user requested cancel of current operation</code>, and then continue the rebalance operation asynchronously.</p>
<p>Additional rules for the rebalance operation include the following:</p>
<ul>
<li>
<p>An ongoing rebalance command is restarted if the storage configuration changes either when you alter the configuration, or if the configuration changes due to a failure or an outage. Furthermore, if the new rebalance fails because of a user error, then a manual rebalance may be required.</p>
</li>
<li>
<p>The <code>ALTER DISKGROUP...REBALANCE</code> statement runs on a single node even if you are using Oracle Real Application Clusters (Oracle RAC).</p>
</li>
<li>
<p>Oracle ASM can perform one disk group rebalance at a time on a given instance. If you have initiated multiple rebalances on different disk groups on a single node, then Oracle processes these operations in parallel on additional nodes if available; otherwise the rebalances are performed serially on the single node. You can explicitly initiate rebalances on different disk groups on different nodes in parallel.</p>
</li>
<li>
<p>Rebalancing continues across a failure of the Oracle ASM instance performing the rebalance.</p>
</li>
<li>
<p>The <code>REBALANCE</code> clause (with its associated <code>POWER</code> and <code>WAIT/NOWAIT</code> keywords) can also be used in <code>ALTER DISKGROUP</code> commands that add, drop, or resize disks.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle restarts the processing of an ongoing rebalance operation if the storage configuration changes. If the next rebalance operation fails because of a user error, then a manual rebalance may be required.</div>
</li>
</ul>
<p>The following example manually rebalances the disk group <code>data2</code>. The command does not return until the rebalance operation is complete.</p>
<div class="example">
<p class="titleinexample"><a id="OSTMG94119"></a><a id="sthref289"></a>Example 4-9 Manually rebalancing a disk group</p>
<pre>
ALTER DISKGROUP data2 REBALANCE POWER 5 WAIT;
</pre></div>
<!-- class="example" -->
<p>For more information about rebalancing operations, refer to <a href="#i1027260">"Tuning Rebalance Operations"</a>.</p>
</div>
<!-- class="sect2" -->
<a id="i1027260"></a><a id="OSTMG10221"></a>
<div class="sect2">
<h3 class="sect2">Tuning Rebalance Operations</h3>
<p><a id="sthref290"></a>If the <code>POWER</code> clause is not specified in an <code>ALTER</code> <code>DISKGROUP</code> statement, or when rebalance is implicitly run by adding or dropping a disk, then the rebalance power defaults to the value of the <code>ASM_POWER_LIMIT</code> initialization parameter. You can adjust the value of this parameter dynamically.</p>
<p>The higher the power limit, the more quickly a rebalance operation can complete. Rebalancing takes longer with lower power values, but consumes fewer processing and I/O resources which are shared by other applications, such as the database.</p>
<p>Oracle ASM tries to keep a rebalance I/O for each unit of power. Each I/O requires PGA memory for the extent involved in the relocation.</p>
<p>The default value of <code>1</code> minimizes disruption to other applications. The appropriate value is dependent on your hardware configuration, performance requirements, and availability requirements.</p>
<p>If a rebalance is in progress because a disk is manually or automatically dropped, then increasing the power of the rebalance shortens the time frame during which redundant copies of that data on the dropped disk are reconstructed on other disks.</p>
<p>The <code>V$ASM_OPERATION</code> view provides information for adjusting <code>ASM_POWER_LIMIT</code> and the resulting power of rebalance operations. The <code>V$ASM_OPERATION</code> view also gives an estimate in the <code>EST_MINUTES</code> column of the amount of time remaining for the rebalance operation to complete. You can see the effect of changing the rebalance power by observing the change in the time estimate.</p>
<p>The range of values for the <code>POWER</code> clause is the same for the <code>ASM_POWER_LIMIT</code> initialization parameter. For information about the <code>ASM_POWER_LIMIT</code> initialization parameter, refer to <a href="asminst.htm#BHCDHJFA">"ASM_POWER_LIMIT"</a>.</p>
<p>For more information about rebalancing disk groups, refer to <a href="#BABCCEAB">"Manually Rebalancing Disk Groups"</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDHDDBE"></a><a id="OSTMG94120"></a>
<div class="sect1">
<h2 class="sect1"><a id="sthref291"></a>Oracle ASM Disk Discovery</h2>
<p><a id="sthref292"></a><a id="sthref293"></a><a id="sthref294"></a><a id="sthref295"></a>Disk discovery is the mechanism used to find the operating system names for disks Oracle ASM can access. It is used to find all the disks that comprise a disk group to be mounted, the disks an administrator wants to add to a disk group, or the disks the administrator might consider adding to a disk group. This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDEDBBG">How A Disk is Discovered</a></p>
</li>
<li>
<p><a href="#CHDEIIAB">Disk Discovery Rules</a></p>
</li>
<li>
<p><a href="#i1027269">Improving Disk Discovery Time</a></p>
</li>
</ul>
<p>For additional information about disk discovery and the <code>ASM_DISKSTRING</code> initialization parameter, refer to <a href="asminst.htm#BHCEHJGA">"ASM_DISKSTRING"</a>.</p>
<a id="CHDEDBBG"></a><a id="OSTMG94121"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How A Disk is Discovered</h3>
<p><a id="sthref296"></a><a id="sthref297"></a><a id="sthref298"></a>When an Oracle ASM instance is initialized, Oracle ASM discovers and examines the contents of all of the disks that are in the paths that you designated with values in the <code>ASM_DISKSTRING</code> initialization parameter.</p>
<p>Disk discovery also occurs when you:</p>
<ul>
<li>
<p>Run the following SQL statements</p>
<ul>
<li>
<p>Mount a disk group with <code>ALTER</code> <code>DISKGROUP</code> ... <code>MOUNT</code></p>
</li>
<li>
<p>Online a disk with <code>ALTER</code> <code>DISKGROUP</code> ... <code>ONLINE</code> <code>DISK</code></p>
</li>
<li>
<p>Add a disk to a disk group with <code>CREATE</code> or <code>ALTER</code> <code>DISKGROUP</code>...<code>ADD</code> <code>DISK</code></p>
</li>
<li>
<p>Resize a disk in a disk group with <code>ALTER</code> <code>DISKGROUP</code>...<code>RESIZE</code> <code>DISK</code></p>
</li>
<li>
<p>Query with <code>SELECT</code> ... <code>FROM</code> <code>V$ASM_DISKGROUP</code> or <code>V$ASM_DISK</code> views</p>
</li>
</ul>
</li>
<li>
<p>Run Oracle Enterprise Manager or Oracle ASM Configuration Assistant (ASMCA) operations that invoke the SQL statements previously listed</p>
</li>
<li>
<p>Run ASMCMD commands that perform the same operations as the SQL statements previously listed</p>
</li>
</ul>
<p>After Oracle ASM successfully discovers a disk, the disk appears in the <code>V$ASM_DISK</code> view. Disks that belong to a disk group, that is, disks that have a disk group name in the disk header, show a header status of <code>MEMBER</code>. Disks that were discovered, but that have not yet been assigned to a disk group, have a status of either <code>CANDIDATE</code> or <code>PROVISIONED</code>. Disks that previously belonged to a disk group and were dropped cleanly from the disk group have a status of <code>FORMER</code>.</p>
<p>The <code>PROVISIONED</code> status implies that an additional platform-specific action has been taken by an administrator to make the disk available for Oracle ASM. For example, on Windows computers, the administrator might have used <code>asmtool</code> or <code>asmtoolg</code> to stamp the disk with a header. On Linux computers, the administrator might have used ASMLib to prepare the disk for Oracle ASM.</p>
<p><a href="#CHDBIFBD">Example 4-10</a> shows a SQL query on <code>V$ASM_DISK</code> that displays the header status of a group of disks.</p>
<div class="example">
<p class="titleinexample"><a id="CHDBIFBD"></a><a id="OSTMG94122"></a>Example 4-10 Querying V$ASM_DISK for header status</p>
<pre>
SQL&gt; SELECT name, header_status, path FROM V$ASM_DISK 
     WHERE path LIKE '/devices/disk0%'

NAME      HEADER_STATUS PATH
--------- ------------- ---------------------
          FORMER        /devices/disk02
          FORMER        /devices/disk01
          CANDIDATE     /devices/disk07
DISK06    MEMBER        /devices/disk06
DISK05    MEMBER        /devices/disk05
DISK04    MEMBER        /devices/disk04
DISK03    MEMBER        /devices/disk03
7 rows selected.
</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN30170" href="../../server.112/e40402/dynviews_1024.htm#REFRN30170"><span class="italic">Oracle Database Reference</span></a> for information about the header status of an Oracle ASM disk that is displayed in the <code>V$ASM_DISK</code> view</div>
</div>
<!-- class="sect2" -->
<a id="CHDEIIAB"></a><a id="OSTMG94123"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Disk Discovery Rules</h3>
<p><a id="sthref299"></a>The rules for discovering Oracle ASM disks are as follows:</p>
<ul>
<li>
<p>Oracle ASM can discover up to 10,000 disks. That is, if more than 10,000 disks match the <code>ASM_DISKSTRING</code> initialization parameter, then Oracle ASM discovers only the first 10,000.</p>
</li>
<li>
<p>Oracle ASM only discovers disk partitions. Oracle ASM does not discover partitions that include the partition table.</p>
</li>
<li>
<p>From the perspective of the installation, candidate disks are those that have the <code>CANDIDATE</code>, <code>PROVISIONED</code>, or <code>FORMER</code> header status. These disks with a <code>CANDIDATE</code>, <code>PROVISIONED</code>, or <code>FORMER</code> status can be added to Oracle ASM disk groups without using the <code>FORCE</code> flag.</p>
</li>
<li>
<p>When adding a disk, the <code>FORCE</code> option must be used if Oracle ASM recognizes that the disk was managed by Oracle. Such a disk appears in the <code>V$ASM_DISK</code> view with a status of <code>FOREIGN</code>. In this case, you can only add the disk to a disk group by using the <code>FORCE</code> keyword.</p>
</li>
<li>
<p><code>MEMBER</code> disks can usually be added to a disk group by specifying the <code>FORCE</code> flag, if the disks are not part of a currently mounted disk group.</p>
</li>
</ul>
<p>In addition, Oracle ASM identifies the following configuration errors during discovery:</p>
<ul>
<li>
<p>Multiple paths to the same disk</p>
<p>In this case, if the disk is part of a disk group, then disk group mount fails. If the disk is being added to a disk group with the <code>ADD DISK</code> or <code>CREATE DISKGROUP</code> command, then the command fails. To correct the error, adjust the <code>ASM_DISKSTRING</code> value so that Oracle ASM does not discover multiple paths to the same disk. Or if you are using multipathing software, then ensure that you include only the pseudo-device name in the <code>ASM_DISKSTRING</code> value. See <a href="asmprepare.htm#BHCJBJFD">"Oracle ASM and Multipathing"</a>.</p>
</li>
<li>
<p>Multiple Oracle ASM disks with the same disk header</p>
<p>This can be caused by having copied one disk onto another. In this case, the disk group mount operation fails.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1027269"></a><a id="OSTMG94124"></a>
<div class="sect2">
<h3 class="sect2">Improving Disk Discovery Time</h3>
<p><a id="sthref300"></a>The value for the <code>ASM_DISKSTRING</code> initialization parameter is an operating system&ndash;dependent value that Oracle ASM uses to limit the set of paths that the discovery process uses to search for disks. When a new disk is added to a disk group, each Oracle ASM instance that has the disk group mounted must be able to discover the new disk using its <code>ASM_DISKSTRING</code>.</p>
<p>In many cases, the default value (<code>NULL</code>) is sufficient. Using a more restrictive value might reduce the time required for Oracle ASM to perform discovery, and thus improve disk group mount time or the time for adding a disk to a disk group. Oracle may dynamically change the <code>ASM_DISKSTRING</code> before adding a disk so that the new disk is discovered through this parameter.</p>
<p>The default value of <code>ASM_DISKSTRING</code> might not find all disks in all situations. If your site is using a third-party vendor ASMLib, then the vendor might have discovery string conventions that you must use for <code>ASM_DISKSTRING</code>. In addition, if your installation uses multipathing software, then the software might place pseudo-devices in a path that is different from the operating system default. See <a href="asmprepare.htm#BHCJBJFD">"Oracle ASM and Multipathing"</a> and consult the multipathing vendor documentation for details.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDGGGAD"></a><a id="OSTMG10201"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing Capacity in Disk Groups</h2>
<p>When Oracle ASM provides redundancy, such as when you create a disk group with <code>NORMAL</code> or <code>HIGH</code> redundancy, <a id="sthref301"></a><a id="sthref302"></a><a id="sthref303"></a>you must have sufficient capacity in each disk group to manage a re-creation of data that is lost after a failure of one or two failure groups. After one or more disks fail, the process of restoring redundancy for all data requires space from the surviving disks in the disk group. If not enough space remains, then some files might end up with reduced redundancy.</p>
<p>Reduced redundancy means that one or more extents in the file are not mirrored at the expected level. For example, a reduced redundancy file in a high redundancy disk group has at least one file extent with two or fewer total copies of the extent instead of three. For unprotected files, data extents could be missing altogether. Other causes of reduced redundancy files are disks running out of space or an insufficient number of failure groups. The <code>REDUNDANCY_LOWERED</code> column in the <code>V$ASM_FILE</code> view <code><a id="sthref304"></a></code>provides information about files with reduced redundancy.</p>
<p>The following guidelines help ensure that you have sufficient space to restore full redundancy for all disk group data after the failure of one or more disks.</p>
<ul>
<li>
<p>Normal redundancy disk group - It is best to have enough free space in your disk group to tolerate the loss of all disks in one failure group. The amount of free space should be equivalent to the size of the largest failure group.</p>
</li>
<li>
<p>High redundancy disk group - It is best to have enough free space to cope with the loss of all disks in two failure groups. The amount of free space should be equivalent to the sum of the sizes of the two largest failure groups.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When you lose multiple disks from multiple failure groups, then you could lose both the primary and the redundant copies of your data. In addition, if you do not have enough capacity to restore redundancy, then Oracle ASM can continue to operate. However, if another disk fails, then the system may not be able to tolerate additional failures.</div>
</li>
</ul>
<p>The <code>V$ASM_DISKGROUP</code> view contains the following columns that contain information to help you manage capacity:</p>
<ul>
<li>
<p><code>REQUIRED_MIRROR_FREE_MB</code> indicates the amount of space that must be available in a disk group to restore full redundancy after the worst failure that can be tolerated by the disk group without adding additional storage. This requirement ensures that there are sufficient failure groups to restore redundancy. Also, this worst failure refers to a permanent failure where the disks must be dropped, not the case where the disks go offline and then back online.</p>
<p>The amount of space displayed in this column takes the effects of mirroring into account. The value is computed as follows:</p>
<ul>
<li>
<p>Normal redundancy disk group with more than two failure groups</p>
<p>The value is the total raw space for all of the disks in the largest failure group. The largest failure group is the one with the largest total raw capacity. For example, if each disk is in its own failure group, then the value would be the size of the largest capacity disk.</p>
</li>
<li>
<p>High redundancy disk group with more than three failure groups</p>
<p>The value is the total raw space for all of the disks in the two largest failure groups.</p>
</li>
</ul>
</li>
<li>
<p><code>USABLE_FILE_MB</code> indicates the amount of free space, adjusted for mirroring, that is available for new files to restore redundancy after a disk failure. <code>USABLE_FILE_MB</code> is computed by subtracting <code>REQUIRED_MIRROR_FREE_MB</code> from the total free space in the disk group and then adjusting the value for mirroring. For example, in a normal redundancy disk group where by default the mirrored files use disk space equal to twice their size, if 4 GB of actual usable file space remains, then <code>USABLE_FILE_MB</code> equals roughly 2 GB. You can then add a file that is up to 2 GB.</p>
</li>
<li>
<p><code>TOTAL_MB</code> is the total usable capacity of a disk group in megabytes. The calculations for data in this column take the disk header overhead into consideration. The disk header overhead depends on the number of Oracle ASM disks and Oracle ASM files. This value is typically about 1% of the total raw storage capacity. For example, if the total LUN capacity provisioned for Oracle ASM is 100 GB, then the value in the <code>TOTAL_MB</code> column would be about 99 GB.</p>
</li>
<li>
<p><code>FREE_MB</code> is the unused capacity of the disk group in megabytes, without considering any data imbalance. There may be situations where the value in the <code>FREE_MB</code> column shows unused capacity but because one Oracle ASM disk is full, database writes fail because of the imbalance in the disk group. Ensure that you initiate a manual rebalance to force even data distribution which results in an accurate presentation of the values in the <code>FREE_MB</code> column.</p>
<p><a id="sthref305"></a><a id="sthref306"></a>With fine grain striping using 128 KB, the storage is preallocated to be eight times the AU size. The data file size may appear slightly larger on Oracle ASM than on a local file system because of the preallocation.</p>
<p>When you use Oracle ASM normal or high redundancy, the disk space utilization becomes more complex to measure because it depends on several variables.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The values in the <code>TOTAL_MB</code> and <code>FREE_MB</code> columns best describe space usage when you do not configure Oracle ASM mirroring, that is, when you use external redundancy.</div>
</li>
</ul>
<p>The results from the following query show capacity metrics for a normal redundancy disk group that consists of six 1 GB (1024 MB) disks, each in its own failure group:</p>
<pre>
SQL&gt; SELECT name, type, total_mb, free_mb, required_mirror_free_mb, 
     usable_file_mb FROM V$ASM_DISKGROUP;

NAME         TYPE     TOTAL_MB    FREE_MB REQUIRED_MIRROR_FREE_MB USABLE_FILE_MB
------------ ------ ---------- ---------- ----------------------- --------------
DATA         NORMAL       6144       3768                    1024           1372
</pre>
<p>The <code>REQUIRED_MIRROR_FREE_MB</code> column shows that 1 GB of extra capacity must be available to restore full redundancy after one or more disks fail. The first three numeric columns in the query results are raw numbers. That is, they do not take redundancy into account. Only the last column is adjusted for normal redundancy. In the query output example for the <code>data</code> disk group, the calculation is as follows:</p>
<p>(<code>FREE_MB</code> <code>-</code> <code>REQUIRED_MIRROR_FREE_MB</code>) <code>/</code> <code>2</code> = <code>USABLE_FILE_MB</code></p>
<p>(<code>3768</code> - <code>1024</code>) / <code>2</code> = <code>2744</code> / <code>2</code> = <code>1372</code></p>
<a id="OSTMG94125"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref307"></a>
<h3 class="sect2">Negative Values of USABLE_FILE_MB</h3>
<p>Due to the relationship between <code>FREE_MB</code>, <code>REQUIRED_MIRROR_FREE_MB</code>, and <code>USABLE_FILE_MB</code>, <code>USABLE_FILE_MB</code> can become negative. Although this is not necessarily a critical situation, it does mean that:</p>
<ul>
<li>
<p>Depending on the value of <code>FREE_MB</code>, you may not be able to create new files.</p>
</li>
<li>
<p>The next failure might result in files with reduced redundancy.</p>
</li>
</ul>
<p>If <code>USABLE_FILE_MB</code> becomes negative, it is strongly recommended that you add more space to the disk group as soon as possible.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDHDGDI"></a><a id="OSTMG13711"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Oracle ASM Mirroring and Disk Group Redundancy</h2>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#BABBEJAF">Mirroring, Redundancy, and Failure Group Options</a></p>
</li>
<li>
<p><a href="#CHDFCIEI">Oracle ASM Recovery from Read and Write I/O Errors</a></p>
</li>
<li>
<p><a href="#CHDBCBGF">Oracle ASM Fast Mirror Resync</a></p>
</li>
<li>
<p><a href="#CHDFJCBF">Preferred Read Failure Groups</a></p>
</li>
</ul>
<a id="BABBEJAF"></a><a id="OSTMG10046"></a>
<div class="sect2">
<h3 class="sect2">Mirroring, Redundancy, and Failure Group Options</h3>
<p><a id="sthref308"></a><a id="sthref309"></a><a id="sthref310"></a><a id="sthref311"></a><a id="sthref312"></a>If you specify mirroring for a file, then Oracle ASM automatically stores redundant copies of the file extents in separate failure groups. Failure groups apply only to normal and high redundancy disk groups. You can define the failure groups for each disk group when you create or alter the disk group.</p>
<p>There are three types of disk groups based on the Oracle ASM redundancy level. <a href="#BABFGFEF">Table 4-1</a> lists the types with their supported and default mirroring levels. The default mirroring levels indicate the mirroring level with which each file is created unless a different mirroring level is designated.</p>
<div class="tblhruleformal">
<p class="titleintable"><a id="OSTMG94126"></a><a id="sthref313"></a><a id="BABFGFEF"></a>Table 4-1 Mirroring options for Oracle ASM disk group types</p>
<table class="cellalignment1546" title="Mirroring options for Oracle ASM disk group types" summary="This table lists the 3 types of disk groups and the mirroring options supported by each." dir="ltr">
<thead>
<tr class="cellalignment1537">
<th class="cellalignment1547" id="r1c1-t26">Disk Group Type</th>
<th class="cellalignment1547" id="r1c2-t26">Supported Mirroring Levels</th>
<th class="cellalignment1547" id="r1c3-t26">Default Mirroring Level</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r2c1-t26" headers="r1c1-t26">
<p>External redundancy</p>
</td>
<td class="cellalignment1543" headers="r2c1-t26 r1c2-t26">
<p>Unprotected (none)</p>
</td>
<td class="cellalignment1543" headers="r2c1-t26 r1c3-t26">
<p>Unprotected</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r3c1-t26" headers="r1c1-t26">
<p>Normal redundancy</p>
</td>
<td class="cellalignment1543" headers="r3c1-t26 r1c2-t26">
<p>Two-way, three-way, unprotected (none)</p>
</td>
<td class="cellalignment1543" headers="r3c1-t26 r1c3-t26">
<p>Two-way</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r4c1-t26" headers="r1c1-t26">
<p>High redundancy</p>
</td>
<td class="cellalignment1543" headers="r4c1-t26 r1c2-t26">
<p>Three-way</p>
</td>
<td class="cellalignment1543" headers="r4c1-t26 r1c3-t26">
<p>Three-way</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>The redundancy level controls how many disk failures are tolerated without dismounting the disk group or losing data. Each file is allocated based on its own redundancy, but the default comes from the disk group.</p>
<p>The redundancy levels are:</p>
<ul>
<li>
<p>External redundancy</p>
<p>Oracle ASM does not provide mirroring redundancy and relies on the storage system to provide RAID functionality. Any write error causes a forced dismount of the disk group. All disks must be located to successfully mount the disk group.</p>
</li>
<li>
<p>Normal redundancy</p>
<p>Oracle ASM provides two-way mirroring by default, which means that all files are mirrored so that there are two copies of every <a href="ostmg_gloss.htm#BABFCABI"><span class="xrefglossterm">extent</span></a>. A loss of one Oracle ASM disk is tolerated. You can optionally choose three-way or unprotected mirroring.</p>
<p>A file specified with <code>HIGH</code> redundancy (three-way mirroring) in a <code>NORMAL</code> redundancy disk group provides additional protection from a bad disk sector, not protection from a disk failure.</p>
</li>
<li>
<p>High redundancy</p>
<p>Oracle ASM provides triple mirroring by default. A loss of two Oracle ASM disks in different failure groups is tolerated.</p>
</li>
</ul>
<p>If there are not enough online failure groups to satisfy the file mirroring (redundancy attribute value) specified in the disk group file type template, Oracle ASM allocates as many mirrors copies as possible and subsequently allocates the remaining mirrors when sufficient online failure groups are available. For information about specifying Oracle ASM disk group templates, see <a href="asmfiles.htm#i1019485">"Managing Disk Group Templates"</a>.</p>
<p>Failure groups enable the mirroring of metadata and user data. System reliability can diminish if your environment has an insufficient number of failure groups.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CHDDBHCH">Oracle ASM Failure Groups</a></p>
</li>
<li>
<p><a href="#BABJIBII">How Oracle ASM Manages Disk Failures</a></p>
</li>
<li>
<p><a href="#CHDGHIAA">Guidelines for Using Failure Groups</a></p>
</li>
<li>
<p><a href="#CHDEJBFA">Failure Group Frequently Asked Questions</a></p>
</li>
</ul>
<a id="CHDDBHCH"></a><a id="OSTMG94127"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Oracle ASM Failure Groups</h4>
<p><a id="sthref314"></a><a id="sthref315"></a><a id="sthref316"></a>Failure groups are used to store mirror copies of data. When Oracle ASM allocates an extent for a normal redundancy file, Oracle ASM allocates a primary copy and a secondary copy. Oracle ASM chooses the disk on which to store the secondary copy so that it is in a different failure group than the primary copy. Each copy is on a disk in a different failure group so that the simultaneous failure of all disks in a failure group does not result in data loss.</p>
<p>A failure group is a subset of the disks in a disk group, which could fail at the same time because they share hardware. The failure of common hardware must be tolerated. Four drives that are in a single removable tray of a large JBOD (Just a Bunch of Disks) array should be in the same failure group because the tray could be removed making all four drives fail at the same time. Drives in the same cabinet could be in multiple failure groups if the cabinet has redundant power and cooling so that it is not necessary to protect against failure of the entire cabinet. However, Oracle ASM mirroring is not intended to protect against a fire in the computer room that destroys the entire cabinet.</p>
<p>There are always failure groups even if they are not explicitly created. If you do not specify a failure group for a disk, then Oracle automatically creates a new failure group containing just that disk, except for disk groups containing disks on Oracle Exadata cells.</p>
<p>A normal redundancy disk group must contain at least two failure groups. A high redundancy disk group must contain at least three failure groups. However, Oracle recommends using several failure groups. A small number of failure groups, or failure groups of uneven capacity, can create allocation problems that prevent full use of all of the available storage.</p>
<p>Failure groups can be specified as regular or quorum failure groups. For information about quorum failure groups, see <a href="#CHDBGAFB">"Oracle Cluster Registry and Voting Files in Oracle ASM Disk Groups"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic">Oracle Exadata documentation</span> for information about Oracle Exadata failure groups</div>
</div>
<!-- class="sect3" -->
<a id="BABJIBII"></a><a id="OSTMG10043"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">How Oracle ASM Manages Disk Failures</h4>
<p><a id="sthref317"></a><a id="sthref318"></a><a id="sthref319"></a>Depending on the redundancy level of a disk group and how you define failure groups, the failure of one or more disks could result in either of the following:</p>
<ul>
<li>
<p>The disks are first taken offline and then automatically dropped. In this case, the disk group remains mounted and serviceable. In addition, because of mirroring, all of the disk group data remains accessible. After the disk drop operation, Oracle ASM performs a rebalance to restore full redundancy for the data on the failed disks.</p>
</li>
<li>
<p>The entire disk group is automatically dismounted, which means loss of data accessibility.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="CHDGHIAA"></a><a id="OSTMG94128"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Guidelines for Using Failure Groups</h4>
<p><a id="sthref320"></a>The following are guidelines for using failure groups:</p>
<ul>
<li>
<p>Each disk in a disk group can belong to only one failure group.</p>
</li>
<li>
<p>Failure groups should all be of the same size. Failure groups of different sizes may lead to reduced availability.</p>
</li>
<li>
<p>Oracle ASM requires at least two failure groups to create a normal redundancy disk group and at least three failure groups to create a high redundancy disk group.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="CHDEJBFA"></a><a id="OSTMG10090"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Failure Group Frequently Asked Questions</h4>
<p>This section discusses frequently asked questions about failure group under the following topics:</p>
<ul>
<li>
<p><a href="#CHDIDIJH">How Many Failure Groups Should I Create?</a></p>
</li>
<li>
<p><a href="#CHDGECFE">How are Multiple Failure Groups Recovered after Simultaneous Failures?</a></p>
</li>
<li>
<p><a href="#CHDBEGAJ">When Should External, Normal, or High Redundancy Be Used?</a></p>
</li>
</ul>
<p class="subhead2"><a id="CHDIDIJH"></a><a id="OSTMG94129"></a>How Many Failure Groups Should I Create?</p>
<p><a id="sthref321"></a>Choosing the number of failure groups to create depends on the types of failures that must be tolerated without data loss. For small numbers of disks, such as fewer than 20, it is usually best to use the default failure group creation that puts every disk in its own failure group.</p>
<p>Using the default failure group creation for small numbers of disks is also applicable for large numbers of disks where your main concern is disk failure. For example, a disk group might be configured from several small modular disk arrays. If the system must continue operating when an entire modular array fails, then a failure group should consist of all of the disks in one module. If one module fails, then all of the data on that module is relocated to other modules to restore redundancy. Disks should be placed in the same failure group if they depend on a common piece of hardware whose failure must be tolerated with no loss of availability.</p>
<p class="subhead2"><a id="CHDGECFE"></a><a id="OSTMG94130"></a>How are Multiple Failure Groups Recovered after Simultaneous Failures?</p>
<p><a id="sthref322"></a>A simultaneous failure can occur if there is a failure of a piece of hardware used by multiple failure groups. This type of failure usually forces a dismount of the disk group if all disks are unavailable.</p>
<p class="subhead2"><a id="CHDBEGAJ"></a><a id="OSTMG94131"></a>When Should External, Normal, or High Redundancy Be Used?</p>
<p><a id="sthref323"></a><a id="sthref324"></a>Oracle ASM mirroring runs on the database server and Oracle recommends to off load this processing to the storage hardware RAID controller by using external redundancy. You can use normal redundancy in the following scenarios:</p>
<ul>
<li>
<p>Storage system does not have RAID controller</p>
</li>
<li>
<p>Mirroring across storage arrays</p>
</li>
<li>
<p>Extended cluster configurations</p>
</li>
</ul>
<p>In general, Oracle ASM mirroring is the Oracle alternative to third party logical volume managers. Oracle ASM mirroring eliminates the deployment of additional layers of software complexity in your Oracle database environment.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDFCIEI"></a><a id="OSTMG94132"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Oracle ASM Recovery from Read and Write I/O Errors</h3>
<p><a id="sthref325"></a><a id="sthref326"></a>Read errors can be the result of a loss of access to the entire disk or media corruptions on an otherwise a healthy disk. Oracle ASM tries to recover from read errors on corrupted sectors on a disk. When a read error by the database or Oracle ASM triggers the Oracle ASM instance to attempt bad block remapping, Oracle ASM reads a good copy of the extent and copies it to the disk that had the read error.</p>
<ul>
<li>
<p>If the write to the same location succeeds, then the underlying allocation unit (sector) is deemed healthy. This might be because the underlying disk did its own bad block reallocation.</p>
</li>
<li>
<p>If the write fails, Oracle ASM attempts to write the extent to a new allocation unit on the same disk. If this write succeeds, the original allocation unit is marked as unusable. If the write fails, the disk is taken offline.</p>
</li>
</ul>
<p>One unique benefit on Oracle ASM based mirroring is that the database instance is aware of the mirroring. For many types of logical corruptions such as a bad checksum or incorrect System Change Number (SCN), the database instance proceeds through the mirror side looking for valid content and proceeds without errors. If the process in the database that encountered the read can obtain the appropriate locks to ensure data consistency, it writes the correct data to all mirror sides.</p>
<p><a id="sthref327"></a><a id="sthref328"></a>When encountering a write error, a database instance sends the Oracle ASM instance a <span class="italic">disk</span> <span class="italic">offline</span> message.</p>
<ul>
<li>
<p>If database can successfully complete a write to at least one extent copy and receive acknowledgment of the offline disk from Oracle ASM, the write is considered successful.</p>
</li>
<li>
<p>If the write to all mirror side fails, database takes the appropriate actions in response to a write error such as taking the tablespace offline.</p>
</li>
</ul>
<p>When the Oracle ASM instance receives a write error message from a database instance or when an Oracle ASM instance encounters a write error itself, the Oracle ASM instance attempts to take the disk offline. Oracle ASM consults the Partner Status Table (PST) to see whether any of the disk's partners are offline. If too many partners are offline, Oracle ASM forces the dismounting of the disk group. Otherwise, Oracle ASM takes the disk offline.</p>
<p>The ASMCMD <code>remap</code> command was introduced to address situations where a range of bad sectors exists on a disk and must be corrected before Oracle ASM or database I/O. For information about the <code>remap</code> command, see <a href="asm_util004.htm#CIHBAFAG">"remap"</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDBCBGF"></a><a id="OSTMG10044"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Oracle ASM Fast Mirror Resync</h3>
<p><a id="sthref329"></a><a id="sthref330"></a><a id="sthref331"></a>Restoring the redundancy of an Oracle ASM disk group after a transient disk path failure can be time consuming. This is especially true if the recovery process requires rebuilding an entire Oracle ASM failure group. Oracle ASM fast mirror resync significantly reduces the time to resynchronize a failed disk in such situations. When you replace the failed disk, Oracle ASM can quickly resynchronize the Oracle ASM disk extents.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To use this feature, the disk group compatibility attributes must be set to <code>11.1</code> or higher. For more information, refer to <a href="#CHDDIGBJ">"Disk Group Compatibility"</a>.</div>
<p>Any problems that make a failure group temporarily unavailable are considered transient failures that can be recovered by the Oracle ASM fast mirror resync feature. For example, transient failures can be caused by disk path malfunctions, such as cable failures, host bus adapter failures, controller failures, or disk power supply interruptions.</p>
<p>Oracle ASM fast resync keeps track of pending changes to extents on an <code>OFFLINE</code> disk during an outage. The extents are resynced when the disk is brought back online.</p>
<p><a id="sthref332"></a>By default, Oracle ASM drops a disk in 3.6 hours after it is taken offline. <a id="sthref333"></a>You can set the <code>DISK_REPAIR_TIME</code> disk group attribute to delay the drop operation by specifying a time interval to repair the disk and bring it back online. The time can be specified in units of minutes (<code>m</code> or <code>M</code>) or hours (<code>h</code> or <code>H</code>). If you omit the unit, then the default unit is hours. The <code>DISK_REPAIR_TIME</code> disk group attribute can only be set with the <code>ALTER</code> <code>DISKGROUP</code> SQL statement.</p>
<p>If the attribute is not set explicitly, then the default value (<code>3.6h</code>) applies to disks that have been set to <code>OFFLINE</code> mode without an explicit <code>DROP</code> <code>AFTER</code> clause. Disks taken offline due to I/O errors do not have a <code>DROP</code> <code>AFTER</code> clause.</p>
<p>The default <code>DISK_REPAIR_TIME</code> attribute value is an estimate that should be adequate for most environments. However, ensure that the attribute value is set to the amount of time that you think is necessary in your environment to fix any transient disk error, and that you are willing to tolerate reduced data redundancy.</p>
<p>The elapsed time (since the disk was set to <code>OFFLINE</code> mode) is incremented only when the disk group containing the offline disks is mounted. The <code>REPAIR_TIMER</code> column of <code>V$ASM_DISK</code> shows the amount of time left (in seconds) before an offline disk is dropped. After the specified time has elapsed, Oracle ASM drops the disk. You can override this attribute with the <code>ALTER</code> <code>DISKGROUP</code> <code>OFFLINE</code> <code>DISK</code> statement and the <code>DROP</code> <code>AFTER</code> clause.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If a disk is offlined by Oracle ASM because of an I/O (write) error or is explicitly offlined using the <code>ALTER</code> <code>DISKGROUP</code>... <code>OFFLINE</code> statement without the <code>DROP</code> <code>AFTER</code> clause, then the value specified for the <code>DISK_REPAIR_TIME</code> attribute for the disk group is used.
<p>Altering the <code>DISK_REPAIR_TIME</code> attribute has no effect on offline disks. The new value is used for any disks that go offline after the attribute is updated. You can confirm this behavior by viewing the Oracle ASM alert log.</p>
</div>
<p>If an offline disk is taken offline for a second time, then the elapsed time is reset and restarted. If another time is specified with the <code>DROP</code> <code>AFTER</code> clause for this disk, the first value is overridden and the new value applies. A disk that is in <code>OFFLINE</code> mode cannot be dropped with an <code>ALTER</code> <code>DISKGROUP</code> <code>DROP</code> <code>DISK</code> statement; an error is returned if attempted. If for some reason the disk must be dropped (such as the disk cannot be repaired) before the repair time has expired, a disk can be dropped immediately by issuing a second <code>OFFLINE</code> statement with a <code>DROP</code> <code>AFTER</code> clause specifying <code>0h</code> or <code>0m</code>.</p>
<p>You can use <code>ALTER</code> <code>DISKGROUP</code> to set the <code>DISK_REPAIR_TIME</code> attribute to a specified hour or minute value, such as 4.5 hours or 270 minutes. For example:</p>
<pre>
ALTER DISKGROUP data SET ATTRIBUTE 'disk_repair_time' = '4.5h'
ALTER DISKGROUP data SET ATTRIBUTE 'disk_repair_time' = '270m'
</pre>
<p>After you repair the disk, run the SQL statement <code>ALTER</code> <code>DISKGROUP</code> <code>ONLINE</code> <code>DISK</code>. This statement brings a repaired disk group back online to enable writes so that no new writes are missed. This statement also starts a procedure to copy of all of the extents that are marked as stale on their redundant copies.</p>
<p>If a disk goes offline when the Oracle ASM instance is in rolling upgrade mode, the disk remains offline until the rolling upgrade has ended and the timer for dropping the disk is stopped until the Oracle ASM cluster is out of rolling upgrade mode. See <a href="asminst.htm#CHDIIGIE">"Using Oracle ASM Rolling Upgrade"</a>. Examples of taking disks offline and bringing them online follow.</p>
<p>The following example takes disk <code>DATA_001</code> offline and drops it after five minutes.</p>
<pre>
ALTER DISKGROUP data OFFLINE DISK DATA_001 DROP AFTER 5m;
</pre>
<p>The next example takes the disk <code>DATA_001</code> offline and drops it after the time period designated by <code>DISK_REPAIR_TIME</code> elapses:</p>
<pre>
ALTER DISKGROUP data OFFLINE DISK DATA_001;
</pre>
<p>This example takes all of the disk in failure group <code>FG2</code> offline and drops them after the time period designated by <code>DISK_REPAIR_TIME</code> elapses. IF you used a <code>DROP</code> <code>AFTER</code> clause, then the disks would be dropped after the specified time:</p>
<pre>
ALTER DISKGROUP data OFFLINE DISK IN FAILGROUP FG2;
</pre>
<p>The next example brings all of the disks in failure group <code>FG2</code> online:</p>
<pre>
ALTER DISKGROUP data ONLINE DISK IN FAILGROUP FG2;
</pre>
<p>This example brings only disk <code>DATA_001</code> online:</p>
<pre>
ALTER DISKGROUP data ONLINE DISK DATA_001;
</pre>
<p>This example brings all of the disks in disk group <code>DATA</code> online:</p>
<pre>
ALTER DISKGROUP data ONLINE ALL;
</pre>
<p>Querying the <code>V$ASM_OPERATION</code> view while you run any of these types of <code>ALTER</code> <code>DISKGROUP</code> ... <code>ONLINE</code> statements displays the name and state of the current operation that you are performing. For example, the query:</p>
<pre>
SELECT GROUP_NUMBER, OPERATION, STATE FROM V$ASM_OPERATION;
</pre>
<p>Displays output similar to the following:</p>
<pre>
GROUP_NUMBER OPERA STAT 
------------ ----- ---- 
           1 ONLIN RUN 
</pre>
<p>An <code>OFFLINE</code> operation is not displayed in a <code>V$ASM_OPERATION</code> view query.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER</code> <code>DISKGROUP</code></a> and <a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><code>CREATE</code> <code>DISKGROUP</code></a></div>
</div>
<!-- class="sect2" -->
<a id="CHDFJCBF"></a><a id="OSTMG10047"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Preferred Read Failure Groups</h3>
<p><a id="sthref334"></a><a id="sthref335"></a>When <a id="sthref336"></a><a id="sthref337"></a><a id="sthref338"></a>you configure Oracle ASM failure groups, it might be more efficient for a node to read from an extent that is closest to the node, even if that extent is a secondary extent. In other words, you can configure Oracle ASM to read from a secondary extent if that extent is closer to the node instead of Oracle ASM reading from the primary copy which might be farther from the node. Using the preferred read failure groups feature is most useful in extended clusters.</p>
<p>To use this feature, Oracle recommends that you configure at least one mirrored extent copy from a disk that is local to a node in an extended cluster. However, a failure group that is preferred for one instance might be remote to another instance in the same Oracle RAC database. The parameter setting for preferred read failure groups is instance specific.</p>
<p>Both the Oracle ASM clients and Oracle ASM require Oracle Database 11<span class="italic">g</span> release 1 (11.1) or higher to use preferred read failure groups.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you do not specify failure groups for a disk group, each disk in the disk group belongs to its own failure group. Oracle does not recommend that you configure multiple preferred read failure groups in a disk group for an Oracle ASM instance. For any given instance, if you specify multiple failure groups in the same disk group as preferred read, a warning message is written to the alert log.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RACAD820" href="../../rac.112/e41960/storage.htm#RACAD820"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for information about configuring preferred read disks in extended clusters</div>
<a id="CHDBBJBE"></a><a id="OSTMG94133"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Configuring and Administering Preferred Read Failure Groups</h4>
<p><a id="sthref339"></a>To configure this feature, set the <code>ASM_PREFERRED_READ_FAILURE_GROUPS</code> initialization parameter to specify a list of failure group names as preferred read disks. For more information about this initialization parameter, refer to <a href="asminst.htm#BHCIHBGH">"ASM_PREFERRED_READ_FAILURE_GROUPS"</a>.</p>
<p>Set the parameter where <code><span class="codeinlineitalic">diskgroup</span></code> is the name of the disk group and <code><span class="codeinlineitalic">failuregroup</span></code> is the name of the failure group, separating these variables with a period. Oracle ASM ignores the name of a failure group that you use in this parameter setting if the failure group does not exist in the named disk group. You can append multiple values using commas as a separator as follows:</p>
<p><code>ASM_PREFERRED_READ_FAILURE_GROUPS</code> <code>=</code> <code><span class="codeinlineitalic">diskgroup</span></code>.<code><span class="codeinlineitalic">failuregroup</span></code>,...</p>
<p>In an extended cluster, the failure groups that you specify with settings for the <code>ASM_PREFERRED_READ_FAILURE_GROUPS</code> parameter should only contain disks that are local to the instance. For normal redundancy disk groups, there should be only one failure group on each site of the extended cluster.</p>
<p>If there are multiple mirrored copies and you have set a value for the <code>ASM_PREFERRED_READ_FAILURE_GROUPS</code> parameter, then Oracle ASM first reads the copy that resides on a preferred read disk. If that read fails, then Oracle ASM attempts to read from the next mirrored copy that might not be on a preferred read disk.</p>
<p>Having multiple failure groups on one site can cause the loss of access to the disk group by the other sites if the site containing multiple failure groups fails. In addition, by having multiple failure groups on a site, an extent might not be mirrored to another site. This can diminish the read performance of the failure group on the other site.</p>
<p>For example, for a normal redundancy disk group, if a site contains two failure groups of a disk group, then Oracle ASM might put both mirror copies of an extent on the same site. In this configuration, Oracle ASM cannot protect against data loss from a site failure.</p>
<p>You should configure at most two failure groups on a site for a high redundancy disk group. If there are three sites in an extended cluster, for the same reason previously mentioned, then you should only create one failure group.</p>
<p>For a two-site extended cluster, a normal redundancy disk group only has two failure groups. In this case, you can only specify one failure group as a preferred read failure group for each instance.</p>
<p><a id="sthref340"></a>You can use views to identify preferred read failure groups, such as the <code>V$ASM_DISK</code> view that shows whether a disk is a preferred read disk by the value in the <code>PREFERRED_READ</code> column. You can also use <code>V$ASM_DISK</code> to verify whether local disks in an extended cluster are preferred read disks. Use the Oracle ASM disk I/O statistics to verify that read operations are using the preferred read disks that you configured.</p>
<p>If a disk group is not optimally configured for an extended cluster, then Oracle ASM records warning messages in the alert logs. To identify specific performance issues with Oracle ASM preferred read failure groups, use the <code>V$ASM_DISK_IOSTAT</code> view. This view displays disk I/O statistics for each Oracle ASM client. You can also query the <code>V$ASM_DISK_IOSTAT</code> view on a database instance. However, this query only shows the I/O statistics for the database instance. In general, optimal preferred read extended cluster configurations balance performance with disk group availability.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN003" href="../../server.112/e40402/dynviews_part.htm#REFRN003"><span class="italic">Oracle Database Reference</span></a> for details about the <code>V$ASM</code>* dynamic performance views</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1014729"></a><a id="OSTMG10042"></a>
<div class="sect1">
<h2 class="sect1">Performance and Scalability Considerations for Disk Groups</h2>
<p><a id="sthref341"></a>This section discusses the following considerations for evaluating disk group performance:</p>
<ul>
<li>
<p><a href="#CHDFAAJH">Determining the Number of Disk Groups</a></p>
</li>
<li>
<p><a href="#CHDEJBHD">Performance Characteristics When Grouping Disks</a></p>
</li>
<li>
<p><a href="#CHDCGGED">Oracle ASM Storage Limits</a></p>
</li>
</ul>
<a id="CHDFAAJH"></a><a id="OSTMG94134"></a>
<div class="sect2">
<h3 class="sect2">Determining the Number of Disk Groups</h3>
<p><a id="sthref342"></a>Use the following criteria to determine the number of disk groups to create:</p>
<ul>
<li>
<p>Disks in a given disk group should have similar size and performance characteristics. If you have several different types of disks in terms of size and performance, then create several disk groups that contain similar characteristics.</p>
</li>
<li>
<p>Create separate disk groups for your database files and fast recovery area for backup files. This configuration allows fast recovery should a disk group failure occur.</p>
</li>
</ul>
<p>For information about creating disk groups for a new installation, refer to <a href="#CHDGJEHJ">"Creating Disk Groups for a New Oracle Installation"</a>.</p>
</div>
<!-- class="sect2" -->
<a id="CHDEJBHD"></a><a id="OSTMG94135"></a>
<div class="sect2">
<h3 class="sect2">Performance Characteristics When Grouping Disks</h3>
<p><a id="sthref343"></a>Oracle ASM load balances the file activity by uniformly distributing file extents across all of the disks in a disk group. For this technique to be effective it is important that disks in a disk group be of similar performance characteristics. For example, the newest and fastest disks might reside in a disk group reserved for the database work area, and slower drives could reside in a disk group reserved for the fast recovery area.</p>
<p>There might be situations where it is acceptable to temporarily have disks of different sizes and performance characteristics coexist in a disk group. This would be the case when migrating from an old set of disks to a new set of disks. The new disks would be added and the old disks dropped. As the old disks are dropped, their storage is migrated to the new disks while the disk group is online.</p>
</div>
<!-- class="sect2" -->
<a id="CHDCGGED"></a><a id="OSTMG94136"></a>
<div class="sect2">
<h3 class="sect2">Oracle ASM Storage Limits</h3>
<p><a id="sthref344"></a><a id="sthref345"></a><a id="sthref346"></a><a id="sthref347"></a>Oracle ASM provides near unlimited capacity for future growth, but does have some storage limits. For example, Oracle ASM has the following limits on the number of disk groups, disks, and files:</p>
<ul>
<li>
<p>63 disk groups in a storage system</p>
</li>
<li>
<p>10,000 Oracle ASM disks in a storage system</p>
</li>
<li>
<p>1 million files for each disk group</p>
</li>
</ul>
<p>Without any Oracle Exadata Storage, Oracle ASM has these storage limits:</p>
<ul>
<li>
<p>2 terabytes (TB) maximum storage for each Oracle ASM disk</p>
</li>
<li>
<p>20 petabytes (PB) maximum for the storage system</p>
</li>
</ul>
<p>With all Oracle Exadata Storage, Oracle ASM has these storage limits:</p>
<ul>
<li>
<p>4 PB maximum storage for each Oracle ASM disk</p>
</li>
<li>
<p>40 exabytes (EB) maximum for the storage system</p>
</li>
</ul>
<p>The maximum size limit of a disk group equals the maximum disk size multiplied by the maximum number of disks in a disk group (10,000).</p>
<p>The maximum number of disks across all disk groups is 10,000. The 10,000 disks can be in one disk group or distributed across a maximum of 63 disk groups. This is a limitation on the number of Oracle ASM disks, not necessarily the number of spindles. A storage array could group multiple spindles into a LUN that is used as a single Oracle ASM disk. However Oracle ASM is currently limited to 2 TB in a single disk unless using Oracle Exadata storage.</p>
<p>File size limits are dependent on the value of the disk group compatibility attributes. Oracle ASM supports file sizes greater than 128 TB in any redundancy mode when the <code>COMPATIBLE.RDBMS</code> disk group attribute is set greater than<code>10.1</code>.</p>
<p>If <code>COMPATIBLE.RDBMS</code> is set to <code>10.1</code>, the file size limits are less. For example, with <code>COMPATIBLE.RDBMS</code> equal to <code>10.1</code> and the AU size equal to 1 MB, Oracle ASM file size limits are:</p>
<ul>
<li>
<p>External redundancy: 16 TB</p>
</li>
<li>
<p>Normal redundancy: 5.8 TB</p>
</li>
<li>
<p>High redundancy: 3.9 TB</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle Database supports data file sizes up to 128 TB depending on the file system. In addition, Oracle Database has a file size limit that is dependent on the <code>DB_BLOCK_SIZE</code> initialization parameter.</div>
<p>For information about Oracle ASM disk group compatibility attributes, see <a href="#CHDDIGBJ">"Disk Group Compatibility"</a>. For information about Oracle ASM file size limits, see <a href="#BABFJBEG">Table 4-4</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDDIGBJ"></a><a id="OSTMG02700"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Disk Group Compatibility</h2>
<p>This section describes disk group compatibility under the following topics:</p>
<ul>
<li>
<p><a href="#CHDEBEEH">Overview of Disk Group Compatibility</a></p>
</li>
<li>
<p><a href="#CHDCACGC">Disk Group Compatibility Attributes</a></p>
</li>
<li>
<p><a href="#CHDJDDFG">Setting Disk Group Compatibility Attributes</a></p>
</li>
<li>
<p><a href="#BABCADAH">Considerations When Setting Disk Group Compatibility in Replicated Environments</a></p>
</li>
</ul>
<a id="CHDEBEEH"></a><a id="OSTMG94137"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Overview of Disk Group Compatibility</h3>
<p><a id="sthref348"></a><a id="sthref349"></a>Advancing the disk group compatibility settings enables you to use the new Oracle ASM features that are available in a later release. For example, a disk group with the disk group compatibility attributes set to 11.2 can take advantage of new Oracle 11<span class="italic">g</span> release 2 (11.2) features, such as Oracle ASM volumes in disk groups and Oracle ASM File Access Control. See <a href="#CHDIBHBB">Table 4-3</a> for the features enabled for combinations of compatibility attribute settings.</p>
<p>The disk group compatibility feature also enables environments to interoperate when they use disk groups from both Oracle Database 10<span class="italic">g</span> and Oracle Database 11<span class="italic">g</span>. For example, disk group compatibility settings that are set to Oracle Database 10<span class="italic">g</span> enable an Oracle 10<span class="italic">g</span> client to access a disk group created with Oracle ASM 11<span class="italic">g</span>.</p>
<p>The disk group attributes that determine compatibility are <code>COMPATIBLE.ASM</code>, <code>COMPATIBLE.RDBMS</code>. and <code>COMPATIBLE.ADVM</code>. The <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> attribute settings determine the minimum Oracle Database software version numbers that a system can use for Oracle ASM and the database instance types respectively. For example, if the Oracle ASM compatibility setting is <code>11.2</code>, and RDBMS compatibility is set to 11.1, then the Oracle ASM software version must be at least <code>11.2</code>, and the Oracle Database client software version must be at least <code>11.1</code>. The <code>COMPATIBLE.ADVM</code> attribute determines whether the Oracle ASM Dynamic Volume Manager feature can create an volume in a disk group.</p>
<p>When you create a disk group, you can specify the disk group compatibility attribute settings in the <code>CREATE</code> <code>DISKGROUP</code> SQL statement. The <code>ALTER</code> <code>DISKGROUP</code> SQL statement can update the compatible attribute settings for existing disk groups. If not specified when using the <code>CREATE</code> <code>DISKGROUP</code> SQL statement, <code>10.1</code> is the default setting for both the <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> attributes for Oracle ASM in Oracle Database 11<span class="italic">g</span>. The <code>COMPATIBLE.ADVM</code> attribute is empty if it is not set. See <a href="#CHDCACFD">Table 4-2</a> for examples of valid combinations of compatible attribute settings.</p>
<p>You can set and update disk group attributes with the ASMCMD <code>setattr</code> command. For information about the ASMCMD <code>setattr</code> command, see <a href="asm_util004.htm#CIHHBIJH">"setattr"</a>.</p>
<div class="infobox-note">
<p class="notep1">Notes:</p>
<ul>
<li>
<p>The disk group compatibility settings determine whether your environment can use the latest Oracle ASM features.</p>
</li>
<li>
<p>The disk group compatibility settings can only be advanced; you cannot revert to a lower compatibility setting. See <a href="#CHDIJHAJ">"Reverting Disk Group Compatibility"</a>.</p>
</li>
<li>
<p>The <code>COMPATIBLE.ASM</code> attribute must be advanced before advancing other disk group compatibility attributes and its value must be greater than or equal to the value of other disk group compatibility attributes.</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="CHDCACGC"></a><a id="OSTMG10045"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Disk Group Compatibility Attributes</h3>
<p><a id="sthref350"></a><a id="sthref351"></a>The disk group compatibility attributes specify the disk group compatibility settings for Oracle ASM and database instances. These attributes are described under the following topics:</p>
<ul>
<li>
<p><a href="#BABGEICD">COMPATIBLE.ASM</a></p>
</li>
<li>
<p><a href="#BABCAJJD">COMPATIBLE.RDBMS</a></p>
</li>
<li>
<p><a href="#CHDFFADC">COMPATIBLE.ADVM</a></p>
</li>
</ul>
<a id="BABGEICD"></a><a id="OSTMG94138"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">COMPATIBLE.ASM</h4>
<p><a id="sthref352"></a>The value for the disk group <code>COMPATIBLE</code>.<code>ASM</code> attribute determines the minimum software version for an Oracle ASM instance that can use the disk group. This setting also affects the format of the data structures for the Oracle ASM metadata on the disk. The format of other file contents is determined by Oracle ASM Dynamic Volume Manager (Oracle ADVM) and the database instance.</p>
<p><a id="sthref353"></a>For Oracle ASM in Oracle Database 11<span class="italic">g</span>, <code>10.1</code> is the default setting for the <code>COMPATIBLE.ASM</code> attribute when using the SQL <code>CREATE</code> <code>DISKGROUP</code> statement, the ASMCMD <code>mkdg</code> command, and Oracle Enterprise Manager <span class="bold">Create</span> <span class="bold">Disk</span> <span class="bold">Group</span> page. When creating a disk group with ASMCA, the default setting is <code>11.2</code>.</p>
</div>
<!-- class="sect3" -->
<a id="BABCAJJD"></a><a id="OSTMG94139"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">COMPATIBLE.RDBMS</h4>
<p><a id="sthref354"></a>The value for the disk group <code>COMPATIBLE.RDBMS</code> attribute determines the minimum <code>COMPATIBLE</code> database initialization parameter setting for any database instance that is allowed to use the disk group. Before advancing the <code>COMPATIBLE</code>.<code>RDBMS</code> attribute, ensure that the values for the <a id="sthref355"></a><a id="sthref356"></a><code>COMPATIBLE</code> initialization parameter for all of the databases that access the disk group are set to at least the value of the new setting for <code>COMPATIBLE</code>.<code>RDBMS</code>.</p>
<p>For example, if the <code>COMPATIBLE</code> initialization parameters of the databases are set to either <code>11.1</code> or <code>11.2</code>, then <code>COMPATIBLE.RDBMS</code> can be set to any value between <code>10.1</code> and <code>11.1</code> inclusively.</p>
<p><a id="sthref357"></a>For Oracle ASM in Oracle Database 11<span class="italic">g</span>, <code>10.1</code> is the default setting for the <code>COMPATIBLE</code>.<code>RDBMS</code> attribute when using the SQL <code>CREATE</code> <code>DISKGROUP</code> statement, the ASMCMD <code>mkdg</code> command, ASMCA <span class="bold">Create</span> <span class="bold">Disk</span> <span class="bold">Group</span> page, and Oracle Enterprise Manager <span class="bold">Create</span> <span class="bold">Disk</span> <span class="bold">Group</span> page.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The database initialization parameter <code>COMPATIBLE</code> enables you to use a new release of Oracle Database, while at the same time guaranteeing backward compatibility with an earlier release. See <a class="olink REFRN10019" href="../../server.112/e40402/initparams035.htm#REFRN10019"><span class="italic">Oracle Database Reference</span></a> for more information about the <code>COMPATIBLE</code> initialization parameter.</div>
</div>
<!-- class="sect3" -->
<a id="CHDFFADC"></a><a id="OSTMG94140"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">COMPATIBLE.ADVM</h4>
<p><a id="sthref358"></a>The value for the disk group <code>COMPATIBLE.ADVM</code> attribute determines whether the disk group can contain Oracle ASM volumes. The value must be set to <code>11.2</code> or higher. Before setting this attribute, the <code>COMPATIBLE.ASM</code> value must be <code>11.2</code> or higher. Also, the Oracle ADVM volume drivers must be loaded in the supported environment.</p>
<p><a id="sthref359"></a>By default, the value of the <code>COMPATIBLE.ADVM</code> attribute is empty until set.</p>
<p>For more information about Oracle ADVM, see <a href="asmfilesystem.htm#CACHFACJ">"Overview of Oracle ASM Dynamic Volume Manager"</a>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDJDDFG"></a><a id="OSTMG94141"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Setting Disk Group Compatibility Attributes</h3>
<p><a id="sthref360"></a>This section discusses the settings of the disk group compatibility attributes and how to set the attribute values with the <code>CREATE</code> <code>DISKGROUP</code> or <code>ALTER</code> <code>DISKGROUP</code> SQL statement.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CHDGAEDF">Valid Combinations of Compatibility Attribute Settings</a></p>
</li>
<li>
<p><a href="#CHDHGJCB">Using CREATE DISKGROUP with Compatibility Attributes</a></p>
</li>
<li>
<p><a href="#CHDDDFJJ">Using ALTER DISKGROUP with Compatibility Attributes</a></p>
</li>
<li>
<p><a href="#CHDJEFBA">Viewing Compatibility Attribute Settings</a></p>
</li>
<li>
<p><a href="#CHDBCHIH">Features Enabled By Disk Group Compatibility Attribute Settings</a></p>
</li>
<li>
<p><a href="#CHDIJHAJ">Reverting Disk Group Compatibility</a></p>
</li>
</ul>
<p>You can also set the disk group compatibility settings with Oracle Enterprise Manager, Oracle ASM command-line utility (ASMCMD), and Oracle ASM Configuration Assistant (ASMCA). See <a href="asm_em.htm#CACHBFDE">Chapter 9, "Administering Oracle ASM with Oracle Enterprise Manager"</a>, <a href="asmca.htm#CHDEIHJA">Chapter 11, "Oracle ASM Configuration Assistant"</a>, and <a href="asm_util.htm#BJEGEAAJ">Chapter 12, "Oracle ASM Command-Line Utility"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Advancing the values for disk group compatibility attributes is an irreversible operation. See <a href="#CHDIJHAJ">"Reverting Disk Group Compatibility"</a>.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the disk group compatibility SQL statements</div>
<a id="CHDGAEDF"></a><a id="OSTMG94142"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Valid Combinations of Compatibility Attribute Settings</h4>
<p><a id="sthref361"></a>When setting the values for the disk group attributes, specify at least the major and minor versions of a valid Oracle Database release number. For example, you can specify compatibility as <code>'11.1'</code> or <code>'11.2'</code>; Oracle assumes that any missing version number digits are zeros.</p>
<p><a href="#CHDCACFD">Table 4-2</a> shows some valid combinations of the disk group compatibility attributes and the valid Oracle ASM and database instance versions for each combination.</p>
<div class="tblformalwide">
<p class="titleintable"><a id="OSTMG94143"></a><a id="sthref362"></a><a id="CHDCACFD"></a>Table 4-2 Examples of disk group compatibility attribute settings</p>
<table class="cellalignment1546" title="Examples of disk group compatibility attribute settings" summary="Valid compatibility attribute combinations table" dir="ltr">
<thead>
<tr class="cellalignment1537">
<th class="cellalignment1547" id="r1c1-t39">COMPATIBLE.ASM</th>
<th class="cellalignment1547" id="r1c2-t39">COMPATIBLE.RDBMS</th>
<th class="cellalignment1547" id="r1c3-t39">COMPATIBLE.ADVM</th>
<th class="cellalignment1547" id="r1c4-t39">ASM Instance Version</th>
<th class="cellalignment1547" id="r1c5-t39">COMPATIBLE Setting for RDBMS Instance</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r2c1-t39" headers="r1c1-t39">
<p>10.1</p>
</td>
<td class="cellalignment1543" headers="r2c1-t39 r1c2-t39">
<p>10.1</p>
</td>
<td class="cellalignment1543" headers="r2c1-t39 r1c3-t39">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r2c1-t39 r1c4-t39">
<p>&gt;= 10.1</p>
</td>
<td class="cellalignment1543" headers="r2c1-t39 r1c5-t39">
<p>&gt;= 10.1</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r3c1-t39" headers="r1c1-t39">
<p>11.1</p>
</td>
<td class="cellalignment1543" headers="r3c1-t39 r1c2-t39">
<p>10.1</p>
</td>
<td class="cellalignment1543" headers="r3c1-t39 r1c3-t39">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r3c1-t39 r1c4-t39">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r3c1-t39 r1c5-t39">
<p>&gt;= 10.1</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r4c1-t39" headers="r1c1-t39">
<p>11.2</p>
</td>
<td class="cellalignment1543" headers="r4c1-t39 r1c2-t39">
<p>11.1</p>
</td>
<td class="cellalignment1543" headers="r4c1-t39 r1c3-t39">
<p>11.2</p>
</td>
<td class="cellalignment1543" headers="r4c1-t39 r1c4-t39">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r4c1-t39 r1c5-t39">
<p>&gt;= 11.1</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r5c1-t39" headers="r1c1-t39">
<p>11.2</p>
</td>
<td class="cellalignment1543" headers="r5c1-t39 r1c2-t39">
<p>11.2</p>
</td>
<td class="cellalignment1543" headers="r5c1-t39 r1c3-t39">
<p>11.2</p>
</td>
<td class="cellalignment1543" headers="r5c1-t39 r1c4-t39">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r5c1-t39 r1c5-t39">
<p>&gt;= 11.2</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" -->
<p>These are some possible combinations of Oracle ASM and database releases:</p>
<ul>
<li>
<p>The database release is 11<span class="italic">g</span> release 2 (11.2) (database initialization parameter <code>COMPATIBLE</code> is set to <code>11.2</code>) and the Oracle ASM release is 11<span class="italic">g</span> release 2 (11.2). The <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group attributes are set to the default value of <code>10.1</code> for a disk group.</p>
<p>The Oracle ASM disk group functionality remains at 10<span class="italic">g</span>.</p>
</li>
<li>
<p>The database release is 10<span class="italic">g</span> and the Oracle ASM release is 11.2. <code>COMPATIBLE.ASM</code> is set to <code>11.2</code> and <code>COMPATIBLE.RDBMS</code> is set to <code>10.1</code> for a disk group.</p>
<p>The disk group features enabled for this combination of attribute settings are shown in <a href="#CHDIBHBB">Table 4-3</a>.</p>
</li>
<li>
<p>The database release is 11.2 (database initialization parameter <code>COMPATIBLE</code> is set to <code>11.2</code>) and the Oracle ASM release is 11.2. All the disk group compatibility attributes are set to <code>11.2</code> for a disk group.</p>
<p>The disk group features enabled for this combination of attribute settings are shown in <a href="#CHDIBHBB">Table 4-3</a>.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="CHDHGJCB"></a><a id="OSTMG94144"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using CREATE DISKGROUP with Compatibility Attributes</h4>
<p><a id="sthref363"></a>You can specify the compatibility settings for a disk group with the <code>CREATE</code> <code>DISKGROUP</code> statement when creating the disk group.</p>
<p>The following example creates a normal redundancy disk group <code>data1</code> with the Oracle ASM compatibility set to <code>11.2</code> and the RDBMS compatibility set to the default (the <code>COMPATIBLE.RDBMS</code> default is less than or equal to 11.2):</p>
<pre>
CREATE DISKGROUP data1 DISK '/dev/sd*' 
       ATTRIBUTE 'compatible.asm' = '11.2';
</pre>
<p>The following example creates a normal redundancy disk group <code>data2</code> with the ASM, RDBMS, and ADVM compatibility set to <code>11.2</code>:</p>
<pre>
CREATE DISKGROUP data2 DISK '/dev/sd*' 
       ATTRIBUTE 'compatible.asm' = '11.2', 'compatible.rdbms' = '11.2',
                 'compatible.advm' = '11.2';
</pre></div>
<!-- class="sect3" -->
<a id="CHDDDFJJ"></a><a id="OSTMG94145"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using ALTER DISKGROUP with Compatibility Attributes</h4>
<p><a id="sthref364"></a>After a disk group has been created, you can use the <code>ALTER</code> <code>DISK</code><code>GROUP</code> SQL statement to change the compatibility attributes. The <code>ALTER</code> <code>DISK</code><code>GROUP</code> SQL statement ensures that Oracle can advance the compatibility of the specified disk group before committing the change.</p>
<p>All of the affected databases and file systems should be online when running <code>ALTER</code> <code>DISKGROUP</code> to ensure that advancing compatibility does not reduce the database and file system access. When advancing disk group compatibility, you must advance the <code>COMPATIBLE</code>.<code>ASM</code> attribute before the <code>COMPATIBLE</code>.<code>RDBMS</code> or <code>COMPATIBLE.ADVM</code> attribute to ensure a valid combination of compatible attribute settings as shown in <a href="#CHDCACFD">Table 4-2</a>. You can advance only one compatibility attribute in a single <code>ALTER</code> <code>DISKGROUP</code> statement.</p>
<p>The following example advances the Oracle ASM compatibility for disk group <code>data3</code> to <code>11.2</code>. An Oracle ASM instance must be at release <code>11.2</code> or higher to access the <code>data3</code> disk group.</p>
<pre>
ALTER DISKGROUP data3 SET ATTRIBUTE 'compatible.asm' = '11.2';
</pre>
<p>The following example advances the <code>COMPATIBLE.RDBMS</code> and <code>COMPATIBLE.ADVM</code> compatibility attributes of the disk group <code>data3</code> to <code>11.2</code>. This example assumes that the value of <code>COMPATIBLE.ASM</code> is set to <code>11.2</code>.</p>
<pre>
ALTER DISKGROUP data3 SET ATTRIBUTE 'compatible.rdbms' = '11.2',
ALTER DISKGROUP data3 SET ATTRIBUTE 'compatible.advm' = '11.2';
</pre></div>
<!-- class="sect3" -->
<a id="CHDJEFBA"></a><a id="OSTMG94146"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Viewing Compatibility Attribute Settings</h4>
<p><a id="sthref365"></a>You can view the disk group compatibility settings in the <a id="sthref366"></a><code>V$ASM_ATTRIBUTE</code> view. However, the <code>V$ASM_ATTRIBUTE</code> view does not display any rows when the <code>COMPATIBLE.ASM</code> value is set to <code>10.1</code>. Instead you can determine the values for the <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group compatibility attributes with the <code>COMPATIBILITY</code> and <code>DATABASE_COMPATIBILITY</code> columns of the <a id="sthref367"></a><code>V$ASM_DISKGROUP</code> view.</p>
<p>See <a href="asmviews.htm#BABJEAAJ">Example 6-1, "Viewing disk group attributes with V$ASM_ATTRIBUTE"</a> for an example querying the <code>V$ASM_ATTRIBUTE</code> view.</p>
<p>You can also display the disk group compatibility attributes with the ASMCMD command <code>lsattr</code>. For information about <code>lsattr</code>, see <a href="asm_util004.htm#CIHGBCHG">"lsattr"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF01114" href="../../server.112/e41084/statements_5008.htm#SQLRF01114"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about disk group attributes</p>
</li>
<li>
<p><a class="olink REFRN003" href="../../server.112/e40402/dynviews_part.htm#REFRN003"><span class="italic">Oracle Database Reference</span></a> for details on the <code>V$ASM_DISKGROUP</code> and <code>V$ASM_ATTRIBUTE</code> dynamic performance views</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="CHDBCHIH"></a><a id="OSTMG94147"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Features Enabled By Disk Group Compatibility Attribute Settings</h4>
<p><a id="sthref368"></a><a href="#CHDIBHBB">Table 4-3</a> describes the features enabled by valid combinations of the disk group compatibility attribute settings.</p>
<div class="tblformalwide">
<p class="titleintable"><a id="OSTMG94148"></a><a id="sthref369"></a><a id="CHDIBHBB"></a>Table 4-3 Features enabled by disk group compatibility attribute settings</p>
<table class="cellalignment1546" title="Features enabled by disk group compatibility attribute settings" summary="Compatibility attributes table for features" dir="ltr">
<thead>
<tr class="cellalignment1537">
<th class="cellalignment1547" id="r1c1-t41">Disk Group Features Enabled</th>
<th class="cellalignment1547" id="r1c2-t41">COMPATIBLE.ASM</th>
<th class="cellalignment1547" id="r1c3-t41">COMPATIBLE.RDBMS</th>
<th class="cellalignment1547" id="r1c4-t41">COMPATIBLE.ADVM</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r2c1-t41" headers="r1c1-t41">
<p><a id="sthref370"></a><a id="sthref371"></a>Support for larger AU sizes (32 or 64 MB)</p>
</td>
<td class="cellalignment1543" headers="r2c1-t41 r1c2-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r2c1-t41 r1c3-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r2c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r3c1-t41" headers="r1c1-t41">
<p><a id="sthref372"></a>Attributes are displayed in the <code>V$ASM_ATTRIBUTE</code> view</p>
</td>
<td class="cellalignment1543" headers="r3c1-t41 r1c2-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r3c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r3c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r4c1-t41" headers="r1c1-t41">
<p><a id="sthref373"></a>Fast mirror resync</p>
</td>
<td class="cellalignment1543" headers="r4c1-t41 r1c2-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r4c1-t41 r1c3-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r4c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r5c1-t41" headers="r1c1-t41">
<p><a id="sthref374"></a><a id="sthref375"></a>Variable size extents</p>
</td>
<td class="cellalignment1543" headers="r5c1-t41 r1c2-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r5c1-t41 r1c3-t41">
<p>&gt;= 11.1</p>
</td>
<td class="cellalignment1543" headers="r5c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r6c1-t41" headers="r1c1-t41">
<p><a id="sthref376"></a>Exadata storage</p>
</td>
<td class="cellalignment1543" headers="r6c1-t41 r1c2-t41">
<p>&gt;= 11.1.0.7</p>
</td>
<td class="cellalignment1543" headers="r6c1-t41 r1c3-t41">
<p>&gt;= 11.1.0.7</p>
</td>
<td class="cellalignment1543" headers="r6c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r7c1-t41" headers="r1c1-t41">
<p><a id="sthref377"></a>Intelligent Data Placement</p>
</td>
<td class="cellalignment1543" headers="r7c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r7c1-t41 r1c3-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r7c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r8c1-t41" headers="r1c1-t41">
<p><a id="sthref378"></a><a id="sthref379"></a>OCR and voting files in a disk group</p>
</td>
<td class="cellalignment1543" headers="r8c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r8c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r8c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r9c1-t41" headers="r1c1-t41">
<p><a id="sthref380"></a>Sector size set to nondefault value</p>
</td>
<td class="cellalignment1543" headers="r9c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r9c1-t41 r1c3-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r9c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r10c1-t41" headers="r1c1-t41">
<p><a id="sthref381"></a>Oracle ASM SPFILE in a disk group</p>
</td>
<td class="cellalignment1543" headers="r10c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r10c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r10c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r11c1-t41" headers="r1c1-t41">
<p><a id="sthref382"></a>Oracle ASM File Access Control</p>
</td>
<td class="cellalignment1543" headers="r11c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r11c1-t41 r1c3-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r11c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r12c1-t41" headers="r1c1-t41">
<p><a id="sthref383"></a>Volumes in disk groups</p>
</td>
<td class="cellalignment1543" headers="r12c1-t41 r1c2-t41">
<p>&gt;= 11.2</p>
</td>
<td class="cellalignment1543" headers="r12c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r12c1-t41 r1c4-t41">
<p>&gt;= 11.2</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r13c1-t41" headers="r1c1-t41">
<p><a id="sthref384"></a><code>ASM_POWER_LIMIT</code> value up to <code>1024</code></p>
</td>
<td class="cellalignment1543" headers="r13c1-t41 r1c2-t41">
<p>&gt;= 11.2.0.2</p>
</td>
<td class="cellalignment1543" headers="r13c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r13c1-t41 r1c4-t41">
<p>n/a</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r14c1-t41" headers="r1c1-t41">
<p><a id="sthref385"></a><a id="sthref386"></a><a id="sthref387"></a><a id="sthref388"></a>Encryption, replication, security, tagging on Linux systems</p>
</td>
<td class="cellalignment1543" headers="r14c1-t41 r1c2-t41">
<p>&gt;= 11.2.0.2</p>
</td>
<td class="cellalignment1543" headers="r14c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r14c1-t41 r1c4-t41">
<p>&gt;= 11.2.0.2</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r15c1-t41" headers="r1c1-t41">
<p><a id="sthref389"></a><a id="sthref390"></a><a id="sthref391"></a><a id="sthref392"></a>Encryption, replication, security, tagging on Windows systems</p>
</td>
<td class="cellalignment1543" headers="r15c1-t41 r1c2-t41">
<p>&gt;= 11.2.0.3</p>
</td>
<td class="cellalignment1543" headers="r15c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r15c1-t41 r1c4-t41">
<p>&gt;= 11.2.0.3</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r16c1-t41" headers="r1c1-t41">
<p><a id="sthref393"></a>Read-write snapshots</p>
</td>
<td class="cellalignment1543" headers="r16c1-t41 r1c2-t41">
<p>&gt;= 11.2.0.3</p>
</td>
<td class="cellalignment1543" headers="r16c1-t41 r1c3-t41">
<p>n/a</p>
</td>
<td class="cellalignment1543" headers="r16c1-t41 r1c4-t41">
<p>&gt;= 11.2.0.3</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" -->
<p>The following list applies to <a href="#CHDIBHBB">Table 4-3</a>.</p>
<ul>
<li>
<p>If encryption is configured for the first time on Oracle ASM 11<span class="italic">g</span> release 2 version 11.2.0.3 on Linux or if encryption parameters must be changed or a new volume encryption key must be created following a software upgrade to Oracle ASM 11<span class="italic">g</span> release 2 version 11.2.0.3 on Linux, then the disk group compatibility attributes for <code>ASM</code> and <code>ADVM</code> must be set to <code>11.2.0.3</code>.</p>
</li>
<li>
<p>Oracle ASM features not explicitly listed in <a href="#CHDIBHBB">Table 4-3</a> do not require advancing the disk group compatibility attribute settings.</p>
</li>
<li>
<p>The value of <code>COMPATIBLE.ASM</code> must always be greater than or equal to the value of <code>COMPATIBLE.RDBMS</code> and <code>COMPATIBLE.ADVM</code>.</p>
</li>
<li>
<p>A value of not applicable (n/a) means that the setting of the attribute has no effect on the feature.</p>
</li>
<li>
<p>For information about the rebalancing process and the <code>ASM_POWER_LIMIT</code> initialization parameter, refer to <a href="asminst.htm#BHCDHJFA">"ASM_POWER_LIMIT"</a>.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="CHDIJHAJ"></a><a id="OSTMG94149"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Reverting Disk Group Compatibility</h4>
<p><a id="sthref394"></a><a id="sthref395"></a><a id="sthref396"></a>Advancing the values for disk group compatibility attributes is an irreversible operation. If you advance the disk group compatibility settings, you cannot change the values back to the previous settings. To revert to the previous values, you must create a new disk group with the old compatibility attribute settings and then restore the database files that were in the disk group to the new disk group.</p>
<p>When you revert to a new disk group with the old compatibility attribute settings, the latest Oracle ASM features might not be available. For example, if you revert the disk group compatibility to a pre-11.2 value, Oracle ACFS functionality is not available.</p>
<p>For example, you could perform the following procedure to revert a disk group to previous compatibility settings:</p>
<ol>
<li>
<p>If the Oracle ASM SPFILE is in the disk group, move this SPFILE out of the disk group:</p>
<ol>
<li>
<p>Connect with SQL*Plus to the Oracle ASM instance.</p>
</li>
<li>
<p>Create a PFILE in the file system.</p>
<p>For example:</p>
<pre>
SQL&gt; CREATE PFILE '$ORACLE_HOME/dbs/asmspfile.ora' FROM SPFILE
</pre></li>
</ol>
</li>
<li>
<p>If the OCR and voting files are in the disk group, move them out of this disk group.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink CWADD838" href="../../rac.112/e41959/admin.htm#CWADD838"><span class="italic">Oracle Clusterware Administration and Deployment Guide</span></a> for information about administering OCR and voting files</div>
</li>
<li>
<p>Back up any files that must be saved.</p>
<ol>
<li>
<p>Back up the database files.</p>
</li>
<li>
<p>If an Oracle ACFS file system is mounted on an Oracle ADVM volume on the disk group, the operating system files in the file system must be backed up or copied to a location outside the file system mount point.</p>
</li>
</ol>
</li>
<li>
<p>Create a new disk group using SQL <code>CREATE</code> <code>DISKGROUP</code> specifying the previous values for the disk group attribute settings.</p>
<p>For information about creating a disk group, see <a href="#CHDBDAGI">"Using the CREATE DISKGROUP SQL Statement"</a>.</p>
</li>
<li>
<p>Restore the database files into the newly created disk group using Recovery Manager (RMAN).</p>
<p>For information about moving data files between disk groups, see <a href="asm_rman.htm#CHDBDJJG">"Moving Data Files Between Oracle ASM Disk Groups Using RMAN"</a>.</p>
</li>
<li>
<p>Drop the disk group with the advanced disk group compatibility settings using SQL <code>DROP</code> <code>DISKGROUP</code> <code>INCLUDING</code> <code>CONTENTS</code> to remove the disk group and its contents.</p>
<p>This SQL statement also removes any Oracle ACFS file system and its contents.</p>
<p>For information about dropping a disk group, see <a href="#i1020539">"Dropping Disk Groups"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABCADAH"></a><a id="OSTMG94150"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><a id="sthref397"></a><a id="sthref398"></a>Considerations When Setting Disk Group Compatibility in Replicated Environments</h3>
<p><a id="sthref399"></a>If you advance disk group compatibility, then you could enable the creation of files that are too large to be managed by a previous Oracle database release. You must be aware of the file size limits because replicated sites cannot continue using the software from a previous release to manage these large files. The disk group compatibility settings should be the same for all replicated environments.</p>
<p><a href="#BABFJBEG">Table 4-4</a> shows the maximum Oracle ASM file sizes supported for <code>COMPATIBLE.RDBMS</code> settings when the <code>AU_SIZE</code> attribute is set to one megabyte for a disk group.</p>
<div class="tblformal">
<p class="titleintable"><a id="OSTMG94151"></a><a id="sthref400"></a><a id="BABFJBEG"></a>Table 4-4 Maximum Oracle ASM file sizes for disk groups with AU_SIZE equal to 1 MB</p>
<table class="cellalignment1548" title="Maximum Oracle ASM file sizes for disk groups with AU_SIZE equal to 1 MB" summary="Max ASM File Sizes" dir="ltr">
<thead>
<tr class="cellalignment1537">
<th class="cellalignment1547" id="r1c1-t43">Redundancy</th>
<th class="cellalignment1547" id="r1c2-t43">COMPATIBLE.RDBMS = 10.1</th>
<th class="cellalignment1547" id="r1c3-t43">COMPATIBLE.RDBMS &gt;= 11.1</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r2c1-t43" headers="r1c1-t43">
<p>External</p>
</td>
<td class="cellalignment1543" headers="r2c1-t43 r1c2-t43">
<p>16 TB</p>
</td>
<td class="cellalignment1543" headers="r2c1-t43 r1c3-t43">
<p>140 PB</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r3c1-t43" headers="r1c1-t43">
<p>Normal</p>
</td>
<td class="cellalignment1543" headers="r3c1-t43 r1c2-t43">
<p>5.8 TB</p>
</td>
<td class="cellalignment1543" headers="r3c1-t43 r1c3-t43">
<p>23 PB</p>
</td>
</tr>
<tr class="cellalignment1537">
<td class="cellalignment1543" id="r4c1-t43" headers="r1c1-t43">
<p>High</p>
</td>
<td class="cellalignment1543" headers="r4c1-t43 r1c2-t43">
<p>3.9 TB</p>
</td>
<td class="cellalignment1543" headers="r4c1-t43 r1c3-t43">
<p>15 PB</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p><a href="#BABFJBEG">Table 4-4</a> shows that Oracle Database 10<span class="italic">g</span> can only support a file size of up to 16 TB for external redundancy. If you advance the <code>COMPATIBILE.RDBMS</code> attribute to <code>11.1</code> or greater, then a file can grow beyond 16 TB. However, the larger size causes the file to be unusable in a replicated and disaster recovery site if the disaster recovery site has a disk group <code>COMPATIBLE.RDBMS</code> setting that is incompatible with the larger size.</p>
<p>For information about Oracle ASM storage sizes, see <a href="#CHDCGGED">"Oracle ASM Storage Limits"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink UPGRD005" href="../../server.112/e23633/intro.htm#UPGRD005"><span class="italic">Oracle Database Upgrade Guide</span></a> for information about database compatibility</p>
</li>
<li>
<p><a class="olink ADMIN002" href="../../server.112/e25494/create.htm#ADMIN002"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about the <code>COMPATIBLE</code> initialization parameter and irreversible compatibility</p>
</li>
<li>
<p><a class="olink REFRN10019" href="../../server.112/e40402/initparams035.htm#REFRN10019"><span class="italic">Oracle Database Reference</span></a> for information about the <code>COMPATIBLE</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDICHHE"></a><a id="OSTMG02660"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Managing Oracle ASM File Access Control for Disk Groups</h2>
<p><a id="sthref401"></a><a id="sthref402"></a><a id="sthref403"></a><a id="sthref404"></a>Oracle ASM File Access Control provides optional protection for the content of Oracle ASM disk groups from accidental access by unauthorized Oracle ASM clients, such as an unauthorized database.</p>
<p>To set up Oracle ASM File Access Control, you must designate separate operating system groups as described in <a href="asminst.htm#CHDGHHIJ">"Using Separate Operating System Groups for Oracle ASM Users"</a>. Oracle ASM File Access Control is available for Linux and UNIX computers only.</p>
<p>You can manage Oracle ASM file access control with ASMCMD commands, Oracle Enterprise Manager, and SQL statements.</p>
<p>This section contains these topics:</p>
<ul>
<li>
<p><a href="#CHDIFDHD">About Oracle ASM File Access Control</a></p>
</li>
<li>
<p><a href="#CHDHEFFA">Setting Disk Group Attributes for Oracle ASM File Access Control</a></p>
</li>
<li>
<p><a href="#CHDHDCIJ">Using SQL Statements to Manage Oracle ASM File Access Control</a></p>
</li>
</ul>
<p>For information about managing Oracle ASM File Access Control with ASMCMD commands, see <a href="asm_util006.htm#CIHDGDJA">"ASMCMD File Access Control Commands"</a>.</p>
<p>For information about managing Oracle ASM File Access Control with Oracle Enterprise Manager, see <a href="asm_em.htm#BABBGJED">"Managing Oracle ASM File Access Control with Oracle Enterprise Manager"</a>.</p>
<p>For information about views that provide details about Oracle ASM file access control, see <a href="asmviews.htm#CHDDIBCD">"Viewing Oracle ASM File Access Control Information"</a>.</p>
<p>For information about controlling accessing to Oracle ASM instances, see <a href="asminst.htm#CHDEJBAI">"Authentication for Accessing Oracle ASM Instances"</a>.</p>
<a id="CHDIFDHD"></a><a id="OSTMG02650"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Oracle ASM File Access Control</h3>
<p><a id="sthref405"></a>Oracle ASM File Access Control restricts the access of files to specific Oracle ASM clients that connect as SYSDBA. An Oracle ASM client is typically a database, which is identified as the user that owns the database instance home. Oracle ASM File Access Control uses this user name to identify a database. Oracle ASM File Access Control restricts access based on the operating system effective user identification number of a database owner. For example, in <a href="asminst.htm#CHDBGJEE">Table 3-2, "Separated operating system groups and privileges for Oracle ASM users"</a> the databases are identified as <code>oracle1</code> and <code>oracle2</code>.</p>
<p>Oracle ASM uses file access control to determine the additional privileges that are given to a database that has been authenticated AS SYSDBA on the Oracle ASM instance. These additional privileges include the ability to modify and delete certain files, aliases, and user groups.</p>
<p>You can set up user groups to specify the list of databases that share the same access permissions to Oracle ASM files. User groups are lists of databases and any database that authenticates AS SYSDBA can create a user group. However, only the creator of a group can delete it or modify its membership list.</p>
<p>Each Oracle ASM file has three categories of privileges: owner, group, and other. Each category can have no permission, read-only permission, or read-write permission.</p>
<p>The file owner is usually the creator of the file and can assign permissions for the file in any of the owner, group, or other categories. The owner can also change the group associated with the file.</p>
<p>When administering Oracle ASM File Access Control, Oracle recommends that you connect as SYSDBA to the database instance that is the owner, or planned owner, of the files in the disk group.</p>
<p><a id="sthref406"></a>To set up Oracle ASM File Access Control for files in a disk group, perform the following steps:</p>
<ol>
<li>
<p>Alter a new or existing disk group to set the Oracle ASM File Access Control disk group attributes.</p>
<p>For a newly-created disk group, you should set the disk group attributes before creating any files in the disk group.</p>
<p>See <a href="#CHDHEFFA">"Setting Disk Group Attributes for Oracle ASM File Access Control"</a>.</p>
</li>
<li>
<p>For files that exist in a disk group before setting the Oracle ASM File Access Control disk group attributes, you must explicitly set the permissions and ownership on those existing files.</p>
<p>Ensure that the user exists before setting ownership or permissions on a file. The file must be closed before setting the ownership or permissions.</p>
<p>See <code>ALTER</code> <code>DISKGROUP</code> <code>SET</code> <code>PERMISSION</code> and <code>ALTER</code> <code>DISKGROUP</code> <code>SET</code> <code>OWNERSHIP</code> in <a href="#CHDHDCIJ">"Using SQL Statements to Manage Oracle ASM File Access Control"</a>.</p>
</li>
<li>
<p>Optionally, you can create user groups that are groups of database users that share the same access permissions to Oracle ASM files.</p>
<p>See <code>ALTER</code> <code>DISKGROUP</code> <code>ADD</code> <code>USERGROUP</code> in <a href="#CHDHDCIJ">"Using SQL Statements to Manage Oracle ASM File Access Control"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDHEFFA"></a><a id="OSTMG94152"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Setting Disk Group Attributes for Oracle ASM File Access Control</h3>
<p><a id="sthref407"></a>To manage Oracle ASM File Access Control for a disk group, you must set the <code>ACCESS_CONTROL.ENABLED</code> and <code>ACCESS_CONTROL.UMASK</code> disk group attributes. You can set the attributes by altering the disk group with the <code>ALTER</code> <code>DISKGROUP</code> SQL statement or you can set the attributes with the ASMCMD <code>setattr</code> command. For information about the ASMCMD <code>setattr</code> command, see <a href="asm_util004.htm#CIHHBIJH">"setattr"</a>.</p>
<p>When you set up file access control on an existing disk group, the files previously created remain accessible by everyone, unless you run the <code>ALTER</code> <code>DISKGROUP</code> <code>SET</code> <code>PERMISSION</code> SQL statement or the ASMCMD <code>chmod</code> command to restrict the permissions. For information about the ASMCMD <code>chmod</code> command, see <a href="asm_util006.htm#CIHGCACA">"chmod"</a>.</p>
<p>The <code>COMPATIBLE.ASM</code> and <code>COMPATIBLE.RDBMS</code> disk group attributes must be set to 11.2 or higher to enable Oracle ASM File Access Control. For information about disk group compatibility attributes, see <a href="#CHDDIGBJ">"Disk Group Compatibility"</a>.</p>
<p>The disk group attributes that control Oracle ASM File Access Control are the following:</p>
<ul>
<li>
<p><a id="sthref408"></a><a id="sthref409"></a><code>ACCESS_CONTROL.ENABLED</code></p>
<p>This attribute determines whether Oracle ASM File Access Control is enabled for a disk group.</p>
<p>The value can be <code>true</code> or <code>false</code>. The default is <code>false</code>.</p>
<p>If the attribute is set to <code>true</code>, accessing Oracle ASM files is subject to access control. If <code>false</code>, any user can access every file in the disk group. All other operations behave independently of this attribute.</p>
</li>
<li>
<p><a id="sthref410"></a><a id="sthref411"></a><code>ACCESS_CONTROL.UMASK</code></p>
<p>This attribute determines which permissions are masked out on the creation of an Oracle ASM file for the user that owns the file, users in the same user group, and others not in the user group. This attribute applies to all files on a disk group.</p>
<p>The values can be combinations of three digits {<code>0</code>|<code>2</code>|<code>6</code>} {<code>0</code>|<code>2</code>|<code>6</code>} {<code>0</code>|<code>2</code>|<code>6</code>}. The default is <code>066</code>.</p>
<p>Setting to <code>0</code> masks out nothing. Setting to <code>2</code> masks out write permission. Setting to <code>6</code> masks out both read and write permissions.</p>
<p>Before setting the <code>ACCESS_CONTROL.UMASK</code> disk group attribute, you must set the <code>ACCESS_CONTROL.ENABLED</code> attribute to <code>true</code> to enable Oracle ASM File Access Control.</p>
</li>
</ul>
<p><a href="#CHDHDJJE">Example 4-11</a> shows how to enable Oracle ASM File Access Control for a disk group using SQL*Plus. In this example, the permissions setting is <code>026</code> which enables read-write access for the owner, read access for users in the group, and no access to others not in the group</p>
<div class="example">
<p class="titleinexample"><a id="CHDHDJJE"></a><a id="OSTMG94153"></a>Example 4-11 Setting up Oracle ASM File Access Control</p>
<pre>
ALTER DISKGROUP data1 SET ATTRIBUTE 'access_control.enabled' = 'true';
ALTER DISKGROUP data1 SET ATTRIBUTE 'access_control.umask' = '026';
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="CHDHDCIJ"></a><a id="OSTMG94154"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using SQL Statements to Manage Oracle ASM File Access Control</h3>
<p><a id="sthref412"></a>You can use the <code>ALTER</code> <code>DISKGROUP</code> SQL statement to manage file access control for Oracle ASM disk groups. These SQL statements are available for both database and Oracle ASM instances.</p>
<p>The SQL statements that support disk group access control are:</p>
<ul>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>ADD</code> <code>USERGROUP</code> ... <code>WITH</code> <code>MEMBER</code></p>
<p>Adds an Oracle ASM user group to a disk group. The user group name is limited to a maximum of 30 characters. The databases identified in the <code>MEMBER</code> clause must be in the disk group, as shown by <code>V$ASM_USER</code>, or the command returns an error. Any users authenticated as <code>SYSASM</code> or <code>SYSDBA</code> can create new user groups. For example:</p>
<pre>
SQL&gt; SELECT group_number, os_name FROM V$ASM_USER;

GROUP_NUMBER OS_NAME
------------ ----------------------------------------------------------------
           1 oracle1
           1 oracle2
...

SQL&gt; ALTER DISKGROUP data ADD USERGROUP 'test_grp1' 
     WITH MEMBER 'oracle1','oracle2';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>DROP</code> <code>USERGROUP</code></p>
<p>Drops an Oracle ASM user group from a disk group. Dropping a group might leave some files without a valid group. For those files to have a valid group, you must manually update the group associated with those files to a valid group.</p>
<pre>
SQL&gt; ALTER DISKGROUP data DROP USERGROUP 'test_grp1';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>MODIFY</code> <code>USERGROUP</code> <code>ADD</code> <code>MEMBER</code></p>
<p>Adds users to the specified user group. The users must be in the disk group, as shown by <code>V$ASM_USER</code>, or the command returns an error. Only the creator of the group or the Oracle ASM administrator can modify group membership.</p>
<pre>
SQL&gt; ALTER DISKGROUP data MODIFY USERGROUP 'test_grp2' ADD MEMBER 'oracle2';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>MODIFY</code> <code>USERGROUP</code> <code>DROP</code> <code>MEMBER</code></p>
<p>Removes users from the specified user group. If a member is not in the user group, then an error is returned. Only the creator of the group or the Oracle ASM administrator can modify group membership.</p>
<pre>
SQL&gt; ALTER DISKGROUP data MODIFY USERGROUP 'test_grp2' DROP MEMBER 'oracle2';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>ADD</code> <code>USER</code></p>
<p>Adds operating system (OS) users to an Oracle ASM disk group, so that these users can have access privileges on the disk group. The users must be existing operating system users, and their user names must have a corresponding operating system user ID or system ID. If a user exists in the disk group, as shown by <code>V$ASM_USER</code>, then the command records an error and continues to add other users, if any.</p>
<p>The operating system user of a running database instance is automatically added to a disk group when the database instance accesses that disk group and creates files. However, for a database instance to read files in a disk group without creating any files, then you must use the <code>ADD</code> <code>USER</code> clause to add that database user to the disk group. Also, you can use this clause to add a database user to an existing disk group immediately after setting the Oracle ASM File Access Control disk group attributes and before creating new files.</p>
<pre>
SQL&gt;  ALTER DISKGROUP DATA ADD USER 'oracle1';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>DROP</code> <code>USER</code></p>
<p>Drops operating system users from an Oracle ASM disk group. If a user is not in the disk group, then this command records an error and continues to drop other users, if any.</p>
<p>If the user owns any files on the same Oracle ASM disk group, then this command fails with an error, unless the <code>CASCADE</code> keyword is specified. If the latter case, then the user is deleted, along with all the files that the user owns.</p>
<p>If any files owned by the user are currently open, then the <code>DROP</code> <code>USER</code> command fails, and no files are deleted.</p>
<pre>
SQL&gt;  ALTER DISKGROUP DATA DROP USER 'oracle1';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>SET</code> <code>PERMISSION</code></p>
<p>Modifies permissions of an Oracle ASM file. Setting <code>read</code> <code>only</code> permission to a file that has <code>read</code> <code>write</code> permission revokes the <code>write</code> permission. Only the file owner or the Oracle ASM administrator can change the permissions of a file. You cannot change the permissions on an open file.</p>
<pre>
SQL&gt; ALTER DISKGROUP data SET PERMISSION OWNER=read write, GROUP=read only,
     OTHER=none FOR FILE '+data/controlfile.f';
</pre></li>
<li>
<p><code>ALTER</code> <code>DISKGROUP</code> <code>SET</code> <code>OWNERSHIP</code></p>
<p>Changes the owner or group of a file to the specified user or user group name, respectively. If the specified user or user group name does not exist, this command fails with an error. Only the owner of the file or the Oracle ASM administrator can run this command, and only the Oracle ASM administrator can change the owner. Also, the user group name must exist, and the owner of the file must be a member of that group. You cannot change the ownership of an open file.</p>
<pre>
SQL&gt; ALTER DISKGROUP data SET OWNERSHIP OWNER='oracle1', GROUP='test_grp1'
     FOR FILE '+data/controlfile.f';
</pre></li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><code>ALTER DISKGROUP</code></a> SQL statement in the <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1019481"></a><a id="OSTMG94155"></a>
<div class="sect1">
<h2 class="sect1">Mounting and Dismounting Disk Groups</h2>
<p><a id="sthref413"></a><a id="sthref414"></a>Disk groups that are specified in the <code>ASM_DISKGROUPS</code> initialization parameter are mounted automatically at Oracle ASM instance startup. This makes them available to all database instances running on the same node as Oracle ASM. The disk groups are dismounted at Oracle ASM instance shutdown. Oracle ASM also automatically mounts a disk group when you initially create it, and dismounts a disk group if you drop it.</p>
<p>When a disk group is mounted, a disk group number is chosen. This number may change across disk group mounts. A disk group number is not recorded in any persistent structure, but the current value can be viewed in the <code>GROUP_NUMBER</code> column of the V$ASM views.</p>
<p>When you want to mount or dismount disk groups manually, use the <code>ALTER DISKGROUP...MOUNT</code> or <code>ALTER DISKGROUP...DISMOUNT</code> statement. You can mount or dismount disk groups by name, or specify <code>ALL</code>.</p>
<p>If you try to dismount a disk group that contains open files, the statement fails, unless you also specify the <code>FORCE</code> clause.</p>
<p>In a clustered Oracle ASM environment in <code>RESTRICTED</code> mode, a disk group is mounted in single-instance exclusive mode. No other Oracle ASM instance in that cluster can mount that disk group. In this mode the disk group is not usable by any Oracle ASM client. Use this mode to perform a fast rebalance.</p>
<p>The following SQL statement dismounts all disk groups that are currently mounted to the Oracle ASM instance:</p>
<pre>
ALTER DISKGROUP ALL DISMOUNT;
</pre>
<p>The following SQL statement mounts disk group <code>data1</code>:</p>
<pre>
ALTER DISKGROUP data1 MOUNT;
</pre>
<a id="CHDJABBD"></a><a id="OSTMG94156"></a>
<div class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Mounting Disk Groups Using the FORCE Option</h3>
<p><a id="sthref415"></a><a id="sthref416"></a>Oracle ASM provides a <code>MOUNT</code> <code>FORCE</code> option with <code>ALTER</code> <code>DISKGROUP</code> to enable Oracle ASM disk groups to be mounted in normal or high redundancy modes even though some Oracle ASM disks may be unavailable to the disk group at mount time. The default behavior without the <code>FORCE</code> option is to fail to mount a disk group that has damaged or missing disks.</p>
<p>The <code>MOUNT</code> <code>FORCE</code> option is useful in situations where a disk is temporarily unavailable and you want to mount the disk group with reduced redundancy while you correct the situation that caused the outage.</p>
<p>To successfully mount with the <code>MOUNT</code> <code>FORCE</code> option, Oracle ASM must be able to find at least one copy of the extents for all of the files in the disk group. In this case, Oracle ASM can successfully mount the disk group, but with potentially reduced redundancy.</p>
<p>The disks that Oracle ASM cannot access are placed in an offline mode. Oracle ASM then begins timing the period that these disks are in an offline mode. If the disk offline time period exceeds the timer threshold set by <code>DISK_REPAIR_TIME</code> disk group attribute, then those disks are permanently dropped from the disk group. You can change the offline timer after a disk is put in an offline state by using the <code>ALTER</code> <code>DISKGROUP</code> <code>OFFLINE</code> statement. For more information about setting the <code>DISK_REPAIR_TIME</code> disk group attribute, see <a href="#CHDBCBGF">"Oracle ASM Fast Mirror Resync"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
An Oracle ASM instance mounts an incomplete disk group differently depending on the specified compatibility. See <a href="#CHDBCHIH">"Features Enabled By Disk Group Compatibility Attribute Settings"</a>.</div>
<p>In clustered Oracle ASM environments, if an Oracle ASM instance is not the first instance to mount the disk group, then using the <code>MOUNT</code> <code>FORCE</code> statement fails. This is because the disks have been accessed by another instance and the disks are not locally accessible.</p>
<p>If all disks are available, then using the <code>FORCE</code> option causes the <code>MOUNT</code> command to fail. This discourages unnecessary and improper use of the feature.</p>
<p>The following example shows how to use the <code>FORCE</code> option to force the mount of the <code>data1</code> disk group:</p>
<pre>
ALTER DISKGROUP data1 MOUNT FORCE
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a> for additional information about the <code>ALTER</code> <code>DISKGROUP</code> statement and the <code>FORCE</code> option</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABCGJHG"></a><a id="OSTMG94157"></a>
<div class="sect1">
<h2 class="sect1">Checking the Internal Consistency of Disk Group Metadata</h2>
<p><a id="sthref417"></a>You can check the internal consistency of disk group metadata using the <code>ALTER</code> <code>DISKGROUP</code> statement with the <code>CHECK</code> keyword. You can use this statement to check specific files in a disk group, specific disks or all disks in a disk group, or specific failure groups within a disk group. The disk group must be mounted to perform these checks.</p>
<p>By default, the <code>CHECK</code> <code>DISK</code> <code>GROUP</code> clause verifies all of the metadata directories. Oracle ASM displays summary errors and writes the details about the errors in an alert log. The <code>CHECK</code> keyword performs the following operations:</p>
<ul>
<li>
<p>Verifies the consistency of the disk</p>
</li>
<li>
<p>Cross checks all of the file extent maps and allocation tables for consistency</p>
</li>
<li>
<p>Checks that the alias metadata directory and file directory are linked correctly</p>
</li>
<li>
<p>Verifies that the alias directory tree is linked correctly</p>
</li>
<li>
<p>Checks that Oracle ASM metadata directories do not have unreachable allocated blocks</p>
</li>
</ul>
<p>The <code>REPAIR</code> <code>|</code> <code>NOREPAIR</code> clause specifies whether Oracle ASM should attempt to repair errors that are found during the check. The default is <code>NOREPAIR</code>. Use the <code>NOREPAIR</code> clause to receive alerts about inconsistencies and to suppress Oracle ASM from resolving the errors automatically. The following example statement checks for consistency in the metadata for all disks in the <code>data1</code> disk group:</p>
<pre>
ALTER DISKGROUP data1 CHECK ALL;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
The <a class="olink SQLRF01113" href="../../server.112/e41084/statements_1007.htm#SQLRF01113"><span class="italic">Oracle Database SQL Language Reference</span></a> for additional information about the <code>CHECK</code> clause syntax</div>
</div>
<!-- class="sect1" -->
<a id="i1020539"></a><a id="OSTMG94158"></a>
<div class="sect1">
<h2 class="sect1">Dropping Disk Groups</h2>
<p><a id="sthref418"></a><a id="sthref419"></a>The <code>DROP</code> <code>DISKGROUP</code> statement enables you to delete an Oracle ASM disk group and optionally, all of its files. You can specify the <code>INCLUDING</code> <code>CONTENTS</code> clause if you also want to delete all files that are contained in the disk group. The default is <code>EXCLUDING</code> <code>CONTENTS</code>, which provides syntactic consistency and prevents you from dropping the disk group if it has any contents</p>
<p>The Oracle ASM instance must be started and the disk group must be mounted with none of the disk group files open, in order for the <code>DROP DISKGROUP</code> statement to succeed. The statement does not return until the disk group has been dropped.</p>
<p>When you drop a disk group, Oracle ASM dismounts the disk group and removes the disk group name from the <code>ASM_DISKGROUPS</code> initialization parameter if a server parameter file is being used. If a text initialization parameter file is being used, and the disk group is mentioned in the <code>ASM_DISKGROUPS</code> initialization parameter, then you must remove the disk group name from the <code>ASM_DISKGROUPS</code> initialization parameter before the next time that you shut down and restart the Oracle ASM instance.</p>
<p>The following statement deletes <code>data1</code>:</p>
<pre>
DROP DISKGROUP data1;
</pre>
<p>After ensuring that none of the files contained in <code>data1</code> are open, Oracle ASM rewrites the header of each disk in the disk group to remove Oracle ASM formatting information. The statement does not specify <code>INCLUDING CONTENTS</code>, so the drop operation fails if the disk group contains any files.</p>
<p>If an Oracle Automatic Storage Management Cluster File System (Oracle ACFS) file system is mounted on a volume contained in the disk group, then the file system must be dismounted. If the file system has been registered, then it must be deregistered. The <code>INCLUDING</code> <code>CONTENTS</code> clause must be used to drop this disk group. All data in the file system is destroyed. To view the volumes and mount paths associated with a disk group, you can query the <code>V$ASM_VOLUME</code> view. For an example of a query on the <code>V$ASM_VOLUME</code> view, see <a href="asmviews.htm#CHDGDJGA">Example 6-16</a>. For information about deregistering and dismounting Oracle ACFS file systems, see <a href="asmfs_util001.htm#BABCJBBI">"Deregistering, Dismounting, and Disabling Volumes and Oracle ACFS File Systems"</a>.</p>
<p>If you cannot mount a disk group but must drop it, you can use the <code>FORCE</code> option of the <code>DROP</code> <code>DISKGROUP</code> statement. This command enables you to remove the headers on disks that belong to a disk group that cannot be mounted by any Oracle ASM instances as shown in the following example:</p>
<pre>
DROP DISKGROUP data1 FORCE
</pre>
<p>The disk group on which you perform this operation should not be mounted anywhere in the cluster. When you use the <code>FORCE</code> option, the Oracle ASM instance does not attempt to verify that a disk group is being used by another Oracle ASM instance in the same storage subsystem.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Use the <code>FORCE</code> option with extreme caution.</div>
<p>You can also drop a disk group with Oracle Enterprise Manager. See <a href="asm_em.htm#CIACBDEJ">"Dropping Disk Groups"</a>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDJAGHE"></a><a id="OSTMG94159"></a>
<div class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Renaming Disks Groups</h2>
<p><a id="sthref420"></a><a id="sthref421"></a><a id="sthref422"></a><a id="sthref423"></a>The <code>renamedg</code> tool enables you to change the name of a cloned disk group. The disk group must be dismounted on all nodes in the cluster before running <code>renamedg</code> on the disk group.</p>
<p><code>renamedg</code> renames a disk group using a two-step process:</p>
<ol>
<li>
<p>Phase one</p>
<p>This phase generates a configuration file to be used in phase two.</p>
</li>
<li>
<p>Phase two</p>
<p>This phase uses the configuration file to perform the renaming of the disk group.</p>
</li>
</ol>
<p>The syntax is:</p>
<br />
<code>renamedg</code> {<code>-help</code> | <code>help=true</code>}<br />
<br />
<code>renamedg</code><br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> [<code>phase</code>={ <code>one</code>|<code>two</code> |<code>both</code> } ] <code>dgname=</code><code><span class="codeinlineitalic">diskgroup</span></code><br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> <code>newdgname=</code><code><span class="codeinlineitalic">newdiskgroup</span></code> [<code>config=</code><code><span class="codeinlineitalic">configfile</span></code>]<br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> [ <code>asm_diskstring=</code><code><span class="codeinlineitalic">discoverystring</span></code><code>,</code> <code><span class="codeinlineitalic">discoverystring</span></code> ... ]<br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> [ <code>clean=</code>{<code>true</code>|<code>false</code>} ] [ <code>check=</code>{<code>true</code>|<code>false</code>} ]<br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> [ <code>confirm=</code>{<code>true</code>|<code>false</code>}] [ <code>verbose=</code>{ <code>true</code>|<code>false</code>} ]<br />
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code> [ <code>keep_voting_files=</code>{<code>true</code>|<code>false</code>}]<br />
<ul>
<li>
<p><code>phase=</code>{<code>one</code>|<code>two</code>|<code>both</code>}</p>
<p>Specifies the phase to be run. Allowed values are <code>one</code>, <code>two</code>, or <code>both</code>. This argument is optional. The default is <code>both</code>.</p>
<p>Typically you would run both phases. If a problem occurs during the second phase, then you can re-run phase <code>two</code> using the generated configuration file.</p>
</li>
<li>
<p><code>dgname=</code><code><span class="codeinlineitalic">diskgroup</span></code></p>
<p>Specifies the name of the disk group that to be renamed.</p>
</li>
<li>
<p><code>newdgname=</code><code><span class="codeinlineitalic">newdiskgroup</span></code></p>
<p>Specifies the new name for the disk group.</p>
</li>
<li>
<p><code>config=</code><code><span class="codeinlineitalic">configfile</span></code></p>
<p>Specifies the path to the configuration file to be generated during phase one or specifies the path to the configuration file to be used during phase two.</p>
<p>This argument is optional. The default configuration file is named <code>renamedg_config</code> and is located in the directory in which the command is run. The single quotations may be required on some platforms.</p>
</li>
<li>
<p><code>asm_diskstring=</code><code><span class="codeinlineitalic">discoverystring</span></code><code>,</code> <code><span class="codeinlineitalic">discoverystring</span></code> ...</p>
<p>Specifies the Oracle ASM discovery strings. The <code>asm_diskstring</code> value must be specified if the Oracle ASM disks are not in the default location for the platform. The single quotations may be required on some platforms, usually when wildcard characters are specified.</p>
</li>
<li>
<p><code>clean=</code>{<code>true</code>|<code>false</code>}</p>
<p>Specifies whether to tolerate errors that are otherwise ignored. The default is <code>true</code>.</p>
</li>
<li>
<p><code>check=</code>{<code>true</code>|<code>false</code>}</p>
<p>Specifies a boolean value that is used in the second phase. If <code>true</code>, then the tool prints the list of changes that are to be made to the disks. No writes are issued. It is an optional parameter that defaults to <code>false</code>.</p>
</li>
<li>
<p><code>confirm=</code>{<code>true</code>|<code>false</code>}</p>
<p>Specifies a boolean value that is used in the second phase. If <code>false</code>, then the tool prints the changes that are to be made and seeks confirmation before actually making the changes. It is an optional value that defaults to <code>false</code>. If check is set to <code>true</code>, then the value of this parameter is redundant.</p>
</li>
<li>
<p><code>verbose=</code>{<code>true</code>|<code>false</code>}</p>
<p>Specifies verbose execution when <code>verbose=true</code>. The default is <code>false</code>.</p>
</li>
<li>
<p><code>keep_voting_files=</code>{<code>true</code>|<code>false</code>}</p>
<p>Specifies whether voting files are kept in the renamed disk group. The default is <code>false</code> which deletes the voting files from the renamed disk group.</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
<code>renamedg</code> does not update <a id="sthref424"></a><a id="sthref425"></a>resources, nor does <code>renamedg</code> update any file references within the database. Because of this behavior, the original disk group resource is not automatically deleted after the completion of phase <code>two</code>. The status of the old disk group resource can be checked with the Oracle Clusterware Control (CRSCTL) <code>crsctl</code> <code>stat</code> <code>res</code> <code>-t</code> command and then manually deleted with the Server Control Utility (SRVCTL) <code>srvctl</code> <code>remove</code> <code>diskgroup</code> command.</div>
<p><a href="#CHDJICDB">Example 4-12</a> shows several examples of the use of <code>renamedg</code>. The first example renames the <code>data</code> disk group to <code>new_data</code> using a disk string to locate the disks and the <code>verbose</code> option is enabled. The second example only creates a configuration file during the completion of phase <code>one</code> of the <code>renamedg</code> operation. The third example runs phase <code>two</code> of the <code>renamedg</code> operation using a configuration file generated from a phase <code>one</code> execution of <code>renamedg</code>.</p>
<div class="example">
<p class="titleinexample"><a id="CHDJICDB"></a><a id="OSTMG94160"></a>Example 4-12 Using renamedg</p>
<pre>
$ renamedg dgname=data newdgname=new_data asm_diskstring='/devices/disk*'
      verbose=true

$ renamedg phase=one dgname=data newdgname=new_data
      asm_diskstring='/devices/disk*' config=/tmp/data2.conf verbose=true

$ renamedg phase=two dgname=data newdgname=new_data config=/tmp/data2.conf
      verbose=true
</pre></div>
<!-- class="example" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1536">
<tr>
<td class="cellalignment1543">
<table class="cellalignment1541">
<tr>
<td class="cellalignment1540"><a href="asminst.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1540"><a href="asmfilesystem.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2007, 2012,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1545">
<table class="cellalignment1539">
<tr>
<td class="cellalignment1540"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1540"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1540"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1540"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1540"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1540"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
