<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Configuring Factors</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1088" />
<meta name="dcterms.created" content="2016-11-14T16:25:10Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Vault Administrator's Guide" />
<meta name="dcterms.identifier" content="E23090-13" />
<meta name="dcterms.isVersionOf" content="DVADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="cfcmdaut.htm" title="Previous" type="text/html" />
<link rel="Next" href="cfseappr.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e23090.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">14/31</span> <!-- End Header -->
<div id="DVADM004" class="chapter"><a id="CIHCDJJA"></a>
<h1 class="chapter"><span class="secnum">7</span> Configuring Factors</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#BABICFFD">What Are Factors?</a></p>
</li>
<li>
<p><a href="#BABIEIJB">Default Factors</a></p>
</li>
<li>
<p><a href="#BABFBAAF">Creating a Factor</a></p>
</li>
<li>
<p><a href="#BABDBEEI">Editing a Factor</a></p>
</li>
<li>
<p><a href="#BABFJCHH">Adding an Identity to a Factor</a></p>
</li>
<li>
<p><a href="#BABGEBCE">Deleting a Factor</a></p>
</li>
<li>
<p><a href="#BABFIEDE">How Factors Work</a></p>
</li>
<li>
<p><a href="#BABIJFHF">Tutorial: Preventing Ad Hoc Tool Access to the Database</a></p>
</li>
<li>
<p><a href="#CIHCFJBG">Tutorial: Restricting User Activities Based on Session Data</a></p>
</li>
<li>
<p><a href="#BABBIDEH">Guidelines for Designing Factors</a></p>
</li>
<li>
<p><a href="#BABJIBAE">How Factors Affect Performance</a></p>
</li>
<li>
<p><a href="#CIHHEHFI">Related Reports and Data Dictionary Views</a></p>
</li>
</ul>
<a id="BABICFFD"></a>
<div id="DVADM70224" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">What Are Factors?</h2>
<p><a id="sthref283"></a>A <span class="bold">factor</span> is a named variable or attribute, such as a user location, database IP address, or session user, that Oracle Database Vault can recognize. You can use factors for activities such as authorizing database accounts to connect to the database or creating filtering logic to restrict the visibility and manageability of data.</p>
<p>Oracle Database Vault provides a selection of factors that lets you set controls on such components as the <a id="sthref284"></a>domain for your site, IP addresses<a id="sthref285"></a>, <a id="sthref286"></a>databases, and so on. <a href="#BABIEIJB">"Default Factors"</a> describes the default factors in detail. You also can create custom factors, using your own PL/SQL retrieval methods.</p>
<p><a id="sthref287"></a><a id="sthref288"></a>You can use factors in combination with rules in rule sets. The <code dir="ltr">DVF</code> factor functions described in <a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a> are factor-specific functions that you can use in rule expressions.</p>
<p><a id="sthref289"></a>Factors have values (identities) and are further categorized by their factor types. <a href="#BABHHGBC">"Factor Identification"</a> explains more about factor identities. See "Factor Type" under <a href="#BABBCIBC">"General"</a> for information about factor types.</p>
<p>You also can integrate factors with Oracle Label Security labels. <a href="dv_ols.htm#CHDHJIFJ">"Integrating Oracle Database Vault with Oracle Label Security"</a> explains how. See <a href="dv_ols.htm#BEIHAJCG">"Tutorial: Integrating Oracle Database Vault with Oracle Label Security"</a> for more information.</p>
<p>You can run reports on the factors that you create in Oracle Database Vault. See <a href="#CIHHEHFI">"Related Reports and Data Dictionary Views"</a> for more information.</p>
<p>This chapter explains how to configure factors by using Oracle Database Vault Administrator. To configure factors by using the PL/SQL packages and interfaces provided by Oracle Database Vault, refer to the following chapters:</p>
<ul>
<li>
<p><a href="apis_dbms_macadm.htm#CHDHHDGI">Chapter 12, "Using the DBMS_MACADM Package"</a></p>
</li>
<li>
<p><a href="plsql_interfaces.htm#CHDEAEHD">Chapter 15, "Using the Oracle Database Vault PL/SQL&nbsp;Interfaces"</a></p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABIEIJB"></a>
<div id="DVADM70225" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Default Factors</h2>
<p><a id="sthref290"></a>Oracle Database Vault provides a set of<a id="sthref291"></a> default factors. For each of these factors, there is an associated function that retrieves the value of the factor. See <a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a> for a listing of these functions.</p>
<p>You can create custom factors by using your own PL/SQL retrieval methods. A useful PL/SQL function you can use (which is used for many of the default factors) is the <code dir="ltr">SYS_CONTEXT</code> SQL function, which retrieves data about the user session. After you create the custom factor, you can query its values similar to the functions used to query the default factors. <a href="#BABIJFHF">"Tutorial: Preventing Ad Hoc Tool Access to the Database"</a> shows an example of how to create and query a custom factor.</p>
<p>See <a class="olink SQLRF06117" href="../../server.112/e41084/functions184.htm#SQLRF06117"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code dir="ltr">SYS_CONTEXT</code> function.</p>
<p>You can use the default factors in your own security configurations. If you do not need them, you can remove them. (That is, they are not needed for internal use by Oracle Database Vault.)</p>
<p>The default factors are as follows:</p>
<ul>
<li>
<p><span class="bold">Authentication_Method:</span> <a id="sthref292"></a>Is the method of authentication. In the list that follows, the type of user is followed by the method returned:</p>
<ul>
<li>
<p>Password-authenticated enterprise user, local database user, or <code dir="ltr">SYSDBA</code>/<code dir="ltr">SYSOPER</code> using Password File; proxy with user name using password: <code dir="ltr">PASSWORD</code></p>
</li>
<li>
<p>Kerberos-authenticated enterprise or external user: <code dir="ltr">KERBEROS</code></p>
</li>
<li>
<p>SSL-authenticated enterprise or external user: <code dir="ltr">SSL</code></p>
</li>
<li>
<p>Radius-authenticated external user: <code dir="ltr">RADIUS</code></p>
</li>
<li>
<p>Operating system-authenticated external user or <code dir="ltr">SYSDBA</code>/<code dir="ltr">SYSOPER</code>: <code dir="ltr">OS</code></p>
</li>
<li>
<p>DCE-authenticated external user: <code dir="ltr">DCE</code></p>
</li>
<li>
<p>Proxy with certificate, distinguished name (DN), or user name without using password: <code dir="ltr">NONE</code></p>
</li>
</ul>
<p>You can use <code dir="ltr">IDENTIFICATION_TYPE</code> to distinguish between external and enterprise users when the authentication method is Password, Kerberos, or SSL.</p>
</li>
<li>
<p><span class="bold">Client_IP:</span> <a id="sthref293"></a>Is the IP address of the machine from which the client is connected.</p>
</li>
<li>
<p><span class="bold">Database_Domain:</span> <a id="sthref294"></a>Is the domain of the database as specified in the <code dir="ltr">DB_DOMAIN</code> initialization parameter.</p>
</li>
<li>
<p><span class="bold">Database_Hostname:</span> <a id="sthref295"></a>Is the host name of the computer on which the instance is running.</p>
</li>
<li>
<p><span class="bold">Database_Instance:</span> <a id="sthref296"></a>Is the instance identification number of the current instance.</p>
</li>
<li>
<p><span class="bold">Database_IP:</span> <a id="sthref297"></a>Is the IP address of the computer on which the instance is running.</p>
</li>
<li>
<p><span class="bold">Database_Name:</span> <a id="sthref298"></a>Is the name of the database as specified in the <code dir="ltr">DB_NAME</code> initialization parameter.</p>
</li>
<li>
<p><span class="bold">Domain:</span> <a id="sthref299"></a>Is a named collection of physical, configuration, or implementation-specific factors in the run-time environment (for example, a networked IT environment or subset of it) that operates at a specific sensitivity level. You can identify a domain using factors such as host name, IP address, and database instance names of the Database Vault nodes in a secure access path to the database. Each domain can be uniquely determined using a combination of the factor identifiers that identify the domain. You can use these identifying factors and possibly additional factors to define the Maximum Security Label within the domain. This restricts data access and commands, depending on the physical factors about the Database Vault session. Example domains of interest may be Corporate Sensitive, Internal Public, Partners, and Customers.</p>
</li>
<li>
<p><span class="bold">Enterprise_Identity:</span> <a id="sthref300"></a>Is the enterprise-wide identity for the user:</p>
<ul>
<li>
<p>For enterprise users: the Oracle Internet Directory-distinguished name (DN).</p>
</li>
<li>
<p>For external users: the external identity (Kerberos principal name, Radius and DCE schema names, operating system user name, certificate DN).</p>
</li>
<li>
<p>For local users and <code dir="ltr">SYSDBA</code> and <code dir="ltr">SYSOPER</code> logins: NULL.</p>
</li>
</ul>
<p>The value of the attribute differs by proxy method:</p>
<ul>
<li>
<p>For a proxy with DN: the Oracle Internet Directory DN of the client.</p>
</li>
<li>
<p>For a proxy with certificate: the certificate DN of the client for external users; the Oracle Internet Directory DN for global users.</p>
</li>
<li>
<p>For a proxy with user names: the Oracle Internet Directory DN if the client is an enterprise user; NULL if the client is a local database user.</p>
</li>
</ul>
</li>
<li>
<p><span class="bold">Identification_Type:</span> <a id="sthref301"></a>Is the way the user schema was created in the database. Specifically, it reflects the <code dir="ltr">IDENTIFIED</code> clause in the <code dir="ltr">CREATE</code>/<code dir="ltr">ALTER USER</code> syntax. In the list that follows, the syntax used during schema creation is followed by the identification type returned:</p>
<ul>
<li>
<p><code dir="ltr">IDENTIFIED BY</code> <code dir="ltr"><span class="codeinlineitalic">password</span></code>: <code dir="ltr">LOCAL</code></p>
</li>
<li>
<p><code dir="ltr">IDENTIFIED EXTERNALLY</code>: <code dir="ltr">EXTERNAL</code></p>
</li>
<li>
<p><code dir="ltr">IDENTIFIED GLOBALLY</code>: <code dir="ltr">GLOBAL SHARED</code></p>
</li>
<li>
<p><code dir="ltr">IDENTIFIED GLOBALLY</code> <code dir="ltr">AS DN</code>: <code dir="ltr">GLOBAL PRIVATE</code></p>
</li>
</ul>
</li>
<li>
<p><span class="bold">Lang:</span> <a id="sthref302"></a><a id="sthref303"></a>Is the ISO abbreviation for the language name, a shorter form than the existing <code dir="ltr">LANGUAGE</code> parameter.</p>
</li>
<li>
<p><span class="bold">Language:</span> Is the language and territory your session currently uses, along with the database character set, in the following form:</p>
<pre dir="ltr">
<span class="italic">language_territory</span>.<span class="italic">characterset</span>
</pre>
<p>For example:</p>
<pre dir="ltr">
AMERICAN_AMERICA.WE8MSWIN1252
</pre>
<p>Refer to <a class="olink NLSPG" href="../e10729/toc.htm"><span class="italic">Oracle Database Globalization Support Guide</span></a> for more information about languages, territories, and character sets.</p>
</li>
<li>
<p><span class="bold">Machine:</span> <a id="sthref304"></a>Is the host name for the database client that established the current session. If you must find out whether the computer was used for a client or server session, then you can compare this setting with the Database_Hostname factor to make the determination.</p>
</li>
<li>
<p><span class="bold">Network_Protocol:</span> <a id="sthref305"></a>Is the network protocol being used for communication, as specified in the <code dir="ltr">PROTOCOL=protocol</code> portion of the connect string.</p>
</li>
<li>
<p><span class="bold">Proxy_Enterprise_Identity:</span> <a id="sthref306"></a>Is the Oracle Internet Directory DN when the proxy user is an enterprise user.</p>
</li>
<li>
<p><span class="bold">Proxy_User:</span> <a id="sthref307"></a>Is the name of the database user who opened the current session on behalf of <code dir="ltr">SESSION_USER</code>.</p>
</li>
<li>
<p><span class="bold">Session_User:</span> <a id="sthref308"></a>Is the database user name by which the current user is authenticated. This value remains the same throughout the session.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABFBAAF"></a>
<div id="DVADM70226" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating a Factor</h2>
<p>In general, <a id="sthref309"></a>to create a factor, you first create the factor itself, and then you edit the factor to include its identity. <a href="#BABBIDEH">"Guidelines for Designing Factors"</a> provides advice on designing factors.</p>
<p>To create a factor:</p>
<ol>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>In the Administration page, under Database Vault Feature Administration, click <span class="bold">Factors</span>.</p>
</li>
<li>
<p>In the Factors page, click <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Factor page, enter the following settings, and then click <span class="bold">OK</span>:</p>
<ul>
<li>
<p><a href="#BABBCIBC">General</a></p>
</li>
<li>
<p><a href="#BABHHGBC">Factor Identification</a></p>
</li>
<li>
<p><a href="#BABIEIBD">Evaluation</a></p>
</li>
<li>
<p><a href="#CIHHFBGG">Factor Labeling</a></p>
</li>
<li>
<p><a href="#BABGIIAB">Retrieval Method</a></p>
</li>
<li>
<p><a href="#BABJJEFA">Validation Method</a></p>
</li>
<li>
<p><a href="#BABGAJIG">Assignment Rule Set</a></p>
</li>
<li>
<p><a href="#BABEDJHB">Audit Options</a></p>
</li>
<li>
<p><a href="#BABEBHID">Error Options</a></p>
</li>
</ul>
</li>
</ol>
<p class="subhead2"><a id="BABBCIBC"></a><a id="DVADM70227"></a>General</p>
<p>In the General area, enter the following information:</p>
<ul>
<li>
<p><span class="bold">Name:</span> <a id="sthref310"></a>Enter <a id="sthref311"></a><a id="sthref312"></a>a name up to 28 characters in mixed-case, without spaces. Oracle Database Vault creates a valid Oracle identifier for the factor function to be created in the <code dir="ltr">DVF</code> schema based on the name of the factor chosen. For example, if you create a factor named <code dir="ltr">GetNetworkIP</code>, Oracle Database Vault creates the <code dir="ltr">DVF.F$GETNETWORKIP</code> function. This attribute is mandatory.</p>
<p>Oracle suggests that you start the name with a noun and complete the name with a brief description of the derived value.</p>
<p><a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a> describes the <code dir="ltr">DVF</code> factor functions.</p>
</li>
<li>
<p><span class="bold">Description:</span> Enter a text description of the factor. It can have up to 1024 characters in mixed-case. This attribute is optional.</p>
</li>
<li>
<p><span class="bold">Factor Type:</span> <a id="sthref313"></a>From the list, select the type or category of the factor. This attribute is mandatory.</p>
<p>Factor types have a name and description and are used only to help classify factors. A <a id="sthref314"></a><a id="sthref315"></a>factor type is the category name used to classify the factor. The default physical factor types include authentication method, host name, host IP address, instance identifiers, database account information, and others. You can create user-defined factor types, such as application name, certificate information, and so on in addition to the installed factor types, such as time and authentication method.</p>
<p>You can find the factors that are associated with a particular factor type by querying the <code dir="ltr">DVSYS.DBA_DV_FACTOR</code> data dictionary view. For example:</p>
<pre dir="ltr">
SELECT NAME 
FROM DVSYS.DBA_DV_FACTOR 
WHERE FACTOR_TYPE_NAME='Authentication Method';
</pre>
<p>The output is:</p>
<pre dir="ltr">
NAME
------------------------------
Network_Protocol
Authentication_Method
Identification_Type
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
To create user-defined factor types by using the Oracle Database Vault <code dir="ltr">DBMS_MACADM</code> package, use the <code dir="ltr">CREATE_FACTOR_TYPE</code> procedure, described in <a href="apis_dbms_macadm.htm#BCFJIFEG">"CREATE_FACTOR_TYPE Procedure"</a>.</div>
</li>
</ul>
<p class="subhead2"><a id="BABHHGBC"></a><a id="DVADM70228"></a>Factor Identification</p>
<p><a id="sthref316"></a>Under Factor Identification, select how to resolve the identity of a factor. This attribute is mandatory. The values are as follows:</p>
<ul>
<li>
<p><span class="bold">By Method:</span> Default. Sets the factor identity by executing the PL/SQL expression specified in the <span class="bold">Retrieval Method</span> field.</p>
<p>For example, suppose the expression retrieves the system date:</p>
<pre dir="ltr">
to_char(sysdate,'yyyy-mm-dd')
</pre>
<p>On December 6, 2009, the <span class="bold">By Method</span> option would return the following value:</p>
<pre dir="ltr">
2009-12-06
</pre></li>
<li>
<p><span class="bold">By Constant:</span> Resolves the factor identity by retrieving the constant value found in the <span class="bold">Retrieval Method</span> field.</p>
</li>
<li>
<p><span class="bold">By Factors:</span> <a id="sthref317"></a>Determines the factor identity by mapping the identities of the child factor to its parent factor. A <a id="sthref318"></a><a id="sthref319"></a>parent factor is a factor whose values are resolved based on a second factor, called a child factor. To establish their relationship, you map their identities. (You do not need to specify a <span class="bold">Retrieval Method</span> expression for this option.)</p>
<p>See <a href="#BABCHFGI">"Using Identity Mapping to Configure an Identity to Use Other Factors"</a> for more information about mapping identities.</p>
</li>
</ul>
<p>A<a id="sthref320"></a> <span class="bold">factor identity</span> is the actual value of a factor (for example, the IP address for a factor that uses the IP_Address type). A factor can have several identities depending on its retrieval method or its identity mapping logic. For example, a factor such as Database_Hostname could have multiple identities in an <a id="sthref321"></a>Oracle Real Application Clusters environment; a factor such as Client_IP can have multiple identities in any RDBMS environment. The retrieval method for these types of factors may return different values because the retrieval method is based on the database session.</p>
<p>Several reports allow you to track the factor identity configuration. See <a href="#CIHHEHFI">"Related Reports and Data Dictionary Views"</a> for more information.</p>
<p><a id="sthref322"></a>You <a id="sthref323"></a>can configure the assignment of a factor in the following ways:</p>
<ul>
<li>
<p>Assign the factor at the time a database session is established.</p>
</li>
<li>
<p>Configure individual requests to retrieve the identity of the factor.</p>
</li>
</ul>
<p>With the Oracle Label Security integration, <a id="sthref324"></a>you can label identities with an Oracle Label Security label. You can also assign an identity <a id="sthref325"></a><a id="sthref326"></a><span class="italic">trust levels</span>, which are numbers that indicate the magnitude of trust relative to other identities for the same factor. In general, the higher the trust level number is set, the greater the trust. Negative trust levels are not trusted.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#BABFJCHH">"Adding an Identity to a Factor"</a> for more information about factor identities</div>
<p><a id="sthref327"></a><a id="sthref328"></a>Within a database session, a factor assigned identity is available to Oracle Database Vault and any application with a publicly accessible PL/SQL function that exists in the <code dir="ltr">DVF</code> schema (which contains functions that retrieve factor values) as follows:</p>
<p><code dir="ltr">dvf.f$</code><code dir="ltr"><span class="codeinlineitalic">factor_name</span></code></p>
<p>This allows the identifier for a factor to be accessed globally from within the Oracle database (using PL/SQL, SQL, Oracle Virtual Private Database, triggers, and so on). For example, in SQL*Plus:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>    

SELECT DVF.F$DATABASE_IP FROM DUAL;
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">
SELECT DVF.F$DATABASE_IP FROM DUAL;

F$DATABASE_IP
-------------------------------------------------------------
192.0.2.1
</pre>
<p>You can also use the <code dir="ltr"><a id="sthref329"></a>DVSYS.GET_FACTOR</code> function to find the identity of a factor that is made available for public access. For example:</p>
<pre dir="ltr">
SELECT GET_FACTOR('DATABASE_IP') FROM DUAL;
</pre>
<p>The following output appears:</p>
<pre dir="ltr">
GET_FACTOR('DATABASE_IP')
-------------------------------------------------------------
192.0.2.1
</pre>
<p class="subhead2"><a id="BABIEIBD"></a><a id="DVADM70229"></a>Evaluation</p>
<p><a id="sthref330"></a>Under Evaluation, select how you want the <a id="sthref331"></a>factor to be evaluated and assigned an identity. See <a href="#BABJIBAE">"How Factors Affect Performance"</a> for the performance effect of session factors. This attribute is mandatory.</p>
<p>The values are as follows:</p>
<ul>
<li>
<p><span class="bold">By Session:</span> Default. Evaluates the factor when a database session is created.</p>
</li>
<li>
<p><span class="bold">By Access:</span> Evaluates the factor each time it is accessed (for example, referenced by an application) and when the database session is first created.</p>
</li>
</ul>
<p class="subhead2"><a id="CIHHFBGG"></a><a id="DVADM70230"></a>Factor Labeling</p>
<p>Under Factor Labeling, select how you want the <a id="sthref332"></a><a id="sthref333"></a>factor identity to retrieve an Oracle Label Security (OLS) label. This setting applies if you plan to use the Oracle Label Security integration. This attribute is mandatory if you want to use an OLS label. (See also <a href="dv_ols.htm#CHDHJIFJ">"Integrating Oracle Database Vault with Oracle Label Security"</a> for information on integrating OLS labels with a factors.</p>
<p>The values are as follows:</p>
<ul>
<li>
<p><span class="bold">By Self:</span> Default. Labels the identities for the factor directly from the labels associated with an Oracle Label Security policy.</p>
</li>
<li>
<p><span class="bold">By Factors:</span> If there are multiple child factor labels, then Oracle Database Vault merges the labels by using the Oracle Label Security algorithm that is associated with the applicable Oracle Label Security policy. For each applicable Oracle Label Security policy, a factor identity can have an assigned label.</p>
</li>
</ul>
<p class="subhead2"><a id="BABGIIAB"></a><a id="DVADM70231"></a>Retrieval Method</p>
<p><a id="sthref334"></a>Under Retrieval Method, enter a PL/SQL expression that retrieves the identity of a factor or a constant. It can use up to 255 characters in mixed-case. The Retrieval Method identifies factors where the factor identification is by method or constant. If the factor identification is by factors, Oracle Database Vault identifies it by its identity mappings.</p>
<p>You can create your own PL/SQL retrieval methods, or use the functions supplied with Oracle Database Vault. See the following sections for factor-specific and general utility functions that you can use to build the retrieval method:</p>
<ul>
<li>
<p><a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a></p>
</li>
<li>
<p><a href="apis_dbms_macadm.htm#CHDEGBDF">"Factor Procedures and Functions Within DBMS_MACADM"</a></p>
</li>
<li>
<p><a href="apis_dbms_macutl.htm#CIHIDIDC">Chapter 14, "Using the DBMS_MACUTL Package"</a></p>
</li>
</ul>
<p>The following retrieval method sets a value of the DB_NAME factor by retrieving the database name (DB_NAME) from the <code dir="ltr">USERENV</code> namespace in a user's session.</p>
<pre dir="ltr">
UPPER(SYS_CONTEXT('USERENV','DB_NAME'))
</pre>
<p>See also the default factors provided with Oracle Database Vault for examples of retrieval methods. <a href="#BABIEIJB">"Default Factors"</a> describes these factors.</p>
<p>The <span class="bold">Retrieval Method</span> field is mandatory if you have selected the following settings under Factor Identification:</p>
<ul>
<li>
<p><span class="bold">By Method:</span> Enter a method in the Retrieval Method field.</p>
</li>
<li>
<p><span class="bold">By Constant:</span> Enter a constant in the Retrieval Method field.</p>
</li>
</ul>
<p>The value returned as the factor identity must be a <code dir="ltr">VARCHAR2</code> string or otherwise convertible to one.</p>
<p>You can include any package function or standalone function in the expression. Ensure that the expression is a fully qualified function, such as <code dir="ltr"><span class="codeinlineitalic">schema</span></code>.<code dir="ltr"><span class="codeinlineitalic">function_name</span></code>. Do not include complete SQL statements. If you are using application packages or functions, you must provide <code dir="ltr">DVSYS</code> with the <code dir="ltr">GRANT EXECUTE</code> privilege on the object.</p>
<p>Write the function signature using the following format:</p>
<pre dir="ltr">
FUNCTION GET_FACTOR RETURN VARCHAR2
</pre>
<p class="subhead2"><a id="BABJJEFA"></a><a id="DVADM70232"></a>Validation Method</p>
<p><a id="sthref335"></a>Under Validation Method, enter a PL/SQL expression that returns a Boolean value (<code dir="ltr">TRUE</code> or <code dir="ltr">FALSE</code>) to validate <a id="sthref336"></a><a id="sthref337"></a>the identity of a factor being retrieved (with the <code dir="ltr">DVSYS.GET_FACTOR</code> function) or the value to be assigned to a factor (with the <code dir="ltr">DVSYS.SET_FACTOR</code> function). If the method is evaluated to false for the value being retrieved or to be assigned, then the factor identity is set to null. This optional feature provides an additional level of assurance that the factor is properly retrieved and set. This field can have up to 255 characters in mixed-case.</p>
<p>You can include any package function or standalone function in the expression. Ensure that the expression is a fully qualified function, such as <code dir="ltr"><span class="codeinlineitalic">schema</span></code>.<code dir="ltr"><span class="codeinlineitalic">function_name</span></code>. Do not include complete SQL statements. If you are using application packages or functions, you must provide <code dir="ltr"><a id="sthref338"></a>DVSYS</code> with the <code dir="ltr">GRANT EXECUTE</code> privilege on the object.</p>
<p>Write the function using one of the following formats:</p>
<ul>
<li>
<p><code dir="ltr">FUNCTION</code> <code dir="ltr">IS_VALID</code> <code dir="ltr">RETURN BOOLEAN</code></p>
<p>In this form, you can use the <code dir="ltr">DVF.F$</code><code dir="ltr"><span class="codeinlineitalic">factor_name</span></code> function inside the function logic. This is more appropriate for factors that are evaluated by session.</p>
</li>
<li>
<p><code dir="ltr">FUNCTION</code> <code dir="ltr">IS_VALID</code><code dir="ltr">(</code><code dir="ltr"><span class="codeinlineitalic">p_factor_value</span></code> <code dir="ltr">VARCHAR2</code><code dir="ltr">)</code> <code dir="ltr">RETURN BOOLEAN</code></p>
<p>In this form, the factor value is passed to the validation function directly. This is more appropriate for factors that are evaluated by access. It is also valid for factors evaluated by session.</p>
</li>
</ul>
<p>See the following sections for factor-specific and general utility functions that you can use to build the validation method:</p>
<ul>
<li>
<p><a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a></p>
</li>
<li>
<p><a href="apis_dbms_macadm.htm#CHDEGBDF">"Factor Procedures and Functions Within DBMS_MACADM"</a></p>
</li>
<li>
<p><a href="apis_dbms_macutl.htm#CIHIDIDC">Chapter 14, "Using the DBMS_MACUTL Package"</a></p>
</li>
</ul>
<p class="subhead2"><a id="BABGAJIG"></a><a id="DVADM70233"></a>Assignment Rule Set</p>
<p><a id="sthref339"></a><a id="sthref340"></a>Under Assignment Rule Set, select a rule set from the list if you want to use a rule set to control when and how a factor identity is set. For example, you can use a rule set to determine when a database session originates from a known application server or program. <a href="cfrulset.htm#BABIFBBC">Chapter 5, "Configuring Rule Sets,"</a> explains how to create rule sets.</p>
<p>This attribute is particularly useful for situations where database applications, such as a Web application using a JDBC connection pool, must dynamically set a factor identity for the current database session. For example, a Web application may want to assign the geographic location for a database account logging in to the Web application. To do so, the Web application can use the JDBC Callable Statement, or Oracle Data Provider for .NET (ODP.NET) to execute the PL/SQL function <code dir="ltr">DVSYS.SET_FACTOR</code>, for example:</p>
<pre dir="ltr">
BEGIN 
 DVSYS.SET_FACTOR('GEO_STATE','VIRGINIA');
END;
</pre>
<p>Then you can create an assignment rule for the GEO_STATE factor to allow or disallow the setting of the GEO_STATE factor based on other factors or rule expressions. See <a href="#BABIFICC">"How Factors Are Set"</a> for more information.</p>
<p class="subhead2"><a id="BABEDJHB"></a><a id="DVADM70234"></a>Audit Options</p>
<p><a id="sthref341"></a><a id="sthref342"></a>Under Audit Options, select from the settings to generate an audit trail. Oracle Database Vault writes the audit trail to the <code dir="ltr">DVSYS.AUDIT_TRAIL$</code> system file, described in <a href="audplcy.htm#BGBFCEGE">Appendix A, "Auditing Oracle Database Vault."</a></p>
<p>You can use the Factor Audit Report to display the generated audit records. (See <a href="#CIHHEHFI">"Related Reports and Data Dictionary Views"</a> for more information.) In addition, you can select multiple audit options at a time. Each option is converted to a bit mask and added to determine the aggregate behavior. Note that there is little performance impact in auditing, unless the factor has errors. This attribute is mandatory. The values are as follows:</p>
<ul>
<li>
<p><span class="bold">Never:</span> Does not audit.</p>
</li>
<li>
<p><span class="bold">Always:</span> Always creates an audit record when a factor is evaluated. You can select from the conditions, described next.</p>
</li>
<li>
<p><span class="bold">Sometimes:</span> Creates an audit record based on one or more conditions. When you select <span class="bold">Sometimes</span>, by default the <span class="bold">Retrieval Error</span> and <span class="bold">Retrieval NULL</span> options are selected.</p>
<p>You can select from the following conditions listed next.</p>
</li>
</ul>
<p>Conditions that you can select for the <span class="bold">Always</span> and <span class="bold">Sometimes</span> options are as follows:</p>
<ul>
<li>
<p><span class="bold">Retrieval Error:</span> Creates an audit record when the identity of a factor cannot be resolved and assigned, due to an error (such as <code dir="ltr">No data found</code> or <code dir="ltr">Too many rows</code>).</p>
</li>
<li>
<p><span class="bold">Retrieval NULL:</span> Creates an audit record when the identity of a factor is resolved to <code dir="ltr">NULL</code>.</p>
</li>
<li>
<p><span class="bold">Validation Error:</span> Creates an audit record when the validation method (if provided) returns an error.</p>
</li>
<li>
<p><span class="bold">Validation False:</span> Creates an audit record when the validation method (if provided) returns <code dir="ltr">FALSE</code>.</p>
</li>
<li>
<p><span class="bold">Trust Level NULL:</span> Creates an audit record when the resolved identity of a factor has an assigned trust level of <code dir="ltr">NULL</code>.</p>
<p>See <a href="#BABDJFJB">"Creating and Configuring a Factor Identity"</a> for more information about trust levels.</p>
</li>
<li>
<p><span class="bold">Trust Level Less Than Zero:</span> Creates an audit record when the resolved identity of a factor has an assigned trust level less than zero.</p>
</li>
</ul>
<p class="subhead2"><a id="BABEBHID"></a><a id="DVADM70235"></a>Error Options</p>
<p><a id="sthref343"></a><a id="sthref344"></a>Under Error Options, select from the following to specify the processing that occurs when a factory identity cannot be resolved. This attribute is mandatory.</p>
<p>The values are as follows:</p>
<ul>
<li>
<p><span class="bold">Show Error Message:</span> Default. Displays an error message to the database session.</p>
</li>
<li>
<p><span class="bold">Do Not Show Error Message:</span> Does not display the error message.</p>
<p><a id="sthref345"></a><a id="sthref346"></a>An advantage of selecting <span class="bold">Do Not Show Error Message</span> and then enabling auditing is that you can track the activities of a potential intruder. The audit report reveals the activities of the intruder, yet the intruder is unaware that you are doing this because he or she does not see any error messages.</p>
</li>
</ul>
<p>After you have created a new factor, you are ready to configure its identity. To do so, edit the factor and then add its identity.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABDBEEI">"Editing a Factor"</a></p>
</li>
<li>
<p><a href="#BABFJCHH">"Adding an Identity to a Factor"</a></p>
</li>
<li>
<p><a href="dba.htm#CHDEEEFH">"Propagating Oracle Database Vault Policies to Other Databases"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABDBEEI"></a>
<div id="DVADM70236" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Editing a Factor</h2>
<p><a id="sthref347"></a>To edit a factor:</p>
<ol>
<li>
<p>In the Oracle Database Vault Administration page, select <span class="bold">Factors</span>.</p>
</li>
<li>
<p>In the Factors page, select the factor that you want to edit.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
</li>
<li>
<p>Modify the factor as necessary, and then click <span class="bold">OK</span>.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFBAAF">"Creating a Factor"</a> to modify the settings created for a new factor</p>
</li>
<li>
<p><a href="#BABFJCHH">"Adding an Identity to a Factor"</a> to add or modify an identity for the factor</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BABFJCHH"></a>
<div id="DVADM70237" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Adding an Identity to a Factor</h2>
<p><a id="sthref348"></a>After you create a new factor, you optionally can add an identity to it. An identity is the actual value of the factor. For example, the identity of an IP_Address factor could be the IP address of 192.0.2.4.</p>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CIHCABIA">About Factor Identities</a></p>
</li>
<li>
<p><a href="#BABDJFJB">Creating and Configuring a Factor Identity</a></p>
</li>
<li>
<p><a href="#BABCHFGI">Using Identity Mapping to Configure an Identity to Use Other Factors</a></p>
</li>
</ul>
<a id="CIHCABIA"></a>
<div id="DVADM70238" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Factor Identities</h3>
<p><a id="sthref349"></a>A factor identity for a given database session is assigned at run time using the <span class="bold">Factor Identification</span> and <span class="bold">Retrieval Method</span> fields described in <a href="#BABFBAAF">"Creating a Factor"</a>. You can further configure the identity for the following reasons:</p>
<ul>
<li>
<p>To define the known identities for a factor</p>
</li>
<li>
<p>To add a trust level to a factor identity</p>
</li>
<li>
<p>To add an Oracle Label Security label to a factor identity</p>
</li>
<li>
<p>To resolve a factor identity through its child factors, by using Identity Mapping</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFIEDE">"How Factors Work"</a> for more information about how a factor behaves during a database session</p>
</li>
<li>
<p><a href="#CIHCFJBG">"Tutorial: Restricting User Activities Based on Session Data"</a> for an example of how to create and use factor identities</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="BABDJFJB"></a>
<div id="DVADM70239" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating and Configuring a Factor Identity</h3>
<p><a id="sthref350"></a><a id="sthref351"></a>To create and configure an identity:</p>
<ol>
<li>
<p>In the Oracle Database Vault Administration page, select <span class="bold">Factors</span>.</p>
</li>
<li>
<p>In the Factors page, select the factor to which you want to add the identity.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
</li>
<li>
<p>In the Edit Factor page, scroll down to Identities and click <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Identity page, enter the following settings and then click <span class="bold">OK</span>:</p>
<ul>
<li>
<p><a href="#BABEGCJB">General</a></p>
</li>
<li>
<p><a href="#BABEDJHF">Label Identity</a></p>
</li>
</ul>
</li>
</ol>
<p class="subhead2"><a id="BABEGCJB"></a><a id="DVADM70240"></a>General</p>
<p>Enter the following values:</p>
<ul>
<li>
<p><span class="bold">Value:</span> Enter the value of the identity, up to 1024 characters in mixed-case. This attribute is mandatory.</p>
</li>
<li>
<p><span class="bold">Trust Level:</span> <a id="sthref352"></a><a id="sthref353"></a>Select one of the following trust levels:</p>
<ul>
<li>
<p><span class="bold">Very Trusted:</span> Assigns a trust level value of 10</p>
</li>
<li>
<p><span class="bold">Trusted:</span> Assigns a trust level value of 5</p>
</li>
<li>
<p><span class="bold">Somewhat Trusted:</span> Assigns a trust level value of 1</p>
</li>
<li>
<p><span class="bold">Untrusted:</span> Assigns a trust level value of -1</p>
</li>
<li>
<p><span class="bold">Trust Level Not Defined:</span> Assigns a trust level value of <code dir="ltr">NULL</code> (default)</p>
</li>
</ul>
</li>
</ul>
<p><a id="sthref354"></a>Trust levels enable you to assign a numeric value to indicate the measure of trust allowed. A trust value of 1 signifies some trust. A higher value indicates a higher level of trust. A negative value or zero indicates distrust. When the factor identity returned from a factor retrieval method is not defined in the identity, Oracle Database Vault automatically assigns the identity a negative trust level.</p>
<p>To determine the <a id="sthref355"></a>trust level of a factor identity at run time, you can use the <code dir="ltr">GET_TRUST_LEVEL</code> and <code dir="ltr">GET_TRUST_LEVEL_FOR_IDENTITY</code> functions in the <code dir="ltr">DVSYS</code> schema.</p>
<p>For example, suppose you have created a factor named Network. You can create the following identities for the Network factor:</p>
<ul>
<li>
<p>Intranet, with a trust level of 10</p>
</li>
<li>
<p>VPN (virtual private network), with a trust level of 5</p>
</li>
<li>
<p>Public, with a trust level of 1</p>
</li>
</ul>
<p>You then can create rule expressions (or custom application code) that base policy decisions on the trust level. For example, you can use <code dir="ltr">DVSYS.GET_TRUST_LEVEL</code> to find trust levels greater than 5:</p>
<pre dir="ltr">
DVSYS.GET_TRUST_LEVEL('Network') &gt; 5
</pre>
<p>Or, you can use a <code dir="ltr">SELECT</code> statement on the <code dir="ltr">DVSYS.DBA_DV_IDENTITY</code> data dictionary view to find trust levels for the Network factor greater than or equal to 5:</p>
<pre dir="ltr">
SELECT VALUE, TRUST_LEVEL FROM DVSYS.DBA_DV_IDENTITY 
   WHERE TRUST_LEVEL &gt;= 5 
   AND FACTOR_NAME='Network'
</pre>
<p>Output similar to the following appears:</p>
<pre dir="ltr">
F$NETWORK GET_TRUST_LEVEL('NETWORK')
------------------------------------
VPN                                5
INTRANET                          10
</pre>
<p>In the preceding example, Network factor identity for VPN is trusted (value equals 5), and the identity for the INTRANET domain is 10, which implies a greater trust.</p>
<p>See <a href="plsql_interfaces.htm#CHDEAEHD">Chapter 15, "Using the Oracle Database Vault PL/SQL&nbsp;Interfaces,"</a> for more information about the Oracle Database Vault functions.</p>
<p class="subhead2"><a id="BABEDJHF"></a><a id="DVADM70241"></a>Label Identity</p>
<p><a id="sthref356"></a><a id="sthref357"></a>You can assign Oracle Label Security (OLS) labels to factor identities. (In brief, a label acts as an identifier for a database table row to assign privileges to the row. For more information about labels, see <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a>.) The <span class="bold">Factor Labeling</span> attribute for a factor determines whether a factor is labeled <span class="bold">By Self</span> or <span class="bold">By Factors</span>. If you set the <span class="bold">Factor Labeling</span> attribute to <span class="bold">By Self</span>, then you can associate OLS labels with the factor identities. If you set the <span class="bold">Factor Labeling</span> attribute to <span class="bold">By Factors</span>, then Oracle Database Vault derives the factor identity labels from the labeling of child factor identities. When there are multiple child factor identities with labels, Oracle Database Vault merges the labels using the OLS algorithm associated with the applicable factor Oracle Label Security policy.</p>
<p><a id="sthref358"></a>To label an identity:</p>
<ol>
<li id="CIHFGHCB">
<p>In the Create Identity page, under Label Identity, select the OLS label from the <span class="bold">Available OLS Labels</span> list.</p>
<p>The list shows data labels from the Oracle Label Security installation for your site. For more information, refer to <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can select multiple labels by holding down the Ctrl key as you click each label that is to be selected.</div>
</li>
<li id="CIHHFBJG">
<p>Click <span class="bold">Move</span> to move the OLS label to the <span class="bold">Selected OLS Labels</span> list.</p>
</li>
<li>
<p>Repeat Step <a href="#CIHFGHCB">1</a> and Step <a href="#CIHHFBJG">2</a> to select more OLS labels.</p>
<p>You can select only one label for each OLS policy.</p>
</li>
<li>
<p>Click <span class="bold">OK</span> to finish labeling the identity.</p>
</li>
</ol>
<p class="subhead2"><a id="DVADM70242"></a>Editing a Factor Identity</p>
<p><a id="sthref359"></a>To edit a factor identity:</p>
<ol>
<li>
<p>In the Edit Factor page, scroll down to Identities and select the identity you want to edit.</p>
</li>
<li>
<p>Click <span class="bold">Edit</span>.</p>
</li>
<li>
<p>In the Edit Identity page, modify the identity as necessary.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
<p class="subhead2"><a id="DVADM70243"></a>Deleting a Factor Identity</p>
<p>Before you delete a factor identity, you can locate the various references to it by querying the factor-related Oracle Database Vault views. See <a href="views.htm#BABIFDGE">Chapter 16, "Oracle Database Vault Data Dictionary Views,"</a> for more information.</p>
<p><a id="sthref360"></a>To delete a factor identity:</p>
<ol>
<li>
<p>In the Edit Factor page, scroll down to Identities and select the identity you want to remove.</p>
</li>
<li>
<p>Click <span class="bold">Remove</span>.</p>
</li>
<li>
<p>In the Confirmation page, click <span class="bold">Yes</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABCHFGI"></a>
<div id="DVADM70244" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Identity Mapping to Configure an Identity to Use Other Factors</h3>
<p>After you create, edit, and save the factor identity, you can map it. Identity mapping<a id="sthref361"></a> is <a id="sthref362"></a>the process of identifying a <a id="sthref363"></a>factor by using other <a id="sthref364"></a>(child) factors. This is a way to transform combinations of factors into logical identities for a factor or to transform continuous identity values (for example, temperature) or large discrete identity values (for example, IP address ranges) into logical sets. To check configuration issues in the mapping for an identity, see <a href="reports.htm#BABHJACH">"Identity Configuration Issues Report"</a>. See also <a href="#CIHCFJBG">"Tutorial: Restricting User Activities Based on Session Data"</a> for an example of how to use identity mapping.</p>
<p><a id="sthref365"></a><a id="sthref366"></a>To map an identity to a factor:</p>
<ol>
<li>
<p>Create a parent factor and set the attribute <span class="bold">Factor Identification</span> to <span class="bold">By Factors</span>.</p>
<p><a href="#BABFBAAF">"Creating a Factor"</a> describes how to create factors.</p>
</li>
<li>
<p>For the parent factor, create a new factor identity.</p>
<p><a href="#BABDJFJB">"Creating and Configuring a Factor Identity"</a> describes how to create an identity.</p>
</li>
<li>
<p>Map the <a id="sthref367"></a>factor-identity pair of the parent to the factor-identity pairs of its children. Use the following process:</p>
<ol>
<li>
<p>In the Factors page, select the parent factor from the Factors page and then click <span class="bold">Edit</span>.</p>
</li>
<li id="CIHJEAGF">
<p>In the Edit Factor page, under Identities, select the parent factor identity and then click <span class="bold">Edit</span>.</p>
</li>
<li id="CIHBADJF">
<p>In the Edit Identity page, click <span class="bold">Create</span> under Map Identity.</p>
</li>
<li id="CHDHAACD">
<p>In the Create Identity Map page, select a factor name from the <span class="bold">Contributing Factor</span> list.</p>
<p>This is the child factor to which you want to map the parent factor.</p>
</li>
<li>
<p>Select a <span class="bold">Map Condition</span>.</p>
<p>This setting lets you select an operator to compare the contributing (child) factor values.</p>
</li>
<li>
<p>Enter a value for the Low Value and High Value (optional) fields.</p>
<p>For example, consider a scenario where the Contributing Factor to the Factor Network is set to Client_IP, the <span class="bold">Map Condition</span> is set to <code dir="ltr">Between</code>, the <span class="bold">Low Value</span> is set to 192.0.2.1 and the <span class="bold">High Value</span> is set to 192.0.2.24. This means that whenever the client IP address lies in the specified address range of 192.0.2.1 to 192.0.2.24, the parent factor evaluates to a predefined identity (for example, INTRANET).</p>
</li>
<li id="CHDJEIAE">
<p>Click <span class="bold">OK</span> to map the parent factor-identity to the child factor-identity.</p>
<p>You can map different identities of a parent factor to different identities of the contributing factor. For example, the INTRANET identity maps to an IP address range of 192.0.2.1 to 192.0.2.24. The REMOTE identity can map to an IP address range that excludes the address range 192.0.2.1 to 192.0.2.24.</p>
<p>Based on identity mapping, you can create a security policy. For example, you can define a reduced set of privileges for an employee connecting over VPN (with REMOTE), as opposed to an employee connecting from within the corporate network (with INTRANET).</p>
</li>
<li>
<p>Repeat Step <a href="#CIHBADJF">c</a> to Step <a href="#CHDJEIAE">g</a> to add more contributing factors for a parent factor identity.</p>
<p>For example, you can configure the Network factor to resolve to a value ACCOUNTING-SENSITIVE, when the Program factor resolves to "Oracle General Ledger" and the Client_IP is in between 192.0.2.1 and 192.0.2.24. So, if an authorized accounting financial application program, running on a client with IP address 192.0.2.12 accesses the database, then the Network factor is resolved to ACCOUNTING-SENSITIVE. A database session with the ACCOUNTING-SENSITIVE Network value would have more access privileges than one with the INTRANET Network value.</p>
</li>
</ol>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABGEBCE"></a>
<div id="DVADM70245" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Deleting a Factor</h2>
<p>Before you delete a factor, you can locate the various references to the factor and its identities by querying the factor-related Oracle Database Vault views. See <a href="views.htm#BABIFDGE">Chapter 16, "Oracle Database Vault Data Dictionary Views,"</a> for more information.</p>
<p><a id="sthref368"></a>To delete a factor:</p>
<ol>
<li>
<p>Delete any references to the factor, such as factor identities, and Oracle Label Security policy associations.</p>
<p>You cannot delete a factor that has references.</p>
</li>
<li>
<p>In the Oracle Database Vault Administration page, select <span class="bold">Factors</span>.</p>
</li>
<li>
<p>In the Factors page, select the factor that you want to remove.</p>
</li>
<li>
<p>Click <span class="bold">Remove</span>.</p>
</li>
<li>
<p>In the Confirmation page, click <span class="bold">Yes</span>.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="BABFIEDE"></a>
<div id="DVADM70246" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">How Factors Work</h2>
<p><a id="sthref369"></a><a id="sthref370"></a>The following topics in this section explain how Oracle Database Vault processes factors:</p>
<ul>
<li>
<p><a href="#BABEBEID">How Factors Are Processed When a Session Is Established</a></p>
</li>
<li>
<p><a href="#BABGHBHD">How Factors Are Retrieved</a></p>
</li>
<li>
<p><a href="#BABIFICC">How Factors Are Set</a></p>
</li>
</ul>
<a id="BABEBEID"></a>
<div id="DVADM70247" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How Factors Are Processed When a Session Is Established</h3>
<p>When a database session is established, the following actions occur:</p>
<ol>
<li>
<p>At the start of each <a id="sthref371"></a>database session, Oracle Database Vault begins to evaluate all default and user-created factors in the database instance.</p>
<p>This evaluation occurs after the normal database authentication of the session and the initialization of the Oracle Label Security session information, if applicable.</p>
</li>
<li id="BABJGGCA">
<p>In the factor evaluation stage, the factor initialization process executes the retrieval method for all factors that are identified by methods or constants, to resolve the factor identity for the session.</p>
<p>The factor error options setting has no effect on the factor initialization process.</p>
</li>
<li>
<p>If a factor has a validation method defined, Oracle Database Vault validates the identity (value) of the factor by executing this validation method. If the validation method fails or returns false, the identity of the factor is undefined (<code dir="ltr">NULL</code>).</p>
</li>
<li>
<p>If a factor has any identities defined for it, Oracle Database Vault resolves the trust level of the factor based on the identities defined. If an identity of the factor is defined in this list of defined identities, then Oracle Database Vault assigns the trust level as configured; otherwise it sets it to -1. If there are no identities defined for the factor, the trust level is undefined (<code dir="ltr">NULL</code>).</p>
</li>
<li id="CIHJFJJD">
<p>Depending on the outcome of this factor evaluation, factor validation, and trust level resolution, Database Vault audits the details of the evaluation as dictated by the factor audit configuration.</p>
</li>
<li id="BABHEHBJ">
<p>When the evaluation of all factors that are identified by method or constant completes, Oracle Database Vault resolves the factors that are identified by other factors by using the identity maps that are defined for the factor configured identities.</p>
<p>The evaluation order of the factor-configured identities is by ASCII sort on the identity values: Oracle Database Vault uses the first alphabetically sorted identity mapping that it evaluates. For example, suppose factor TEST has identities X and Y. Furthermore, identities X and Y have identity maps that are dependent on identities for factors A, B, and C. The following mapping occurs:</p>
<ul>
<li>
<p>X is mapped when A=1 and B=1</p>
</li>
<li>
<p>Y is mapped when A=1, B=1, and C=2</p>
</li>
</ul>
<p>In this case, the first one evaluated is X. Y is not evaluated, but what if its C mapping meets the criteria that is needed for the TEST factor's success? You would need to reverse the mapping, that is, map Y before X so that A, B, and C can be evaluated first. To reverse the mapping, rename Y to V (or some alphabetic value that sorts before X) so that it can be correctly resolved.</p>
<p>This algorithm works if the ASCII sort ordering is correct and the identities map the same number factors at some level.</p>
</li>
<li>
<p>When the factor initialization completes, the Oracle Database Vault integration with Oracle Label Security occurs.</p>
</li>
</ol>
<p>After this process completes, Oracle Database Vault checks to see if a command rule is associated with the <code dir="ltr">CONNECT</code> event. If a rule set associated with the <code dir="ltr">CONNECT</code> event, then Oracle Database Vault evaluates the rule set. If the rule set evaluates to false or results in an error, then the session is terminated. Oracle Database Vault executes any auditing or call handlers associated with the rule set before the session is terminated.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Be careful about associating command rules with the <code dir="ltr">CONNECT</code> event, because you can inadvertently lock out other users from of the database. In general, if you create a command rule for <code dir="ltr">CONNECT</code>, set its evaluation option of the associated rule set to <code dir="ltr">Any True</code>.
<p>If you do inadvertently lock out users, then you should temporarily disable Oracle Database Vault, disable the CONNECT command rule, reenable Oracle Database Vault, and then fix the factor code that is causing the problem. <a href="#CIHCJAFG">"If the Test Fails"</a> provides an example of how to accomplish this.</p>
</div>
</div>
<!-- class="sect2" -->
<a id="BABGHBHD"></a>
<div id="DVADM70248" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How Factors Are Retrieved</h3>
<p><a id="sthref372"></a>You can retrieve a factor in a database session at any time by using the <code dir="ltr">DVF</code> factor function or the <code dir="ltr">DVSYS.GET_FACTOR</code> function. To find a listing of available factors, query the <code dir="ltr">DVS.DBA_DV_FACTOR</code> data dictionary view, described in<a href="views.htm#BABJHIEG">"DVSYS.DBA_DV_FACTOR View"</a>.</p>
<p><a href="#CIHEDHHG">Example 7-1</a> shows an example of using the <code dir="ltr">DVSYS.GET_FACTOR</code> function.</p>
<div id="DVADM70249" class="example">
<p class="titleinexample"><a id="CIHEDHHG"></a>Example 7-1 Using DVSYS.GET_FACTOR to Retrieve a Factor</p>
<pre dir="ltr">
SELECT GET_FACTOR('client_ip') FROM DUAL;
</pre></div>
<!-- class="example" -->
<p>You can use the factor values retrieved from the <code dir="ltr">DVF</code> factor function or the <code dir="ltr">DVSYS.GET_FACTOR</code> in the following ways:</p>
<ul>
<li>
<p>Oracle Database Vault rule expressions</p>
</li>
<li>
<p>Custom application code that is available to all database sessions in an Oracle Database Vault environment</p>
</li>
</ul>
<p><a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a> describes <code dir="ltr">DVF</code> factor functions in detail.</p>
<p>If you had set the factor evaluation to <span class="bold">By Session</span>, then Oracle Database Vault retrieves the value from the session context established, as described under <a href="#BABEBEID">"How Factors Are Processed When a Session Is Established"</a>.</p>
<p>If you had set the factor evaluation to <span class="bold">By Access</span>, then Oracle Database Vault performs Step <a href="#BABJGGCA">2</a> through Step <a href="#CIHJFJJD">5</a> (or Step <a href="#BABHEHBJ">6</a>), as described under <a href="#BABEBEID">"How Factors Are Processed When a Session Is Established"</a>, whenever the factor is retrieved.</p>
<p>If you had defined error options for the factor and if an error occurs, then Oracle Database Vault displays the error message.</p>
</div>
<!-- class="sect2" -->
<a id="BABIFICC"></a>
<div id="DVADM70250" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How Factors Are Set</h3>
<p><a id="sthref373"></a>You can have a factor identity assigned at any time during a database session, but only if you have defined a factor assignment rule set and that rule set evaluates to true. You can do this in the application code by using the <code dir="ltr">DVSYS.SET_FACTOR</code> function. In Java code, you can use the JDBC class <code dir="ltr">java.sql.CallableStatement</code> to set this value. For example:</p>
<pre dir="ltr">
java.sql.Connection connection ; 
...
java.sql.CallableStatement statement = 
   connection.prepareCall("{call DVSYS.SET_FACTOR('FACTOR_X', ?)}");
statement.setString(1, "MyValue");
boolean result = statement.execute();
...
</pre>
<p>Applications that can execute Oracle PL/SQL functions can use this procedure (for example, applications written using Oracle Data Provider for .NET (ODP.NET)).</p>
<p>This concept is similar to the standard Oracle <code dir="ltr">DBMS_SESSION.SET_IDENTIFIER</code> procedure with an added feature that a rule set controls when a factor value can be set. If the rule set evaluates to true, Steps <a href="#BABJGGCA">2</a> through <a href="#CIHJFJJD">5</a> under <a href="#BABEBEID">"How Factors Are Processed When a Session Is Established"</a> occur.</p>
<p>If you have not associated a assignment rule set for the factor or if the rule set returns false (or returns errors), then Oracle Database Vault sends an error message if you attempt to set the factor using the <code dir="ltr">DVSYS.SET_FACTOR</code> function.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABIJFHF"></a>
<div id="DVADM70078" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Tutorial: Preventing Ad Hoc Tool Access to the Database</h2>
<p>In this section:</p>
<ul>
<li>
<p><a href="#BABCDBCG">About This Tutorial</a></p>
</li>
<li>
<p><a href="#CIHBDBHF">Step 1: Enable the SCOTT User Account</a></p>
</li>
<li>
<p><a href="#CIHDBICJ">Step 2: Create the Module Factor</a></p>
</li>
<li>
<p><a href="#CIHECJDA">Step 3: Create the Limit SQL*Plus Access Rule and Rule Set</a></p>
</li>
<li>
<p><a href="#CIHBAHHH">Step 4: Create the CONNECT Command Rule</a></p>
</li>
<li>
<p><a href="#CIHEGDJH">Step 5: Test the Ad Hoc Tool Access Restriction</a></p>
</li>
<li>
<p><a href="#CIHDJHFH">Step 6: Remove the Components for This Tutorial</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#CIHCFJBG">"Tutorial: Restricting User Activities Based on Session Data"</a> for an example of using factor identity mapping</p>
</li>
<li>
<p><a href="dv_ols.htm#BEIHAJCG">"Tutorial: Integrating Oracle Database Vault with Oracle Label Security"</a> for an example of integrating an Oracle Database Vault factor with an Oracle Label Security label</p>
</li>
</ul>
</div>
<a id="BABCDBCG"></a>
<div id="DVADM71118" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About This Tutorial</h3>
<p><a id="sthref374"></a><a id="sthref375"></a>Many database applications contain features to explicitly control the actions of a user. However, an ad hoc query tool, such as SQL*Plus, may not have these controls. As a result, a user could use an ad hoc tool to perform actions in the database that he or she would normally be prevented from performing in a regular database application. You can use a combination of Oracle Database Vault factors, rule sets, and command rules to prevent unauthorized access to the database by ad hoc query tools.</p>
<p>In the following tutorial, you limit the use of SQL*Plus to only four users: the Database Vault Owner, the Database Vault Account Manager, <code dir="ltr">SYSTEM</code>, and <code dir="ltr">SYS</code>. To accomplish this, you must create a factor to find the applications on your system and a rule and rule set to limit SQL*Plus to these four users. Then you create a command rule for the <code dir="ltr">CONNECT</code> SQL statement, which is associated with the rule set. When you successfully complete this tutorial, then only the administrative users you specify should be able to connect to the database using SQL*Plus.</p>
</div>
<!-- class="sect2" -->
<a id="CIHBDBHF"></a>
<div id="DVADM70251" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 1: Enable the SCOTT User Account</h3>
<p>You must use the <code dir="ltr">SCOTT</code> account later on when you test the Oracle Database Vault components for this tutorial, so ensure that this account is active.</p>
<ol>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Check the status of the <code dir="ltr">SCOTT</code> account.</p>
<pre dir="ltr">
SELECT USERNAME, ACCOUNT_STATUS FROM DBA_USERS WHERE USERNAME = 'SCOTT';
</pre></li>
<li>
<p>If the <code dir="ltr">SCOTT</code> account is expired and locked, then enter the following statement to make it active:</p>
<pre dir="ltr">
ALTER USER SCOTT ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">password</span></code> with a password that is secure. See <a class="olink DBSEG33223" href="../../network.112/e36292/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHDBICJ"></a>
<div id="DVADM70252" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 2: Create the Module Factor</h3>
<p>The Module factor uses the <code dir="ltr">SYS_CONTEXT</code> SQL function to find the names of the applications that are used to access the current instance of Oracle Database. As described previously, the <code dir="ltr">SYS_CONTEXT</code> SQL function provides many useful methods for finding the state of a user session. <code dir="ltr">SYS_CONTEXT</code> is a valuable tool for creating custom factors. See <a class="olink SQLRF06117" href="../../server.112/e41084/functions184.htm#SQLRF06117"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code dir="ltr">SYS_CONTEXT</code> function.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This type of factor is highly dependent on the security of the client session to ensure that it cannot be faked. See <a id="sthref376"></a>My Oracle Support (formerly Oracle<span class="italic">MetaLink</span>) Note 281229.1 for more information. You can access My Oracle Support from the following Web site:
<p><a href="https://support.oracle.com"><code dir="ltr">https://support.oracle.com"&gt;&gt;https://support.oracle.com</code></a></p>
</div>
<ol>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>In the Administration page, select <span class="bold">Factors</span>.</p>
<p>The Factors page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span> to display the Create Factor page.</p>
</li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<p><span class="bold">Name:</span> Enter <code dir="ltr">Module</code>.</p>
</li>
<li>
<p><span class="bold">Description:</span> Enter <code dir="ltr">Factor to find applications that can access Oracle Database</code>.</p>
</li>
<li>
<p><span class="bold">Factor Type:</span> From the list, select <span class="bold">Application</span>.</p>
</li>
<li>
<p><span class="bold">Factor Identification:</span> Select <span class="bold">By Method</span>.</p>
</li>
<li>
<p><span class="bold">Evaluation:</span> Select <span class="bold">By Access</span>.</p>
</li>
<li>
<p><span class="bold">Factor Labeling:</span> Select <span class="bold">By Self</span>.</p>
</li>
<li>
<p><span class="bold">Retrieval Method:</span> Enter the following retrieval method:</p>
<pre dir="ltr">
UPPER(SYS_CONTEXT('USERENV', 'MODULE'))
</pre></li>
<li>
<p><span class="bold">Validation Method:</span> Leave blank.</p>
</li>
<li>
<p><span class="bold">Assignment Rule Set:</span> From the list, select <span class="bold">&lt;Non Selected&gt;</span>.</p>
</li>
<li>
<p><span class="bold">Audit Options:</span> Select <span class="bold">Never</span>.</p>
</li>
<li>
<p><span class="bold">Error Options:</span> Select <span class="bold">Show Error Message</span>.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>Oracle Database Vault creates the factor. You now can query for the factor using the same syntax you would use to query the default factors, described <a href="plsql_interfaces.htm#CHDJGAIJ">"Oracle Database Vault PL/SQL Factor Functions"</a>.</p>
</li>
<li>
<p>In SQL*Plus, perform a quick test of the Module factor.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus lbrown_dvowner
Enter password: <span class="italic">password</span>

SELECT DVF.F$MODULE FROM DUAL;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
F$MODULE
-----------------------------
SQLPLUS.EXE
</pre>
<p>Do not exit SQL*Plus. You must use it later on when you test the factor components.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHECJDA"></a>
<div id="DVADM70253" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 3: Create the Limit SQL*Plus Access Rule and Rule Set</h3>
<ol>
<li>
<p>In Oracle Database Vault Administrator, return to the Administration page.</p>
</li>
<li>
<p>Under Administration, select <span class="bold">Rule Sets</span>.</p>
<p>The Rule Sets page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span> to display the Create Rule Set page.</p>
</li>
<li>
<p>Enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Name:</span> Enter <code dir="ltr">Limit SQL*Plus Access</code>.</p>
</li>
<li>
<p><span class="bold">Description:</span> Enter <code dir="ltr">Rule set to limit access to SQL*Plus</code>.</p>
</li>
<li>
<p><span class="bold">Status:</span> Select <span class="bold">Enabled</span>.</p>
</li>
<li>
<p><span class="bold">Evaluation Options:</span> Select <span class="bold">All True</span>.</p>
</li>
<li>
<p><span class="bold">Audit Options:</span> Select <span class="bold">Audit Disabled</span>.</p>
</li>
<li>
<p><span class="bold">Error Handling Options:</span> Select <span class="bold">Show Error Message</span>.</p>
</li>
<li>
<p><span class="bold">Fail Code, Fail Message:</span> Leave blank.</p>
</li>
<li>
<p><span class="bold">Custom Event Handler Option:</span> Select <span class="bold">Handler Disabled</span>.</p>
</li>
<li>
<p><span class="bold">Custom Event Handler Logic:</span> Leave blank.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>The Rule Sets page appears.</p>
</li>
<li>
<p>Select the Limit SQL*Plus rule set and then click <span class="bold">Edit</span>.</p>
<p>The Edit Rule Set page appears.</p>
</li>
<li>
<p>Under Rules Associated To The Rule Set, click <span class="bold">Create</span>.</p>
<p>The Create Rule page appears.</p>
</li>
<li id="CIHDDACH">
<p>Enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Name:</span> Enter <code dir="ltr">Prevent non-admin access to SQL*Plus</code>.</p>
</li>
<li>
<p><span class="bold">Rule Expression:</span> Enter the following rule expression:</p>
<pre dir="ltr">
DVF.F$MODULE = 'SQL*PLUS.EXE' AND DVF.F$SESSION_USER IN ('LBROWN_DVOWNER', 'AMALCOLM_DVACCTMGR', 'SYS', 'SYSTEM')
</pre>
<p>Replace <code dir="ltr">LBROWN_DVOWNER</code> and <code dir="ltr">AMALCOLM_DVACCTMGR</code> with the user account names that you use for the Database Vault Owner and Database Vault Account Manager accounts. You <span class="italic">must</span> enter the user account names in upper case letters, because that is how the database stores user account names.</p>
<p>This expression tells Oracle Database Vault only to allow these four users to use SQL*Plus. Another way to write the expression is to tell Database Vault to simply exclude certain users from using SQL*Plus. That way, everyone else has access to SQL*Plus. For example, to exclude users <code dir="ltr">JSMITH</code> and <code dir="ltr">TSMITH</code> from using SQL*Plus, you would create this expression:</p>
<pre dir="ltr">
DVF.F$MODULE != 'SQL*PLUS.EXE' AND DVF.F$SESSION_USER NOT IN ('JSMITH', 'TSMITH')
</pre>
<p>However, for this tutorial, use the first expression, in which only the four administrative users are allowed to use SQL*Plus.</p>
</li>
</ul>
</li>
<li>
<p>Ensure that you have entered this rule expression <span class="italic">exactly</span> as shown in Step <a href="#CIHDDACH">8</a>. If you enter it incorrectly, you cannot log in to SQL*Plus.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHBAHHH"></a>
<div id="DVADM70254" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 4: Create the CONNECT Command Rule</h3>
<p>The CONNECT command rule controls the <code dir="ltr">CONNECT</code> SQL statement. It also applies to logging into SQL*Plus from the command line or other tools your site may use to access SQL*Plus.</p>
<ol>
<li>
<p>In Oracle Database Vault, return to the Administration page.</p>
</li>
<li>
<p>Select <span class="bold">Command Rules</span>.</p>
<p>The Command Rules page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span> to display the Create Command Rule page.</p>
</li>
<li>
<p>Enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Command:</span> Select <span class="bold">CONNECT</span> from the list.</p>
</li>
<li>
<p><span class="bold">Status:</span> Select <span class="bold">Enabled</span>.</p>
</li>
<li>
<p><span class="bold">Object Owner, Object Name:</span> Set to <span class="bold">%</span> so that the command rule applies to anyone who logs in.</p>
</li>
<li>
<p><span class="bold">Rule Set:</span> Select <span class="bold">Limit SQL*Plus Access</span> from the list.</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHEGDJH"></a>
<div id="DVADM70255" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 5: Test the Ad Hoc Tool Access Restriction</h3>
<p>You have been logged in to SQL*Plus all along, but note that you do not need to restart your SQL*Plus session in order for the Oracle Database Vault changes to take effect. They take effect right away.</p>
<ol>
<li>
<p>In SQL*Plus, try to connect as user <code dir="ltr">SCOTT</code>:</p>
<pre dir="ltr">
CONNECT SCOTT
Enter password: <span class="italic">password</span>
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ERROR:
ORA-47400: Command Rule violation for CONNECT on LOGON

Warning: You are no longer connected to ORACLE. 
</pre>
<p>User <code dir="ltr">SCOTT</code> should be prevented from using SQL*Plus.</p>
</li>
<li>
<p>Now try to connect as user <code dir="ltr">SYSTEM</code>:</p>
<pre dir="ltr">
CONNECT SYSTEM
Enter password: <span class="italic">password</span>
Connected. 
</pre>
<p>User <code dir="ltr">SYSTEM</code> should be able to log in to SQL*Plus. So should <code dir="ltr">SYS</code>, the Database Vault Owner account, and the Database Vault Account Manager account.</p>
</li>
</ol>
<p class="subhead2"><a id="CIHCJAFG"></a><a id="DVADM70256"></a>If the Test Fails</p>
<p>If you cannot log in to SQL*Plus as <code dir="ltr">SYSTEM</code> (or as any of the other administrative users listed in your rule expression), then you are prevented from using both SQL*Plus and Oracle Database Vault Administrator. But do not fear, you can remedy the problem as follows:</p>
<ol>
<li>
<p>Temporarily disable Oracle Database Vault.</p>
<p>See <a href="dvdisabl.htm#BJEDGGGA">Appendix B, "Disabling and Enabling Oracle&nbsp;Database&nbsp;Vault,"</a> for instructions on disabling Oracle Database Vault. After you disable Oracle Database Vault, you can log in to SQL*Plus.</p>
</li>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_OWNE</code>R or <code dir="ltr">DV_ADMIN</code> role.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Enter the following statement to drop the CONNECT command rule.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.DELETE_COMMAND_RULE ('CONNECT', '%', '%');
</pre>
<p>Even though you have disabled Oracle Database Vault, you still can use its PL/SQL Packages and Database Vault Administrator.</p>
</li>
<li>
<p>Exit SQL*Plus.</p>
</li>
<li>
<p>Reenable Oracle Database Vault.</p>
<p>See <a href="dvdisabl.htm#BJEDGGGA">Appendix B, "Disabling and Enabling Oracle&nbsp;Database&nbsp;Vault,"</a> for instructions on enabling Oracle Database Vault.</p>
</li>
<li>
<p>In Oracle Database Vault Administrator, check the rule expression for any errors and then correct them. Recreate the CONNECT command rule, and then test it.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHDJHFH"></a>
<div id="DVADM70257" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 6: Remove the Components for This Tutorial</h3>
<ol>
<li>
<p>In Database Vault Administrator, return to the Administrator page.</p>
</li>
<li>
<p>Select <span class="bold">Command Rules</span>.</p>
</li>
<li>
<p>In the Command Rules page, select the CONNECT command rule, and then click <span class="bold">Remove</span>. Select <span class="bold">Yes</span> in the Confirmation page.</p>
</li>
<li>
<p>In the Administrator page, select <span class="bold">Rule Sets</span>.</p>
</li>
<li>
<p>In the Rule Sets page, select the Limit SQL*Plus Access rule set and click <span class="bold">Remove</span>. Select <span class="bold">Yes</span> in the Confirmation page.</p>
</li>
<li>
<p>In the Administration page, select <span class="bold">Factors</span>.</p>
</li>
<li>
<p>In the Factors page, select the Module factor, and then click <span class="bold">Remove</span>. Select <span class="bold">Yes</span> in the Confirmation page.</p>
</li>
<li>
<p>As the Database Vault Owner, log in to SQL*Plus and then remove the Prevent Non-admin access to SQL*Plus rule.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>

EXEC DBMS_MACADM.DELETE_RULE('Prevent non-admin access to SQL*Plus');
 
</pre></li>
<li>
<p>If necessary, connect as the Oracle Database Vault Account Manager and then lock and expire the <code dir="ltr">SCOTT</code> account.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

ALTER USER SCOTT ACCOUNT LOCK PASSWORD EXPIRE;
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHCFJBG"></a>
<div id="DVADM70258" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Tutorial: Restricting User Activities Based on Session Data</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABGJABD">About This Tutorial</a></p>
</li>
<li>
<p><a href="#CIHCEAJA">Step 1: Create an Administrative User</a></p>
</li>
<li>
<p><a href="#CIHBIHAH">Step 2: Add Identities to the Domain Factor</a></p>
</li>
<li>
<p><a href="#CIHICACA">Step 3: Map the Domain Factor Identities to the Client_IP Factor</a></p>
</li>
<li>
<p><a href="#CIHHADEJ">Step 4: Create a Rule Set to Set the Hours and Select the Factor Identity</a></p>
</li>
<li>
<p><a href="#CIHHABEJ">Step 5: Create a Command Rule That Uses the Rule Set</a></p>
</li>
<li>
<p><a href="#CIHIJAAF">Step 6: Test the Factor Identity Settings</a></p>
</li>
<li>
<p><a href="#CIHGCCEJ">Step 7: Remove the Components for This Tutorial</a></p>
</li>
</ul>
<a id="BABGJABD"></a>
<div id="DVADM71119" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About This Tutorial</h3>
<p>You <a id="sthref377"></a><a id="sthref378"></a><a id="sthref379"></a><a id="sthref380"></a>can <a id="sthref381"></a>use factor identity mapping to set session-based user restrictions for database activities. For example, suppose you wanted to restrict administrative access to a database using the following criteria:</p>
<ul>
<li>
<p>Ensure that the administrator is accessing the database from the correct IP address.</p>
</li>
<li>
<p>Limit the database access to the standard business hours of the administrator.</p>
</li>
</ul>
<p>This type of configuration is useful for restricting <a id="sthref382"></a>different types of administrators: not only local, internal administrators, but offshore and contract administrators as well.</p>
<p>In this tutorial, you modify the Domain factor to include identities for a secure and non-secure network access, which are based on the IP address of the computer the administrator is using. If the administrator tries to perform an action outside the standard working hours or from a different IP address, then Oracle Database Vault prevents him from doing so.</p>
</div>
<!-- class="sect2" -->
<a id="CIHCEAJA"></a>
<div id="DVADM70259" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 1: Create an Administrative User</h3>
<ol>
<li>
<p>In SQL*Plus, log in as a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role, and then create the user account <code dir="ltr">mwaldron</code>.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

CREATE USER mwaldron IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">password</span></code> with a password that is secure. See <a class="olink DBSEG33223" href="../../network.112/e36292/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</li>
<li>
<p>Connect as <code dir="ltr">SYS</code> using the <code dir="ltr">SYSDBA</code> privilege, and then grant user <code dir="ltr">mwaldron</code> DBA privileges.</p>
<pre dir="ltr">
CONNECT SYS AS SYSDBA
Enter password: <span class="italic">password</span>

GRANT CREATE SESSION, DBA TO mwaldron;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHBIHAH"></a>
<div id="DVADM70260" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 2: Add Identities to the Domain Factor</h3>
<ol>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>In the Administration page, select <span class="bold">Factors</span>.</p>
<p>The Factors page appears.</p>
</li>
<li>
<p>Select the Domain factor and then select <span class="bold">Edit</span>.</p>
<p>The Domain factor is the parent factor.</p>
</li>
<li>
<p>Under Identities, select <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Identity page, enter the following information:</p>
<ul>
<li>
<p><span class="bold">Value:</span> Enter <code dir="ltr">HIGHLY SECURE INTERNAL NETWORK</code></p>
</li>
<li>
<p><span class="bold">Trust Level:</span> Select <span class="bold">Very Trusted</span></p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Edit Factor:Domain page, create a second identity called NOT SECURE, and then set its trust level to Untrusted.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHICACA"></a>
<div id="DVADM70261" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 3: Map the Domain Factor Identities to the Client_IP Factor</h3>
<ol>
<li>
<p>In Oracle Database Vault Administrator, in the Edit Factor: Domain page, select the HIGHLY SECURE INTERNAL NETWORK identity and then select <span class="bold">Edit</span>.</p>
</li>
<li>
<p>Under Map Identity, select <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Identity Map page, enter the following information:</p>
<ul>
<li>
<p><span class="bold">Contributing Factor:</span> Select <span class="bold">Client_IP</span> to be the child factor.</p>
</li>
<li>
<p><span class="bold">Map Condition:</span> Select <span class="bold">Equal</span>, and then in the <span class="bold">Low Value</span> box, enter the IP address for the Virtual Machine (for example, <code dir="ltr">192.0.2.12</code>). (This is the computer that user <code dir="ltr">mwaldron</code> uses. For this tutorial, you can enter the IP address of your own computer. If you are using Microsoft Windows, use the IP address assigned to the Loopback Adapter.)</p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span>, and then click <span class="bold">OK</span> again to return to the Edit Factor: Domain page.</p>
</li>
<li>
<p>Create the following two identity maps for the NOT SECURE identity:</p>
<div class="inftblsimple">
<table class="cellalignment1645" title="SECURE NETWORK EXTERNAL DBA identity mappings" summary="SECURE NETWORK EXTERNAL DBA identity mappings, listed top to bottom, left to right" dir="ltr">
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><span class="bold">Child Factor Name</span></td>
<td class="cellalignment1646"><span class="bold">Operation Value</span></td>
<td class="cellalignment1646"><span class="bold">Operand 1</span></td>
<td class="cellalignment1646"><span class="bold">Operand 2</span></td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><code dir="ltr">Client_IP</code></td>
<td class="cellalignment1646"><code dir="ltr">Less</code></td>
<td class="cellalignment1646"><code dir="ltr">192.0.2.5</code></td>
<td class="cellalignment1646">(Leave blank)</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><code dir="ltr">Client_IP</code></td>
<td class="cellalignment1646"><code dir="ltr">Greater</code></td>
<td class="cellalignment1646"><code dir="ltr">192.0.2.20</code></td>
<td class="cellalignment1646">(Leave blank)</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblsimple" -->
<p>The identity maps in the NOT SECURE identity are in a range of IP addresses outside the IP address that user <code dir="ltr">mwaldron</code> uses (192.0.2.12). The IP addresses here must be in any range <span class="italic">outside</span> <code dir="ltr">mwaldron</code>'s IP address.</p>
<p>This identity mapping creates the following condition: If the user logs in from the correct IP address, then Oracle Database Vault decides that the connection is secure, through the HIGHLY SECURE INTERNAL NETWORK identity. However, if the user logs in from an IP address that is less than 192.0.2.5 or greater than 192.0.2.20, then the connection is deemed not secure, through the NO SECURE identity.</p>
</li>
<li>
<p>Click <span class="bold">OK</span> to return to the Edit Factor: Domain page, then click <span class="bold">OK</span> again to return to the Factors page.</p>
</li>
<li id="CIHCJBAH">
<p>Test the factor identities.</p>
<p>First, in SQL*Plus, connect as user <code dir="ltr">mwaldron</code> but do not specify a database instance.</p>
<pre dir="ltr">
CONNECT mwaldron
Enter password: <span class="italic">password</span>

SELECT DVF.F$CLIENT_IP FROM DUAL;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
F$CLIENT_IP
-------------------------------------
</pre>
<p>Next:</p>
<pre dir="ltr">
SELECT DVF.F$DOMAIN FROM DUAL;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
F$DOMAIN
-------------------------------------
NOT SECURE
</pre>
<p>Because user <code dir="ltr">mwaldron</code> is not connecting directly to the database instance, Oracle Database Vault does not recognize the IP address from which he is connecting. In this case, Oracle Database uses the IPC protocol to perform the connection, which sets the IP value to null. Therefore, the identity for this connection is set to NOT SECURE.</p>
<p>Now connect to SQL*Plus by specifying the database instance (for example, <code dir="ltr">orcl</code>), and then check the factor identities again:</p>
<pre dir="ltr">
CONNECT mwaldron@orcl
Enter password: <span class="italic">password</span>

SELECT DVF.F$CLIENT_IP FROM DUAL;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
F$CLIENT_IP
-------------------------------------
192.0.2.12
</pre>
<p>Next:</p>
<pre dir="ltr">
SELECT DVF.F$DOMAIN FROM DUAL;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
F$DOMAIN
-------------------------------------
HIGHLY SECURE INTERNAL NETWORK
</pre>
<p>Now that user <code dir="ltr">mwaldron</code> is connecting to the <code dir="ltr">orcl</code> database instance, his IP address is recognized. This is because the database uses the TCP protocol, so now the host IP value can be populated appropriately. Because the IP address is within the correct range, the factor identity is set to HIGHLY SECURE INTERNAL NETWORK.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHHADEJ"></a>
<div id="DVADM70262" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 4: Create a Rule Set to Set the Hours and Select the Factor Identity</h3>
<ol>
<li>
<p>In Oracle Database Vault, return to the Administration page.</p>
</li>
<li>
<p>Select <span class="bold">Rule Sets</span>.</p>
</li>
<li>
<p>In the Rule Sets page, select <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Rule Set page, enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Name:</span> Enter <code dir="ltr">Internal DBA Standard Working Hours</code>.</p>
</li>
<li>
<p><span class="bold">Status:</span> Select <span class="bold">Enabled</span>.</p>
</li>
<li>
<p><span class="bold">Evaluation Options:</span> Select <span class="bold">All True</span>.</p>
</li>
</ul>
<p>Leave the remaining settings at their defaults.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Rule Sets page, select the Internal DBA Standard Working Hours rule set, and then select <span class="bold">Edit</span>.</p>
</li>
<li>
<p>In the Edit Rule Set: Internal DBA Standard Working Hours page, under Rules Associated To The Rule Set, select <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Rule page, create the following rules:</p>
<ul>
<li>
<p><span class="bold">Name:</span> <code dir="ltr">Internal DBA</code></p>
<p><span class="bold">Rule Expression:</span> <code dir="ltr">DVF.F$SESSION_USER='MWALDRON'</code></p>
<p>(When you create an expression with a user name, enter the user name in upper case letters, because that is how the database stores user names.)</p>
</li>
<li>
<p><span class="bold">Name:</span> <code dir="ltr">Internal Network Only</code></p>
<p><span class="bold">Rule Expression:</span> <code dir="ltr">DVF.F$DOMAIN='HIGHLY SECURE INTERNAL NETWORK'</code></p>
</li>
<li>
<p><span class="bold">Name:</span> <code dir="ltr">Week Day</code></p>
<p><span class="bold">Rule Expression:</span> <code dir="ltr">TO_CHAR(SYSDATE, 'D') BETWEEN '2' AND '6'</code></p>
</li>
<li>
<p><span class="bold">Name:</span> <code dir="ltr">Week Working Day Hours</code></p>
<p><span class="bold">Rule Expression:</span> <code dir="ltr">TO_CHAR(SYSDATE, 'HH24') BETWEEN '08' AND '19'</code></p>
</li>
</ul>
</li>
<li>
<p>Click <span class="bold">OK</span> to return to the Rule Sets page.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHHABEJ"></a>
<div id="DVADM70263" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 5: Create a Command Rule That Uses the Rule Set</h3>
<ol>
<li>
<p>In Oracle Database Vault Administrator, return to the Administration page.</p>
</li>
<li>
<p>Select <span class="bold">Command Rules</span>, and in the Command Rules page, select <span class="bold">Create</span>.</p>
</li>
<li>
<p>In the Create Command Rule page, enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Command</span>: Select <span class="bold">CREATE TABLE</span> from the list.</p>
</li>
<li>
<p><span class="bold">Rule Set</span>: Select <span class="bold">Internal DBA Standard Working Hours</span> from the list.</p>
</li>
</ul>
<p>Leave the remaining settings at their defaults.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHIJAAF"></a>
<div id="DVADM70264" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 6: Test the Factor Identity Settings</h3>
<p>Test the settings by resetting the system clock, logging in as the <code dir="ltr">mwaldron</code> administrative user, and then trying to create a table.</p>
<ol>
<li>
<p>Set the system time to 9 p.m.</p>
<p><span class="bold">UNIX:</span> Log in as root and use the date command to set the time. For example, assuming the date today is December 14 2011, you would enter the following:</p>
<pre dir="ltr">
su root
Password: <span class="italic">password</span>

date --set="14 DEC 2011 21:00:00"
</pre>
<p><span class="bold">Windows:</span> Double-click the clock icon, which is typically at the lower right corner of the screen. In the Date and Time Properties window, set the time to 9 p.m., and then click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In SQL*Plus, connect as user <code dir="ltr">mwaldron</code> and try to create a table. In the following, replace <code dir="ltr">orcl</code> with the name of your database instance.</p>
<pre dir="ltr">
CONNECT mwaldron@orcl
Enter password: <span class="italic">password</span>

CREATE TABLE TEST (num number);  
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ORA-47400: Command Rule violation for create table on MWALDRON.TEST
</pre>
<p>Because user <code dir="ltr">mwaldron</code> is create a table outside working hours, Database Vault prevents him.</p>
</li>
<li>
<p>Reset the system time back to the local time.</p>
</li>
<li>
<p>In SQL*Plus, as user <code dir="ltr">mwaldron</code>, try to create the table again.</p>
<pre dir="ltr">
CREATE TABLE TEST (num number);

Table created.

DROP TABLE TEST;
Table dropped.
</pre>
<p>Now that user <code dir="ltr">mwaldron</code> is working during his local hours and from the IP address associated with the HIGHLY SECURE INTERNAL NETWORK identity, he can create tables.</p>
</li>
<li>
<p>Reconnect as user <code dir="ltr">mwaldron</code> but without adding the database instance name to the connection command, and then try to create the table again.</p>
<pre dir="ltr">
CONNECT mwaldron
Enter password: <span class="italic">password</span>

CREATE TABLE TEST (num number);
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ORA-47400: Command Rule violation for create table on MWALDRON.TEST
</pre>
<p>Even though user <code dir="ltr">mwaldron</code> is trying to create a table during the correct time, he cannot because is not directly logged in to the <code dir="ltr">orcl</code> database instance. Oracle Database Vault deems him to be using the NOT SECURE identity, and then denies him access.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHGCCEJ"></a>
<div id="DVADM70265" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 7: Remove the Components for This Tutorial</h3>
<ol>
<li>
<p>Log in to SQL*Plus as the <code dir="ltr">DV_ACCTMGR</code> user and drop user <code dir="ltr">mwaldron</code>.</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

DROP USER mwaldron CASCADE;
</pre></li>
<li>
<p>Remove the CREATE TABLE command rule.</p>
<p>Return the Administration page and select <span class="bold">Command Rules</span>. Select the CREATE TABLE command rule and then select <span class="bold">Remove</span>. In the Confirmation page, select <span class="bold">Yes</span>.</p>
</li>
<li>
<p>Remove the Internal DBA Standard Working Hours rule set.</p>
<p>In Oracle Database Vault Administrator, select <span class="bold">Rule Sets</span> in the Administration page. In the Rule Sets page, select the Internal DBA Standard Working Hours rule set, and then select <span class="bold">Remove</span>. In the Confirmation page, select <span class="bold">Yes</span>.</p>
</li>
<li>
<p>In SQL*Plus, delete the rules associated with the Internal DBA Standard Working Hours rule set.</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>

EXEC DBMS_MACADM.DELETE_RULE('Internal DBA');
EXEC DBMS_MACADM.DELETE_RULE('Internal Network Only');
EXEC DBMS_MACADM.DELETE_RULE('Week Day');
EXEC DBMS_MACADM.DELETE_RULE('Week Day Working Hours'); 
COMMIT;
</pre></li>
<li>
<p>Remove the HIGHLY SECURE INTERNAL NETWORK and NOT SECURE factor identities from the Domain factor.</p>
<p>Return to the Administration page and select <span class="bold">Factors</span>. Select the Domain factor, select <span class="bold">Edit</span>, and under Identities, remove the HIGHLY SECURE INTERNAL NETWORK and NOT SECURE factor identities. In the Confirmation page, select <span class="bold">Yes</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABBIDEH"></a>
<div id="DVADM70266" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Guidelines for Designing Factors</h2>
<p><a id="sthref383"></a><a id="sthref384"></a>Follow these guidelines for designing factors:</p>
<ul>
<li>
<p>You can use the Oracle utility packages such as <code dir="ltr">UTL_TCP</code>, <code dir="ltr">UTL_HTTP</code>, <code dir="ltr">DBMS_LDAP</code>, and <code dir="ltr">DBMS_PIPE</code> to integrate security or other contextual information about the session from external systems.</p>
</li>
<li>
<p>Do not specify a retrieval method if the factor identification is set to <span class="bold">Identified By Factors</span>. Retrieval methods are only needed if you set the factor to <span class="bold">By Method</span> or <span class="bold">By Constant</span>.</p>
</li>
<li>
<p>Consider using a validation method if a factor has an assignment rule set. Doing so helps to verify that invalid identities are not submitted.</p>
</li>
<li>
<p>Use the client-supplied factors such as Program, OS User, and others with caution, because the values that are supplied can only be trusted when the client software is trusted and the communications channel from the client software is known to be secure.</p>
</li>
<li>
<p>Only specify an evaluation option of <span class="bold">By Access</span> if the value returned by the retrieval method could change from one invocation to the next in the same session (for example, time-based factors).</p>
</li>
<li>
<p>Optimize the internal logic of a function used for the factor retrieval method using traditional SQL and PL/SQL optimization techniques. For more information about performance and optimization, see <a class="olink PFGRF" href="../e41573/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a>.</p>
</li>
<li>
<p>If the discrete values returned by the retrieval method are known, be sure to define identities for each value so that you can assign trust levels for them. Trust levels add value to factors as you also can use the trust level in application logic based on factors.</p>
</li>
<li>
<p>A security policy based on more factors is generally considered stronger than one based on fewer factors. You can create a new factor that is identified by other factors to store combinations of factors into logical grouping using identity maps. This also makes it easier to label the parent factor when you integrate the factors with the Oracle Label Security labels. (See <a href="dv_ols.htm#CHDHJIFJ">"Integrating Oracle Database Vault with Oracle Label Security"</a> for more information.)</p>
</li>
<li>
<p>It is generally easier to configure and debug a factor that is labeled <span class="bold">By Self</span> than one labeled <span class="bold">By Factors</span> when integrating the Oracle Label Security.</p>
</li>
<li>
<p>You can design a database client application to pass one or more security, end-user, or environmental attributes so that they are available to an associated database session. To do this, create a single factor for each attribute and then use an assignment rule set to control when these attributes can be assigned (for example only when using a specific Web application on specified named application server computers). Oracle Database Vault factors used in this fashion are very much like the Oracle procedure <code dir="ltr">DBMS_SESSION.SET_IDENTIFIER</code> but also include a capability to control when they can be set. For more information about the <code dir="ltr">DBMS_SESSION</code> package, see <a class="olink ARPLS" href="../../appdev.112/e40758/toc.htm"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a>.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABJIBAE"></a>
<div id="DVADM70267" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">How Factors Affect Performance</h2>
<p><a id="sthref385"></a><a id="sthref386"></a>Each factor has elements that are processed, such as its validation method, trust level, and so on. For factors that are evaluated by the session, such as Database_Hostname and <code dir="ltr">Proxy_User</code>, Oracle Database Vault performs this processing during session initialization, and then caches the results for subsequent requests for that value.</p>
<p>The 17 default factors listed in <a href="#BABIEIJB">"Default Factors"</a> are cached because they are likely candidates for a typical security policy. However, if you only use five factors (for example, in rule sets or other components), then the other factors consume resources that could otherwise be used elsewhere. In this case, you should remove the unnecessary factors by deleting them. (Oracle Database Vault does not use any of these factors internally, so you can remove them if you do not need them.)</p>
<p>If you have a large number of users or if your application server frequently must create and destroy connections, the resources used can affect system performance. You can delete the unnecessary factors.</p>
<p>You can check system performance by running tools such as <a id="sthref387"></a>Oracle Enterprise Manager (including <a id="sthref388"></a>Oracle Enterprise Manager Database Control, which is installed by default with Oracle Database), <a id="sthref389"></a><code dir="ltr">Statspack</code>, and <a id="sthref390"></a><code dir="ltr">TKPROF</code>. For more information about Oracle Enterprise Manager, see the Oracle Enterprise Manager documentation set. For information about Database Control, refer to its online Help. <a class="olink PFGRF" href="../e41573/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a> describes the <code dir="ltr">Statspack</code> and <code dir="ltr">TKPROF</code> utilities.</p>
</div>
<!-- class="sect1" -->
<a id="CIHHEHFI"></a>
<div id="DVADM70268" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Related Reports and Data Dictionary Views</h2>
<p><a href="#CIHECJFB">Table 7-1</a> lists <a id="sthref391"></a><a id="sthref392"></a>Oracle Database Vault reports that are useful for analyzing factors and their identities. See <a href="reports.htm#BABDCICF">Chapter 18, "Oracle Database Vault Reports,"</a> for information about how to run these reports.</p>
<div id="DVADM70269" class="tblhruleformal">
<p class="titleintable"><a id="sthref393"></a><a id="CIHECJFB"></a>Table 7-1 Reports Related to Factors and Their Identities</p>
<table class="cellalignment1647" title="Reports Related to Factors and Their Identities" summary="factor reports" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t12">Report</th>
<th class="cellalignment1648" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t12" headers="r1c1-t12">
<p><a href="reports.htm#BABGDHCE">"Factor Audit Report"</a></p>
</td>
<td class="cellalignment1646" headers="r2c1-t12 r1c2-t12">
<p>Audits factors (for example, to find factors that failed to be evaluated)</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t12" headers="r1c1-t12">
<p><a href="reports.htm#BABDEFIG">"Factor Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r3c1-t12 r1c2-t12">
<p>Lists configuration issues, such as disabled or incomplete rule sets, or to audit issues that may affect the factor</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t12" headers="r1c1-t12">
<p><a href="reports.htm#BABEGAEA">"Factor Without Identities Report"</a></p>
</td>
<td class="cellalignment1646" headers="r4c1-t12 r1c2-t12">
<p>Lists factors that have had no identities assigned yet</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r5c1-t12" headers="r1c1-t12">
<p><a href="reports.htm#BABHJACH">"Identity Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r5c1-t12 r1c2-t12">
<p>Lists factors that have invalid label identities or no map for the identity</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r6c1-t12" headers="r1c1-t12">
<p><a href="reports.htm#BABGBBFH">"Rule Set Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r6c1-t12 r1c2-t12">
<p>Lists rule sets that have no rules defined or enabled, which may affect the factors that use them</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p><a href="#CIHCDBII">Table 7-2</a> lists <a id="sthref394"></a><a id="sthref395"></a>data dictionary views that provide information about existing factors and factor identities.</p>
<div id="DVADM70270" class="tblhruleformal">
<p class="titleintable"><a id="sthref396"></a><a id="CIHCDBII"></a>Table 7-2 Data Dictionary Views Used for Factors and Factor Identities</p>
<table class="cellalignment1647" title="Data Dictionary Views Used for Factors and Factor Identities" summary="Factor Data Dictionary Views" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t13">Data Dictionary View</th>
<th class="cellalignment1648" id="r1c2-t13">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t13" headers="r1c1-t13">
<p><a href="views.htm#BABJHIEG">"DVSYS.DBA_DV_FACTOR View"</a></p>
</td>
<td class="cellalignment1646" headers="r2c1-t13 r1c2-t13">
<p>Lists the existing factors in the current database instance</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t13" headers="r1c1-t13">
<p><a href="views.htm#BABDAFEJ">"DVSYS.DBA_DV_FACTOR_LINK View"</a></p>
</td>
<td class="cellalignment1646" headers="r3c1-t13 r1c2-t13">
<p>Shows the relationships of each factor whose identity is determined by the association of child factors</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t13" headers="r1c1-t13">
<p><a href="views.htm#BABEJCIJ">"DVSYS.DBA_DV_FACTOR_TYPE View"</a></p>
</td>
<td class="cellalignment1646" headers="r4c1-t13 r1c2-t13">
<p>Lists the names and descriptions of factor types used in the system</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r5c1-t13" headers="r1c1-t13">
<p><a href="views.htm#BABBHHCB">"DVSYS.DBA_DV_IDENTITY View"</a></p>
</td>
<td class="cellalignment1646" headers="r5c1-t13 r1c2-t13">
<p>Lists the identities for each factor</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r6c1-t13" headers="r1c1-t13">
<p><a href="views.htm#BABBDBFF">"DVSYS.DBA_DV_IDENTITY_MAP View"</a></p>
</td>
<td class="cellalignment1646" headers="r6c1-t13 r1c2-t13">
<p>Lists the mappings for each factor identity</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1638">
<tr>
<td class="cellalignment1646">
<table class="cellalignment1643">
<tr>
<td class="cellalignment1642"><a href="cfcmdaut.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1642"><a href="cfseappr.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1650">
<table class="cellalignment1641">
<tr>
<td class="cellalignment1642"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1642"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1642"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1642"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1642"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
