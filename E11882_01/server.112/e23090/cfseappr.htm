<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Configuring Secure Application Roles for&nbsp;Oracle Database Vault</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1088" />
<meta name="dcterms.created" content="2016-11-14T16:25:10Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Vault Administrator's Guide" />
<meta name="dcterms.identifier" content="E23090-13" />
<meta name="dcterms.isVersionOf" content="DVADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="cfgfact.htm" title="Previous" type="text/html" />
<link rel="Next" href="dv_ols.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e23090.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">15/31</span> <!-- End Header -->
<div id="DVADM007" class="chapter"><a id="CHDFIAIE"></a>
<h1 class="chapter"><span class="secnum">8</span> Configuring Secure Application Roles for&nbsp;Oracle Database Vault</h1>
<p>This chapter contains:</p>
<ul>
<li>
<p><a href="#CHDDBFCI">What Are Secure Application Roles in Oracle Database Vault?</a></p>
</li>
<li>
<p><a href="#CHDDGBGI">Creating and Editing Secure Application Roles</a></p>
</li>
<li>
<p><a href="#CFAICGCC">Securing a Secure Application Role</a></p>
</li>
<li>
<p><a href="#CHDEAECF">Deleting a Secure Application Role</a></p>
</li>
<li>
<p><a href="#CHDEFFEE">How Secure Application Roles Work</a></p>
</li>
<li>
<p><a href="#CFACFFFG">Tutorial: Granting Access with Database Vault Secure Application Roles</a></p>
</li>
<li>
<p><a href="#CHDIEIHJ">How Secure Application Roles Affect Performance</a></p>
</li>
<li>
<p><a href="#CFAJBGFA">Related Reports and Data Dictionary View</a></p>
</li>
</ul>
<a id="CHDDBFCI"></a>
<div id="DVADM70271" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">What Are Secure Application Roles in Oracle Database Vault?</h2>
<p>In Oracle Database Vault, you can create a <a id="sthref397"></a>secure application role that you enable with an Oracle Database Vault rule set. Regular Oracle Database secure application roles are enabled by custom PL/SQL procedures. You use secure application roles to prevent users from accessing data from outside an application. This forces users to work within the framework of the application privileges that have been granted to the role.</p>
<p>The advantage of basing database access for a role on a rule set is that you can store database security policies in one central place, as opposed to storing them in all your applications. Basing the role on a rule set provides a consistent and flexible method to enforce the security policies that the role provides. In this way, if you must update the security policy for the application role, you do it in one place, the rule set. Furthermore, no matter how the user connects to the database, the result is the same, because the rule set is bound to the role. All you need to do is to create the role and then associate it with a rule set. The associated rule set validates the user who is trying to enable the role.</p>
<p>You can run reports on secure application roles that you create in Oracle Database Vault. See <a href="#CFAJBGFA">"Related Reports and Data Dictionary View"</a> for more information.</p>
<p>This chapter explains how to configure secure application roles by using Oracle Database Vault Administrator. To configure secure application roles by using the PL/SQL interfaces and packages provided by Oracle Database Vault, refer to the following chapters:</p>
<ul>
<li>
<p><a href="apis_dbms_macadm.htm#CHDHHDGI">Chapter 12, "Using the DBMS_MACADM Package"</a></p>
</li>
<li>
<p><a href="plsql_interfaces.htm#CHDEAEHD">Chapter 15, "Using the Oracle Database Vault PL/SQL&nbsp;Interfaces"</a></p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDDGBGI"></a>
<div id="DVADM70272" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Creating and Editing Secure Application Roles</h2>
<p><a id="sthref398"></a>Follow these steps:</p>
<ol>
<li>
<p>Create a rule set that contains at least one rule to set the conditions for allowing or disallowing the user to enable the role.</p>
<p>When you create the underlying rule for the rule set, remember that the rule should validate the user who is trying to enable the role. The rule should validate the user who is trying to log in. See <a href="cfrulset.htm#BABIFBBC">Chapter 5, "Configuring Rule Sets,"</a> for more information about rule sets.</p>
</li>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>In the Administration page, under Database Vault Feature Administration, click <span class="bold">Secure Application Roles</span>.</p>
</li>
<li>
<p>In the Secure Application Roles page:</p>
<ul>
<li>
<p>To create a new secure application role, click <span class="bold">Create</span>.</p>
</li>
<li>
<p>To edit an existing secure application role, select it from the list and then click <span class="bold">Edit</span>.</p>
<p>Remember that you can modify an existing secure application role only if it has been created in Oracle Database Vault. You cannot modify secure application roles or database roles that have been created outside of Oracle Database Vault. If you want to modify an existing Oracle Database role so that it can work with Oracle Database Vault, create a new secure application role in Oracle Database Vault and then grant the existing role to the secure application role. For example, in SQL*Plus:</p>
<pre dir="ltr">
GRANT myExistingDBrole TO myDVrole;
</pre>
<p>After you create a new secure application role, you must modify your code to use this new role. You can use <code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code> in your application code to accomplish this. See <a href="apis_macsec_roles.htm#BCFCFBCE">"SET_ROLE Procedure"</a> for more information about the <code dir="ltr">SET_ROLE</code> function.</p>
</li>
</ul>
</li>
<li>
<p>In the Create (or Edit) Role page, enter the following settings and then click <span class="bold">OK</span>.</p>
<ul>
<li>
<p><a href="#CHDIAGCA">General</a></p>
</li>
<li>
<p><a href="#CHDIBHAE">Rule Set</a></p>
</li>
</ul>
</li>
</ol>
<p class="subhead2"><a id="CHDIAGCA"></a><a id="DVADM70273"></a>General</p>
<p>Enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Role:</span> Enter the name using no more than 30 characters, with no spaces. Preferably, enter the role name in upper case letters, though you are not required to do so. Ensure that this name follows the standard Oracle naming conventions for role creation using the <code dir="ltr">CREATE ROLE</code> statement, described in <a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a>. This attribute is mandatory.</p>
</li>
<li>
<p><span class="bold">Status:</span> Select either <span class="bold">Enabled</span> or <span class="bold">Disabled</span> to enable or disable the secure application role during run time. The default is <span class="bold">Enabled</span>. This attribute is mandatory.</p>
<ul>
<li>
<p><span class="bold">Enabled:</span> Enables the role to be available for use. That is, users are allowed to call the <code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code> function to try to enable the role. Note that whether or not the role will be enabled depends on the evaluation result of the associated rule set.</p>
<p>See <a href="apis_macsec_roles.htm#BCFCFBCE">"SET_ROLE Procedure"</a> for more information about this function.</p>
</li>
<li>
<p><span class="bold">Disabled:</span> Disables the role from being available for use. The <a id="sthref399"></a><code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code> function will not be able to enable the role.</p>
</li>
</ul>
<p>See <a href="plsql_interfaces.htm#CHDBEIII">"Oracle Database Vault PL/SQL Packages"</a> for more information about the <code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code> function.</p>
</li>
</ul>
<p class="subhead2"><a id="CHDIBHAE"></a><a id="DVADM70274"></a>Rule Set</p>
<p>From the list, select the rule set that you want to associate with the secure application role. This attribute is mandatory.</p>
<p>When calling <code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code>, if the rule set evaluates to true, then Oracle Database Vault sets the role for the database session. If the rule set evaluates to false, then the role is not set.</p>
<p>See <a href="cfrulset.htm#BABIFBBC">Chapter 5, "Configuring Rule Sets,"</a> for more information about rule sets.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dba.htm#CHDEEEFH">"Propagating Oracle Database Vault Policies to Other Databases"</a></div>
</div>
<!-- class="sect1" -->
<a id="CFAICGCC"></a>
<div id="DVADM70275" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Securing a Secure Application Role</h2>
<p><a id="sthref400"></a>Users <a id="sthref401"></a>who have database administrative privileges may try to use the <code dir="ltr">DROP ROLE</code> SQL statement to delete secure application roles that were created using Oracle Database Vault.</p>
<p>Whenever an Oracle Database Vault secure application role has been created, Database Vault adds the secure application role to the Database Vault realm. This prevents the database administrator from deleting the secure application role.</p>
</div>
<!-- class="sect1" -->
<a id="CHDEAECF"></a>
<div id="DVADM70276" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Deleting a Secure Application Role</h2>
<p><a id="sthref402"></a>Before you delete a secure application role, you can locate the various references to it by querying the role-related Oracle Database Vault views. See <a href="views.htm#BABIFDGE">Chapter 16, "Oracle Database Vault Data Dictionary Views,"</a> for more information.</p>
<p>To delete a secure application role:</p>
<ol>
<li>
<p>Check and modify any applications that may be using the secure application role that you want to delete.</p>
</li>
<li>
<p>In the Oracle Database Vault Administration page, select <span class="bold">Secure Application Roles</span>.</p>
</li>
<li>
<p>In the Secure Application Roles page, select the role that you want to remove.</p>
</li>
<li>
<p>Click <span class="bold">Remove</span>.</p>
</li>
<li>
<p>In the Confirmation page, click <span class="bold">Yes</span>.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CHDEFFEE"></a>
<div id="DVADM70277" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">How Secure Application Roles Work</h2>
<p><a id="sthref403"></a>The process flow for a secure application role that is managed by Oracle Database Vault is as follows:</p>
<ol>
<li>
<p>Create or update the role either in Oracle Database Vault Administrator or by using the secure application role-specific functions in the <code dir="ltr">DBMS_MACADM</code> package.</p>
<p>See <a href="apis_dbms_macadm.htm#CHDBDJBG">"Secure Application Role Procedures Within DBMS_MACADM"</a> for more information.</p>
</li>
<li>
<p>Modify your application to call the role, by using the <code dir="ltr">DBMS_MACSEC_ROLES.SET_ROLE</code> function.</p>
<p>See <a href="apis_macsec_roles.htm#BCFCFBCE">"SET_ROLE Procedure"</a> for more information.</p>
</li>
<li>
<p>Oracle Database Vault then evaluates the rule set associated with the secure application role.</p>
<p>If the rule set evaluates to true, then Oracle Database Vault enables the role for the current session. If the rule set evaluates to false, the role is not enabled. In either case, Oracle Database Vault processes the associated auditing and custom event handlers for the rule set associated with the secure application role.</p>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CFACFFFG"></a>
<div id="DVADM70278" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Tutorial: Granting Access with Database Vault Secure Application Roles</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CHDHGGBH">About This Tutorial</a></p>
</li>
<li>
<p><a href="#CFAFGACB">Step 1: Create Users for This Tutorial</a></p>
</li>
<li>
<p><a href="#CFAIFDAA">Step 2: Enable the OE User Account</a></p>
</li>
<li>
<p><a href="#CFAHDCDF">Step 3: Create the Rule Set and Its Rules</a></p>
</li>
<li>
<p><a href="#CFAHBAHA">Step 4: Create the Database Vault Secure Application Role</a></p>
</li>
<li>
<p><a href="#CFABIAIE">Step 5: Grant the SELECT Privilege to the Secure Application Role</a></p>
</li>
<li>
<p><a href="#CFAEFCBA">Step 6: Test the Database Vault Secure Application Role</a></p>
</li>
<li>
<p><a href="#CFAHCDBG">Step 7: Remove the Components for This Tutorial</a></p>
</li>
</ul>
<a id="CHDHGGBH"></a>
<div id="DVADM71120" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About This Tutorial</h3>
<p>In this tutorial, <a id="sthref404"></a><a id="sthref405"></a>you restrict the <code dir="ltr">SELECT</code> SQL statement on the <code dir="ltr">ORDERS</code> table in the <code dir="ltr">OE</code> schema to a specific set of users. Furthermore, these users can only perform these statements on the <code dir="ltr">OE.ORDERS</code> table from within the office, not from a remote connection. To accomplish this, you create an Oracle Database Vault secure application role that is enabled for the user only if the user passes the checks enforced by the rule set that you associate with the secure application role.</p>
</div>
<!-- class="sect2" -->
<a id="CFAFGACB"></a>
<div id="DVADM70279" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 1: Create Users for This Tutorial</h3>
<ol>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Create the following user accounts:</p>
<pre dir="ltr">
CREATE USER eabel IDENTIFIED BY <span class="italic">password</span>;
CREATE USER ahutton IDENTIFIED BY <span class="italic">password</span>;
CREATE USER ldoran IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">password</span></code> with a password that is secure. See <a class="olink DBSEG33223" href="../../network.112/e36292/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</li>
<li>
<p>Connect as <code dir="ltr">SYS</code> using the <code dir="ltr">SYSDBA</code> privilege, and then grant these users the <code dir="ltr">CREATE SESSION</code> privilege.</p>
<pre dir="ltr">
CONNECT SYS AS SYSDBA
Enter password: password

GRANT CREATE SESSION TO eabel, ahutton, ldoran;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CFAIFDAA"></a>
<div id="DVADM70280" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 2: Enable the OE User Account</h3>
<ol>
<li>
<p>In SQL*Plus, connect as the <code dir="ltr">DV_ACCTMGR</code> user.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Check the account status of the <code dir="ltr">OE</code> account.</p>
<pre dir="ltr">
SELECT USERNAME, ACCOUNT_STATUS FROM DBA_USERS WHERE USERNAME = 'OE';
</pre></li>
<li>
<p>If the <code dir="ltr">OE</code> account is locked and expired, unlock it and assign it a new password.</p>
<pre dir="ltr">
ALTER USER OE ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CFAHDCDF"></a>
<div id="DVADM70281" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 3: Create the Rule Set and Its Rules</h3>
<ol>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>In the Administration page, select <span class="bold">Rule Sets</span>.</p>
<p>The Rule Sets page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>The Create Rule Set page appears.</p>
</li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<p><span class="bold">Name:</span> <code dir="ltr">Can Modify Orders</code></p>
</li>
<li>
<p><span class="bold">Description:</span> <code dir="ltr">Rule set to control who can modify orders in the OE.ORDERS table</code></p>
</li>
</ul>
</li>
<li>
<p>Leave the remaining settings and their defaults, and then click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the Rule Sets page, select the Can Modify Orders rule set, and then click <span class="bold">Edit</span>.</p>
<p>The Edit Rule Set: Can Modify Orders page appears.</p>
</li>
<li>
<p>Scroll to the bottom of the page and under Rules Associated To The Rule Set, click <span class="bold">Create</span>.</p>
</li>
<li>
<p>Create the following two rules:</p>
<div class="inftblsimple">
<table class="cellalignment1645" title="Can Modify Orders rules" summary="Can Modify Orders rules" dir="ltr">
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><span class="bold">Rule Name</span></td>
<td class="cellalignment1646"><span class="bold">Rule Expression</span></td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><code dir="ltr">Check IP Address</code></td>
<td class="cellalignment1646"><code dir="ltr">DVF.F$CLIENT_IP = '192.0.2.12'</code></td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646">&nbsp;</td>
<td class="cellalignment1646"><code dir="ltr">Check Session User</code></td>
<td class="cellalignment1646"><code dir="ltr">DVF.F$SESSION_USER IN ('EABEL', 'AHUTTON')</code></td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblsimple" -->
<p>For the Check IP Address rule, replace 123.45.67.89 with the IP address for your own computer. In a real-world scenario, you would create an expression that includes all the IP addresses for the users who should be allowed access.</p>
<p>Both of these rules use the default factors Client_IP and Session_User. See <a href="cfgfact.htm#BABIEIJB">"Default Factors"</a> for more information about these factors. If these factors have been removed or modified, you can use the following rule expressions instead:</p>
<ul>
<li>
<p><span class="bold">Check IP Address:</span> <code dir="ltr">UPPER(SYS_CONTEXT('USERENV','IP_ADDRESS')) = '192.0.2.12'</code></p>
</li>
<li>
<p><span class="bold">Check Session User:</span> <code dir="ltr">UPPER(SYS_CONTEXT('USERENV','SESSION_USER')) IN ('EABEL', 'AHUTTON')</code></p>
</li>
</ul>
</li>
<li>
<p>Ensure that the <span class="bold">Status</span> setting for the Can Modify Orders table is set to <span class="bold">Enabled</span> and <span class="bold">Evaluation Options</span> is set to <span class="bold">All True</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CFAHBAHA"></a>
<div id="DVADM70282" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 4: Create the Database Vault Secure Application Role</h3>
<ol>
<li>
<p>In Oracle Database Vault, return to the Administration page.</p>
</li>
<li>
<p>Under Administration, select <span class="bold">Secure Application Roles</span>.</p>
<p>The Secure Application Roles page appears.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>The Create Role page appears.</p>
</li>
<li>
<p>In the <span class="bold">Role</span> box, enter <code dir="ltr">ORDERS_MGMT</code> to name the role.</p>
</li>
<li>
<p>Under Rule Set, select <span class="bold">Can Modify Orders</span>.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
</li>
</ol>
<p>At this stage, the Database Vault secure application role and its associated rule set are created, though the role does not yet have any privileges.</p>
</div>
<!-- class="sect2" -->
<a id="CFABIAIE"></a>
<div id="DVADM70283" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 5: Grant the SELECT Privilege to the Secure Application Role</h3>
<ol>
<li>
<p>In SQL*Plus, connect as user <code dir="ltr">OE</code>.</p>
<pre dir="ltr">
CONNECT OE
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Grant the <code dir="ltr">SELECT</code> privilege to the <code dir="ltr">ORDERS_MGMT</code> Database Vault Secure application role.</p>
<pre dir="ltr">
GRANT SELECT ON ORDERS TO ORDERS_MGMT;
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CFAEFCBA"></a>
<div id="DVADM70284" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 6: Test the Database Vault Secure Application Role</h3>
<ol>
<li id="CFACGFCD">
<p>In SQL*Plus, connect directly to the database as user <code dir="ltr">eabel</code>.</p>
<pre dir="ltr">
CONNECT eabel@orcl
Enter password: <span class="italic">password</span>
</pre>
<p>Replace <code dir="ltr">orcl</code> with the name of your database instance.</p>
</li>
<li>
<p>Set the <code dir="ltr">ORDERS_MGMT</code> role.</p>
<pre dir="ltr">
EXEC DBMS_MACSEC_ROLES.SET_ROLE('ORDERS_MGMT');
</pre>
<p>Typically, you would embed this call in the application that the user logs in to.</p>
</li>
<li>
<p>Select from the <code dir="ltr">OE.ORDERS</code> table.</p>
<pre dir="ltr">
SELECT COUNT(*) FROM OE.ORDERS;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
  COUNT(*)
----------
       105
</pre>
<p>Because user <code dir="ltr">eabel</code> is logging directly into the database from the correct IP address and is listed as a valid session user, she can select from the <code dir="ltr">OE.ORDERS</code> table. If user <code dir="ltr">ahutton</code> logs in to SQL*Plus in the same manner, she also can select from the <code dir="ltr">OE.ORDERS</code> table.</p>
</li>
<li>
<p>Reconnect as user <code dir="ltr">eabel</code> without specifying the database instance, and then try to select from the <code dir="ltr">OE.ORDERS</code> table again.</p>
<pre dir="ltr">
CONNECT eabel
Enter password: <span class="italic">password</span>

EXEC DBMS_MACSEC_ROLES.SET_ROLE('ORDERS_MGMT');
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
Error at line 1: 
<a id="sthref406"></a>ORA-47305: Rule Set Violation on SET ROLE (Can Modfiy Orders)
...
</pre>
<p>Next:</p>
<pre dir="ltr">
SELECT COUNT(*) FROM OE.ORDERS;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ERROR at line 1:
<a id="sthref407"></a>ORA-00942: table or view does not exist
</pre>
<p>Even though user <code dir="ltr">eabel</code> is a valid user, she has violated the Check IP Address rule in the rule set, so she is not granted the <code dir="ltr">ORDERS_MGMT</code> role. The only way for the IP address to be recognized is to connect by specifying the database instance, as user <code dir="ltr">eabel</code> did in Step <a href="#CFACGFCD">1</a>. (For an explanation about how this works, see Step <a href="cfgfact.htm#CIHCJBAH">7</a> in <a href="cfgfact.htm#CIHICACA">"Step 3: Map the Domain Factor Identities to the Client_IP Factor"</a>, in <a href="cfgfact.htm#CIHCDJJA">Chapter 7</a>.)</p>
</li>
<li>
<p>Connect as user <code dir="ltr">ldoran</code> and then enter the following statements:</p>
<pre dir="ltr">
EXEC DBMS_MACSEC_ROLES.SET_ROLE('ORDERS_MGMT');
SELECT COUNT(*) FROM OE.ORDERS;
</pre>
<p>Because user <code dir="ltr">ldoran</code> is not a valid user, she is not granted the <code dir="ltr">ORDERS_MGMT</code> role. Therefore, she cannot select from the <code dir="ltr">OE.ORDERS</code> table.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CFAHCDBG"></a>
<div id="DVADM70285" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Step 7: Remove the Components for This Tutorial</h3>
<ol>
<li>
<p>Log into SQL*Plus as the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> user.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Delete the <code dir="ltr">ORDERS_MGMT</code> secure application role.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.DELETE_ROLE('ORDERS_MGMT');
</pre></li>
<li>
<p>Enter the following commands in the order shown to remove the Can Modify Orders rule set.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('Can Modify Orders', 'Check IP Address');
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('Can Modify Orders', 'Check Session User');
EXEC DBMS_MACADM.DELETE_RULE('Check IP Address');
EXEC DBMS_MACADM.DELETE_RULE('Check Session User');
EXEC DBMS_MACADM.DELETE_RULE_SET('Can Modify Orders');
COMMIT;
</pre></li>
<li>
<p>Connect as the Database Vault Account Manager and drop the users.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

DROP USER eabel;
DROP USER ahutton;
DROP USER ldoran;
</pre></li>
<li>
<p>If uneccessary, lock and expire the <code dir="ltr">OE</code> user account.</p>
<pre dir="ltr">
ALTER USER OE ACCOUNT LOCK PASSWORD EXPIRE;
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDIEIHJ"></a>
<div id="DVADM70286" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">How Secure Application Roles Affect Performance</h2>
<p><a id="sthref408"></a><a id="sthref409"></a>You can check system performance by running tools such as <a id="sthref410"></a>Oracle Enterprise Manager (including <a id="sthref411"></a>Oracle Enterprise Manager Database Control, which is installed by default with Oracle Database), <a id="sthref412"></a><code dir="ltr">Statspack</code>, and <a id="sthref413"></a><code dir="ltr">TKPROF</code>. For more information about Oracle Enterprise Manager, see the Oracle Enterprise Manager documentation set. For information about Database Control, refer to its online Help. <a class="olink PFGRF" href="../e41573/toc.htm"><span class="italic">Oracle Database Performance Tuning Guide</span></a> describes the <code dir="ltr">Statspack</code> and <code dir="ltr">TKPROF</code> utilities.</p>
</div>
<!-- class="sect1" -->
<a id="CFAJBGFA"></a>
<div id="DVADM70287" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Related Reports and Data Dictionary View</h2>
<p><a href="#CFAHGGBJ">Table 8-1</a><a id="sthref414"></a> lists Oracle Database Vault reports that are useful for analyzing Oracle Database Vault secure application roles. See <a href="reports.htm#BABDCICF">Chapter 18, "Oracle Database Vault Reports,"</a> for information about how to run these reports.</p>
<div id="DVADM70288" class="tblhruleformal">
<p class="titleintable"><a id="sthref415"></a><a id="CFAHGGBJ"></a>Table 8-1 Reports Related to Secure Application Roles</p>
<table class="cellalignment1647" title="Reports Related to Secure Application Roles" summary="secure application role reports" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t4">Report</th>
<th class="cellalignment1648" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t4" headers="r1c1-t4">
<p><a href="reports.htm#BABHACCH">"Secure Application Role Audit Report"</a></p>
</td>
<td class="cellalignment1646" headers="r2c1-t4 r1c2-t4">
<p>Lists audit records generated by the Oracle Database Vault secure application role-enabling operation<a id="sthref416"></a>.</p>
<p>To generate this type of audit record, enable auditing for the rule set associated with the role.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t4" headers="r1c1-t4">
<p><a href="reports.htm#BABJAAFD">"Secure Application Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r3c1-t4 r1c2-t4">
<p>Lists secure application roles that have nonexistent database roles, or incomplete or disabled rule sets</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t4" headers="r1c1-t4">
<p><a href="reports.htm#BABGBBFH">"Rule Set Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r4c1-t4 r1c2-t4">
<p>Lists rule sets that have no rules defined or enabled, which may affect the secure application roles that use them</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r5c1-t4" headers="r1c1-t4">
<p><a href="reports.htm#BABEDAAE">"Powerful Database Accounts and Roles Reports"</a></p>
</td>
<td class="cellalignment1646" headers="r5c1-t4 r1c2-t4">
<p>Provides information about powerful database accounts and roles</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p>You <a id="sthref417"></a>can use the <code dir="ltr">DVSYS.DBA_DV_ROLE</code> data dictionary view to find the Oracle Database Vault secure application roles used in privilege management. See <a href="views.htm#BABGFIGC">"DVSYS.DBA_DV_ROLE View"</a> for more information.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1638">
<tr>
<td class="cellalignment1646">
<table class="cellalignment1643">
<tr>
<td class="cellalignment1642"><a href="cfgfact.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1642"><a href="dv_ols.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1650">
<table class="cellalignment1641">
<tr>
<td class="cellalignment1642"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1642"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1642"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1642"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1642"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
