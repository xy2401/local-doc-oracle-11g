<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>DBA Operations in an Oracle Database Vault Environment</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1088" />
<meta name="dcterms.created" content="2016-11-14T16:25:10Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Vault Administrator's Guide" />
<meta name="dcterms.identifier" content="E23090-13" />
<meta name="dcterms.isVersionOf" content="DVADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="dv_ols.htm" title="Previous" type="text/html" />
<link rel="Next" href="db_objects.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e23090.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">17/31</span> <!-- End Header -->
<div id="DVADM71122" class="chapter"><a id="sthref437"></a>
<h1 class="chapter"><span class="secnum">10</span> DBA Operations in an Oracle Database Vault Environment</h1>
<p>This <a id="ABC71712936"></a><a id="ABC71712936SRI1"></a>chapter contains:</p>
<ul>
<li>
<p><a href="#CHDIBHIC">Using Oracle Database Vault with Oracle Enterprise Manager</a></p>
</li>
<li>
<p><a href="#CHDDECIH">Using Oracle Data Pump in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDICCJG">Scheduling Database Jobs in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDBAJEH">Using Oracle Database Vault with Oracle Recovery Manager</a></p>
</li>
<li>
<p><a href="#CHDEAGJF">Using Oracle Streams in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDIEGDG">Using XStream in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDCBBCJ">Using Oracle GoldenGate in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#BABBBEAH">Using Data Masking in an Oracle Database Vault Environment</a></p>
</li>
</ul>
<a id="CHDIBHIC"></a>
<div id="DVADM70289" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle Database Vault with Oracle Enterprise Manager</h2>
<p>This section contains: <a id="ABC71700103"></a></p>
<ul>
<li>
<p><a href="#BABEHCIE">Setting the Database Vault Administrator URL in Oracle Enterprise Manager</a></p>
</li>
<li>
<p><a href="#CHDEEEFH">Propagating Oracle Database Vault Policies to Other Databases</a></p>
</li>
<li>
<p><a href="#CHDFGHHB">Using Enterprise Manager Grid Control Alerts for Oracle Database Vault Policies</a></p>
</li>
<li>
<p><a href="#CHDDIDEA">Using Oracle Database Vault-Specific Reports in Enterprise Manager Grid Control</a></p>
</li>
<li>
<p><a href="#CHDIECHA">Changing the DBSNMP Account Password in an Oracle Database Vault Environment</a></p>
</li>
</ul>
<a id="BABEHCIE"></a>
<div id="DVADM70290" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Setting the Database Vault Administrator URL in Oracle Enterprise Manager</h3>
<p>You <a id="sthref438"></a>can <a id="sthref439"></a>configure Database Control or Grid Control to use a specific Database Vault Administrator URL.</p>
<ol>
<li>
<p>Access Oracle Database Vault Home page from Oracle Enterprise Manager.</p>
<p>See <a href="getting_started.htm#CIHIIJBD">"Accessing the Oracle Database Vault Pages and DVA from Oracle Enterprise Manager"</a>.</p>
<p>If you want to save the Database Vault URL:</p>
<ul>
<li>
<p><span class="bold">For Database Control:</span> Ensure that in addition to being granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role, that you are also an Enterprise Manager administrator.</p>
</li>
<li>
<p><span class="bold">For Grid Control:</span> Ensure that you have been granted the <code dir="ltr">OPERATOR</code> privilege on the target database.</p>
</li>
</ul>
</li>
<li>
<p>Access the Database Vault Administrator URL page.</p>
<p>From the Database Vault Home page, click the <span class="bold">Administration</span> tab, and then under Policy Administration, click the <span class="bold">Launch Database Vault Administrator</span> link.</p>
<p>The Database Vault Administrator URL page appears.</p>
</li>
<li>
<p>In the Database Vault Administrator URL field, enter the Database Vault Administrator URL that you want to use.</p>
<p>For example:</p>
<pre dir="ltr">
https://myserver.us.example.com:1148/dva
</pre></li>
<li>
<p>To test the URL, click the <span class="bold">Launch to test URL</span> button.</p>
</li>
<li>
<p>Click the <span class="bold">Save</span> button.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDEEEFH"></a>
<div id="DVADM08007" class="sect2">
<h3 class="sect2">Propagating Oracle Database Vault Policies to Other Databases</h3>
<p>If you have <a id="sthref440"></a>Oracle Database Vault<a id="sthref441"></a> installed <a id="sthref442"></a>in<a id="sthref443"></a> an <a id="sthref444"></a>Oracle <a id="sthref445"></a>Enterprise Manager Grid Control Release 10.2.0.5 environment, then you can propagate Database Vault policies to other Database Vault-protected databases. Note that you cannot use Grid Control to create Database Vault policies or perform the actions normally provided for in Database Vault Administrator. If you want to perform these functions, then use Database Vault Administrator.</p>
<p>To propagate Database Vault policies to other databases:</p>
<ol>
<li id="CHDGCHAA">
<p>Access Oracle Database Vault Administrator from Oracle Enterprise Manager, and log in to Database Vault as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p>Ensure that you select the database that contains the policies that you want to propagate.</p>
<p>See <a href="getting_started.htm#CIHIIJBD">"Accessing the Oracle Database Vault Pages and DVA from Oracle Enterprise Manager"</a>.</p>
</li>
<li>
<p>From the Database Vault home page, select the <span class="bold">Administration</span> subpage.</p>
</li>
<li>
<p>In the Administration page, under Policy Propagation, select the <span class="bold">Database Vault Policy Propagation</span> link.</p>
<p>The Available Policies area in the Policy Propagation subpage lists a summary of the Oracle Database Vault policies that were created for the database that you selected in Step <a href="#CHDGCHAA">1</a>. From here, you can propagate these policies to another database.</p>
</li>
<li>
<p>Under Available Policies, select each policy that you want to propagate to another database.</p>
<p>By default, all policies are selected.</p>
<img width="998" height="546" src="img/dv_oem.gif" alt="Description of dv_oem.gif follows" /><br />
<a id="sthref446" href="img_text/dv_oem.htm">Description of the illustration ''dv_oem.gif''</a><br />
<br /></li>
<li>
<p>Under Destination Databases, click the <span class="bold">Add</span> button.</p>
<img width="963" height="384" src="img/dv_oem2.gif" alt="Description of dv_oem2.gif follows" /><br />
<a id="sthref447" href="img_text/dv_oem2.htm">Description of the illustration ''dv_oem2.gif''</a><br />
<br /></li>
<li>
<p>Under Search and Select: Database Vault Enabled Destination Databases, search for the destination databases, and then select each database to which you want to propagate the policies. Then click the <span class="bold">Select</span> button.</p>
</li>
<li>
<p>Under Destination Databases, do the following:</p>
<ol>
<li>
<p>Under Apply credentials across destination database(s), enter the user name and password of the administrator of the Database Vault database that contains the policies you want to propagate.</p>
<p>This feature applies the Database Vault administrator's user name and password to all of the selected destination databases.</p>
</li>
<li>
<p>Select each database to which you want to propagate the policies.</p>
</li>
<li>
<p>Enter the Database Vault administrator user name and password for each database.</p>
</li>
<li>
<p>Click the <span class="bold">Apply</span> button.</p>
</li>
</ol>
</li>
<li>
<p>In the Propagate Options page, select from the following options.</p>
<p>Any changes made to the seeded realms, command rules, rule sets, and so on will not be propagated to the destination databases. Only custom-created data are propagated.</p>
<ul>
<li>
<p><span class="bold">Restore on failure:</span> If the policy propagation encounters errors, then the propagation is rolled back. That is, the original policies on the destination database are restored. If you do not select this option, then the policy propagation on the destination database continues and ignores any errors.</p>
</li>
<li>
<p><span class="bold">Skip propagation if user defined policies exist:</span> If the destination databases already have the user-defined policies, then the policy propagation is not attempted. If you do not select this option, then regardless of whether user-defined policies exist on the destination database, all the existing policies are cleared, and the policies from the source database are applied to the destination database.</p>
</li>
<li>
<p><span class="bold">Propagate Enterprise Manager metric thresholds for database vault metrics:</span> If the source database has Oracle Database Vault metric thresholds set, then these thresholds are also propagated to the destination databases. If you do not select this option, then only policies are propagated and not the Oracle Database Vault thresholds.</p>
</li>
</ul>
</li>
<li>
<p>Click the <span class="bold">OK</span> button.</p>
</li>
<li>
<p>In the Confirmation window, click <span class="bold">OK</span>.</p>
<p>A message indicating success or failure appears. If the propagation succeeds, then the policies are active right away in their destination databases.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDFGHHB"></a>
<div id="DVADM70291" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Enterprise Manager Grid Control Alerts for Oracle Database Vault Policies</h3>
<p>Grid Control <a id="sthref448"></a>generates Oracle Database Vault-specific alerts. To view these alerts, you must be granted the <code dir="ltr">DV_OWNER</code>, <code dir="ltr">DV_ADMIN</code>, or <code dir="ltr">DV_SECANALYST</code> role. The alerts are as follows:</p>
<ul>
<li>
<p><span class="bold">Database Vault Attempted Realm Violations.</span> This alert helps the Oracle Database Vault security analyst (<code dir="ltr">DV_SECANALYST</code> role) to monitor violation attempts on the Database Vault database. This user can select the realms to be affected by the alert and filter these realms based on the different types of attempts by using error codes. You can enable this metric from the Metrics and Policy Settings page. By default, the attempted realm violations are collected every 24 hours.</p>
</li>
<li>
<p><span class="bold">Database Vault Attempted Command Rule Violations.</span> The functionality for this alert is the same as for Database Vault Attempted Realm Violations, except that it focuses on violations on command rules.</p>
</li>
<li>
<p><span class="bold">Database Vault Realm Configuration Issues.</span> This metric tracks and raises an alert if users misconfigure realms. This metric is enabled when you install Oracle Database vault, and by default it collects data every one hour.</p>
</li>
<li>
<p><span class="bold">Database Vault Command Rule Configuration Issues.</span> This functionality for this alert is that same as Database Vault Realm Configuration Issues, except that it focuses on configuration changes to command rules.</p>
</li>
<li>
<p><span class="bold">Database Vault Policy Changes.</span> This metric raises an alert on any change to any Database Vault policy, such as policies for realms and command rules. It provides a detailed policy changes report.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDDIDEA"></a>
<div id="DVADM70292" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Oracle Database Vault-Specific Reports in Enterprise Manager Grid Control</h3>
<p>From <a id="sthref449"></a>the Database Vault home page, you can find information about the following types of violations:</p>
<ul>
<li>
<p>Top five attempted violations on realm and command rule</p>
</li>
<li>
<p>Top five attempted violations by database users and client host</p>
</li>
<li>
<p>Time series-based graphical reports on attempted violations for more detailed analysis</p>
</li>
</ul>
<p>To have full access to the Database Vault reports, you must log in to Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code>, <code dir="ltr">DV_ADMIN</code>, or <code dir="ltr">DV_SECANALYST</code> role.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="reports.htm#BABDCICF">Chapter 18, "Oracle Database Vault Reports"</a></div>
</div>
<!-- class="sect2" -->
<a id="CHDIECHA"></a>
<div id="DVADM70293" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Changing the DBSNMP Account Password in an Oracle Database Vault Environment</h3>
<p>Before <a id="sthref450"></a><a id="sthref451"></a><a id="sthref452"></a>you can change the password for the <code dir="ltr">DBSNMP</code> user account, you must revoke the <code dir="ltr">DV_MONITOR</code> role from this account. In an Oracle Database Vault environment, the <code dir="ltr">DBSNMP</code> user account is granted the <code dir="ltr">DV_MONITOR</code> role. (The <code dir="ltr">DBSNMP</code> user can change his or her own password directly, without having to have the <code dir="ltr">DV_MONITOR</code> role revoked first.)</p>
<p>To change the <code dir="ltr">DBSNMP</code> user password:</p>
<ol>
<li>
<p>Log in to SQL*Plus using an account that has been granted the <code dir="ltr">DV_OWNER</code> role.</p>
</li>
<li>
<p>Revoke the <code dir="ltr">DV_MONITOR</code> role from the <code dir="ltr">DBSNMP</code> user account.</p>
</li>
<li>
<p>Connect as a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role and then change the <code dir="ltr">DBSNMP</code> user account password.</p>
</li>
<li>
<p>Connect as the <code dir="ltr">DV_OWNER</code> user and then grant the <code dir="ltr">DV_MONITOR</code> role back to the <code dir="ltr">DBSNMP</code> user account.</p>
</li>
</ol>
<p>Alternatively, you can temporarily disable Oracle Database Vault, log on as a user who has been granted the <code dir="ltr">ALTER USER</code> privilege, and then modify the <code dir="ltr">DBSNMP</code> password. Afterward, re-enable Database Vault. See <a href="dvdisabl.htm#BJEDGGGA">Appendix B, "Disabling and Enabling Oracle&nbsp;Database&nbsp;Vault,"</a> for more information.<a id="sthref453"></a></p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDDECIH"></a>
<div id="DVADM70314" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle Data Pump in an Oracle Database Vault Environment</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CHDHAHFD">About Using Oracle Data Pump in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDGICDC">Granting a Database Administrator Authorization to Use Oracle Data Pump</a></p>
</li>
<li>
<p><a href="#CHDCFBDE">Guidelines for Exporting or Importing Data in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDBGJIA">Revoking Authorization from Databases Administrators Who Are Using Data Pump</a></p>
</li>
</ul>
<a id="CHDHAHFD"></a>
<div id="DVADM70315" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Using Oracle Data Pump in an Oracle Database Vault Environment</h3>
<p>Database administrators<a id="sthref454"></a> who want to use Oracle Data Pump <a id="sthref455"></a>must have Oracle Database Vault-specific authorization, in addition to the standard Oracle Data Pump privileges, if they want to export and import data in an Oracle Database Vault environment. (Note that you cannot use the legacy <code dir="ltr">EXP</code> and <code dir="ltr">IMP</code> utilities if Oracle Database Vault is enabled.) You can check a user's authorizations for using Data Pump in an Oracle Database Vault environment by querying the <code dir="ltr">DVSYS.DBA_DV_DATAPUMP_AUTH</code> data dictionary view.</p>
<p>The level of authorization that you must grant depends on the following scenarios:</p>
<ul>
<li>
<p><span class="bold">Users who import data into another schema must have the BECOME USER system privilege.</span> To find the privileges a user has been granted, query the <code dir="ltr">USER_SYS_PRIVS</code> data dictionary view.</p>
</li>
<li>
<p><span class="bold">A database administrator wants to export or import data in a schema that has no realm protection.</span> In this case, this user only needs the standard Oracle Data Pump privileges, not the Oracle Database Vault authorization.</p>
</li>
<li>
<p><span class="bold">A database administrator wants to export or import data in a protected schema.</span> You must grant this user Database Vault-specific authorization by using the <code dir="ltr">DBMS_MACADM.AUTHORIZE_DATAPUMP_USER</code> procedure. This authorization applies to both the <code dir="ltr">EXPDP</code> and <code dir="ltr">IMPDP</code> utilities. Later on, you can revoke this authorization by using the <code dir="ltr">DBMS_MACADM.UNAUTHORIZE_DATAPUMP_USER</code> procedure.</p>
</li>
<li>
<p><span class="bold">A database administrator wants to export or import the contents of an entire database.</span> In addition to the authorization granted by the <code dir="ltr">DBMS_MACADM.AUTHORIZE_DATAPUMP_USER</code> procedure, you must grant this user the <code dir="ltr">DV_OWNER</code> role. For the import operation, this user must have the <code dir="ltr">BECOME USER</code> privilege.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="views.htm#BACJCFEF">"DVSYS.DBA_DV_DATAPUMP_AUTH View"</a></div>
</div>
<!-- class="sect2" -->
<a id="CHDGICDC"></a>
<div id="DVADM70316" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Granting a Database Administrator Authorization to Use Oracle Data Pump</h3>
<p>To <a id="sthref456"></a>authorize a database administrator to use Data Pump in an Oracle Database Vault environment:</p>
<ol>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
</li>
<li>
<p>Ensure that the user to whom you want to grant authorization has been granted the <code dir="ltr">EXP_FULL_DATABASE</code> and <code dir="ltr">IMP_FULL_DATABASE</code> roles, which are required for using Oracle Data Pump.</p>
<pre dir="ltr">
SELECT GRANTEE, GRANTED_ROLE FROM DBA_ROLE_PRIVS 
 WHERE GRANTED_ROLE LIKE '%FULL%';
</pre></li>
<li>
<p>Grant this user Oracle Database Vault authorization.</p>
<p>For example, to authorize the Data Pump user <code dir="ltr">dp_mgr</code> to export and import objects for an entire database:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.AUTHORIZE_DATAPUMP_USER('dp_mgr');
</pre>
<p>Optionally, you can restrict <code dir="ltr">dp_mgr</code>'s activities to a specific schema or even a table, as shown in the following examples:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.AUTHORIZE_DATAPUMP_USER('DP_MGR', 'HR');

EXEC DBMS_MACADM.AUTHORIZE_DATAPUMP_USER('DP_MGR', 'HR', 'EMPLOYEES');
</pre>
<p>See <a href="apis_dbms_macadm.htm#CACECEBG">"AUTHORIZE_DATAPUMP_USER Procedure"</a> for detailed information about this procedure.</p>
<p>After you run the <code dir="ltr">DBMS_MACADM.AUTHORIZE_DATAPUMP_USER</code> procedure, the authorization is stored as a rule in the Allow Oracle Data Pump Operation rule set, described in <a href="cfrulset.htm#CHDGIFGJ">"Default Rule Sets"</a>. You can refer to this rule set by querying the <code dir="ltr">DVSYS.DBA_DV_RULE_SET</code> view if you want to check the user's authorizations.</p>
</li>
<li id="CHDIEFIB">
<p>If the objects that this user wants to import are associated with other objects that are protected by a realm, then authorize the user to have access to that realm.</p>
<p>For example, suppose user <code dir="ltr">dp_mgr</code> wants to export the <code dir="ltr">SCOTT</code> schema. However, the <code dir="ltr">SCOTT</code> schema is associated with the <code dir="ltr">SYSMAN.AQ$_MGMT_NOTIFY_QTABLE_S</code> table, and the <code dir="ltr">SYSMAN</code> schema is protected by a realm. So, before user <code dir="ltr">dp_mgr</code> can export the <code dir="ltr">SCOTT</code> schema, he must be authorized as follows:</p>
<p>First, ensure that this user is a realm participant. For example:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.ADD_AUTH_TO_REALM(
  realm_name   =&gt; 'SYSMAN Realm', 
  grantee      =&gt; 'DP_MGR', 
  auth_options =&gt; DBMS_MACUTL.G_REALM_AUTH_PARTICIPANT);
END;
/
</pre>
<p>Next, run the following procedure to authorize the user for Oracle Data Pump operations:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.AUTHORIZE_DATAPUMP_USER('DP_MGR','SYSMAN'); 
</pre></li>
<li>
<p>If the user must export the entire database, then grant the user the <code dir="ltr">DV_OWNER</code> role.</p>
<pre dir="ltr">
GRANT DV_OWNER TO dp_mgr;
</pre></li>
<li>
<p>Ensure that the Allow Oracle Data Pump Operation rule set has been enabled by querying the <code dir="ltr">DVSYS.DBA_DV_RULE_SET</code> data dictionary view as follows:</p>
<pre dir="ltr">
SELECT ENABLED FROM DVSYS.DBA_DV_RULE_SET 
 WHERE RULE_SET_NAME = 'Allow Oracle Data Pump Operation'; 
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDCFBDE"></a>
<div id="DVADM70317" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Guidelines for Exporting or Importing Data in an Oracle Database Vault Environment</h3>
<p>After you have granted the database administrator who is using Data Pump the necessary authorization, <a id="sthref457"></a>this user is ready to perform any export or import operations that are necessary. Before this user begins work, he or she should follow these guidelines:</p>
<ul>
<li>
<p><span class="bold">Create a full backup of the database datafiles.</span> This way, if you or other users do not like the newly-imported data, you easily can revert the database to its previous state. This guideline is especially useful if an intruder had managed to modify Data Pump exported data to use his or her own policies.</p>
</li>
<li>
<p><span class="bold">Decide how to handle exporting and importing multiple schemas or tables.</span> You cannot specify multiple schemas or tables in the <code dir="ltr">DBMS_MACADM.AUTHORIZE_DATAPUMP_USER</code> procedure, but you can use either of the following methods to accomplish this task:</p>
<ul>
<li>
<p>Run individual <code dir="ltr">DBMS_MACADM.AUTHORIZE_DATAPUMP_USER</code> procedures for each schema or table, and then specify the list of these objects in the <code dir="ltr">SCHEMAS</code> or <code dir="ltr">TABLES</code> parameter of the <code dir="ltr">expdp</code> and <code dir="ltr">impdp</code> utilities.</p>
</li>
<li>
<p>Perform a full database export or import operation. If so, see the next guideline.</p>
</li>
</ul>
</li>
<li>
<p><span class="bold">When performing an export or import operation for an entire database, set the expdp or impdp FULL option to Y.</span> Remember that this setting will capture the <code dir="ltr">DVSYS</code> schema, so ensure that the user has been granted the <code dir="ltr">DV_OWNER</code> role. For detailed information about Oracle Data Pump, see <a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a>.</p>
</li>
<li>
<p><span class="bold">You cannot use the legacy EXP and IMP utilities with the direct path option (direct=y) if Oracle Database Vault is enabled.</span></p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDBGJIA"></a>
<div id="DVADM70318" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Revoking Authorization from Databases Administrators Who Are Using Data Pump</h3>
<p>To <a id="sthref458"></a>revoke authorization from the database administrator who is using Data Pump:</p>
<ol>
<li>
<p>If you granted the user the <code dir="ltr">DV_OWNER</code> role, optionally revoke this role.</p>
<pre dir="ltr">
REVOKE DV_OWNER FROM dp_mgr;
</pre></li>
<li id="CHDCIIFB">
<p>Query the <code dir="ltr">DVSYS.DBA_DV_RULE_SET</code> data dictionary view and then make a note of the user's authorizations that have been defined in the Allow Oracle Data Pump Operation rule set.</p>
<pre dir="ltr">
SELECT RULE_EXPR FROM DVSYS.DBA_DV_RULE_SET_RULE
 WHERE RULE_SET_NAME = 'Allow Oracle Data Pump Operation';
</pre>
<p>For example, if you had authorized user <code dir="ltr">dp_mgr</code> to perform export and import operations on the entire database, a rule defining this authorization appears in the list of rule expressions in the Allow Oracle Data Pump Operation rule set.</p>
</li>
<li>
<p>Use the information you gathered from Step <a href="#CHDCIIFB">2</a> to build the <code dir="ltr">DBMS_MACADM.UNAUTHORIZE_DATAPUMP_USER</code> command.</p>
<p>For example:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.UNAUTHORIZE_DATAPUMP_USER('DP_MGR');
</pre>
<p>Ensure that this unauthorization complements the original authorization action. In other words, if you originally gave <code dir="ltr">dp_mgr</code> authorization over the entire database, then the following commands will not work:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.UNAUTHORIZE_DATAPUMP_USER('DP_MGR', 'HR');

EXEC DBMS_MACADM.UNAUTHORIZE_DATAPUMP_USER('DP_MGR', 'HR', 'EMPLOYEES');
</pre>
<p>See <a href="apis_dbms_macadm.htm#CACEEHCF">"UNAUTHORIZE_DATAPUMP_USER Procedure"</a> for more information.</p>
</li>
<li>
<p>If you needed to make the user a realm participant (for example, to access the <code dir="ltr">SYSMAN.AQ$_MGMT_NOTIFY_QTABLE_S</code> table objects, as described in Step <a href="#CHDIEFIB">4</a> under <a href="#CHDGICDC">"Granting a Database Administrator Authorization to Use Oracle Data Pump"</a>), then remove the realm authorization for this user.</p>
<p>For example:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.DELETE_AUTH_FROM_REALM(
  realm_name =&gt; 'SYSMAN Realm',
  grantee    =&gt; 'DP_MGR');
END;
/
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDICCJG"></a>
<div id="DVADM70319" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Scheduling Database Jobs in an Oracle Database Vault Environment</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#CHDHDJIJ">About Scheduling Database Jobs in an Oracle Database Vault Environment</a></p>
</li>
<li>
<p><a href="#CHDIGDJB">Granting a Job Scheduling Administrator Authorization for Oracle Database Vault</a></p>
</li>
<li>
<p><a href="#CHDJGBAC">Revoking Authorization from Job Scheduling Administrators</a></p>
</li>
</ul>
<a id="CHDHDJIJ"></a>
<div id="DVADM70320" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Scheduling Database Jobs in an Oracle Database Vault Environment</h3>
<p>Users <a id="sthref459"></a>who are responsible<a id="sthref460"></a> for scheduling database jobs must have Oracle Database Vault-specific administration, in addition to the standard system privileges required for scheduling database jobs.</p>
<p>The level of authorization that you must grant depends on the following scenarios:</p>
<ul>
<li>
<p><span class="bold">An administrator wants to schedule a job in his or her own schema.</span> An administrator who has been granted privileges to schedule database jobs can continue to do so without any Oracle Database Vault-specific authorizations, unless this schema is protected by a realm. In that case, ensure that this user is authorized to access the realm. See <a href="cfrealms.htm#CHDHDGGD">"Defining Realm Authorization"</a> for instructions on granting a user realm authorization.</p>
</li>
<li>
<p><span class="bold">An administrator wants to run a job in another schema, but this job does not access any Oracle Database Vault realm or command rule protected object.</span> In this case, this user only needs job related system privileges, not the Oracle Database Vault privileges.</p>
</li>
<li>
<p><span class="bold">An administrator wants to run a job under the schema of another user, including any schema in the database or a remote database.</span> If this job accesses an Oracle Database Vault realm or command rule protected object, then you must grant this user Database Vault-specific authorization by using the <code dir="ltr">DBMS_MACADM.AUTHORIZE_SCHEDULER_USER</code> procedure. This authorization applies to both background and foreground jobs. For background jobs, the authorization applies to the last user who created or modified the job. In addition, ensure that the schema owner (the protected schema in which the job is created) authorized to the realm.</p>
<p>Later on, you can revoke this authorization by using the <code dir="ltr">DBMS_MACADM.UNAUTHORIZE_SCHEDULER_USER</code> procedure. If the schema is not protected by a realm, then you do not need to run the <code dir="ltr">DBMS_MACADM.AUTHORIZE_SCHEDULER_USER</code> procedure for the user.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CHDIGDJB"></a>
<div id="DVADM70321" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Granting a Job Scheduling Administrator Authorization for Oracle Database Vault</h3>
<p>To <a id="sthref461"></a>authorize a user to schedule database jobs:</p>
<ol>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p>Only a user who has been granted either of these roles can grant the necessary authorization.</p>
</li>
<li id="CHDCIACI">
<p>Ensure that the user to whom you want to grant authorization has been granted system privileges to schedule database jobs.</p>
<p>These privileges include any of the following: <code dir="ltr">CREATE JOB</code>, <code dir="ltr">CREATE ANY JOB</code>, <code dir="ltr">CREATE EXTERNAL JOB</code>, <code dir="ltr">EXECUTE ANY PROGRAM</code>, <code dir="ltr">EXECUTE ANY CLASS</code>, <code dir="ltr">MANAGE SCHEDULER</code>. The <code dir="ltr">DBA</code> and <code dir="ltr">SCHEDULER_ADMIN</code> roles provide these privileges; however, when Oracle Database Vault is enabled, the privileges are revoked from these roles.</p>
<p>For example:</p>
<pre dir="ltr">
SELECT GRANTEE, PRIVILEGE FROM DBA_SYS_PRIVS 
 WHERE PRIVILEGE IN ('CREATE JOB', 'CREATE ANY JOB');
</pre></li>
<li>
<p>Grant this user Oracle Database Vault authorization.</p>
<p>For example, to authorize the user <code dir="ltr">job_mgr</code> to schedule jobs for any schema in the database:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.AUTHORIZE_SCHEDULER_USER('JOB_MGR');
</pre>
<p>Optionally, you can restrict <code dir="ltr">job_mgr</code>'s activities to a specific schema, as follows:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.AUTHORIZE_SCHEDULER_USER('JOB_MGR', 'HR');
</pre>
<p>See <a href="apis_dbms_macadm.htm#CACFDIFH">"AUTHORIZE_SCHEDULER_USER Procedure"</a> for detailed information about this procedure.</p>
<p>After you run the <code dir="ltr">DBMS_MACADM.AUTHORIZE_SCHEDULER_USER</code> procedure, the authorization is stored as a rule in the Allow Scheduler Job rule set, described in <a href="cfrulset.htm#CHDGIFGJ">"Default Rule Sets"</a>. You can refer to this rule set by querying the <code dir="ltr">DVSYS.DBA_DV_RULE_SET</code> view if you want to check the user's authorizations.</p>
</li>
<li>
<p>Ensure that the user has been authorized by querying the <code dir="ltr">DVSYS.DBA_DV_JOB_AUTH</code> data dictionary view as follows:</p>
<pre dir="ltr">
SELECT GRANTEE,OBJECT_OWNER FROM DVSYS.DBA_DV_JOB_AUTH 
WHERE GRANTEE = '<span class="italic">user_name</span>';
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDJGBAC"></a>
<div id="DVADM70322" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Revoking Authorization from Job Scheduling Administrators</h3>
<p>To <a id="sthref462"></a>revoke authorization from a user for scheduling database jobs.</p>
<ol>
<li id="CHDJEBIH">
<p>Query the <code dir="ltr">DVSYS.DBA_DV_JOB_AUTH</code> data dictionary view and then make a note of the user's authorizations that have been defined in the Allow Scheduler Job rule set.</p>
<pre dir="ltr">
SELECT GRANTEE FROM DVSYS.DBA_DV_JOB_AUTH;
</pre>
<p>For example, if you had authorized user <code dir="ltr">job_mgr</code> to perform schedule database jobs for the entire database, a rule defining this authorization appears in the list of rule expressions in the Allow Scheduler Job rule set.</p>
</li>
<li>
<p>Use the information you gathered from Step <a href="#CHDJEBIH">1</a> to build the <code dir="ltr">DBMS_MACADM.UNAUTHORIZE_SCHEDULER_USER</code> command.</p>
<p>For example:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.UNAUTHORIZE_SCHEDULER_USER('JOB_MGR');
</pre>
<p>Ensure that this unauthorization complements the original authorization action. In other words, if you originally gave <code dir="ltr">job_mgr</code> authorization over the entire database, then the following command will not work:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.UNAUTHORIZE_SCHEDULER_USER('JOB_MGR', 'HR');
</pre>
<p>See <a href="apis_dbms_macadm.htm#CACGIDFG">"UNAUTHORIZE_SCHEDULER_USER Procedure"</a> for more information.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDBAJEH"></a>
<div id="DVADM70323" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle Database Vault with Oracle Recovery Manager</h2>
<p>You can use <a id="sthref463"></a>Recovery Manager (RMAN) in an Oracle Database Vault environment. The functionality of RMAN with Oracle Database Vault is the same as its functionality in a standard Oracle Database environment.</p>
<p>For more information about RMAN, see the following documentation:</p>
<ul>
<li>
<p><a class="olink BRADV" href="../../backup.112/e10642/toc.htm"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a></p>
</li>
<li>
<p><a class="olink RCMRF" href="../../backup.112/e10643/toc.htm"><span class="italic">Oracle Database Backup and Recovery Reference</span></a></p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDEAGJF"></a>
<div id="DVADM70324" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle Streams in an Oracle Database Vault Environment</h2>
<p>If you want <a id="sthref464"></a>to use Oracle Streams in an Oracle Database Vault environment, then you must have the following privileges:</p>
<ul>
<li>
<p>You must be granted the <code dir="ltr">DV_STREAMS_ADMIN</code> role in order to configure the Oracle Streams capture process. See <a href="db_objects.htm#BABIFJBJ">"DV_STREAMS_ADMIN Oracle Streams Configuration Role"</a> for more information.</p>
</li>
<li>
<p>Before you can apply changes to any tables that are protected by a realm, you must be authorized to have access to that realm. For example:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.ADD_AUTH_TO_REALM('<span class="italic">realm_name</span>','<span class="italic">username</span>');
</pre>
<p>See <a href="apis_dbms_macadm.htm#BCFHJJAE">"ADD_AUTH_TO_REALM Procedure"</a> for more information about the <code dir="ltr">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDIEGDG"></a>
<div id="DVADM71141" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using XStream in an Oracle Database Vault Environment</h2>
<p>If you <a id="sthref465"></a>want to use XStream in an Oracle Database Vault environment, then you must have the following privileges:</p>
<ul>
<li>
<p>You must be granted the <code dir="ltr">DV_XSTREAM_ADMIN</code> role in order to configure the XStream. See <a href="db_objects.htm#BABBIFHJ">"DV_XSTREAM_ADMIN XStream Administrative Role"</a> for more information.</p>
</li>
<li>
<p>Before you can apply changes to any tables that are protected by a realm, you must be authorized to have access to that realm. For example:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.ADD_AUTH_TO_REALM('<span class="italic">realm_name</span>','<span class="italic">username</span>');
</pre>
<p>See <a href="apis_dbms_macadm.htm#BCFHJJAE">"ADD_AUTH_TO_REALM Procedure"</a> for more information about the <code dir="ltr">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CHDCBBCJ"></a>
<div id="DVADM71142" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Oracle GoldenGate in an Oracle Database Vault Environment</h2>
<p>If you <a id="sthref466"></a>want to use Oracle GoldenGate in an Oracle Database Vault environment, then you must have the following privileges:</p>
<ul>
<li>
<p>You must be granted the <code dir="ltr">DV_GOLDENGATE_ADMIN</code> role in order to configure the Oracle GoldenGate. See <a href="db_objects.htm#BABHHDFF">"DV_GOLDENGATE_ADMIN Oracle GoldenGate Administrative Role"</a> for more information.</p>
</li>
<li>
<p>You must be granted the <code dir="ltr">DV_GOLDENGATE_REDO_ACCESS</code> role if you want to use the Oracle GoldenGate <code dir="ltr">TRANLOGOPTIONS DBLOGREADER</code> method to access redo logs. See <a href="db_objects.htm#BABGFJGH">"DV_GOLDENGATE_REDO_ACCESS Oracle GoldenGate Redo Log Access Role"</a> for more information.</p>
</li>
<li>
<p>Before you can apply changes to any tables that are protected by a realm, you must be authorized to have access to that realm. For example:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.ADD_AUTH_TO_REALM('<span class="italic">realm_name</span>','<span class="italic">username</span>');
</pre>
<p>See <a href="apis_dbms_macadm.htm#BCFHJJAE">"ADD_AUTH_TO_REALM Procedure"</a> for more information about the <code dir="ltr">DBMS_MACADM.ADD_AUTH_TO_REALM</code> procedure.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="BABBBEAH"></a>
<div id="DVADM71123" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Data Masking in an Oracle Database Vault Environment</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABGBJAF">About Data Masking in an Oracle Database Vault Enabled Database</a></p>
</li>
<li>
<p><a href="#BABCFEGD">Adding Data Masking Users to the Data Dictionary Realm Authorizations</a></p>
</li>
<li>
<p><a href="#BABJDFGJ">Giving Users Access to Tables or Schemas That They Want to Mask</a></p>
</li>
<li>
<p><a href="#BABJADCG">Creating a Command Rule to Enable Data Masking Privileges</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink RATUG04000" href="../../server.112/e41481/tdm_data_masking.htm#RATUG04000"><span class="italic">Oracle Database Real Application Testing User's Guide</span></a> for more information about data masking</div>
<a id="BABGBJAF"></a>
<div id="DVADM71124" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Data Masking in an Oracle Database Vault Enabled Database</h3>
<p>In <a id="sthref467"></a>an Oracle Database Vault-enabled database, only users who have Database Vault authorizations can mask data in Database Vault-protected database objects. In a non-Database Vault environment, users who have been granted the <code dir="ltr">SELECT_CATALOG_ROLE</code> and <code dir="ltr">DBA</code> roles can perform data masking. However, with Database Vault, users must have additional privileges. This section describes three ways that you can use to enable users to mask data in Database Vault-protected objects.</p>
<p>If <a id="sthref468"></a>users do not have the correct privileges, then the following errors can occur while creating the masking definition or when the job is executing:</p>
<pre dir="ltr">
<a id="sthref469"></a>ORA-47400: Command Rule violation for string on string 

<a id="sthref470"></a>ORA-47401: Realm violation for string on string. 

<a id="sthref471"></a>ORA-47408: Realm violation for the EXECUTE command 

<a id="sthref472"></a>ORA-47409: Command Rule violation for the EXECUTE command 

<a id="sthref473"></a>ORA-01301: insufficient privileges
</pre></div>
<!-- class="sect2" -->
<a id="BABCFEGD"></a>
<div id="DVADM71125" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Adding Data Masking Users to the Data Dictionary Realm Authorizations</h3>
<p>The <a id="sthref474"></a>Oracle Data Dictionary controls access to the Oracle Database catalog schemas, such as <code dir="ltr">SYS</code> and <code dir="ltr">SYSTEM</code>. (See <a href="cfrealms.htm#CHDFBGJB">"Default Realms"</a> for a full list of these schemas.) It also controls the ability to grant system privileges and database administrator roles. If you add users to the Data Dictionary realm, and assuming these users already have the privileges associated with the Oracle Data Dictionary, then these users will have these same privileges in a Database Vault environment. Therefore, if you do add a user to this realm, ensure that this user is a trusted user.</p>
<p>For example:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.ADD_AUTH_TO_REALM(
  realm_name   =&gt; 'Data Dictionary Realm', 
  grantee      =&gt; 'DBA_JSMITH', 
  auth_options =&gt; DBMS_MACUTL.G_REALM_AUTH_PARTICIPANT);
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="BABJDFGJ"></a>
<div id="DVADM71126" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Giving Users Access to Tables or Schemas That They Want to Mask</h3>
<p>If t<a id="sthref475"></a>he <a id="sthref476"></a>table or schema of a table that is to be data masked is in a realm, then you must add the user responsible for data masking to the realm authorization as a participant or owner. If the table or schema has dependent objects that are in other realm-protected tables, then you must grant the user participant or owner authorization for those realms as well.</p>
<p>The following example shows how to grant user <code dir="ltr">DBA_JSMITH</code> authorization for the <code dir="ltr">HR.EMPLOYEES</code> table, which is protected by a realm called Business Apps Realm:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.ADD_AUTH_TO_REALM(
  realm_name   =&gt; 'Business Apps Realm', 
  grantee      =&gt; 'DBA_JSMITH', 
  auth_options =&gt; DBMS_MACUTL.G_REALM_AUTH_PARTICIPANT;
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="BABJADCG"></a>
<div id="DVADM71127" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Creating a Command Rule to Enable Data Masking Privileges</h3>
<p>For data masking, users must have the <code dir="ltr">CREATE TABLE</code>, <code dir="ltr">SELECT TABLE</code>, <code dir="ltr">ALTER TABLE</code>, and <code dir="ltr">DROP TABLE</code> privileges for the masking objects and if there are any dependent objects to be created, the user must have the appropriate privileges such as <code dir="ltr">CREATE PACKAGE</code>, <code dir="ltr">CREATE TRIGGER</code>, and so on.</p>
<p>You <a id="sthref477"></a>can <a id="sthref478"></a>create command rules to control data masking privileges at a granular level. To do so, create a command rule that can either prevent or allow the user access to objects that must have to be data masked. For example, you can create a command rule called Allow Data Masking that checks if the user is in a list of users who are responsible for data masking. If the user logging in is one of these users, then the command rule evaluates to true and the user is permitted to create the data mask for the protected object.</p>
<p>To create this type of command rule:</p>
<ol>
<li>
<p>Create the rule set rule.</p>
<p>For example:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.CREATE_RULE(
  rule_name  =&gt; 'Is HDRISCOLL or DBA_JSMITH User', 
  rule_expr  =&gt;'USER IN(''HDRISCOLL'',''DBA_JSMITH'')';
END;
/
</pre></li>
<li>
<p>Create a rule set and then add the rule to it:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.CREATE_RULE_SET(
  rule_set_name    =&gt; 'Allow Data Masking', 
  description      =&gt; 'Allows users HDRISCOLL and DBA_JSMITH access', 
  enabled          =&gt; 'Y',
  eval_options     =&gt; 1,
  audit_options    =&gt; 1,
  fail_options     =&gt; 1,
  fail_message     =&gt; 'You do not have access to this object.',
  fail_code        =&gt; 20461,
  handler_options  =&gt; 0, 
  is_static        =&gt; TRUE);
END;
/
BEGIN
 DBMS_MACADM.ADD_RULE_TO_RULE_SET(
  rule_set_name =&gt; 'Allow Data Masking', 
  rule_name     =&gt; 'Is HDRISCOLL or DBA_JSMITH User'),
  rule_order    =&gt; 1);
END;
/
</pre></li>
<li>
<p>Create a command rule and then add this rule to it:</p>
<pre dir="ltr">
BEGIN
 DBMS_MACADM.CREATE_COMMAND_RULE(
  command         =&gt; 'CREATE TABLE', 
  rule_set_name   =&gt; 'Allow Data Masking', 
  object_owner    =&gt; 'HR', 
  object_name     =&gt; 'EMPLOYEES', 
  enabled         =&gt; DBMS_MACUTL.G_YES);
END; 
/
</pre></li>
</ol>
<p><a id="sthref479"></a><a id="sthref480"></a></p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1638">
<tr>
<td class="cellalignment1646">
<table class="cellalignment1643">
<tr>
<td class="cellalignment1642"><a href="dv_ols.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1642"><a href="db_objects.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1650">
<table class="cellalignment1641">
<tr>
<td class="cellalignment1642"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1642"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1642"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1642"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1642"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
