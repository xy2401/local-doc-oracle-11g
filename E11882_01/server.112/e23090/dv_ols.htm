<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Integrating Oracle Database Vault with Other&nbsp;Oracle Products</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1088" />
<meta name="dcterms.created" content="2016-11-14T16:25:10Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Vault Administrator's Guide" />
<meta name="dcterms.identifier" content="E23090-13" />
<meta name="dcterms.isVersionOf" content="DVADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="cfseappr.htm" title="Previous" type="text/html" />
<link rel="Next" href="dba.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e23090.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">16/31</span> <!-- End Header -->
<div id="DVADM008" class="chapter"><a id="BEIFHIGI"></a>
<h1 class="chapter"><span class="secnum">9</span> Integrating Oracle Database Vault with Other&nbsp;Oracle Products</h1>
<p><a id="sthref418"></a>This chapter contains:</p>
<ul>
<li>
<p><a href="#CHDDGJBI">Integrating Oracle Database Vault with Enterprise User Security</a></p>
</li>
<li>
<p><a href="#CHDHJBHC">Integrating Oracle Database Vault with Transparent Data Encryption</a></p>
</li>
<li>
<p><a href="#CHDCAFBG">Attaching Factors to an Oracle Virtual Private Database</a></p>
</li>
<li>
<p><a href="#CHDHJIFJ">Integrating Oracle Database Vault with Oracle Label Security</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you plan to use <a id="sthref419"></a>Oracle Data Guard with Oracle Database Vault, see My Oracle Support Note 754065.1. You can access My Oracle Support from the following Web site:
<p><a href="https://support.oracle.com"><code dir="ltr">https://support.oracle.com"&gt;&gt;https://support.oracle.com</code></a></p>
</div>
<a id="CHDDGJBI"></a>
<div id="DVADM70294" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Integrating Oracle Database Vault with Enterprise User Security</h2>
<p><a id="sthref420"></a>You can integrate Oracle Database Vault with Oracle Enterprise User Security. Enterprise User Security enables you to centrally manage database users and authorizations in one place. It is combined with Oracle Identity Management and is available in Oracle Database Enterprise Edition.</p>
<p>In general, to integrate Oracle Database Vault with Oracle Enterprise User Security, you configure the appropriate realms to protect the data that you want to protect in the database.</p>
<p>After you define the Oracle Database Vault roles as needed, you can create a rule set for the Enterprise users to allow or disallow their access.</p>
<p>To configure an Enterprise User authorization:</p>
<ol>
<li>
<p>Create a rule to allow or disallow user access.</p>
<p>Follow the instructions in <a href="cfrulset.htm#CHDGIFCE">"Creating a Rule to Add to a Rule Set"</a> to create a new rule. In the Create Rule page, enter the following PL/SQL in the Rule Expression field:</p>
<pre dir="ltr">
SYS_CONTEXT('USERENV','AUTHENTICATED_IDENTITY') = <span class="italic">'user_domain_name'</span>
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">user_domain_name</span></code> with the domain, for example:</p>
<pre dir="ltr">
SYS_CONTEXT('USERENV','AUTHENTICATED_IDENTITY') = 'myserver.us.example.com<span class="italic">'</span>
</pre></li>
<li id="CHDICFCJ">
<p>Add this rule to a new rule set.</p>
<p><a href="cfrulset.htm#CHDDBAJI">"Creating a Rule Set"</a> explains how to create a new rule set, including how to add an existing rule to it.</p>
</li>
<li>
<p>Add this rule set to the realm authorization for the database that you want to protect.</p>
<p><a href="cfrealms.htm#CHDHDGGD">"Defining Realm Authorization"</a> explains how to create realm authorizations. In the Authorization Rule Set list, select the rule set that you created in Step <a href="#CHDICFCJ">2</a>. Afterward, the realm authorization applies to all users.</p>
</li>
</ol>
<p>For more information about Enterprise User Security, see <a class="olink DBIMI" href="../../network.112/e10744/toc.htm"><span class="italic">Oracle Database Enterprise User Security Administrator's Guide</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDHJBHC"></a>
<div id="DVADM70295" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Integrating Oracle Database Vault with Transparent Data Encryption</h2>
<p>Transparent <a id="sthref421"></a>Data Encryption complements Oracle Database Vault in that it provides data protection when the data leaves the secure perimeter of the database. With Transparent Data Encryption, a database administrator or database security administrator can simply encrypt columns with sensitive content in application tables, or encrypt entire application tablespaces, without any modification to the application. For detailed information about Transparent Data Encryption, see <a class="olink ASOAG600" href="../../network.112/e40393/asotrans.htm#ASOAG600"><span class="italic">Oracle Database Advanced Security Administrator's Guide</span></a>.</p>
<p>If a user passes the authentication and authorization checks, Transparent Data Encryption automatically encrypts and decrypts information for the user. This way, you can implement encryption without having to change your applications.</p>
<p>Before you can use Oracle Database Vault with Transparent Data Encryption, you must enable the <code dir="ltr">SYSTEM</code> user (or other user with privileges to manage Transparent Data Encryption) as at minimum a participant of the Database Dictionary Realm. See <a href="apis_dbms_macadm.htm#BCFHJJAE">"ADD_AUTH_TO_REALM Procedure"</a> for more information about adding a user to a realm.</p>
<p>Once you have granted the Transparent Data Encryption user the appropriate privileges, then Transparent Data Encryption can be managed as usual and be used complimentary to Database Vault.</p>
<p><a href="#CHDGFECH">Figure 9-1</a> shows how Oracle Database Vault realms handle encrypted data.</p>
<div id="DVADM70296" class="figure">
<p class="titleinfigure"><a id="CHDGFECH"></a>Figure 9-1 Encrypted Data and Oracle Database Vault</p>
<img width="521" height="224" src="img/tde.gif" alt="Description of Figure 9-1 follows" /><br />
<a id="sthref422" href="img_text/tde.htm">Description of ''Figure 9-1 Encrypted Data and Oracle Database Vault''</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="CHDCAFBG"></a>
<div id="DVADM70297" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Attaching Factors to an Oracle Virtual Private Database</h2>
<p><a id="sthref423"></a><a id="sthref424"></a>You can attach factors to an Oracle Virtual Private Database. To do so, define a policy predicate that is a PL/SQL function or expression. Then, for each function or expression, you can use the <code dir="ltr">DVF.F$</code> PL/SQL function that is created for each factor.</p>
<p>For more information about Oracle Virtual Private Database, see <a class="olink DBSEG007" href="../../network.112/e36292/vpd.htm#DBSEG007"><span class="italic">Oracle Database Security Guide</span></a>.</p>
</div>
<!-- class="sect1" -->
<a id="CHDHJIFJ"></a>
<div id="DVADM70298" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Integrating Oracle Database Vault with Oracle Label Security</h2>
<p>This section includes the following topics:</p>
<ul>
<li>
<p><a href="#BEIBEEFB">How Oracle Database Vault Is Integrated with Oracle Label Security</a></p>
</li>
<li>
<p><a href="#BEIGACIJ">Requirements for Using Oracle Database Vault with Oracle Label Security</a></p>
</li>
<li>
<p><a href="#BEIGHIHA">Using Oracle Database Vault Factors with Oracle Label Security Policies</a></p>
</li>
<li>
<p><a href="#BEIHAJCG">Tutorial: Integrating Oracle Database Vault with Oracle Label Security</a></p>
</li>
<li>
<p><a href="#CHDJJGAB">Related Reports and Data Dictionary Views</a></p>
</li>
</ul>
<a id="BEIBEEFB"></a>
<div id="DVADM70299" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">How Oracle Database Vault Is Integrated with Oracle Label Security</h3>
<p><a id="sthref425"></a>When you integrate Oracle Database Vault with Oracle Label Security, it means that you can assign an Oracle Label Security label to an Oracle Database Vault factor identity.</p>
<p>In Oracle Label Security, you can restrict access to records in database tables or PL/SQL programs. For example, Mary may be able to see data protected by the HIGHLY SENSITIVE label, an Oracle Label Security label on the <code dir="ltr">EMPLOYEE</code> table that includes records that should have access limited to certain managers. Another label can be PUBLIC, which allows more open access to this data.</p>
<p>In Oracle Database Vault, you can create a factor called Network, for the network on which the database session originates, with the following identities:</p>
<ul>
<li>
<p><span class="bold">Intranet:</span> Used for when an employee is working on site within the intranet for your company.</p>
</li>
<li>
<p><span class="bold">Remote:</span> Used for when the employee is working at home from a VPN connection.</p>
</li>
</ul>
<p>You then assign a maximum session label to both. For example:</p>
<ul>
<li>
<p>Assign the Intranet identity to the HIGHLY SENSITIVE Oracle Label Security label.</p>
</li>
<li>
<p>Assign the Remote identity to the PUBLIC label.</p>
</li>
</ul>
<p>This means that when Mary is working at home using her VPN connection, she has access only to the limited table data protected under the PUBLIC identity. But when she is in the office, she has access to the HIGHLY SENSITIVE data, because she is using the Intranet identity. <a href="#BEIHAJCG">"Tutorial: Integrating Oracle Database Vault with Oracle Label Security"</a> provides an example of how to accomplish this type of integration.</p>
<p>You can audit the integration with Oracle Label Security by using the Label Security Integration Audit Report. See <a href="reports.htm#BABJBECC">"Label Security Integration Audit Report"</a> for more information. Oracle Database Vault writes the audit trail to the <code dir="ltr">DVSYS.AUDIT_TRAIL$</code> system file, described in <a href="audplcy.htm#BGBFCEGE">Appendix A, "Auditing Oracle Database Vault."</a></p>
<p>You can use the Oracle Database Vault APIs to integrate Oracle Database Vault with Oracle Label Security. See <a href="apis_dbms_macadm.htm#CHDHHDGI">Chapter 12, "Using the DBMS_MACADM Package,"</a> for more information.</p>
<p>For more information about Oracle Label Security labels, levels, and policies, see <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a>.</p>
<p>You can run reports on the Oracle Database Vault and Oracle Label Security integration. See <a href="#CHDJJGAB">"Related Reports and Data Dictionary Views"</a> for more information.</p>
</div>
<!-- class="sect2" -->
<a id="BEIGACIJ"></a>
<div id="DVADM70300" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Requirements for Using Oracle Database Vault with Oracle Label Security</h3>
<p>You<a id="sthref426"></a> must have the following requirements in place before you use Oracle Database Vault with Oracle Label Security:</p>
<ul>
<li>
<p>Oracle Label Security is licensed separately. Ensure that you have purchased a license to use it.</p>
</li>
<li>
<p>Before you install Oracle Database Vault, you must have already installed Oracle Label Security.</p>
</li>
<li>
<p>The installation process for Oracle Label Security creates the <code dir="ltr">LBACSYS</code> user account. As a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role, unlock this account and grant it a new password. For example:</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

ALTER USER LBACSYS ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">password</span></code> with a password that is secure. See <a class="olink DBSEG33223" href="../../network.112/e36292/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</li>
<li>
<p>If you plan to use the <code dir="ltr">LBACSYS</code> user account in Oracle Enterprise Manager, then log in to Enterprise Manager as user <code dir="ltr">SYS</code> with the <code dir="ltr">SYSDBA</code> privilege, and grant this user the <code dir="ltr">SELECT ANY DICTIONARY</code> and <code dir="ltr">SELECT_CATALOG_ROLE</code> system privileges.</p>
</li>
<li>
<p>Ensure that you have the appropriate Oracle Label Security policies defined. For more information, see <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a>.</p>
</li>
<li>
<p>If you plan to integrate an Oracle Label Security policy with a Database Vault policy, then ensure that the policy name for Oracle Label Security is less than 24 characters. You can check the names of Oracle Label Security policies by querying the <code dir="ltr">POLICY_NAME</code> column of the <code dir="ltr">ALL_SA_POLICIES</code> data dictionary view.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BEIGHIHA"></a>
<div id="DVADM70301" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Using Oracle Database Vault Factors with Oracle Label Security Policies</h3>
<p><a id="sthref427"></a>Oracle Database Vault controls the maximum security clearance for a database session by merging the maximum allowable data for each label in a database session by merging the labels of Oracle Database Vault factors that are associated to an Oracle Label Security policy. In brief, a label acts as an identifier for the access privileges of a database table row. A policy is a name associated with the labels, rules, and authorizations that govern access to table rows. See <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a> for more information about row labels and policies.</p>
<p>Use the following steps to define factors that contribute to the maximum allowable data label of an Oracle Label Security policy:</p>
<ol>
<li>
<p>Log in to Oracle Database Vault Administrator as a user who has been granted the <code dir="ltr">DV_OWNER</code> or <code dir="ltr">DV_ADMIN</code> role.</p>
<p><a href="getting_started.htm#BABJHBBF">"Starting Oracle Database Vault"</a> explains how to log in.</p>
</li>
<li>
<p>Make the user <code dir="ltr"><a id="sthref428"></a>LBACSYS</code> account an owner of the realm that contains the schema to which a label security policy has been applied.</p>
<p>This enables the <code dir="ltr">LBACSYS</code> account to have access to all the protected data in the realm, so that it can properly classify the data.</p>
<p>The <code dir="ltr">LBACSYS</code> account is created in Oracle Label Security using the Oracle Universal Installer custom installation option. Before you can create an Oracle Label Security policy for use with Oracle Database Vault, you must make <code dir="ltr">LBACSYS</code> an owner for the realm you plan to use. See <a href="cfrealms.htm#CHDHDGGD">"Defining Realm Authorization"</a> for more information.</p>
</li>
<li>
<p>Authorize the schema owner (on which the label security policy has been applied) as either a realm participant or a realm owner.</p>
</li>
<li>
<p>In the Administration page, under Database Vault Feature Administration, click <span class="bold">Label Security Integration</span>.</p>
</li>
<li>
<p>In the Label Security Policies page:</p>
<ul>
<li>
<p>To register a new label security policy, click <span class="bold">Create</span>.</p>
</li>
<li>
<p>To edit an existing label security policy, select it from the list and then click <span class="bold">Edit</span>.</p>
</li>
</ul>
</li>
<li>
<p>Enter the following settings and then click <span class="bold">OK</span>:</p>
<ul>
<li>
<p><a href="#BEIHAGEG">General</a></p>
</li>
<li>
<p><a href="#BEICFCJI">Label Security Policy Factors</a></p>
</li>
</ul>
</li>
</ol>
<p class="subhead2"><a id="BEIHAGEG"></a><a id="DVADM70302"></a>General</p>
<p>Under General, enter the following settings:</p>
<ul>
<li>
<p><span class="bold">Label Security Policy:</span> From the list, select the Oracle Label Security policy that you want to use.</p>
</li>
<li>
<p><span class="bold">Algorithm:</span> Optionally change the label-merging algorithm for cases when Oracle Label Security has merged two labels. In most cases, you may want to select <span class="bold">LII - Minimum Level/Intersection/Intersection</span>. This setting is the most commonly used method that Oracle Label Security administrators use when they want to merge two labels. This setting provides optimum flexibility when your applications must determine the resulting label that is required when combining two data sets that have different labels. It is also necessary for situations in which you must perform queries using joins on rows with different data labels.</p>
<p>For more information on these label-merging algorithms, see <a class="olink OLSAG" href="../../network.112/e10745/toc.htm"><span class="italic">Oracle Label Security Administrator's Guide</span></a>. If you want to use the <code dir="ltr">DBMS_MACADM</code> package to specify a merge algorithm, see <a href="apis_dbms_macadm.htm#BCFCADEE">Table 12-57, "Oracle Label Security Merge Algorithm Codes"</a> for a full listing of possible merge algorithms.</p>
</li>
<li>
<p><span class="bold">Label for Initialization Errors:</span> Optionally enter a label for initialization errors. The label specified for initialization errors is set when a configuration error or run-time error occurs during session initialization. You can use this setting to assign the session a data label that prevents access or updates to any data the policy protects until the issue is resolved.</p>
</li>
</ul>
<p class="subhead2"><a id="BEICFCJI"></a><a id="DVADM70303"></a>Label Security Policy Factors</p>
<p>To select a factor to associate with an Oracle Label Security policy:</p>
<ol>
<li>
<p>In the <span class="bold">Available Factors</span> list under Label Security Policy Factors, select the factor that you want to associate with the Oracle Label Security policy.</p>
</li>
<li>
<p>Click <span class="bold">Move</span> to move the factor to the <span class="bold">Selected Factors</span> list.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can select multiple factors by holding down the <span class="bold">Ctrl</span> key as you click each factor that you want to select.</div>
</li>
</ol>
<p>After you associate a factor with an Oracle Label Security policy, you can label the factor identities using the labels for the policy. <a href="cfgfact.htm#BABFJCHH">"Adding an Identity to a Factor"</a> provides detailed information.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you do not associate an Oracle Label Security policy with factors, then Oracle Database Vault maintains the default Oracle Label Security behavior for the policy.</div>
</div>
<!-- class="sect2" -->
<a id="BEIHAJCG"></a>
<div id="DVADM70304" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Tutorial: Integrating Oracle Database Vault with Oracle Label Security</h3>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABCBBAB">About This Tutorial</a></p>
</li>
<li>
<p><a href="#CHDJEJEJ">Step 1: Create Users for This Tutorial</a></p>
</li>
<li>
<p><a href="#CHDBIFAJ">Step 2: Create the Oracle Label Security Policy</a></p>
</li>
<li>
<p><a href="#CHDIEDBA">Step 3: Create Oracle Database Vault Rules to Control the OLS Authorization</a></p>
</li>
<li>
<p><a href="#CHDJAEAC">Step 4: Update the ALTER SYSTEM Command Rule to Use the Rule Set</a></p>
</li>
<li>
<p><a href="#CHDIDDJG">Step 5: Test the Authorizations</a></p>
</li>
<li>
<p><a href="#CHDHDDGI">Step 6: Remove the Components for This Tutorial</a></p>
</li>
</ul>
<a id="BABCBBAB"></a>
<div id="DVADM71121" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">About This Tutorial</h4>
<p>You <a id="sthref429"></a><a id="sthref430"></a>can <a id="sthref431"></a>use <a id="sthref432"></a>Oracle Database Vault factors with Oracle Label Security and Oracle Virtual Private Database (VPD) technology to restrict access to sensitive data. You can restrict this data so that it is only exposed to a database session when the correct combination of factors exists, defined by the security administrator, for any given database session.</p>
<p>This tutorial shows how you can integrate Oracle Database Vault with Oracle Label Security to grant two administrative users who normally have the same privileges different levels of access.</p>
</div>
<!-- class="sect3" -->
<a id="CHDJEJEJ"></a>
<div id="DVADM70305" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 1: Create Users for This Tutorial</h4>
<ol>
<li>
<p>Log in to SQL*Plus as a user who has been granted the <code dir="ltr">DV_ACCTMGR</code> role.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Create the following users:</p>
<pre dir="ltr">
CREATE USER mdale IDENTIFIED BY <span class="italic">password</span>;
CREATE USER jsmith IDENTIFIED BY <span class="italic">password</span>;
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">password</span></code> with a password that is secure. See <a class="olink DBSEG33223" href="../../network.112/e36292/authentication.htm#DBSEG33223"><span class="italic">Oracle Database Security Guide</span></a> for the minimum requirements for creating passwords.</p>
</li>
<li>
<p>Connect as user <code dir="ltr">SYS</code> with the <code dir="ltr">SYSDBA</code> privilege and then grant administrative privileges to users <code dir="ltr">mdale</code> and <code dir="ltr">jsmith</code>.</p>
<pre dir="ltr">
CONNECT SYS AS SYSDBA
Enter password: <span class="italic">password</span>

GRANT CREATE SESSION, DBA TO mdale, jsmith;
</pre>
<p>At this stage, users <code dir="ltr">mdale</code> and <code dir="ltr">jsmith</code> have identical administrative privileges.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDBIFAJ"></a>
<div id="DVADM70306" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 2: Create the Oracle Label Security Policy</h4>
<ol>
<li>
<p>In SQL*Plus, connect as the Oracle Label Security administrator, <code dir="ltr">LBACSYS</code>.</p>
<pre dir="ltr">
CONNECT LBACSYS
Enter password: <span class="italic">password</span>
</pre>
<p>If user <code dir="ltr">LBACSYS</code> is locked and expired, connect as the Database Vault Account Manager, unlock and unexpire the <code dir="ltr">LBACSYS</code> account, and then log back in as <code dir="ltr">LBACSYS</code>.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

ALTER USER LBACSYS ACCOUNT UNLOCK IDENTIFIED BY <span class="italic">password</span>;

CONNECT LBACSYS
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Create a new Oracle Label Security policy:</p>
<pre dir="ltr">
EXEC SA_SYSDBA.CREATE_POLICY('PRIVACY','PRIVACY_COLUMN','NO_CONTROL');
</pre></li>
<li>
<p>Create the following levels for the <code dir="ltr">PRIVACY</code> policy:</p>
<pre dir="ltr">
EXEC SA_COMPONENTS.CREATE_LEVEL('PRIVACY',2000,'S','SENSITIVE');
EXEC SA_COMPONENTS.CREATE_LEVEL('PRIVACY',1000,'C','CONFIDENTIAL');
</pre></li>
<li>
<p>Create the PII compartment.</p>
<pre dir="ltr">
EXEC SA_COMPONENTS.CREATE_COMPARTMENT('PRIVACY',100,'PII','PERS_INFO');
</pre></li>
<li>
<p>Grant users <code dir="ltr">mdale</code> and <code dir="ltr">jsmith</code> the following labels:</p>
<pre dir="ltr">
EXEC SA_USER_ADMIN.SET_USER_LABELS('PRIVACY','mdale','S:PII');
EXEC SA_USER_ADMIN.SET_USER_LABELS('PRIVACY','jsmith','C'); 
</pre>
<p>User <code dir="ltr">mdale</code> is granted the more sensitive label, Sensitive, which includes the PII compartment. User <code dir="ltr">jsmith</code> gets the Confidential label, which is less sensitive.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDIEDBA"></a>
<div id="DVADM70307" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 3: Create Oracle Database Vault Rules to Control the OLS Authorization</h4>
<ol>
<li>
<p>Connect to SQL*Plus as the Database Vault Owner.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Create the following rule set:</p>
<pre dir="ltr">
EXEC DBMS_MACADM.CREATE_RULE_SET('PII Rule Set',
 'Protect PII data from privileged users','Y',1,0,2,NULL,NULL,0,NULL);
</pre></li>
<li>
<p>Create a rule for the PII Rule Set.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.CREATE_RULE('Check OLS Factor', 
 'dominates(sa_utl.numeric_label(''PRIVACY''), 
  char_to_label(''PRIVACY'',''S:PII'')) = ''1''');
</pre>
<p>Ensure that you use single quotes, as shown in this example, and not double quotes.</p>
</li>
<li>
<p>Add the Check OLS Factor rule to the PII Rule Set.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.ADD_RULE_TO_RULE_SET('PII Rule Set', 
 'Check OLS Factor');
</pre></li>
<li>
<p>Synchronize the Check OLS factor rule.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.SYNC_RULES;
COMMIT;
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDJAEAC"></a>
<div id="DVADM70308" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 4: Update the ALTER SYSTEM Command Rule to Use the Rule Set</h4>
<ol>
<li>
<p>As the Database Vault Owner, check the current value of the ALTER SYSTEM command rule, which is one of the default command rules when you install Oracle Database Vault.</p>
<pre dir="ltr">
SELECT * FROM DVSYS.DBA_DV_COMMAND_RULE WHERE COMMAND = 'ALTER SYSTEM';
</pre></li>
<li>
<p>Make a note of these settings so that you can revert them to their original values later on.</p>
<p>In a default installation, the ALTER SYSTEM command rule uses the Allow System Parameters rule set, has no object owner or name, and is enabled.</p>
</li>
<li>
<p>Update the ALTER SYSTEM command rule to include the PII Rule Set.</p>
<pre dir="ltr">
EXEC DBMS_MACADM.UPDATE_COMMAND_RULE('ALTER SYSTEM', 'PII Rule Set', '%', '%', 'Y');
</pre>
<p>This command adds the PII Rule Set to the ALTER SYSTEM command rule, applies it to all object owners and object names, and enables the command rule.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDIDDJG"></a>
<div id="DVADM70309" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 5: Test the Authorizations</h4>
<ol>
<li>
<p>In SQL*Plus, log on as user <code dir="ltr">mdale</code>.</p>
<pre dir="ltr">
CONNECT mdale
Enter password: <span class="italic">password</span>
</pre></li>
<li>
<p>Check the current setting for the <code dir="ltr">AUDIT_TRAIL</code> initialization parameter.</p>
<pre dir="ltr">
SHOW PARAMETER AUDIT_TRAIL

NAME                                 TYPE        VALUE
------------------------------------ ----------- ----------------------
audit_trail                          string      DB
</pre>
<p>Make a note of this setting, so that you can revert it to its original setting later on.</p>
</li>
<li>
<p>As user <code dir="ltr">mdale</code>, use the <code dir="ltr">ALTER SYSTEM</code> statement to modify the <code dir="ltr">AUDIT_TRAIL</code> parameter.</p>
<pre dir="ltr">
ALTER SYSTEM SET AUDIT_TRAIL=OS, EXTENDED SCOPE=SPFILE;
System altered.
</pre>
<p>Because user <code dir="ltr">mdale</code> was assigned the Sensitive label with the PII compartment, he can use the <code dir="ltr">ALTER SYSTEM</code> statement to modify the <code dir="ltr">AUDIT_TRAIL</code> system parameter.</p>
</li>
<li>
<p>Set the <code dir="ltr">AUDIT_TRAIL</code> parameter back to its original value, for example:</p>
<pre dir="ltr">
ALTER SYSTEM SET AUDIT_TRAIL=DB, EXTENDED SCOPE=SPFILE;
</pre></li>
<li>
<p>Log in as user <code dir="ltr">jsmith</code> and then issue the same <code dir="ltr">ALTER SYSTEM</code> statement:</p>
<pre dir="ltr">
CONNECT jsmith
Enter password: <span class="italic">password</span>

ALTER SYSTEM SET AUDIT_TRAIL=OS, EXTENDED SCOPE=SPFILE;
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ERROR at line 1:
ORA-01031: insufficient privileges
</pre>
<p>Because user <code dir="ltr">jsmith</code> was assigned only the Confidential label, he cannot perform the <code dir="ltr">ALTER SYSTEM</code> statement.</p>
</li>
<li>
<p>Now log in as user <code dir="ltr">SYSTEM</code>, who normally has the <code dir="ltr">ALTER SYSTEM</code> privilege, and issue the same <code dir="ltr">ALTER SYSTEM</code> statement:</p>
<pre dir="ltr">
CONNECT SYSTEM
Enter password: <span class="italic">password</span>
</pre>
<p>The following output should appear:</p>
<pre dir="ltr">
ERROR at line 1:
ORA-01031: insufficient privileges
</pre>
<p><code dir="ltr">SYSTEM</code> no longer has sufficient privileges needed to perform an <code dir="ltr">ALTER SYSTEM</code> statement. Only users who have been assigned the Sensitive label, as with user <code dir="ltr">mdale</code>, can use the <code dir="ltr">ALTER SYSTEM</code> statement.</p>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="CHDHDDGI"></a>
<div id="DVADM70310" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Step 6: Remove the Components for This Tutorial</h4>
<ol>
<li>
<p>Connect as the Oracle Label Security administrator and remove the label policy and its components.</p>
<pre dir="ltr">
CONNECT LBACSYS
Enter password: <span class="italic">password</span>

EXEC SA_SYSDBA.DROP_POLICY('PRIVACY', TRUE);
</pre></li>
<li>
<p>Connect as the Oracle Database Vault Owner and issue the following commands in the order shown, to set the ALTER SYSTEM command rule back to its previous setting and remove the rule set.</p>
<p>For example:</p>
<pre dir="ltr">
CONNECT lbrown_dvowner
Enter password: <span class="italic">password</span>

EXEC DBMS_MACADM.UPDATE_COMMAND_RULE('ALTER SYSTEM', 'Allow System Parameters','%', '%', 'Y');
EXEC DBMS_MACADM.DELETE_RULE_FROM_RULE_SET('PII Rule Set', 'Check OLS Factor');
EXEC DBMS_MACADM.DELETE_RULE('Check OLS Factor');
EXEC DBMS_MACADM.DELETE_RULE_SET('PII Rule Set');
COMMIT;
</pre></li>
<li>
<p>Connect as the Database Vault Account Manager and remove users <code dir="ltr">mdale</code> and <code dir="ltr">jsmith</code>.</p>
<pre dir="ltr">
CONNECT amalcolm_dvacctmgr
Enter password: <span class="italic">password</span>

DROP USER mdale;
DROP USER jsmith;
</pre></li>
</ol>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDJJGAB"></a>
<div id="DVADM70311" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Related Reports and Data Dictionary Views</h3>
<p><a href="#CHDEAICG">Table 9-1</a> lists <a id="sthref433"></a>Oracle Database Vault reports that are useful for analyzing the integration of Oracle Database Vault and Oracle Label Security. See <a href="reports.htm#BABDCICF">Chapter 18, "Oracle Database Vault Reports,"</a> for information about how to run these reports.</p>
<div id="DVADM70312" class="tblhruleformal">
<p class="titleintable"><a id="sthref434"></a><a id="CHDEAICG"></a>Table 9-1 Reports Related to Database Vault and Oracle Label Security Integration</p>
<table class="cellalignment1647" title="Reports Related to Database Vault and Oracle Label Security Integration" summary="DV and OLS integration reports" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t5">Report</th>
<th class="cellalignment1648" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t5" headers="r1c1-t5">
<p><a href="reports.htm#BABDEFIG">"Factor Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r2c1-t5 r1c2-t5">
<p>Lists factors in which the Oracle Label Security policy does not exist.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t5" headers="r1c1-t5">
<p><a href="reports.htm#BABHJACH">"Identity Configuration Issues Report"</a></p>
</td>
<td class="cellalignment1646" headers="r3c1-t5 r1c2-t5">
<p>Lists invalid label identities (the Oracle Label Security label for this identity has been removed and no longer exists).</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t5" headers="r1c1-t5">
<p><a href="reports.htm#BABFHGGF">"Security Policy Exemption Report"</a></p>
</td>
<td class="cellalignment1646" headers="r4c1-t5 r1c2-t5">
<p>Lists accounts and roles that have the <code dir="ltr">EXEMPT ACCESS POLICY</code> system privilege granted to them. Accounts that have this privilege can bypass all Virtual Private Database policy filters and any Oracle Label Security policies that use Oracle Virtual Private Database indirectly.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" -->
<p><a href="#CHDIHAGG">Table 9-2</a> lists <a id="sthref435"></a>data dictionary views that provide information about existing Oracle Label Security policies used with Oracle Database Vault.</p>
<div id="DVADM70313" class="tblhruleformal">
<p class="titleintable"><a id="sthref436"></a><a id="CHDIHAGG"></a>Table 9-2 Data Dictionary Views Used for Oracle Label Security</p>
<table class="cellalignment1647" title="Data Dictionary Views Used for Oracle Label Security" summary="Oracle Label Security Data Dictionary Views" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t6">Data Dictionary View</th>
<th class="cellalignment1648" id="r1c2-t6">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t6" headers="r1c1-t6">
<p><a href="views.htm#BABIHCJA">"DVSYS.DBA_DV_MAC_POLICY View"</a></p>
</td>
<td class="cellalignment1646" headers="r2c1-t6 r1c2-t6">
<p>Lists the Oracle Label Security policies defined</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t6" headers="r1c1-t6">
<p><a href="views.htm#BABJCCEB">"DVSYS.DBA_DV_MAC_POLICY_FACTOR View"</a></p>
</td>
<td class="cellalignment1646" headers="r3c1-t6 r1c2-t6">
<p>Lists the factors that are associated with Oracle Label Security policies</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t6" headers="r1c1-t6">
<p><a href="views.htm#BABHCAGA">"DVSYS.DBA_DV_POLICY_LABEL View"</a></p>
</td>
<td class="cellalignment1646" headers="r4c1-t6 r1c2-t6">
<p>Lists the Oracle Label Security label for each factor identifier in the <code dir="ltr">DVSYS.DBA_DV_IDENTITY</code> view for each policy</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1638">
<tr>
<td class="cellalignment1646">
<table class="cellalignment1643">
<tr>
<td class="cellalignment1642"><a href="cfseappr.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1642"><a href="dba.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1650">
<table class="cellalignment1641">
<tr>
<td class="cellalignment1642"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1642"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1642"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1642"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1642"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
