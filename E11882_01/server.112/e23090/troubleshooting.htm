<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Troubleshooting Oracle Database Vault</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1088" />
<meta name="dcterms.created" content="2016-11-14T16:25:11Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Vault Administrator's Guide" />
<meta name="dcterms.identifier" content="E23090-13" />
<meta name="dcterms.isVersionOf" content="DVADM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="guidelines.htm" title="Previous" type="text/html" />
<link rel="Next" href="index.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e23090.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">30/31</span> <!-- End Header -->
<div id="DVADM017" class="appendix"><a id="CHDHDIHA"></a>
<h1 class="appendix"><span class="secnum">E</span> Troubleshooting Oracle Database Vault</h1>
<p>This appendix contains:</p>
<ul>
<li>
<p><a href="#CEGICEEE">Using Trace Files to Diagnose Events in the Database</a></p>
</li>
<li>
<p><a href="#CEGHEDIE">General Diagnostic Tips</a></p>
</li>
<li>
<p><a href="#CEGHCAIH">Configuration Problems with Oracle Database Vault Components</a></p>
</li>
</ul>
<a id="CEGICEEE"></a>
<div id="DVADM71111" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Using Trace Files to Diagnose Events in the Database</h2>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABBFCCA">About Using Trace Files to Diagnose Oracle Database Vault Events</a></p>
</li>
<li>
<p><a href="#BABCFAII">Types of Oracle Database Vault Trace Events That You Can and Cannot Track</a></p>
</li>
<li>
<p><a href="#BABIFAEB">Levels of Oracle Database Vault Trace Events</a></p>
</li>
<li>
<p><a href="#BABJJGHE">Performance Effect of Enabling Oracle Database Vault Trace Files</a></p>
</li>
<li>
<p><a href="#BABIHEHJ">Enabling Oracle Database Vault Trace Events</a></p>
</li>
<li>
<p><a href="#BABIJBFC">Finding Oracle Database Vault Trace File Data</a></p>
</li>
<li>
<p><a href="#BABCADCI">Examples Oracle Database Vault Trace Files</a></p>
</li>
<li>
<p><a href="#BABEJEEJ">Disabling Oracle Database Vault Trace Events</a></p>
</li>
</ul>
<a id="BABBFCCA"></a>
<div id="DVADM71357" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">About Using Trace Files to Diagnose Oracle Database Vault Events</h3>
<p>You<a id="sthref1449"></a> can monitor the<a id="sthref1450"></a><a id="sthref1451"></a><a id="sthref1452"></a> Oracle Database Vault database instance for server and background process events by enabling and checking the database instance <a id="sthref1453"></a>trace files. Trace files reveal the Oracle Database Vault policy authorization success and failures. They are useful for providing information to help resolve bug and other issues that may occur.</p>
<p>To set tracing for Oracle Database Vault, you must have the <code dir="ltr">DV_ADMIN</code> role. To perform the configuration, you use either of the <code dir="ltr">ALTER SESSION SET EVENTS</code> or <code dir="ltr">ALTER SYSTEM SET EVENTS</code> SQL statements.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN11243" href="../../server.112/e25494/monitoring.htm#ADMIN11243"><span class="italic">Oracle Database Administrator's Guide</span></a> for more information about how to manage trace files</div>
</div>
<!-- class="sect2" -->
<a id="BABCFAII"></a>
<div id="DVADM71358" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Types of Oracle Database Vault Trace Events That You Can and Cannot Track</h3>
<p><a href="#BABEGDHE">Table E-1</a> describes<a id="sthref1454"></a> the types of activities that you can track with trace files.</p>
<div id="DVADM71359" class="tblhruleformal">
<p class="titleintable"><a id="sthref1455"></a><a id="BABEGDHE"></a>Table E-1 Contents of Oracle Database Vault Trace Files</p>
<table class="cellalignment1647" title="Contents of Oracle Database Vault Trace Files" summary="DV Trace Event Categories" dir="ltr">
<thead>
<tr class="cellalignment1639">
<th class="cellalignment1648" id="r1c1-t3">Database Vault Feature</th>
<th class="cellalignment1648" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r2c1-t3" headers="r1c1-t3">
<p>Realm authorizations</p>
</td>
<td class="cellalignment1646" headers="r2c1-t3 r1c2-t3">
<p>The trace file tracks cases of realm authorization with a rule set and realm authorization to a role. See <a href="#BABCADCI">"Examples Oracle Database Vault Trace Files"</a> for examples of this type of trace file.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r3c1-t3" headers="r1c1-t3">
<p>Rule set evaluations</p>
</td>
<td class="cellalignment1646" headers="r3c1-t3 r1c2-t3">
<p>The trace file includes information about a rule set evaluation from a realm authorization, for a command rule, the CONNECT command rule, and from a factor.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r4c1-t3" headers="r1c1-t3">
<p>Oracle Data Pump authorization</p>
</td>
<td class="cellalignment1646" headers="r4c1-t3 r1c2-t3">
<p>The trace file includes Database Vault Data Pump authorization results and other user, object, and SQL text information.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r5c1-t3" headers="r1c1-t3">
<p>Oracle Scheduler job authorization</p>
</td>
<td class="cellalignment1646" headers="r5c1-t3 r1c2-t3">
<p>The trace file includes the Database Vault Oracle Scheduler job authorization results, job name, job owner, current statement, and so on.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r6c1-t3" headers="r1c1-t3">
<p>Object privilege bypass</p>
</td>
<td class="cellalignment1646" headers="r6c1-t3 r1c2-t3">
<p>The trace file tracks both direct grants and grants through a role. This type of trace is useful for cases where mandatory realms are not enabled, which enables users who have an object privilege to access realm protected objects.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r7c1-t3" headers="r1c1-t3">
<p>Factor loading</p>
</td>
<td class="cellalignment1646" headers="r7c1-t3 r1c2-t3">
<p>The trace file tracks the expression and value for each factor loaded.</p>
</td>
</tr>
<tr class="cellalignment1639">
<td class="cellalignment1646" id="r8c1-t3" headers="r1c1-t3">
<p>Others</p>
</td>
<td class="cellalignment1646" headers="r8c1-t3 r1c2-t3">
<p>Object owner bypassed realm protection and other Database Vault failed and succeeded operations</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect2" -->
<a id="BABIFAEB"></a>
<div id="DVADM71360" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Levels of Oracle Database Vault Trace Events</h3>
<p>You<a id="sthref1456"></a> can use the following levels for Oracle Database Vault trace events:</p>
<ul>
<li>
<p><span class="bold">Low</span> prints the information for all failed Oracle Database Vault authorizations to a trace file. This type of trace file includes failed realm authorizations, failed factor loading, failed rule set evaluating, and so on. It has a low impact on Oracle Database performance.</p>
</li>
<li>
<p><span class="bold">High</span> prints trace records that include both successful and failed authorizations. Because this type of tracing tracks all the authorizations, the overhead is larger than that of the low level tracing. In addition, the trace files are usually larger.</p>
</li>
<li>
<p><span class="bold">Highest</span> prints the PL/SQL stack and function call stack to a trace file, as well as what is traced at level high (as described in <a href="#BABEGDHE">Table E-1</a>). It has the highest impact on Oracle Database performance.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="BABJJGHE"></a>
<div id="DVADM71361" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Performance Effect of Enabling Oracle Database Vault Trace Files</h3>
<p>Be careful <a id="sthref1457"></a>about enabling trace files. Doing so can increase the overhead of the database instance operation, which could decrease performance.</p>
</div>
<!-- class="sect2" -->
<a id="BABIHEHJ"></a>
<div id="DVADM71362" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Enabling Oracle Database Vault Trace Events</h3>
<p>This <a id="sthref1458"></a>section contains:</p>
<ul>
<li>
<p><a href="#BABFCDEJ">Enabling Trace Events for the Current Database Session</a></p>
</li>
<li>
<p><a href="#BABFIHGD">Enabling Trace Events for All Database Sessions</a></p>
</li>
</ul>
<a id="BABFCDEJ"></a>
<div id="DVADM71363" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Enabling Trace Events for the Current Database Session</h4>
<ol>
<li>
<p>Log<a id="sthref1459"></a> into the database instance as a user who has been granted the <code dir="ltr">DV_ADMIN</code> role and the <code dir="ltr">ALTER SESSION</code> system privilege.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus lbrown_dvowner
Enter password: <span class="italic">password</span>
Connected.
</pre></li>
<li id="BABJBCEG">
<p>Enter the <code dir="ltr">ALTER SESSION SET EVENTS</code> SQL statement to set the tracing to low, high, or highest, as described in <a href="#BABIFAEB">"Levels of Oracle Database Vault Trace Events"</a>.</p>
<ul>
<li>
<p>To turn on tracing for failed operations that have a low impact, enter one of the following statements:</p>
<pre dir="ltr">
ALTER SESSION SET EVENTS 'TRACE[DV] DISK=LOW';

ALTER SESSION SET EVENTS '47998 TRACE NAME CONTEXT FOREVER, LEVEL 1';
</pre></li>
<li>
<p>To turn on tracing for both failed and successful operations that have a high impact, enter one of the following statements:</p>
<pre dir="ltr">
ALTER SESSION SET EVENTS 'TRACE[DV] DISK=HIGH';

ALTER SESSION SET EVENTS '47998 TRACE NAME CONTEXT FOREVER, LEVEL 3';
</pre></li>
<li>
<p>To turn on tracing for both failed and successful operations with a function and PL/SQL call stack that has the highest impact, enter one of the following statements:</p>
<pre dir="ltr">
ALTER SESSION SET EVENTS 'TRACE[DV] DISK=HIGHEST';

ALTER SESSION SET EVENTS '47998 TRACE NAME CONTEXT FOREVER, LEVEL 4';
</pre></li>
</ul>
</li>
</ol>
</div>
<!-- class="sect3" -->
<a id="BABFIHGD"></a>
<div id="DVADM71364" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Enabling Trace Events for All Database Sessions</h4>
<ol>
<li>
<p>Log<a id="sthref1460"></a> into the database instance as a user who has been granted the <code dir="ltr">DV_ADMIN</code> role and the <code dir="ltr">ALTER SYSTEM</code> system privilege.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus lbrown_dvowner
Enter password: <span class="italic">password</span>
Connected.
</pre></li>
<li>
<p>Enter the <code dir="ltr">ALTER SYSTEM SET EVENTS</code> SQL statement, using the syntax that is shown in Step <a href="#BABJBCEG">2</a> in <a href="#BABFCDEJ">"Enabling Trace Events for the Current Database Session"</a>.</p>
<p>For example:</p>
<pre dir="ltr">
ALTER SYSTEM SET EVENTS 'TRACE[DV] DISK=LOW';
</pre></li>
<li>
<p>Restart the database.</p>
<p>For example:</p>
<pre dir="ltr">
SHUTDOWN IMMEDIATE
STARTUP
</pre></li>
</ol>
<p>Another way that you can enable trace events for all database sessions is to add the following line to the <code dir="ltr">init.ora</code> file, and then restart the database:</p>
<pre dir="ltr">
event="47998 trace name context forever, level [<span class="italic">trace_level</span>]"
</pre>
<p>Replace <code dir="ltr"><span class="codeinlineitalic">trace_level</span></code> with one of the following values:</p>
<ul>
<li>
<p><code dir="ltr">1</code> for the lowest level of tracing</p>
</li>
<li>
<p><code dir="ltr">3</code> for the high level</p>
</li>
<li>
<p><code dir="ltr">4</code> for the highest level</p>
</li>
</ul>
<p>For example:</p>
<pre dir="ltr">
event="47998 trace name context forever, level [1]"
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABIJBFC"></a>
<div id="DVADM71365" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Finding Oracle Database Vault Trace File Data</h3>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABHADJI">Finding the Database Vault Trace File Directory Location</a></p>
</li>
<li>
<p><a href="#BABCJBJG">Using the Linux grep Command to Search Trace Files for Strings</a></p>
</li>
<li>
<p><a href="#BABFEAJC">Using the ADR Command Interpreter (ADRCI) Utility to QueryTrace Files</a></p>
</li>
</ul>
<a id="BABHADJI"></a>
<div id="DVADM71366" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Finding the Database Vault Trace File Directory Location</h4>
<p>You<a id="sthref1461"></a> can find the full <a id="sthref1462"></a>directory location of trace files by querying the <code dir="ltr">V$DIAG_INFO</code> dynamic view.</p>
<p>For example:</p>
<pre dir="ltr">
SELECT VALUE FROM V$DIAG_INFO WHERE NAME = 'Default Trace File';

VALUE
--------------------------------------------------------------------------------
/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_7174.trc
</pre></div>
<!-- class="sect3" -->
<a id="BABCJBJG"></a>
<div id="DVADM71367" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using the Linux grep Command to Search Trace Files for Strings</h4>
<p>To <a id="sthref1463"></a>query or process the trace files, you can use the Linux <code dir="ltr">grep</code> command to search for strings. For example, to find the trace files that show realm authorization failures, enter the following command:</p>
<pre dir="ltr">
grep 'Result=Realm Authorization Failed'  *.trc
</pre></div>
<!-- class="sect3" -->
<a id="BABFEAJC"></a>
<div id="DVADM71368" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Using the ADR Command Interpreter (ADRCI) Utility to QueryTrace Files</h4>
<p>Another <a id="sthref1464"></a>way to query trace files is to use the <a id="sthref1465"></a><a id="sthref1466"></a>ADR Command Interpreter (<code dir="ltr">ADRCI</code>) command-line utility. For example, to use <code dir="ltr">ADRCI</code> to find the trace files, enter the <code dir="ltr">SHOW TRACEFILE</code> command:</p>
<pre dir="ltr">
adrci <span class="italic">--To start ACRCI from the command line</span>
adrci&gt; show tracefile

diag/rdbms/orcl/orcl/trace/orcl_m002_14551.trc
diag/rdbms/orcl/orcl/trace/orcl_tmon_13450.trc
diag/rdbms/orcl/orcl/trace/orcl_vktm_963.trc
diag/rdbms/orcl/orcl/trace/alert_orcl.log
...
</pre>
<p>To find the number of all trace incidents:</p>
<pre dir="ltr">
adrci&gt; show incident

ADR Home = /u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl:
*************************************************************************
234 rows fetched
</pre>
<p>The following <code dir="ltr">ADRCI</code> command returns a list of all trace files whose name contains the word <code dir="ltr">ora</code>:</p>
<pre dir="ltr">
adrci&gt; show tracefile %ora%

/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_18841.trc
/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_12017.trc
/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_19372.trc
/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_12221.trc
/u01/app/oracle/product/11.2.0.4/log/diag/rdbms/orcl/orcl/trace/orcl_ora_1600.trc
...
</pre>
<p>The following <code dir="ltr">ADRCI</code> command searches for trace files that contain the phrase <code dir="ltr">Realm Authorization Failed</code>:</p>
<pre dir="ltr">
adrci&gt; show trace %trc -xp "[payload like '%Realm Authorization Failed%']"
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SUTIL700" href="../../server.112/e22490/adrci.htm#SUTIL700"><span class="italic">Oracle Database Utilities</span></a> for detailed information about the <code dir="ltr">ADRCI</code> utility</p>
</li>
<li>
<p><a class="olink ADMIN11277" href="../../server.112/e25494/diag.htm#ADMIN11277"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about viewing reports with the <code dir="ltr">ADRCI</code> utility</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="BABCADCI"></a>
<div id="DVADM71369" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Examples Oracle Database Vault Trace Files</h3>
<p>This <a id="sthref1467"></a><a id="sthref1468"></a>section provides examples of trace files for all three levels: low, high, and highest.</p>
<p><a href="#BABFEBIB">Example E-1</a> shows trace file data for low level realm violations.</p>
<div id="DVADM71370" class="example">
<p class="titleinexample"><a id="BABFEBIB"></a>Example E-1 Low Level Oracle Database Vault Realm Violations in a Trace File</p>
<pre dir="ltr">
*** 2010-02-05 18:35:31.438
*** SESSION ID:(34.559) 2010-02-05 18:35:31.438
*** CLIENT ID:() 2010-02-05 18:35:31.438
*** SERVICE NAME:(SYS$USERS) 2010-02-05 18:35:31.438
*** MODULE NAME:(SQL*Plus) 2010-02-05 18:35:31.438
*** ACTION NAME:() 2010-02-05 18:35:31.438
 
Result=Realm Authorization Failed
        Realm_Name=realm 3      Required_Auth_Level=0
        Current_User=116
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=INSERT INTO U1.T1 VALUES(30)
 
Result=Realm Authorization Failed
        Realm_Name=realm 3      Required_Auth_Level=0
        Current_User=116
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=DELETE FROM U1.T1
 
Result=Realm Authorization Failed
        Realm_Name=realm 3      Required_Auth_Level=0
        Current_User=116
        Object_Owner=U1 Object_Name=T3  Object_Type=TABLE
        SQL_Text=CREATE TABLE U1.T3(C INT)
 
*** 2010-02-05 18:35:34.465
 
Result=Realm Authorization Failed
        Realm_Name=realm 3      Required_Auth_Level=0
        Current_User=116
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=INSERT INTO U1.T1 VALUES(30)
 
Result=Realm Authorization Failed
        Realm_Name=realm 3      Required_Auth_Level=0
        Current_User=116
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=DELETE FROM U1.T1
</pre></div>
<!-- class="example" -->
<p><a href="#BABDHDJJ">Example E-2</a> shows how Database Vault authorization can appear in a trace file with high level trace enabled.</p>
<div id="DVADM71371" class="example">
<p class="titleinexample"><a id="BABDHDJJ"></a>Example E-2 High Level Trace Enabled for Oracle Database Vault Authorization</p>
<pre dir="ltr">
Result= Realm Authorization Passed
        Reason=Current user is the object owner
        Current_User=70 Command=SELECT
        Object_Owner=LBACSYS    Object_Name=LBAC$AUDIT  Object_Type=TABLE
 
Result= Realm Authorization Passed
        Reason=Current user is the object owner
        Current_User=70 Command=SELECT
        Object_Owner=LBACSYS    Object_Name=LBAC$AUDIT  Object_Type=TABLE
 
Result= Realm Authorization Passed
        Reason=Current user is the object owner
        Current_User=70 Command=SELECT
        Object_Owner=LBACSYS    Object_Name=LBAC$POL    Object_Type=TABLE
 
Result= Realm Authorization Passed
        Reason=Current user is the object owner
        Current_User=70 Command=SELECT
        Object_Owner=LBACSYS    Object_Name=LBAC$USER_LOGON     Object_Type=VIEW
 
&hellip;&hellip;
 
Result= Realm Authorization Passed
        Reason=Current user is the object owner
        Current_User=70 Command=SELECT
        Object_Owner=LBACSYS    Object_Name=LBAC$POL    Object_Type=TABLE
 
Result=Set Factor Value
        Factor_Name=Sensitive_Treatments        Factor_Expression=/SURGERY/PSYCHOLOGICAL
 
Result=Set Factor Value
        Factor_Name=Database_Instance   Factor_Expression=UPPER(SYS_CONTEXT('USERENV','INSTANCE'))      Factor_Value=1
 
Result=Set Factor Value
        Factor_Name=Client_IP   Factor_Expression=UPPER(SYS_CONTEXT('USERENV','IP_ADDRESS'))    Factor_Value=
 
Result=Set Factor Value
        Factor_Name=Authentication_Method       Factor_Expression=UPPER(SYS_CONTEXT('USERENV','AUTHENTICATION_METHOD')) Factor_Value=PASSWORD
&hellip;&hellip;
 
*** ACTION NAME:() 2010-02-05 18:47:19.540
 
Result=Rule Set Evaluation Failed
        Command=SELECT  RuleSet_ID=2    RuleSet_Name=Disabled
        Current_User=SYSTEM 
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=SELECT * FROM U1.T1
 
Result=Rule Set Evaluation Succeeded
        Command=SELECT  RuleSet_ID=1    RuleSet_Name=Enabled
        Current_User=SYSTEM 
        Object_Owner=U1 Object_Name=T1  Object_Type=TABLE
        SQL_Text=SELECT * FROM U1.T1
</pre></div>
<!-- class="example" -->
<p><a href="#BABEAIIA">Example E-3</a> shows how highest level violations that involve Oracle Scheduler jobs authorization can appear in a trace file when trace is enabled at the highest level.</p>
<div id="DVADM71372" class="example">
<p class="titleinexample"><a id="BABEAIIA"></a>Example E-3 Highest Level Traces on Violations on Realm-Protected Objects</p>
<pre dir="ltr">
------ Call Stack Trace ------
kzvdvechk&lt;-kzvdveqau&lt;-kksfbc&lt;-opiexe&lt;-kpoal8&lt;-opiodr&lt;-ttcpip&lt;-opitsk&lt;-opiino&lt;-opiodr&lt;-opidrv&lt;-sou2o&lt;-opimai_real&lt;-ssthrdmain&lt;-main&lt;-__libc_start_main&lt;-_start
 
Result=Object Privilege check passed
        Current_User=INVOKER2   Used_Role=1
        Object_Owner=SYSTEM     Object_Name=PRODUCT_PRIVS       Object_Type=VIEW
        SQL_Text=SELECT CHAR_VALUE FROM SYSTEM.PRODUCT_PRIVS WHERE (UPPER('SQL*PLUS') LIKE UPPER(PRODUCT)) AND ((USER LIKE USERID) OR (USERID = 'PUBLIC')) AND (UPPER(ATTRIBUTE) = 'ROLES')
*** MODULE NAME:(SQL*Plus) 2010-02-05 18:57:53.973
*** ACTION NAME:() 2010-02-05 18:57:53.973
 
----- Current SQL Statement for this session (sql_id=2sr63rjm45yfh) -----
UPDATE INVOKER1.T1 SET A = 20
----- PL/SQL Stack -----
----- PL/SQL Call Stack -----
  object      line  object
  handle    number  name
0x26a00e34         1  anonymous block
0x2495b000       185  package body SYS.DBMS_ISCHED
0x24958fb8       486  package body SYS.DBMS_SCHEDULER
0x247bbb34         1  anonymous block
 
------ Call Stack Trace ------
kzvdvechk&lt;-kzvdveqau&lt;-kksfbc&lt;-opiexe&lt;-opipls&lt;-opiodr&lt;-__PGOSF151_rpidrus&lt;-skgmstack&lt;-rpidru&lt;-rpiswu2&lt;-rpidrv&lt;-psddr0&lt;-psdnal&lt;-pevm_EXECC&lt;-pfrinstr_EXECC&lt;-pfrrun_no_tool&lt;-pfrrun&lt;-plsql_run&lt;-peicnt&lt;-kkxexe&lt;-opiexe&lt;-kpoal8&lt;-opiodr&lt;-kpoodr&lt;-upirtrc&lt;-kpurcsc&lt;-kpuexec
&lt;-OCIStmtExecute&lt;-jslvec_execcb&lt;-jslvswu&lt;-jslve_execute0&lt;-jskaJobRun&lt;-jsiRunJob&lt;-jsaRunJob&lt;-spefcmpa&lt;-spefmccallstd&lt;-pextproc&lt;-__PGOSF495_peftrusted&lt;-__PGOSF522_psdexsp&lt;-rpiswu2&lt;-psdextp&lt;-pefccal&lt;-pefcal&lt;-pevm_FCAL&lt;-pfrinstr_FCAL&lt;-pfrrun_no_tool&lt;-pfrrun&lt;-plsql_run
&lt;-peicnt&lt;-kkxexe&lt;-opiexe&lt;-kpoal8&lt;-opiodr&lt;-ttcpip&lt;-opitsk&lt;-opiino&lt;-opiodr&lt;-opidrv&lt;-sou2o&lt;-opimai_real&lt;-ssthrdmain&lt;-main&lt;-__libc_start_main&lt;-_start
 
Result=Realm Authorization Succeeded
        Realm_Name=jobowner realm       Used_Auth_Level=0
        Current_User=119
        Object_Owner=INVOKER1   Object_Name=T1  Object_Type=TABLE
        SQL_Text=UPDATE INVOKER1.T1 SET A = 20
 
Result=Scheduler Job Authorization Succeeded
        Current_User=JOBOWNER   Logon_User=INVOKER2
        Job_Owner=JOBOWNER      Job_Name=DMLJOB1
        Object_Owner=INVOKER1   Object_Name=T1  Object_Type=TABLE
        SQL_Text=UPDATE INVOKER1.T1 SET A = 20
</pre></div>
<!-- class="example" --></div>
<!-- class="sect2" -->
<a id="BABEJEEJ"></a>
<div id="DVADM71373" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2">Disabling Oracle Database Vault Trace Events</h3>
<p>This section contains:</p>
<ul>
<li>
<p><a href="#BABBJJJG">Disabling Trace Events for the Current Database Session</a></p>
</li>
<li>
<p><a href="#BABBAHII">Disabling Trace Events for All Database Sessions</a></p>
</li>
</ul>
<a id="BABBJJJG"></a>
<div id="DVADM71374" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Disabling Trace Events for the Current Database Session</h4>
<ol>
<li>
<p>Log <a id="sthref1469"></a>into the database instance as a user who has been granted the <code dir="ltr">DV_ADMIN</code> role and the <code dir="ltr">ALTER SESSION</code> system privilege.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus lbrown_dvowner
Enter password: <span class="italic">password</span>
Connected.
</pre></li>
<li id="BABIEADF">
<p>Enter both of the following SQL statements to disable tracing:</p>
<pre dir="ltr">
ALTER SESSION SET EVENTS 'TRACE[DV] OFF'; 
ALTER SESSION SET EVENTS '47998 trace name context off';
</pre>
<p>Alternatively, you can use the <code dir="ltr">ALTER SYSTEM</code> statement as well:</p>
<pre dir="ltr">
ALTER SYSTEM SET EVENTS 'TRACE[DV] OFF'; 
ALTER SYSTEM SET EVENTS '47998 trace name context off';
</pre></li>
</ol>
</div>
<!-- class="sect3" -->
<a id="BABBAHII"></a>
<div id="DVADM71375" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3">Disabling Trace Events for All Database Sessions</h4>
<ol>
<li>
<p>Log<a id="sthref1470"></a> into the database instance as a user who has been granted the <code dir="ltr">DV_ADMIN</code> role and the <code dir="ltr">ALTER SYSTEM</code> system privilege.</p>
<p>For example:</p>
<pre dir="ltr">
sqlplus lbrown_dvowner
Enter password: <span class="italic">password</span>
Connected.
</pre></li>
<li>
<p>Enter the <code dir="ltr">ALTER SYSTEM SET EVENTS</code> SQL statement, using the syntax that is shown in Step <a href="#BABIEADF">2</a> in <a href="#BABBJJJG">"Disabling Trace Events for the Current Database Session"</a>.</p>
<p>For example:</p>
<pre dir="ltr">
ALTER SYSTEM SET EVENTS 'TRACE[DV] OFF'; 
</pre></li>
<li>
<p>Restart the database.</p>
<p>For example:</p>
<pre dir="ltr">
SHUTDOWN IMMEDIATE
STARTUP
</pre></li>
</ol>
<p>Another way that you can disable trace events for all database sessions is to add the following line to the <code dir="ltr">init.ora</code> file, and then restart the database:</p>
<pre dir="ltr">
event="47998 trace name context off"
</pre>
<p>Ensure that the <code dir="ltr">init.ora</code> file does not have any conflicting <code dir="ltr">47998</code> lines, such as <code dir="ltr">event="47998 trace name context forever, level [1]"</code>.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CEGHEDIE"></a>
<div id="DVADM71112" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">General Diagnostic Tips</h2>
<p><a id="sthref1471"></a><a id="sthref1472"></a><a id="sthref1473"></a>Follow <a id="sthref1474"></a>these general tips for diagnosing problems in <a id="sthref1475"></a>realms,<a id="sthref1476"></a> factors, and <a id="sthref1477"></a>rule <a id="sthref1478"></a><a id="sthref1479"></a>sets:</p>
<ul>
<li>
<p>For realm protections, verify that a user has the underlying system or object privileges (granted directly or through a role) that might affect the command.</p>
</li>
<li>
<p>If a <a id="sthref1480"></a>realm authorization is not working, verify that the account roles are set correctly.</p>
</li>
<li>
<p>For PL/SQL expressions used in factors and rule sets, grant the <code dir="ltr">EXECUTE</code> privilege on the PL/SQL package functions used in these expressions directly to the account and determine if the results appear to be correct.</p>
</li>
<li>
<p>Use the auditing reports to diagnose problems in general. See <a href="reports.htm#BABDEJJE">"Oracle Database Vault Auditing Reports"</a> for more information.</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CEGHCAIH"></a>
<div id="DVADM71113" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">Configuration Problems with Oracle Database Vault Components</h2>
<p>If you suspect problems with the configuration of <a id="sthref1481"></a>realms, command rules, <a id="sthref1482"></a>factors, <a id="sthref1483"></a>rule sets, or <a id="sthref1484"></a>secure application roles, you can run the appropriate configuration report. See the following sections for more information:</p>
<ul>
<li>
<p><a href="reports.htm#BABJGDCF">"Command Rule Configuration Issues Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABDEFIG">"Factor Configuration Issues Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABEGAEA">"Factor Without Identities Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABHJACH">"Identity Configuration Issues Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABFFIIJ">"Realm Authorization Configuration Issues Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABGBBFH">"Rule Set Configuration Issues Report"</a></p>
</li>
<li>
<p><a href="reports.htm#BABJAAFD">"Secure Application Configuration Issues Report"</a></p>
</li>
</ul>
<p>To run these reports, see <a href="reports.htm#CHDBFBFH">"How to Run Oracle Database Vault Reports"</a>.</p>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1638">
<tr>
<td class="cellalignment1646">
<table class="cellalignment1643">
<tr>
<td class="cellalignment1642"><a href="guidelines.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2016,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1650">
<table class="cellalignment1641">
<tr>
<td class="cellalignment1642"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1642"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1642"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1642"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1642"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1642"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
