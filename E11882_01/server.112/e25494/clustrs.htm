<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Managing Clusters</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1055" />
<meta name="dcterms.created" content="2015-05-05T8:27:36Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Administrator's Guide" />
<meta name="dcterms.identifier" content="E25494-07" />
<meta name="dcterms.isVersionOf" content="ADMIN" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="indexes.htm" title="Previous" type="text/html" />
<link rel="Next" href="hash.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e25494.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">31/49</span> <!-- End Header -->
<div id="ADMIN018" class="chapter"><a id="g1009415"></a> <a id="i1006586"></a>
<h1 class="chapter"><span class="secnum">22</span> Managing Clusters</h1>
<p>In this chapter:</p>
<ul>
<li>
<p><a href="#i1006635">About Clusters</a></p>
</li>
<li>
<p><a href="#i1006620">Guidelines for Managing Clusters</a></p>
</li>
<li>
<p><a href="#i1006273">Creating Clusters</a></p>
</li>
<li>
<p><a href="#i1106361">Altering Clusters</a></p>
</li>
<li>
<p><a href="#i1206425">Dropping Clusters</a></p>
</li>
<li>
<p><a href="#i1006481">Clusters Data Dictionary Views</a></p>
</li>
</ul>
<a id="i1006635"></a>
<div id="ADMIN11739" class="sect1">
<h2 class="sect1">About Clusters<a id="sthref2483"></a></h2>
<p>A <span class="bold">cluster</span> provides an optional method of storing table data. A cluster is made up of a group of <a id="sthref2484"></a>tables that share the same data blocks<a id="sthref2485"></a>. The tables are grouped together because they share common columns and are often used together. For example, the <code dir="ltr">emp</code> and <code dir="ltr">dept</code> table share the <code dir="ltr">deptno</code> column. When you cluster the <code dir="ltr">emp</code> and <code dir="ltr">dept</code> tables (see <a href="#i1006158">Figure 22-1</a>), Oracle Database physically stores all rows for each department from both the <code dir="ltr">emp</code> and <code dir="ltr">dept</code> tables in the same data blocks.</p>
<p>Because clusters store related rows of different tables together in the same data blocks, properly used clusters offer two primary benefits:</p>
<ul>
<li>
<p>Disk I/O is reduced and access time improves for joins of clustered tables.</p>
</li>
<li>
<p><a id="sthref2486"></a><a id="sthref2487"></a>The <span class="bold">cluster key</span> is the column, or group of columns, that the clustered tables have in common. You specify the columns of the cluster key when creating the cluster. You subsequently specify the same columns when creating every table added to the cluster. Each cluster key value is stored only once each in the cluster and the cluster index, no matter how many rows of different tables contain the value.</p>
<p>Therefore, less storage might be required to store related table and index data in a cluster than is necessary in non-clustered table format. For example, in <a href="#i1006158">Figure 22-1</a>, notice how each cluster key (each <code dir="ltr">deptno</code>) is stored just once for many rows that contain the same value in both the <code dir="ltr">emp</code> and <code dir="ltr">dept</code> tables.</p>
</li>
</ul>
<p>After creating a cluster, you can create tables in the cluster. However, before any rows can be inserted into the clustered tables, a cluster index must be created. Using clusters does not affect the creation of additional indexes on the clustered tables; they can be created and dropped as usual.</p>
<p>You should not use clusters for tables that are frequently accessed individually.</p>
<div id="ADMIN13069" class="figure">
<p class="titleinfigure"><a id="i1006158"></a>Figure 22-1 Clustered Table Data</p>
<img width="648" height="643" src="img/admin021.gif" alt="Description of Figure 22-1 follows" /><br />
<a id="sthref2488" href="img_text/admin021.htm">Description of "Figure 22-1 Clustered Table Data"</a><br />
<br /></div>
<!-- class="figure" -->
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a href="hash.htm#g1009458">Chapter 23, "Managing Hash Clusters"</a> for a description of another type of cluster: a hash cluster</p>
</li>
<li>
<p><a href="schema.htm#g1019613">Chapter 19, "Managing Space for Schema Objects"</a> is recommended reading before attempting tasks described in this chapter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="i1006620"></a>
<div id="ADMIN11740" class="sect1">
<h2 class="sect1">Guidelines for Managing Clusters</h2>
<p><a id="sthref2489"></a>The following sections describe guidelines to consider when managing clusters, and contains the following topics:</p>
<ul>
<li>
<p><a href="#i1006207">Choose Appropriate Tables for the Cluster</a></p>
</li>
<li>
<p><a href="#i1006213">Choose Appropriate Columns for the Cluster Key</a></p>
</li>
<li>
<p><a href="#i1006250">Specify the Space Required by an Average Cluster Key and Its Associated Rows</a></p>
</li>
<li>
<p><a href="#i1006260">Specify the Location of Each Cluster and Cluster Index Rows</a></p>
</li>
<li>
<p><a href="#i1206265">Estimate Cluster Size and Set Storage Parameters</a></p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink CNCPT608" href="../../server.112/e40540/tablecls.htm#CNCPT608"><span class="italic">Oracle Database Concepts</span></a> for more information about clusters</p>
</li>
<li>
<p><a class="olink PFGRF004" href="../../server.112/e41573/data_acc.htm#PFGRF004"><span class="italic">Oracle Database Performance Tuning Guide</span></a> for guidelines on when to use clusters</p>
</li>
</ul>
</div>
</li>
</ul>
<a id="i1006207"></a>
<div id="ADMIN11741" class="sect2">
<h3 class="sect2">Choose Appropriate Tables for the Cluster</h3>
<p><a id="sthref2490"></a><a id="sthref2491"></a>Use clusters for tables for which the following conditions are true:</p>
<ul>
<li>
<p>The tables are primarily queried--that is, tables that are <span class="italic">not</span> predominantly inserted into or updated.</p>
</li>
<li>
<p>Records from the tables are frequently queried together or joined.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1006213"></a>
<div id="ADMIN11742" class="sect2">
<h3 class="sect2">Choose Appropriate Columns for the Cluster Key</h3>
<p><a id="sthref2492"></a><a id="sthref2493"></a>Choose cluster key columns carefully. If multiple columns are used in queries that join the tables, make the cluster key a composite key. In general, the characteristics that indicate a good cluster index are the same as those for any index. For information about characteristics of a good index, see <a href="indexes.htm#i1007193">"Guidelines for Managing Indexes"</a>.</p>
<p>A good cluster key has enough unique values so that the group of rows corresponding to each key value fills approximately one data block. Having too few rows for each cluster key value can waste space and result in negligible performance gains. Cluster keys that are so specific that only a few rows share a common value can cause wasted space in blocks, unless a small <code dir="ltr">SIZE</code> was specified at cluster creation time (see <a href="#i1006250">"Specify the Space Required by an Average Cluster Key and Its Associated Rows"</a>).</p>
<p>Too many rows for each cluster key value can cause extra searching to find rows for that key. Cluster keys on values that are too general (for example, <code dir="ltr">male</code> and <code dir="ltr">female</code>) result in excessive searching and can result in worse performance than with no clustering.</p>
<p>A cluster index cannot be unique or include a column defined as <code dir="ltr">long</code>.</p>
</div>
<!-- class="sect2" -->
<a id="i1006250"></a>
<div id="ADMIN11743" class="sect2">
<h3 class="sect2">Specify the Space Required by an Average Cluster Key and Its Associated Rows</h3>
<p><a id="sthref2494"></a>The <code dir="ltr">CREATE CLUSTER</code> statement has an optional clause, <code dir="ltr">SIZE</code>, which is the estimated number of bytes required by an average cluster key and its associated rows. The database uses the <code dir="ltr">SIZE</code> parameter when performing the following tasks:</p>
<ul>
<li>
<p>Estimating the number of cluster keys (and associated rows) that can fit in a clustered data block</p>
</li>
<li>
<p>Limiting the number of cluster keys placed in a clustered data block. This maximizes the storage efficiency of keys within a cluster.</p>
</li>
</ul>
<p><code dir="ltr"><a id="sthref2495"></a><a id="sthref2496"></a>SIZE</code> does not limit the space that can be used by a given cluster key. For example, if <code dir="ltr">SIZE</code> is set such that two cluster keys can fit in one data block, any amount of the available data block space can still be used by either of the cluster keys.</p>
<p>By default, the database stores only one cluster key and its associated rows in each data block of the cluster data segment. Although block size can vary from one operating system to the next, the rule of one key for each block is maintained as clustered tables are imported to other databases on other systems.</p>
<p>If all the rows for a given cluster key value cannot fit in one block, the blocks are chained together to speed access to all the values with the given key. The cluster index points to the beginning of the chain of blocks, each of which contains the cluster key value and associated rows. If the cluster <code dir="ltr">SIZE</code> is such that multiple keys fit in a block, then blocks can belong to multiple chains.</p>
</div>
<!-- class="sect2" -->
<a id="i1006260"></a>
<div id="ADMIN11744" class="sect2">
<h3 class="sect2">Specify the Location of Each Cluster and Cluster Index Rows</h3>
<p><a id="sthref2497"></a>If you have the proper privileges and tablespace quota, you can create a new cluster and the associated cluster index in any tablespace that is currently online. Always specify the <code dir="ltr">TABLESPACE</code> clause in a <code dir="ltr">CREATE CLUSTER</code>/<code dir="ltr">INDEX</code> statement to identify the tablespace to store the new cluster or index.</p>
<p>The cluster and its cluster index can be created in different tablespaces. In fact, creating a cluster and its index in different tablespaces that are stored on different storage devices allows table data and index data to be retrieved simultaneously with minimal disk contention.</p>
</div>
<!-- class="sect2" -->
<a id="i1206265"></a>
<div id="ADMIN11745" class="sect2">
<h3 class="sect2">Estimate Cluster Size and Set Storage Parameters</h3>
<p><a id="sthref2498"></a>The following are benefits of estimating cluster size before creating the cluster:</p>
<ul>
<li>
<p>You can use the combined estimated size of clusters, along with estimates for indexes and redo log files, to determine the amount of disk space that is required to hold an intended database. From these estimates, you can make correct hardware purchases and other decisions.</p>
</li>
<li>
<p>You can use the estimated size of an individual cluster to better manage the disk space that the cluster will use. When a cluster is created, you can set appropriate storage parameters and improve I/O performance of applications that use the cluster.</p>
</li>
</ul>
<p>Set the storage parameters for the data segments of a cluster using the <code dir="ltr">STORAGE</code> clause of the <code dir="ltr">CREATE</code> <code dir="ltr">CLUSTER</code> or <code dir="ltr">ALTER</code> <code dir="ltr">CLUSTER</code> statement, rather than the individual <code dir="ltr">CREATE</code> or <code dir="ltr">ALTER</code> statements that put tables into the cluster. Storage parameters specified when creating or altering a clustered table are ignored. The storage parameters set for the cluster override the table storage parameters.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006273"></a>
<div id="ADMIN11746" class="sect1">
<h2 class="sect1">Creating Clusters<a id="sthref2499"></a></h2>
<p><a id="sthref2500"></a>To create a cluster in your schema, you must have the <code dir="ltr">CREATE CLUSTER</code> system privilege and a quota for the tablespace intended to contain the cluster or the <code dir="ltr">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>To create a cluster in another user's schema you must have the <code dir="ltr">CREATE ANY CLUSTER</code> system privilege, and the owner must have a quota for the tablespace intended to contain the cluster or the <code dir="ltr">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>You create a cluster using the <a id="sthref2501"></a><code dir="ltr">CREATE CLUSTER</code> statement. The following statement creates a cluster named <code dir="ltr">emp_dept</code>, which stores the <code dir="ltr">emp</code> and <code dir="ltr">dept</code> tables, clustered by the <code dir="ltr">deptno</code> column:</p>
<pre dir="ltr">
<a id="sthref2502"></a>CREATE CLUSTER emp_dept (deptno NUMBER(3))
   SIZE 600
   TABLESPACE users
   STORAGE (INITIAL 200K
      NEXT 300K
      MINEXTENTS 2
      PCTINCREASE 33);
</pre>
<p>If no <code dir="ltr">INDEX</code> keyword is specified, as is true in this example, an index cluster is created by default. You can also create a <code dir="ltr">HASH</code> cluster, when hash parameters (<code dir="ltr">HASHKEYS</code>, <code dir="ltr">HASH IS</code>, or <code dir="ltr">SINGLE TABLE HASHKEYS</code>) are specified. Hash clusters are described in <a href="hash.htm#g1009458">Chapter 23, "Managing Hash Clusters"</a>.</p>
<a id="i1006298"></a>
<div id="ADMIN11747" class="sect2">
<h3 class="sect2">Creating Clustered Tables<a id="sthref2503"></a></h3>
<p>To create a table in a cluster, you must have either the <code dir="ltr">CREATE TABLE</code> or <code dir="ltr">CREATE ANY TABLE</code> system privilege. You do not need a tablespace quota or the <code dir="ltr">UNLIMITED TABLESPACE</code> system privilege to create a table in a cluster.</p>
<p><a id="sthref2504"></a>You create a table in a cluster using the <code dir="ltr">CREATE TABLE</code> statement with the <code dir="ltr">CLUSTER</code> clause. The <code dir="ltr">emp</code> and <code dir="ltr">dept</code> tables can be created in the <code dir="ltr">emp_dept</code> cluster using the following statements:</p>
<pre dir="ltr">
CREATE TABLE emp (
   empno NUMBER(5) PRIMARY KEY,
   ename VARCHAR2(15) NOT NULL,
   . . .
   deptno NUMBER(3) REFERENCES dept)
   CLUSTER emp_dept (deptno);  

CREATE TABLE dept (
   deptno NUMBER(3) PRIMARY KEY, . . . )
   CLUSTER emp_dept (deptno);
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can specify the schema for a clustered table in the <code dir="ltr">CREATE TABLE</code> statement. A clustered table can be in a different schema than the schema containing the cluster. Also, the names of the columns are not required to match, but their structure must match.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01402" href="../../server.112/e41084/statements_7002.htm#SQLRF01402"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code dir="ltr">CREATE TABLE</code> statement for creating cluster tables</div>
</div>
<!-- class="sect2" -->
<a id="i1006329"></a>
<div id="ADMIN11748" class="sect2">
<h3 class="sect2">Creating Cluster Indexes<a id="sthref2505"></a></h3>
<p>To create a cluster index, one of the following conditions must be true:</p>
<ul>
<li>
<p>Your schema contains the cluster.</p>
</li>
<li>
<p>You have the <code dir="ltr">CREATE ANY INDEX</code> system privilege.</p>
</li>
</ul>
<p>In either case, you must also have either a quota for the tablespace intended to contain the cluster index, or the <code dir="ltr">UNLIMITED TABLESPACE</code> system privilege.</p>
<p>A cluster index must be created before any rows can be inserted into any clustered table. The following statement creates a cluster index for the <code dir="ltr">emp_dept</code> cluster:</p>
<pre dir="ltr">
<a id="sthref2506"></a>CREATE INDEX emp_dept_index
   ON CLUSTER emp_dept
   TABLESPACE users
   STORAGE (INITIAL 50K
      NEXT 50K
      MINEXTENTS 2
      MAXEXTENTS 10
      PCTINCREASE 33);
</pre>
<p>The cluster index clause (<code dir="ltr">ON CLUSTER</code>) identifies the cluster, <code dir="ltr">emp_dept</code>, for which the cluster index is being created. The statement also explicitly specifies several storage settings for the cluster and cluster index.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01209" href="../../server.112/e41084/statements_5012.htm#SQLRF01209"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code dir="ltr">CREATE INDEX</code> statement for creating cluster indexes</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1106361"></a>
<div id="ADMIN11749" class="sect1">
<h2 class="sect1">Altering Clusters<a id="sthref2507"></a></h2>
<p>To alter a cluster, your schema must contain the cluster or you must have the <code dir="ltr">ALTER ANY CLUSTER</code> system <a id="sthref2508"></a>privilege. You can alter an existing cluster to change the following settings:</p>
<ul>
<li>
<p>Physical attributes (<code dir="ltr">INITRANS</code> and storage characteristics)</p>
</li>
<li>
<p>The average amount of space required to store all the rows for a cluster key value (<code dir="ltr">SIZE</code>)</p>
</li>
<li>
<p>The default degree of parallelism</p>
</li>
</ul>
<p>Additionally, you can explicitly allocate a new extent for the cluster, or deallocate any unused extents at the end of the cluster. <a id="sthref2509"></a><a id="sthref2510"></a><a id="sthref2511"></a><a id="sthref2512"></a>The database dynamically allocates additional extents for the data segment of a cluster as required. In some circumstances, however, you might want to explicitly allocate an additional extent for a cluster. For example, when using Real Application Clusters<a id="sthref2513"></a>, you can allocate an extent of a cluster explicitly for a specific instance. <a id="sthref2514"></a>You allocate a new extent for a cluster using the <code dir="ltr">ALTER CLUSTER</code> statement with the <code dir="ltr">ALLOCATE EXTENT</code> clause.</p>
<p>When you alter the cluster size parameter (<code dir="ltr">SIZE</code>) of a cluster, the new settings apply to all data blocks used by the cluster, including blocks already allocated and blocks subsequently allocated for the cluster. Blocks already allocated for the table are reorganized when necessary (not immediately).</p>
<p>When you alter the transaction entry setting <code dir="ltr">INITRANS</code> of a cluster, the new setting for <code dir="ltr">INITRANS</code> applies only to data blocks subsequently allocated for the cluster.</p>
<p>The storage parameters <code dir="ltr">INITIAL</code> and <code dir="ltr">MINEXTENTS</code> cannot be altered. All new settings for the other storage parameters affect only extents subsequently allocated for the cluster.</p>
<p><a id="sthref2515"></a>To alter a cluster, use the <code dir="ltr">ALTER CLUSTER</code> statement.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF008" href="../../server.112/e41084/statements_1.htm#SQLRF008"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code dir="ltr">ALTER CLUSTER</code> statement</div>
<div id="ADMIN11750" class="sect2"><a id="sthref2516"></a>
<h3 class="sect2">Altering Clustered Tables</h3>
<p><a id="sthref2517"></a><a id="sthref2518"></a>You can alter clustered tables using the <code dir="ltr">ALTER TABLE</code> statement. However, any data block space parameters, transaction entry parameters, or storage parameters you set in an <code dir="ltr">ALTER TABLE</code> statement for a clustered table generate an error message (<code dir="ltr">ORA-01771, illegal option for a clustered table</code>). The database uses the parameters of the cluster for all clustered tables. Therefore, you can use the <code dir="ltr">ALTER TABLE</code> statement only to add or modify columns, drop non-cluster-key columns, or add, drop, enable, or disable integrity constraints or triggers for a clustered table. For information about altering tables, see <a href="tables.htm#i1006494">"Altering Tables"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01001" href="../../server.112/e41084/statements_3001.htm#SQLRF01001"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code dir="ltr">ALTER TABLE</code> statement</div>
</div>
<!-- class="sect2" -->
<div id="ADMIN11751" class="sect2"><a id="sthref2519"></a>
<h3 class="sect2">Altering Cluster Indexes</h3>
<p>You alter cluster indexes exactly as you do other indexes. See <a href="indexes.htm#i1006816">"Altering Indexes"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When estimating the size of cluster indexes, remember that the index is on each cluster key, not the actual rows. Therefore, each key appears only once in the index.</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1206425"></a>
<div id="ADMIN11752" class="sect1">
<h2 class="sect1">Dropping Clusters</h2>
<p><a id="sthref2520"></a><a id="sthref2521"></a><a id="sthref2522"></a>A cluster can be dropped if the tables within the cluster are no longer needed. When a cluster is dropped, so are the tables within the cluster and the corresponding cluster index. All extents belonging to both the cluster data segment and the index segment of the cluster index are returned to the containing tablespace and become available for other segments within the tablespace.</p>
<p><a id="sthref2523"></a><a id="sthref2524"></a><a id="sthref2525"></a>To drop a cluster that contains no tables, and its cluster index, use the <code dir="ltr">DROP CLUSTER</code> statement. For example, the following statement drops the empty cluster named <code dir="ltr">emp_dept</code>:</p>
<pre dir="ltr">
DROP CLUSTER emp_dept;
</pre>
<p>If the cluster contains one or more clustered tables and you intend to drop the tables as well, add the <code dir="ltr">INCLUDING TABLES</code> clause of the <code dir="ltr">DROP CLUSTER</code> statement, as follows:</p>
<pre dir="ltr">
DROP CLUSTER emp_dept INCLUDING TABLES;
</pre>
<p>If the <code dir="ltr">INCLUDING TABLES</code> clause is not included and the cluster contains tables, an error is returned.</p>
<p>If one or more tables in a cluster contain primary or unique keys that are referenced by <code dir="ltr">FOREIGN KEY</code> constraints of tables outside the cluster, the cluster cannot be dropped unless the dependent <code dir="ltr">FOREIGN KEY</code> constraints are also dropped. <a id="sthref2526"></a>This can be easily done using the <code dir="ltr">CASCADE CONSTRAINTS</code> clause of the <code dir="ltr">DROP CLUSTER</code> statement, as shown in the following example:</p>
<pre dir="ltr">
DROP CLUSTER emp_dept INCLUDING TABLES CASCADE CONSTRAINTS;
</pre>
<p>The database returns an error if you do not use the <code dir="ltr">CASCADE CONSTRAINTS</code> clause and constraints exist.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01511" href="../../server.112/e41084/statements_8007.htm#SQLRF01511"><span class="italic">Oracle Database SQL Language Reference</span></a> for syntax of the <code dir="ltr">DROP CLUSTER</code> statement</div>
<a id="i1006454"></a>
<div id="ADMIN11753" class="sect2">
<h3 class="sect2">Dropping Clustered Tables</h3>
<p><a id="sthref2527"></a>To drop a cluster, your schema must contain the cluster or you must have the <code dir="ltr">DROP ANY CLUSTER</code> system privilege. You do not need additional privileges to drop a cluster that contains tables, even if the clustered tables are not owned by the owner of the cluster.<a id="sthref2528"></a></p>
<p>Clustered tables can be dropped individually without affecting the cluster, other clustered tables, or the cluster index. A clustered table is dropped just as a nonclustered table is dropped, with the <a id="sthref2529"></a><code dir="ltr">DROP TABLE</code> statement. See <a href="tables.htm#i1006709">"Dropping Table Columns"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
When you drop a single table from a cluster, the database deletes each row of the table individually. To maximize efficiency when you intend to drop an entire cluster, drop the cluster including all tables by using the <code dir="ltr">DROP CLUSTER</code> statement with the <code dir="ltr">INCLUDING TABLES</code> clause. Drop an individual table from a cluster (using the <code dir="ltr">DROP TABLE</code> statement) only if you want the rest of the cluster to remain.</div>
</div>
<!-- class="sect2" -->
<a id="i1006472"></a>
<div id="ADMIN11754" class="sect2">
<h3 class="sect2">Dropping Cluster Indexes</h3>
<p>A cluster index can be dropped without affecting the cluster or its clustered tables. However, clustered tables cannot be used if there is no cluster index; you must re-create the cluster index to allow access to the cluster. Cluster indexes are sometimes dropped as part of the procedure to rebuild a fragmented cluster index.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Hash cluster indexes cannot be dropped.</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="indexes.htm#i1006942">"Dropping Indexes"</a></div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006481"></a>
<div id="ADMIN11755" class="sect1">
<h2 class="sect1">Clusters Data Dictionary Views<a id="sthref2530"></a><a id="sthref2531"></a></h2>
<p>The following views display information about clusters:</p>
<div class="inftblruleinformalwide">
<table class="cellalignment1333" title="Viewing Information About Clusters" summary="Column 1 lists the names of views used to display information about clusters, column 2 describes each view." dir="ltr">
<thead>
<tr class="cellalignment1327">
<th class="cellalignment1334" id="r1c1-t14">View</th>
<th class="cellalignment1334" id="r1c2-t14">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r2c1-t14" headers="r1c1-t14"><code dir="ltr">DBA_CLUSTERS</code>
<p><code dir="ltr">ALL_CLUSTERS</code></p>
<p><code dir="ltr">USER_CLUSTERS</code></p>
</td>
<td class="cellalignment1335" headers="r2c1-t14 r1c2-t14"><code dir="ltr">DBA</code> view describes all clusters in the database. <code dir="ltr">ALL</code> view describes all clusters accessible to the user. <code dir="ltr">USER</code> view is restricted to clusters owned by the user. Some columns in these views contain statistics that are generated by the <code dir="ltr">DBMS_STATS</code> package or <code dir="ltr">ANALYZE</code> statement.</td>
</tr>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r3c1-t14" headers="r1c1-t14"><code dir="ltr">DBA_CLU_COLUMNS</code>
<p><code dir="ltr">USER_CLU_COLUMNS</code></p>
</td>
<td class="cellalignment1335" headers="r3c1-t14 r1c2-t14">These views map table columns to cluster columns</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblruleinformalwide" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN" href="../e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a> for complete descriptions of these views</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1326">
<tr>
<td class="cellalignment1335">
<table class="cellalignment1331">
<tr>
<td class="cellalignment1330"><a href="indexes.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1330"><a href="hash.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1337">
<table class="cellalignment1329">
<tr>
<td class="cellalignment1330"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1330"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1330"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1330"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1330"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1330"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
