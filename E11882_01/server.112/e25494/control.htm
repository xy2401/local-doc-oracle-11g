<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Managing Control Files</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1055" />
<meta name="dcterms.created" content="2015-05-05T8:27:34Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Administrator's Guide" />
<meta name="dcterms.identifier" content="E25494-07" />
<meta name="dcterms.isVersionOf" content="ADMIN" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2001, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="part2.htm" title="Previous" type="text/html" />
<link rel="Next" href="onlineredo.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e25494.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">19/49</span> <!-- End Header -->
<div id="ADMIN006" class="chapter"><a id="g1009963"></a> <a id="i1006088"></a>
<h1 class="chapter"><span class="secnum">11</span> Managing Control Files</h1>
<p>In this chapter:</p>
<ul>
<li>
<p><a href="#i1006143">What Is a Control File?</a></p>
</li>
<li>
<p><a href="#i1006155">Guidelines for Control Files</a></p>
</li>
<li>
<p><a href="#i1106242">Creating Control Files</a></p>
</li>
<li>
<p><a href="#i1006445">Troubleshooting After Creating Control Files</a></p>
</li>
<li>
<p><a href="#i1006485">Backing Up Control Files</a></p>
</li>
<li>
<p><a href="#i1006512">Recovering a Control File Using a Current Copy</a></p>
</li>
<li>
<p><a href="#i1106536">Dropping Control Files</a></p>
</li>
<li>
<p><a href="#i1006548">Control Files Data Dictionary Views</a></p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink CNCPT404" href="../../server.112/e40540/physical.htm#CNCPT404"><span class="italic">Oracle Database Concepts</span></a> for an overview of control files</p>
</li>
<li>
<p><a href="omf.htm#g1018000">Chapter 17, "Using Oracle Managed Files"</a> for information about creating control files that are both created and managed by the Oracle Database server</p>
</li>
</ul>
</div>
</li>
</ul>
<a id="i1006143"></a>
<div id="ADMIN11281" class="sect1">
<h2 class="sect1">What Is a Control File?</h2>
<p><a id="sthref1205"></a><a id="sthref1206"></a>Every Oracle Database has a <span class="bold">control file</span>, which is a small binary file that records the physical structure of the database. The control file includes:</p>
<ul>
<li>
<p>The database name</p>
</li>
<li>
<p>Names and locations of associated data files and redo log files</p>
</li>
<li>
<p>The timestamp of the database creation</p>
</li>
<li>
<p>The current log sequence number</p>
</li>
<li>
<p>Checkpoint information</p>
</li>
</ul>
<p>The control file must be available for writing by the Oracle Database server whenever the database is open. Without the control file, the database cannot be mounted and recovery is difficult.</p>
<p>The control file of an Oracle Database is created at the same time as the database. By default, at least one copy of the control file is created during database creation. On some operating systems the default is to create multiple copies. You should create two or more copies of the control file during database creation. You can also create control files later, if you lose control files or want to change particular settings in the control files.</p>
</div>
<!-- class="sect1" -->
<a id="i1006155"></a>
<div id="ADMIN11282" class="sect1">
<h2 class="sect1">Guidelines for Control Files</h2>
<p><a id="sthref1207"></a><a id="sthref1208"></a>This section describes guidelines you can use to manage the control files for a database, and contains the following topics:</p>
<ul>
<li>
<p><a href="#i1006180">Provide Filenames for the Control Files</a></p>
</li>
<li>
<p><a href="#i1006192">Multiplex Control Files on Different Disks</a></p>
</li>
<li>
<p><a href="#i1106212">Back Up Control Files</a></p>
</li>
<li>
<p><a href="#i1006226">Manage the Size of Control Files</a></p>
</li>
</ul>
<a id="i1006180"></a>
<div id="ADMIN11283" class="sect2">
<h3 class="sect2">Provide Filenames for the Control Files</h3>
<p><a id="sthref1209"></a>You specify control file names using the <code dir="ltr">CONTROL_FILES</code><a id="sthref1210"></a><a id="sthref1211"></a> initialization parameter in the database initialization parameter file (see <a href="#i1006257">"Creating Initial Control Files"</a>). The instance recognizes and opens all the listed file during startup, and the instance writes to and maintains all listed control files during database operation.</p>
<p>If you do not specify files for <code dir="ltr">CONTROL_FILES</code> before database creation:</p>
<ul>
<li>
<p>If you are not using Oracle Managed Files, then the database creates a control file and uses a default filename. The default name is operating system specific.</p>
</li>
<li>
<p>If you are using Oracle Managed Files, then the initialization parameters you set to enable that feature determine the name and location of the control files, as described in <a href="omf.htm#g1018000">Chapter 17, "Using Oracle Managed Files"</a>.</p>
</li>
<li>
<p>If you are using Oracle Automatic Storage Management (Oracle ASM), you can place incomplete Oracle ASM filenames in the <code dir="ltr">DB_CREATE_FILE_DEST</code> and <code dir="ltr">DB_RECOVERY_FILE_DEST</code> initialization parameters. Oracle ASM then automatically creates control files in the appropriate places. See the sections "About Oracle ASM Filenames" and "Creating a Database That Uses Oracle ASM" in <a class="olink OSTMG" href="../e18951/toc.htm"><span class="italic">Oracle Automatic Storage Management Administrator's Guide</span></a> for more information.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1006192"></a>
<div id="ADMIN11284" class="sect2">
<h3 class="sect2">Multiplex Control Files on Different Disks<a id="sthref1212"></a><a id="sthref1213"></a></h3>
<p><a id="sthref1214"></a><a id="sthref1215"></a><a id="sthref1216"></a><a id="sthref1217"></a>Every Oracle Database should have at least two control files<a id="sthref1218"></a>, each stored on a different physical disk. If a control file is damaged due to a disk failure, the associated instance must be shut down. Once the disk drive is repaired, the damaged control file can be restored using the intact copy of the control file from the other disk and the instance can be restarted. In this case, no media recovery is required.</p>
<p>The behavior of multiplexed control files is this:</p>
<ul>
<li>
<p>The database writes to all filenames listed for the initialization parameter <code dir="ltr">CONTROL_FILES</code> in the database initialization parameter file.</p>
</li>
<li>
<p>The database reads only the first file listed in the <code dir="ltr">CONTROL_FILES</code> parameter during database operation.</p>
</li>
<li>
<p>If any of the control files become unavailable during database operation, the instance becomes inoperable and should be aborted.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Oracle strongly recommends that your database has a minimum of two control files and that they are located on separate physical disks.</div>
</li>
</ul>
<p><a id="sthref1219"></a>One way to multiplex control files is to store a control file copy on every disk drive that stores members of redo log groups, if the redo log is multiplexed. By storing control files in these locations, you minimize the risk that all control files and all groups of the redo log will be lost in a single disk failure.</p>
</div>
<!-- class="sect2" -->
<a id="i1106212"></a>
<div id="ADMIN11285" class="sect2">
<h3 class="sect2">Back Up Control Files</h3>
<p>It is very important that you back up your control files. This is true initially, and every time you change the physical structure of your database. Such structural changes include:</p>
<ul>
<li>
<p>Adding, dropping, or renaming data files</p>
</li>
<li>
<p>Adding or dropping a tablespace, or altering the read/write state of the tablespace</p>
</li>
<li>
<p>Adding or dropping redo log files or groups</p>
</li>
</ul>
<p>The methods for backing up control files are discussed in <a href="#i1006485">"Backing Up Control Files"</a>.</p>
</div>
<!-- class="sect2" -->
<a id="i1006226"></a>
<div id="ADMIN11286" class="sect2">
<h3 class="sect2">Manage the Size of Control Files</h3>
<p><a id="sthref1220"></a>The main determinants of the size of a control file are the values set for the <code dir="ltr">MAXDATAFILES</code>, <code dir="ltr">MAXLOGFILES</code>, <code dir="ltr">MAXLOGMEMBERS</code>, <code dir="ltr">MAXLOGHISTORY</code>, and <code dir="ltr">MAXINSTANCES</code> parameters in the <code dir="ltr">CREATE DATABASE</code> statement that created the associated database. Increasing the values of these parameters increases the size of a control file of the associated database.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p>Your operating system specific Oracle documentation contains more information about the maximum control file size.</p>
</li>
<li>
<p><a class="olink SQLRF01204" href="../../server.112/e41084/statements_5004.htm#SQLRF01204"><span class="italic">Oracle Database SQL Language Reference</span></a> for a description of the <code dir="ltr">CREATE DATABASE</code> statement</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1106242"></a>
<div id="ADMIN10064" class="sect1">
<h2 class="sect1">Creating Co<a id="sthref1221"></a><a id="sthref1222"></a>ntrol Files</h2>
<p>This section describes ways to create control files, and contains the following topics:</p>
<ul>
<li>
<p><a href="#i1006257">Creating Initial Control Files</a></p>
</li>
<li>
<p><a href="#i1006277">Creating Additional Copies, Renaming, and Relocating Control Files</a></p>
</li>
<li>
<p><a href="#i1006293">Creating New Control Files</a></p>
</li>
</ul>
<a id="i1006257"></a>
<div id="ADMIN11287" class="sect2">
<h3 class="sect2">Creating Initial Control Files</h3>
<p><a id="sthref1223"></a><a id="sthref1224"></a><a id="sthref1225"></a>The initial control files of an Oracle Database are created when you issue the <code dir="ltr">CREATE DATABASE</code> statement. The names of the control files are specified by the <code dir="ltr">CONTROL_FILES</code> parameter in the initialization parameter file used during database creation. The filenames specified in <code dir="ltr">CONTROL_FILES</code> should be fully specified and are operating system specific. The following is an example of a <code dir="ltr">CONTROL_FILES</code> initialization parameter:</p>
<pre dir="ltr">
CONTROL_FILES = (/u01/oracle/prod/control01.ctl,
                 /u02/oracle/prod/control02.ctl, 
                 /u03/oracle/prod/control03.ctl)
</pre>
<p><a id="sthref1226"></a><a id="sthref1227"></a><a id="sthref1228"></a>If files with the specified names currently exist at the time of database creation, you must specify the <code dir="ltr">CONTROLFILE REUSE</code> clause in the <code dir="ltr">CREATE DATABASE</code> statement, or else an error occurs. Also, if the size of the old control file differs from the <code dir="ltr">SIZE</code> parameter of the new one, you cannot use the <code dir="ltr">REUSE</code> clause.</p>
<p>The size of the control file changes between some releases of Oracle Database, as well as when the number of files specified in the control file changes. Configuration parameters such as <code dir="ltr">MAXLOGFILES</code>, <code dir="ltr">MAXLOGMEMBERS</code>, <code dir="ltr">MAXLOGHISTORY</code>, <code dir="ltr">MAXDATAFILES</code>, and <code dir="ltr">MAXINSTANCES</code> affect control file size.</p>
<p>You can subsequently change the value of the <code dir="ltr">CONTROL_FILES</code> initialization parameter to add more control files or to change the names or locations of existing control files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
Your operating system specific Oracle documentation contains more information about specifying control files.</div>
</div>
<!-- class="sect2" -->
<a id="i1006277"></a>
<div id="ADMIN11288" class="sect2">
<h3 class="sect2">Creating Additional Copies, Renaming, and Relocating Control Files</h3>
<p><a id="sthref1229"></a><a id="sthref1230"></a><a id="sthref1231"></a><a id="sthref1232"></a><a id="sthref1233"></a><a id="sthref1234"></a><a id="sthref1235"></a>You can create an additional control file copy for multiplexing by copying an existing control file to a new location and adding the file name to the list of control files. Similarly, you rename an existing control file by copying the file to its new name or location, and changing the file name in the control file list. In both cases, to guarantee that control files do not change during the procedure, shut down the database before copying the control file.</p>
<p>To add a multiplexed copy of the current control file or to rename a control file:</p>
<ol>
<li>
<p>Shut down the database.</p>
</li>
<li>
<p>Copy an existing control file to a new location, using operating system commands.</p>
</li>
<li>
<p>Edit the <code dir="ltr">CONTROL_FILES</code> parameter in the database initialization parameter file to add the new control file name, or to change the existing control filename.</p>
</li>
<li>
<p>Restart the database.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="i1006293"></a>
<div id="ADMIN11289" class="sect2">
<h3 class="sect2">Creating New Control Files</h3>
<p>This section discusses when and how to create new control files.</p>
<a id="i1006296"></a>
<div id="ADMIN11290" class="sect3">
<h4 class="sect3">When to Create New Control Files</h4>
<p>It is necessary for you to create new control files in the following situations:</p>
<ul>
<li>
<p>All control files for the database have been permanently damaged and you do not have a control file backup.</p>
</li>
<li>
<p>You want to change the database name.</p>
<p>For example, you would change a database name if it conflicted with another database name in a distributed environment.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can change the database name and DBID (internal database identifier) using the DBNEWID utility. See <a class="olink SUTIL014" href="../../server.112/e22490/dbnewid.htm#SUTIL014"><span class="italic">Oracle Database Utilities</span></a> for information about using this utility.</div>
</li>
<li>
<p>The compatibility level is set to a value that is earlier than 10.2.0, <a id="sthref1236"></a>and you must make a change to an area of database configuration that relates to any of the following parameters from the <code dir="ltr">CREATE</code> <code dir="ltr">DATABASE</code> or <code dir="ltr">CREATE</code> <code dir="ltr">CONTROLFILE</code> commands: <code dir="ltr">MAXLOGFILES</code>, <code dir="ltr">MAXLOGMEMBERS</code>, <code dir="ltr">MAXLOGHISTORY</code>, and <code dir="ltr">MAXINSTANCES</code>. If compatibility is 10.2.0 or later, you do not have to create new control files when you make such a change; the control files automatically expand, if necessary, to accommodate the new configuration information.</p>
<p>For example, assume that when you created the database or re-created the control files, you set <code dir="ltr">MAXLOGFILES</code> to 3. Suppose that now you want to add a fourth redo log file group to the database with the <code dir="ltr">ALTER DATABASE</code> command. If compatibility is set to 10.2.0 or later, you can do so and the control files automatically expand to accommodate the new log file information. However, with compatibility set earlier than 10.2.0, your <code dir="ltr">ALTER DATABASE</code> command would generate an error, and you would have to first create new control files.</p>
<p>For information on compatibility level, see <a href="create.htm#i1014800">"About The COMPATIBLE Initialization Parameter"</a>.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="i1106303"></a>
<div id="ADMIN11291" class="sect3">
<h4 class="sect3">The CREATE CONTROLFILE Statement</h4>
<p><a id="sthref1237"></a><a id="sthref1238"></a><a id="sthref1239"></a><a id="sthref1240"></a><a id="sthref1241"></a><a id="sthref1242"></a><a id="sthref1243"></a><a id="sthref1244"></a><a id="sthref1245"></a>You can create a new control file for a database using the <code dir="ltr">CREATE CONTROLFILE</code> statement. The following statement creates a new control file for the <code dir="ltr">prod</code> database (a database that formerly used a different database name):</p>
<pre dir="ltr">
CREATE CONTROLFILE
   SET DATABASE prod
   LOGFILE GROUP 1 ('/u01/oracle/prod/redo01_01.log', 
                    '/u01/oracle/prod/redo01_02.log'),
           GROUP 2 ('/u01/oracle/prod/redo02_01.log', 
                    '/u01/oracle/prod/redo02_02.log'),
           GROUP 3 ('/u01/oracle/prod/redo03_01.log', 
                    '/u01/oracle/prod/redo03_02.log') 
   RESETLOGS
   DATAFILE '/u01/oracle/prod/system01.dbf' SIZE 3M,
            '/u01/oracle/prod/rbs01.dbs' SIZE 5M,
            '/u01/oracle/prod/users01.dbs' SIZE 5M,
            '/u01/oracle/prod/temp01.dbs' SIZE 5M
   MAXLOGFILES 50
   MAXLOGMEMBERS 3
   MAXLOGHISTORY 400
   MAXDATAFILES 200
   MAXINSTANCES 6
   ARCHIVELOG;
</pre>
<div class="infobox-note">
<p class="notep1">Cautions:</p>
<ul>
<li>
<p>The <code dir="ltr">CREATE CONTROLFILE</code> statement can potentially damage specified data files and redo log files. Omitting a filename can cause loss of the data in that file, or loss of access to the entire database. Use caution when issuing this statement and be sure to follow the instructions in <a href="#i1006360">"Steps for Creating New Control Files"</a>.</p>
</li>
<li>
<p>If the database had forced logging enabled before creating the new control file, and you want it to continue to be enabled, then you must specify the <code dir="ltr">FORCE LOGGING</code> clause in the <code dir="ltr">CREATE CONTROLFILE</code> statement. See <a href="create.htm#i1009449">"Specifying FORCE LOGGING Mode"</a>.</p>
</li>
</ul>
</div>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01203" href="../../server.112/e41084/statements_5003.htm#SQLRF01203"><span class="italic">Oracle Database SQL Language Reference</span></a> describes the complete syntax of the <code dir="ltr">CREATE CONTROLFILE</code> statement</div>
</div>
<!-- class="sect3" -->
<a id="i1006360"></a>
<div id="ADMIN11292" class="sect3">
<h4 class="sect3">Steps for Creating New Control Files</h4>
<p>Complete the following steps to create a new control file.</p>
<ol>
<li>
<p>Make a list of all data files and redo log files of the database.</p>
<p>If you follow recommendations for control file backups as discussed in <a href="#i1006485">"Backing Up Control Files"</a> , you will already have a list of data files and redo log files that reflect the current structure of the database. However, if you have no such list, executing the following statements will produce one.</p>
<pre dir="ltr">
SELECT MEMBER FROM V$LOGFILE;
SELECT NAME FROM V$DATAFILE; 
SELECT VALUE FROM V$PARAMETER WHERE NAME = 'control_files';
</pre>
<p>If you have no such lists and your control file has been damaged so that the database cannot be opened, try to locate all of the data files and redo log files that constitute the database. Any files not specified in step <a href="#i1006387">5</a> are not recoverable once a new control file has been created. Moreover, if you omit any of the files that comprise the <code dir="ltr">SYSTEM</code> tablespace, you might not be able to recover the database.</p>
</li>
<li>
<p>Shut down the database.</p>
<p>If the database is open, shut down the database normally if possible. Use the <code dir="ltr">IMMEDIATE</code> or <code dir="ltr">ABORT</code> clauses only as a last resort.</p>
</li>
<li id="i1006381">
<p>Back up all data files and redo log files of the database.</p>
</li>
<li id="i1006383">
<p>Start up a new instance, but do not mount or open the database:</p>
<pre dir="ltr">
STARTUP NOMOUNT
</pre></li>
<li id="i1006387">
<p>Create a new control file for the database using the <code dir="ltr">CREATE CONTROLFILE</code> statement.</p>
<p><a id="sthref1246"></a>When creating a new control file, specify the <code dir="ltr">RESETLOGS</code> clause if you have lost any redo log groups in addition to control files. In this case, you will need to recover from the loss of the redo logs (step <a href="#i1006408">8</a>). You must specify the <code dir="ltr">RESETLOGS</code> clause if you have renamed the database. <a id="sthref1247"></a>Otherwise, select the <code dir="ltr">NORESETLOGS</code> clause.</p>
</li>
<li id="i1106395">
<p>Store a backup of the new control file on an offline storage device. See <a href="#i1006485">"Backing Up Control Files"</a> for instructions for creating a backup.</p>
</li>
<li>
<p>Edit the <code dir="ltr">CONTROL_FILES</code> initialization parameter for the database to indicate all of the control files now part of your database as created in step <a href="#i1006387">5</a> (not including the backup control file). If you are renaming the database, edit the <code dir="ltr">DB_NAME</code> parameter in your instance parameter file to specify the new name.<a id="sthref1248"></a></p>
</li>
<li id="i1006408">
<p>Recover the database if necessary. If you are not recovering the database, skip to step <a href="#i1006418">9</a>.</p>
<p>If you are creating the control file as part of recovery, recover the database. If the new control file was created using the <code dir="ltr">NORESETLOGS</code> clause (step <a href="#i1006387">5</a>), you can recover the database with complete, closed database recovery.</p>
<p>If the new control file was created using the <code dir="ltr">RESETLOGS</code> clause, you must specify <code dir="ltr">USING BACKUP CONTROL FILE</code>. If you have lost online or archived redo logs or data files, use the procedures for recovering those files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink BRADV" href="../../backup.112/e10642/toc.htm"></a><a class="olink BRADV" href="../../backup.112/e10642/toc.htm"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for information about recovering your database and methods of recovering a lost control file</div>
</li>
<li id="i1006418">
<p>Open the database using one of the following methods:</p>
<ul>
<li>
<p>If you did not perform recovery, or you performed complete, closed database recovery in step <a href="#i1006408">8</a>, open the database normally.</p>
<pre dir="ltr">
ALTER DATABASE OPEN; 
</pre></li>
<li>
<p>If you specified <code dir="ltr">RESETLOGS</code> when creating the control file, use the <code dir="ltr">ALTER DATABASE</code> statement, indicating <code dir="ltr">RESETLOGS</code>.</p>
<pre dir="ltr">
ALTER DATABASE OPEN RESETLOGS;
</pre></li>
</ul>
</li>
</ol>
<p>The database is now open and available for use.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006445"></a>
<div id="ADMIN11293" class="sect1">
<h2 class="sect1">Troubleshooting After Creating <a id="sthref1249"></a>Control Files</h2>
<p>After issuing the <code dir="ltr">CREATE CONTROLFILE</code> statement, you may encounter some errors. This section describes the most common control file errors:</p>
<ul>
<li>
<p><a href="#i1006456">Checking for Missing or Extra Files</a></p>
</li>
<li>
<p><a href="#i1006466">Handling Errors During CREATE CONTROLFILE</a></p>
</li>
</ul>
<a id="i1006456"></a>
<div id="ADMIN11294" class="sect2">
<h3 class="sect2">Checking for Missing or Extra Files</h3>
<p><a id="sthref1250"></a><a id="sthref1251"></a><a id="sthref1252"></a>After creating a new control file and using it to open the database, check the alert log to see if the database has detected inconsistencies between the data dictionary and the control file, such as a data file in the data dictionary includes that the control file does not list.</p>
<p><a id="sthref1253"></a><a id="sthref1254"></a>If a data file exists in the data dictionary but not in the new control file, the database creates a placeholder entry in the control file under the name <code dir="ltr">MISSING</code><code dir="ltr"><span class="codeinlineitalic">nnnn</span></code>, where <code dir="ltr"><span class="codeinlineitalic">nnnn</span></code> is the file number in decimal. <code dir="ltr">MISSING</code><code dir="ltr"><span class="codeinlineitalic">nnnn</span></code> is flagged in the control file as being offline and requiring media recovery.</p>
<p>If the actual data file corresponding to <code dir="ltr">MISSING</code><code dir="ltr"><span class="codeinlineitalic">nnnn</span></code> is read-only or offline normal, then you can make the data file accessible by renaming <code dir="ltr">MISSING</code><code dir="ltr"><span class="codeinlineitalic">nnnn</span></code> to the name of the actual data file. If <code dir="ltr">MISSING</code><code dir="ltr"><span class="codeinlineitalic">nnnn</span></code> corresponds to a data file that was not read-only or offline normal, then you cannot use the rename operation to make the data file accessible, because the data file requires media recovery that is precluded by the results of <code dir="ltr">RESETLOGS</code>. In this case, you must drop the tablespace containing the data file.</p>
<p>Conversely, if a data file listed in the control file is not present in the data dictionary, then the database removes references to it from the new control file. In both cases, the database includes an explanatory message in the alert log to let you know what was found.</p>
</div>
<!-- class="sect2" -->
<a id="i1006466"></a>
<div id="ADMIN11295" class="sect2">
<h3 class="sect2">Handling Errors During CREATE CONTROLFILE</h3>
<p><a id="sthref1255"></a><a id="sthref1256"></a><a id="sthref1257"></a><a id="sthref1258"></a><a id="sthref1259"></a><a id="sthref1260"></a><a id="sthref1261"></a>If Oracle Database sends you an error (usually error <code dir="ltr">ORA-01173</code>, <code dir="ltr">ORA-01176</code>, <code dir="ltr">ORA-01177</code>, <code dir="ltr">ORA-01215</code>, or <code dir="ltr">ORA-01216</code>) when you attempt to mount and open the database after creating a new control file, the most likely cause is that you omitted a file from the <code dir="ltr">CREATE CONTROLFILE</code> statement or included one that should not have been listed. In this case, you should restore the files you backed up in step <a href="#i1006381">3</a> and repeat the procedure from step <a href="#i1006383">4</a>, using the correct filenames.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006485"></a>
<div id="ADMIN11296" class="sect1">
<h2 class="sect1">Backing Up Control Files</h2>
<p>Use the <code dir="ltr">ALTER DATABASE BACKUP CONTROLFILE</code> statement to back up your control files. You have two options:</p>
<ul>
<li>
<p>Back up the control file to a binary file (duplicate of existing control file) using the following statement:</p>
<pre dir="ltr">
ALTER DATABASE BACKUP CONTROLFILE TO '/oracle/backup/control.bkp';
</pre></li>
<li>
<p>Produce SQL statements that can later be used to re-create your control file:</p>
<pre dir="ltr">
ALTER DATABASE BACKUP CONTROLFILE TO TRACE;
</pre>
<p>This command writes a SQL script to a trace file where it can be captured and edited to reproduce the control file. View the alert log to determine the name and location of the trace file.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink BRADV89517" href="../../backup.112/e10642/rcmbckba.htm#BRADV89517"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for more information on backing up your control files</p>
</li>
<li>
<p><a href="diag.htm#CHDGCEIH">"Viewing the Alert Log"</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i1006512"></a>
<div id="ADMIN11297" class="sect1">
<h2 class="sect1">Recovering a Control File Using a Current Copy</h2>
<p>This section presents ways that you can recover your control file from a current backup or from a multiplexed copy.</p>
<div id="ADMIN11298" class="sect2"><a id="sthref1262"></a>
<h3 class="sect2">Recovering from Control File Corruption Using a Control File Copy</h3>
<p>This procedure assumes that one of the control files specified in the <code dir="ltr">CONTROL_FILES</code> parameter is corrupted, that the control file directory is still accessible, and that you have a multiplexed copy of the control file.</p>
<ol>
<li>
<p>With the instance shut down, use an operating system command to overwrite the bad control file with a good copy:</p>
<pre dir="ltr">
% cp /u03/oracle/prod/control03.ctl  /u02/oracle/prod/control02.ctl
</pre></li>
<li>
<p>Start SQL*Plus and open the database:</p>
<pre dir="ltr">
SQL&gt; STARTUP
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<div id="ADMIN11299" class="sect2"><a id="sthref1263"></a>
<h3 class="sect2">Recovering from Permanent Media Failure Using a Control File Copy</h3>
<p>This procedure assumes that one of the control files specified in the <code dir="ltr">CONTROL_FILES</code> parameter is inaccessible due to a permanent media failure and that you have a multiplexed copy of the control file.</p>
<ol>
<li>
<p>With the instance shut down, use an operating system command to copy the current copy of the control file to a new, accessible location:</p>
<pre dir="ltr">
% cp /u01/oracle/prod/control01.ctl  /u04/oracle/prod/control03.ctl
</pre></li>
<li>
<p>Edit the <code dir="ltr">CONTROL_FILES</code> parameter in the initialization parameter file to replace the bad location with the new location:</p>
<pre dir="ltr">
CONTROL_FILES = (/u01/oracle/prod/control01.ctl,
                 /u02/oracle/prod/control02.ctl, 
                 /u04/oracle/prod/control03.ctl)
</pre></li>
<li>
<p>Start SQL*Plus and open the database:</p>
<pre dir="ltr">
SQL&gt; STARTUP
</pre></li>
</ol>
<p>If you have multiplexed control files, you can get the database started up quickly by editing the <code dir="ltr">CONTROL_FILES</code> initialization parameter. Remove the bad control file from <code dir="ltr">CONTROL_FILES</code> setting and you can restart the database immediately. Then you can perform the reconstruction of the bad control file and at some later time shut down and restart the database after editing the <code dir="ltr">CONTROL_FILES</code> initialization parameter to include the recovered control file.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1106536"></a>
<div id="ADMIN11300" class="sect1">
<h2 class="sect1">Dropping Control Files</h2>
<p><a id="sthref1264"></a>You want to drop control files from the database, for example, if the location of a control file is no longer appropriate. Remember that the database should have at least two control files at all times.</p>
<ol>
<li>
<p>Shut down the database.</p>
</li>
<li>
<p>Edit the <code dir="ltr">CONTROL_FILES</code> parameter in the database initialization parameter file to delete the old control file name.</p>
</li>
<li>
<p>Restart the database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
This operation does not physically delete the unwanted control file from the disk. Use operating system commands to delete the unnecessary file after you have dropped the control file from the database.</div>
</li>
</ol>
</div>
<!-- class="sect1" -->
<a id="i1006548"></a>
<div id="ADMIN11301" class="sect1">
<h2 class="sect1">Control Files Data Dictionary Views<a id="sthref1265"></a><a id="sthref1266"></a></h2>
<p>The following views display information about control files:</p>
<div class="inftblruleinformal">
<table class="cellalignment1333" title="Viewing Information About Control Files" summary="The first column lists views that display information about control files. The second column describes each view." dir="ltr">
<thead>
<tr class="cellalignment1327">
<th class="cellalignment1334" id="r1c1-t12">View</th>
<th class="cellalignment1334" id="r1c2-t12">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r2c1-t12" headers="r1c1-t12"><code dir="ltr">V$DATABASE</code></td>
<td class="cellalignment1335" headers="r2c1-t12 r1c2-t12">Displays database information from the control file</td>
</tr>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r3c1-t12" headers="r1c1-t12"><code dir="ltr">V$CONTROLFILE</code></td>
<td class="cellalignment1335" headers="r3c1-t12 r1c2-t12">Lists the names of control files</td>
</tr>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r4c1-t12" headers="r1c1-t12"><code dir="ltr">V$CONTROLFILE_RECORD_SECTION</code></td>
<td class="cellalignment1335" headers="r4c1-t12 r1c2-t12">Displays information about control file record sections</td>
</tr>
<tr class="cellalignment1327">
<td class="cellalignment1335" id="r5c1-t12" headers="r1c1-t12"><code dir="ltr">V$PARAMETER</code></td>
<td class="cellalignment1335" headers="r5c1-t12 r1c2-t12">Displays the names of control files as specified in the <code dir="ltr">CONTROL_FILES</code> initialization parameter</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblruleinformal" -->
<p>This example lists the names of the control files.</p>
<pre dir="ltr">
SQL&gt; SELECT NAME FROM V$CONTROLFILE;

NAME
-------------------------------------
/u01/oracle/prod/control01.ctl
/u02/oracle/prod/control02.ctl 
/u03/oracle/prod/control03.ctl
</pre></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1326">
<tr>
<td class="cellalignment1335">
<table class="cellalignment1331">
<tr>
<td class="cellalignment1330"><a href="part2.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1330"><a href="onlineredo.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2001, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1337">
<table class="cellalignment1329">
<tr>
<td class="cellalignment1330"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1330"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1330"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1330"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1330"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1330"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
