<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Using Partitioning for Information Lifecycle Management</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 037" />
<meta name="dcterms.created" content="2011-09-27T4:11:52Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database VLDB and Partitioning Guide" />
<meta name="dcterms.identifier" content="E25523-01" />
<meta name="dcterms.isVersionOf" content="VLDBG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="part_admin005.htm" title="Previous" type="text/html" />
<link rel="Next" href="part_warehouse.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e25523.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">14/27</span> <!-- End Header --><a id="CACECAFB"></a><a id="VLDBG007"></a>
<h1 class="chapter"><span class="secnum">5</span> Using Partitioning for Information Lifecycle Management</h1>
<p><a id="sthref657"></a>This chapter discusses the components in Oracle Database which can build an Information Lifecycle Management (ILM) strategy to manage and maintain data.</p>
<p>Although most organizations have long regarded their stores of data as one of their most valuable corporate assets, how this data was managed and maintained varies enormously from company to company. Originally, data was used to help achieve operational goals, run the business, and help identify the future direction and success of the company.</p>
<p>However, new government regulations and guidelines are a key driving force in how and why data is being retained. Regulations now require organizations to retain and control information for very long periods of time. Consequently, today there are two additional objectives that information technology (IT) managers are trying to satisfy: to store vast quantities of data for the lowest possible cost and to meet the new regulatory requirements for data retention and protection.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#CACFJDGE">What Is ILM?</a></p>
</li>
<li>
<p><a href="#CACBAJFI">Implementing ILM Using Oracle Database</a></p>
</li>
<li>
<p><a href="#CACHIJIB">The Benefits of an Online Archive</a></p>
</li>
<li>
<p><a href="#CACGCIIF">Oracle ILM Assistant</a></p>
</li>
<li>
<p><a href="#CACEABBJ">Implementing an ILM System Manually</a></p>
</li>
</ul>
<a id="CACFJDGE"></a><a id="VLDBG1283"></a>
<div class="sect1">
<h2 class="sect1">What Is ILM?</h2>
<p><a id="sthref658"></a>Information today comes in a wide variety of types, for example an e-mail message, a photograph, or an order in an Online Transaction Processing (OLTP) System. After you know the type of data and how it is used, you have an understanding of what its evolution and final destiny is likely to be.</p>
<p>One challenge facing each organization is to understand how its data evolves and grows, monitor how its usage changes over time, and decide how long it should survive, while adhering to all the rules and regulations that now apply to that data. Information Lifecycle Management (ILM) is designed to address these issues, with a combination of processes, policies, software, and hardware so that the appropriate technology can be used for each stage in the lifecycle of the data.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDJABFD">Oracle Database for ILM</a></p>
</li>
<li>
<p><a href="#CHDHADEC">Regulatory Requirements</a></p>
</li>
</ul>
<a id="CHDJABFD"></a><a id="VLDBG1284"></a>
<div class="sect2">
<h3 class="sect2">Oracle Database for ILM</h3>
<p><a id="sthref659"></a>Oracle Database provides the ideal platform for implementing an ILM solution, because it offers:</p>
<ul>
<li>
<p>Application Transparency</p>
<p><a id="sthref660"></a>Application transparency is very important in ILM because it means that there is no need to customize applications and it also enables various changes to be made to the data without any effect on the applications that are using that data. Data can easily be moved at the different stages of its lifecycle and access to the data can be optimized with the database. Another important benefit is that application transparency offers the flexibility required to quickly adapt to any new regulatory requirements, again without any impact on the existing applications.</p>
</li>
<li>
<p>Fine-grained data</p>
<p><a id="sthref661"></a>Oracle can view data at a very fine-grained level and group related data, whereas storage devices only see bytes and blocks.</p>
</li>
<li>
<p>Low-Cost Storage</p>
<p><a id="sthref662"></a>With so much data to retain, using low cost storage is a key factor in implementing ILM. Because Oracle can take advantage of many types of storage devices, the maximum amount of data can be held for the lowest possible cost.</p>
</li>
<li>
<p>Enforceable Compliance Policies</p>
<p><a id="sthref663"></a>When information is kept for compliance reasons, it is imperative to show to regulatory bodies that data is being retained and managed in accordance with the regulations. Within Oracle Database, it is possible to define security and audit policies, which enforce and log all access to data.</p>
</li>
</ul>
<a id="VLDBG1285"></a>
<div class="sect3"><a id="sthref664"></a>
<h4 class="sect3">Oracle Database Manages All Types of Data</h4>
<p><a id="sthref665"></a>Information Lifecycle Management is concerned with all data in an organization. This includes not just structured data, such as orders in an OLTP system or a history of sales in a data warehouse, but also unstructured data, such as e-mail, documents, and images.</p>
<p>Although Oracle Database supports the storing of unstructured data with BLOBs and Oracle Fast Files, a sophisticated document management system is available in Oracle Content Database, when used with the Enterprise Edition. It includes role-based security to ensure that content is only accessed by authorized personnel and policies which describe what happens to the content during its lifetime.</p>
<p>If all of the information in your organization is contained in an Oracle database, then you can take advantage of the features and functionality provided by the database to manage and move the data as it evolves during its lifetime, without having to manage multiple types of data stores.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDHADEC"></a><a id="VLDBG1286"></a>
<div class="sect2">
<h3 class="sect2">Regulatory Requirements</h3>
<p><a id="sthref666"></a>Today, many organizations must retain specific data for a specific time period. Failure to follow these regulations could result in organizations having to pay very heavy fines. Around the world various regulatory requirements, such as Sarbanes-Oxley, HIPAA, DOD5015.2-STD in the US and the European Data Privacy Directive in the European Union, are changing how organizations manage their data. These regulations specify what data must be retained, whether it can be changed, and for how long it must be retained, which could be for a period of 30 years or longer.</p>
<p>These regulations frequently demand that electronic data is secure from unauthorized access and changes, and that there is an audit trail of all changes to data and by whom. Oracle Database can retain huge quantities of data without impacting application performance. It also contains the features required to restrict access and prevent unauthorized changes to data, and can be further enhanced with Oracle Database Vault and Oracle Audit Vault. Oracle Database also provides cryptographic functions that can demonstrate that a highly privileged user has not intentionally modified data. Flashback Data Archive can show all the versions of a row during its lifetime.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACBAJFI"></a><a id="VLDBG1287"></a>
<div class="sect1">
<h2 class="sect1">Implementing ILM Using Oracle Database</h2>
<p><a id="sthref667"></a><a id="sthref668"></a>Building an Information Lifecycle Management solution using Oracle Database is quite straightforward and can be completed by following these four simple steps, although Step 4 is optional if ILM is not being implemented for compliance:</p>
<ul>
<li>
<p><a href="#CACDGBAF">Step 1: Define the Data Classes</a></p>
</li>
<li>
<p><a href="#CACBCDBI">Step 2: Create Storage Tiers for the Data Classes</a></p>
</li>
<li>
<p><a href="#CACIGDAC">Step 3: Create Data Access and Migration Policies</a></p>
</li>
<li>
<p><a href="#CACHIFAJ">Step 4: Define and Enforce Compliance Policies</a></p>
</li>
</ul>
<a id="CACDGBAF"></a><a id="VLDBG1288"></a>
<div class="sect2">
<h3 class="sect2">Step 1: Define the Data Classes</h3>
<p><a id="sthref669"></a>To make effective use of Information Lifecycle Management, the first step is to look at all the data in your organization and determine:</p>
<ul>
<li>
<p>What data is important, where is it stored, and what must be retained</p>
</li>
<li>
<p>How this data flows within the organization</p>
</li>
<li>
<p>What happens to this data over time and whether it is still required</p>
</li>
<li>
<p>The degree of data availability and protection that is needed</p>
</li>
<li>
<p>Data retention for legal and business requirements</p>
</li>
</ul>
<p>After there is an understanding of how the data is used, the data can then be classified on this basis. The most common type of classification is by age or date, but other types are possible, such as by product or privacy. A hybrid classification could also be used, such as by privacy and age.</p>
<p>To treat the data classes differently, the data must be physically separated. When information is first created, the information is often frequently accessed, but then over time it may be referenced very infrequently. For instance, when a customer places an order, they regularly look at the order to see its status and whether the order has been shipped. After the order arrives, they may never reference that order again. This order would also be included in regular reports that are run to see what goods are being ordered, but, over time, would not figure in any of the reports and may only be referenced in the future if someone does a detailed analysis that involves this data. For example, orders could be classified by the Financial Quarters Q1, Q2, Q3, and Q4, and as Historical Orders.</p>
<p>The advantage of using this approach is that when the data is grouped at the row level by its class, which in this example would be the date of the order, all orders for Q1 can be managed as a self contained unit, where as the orders for Q2 would reside in a different class. This can be achieved by using partitioning. Because partitions are completely transparent to the application, the data is physically separated but the application still locates all the orders.</p>
<a id="VLDBG1289"></a>
<div class="sect3"><a id="sthref670"></a>
<h4 class="sect3">Partitioning</h4>
<p><a id="sthref671"></a>Partitioning involves physically placing data according to a data value, and a frequently used technique is to partition information by date. <a href="#CACJJABF">Figure 5-1</a> illustrates a scenario where the orders for Q1, Q2, Q3, and Q4 are stored in individual partitions and the orders for previous years are stored in other partitions.</p>
<div class="figure">
<p class="titleinfigure"><a id="CACJJABF"></a><a id="VLDBG1290"></a>Figure 5-1 Allocating Data Classes to a Partition</p>
<img width="269" height="686" src="img/vldbg021.gif" alt="Description of Figure 5-1 follows" /><br />
<a id="sthref672" href="img_text/vldbg021.htm">Description of "Figure 5-1 Allocating Data Classes to a Partition"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Oracle offers several different partitioning methods. Range partitioning is one frequently used partitioning method for ILM. Interval and reference partitioning are also particularly suited for use in an ILM environment.</p>
<p>There are multiple benefits to partitioning data. Partitioning provides an easy way to distribute the data across appropriate storage devices depending on its usage, while still keeping the data online and stored on the most cost-effective device. Because partitioning is completely transparent to anyone accessing the data, no application changes are required, thus partitioning can be implemented at any time. When new partitions are required, they are simply added using the <code>ADD PARTITION</code> clause or they can be created automatically if interval partitioning is being used.</p>
<p>Among other benefits, each partition can have its own local index. When the optimizer uses partition pruning, queries only access the relevant partitions instead of all partitions, thus improving query response times.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1291"></a>
<div class="sect3"><a id="sthref673"></a>
<h4 class="sect3">The Lifecycle of Data</h4>
<p><a id="sthref674"></a>An analysis of your data is likely to reveal that initially, it is accessed and updated on a very frequent basis. As the age of the data increases, its access frequency diminishes to almost negligible, if any. Most organizations find themselves in the situation where many users are accessing current data while very few users are accessing older data, as illustrated in <a href="#BABDFGBI">Figure 5-2</a>. Data is considered to be: active, less active, historical, or ready to be archived.</p>
<p>With so much data being held, during its lifetime the data should be moved to different physical locations. Depending on where the data is in its lifecycle, it must be located on the most appropriate storage device.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABDFGBI"></a><a id="VLDBG1292"></a>Figure 5-2 Data Usage Over Time</p>
<img width="512" height="260" src="img/vldbg024.gif" alt="Description of Figure 5-2 follows" /><br />
<a id="sthref675" href="img_text/vldbg024.htm">Description of "Figure 5-2 Data Usage Over Time"</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CACBCDBI"></a><a id="VLDBG1293"></a>
<div class="sect2">
<h3 class="sect2">Step 2: Create Storage Tiers for the Data Classes</h3>
<p><a id="sthref676"></a>Because Oracle Database can take advantage of many different storage options, the next step is to establish the required storage tiers. Although you can create as many storage tiers as you require, a suggested starting point are the following tiers:</p>
<ul>
<li>
<p>High Performance</p>
<p>The high performance storage tier is where all the important and frequently accessed data would be stored, such as the partition holding our Q1 orders. This would use smaller, faster disks on high performance storage devices.</p>
</li>
<li>
<p>Low Cost</p>
<p>The low cost storage tier is where the less frequently accessed data is stored, such as the partitions holding the orders for Q2, Q3, and Q4. This tier would be built using large capacity disks, such as those found in modular storage arrays or low costs ATA disks, which offer the maximum amount of inexpensive storage.</p>
</li>
<li>
<p>Online Archive</p>
<p>The online archive storage tier is where all the data that is seldom accessed or modified would be stored. The storage tier is likely to be extremely large and to store the maximum quantity of data. Various techniques can compress the data. This tier could be located in the database or it could be in another database, which serves as a central archive database for all information within the enterprise. Stored on low cost storage devices, such as ATA drives, the data would still be online and available, for a cost that is only slightly higher than storing this information on tape, without the disadvantages that come with archiving data to tape. If the Online Archive storage tier is identified as read-only, then it would be impossible to change the data and subsequent backups would not be required after the initial database backup.</p>
</li>
<li>
<p>Offline Archive (optional)</p>
<p>The offline archive storage tier is an optional tier because it is only used when there is a requirement to remove data from the database and store it in some other format, such as XML on a tape.</p>
</li>
</ul>
<p><a href="#BABDFGBI">Figure 5-2</a> illustrates how data is used over a time interval. Using this information, it can be determined that to retain all this information, several storage tiers are required to hold all of the data, which also has the benefit of significantly reducing total storage costs.</p>
<p>After the storage tiers have been created, the data classes identified in <a href="#CACDGBAF">"Step 1: Define the Data Classes"</a> are physically implemented inside the database using partitions. This approach provides an easy way to distribute the data across the appropriate storage devices depending on its usage, while still keeping the data online and readily available, and stored on the most cost-effective device.</p>
<p>Note that you can also use Oracle Automatic Storage Management (Oracle ASM) to manage the data across the storage tiers. Oracle ASM is a high-performance, ease-of-management storage solution for Oracle Database files. Oracle ASM is a volume manager and provides a file system designed exclusively for use by the database. To use Oracle ASM, you allocate partitioned disks for Oracle Database with preferences for striping and mirroring. Oracle ASM manages the disk space, distributing the I/O load across all available resources to optimize performance while removing the need for manual I/O tuning. For example, you can increase the size of the disk for the database or move parts of the database to new devices without having to shut down the database.</p>
<a id="VLDBG1294"></a>
<div class="sect3"><a id="sthref677"></a>
<h4 class="sect3">Assigning Classes to Storage Tiers</h4>
<p><a id="sthref678"></a>After the storage tiers have been defined, the data classes (partitions) identified in Step 1 can be assigned to the appropriate storage tiers. This provides an easy way to distribute the data across the appropriate storage devices depending on its usage, keeping the data online and available, and stored on the most cost-effective device. This is illustrated in <a href="#CACEAGHI">Figure 5-3</a>. Using this approach, no application changes are required because the data is still visible.</p>
<div class="figure">
<p class="titleinfigure"><a id="CACEAGHI"></a><a id="VLDBG1295"></a>Figure 5-3 Data Lifecycle</p>
<img width="480" height="258" src="img/vldbg025.gif" alt="Description of Figure 5-3 follows" /><br />
<a id="sthref679" href="img_text/vldbg025.htm">Description of "Figure 5-3 Data Lifecycle"</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect3" -->
<a id="VLDBG1296"></a>
<div class="sect3"><a id="sthref680"></a>
<h4 class="sect3">The Costs Savings of Using Tiered Storage</h4>
<p>One benefit of implementing an ILM strategy is the cost savings that can result from using multiple tiered storage. Assume that there is 3 TB of data to store, comprising of 200 GB on High Performance, 800 GB on Low Cost, and 2 TB on Online Archive. Assume the cost per GB is $72 on the High Performance tier, $14 on the Low Cost tier, and $7 on the Online Archive tier.</p>
<p><a href="#CACFCEGC">Table 5-1</a> illustrates the possible cost savings using tiered storage, rather than storing all data on one class of storage. As you can see, the cost savings can be quite significant and, if the data is suitable for database compression, then even further cost savings are possible.</p>
<div class="tblformalwide">
<p class="titleintable"><a id="VLDBG1297"></a><a id="sthref681"></a><a id="CACFCEGC"></a>Table 5-1 Cost Savings Using Tiered Storage</p>
<table class="cellalignment1835" title="Cost Savings Using Tiered Storage" summary="This table illustrates the possible cost savings using tiered storage" dir="ltr">
<thead>
<tr class="cellalignment1829">
<th class="cellalignment1836" id="r1c1-t2">Storage Tier</th>
<th class="cellalignment1836" id="r1c2-t2">Single Tier using High Performance Disks</th>
<th class="cellalignment1836" id="r1c3-t2">Multiple Storage Tiers</th>
<th class="cellalignment1836" id="r1c4-t2">Multiple Tiers with Database Compression</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1829">
<td class="cellalignment1837" id="r2c1-t2" headers="r1c1-t2">
<p>High Performance (200 GB)</p>
</td>
<td class="cellalignment1837" headers="r2c1-t2 r1c2-t2">
<p>$14,400</p>
</td>
<td class="cellalignment1837" headers="r2c1-t2 r1c3-t2">
<p>$14,400</p>
</td>
<td class="cellalignment1837" headers="r2c1-t2 r1c4-t2">
<p>$14,400</p>
</td>
</tr>
<tr class="cellalignment1829">
<td class="cellalignment1837" id="r3c1-t2" headers="r1c1-t2">
<p>Low Cost (800 GB)</p>
</td>
<td class="cellalignment1837" headers="r3c1-t2 r1c2-t2">
<p>$57,600</p>
</td>
<td class="cellalignment1837" headers="r3c1-t2 r1c3-t2">
<p>$11,200</p>
</td>
<td class="cellalignment1837" headers="r3c1-t2 r1c4-t2">
<p>$11,200</p>
</td>
</tr>
<tr class="cellalignment1829">
<td class="cellalignment1837" id="r4c1-t2" headers="r1c1-t2">
<p>Online Archive (2 TB)</p>
</td>
<td class="cellalignment1837" headers="r4c1-t2 r1c2-t2">
<p>$144,000</p>
</td>
<td class="cellalignment1837" headers="r4c1-t2 r1c3-t2">
<p>$14,000</p>
</td>
<td class="cellalignment1837" headers="r4c1-t2 r1c4-t2">
<p>$5,600</p>
</td>
</tr>
<tr class="cellalignment1829">
<td class="cellalignment1837" id="r5c1-t2" headers="r1c1-t2">&nbsp;</td>
<td class="cellalignment1837" headers="r5c1-t2 r1c2-t2">
<p>$216,000</p>
</td>
<td class="cellalignment1837" headers="r5c1-t2 r1c3-t2">
<p>$39,600</p>
</td>
<td class="cellalignment1837" headers="r5c1-t2 r1c4-t2">
<p>$31,200</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformalwide" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CACIGDAC"></a><a id="VLDBG1298"></a>
<div class="sect2">
<h3 class="sect2">Step 3: Create Data Access and Migration Policies</h3>
<p><a id="sthref682"></a><a id="sthref683"></a>The next step is to ensure that only authorized users have access to the data and to specify how to move the data during its lifetime. As the data ages, there are multiple techniques that can migrate the data between the storage tiers.</p>
<a id="VLDBG1299"></a>
<div class="sect3"><a id="sthref684"></a>
<h4 class="sect3">Controlling Access to Data</h4>
<p><a id="sthref685"></a>The security of your data is another very important part of Information Lifecycle Management because the access rights to the data may change during its lifetime. In addition, there may be regulatory requirements that place exacting demands on how the data can be accessed.</p>
<p>The data in an Oracle Database can be secured using database features, such as:</p>
<ul>
<li>
<p>Database Security</p>
</li>
<li>
<p>Views</p>
</li>
<li>
<p>Virtual Private Database</p>
</li>
</ul>
<p>Virtual Private Database (VPD) defines a very fine-grained level of access to the database. Security policies determine which rows may be viewed and the columns that are visible. Multiple policies can be defined so that different users and applications see different views of the same data. For example, the majority of users could see the information for Q1, Q2, Q3, and Q4, while only authorized users would be able to view the historical data.</p>
<p>A security policy is defined at the database level and is transparently applied to all database users. The benefit of this approach is that it provides a secure and controlled environment for accessing the data, which cannot be overridden and can be implemented without requiring any application changes. In addition, read-only tablespaces can be defined which ensures that the data does not change.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1300"></a>
<div class="sect3"><a id="sthref686"></a>
<h4 class="sect3">Moving Data using Partitioning</h4>
<p><a id="sthref687"></a>During its lifetime, data must be moved. This may occur for the following reasons:</p>
<ul>
<li>
<p>For performance, only a limited number of orders are held on high performance disks</p>
</li>
<li>
<p>Data is no longer frequently accessed and is using valuable high performance storage, and must be moved to a low-cost storage device</p>
</li>
<li>
<p>Legal requirements demand that the information is always available for a given time interval, and it must be held safely for the lowest possible cost</p>
</li>
</ul>
<p>There are multiple ways that data can be physically moved in Oracle Database to take advantage of the different storage tiers. For example, if the data is partitioned, then a partition containing the orders for Q2 could be moved online from the high performance storage tier to the low cost storage tier. Because the data is being moved within the database, it can be physically moved, without affecting the applications that require it or causing disruption to regular users.</p>
<p>Sometimes individual data items, rather than a group of data, must be moved. For example, suppose data was classified according to a level of privacy and a report, which had been secret, is now to be made available to the public. If the classification changed from secret to public and the data was partitioned on its privacy classification, then the row would automatically move to the partition containing public data.</p>
<p>Whenever data is moved from its original source, it is very important to ensure that the process selected adheres to any regulatory requirements, such as, the data cannot be altered, is secure from unauthorized access, easily readable, and stored in an approved location.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CACHIFAJ"></a><a id="VLDBG1301"></a>
<div class="sect2">
<h3 class="sect2">Step 4: Define and Enforce Compliance Policies</h3>
<p><a id="sthref688"></a><a id="sthref689"></a>The last step in an Information Lifecycle Management solution is the creation of policies for compliance. When data is decentralized and fragmented, compliance policies have to be defined and enforced in every data location, which could easily result in a compliance policy being overlooked. However, using Oracle Database to provide a central location for storing data means that it is very easy to enforce compliance policies because they are all managed and enforced from one central location.</p>
<p>When defining compliance policies, consider the following areas:</p>
<ul>
<li>
<p>Data Retention</p>
</li>
<li>
<p>Immutability</p>
</li>
<li>
<p>Privacy</p>
</li>
<li>
<p>Auditing</p>
</li>
<li>
<p>Expiration</p>
</li>
</ul>
<a id="VLDBG1302"></a>
<div class="sect3"><a id="sthref690"></a>
<h4 class="sect3">Data Retention</h4>
<p><a id="sthref691"></a>The retention policy describes how the data is to be retained, how long it must be kept, and what happens after data life. An example of a retention policy is a record must be stored in its original form, no modifications are allowed, it must be kept for seven years, and then it may be deleted. Using Oracle Database security, it is possible to ensure that data remains unchanged and that only authorized processes can remove the data at the appropriate time. Retention policies can also be defined through a lifecycle definition in the ILM Assistant.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1303"></a>
<div class="sect3"><a id="sthref692"></a>
<h4 class="sect3">Immutability</h4>
<p><a id="sthref693"></a>Immutability is concerned with proving to an external party that data is complete and has not been modified. Cryptographic or digital signatures can be generated by Oracle Database and retained either inside or outside of the database, to show that data has not been altered.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1304"></a>
<div class="sect3"><a id="sthref694"></a>
<h4 class="sect3">Privacy</h4>
<p><a id="sthref695"></a>Oracle Database provides several ways to ensure data privacy. Access to data can be strictly controlled with security policies defined using Virtual Private Database (VPD). In addition, individual columns can be encrypted so that anyone looking at the raw data cannot see its contents.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1305"></a>
<div class="sect3"><a id="sthref696"></a>
<h4 class="sect3">Auditing</h4>
<p><a id="sthref697"></a>Oracle Database can track all access and changes to data. These auditing capabilities can be defined either at the table level or through fine-grained auditing, which specifies the criteria for when an audit record is generated. Auditing can be further enhanced using Audit Vault.</p>
</div>
<!-- class="sect3" -->
<a id="VLDBG1306"></a>
<div class="sect3"><a id="sthref698"></a>
<h4 class="sect3">Expiration</h4>
<p><a id="sthref699"></a>Ultimately, data may expire for business or regulatory reasons and must be removed from the database. Oracle Database can remove data very quickly and efficiently by simply dropping the partition which contains the information identified for removal.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACHIJIB"></a><a id="VLDBG1307"></a>
<div class="sect1">
<h2 class="sect1">The Benefits of an Online Archive</h2>
<p><a id="sthref700"></a>There usually comes a point during the lifecycle of the data when it is no longer being regularly accessed and is considered eligible for archiving. Traditionally, the data would have been removed from the database and stored on tape, because it can store vast quantities of information for a very low cost. Today, it is no longer necessary to archive that data to tape, instead it can remain in the database, or transferred to a central online archive database. All this information would be stored using low-cost storage devices whose cost per gigabyte is very close to that of tape.</p>
<p>There are multiple benefits to keeping all of the data in a database for archival purposes. The most important benefit is that the data always be instantly available. Therefore, time is not wasted locating the tapes where the data was archived and determining whether the tape is readable and still in a format that can be loaded into the database.</p>
<p>If the data has been archived for many years, then development time may also be needed to write a program to reload the data into the database from the tape archive. This could prove to be expensive and time consuming, especially if the data is extremely old. If the data is retained in the database, then this is not a problem, because it is online, and in the latest database format.</p>
<p>Holding the historical data in the database no longer impacts the time required to backup the database and the size of the backup. When RMAN is used to back up the database, it only includes in the backup the data that has changed. Because historical data is less likely to change, after the data has been backed up, it is not backed up again.</p>
<p>Another important factor to consider is how the data is to be physically removed from the database, especially if it is to be transferred from a production system to a central database archive. Oracle provides the capability to move this data rapidly between databases by using transportable tablespaces or partitions, which moves the data as a complete unit.</p>
<p>When it is time to remove data from the database, the fastest way is to remove a set of data. This is achieved by keeping the data in its own partition. The partition can be dropped, which is a very fast operation. However, if this approach is not possible because data relationships must be maintained, then a conventional SQL delete statement must be issued. You should not underestimate the time required to issue the delete statement.</p>
<p>If there is a requirement to remove data from the database and there is a possibility that the data may need to be returned to the database in the future, then consider removing the data in a database format such as a transportable tablespace, or use the XML capability of Oracle Database to extract the information in an open format.</p>
<p>Consider an online archive of your data into an Oracle database for the following reasons:</p>
<ul>
<li>
<p>The cost of disk is approaching that of tape, eliminate the time to find the tape that contains the data and the cost of restoring that data</p>
</li>
<li>
<p>Data remains online when needed, faster access to meet business requirements</p>
</li>
<li>
<p>Data online means immediate access, so cannot be fined by regulatory body for failing to produce data</p>
</li>
<li>
<p>Use the current application to access the data, no need to waste resources to build a new application</p>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="CACGCIIF"></a><a id="VLDBG1308"></a>
<div class="sect1">
<h2 class="sect1">Oracle ILM Assistant</h2>
<p><a id="sthref701"></a><a id="sthref702"></a><a id="sthref703"></a>Oracle ILM Assistant provides a graphical user interface (GUI) for managing your ILM environment. <a href="#BABICIHG">Figure 5-4</a> shows the first screen of the ILM Assistant, which lists the outstanding tasks that should be performed.</p>
<div class="figure">
<p class="titleinfigure"><a id="BABICIHG"></a><a id="VLDBG1309"></a>Figure 5-4 ILM Assistant Initial Screen</p>
<img width="597" height="378" src="img/ilm_fig7.gif" alt="Description of Figure 5-4 follows" /><br />
<a id="sthref704" href="img_text/ilm_fig7.htm">Description of "Figure 5-4 ILM Assistant Initial Screen"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The ILM Assistant provides the ability to create lifecycle definitions, which are assigned to tables in the database. Using this lifecycle definition, the ILM Assistant advises when it is time to move, archive, or delete data, as shown by the calendar. It also illustrates the storage requirements and cost savings associated with moving the data.</p>
<p>The ILM Assistant can manage only partitioned tables. For nonpartitioned tables, the ILM Assistant generates a script to show how the table could be partitioned, and it also provides the capability to simulate partitioning on a table to view the actions that would arise if the table were partitioned.</p>
<p>The ILM Assistant does not execute any commands for the tasks it recommends to be performed, such as migrating data to different storage tiers. Instead, it generates a script of the commands that must be executed.</p>
<p>To assist with managing compliance issues, the ILM Assistant shows all Virtual Private Databases (VPD) and Fine-Grained Audit (FGA) policies that have been defined on tables under ILM control. In addition, both Database and FGA audit records can be viewed and digital signatures generated and compared.</p>
<p>Oracle ILM Assistant requires that Oracle Application Express is installed in the database where the tables to be managed by the ILM Assistant reside.</p>
<p>The ILM Assistant provides capability in the following areas:</p>
<ul>
<li>
<p><a href="#CHDCICEB">Lifecycle Setup</a></p>
</li>
<li>
<p><a href="#CHDBJDEB">Lifecycle Management</a></p>
</li>
<li>
<p><a href="#CHDCCEHB">Compliance &amp; Security</a></p>
</li>
<li>
<p><a href="#CHDBJGIA">Reports</a></p>
</li>
</ul>
<a id="CHDCICEB"></a><a id="VLDBG1310"></a>
<div class="sect2">
<h3 class="sect2">Lifecycle Setup</h3>
<p><a id="sthref705"></a><a id="sthref706"></a>The <span class="bold">Lifecycle Setup</span> area of the ILM Assistant consists of the following tasks that must be performed to prepare for managing your data:</p>
<ul>
<li>
<p><a href="#CHDEFCAD">Logical Storage Tiers</a></p>
</li>
<li>
<p><a href="#CHDEAGHG">Lifecycle Definitions</a></p>
</li>
<li>
<p><a href="#CHDGCFBB">Lifecycle Tables</a></p>
</li>
<li>
<p><a href="#CHDJGBCH">Preferences</a></p>
</li>
</ul>
<p>If this is the first time that you have used the ILM Assistant, then it is here where you specify exactly how the data is to be managed by the ILM Assistant. The following steps must be completed before the ILM Assistant can give advice on data placement, as illustrated in <a href="#CIADDJHG">Figure 5-5</a>.</p>
<ol>
<li>
<p>Define the logical storage tiers</p>
</li>
<li>
<p>Define the lifecycle definitions</p>
</li>
<li>
<p>Select tables to be managed by the lifecycle definitions</p>
</li>
</ol>
<div class="figure">
<p class="titleinfigure"><a id="CIADDJHG"></a><a id="VLDBG1311"></a>Figure 5-5 ILM Assistant: Specifying How Data is Managed</p>
<img width="242" height="203" src="img/vldbg023.gif" alt="Description of Figure 5-5 follows" /><br />
<a id="sthref707" href="img_text/vldbg023.htm">Description of "Figure 5-5 ILM Assistant: Specifying How Data is Managed"</a><br />
<br /></div>
<!-- class="figure" -->
<p>Other options available within setup include the ability to:</p>
<ul>
<li>
<p>View partition simulation</p>
</li>
<li>
<p>View a lifecycle summary of mapped tables and their logical storage tiers and lifecycle definitions</p>
</li>
<li>
<p>View storage costs</p>
</li>
<li>
<p>Define policy notes</p>
</li>
<li>
<p>Customize the ILM Assistant with preferences</p>
</li>
</ul>
<a id="CHDEFCAD"></a><a id="VLDBG1312"></a>
<div class="sect3">
<h4 class="sect3">Logical Storage Tiers</h4>
<p><a id="sthref708"></a>A logical storage tier is a name given to a logical group of storage devices; typically all disks of the same type are identified by that name. For example, the group called High Performance could refer to all the high performance disks. Any number of logical storage tiers may be defined and the devices are identified by the assigned tablespaces, which reside upon them.</p>
<p>The cost per GB value must be a value greater than zero. The value is used by the ILM Assistant to project storage costs when data is mapped to the tier. It is recommended that you enter a value that represents a reasonably accurate cost of storing data on the tier. This would include the physical purchase price of a device. However, you might also want to consider other associated costs, such as maintenance and running costs.</p>
<p>Each storage tier has a set of assigned tablespaces that are labeled as a read/write preferred tablespace, read-only preferred tablespace, or a secondary tablespace. If read/write data can be migrated onto the tier, then the read/write preferred tablespace is required. If the storage tier accepts read-only data, then a read-only preferred tablespace must also be identified.</p>
<p>In addition to the preferred tablespaces, one or more secondary tablespaces may be assigned to the tier. Secondary tablespaces are typically located in the same location as the read/write preferred tablespace for the storage tier.</p>
<p>Because the ILM Assistant only supports a single preferred tablespace, any read/write data that must reside on the tier would generate a migration event to move the data to the read/write preferred tablespace. To avoid unnecessary data migration events, the ILM Assistant allows existing data to remain on a secondary tablespace for the storage tier.</p>
</div>
<!-- class="sect3" -->
<a id="CHDEAGHG"></a><a id="VLDBG1313"></a>
<div class="sect3">
<h4 class="sect3">Lifecycle Definitions</h4>
<p><a id="sthref709"></a>A lifecycle definition describes how data migrates across the logical storage tiers during its lifetime. It consists of one or more lifecycle stages that select a logical storage tier, data attributes such as compression and read only, and a duration for data residing on that lifecycle stage.</p>
<p>A lifecycle definition is valid if it contains at least one lifecycle stage. There must be a final stage, which is either user specified or automatically generated by the ILM Assistant upon completion of the lifecycle definition process. For the final stage you must specify what happens to data at lifecycle end.</p>
<p>A lifecycle definition consists of multiple stages that describe what happens to data during its lifetime. Lifecycle stages are initially created in reverse time order (that is, working backward in time from the current date). Every stage must have a unique name; an optional description can be supplied.</p>
<p>If the stage is not the final stage, then you must specify how long the data is to remain on this stage and any stage attributes such as whether the data should be compressed or set to read only. Note that it is only possible to specify a read only stage if a preferred read only tablespace has been defined for the logical storage tier for this stage.</p>
<p>The current stage represents the present, but can span any length of time. A lifecycle can only have one current stage. The final stage is required as it describes what happens when data reaches its end of life. A lifecycle can only have one final stage and it is automatically created if you do not create one. Possible actions are:</p>
<ul>
<li>
<p>Purge the data</p>
</li>
<li>
<p>Archive the data off-line</p>
</li>
<li>
<p>Allow the data to remain on-line</p>
</li>
</ul>
<p>Stages that store data on-line also permit several attributes to be defined that affect the data. The supported attributes are:</p>
<ul>
<li>
<p>Compress</p>
</li>
<li>
<p>Compress and Read-Only</p>
</li>
<li>
<p>Read-Only</p>
</li>
</ul>
<p>Each stage consists of the following information:</p>
<ul>
<li>
<p>Stage Type</p>
<p>A stage is classified as a current stage, final stage, or unclassified.</p>
</li>
<li>
<p>Stage Name</p>
<p>Displays the user-supplied name of the stage.</p>
</li>
<li>
<p>Stage Description</p>
<p>Displays the user-supplied stage description.</p>
</li>
<li>
<p>Action</p>
<p>Displays the action performed when data maps to the stage. Possible actions are:</p>
<ul>
<li>
<p>Remain Online</p>
</li>
<li>
<p>Archive Offline</p>
</li>
<li>
<p>Purge</p>
</li>
</ul>
</li>
<li>
<p>Tier Name</p>
<p>Displays the storage tier associated with the stage. For a stage that purges data or moves data offline, a tier is not specified.</p>
</li>
<li>
<p>Attributes</p>
<p>Displays the optional data attributes that are applied to data when it maps to the stage. Possible values are:</p>
<ul>
<li>
<p>Compress</p>
</li>
<li>
<p>Compress and Read-Only</p>
</li>
<li>
<p>Read-Only</p>
</li>
</ul>
</li>
<li>
<p>Stage Duration</p>
<p>Displays the length of time the data can remain mapped to the stage.</p>
</li>
<li>
<p>Stage Start Date</p>
<p>Displays the actual calendar date for the beginning of the stage. The date is computed based on the adjacent stages and the user-specified fiscal start date.</p>
</li>
<li>
<p>Stage End Date</p>
<p>Displays the actual calendar date for the end of the stage. The date is computed based on the adjacent stages and the user-specified fiscal start date.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="CHDGCFBB"></a><a id="VLDBG1314"></a>
<div class="sect3">
<h4 class="sect3">Lifecycle Tables</h4>
<p><a id="sthref710"></a>The <span class="bold">Lifecycle Tables</span> area identifies those tables that may be managed by the ILM Assistant, and it is here where these tables are mapped to a lifecycle definition, as illustrated in <a href="#CIABJDBH">Figure 5-6</a>. A database may contain many tables, only some of which you want to consider as candidates for ILM. A table is automatically eligible if it is range partitioned on a date column. When the table is associated with a lifecycle definition, the ILM Assistant can manage its data. For tables having no partitioning, storage cost savings and storage tier migration can be modeled using a simulated partitioning strategy.</p>
<div class="figure">
<p class="titleinfigure"><a id="CIABJDBH"></a><a id="VLDBG1315"></a>Figure 5-6 ILM Assistant: Lifecycle Tables</p>
<img width="655" height="430" src="img/ilm_fig6.gif" alt="Description of Figure 5-6 follows" /><br />
<a id="sthref711" href="img_text/ilm_fig6.htm">Description of "Figure 5-6 ILM Assistant: Lifecycle Tables"</a><br />
<br /></div>
<!-- class="figure" -->
<p>If the table is not yet partitioned, then you are directed to a <span class="bold">Partition Simulation</span> page where you can set up a full simulation. Similar to setting up a managed table, a simulation can be previewed and accepted on this page. Upon returning from the simulation page, the table is now eligible for full lifecycle management in simulation mode.</p>
<p>The difference between a managed table and a simulated table is that a managed table contains actual partitions while a simulated table only contains simulate (not real) partitioning data. All reports and event detection work with both types of lifecycle tables. However, any table upon which partitioning is being simulated is only seen as being partitioned from within the ILM Assistant. All other tools continue to see it as a nonpartitioned table.</p>
<p>Though the lifecycle tables view shows all accessible tables, the ILM Assistant may not be able to manage every table. In those cases, the table is marked as ineligible and a link is provided to explain the exception. Some examples of ineligible tables are:</p>
<ul>
<li>
<p>Tables having no date column</p>
</li>
<li>
<p>Tables partitioned on non-date columns</p>
</li>
<li>
<p>Tables partitioned using a partition type other than range</p>
</li>
<li>
<p>Tables containing a LONG column</p>
</li>
<li>
<p>Index-organized tables</p>
</li>
</ul>
<p>The display for Lifecycle Tables can be customized to show managed, simulated, candidate, and ineligible tables, and includes the following information:</p>
<ul>
<li>
<p>Table Owner</p>
<p>The Oracle schema that owns the table</p>
</li>
<li>
<p>Table Name</p>
<p>The table that may allow ILM management</p>
</li>
<li>
<p>Storage Size</p>
<p>The current estimated size of the table. The value is scaled according to the Size Metric as specified within the Filter Options.</p>
</li>
<li>
<p>Data Reads</p>
<p>The current sum of all logical and physical reads for the table.</p>
</li>
<li>
<p>Data Writes</p>
<p>The current sum of all physical writes for the table.</p>
</li>
<li>
<p>Lifecycle Definition</p>
<p>If the ILM Assistant is managing the table, then the required lifecycle definition is displayed here.</p>
</li>
<li>
<p>Lifecycle Status</p>
<p>Provides the current status of the table. This indicates whether the table is eligible, is managed, or is simulated. For tables that are ineligible, the status link provides an explanation regarding its incompatibility with the ILM Assistant.</p>
</li>
<li>
<p>Table Partitioning</p>
<p>Provides a status of the table partitioning. A table can have partitioning implemented, simulated, or none.</p>
</li>
<li>
<p>Cost Savings</p>
<p>When the ILM Assistant is managing a table, a total cost-savings value is computed and displayed here.</p>
</li>
<li>
<p>Partition Map</p>
<p>Indicates that the current table partitioning scheme is compatible with the lifecycle definition. Clicking on the icon displays a detailed report of the table partitions.</p>
</li>
</ul>
<a id="VLDBG1316"></a>
<div class="sect4"><a id="sthref712"></a>
<h5 class="sect4">Lifecycle Table List</h5>
<p>For installations having many tables, the ILM Assistant provides a table list caching system to prevent long page waits and possible browser timeouts. The table list is a snapshot of all user tables on the system that should be periodically refreshed to maintain consistency within the ILM Assistant. Typically, the table list should be refreshed when application tables have been added, changed, or removed outside of the ILM Assistant, or when up-to-date table statistics are desired.</p>
<p>By default, a table list refresh operation attempts to scan for every table defined in the database. For large application environments, this can take a long time to complete. Typically, ILM Assistant management of tables is limited to a small number of tables. To avoid refreshing the table list with the entire set of tables found in the database, filtering may be used to narrow the number of tables to be scanned. For example, if the user was only interested in managing tables in the <code>SH</code> schema, the Table Owner Filter can be set to <code>SH</code>. To estimate the time it may take to do refresh, click <span class="bold">Estimate Refresh Statistics</span>. This returns the projected number of tables that match the filters and the time it takes to process the data.</p>
<p>Purging unused entries in the cache cleans up a cache that contains any entries that are not currently managed by the ILM Assistant. It does not affect any of the tables that currently match the filters.</p>
<p>As a guideline, the ILM Assistant can refresh the table list at a rate of 300 to 350 tables per minute. The operation may be interrupted from the <span class="bold">Lifecycle Tables</span> screen. An interrupt stops the refresh operation as if it has reached the normal end of the table scan. Because of the nature of the process, an interrupt can take up to 30 seconds to stop the actual scan operation.</p>
</div>
<!-- class="sect4" -->
<a id="VLDBG1317"></a>
<div class="sect4"><a id="sthref713"></a>
<h5 class="sect4">Partition Map</h5>
<p>The <span class="bold">Partition Map</span> column in the Lifecycle Tables Report indicates whether all the partitions in the table fit inside a stage and do not overlap stages. The Mapping Status indicates the quality of the partition-to-stage relationship. A green check mark indicates the partition resides completely within the stage without violating date boundaries. A warning icon indicates some type of mismatch. Possible exceptions for the stage mapping are:</p>
<ul>
<li>
<p>Misaligned partitions</p>
<p>A partition can be misaligned when it cannot fit into an entire stage. This can happen if the lifecycle stage duration is smaller than the smallest partition range. To resolve this misalignment, either choose a better lifecycle definition to manage the table or adjust the stage duration by editing the lifecycle definition.</p>
</li>
<li>
<p>Tablespace is not associated with a logical storage tier</p>
<p>This is very common for new ILM Assistant users. To perform cost analysis, the ILM Assistant must associate all referenced tablespaces with a tier. Typically, the easiest correction is to edit a logical storage tier and add the missing tablespace as a secondary tablespace.</p>
</li>
</ul>
</div>
<!-- class="sect4" -->
<a id="VLDBG1318"></a>
<div class="sect4"><a id="sthref714"></a>
<h5 class="sect4">Storage Costs</h5>
<p>The ILM Assistant provides a comprehensive storage cost and savings report associated with the managed or simulated table, as illustrated in <a href="#CIAJAJCJ">Figure 5-7</a>.</p>
<div class="figure">
<p class="titleinfigure"><a id="CIAJAJCJ"></a><a id="VLDBG1319"></a>Figure 5-7 ILM Assistant: Partitioning for Simulated Tables</p>
<img width="689" height="414" src="img/ilm_fig8.gif" alt="Description of Figure 5-7 follows" /><br />
<a id="sthref715" href="img_text/ilm_fig8.htm">Description of "Figure 5-7 ILM Assistant: Partitioning for Simulated Tables"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The report is divided into two main areas. The top portion of the report is a rollup showing the totals for the managed or simulated tables. For managed tables, there are two subsections that show data for a non-ILM environment using a single storage tier and an ILM managed, multitier environment. For simulated tables, a third section shows an ILM managed, multitier environment that includes the estimated effects of compression.</p>
<p>The bottom section of the storage costs page is the detail section that breaks up the cost areas by logical storage tier:</p>
<ul>
<li>
<p>Single-Tier Size</p>
<p>Displays the total size of the entities. For a lifecycle-based report, the value represents the sum of all table sizes that are assigned the current lifecycle definition. For managed tables, the size is the actual size as indicated by the database storage statistics. For simulated tables, the size is the projected size as calculated by the user-specified number of rows and average row length.</p>
</li>
<li>
<p>Single-Tier Cost</p>
<p>Displays the single-tier cost, which is calculated by multiplying the single-tier size of the current entities by the cost of storing the data on the most expensive tier within the lifecycle definition.</p>
</li>
<li>
<p>Cost per GB</p>
<p>Displays the user-specified cost when setting up the storage tier. The value is used to calculate the storage costs for partitions that are assigned to the tier.</p>
</li>
<li>
<p>Multitier Size</p>
<p>Displays the total size of the entities that reside on that tier. For lifecycles, it represents all table partitions that are associated with the current tier. For a table, it represents the sum of all partitions that are associated with the tier. The size does not include any projected compression.</p>
</li>
<li>
<p>Multitier Cost</p>
<p>Displays the cost, which is calculated by multiplying the cost per gigabyte for the current tier by the space occupied by the entities. For lifecycles, it represents all table partitions that are associated with the current tier. For a table, it represents the sum of all partitions that are associated with the tier.</p>
</li>
<li>
<p>Multitier Savings</p>
<p>Displays the savings, which is computed by subtracting the multitier cost from the calculated cost of storing the same data using the single-tier approach.</p>
</li>
<li>
<p>Percent Savings</p>
<p>Displays the ratio of multitier savings to the single-tier cost for the same data.</p>
</li>
<li>
<p>Multitier Compressed Size</p>
<p>Displays the total size of the entities that reside on that tier. For lifecycles, it represents all table partitions that are associated with the current tier. For a table, it represents the sum of all partitions that are associated with the tier. The size includes projected compression based on the estimated compression factor assigned by the user.</p>
<p>This report item is only present when viewing simulated table data.</p>
</li>
<li>
<p>Multitier Compressed Cost</p>
<p>Displays the cost, which is calculated by multiplying the cost per gigabyte for the current tier by the space occupied by the entities. For lifecycles, it represents all table partitions that are associated with the current tier. For a table, it represents the sum of all partitions that are associated with the tier. The size includes projected compression based on the estimated compression factor assigned by the user.</p>
<p>This report item is only present when viewing simulated table data.</p>
</li>
<li>
<p>Multitier Compressed Savings</p>
<p>Displays the savings, which is computed by subtracting the multitier compressed cost from the calculated cost of storing the same data using the single-tier approach.</p>
<p>This report item is only present when viewing simulated table data.</p>
</li>
<li>
<p>Percent Savings</p>
<p>Displays the ratio of multitier compressed savings to the single-tier cost for the same data.</p>
<p>This report item is only present when viewing simulated table data.</p>
</li>
<li>
<p>Lifecycle Stages Compressed</p>
<p>When setting up lifecycle stages, the user has the option of requiring the partitions to be compressed when assigned to the stage. This value shows the number of stages assigned to the storage tier that have the compressed attribute set.</p>
</li>
<li>
<p>Partitions Compression</p>
<p>Displays the number of partitions on the storage tier that are currently compressed.</p>
</li>
</ul>
</div>
<!-- class="sect4" -->
<a id="VLDBG1320"></a>
<div class="sect4"><a id="sthref716"></a>
<h5 class="sect4">Partition Simulation</h5>
<p>Implementing partitioning is likely to be a major task for any organization and the ILM Assistant enables you to model the impact before actually reorganizing the data. To achieve this modeling, the ILM Assistant requires the following information in simulation mode:</p>
<ul>
<li>
<p>Lifecycle Definition</p>
<p>Select a lifecycle definition that is used to manage the simulated table. The simulated partitions are derived from the lifecycle stages defined in the lifecycle. The ILM Assistant determines the optimal date range based on the stage duration information supplied.</p>
</li>
<li>
<p>Partitioning Column</p>
<p>Select a suitable date column as the partitioning key. If the current table has only one date column, then the column automatically is selected and displayed in read-only form.</p>
</li>
<li>
<p>Partition Date Interval</p>
<p>Displays the optimal partition range interval based on the selected lifecycle definition. The ILM Assistant computes an interval that guarantees that all generated partitions properly align with the lifecycle stages.</p>
</li>
<li>
<p>Number of Rows</p>
<p>Provide the number of rows in the current table. The default value is retrieved from the current tables database statistics. If the default value is unavailable, or you want to project future growth, you may enter any value greater than zero.</p>
</li>
<li>
<p>Average Row Length</p>
<p>Provide the average row length for the table. The default value is retrieved from the current tables database statistics. If the statistics are not valid, then the ILM Assistant queries the table and calculate a maximum row size. If the default value is unsuitable, or you want to project future growth, then you may enter any value greater than zero.</p>
</li>
<li>
<p>Estimated Compression Factor</p>
<p>Provide a compression factor. The compression factor is used exclusively by the ILM Assistant to estimate storage costs and savings. The factor is purely an estimate, but can give you savings potential. A value of one indicates no compression is projected. A value greater than one indicates a reduction in space using the formula reduction = 1 / factor. The default value is calculated by sampling a small percentage of the table for compression potential.</p>
</li>
</ul>
<p>An additional option after previewing the simulation is Migration Script generation, as illustrated in <a href="#CIAJAJCJ">Figure 5-7</a>. This functionality enables the user to create a script that can convert the existing nonpartitioned table to a partitioned counterpart. It should be noted that the script contains a simple create operation and a command to migrate the existing data; however, parts of the script have been commented out to prevent accidental operation. A conversion of a table to a partitioned table should be carefully planned.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="CHDJGBCH"></a><a id="VLDBG1321"></a>
<div class="sect3">
<h4 class="sect3">Preferences</h4>
<p><a id="sthref717"></a>Preferences control various aspects of the ILM Assistant's behavior and display of data (for example, the default date format for most entered values and reports, or the default number of rows to display). The following preferences can be set:</p>
<ul>
<li>
<p>Compression sample block count</p>
</li>
<li>
<p>Compression sample percent</p>
</li>
<li>
<p>Date format (Long form)</p>
</li>
<li>
<p>Date format (Short form)</p>
</li>
<li>
<p>Demonstration Mode</p>
<p>Specifies a factor that amplifies the actual table sizes. A value of one effectively disables the mode because multiplying a number by one does not change the original value.</p>
</li>
<li>
<p>Language preference</p>
</li>
<li>
<p>Lifecycle table view filter</p>
<p>Specifies the default selection to view when visiting the Lifecycle Tables page. Values can be combined to indicate multiple types of tables. For example, 3 indicates that both managed and simulated tables are to be shown. Possible values are:</p>
<dl>
<dd>1 - Managed Tables</dd>
<dd>2 - Simulated Tables</dd>
<dd>4 - Candidate Tables</dd>
<dd>8 - Ineligible Tables</dd>
</dl>
<p>The default value is 7, which excludes ineligible tables.</p>
</li>
<li>
<p>Maximum report rows to display</p>
</li>
<li>
<p>Maximum viewable tables</p>
</li>
<li>
<p>Refresh rate for progress monitoring</p>
</li>
<li>
<p>Report column maximum display length</p>
</li>
<li>
<p>Start page for lifecycle setup</p>
<p>Possible values are:</p>
<ul>
<li>
<p>Logical Storage Tiers</p>
</li>
<li>
<p>Lifecycle Definitions</p>
</li>
<li>
<p>Lifecycle Tables</p>
</li>
</ul>
</li>
<li>
<p>Storage size metric</p>
<p>Specifies the default size metric to be used when viewing storage size values. Possible values are:</p>
<dl>
<dd>KB - Kilobytes</dd>
<dd>MB - Megabytes</dd>
<dd>GB - Gigabytes</dd>
<dd>TB - Terabytes</dd>
</dl>
<p>The value is case sensitive.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDBJDEB"></a><a id="VLDBG1322"></a>
<div class="sect2">
<h3 class="sect2">Lifecycle Management</h3>
<p><a id="sthref718"></a><a id="sthref719"></a><span class="bold">Lifecycle Management</span> is concerned with the tasks that must be performed to move data to the correct place in the Information Lifecycle. Information is available on the following:</p>
<ul>
<li>
<p><a href="#CHDHEJID">Lifecycle Events Calendar</a></p>
</li>
<li>
<p><a href="#CHDFDCIB">Lifecycle Events</a></p>
</li>
<li>
<p><a href="#CHDFCFJH">Event Scan History</a></p>
</li>
</ul>
<a id="CHDHEJID"></a><a id="VLDBG1323"></a>
<div class="sect3">
<h4 class="sect3">Lifecycle Events Calendar</h4>
<p><a id="sthref720"></a><a id="sthref721"></a>The <span class="bold">Lifecycle Events Calendar</span> shows the calendar of previous, current, and (optionally,) future lifecycle events that must be performed to place data at the appropriate place in the information lifecycle, as illustrated in <a href="#CIADDJHG">Figure 5-5</a>. You can use the <span class="bold">Previous Month with Events</span> button to navigate to previous months containing lifecycle events.</p>
<p>To identify which data must be moved, click the <span class="bold">Scan for Events</span> button which asks whether to scan for all events up to the current day, or into the future. Additionally, you may choose to evaluate all tables or selected tables. The ILM Assistant then compares the current location of data with where it should be stored in accordance with the lifecycle definition and recommend the appropriate movement. It also advises if data should be compressed or set to read only as defined by the lifecycle definition. All the recommendations made by the ILM Assistant are applied to partitions only.</p>
</div>
<!-- class="sect3" -->
<a id="CHDFDCIB"></a><a id="VLDBG1324"></a>
<div class="sect3">
<h4 class="sect3">Lifecycle Events</h4>
<p><a id="sthref722"></a><a id="sthref723"></a>The <span class="bold">Lifecycle Events</span> report shows details about data migration events and provides a way to generate scripts to perform their actions. You can select some or all of the displayed events by clicking the check boxes in the first column. You must select events to generate scripts or to dismiss events. To generate a script on the selected events, click the <span class="bold">Generate Script</span> button. To dismiss the selected events to make them permanently disappear, click the <span class="bold">Dismiss Selected Events</span> button.</p>
<p>The event summary shows the following pieces of information:</p>
<ul>
<li>
<p>Recommended Action</p>
<p>Indicates the type of event that was detected by the scan operation. Possible event types are:</p>
<ul>
<li>
<p>MOVE PARTITION</p>
<p>Indicates that a partition should be moved from its current logical storage tier to a new logical storage tier. The movement is achieved by moving the partition from one tablespace to another.</p>
</li>
<li>
<p>COMPRESSION</p>
<p>Indicates that the partition should have data compression enabled.</p>
</li>
<li>
<p>READ-ONLY</p>
<p>Indicates that the partition should be set to read-only.</p>
</li>
<li>
<p>PURGE</p>
<p>Indicates that the partition should be physically deleted.</p>
</li>
</ul>
</li>
<li>
<p>Partition Name</p>
<p>Describes the affected partition.</p>
</li>
<li>
<p>Current Tier</p>
<p>Describes the current location of the partition.</p>
</li>
<li>
<p>Recommended Tier</p>
<p>Describes the target storage tier for move operations.</p>
</li>
<li>
<p>Cost Savings</p>
<p>Indicates the potential storage cost savings if the event action were to be implemented.</p>
</li>
<li>
<p>Table Owner and Name</p>
<p>Describes the partition table owner and name.</p>
</li>
<li>
<p>Event Date</p>
<p>Indicates the date on which the action should be performed. For events that should have been resolved, a single keyword <span class="bold">Past</span> is shown; for events in the future, a calendar date is displayed.</p>
</li>
<li>
<p>Event Details</p>
<p>Provides a link to event details. This area describes lifecycle details that affected the scan operation.</p>
</li>
</ul>
<p>When a partition requires several logical operations such as move and compress, the ILM Assistant displays the operations as separate events. However, in the script, the operations may be combined into a single SQL DDL statement.</p>
<p>The ILM Assistant currently does not have any archive capability. Therefore, selecting archive events generates a script that identifies which partitions should now be archived and lists them as comments.</p>
</div>
<!-- class="sect3" -->
<a id="CHDFCFJH"></a><a id="VLDBG1325"></a>
<div class="sect3">
<h4 class="sect3">Event Scan History</h4>
<p><a id="sthref724"></a><a id="sthref725"></a>Any authorized user can invoke event scanning through the Lifecycle Events Calendar. Over time, tracking the scan activity can be quite difficult, so a history is made available.</p>
<p>The history report shows the following pieces of information:</p>
<ul>
<li>
<p>Scan Date</p>
</li>
<li>
<p>Submitted by User</p>
</li>
<li>
<p>Lowest Event Date</p>
</li>
<li>
<p>Highest Event Date</p>
</li>
<li>
<p>Table Owner and Name</p>
</li>
<li>
<p>Number of Events</p>
</li>
<li>
<p>Lifecycle Status</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDCCEHB"></a><a id="VLDBG1326"></a>
<div class="sect2">
<h3 class="sect2">Compliance &amp; Security</h3>
<p><a id="sthref726"></a><a id="sthref727"></a>The <span class="bold">Compliance &amp; Security</span> area shows everything that can enforce security and help maintain compliance with the numerous world-wide regulations. It provides an area to view:</p>
<ul>
<li>
<p><a href="#CHDCAAJA">Current Status</a></p>
</li>
<li>
<p><a href="#CHDIJJII">Digital Signatures and Immutability</a></p>
</li>
<li>
<p><a href="#CHDGEEBJ">Privacy &amp; Security</a></p>
</li>
<li>
<p><a href="#CHDCHCFB">Auditing</a></p>
</li>
<li>
<p><a href="#CHDHADBC">Policy Notes</a></p>
</li>
</ul>
<a id="CHDCAAJA"></a><a id="VLDBG1327"></a>
<div class="sect3">
<h4 class="sect3">Current Status</h4>
<p><a id="sthref728"></a><a id="sthref729"></a>Current status summarizes the status of all the various <span class="bold">Compliance &amp; Security</span> features that are available. For example, it advises how many Virtual Private Database (VPD) policies have been defined, when a digital signature was last generated, and when a comparison of digital signatures was last performed.</p>
</div>
<!-- class="sect3" -->
<a id="CHDIJJII"></a><a id="VLDBG1328"></a>
<div class="sect3">
<h4 class="sect3">Digital Signatures and Immutability</h4>
<p><a id="sthref730"></a><a id="sthref731"></a>Some regulations stipulate that it must be shown that data has not changed since it was entered into the database. One technique that can prove that data has not been altered is to generate a digital signature.</p>
<p>Oracle Database provides the capability to generate a digital signature for a SQL result set. This can be generated inside the ILM Assistant and is achieved by creating a named SQL result set which includes the query to describe the collection of records. The digital signature is generated and is initially saved in a text file.</p>
<p>To show that the data records in a query have not been altered, a digital signature can be presented for a previously defined SQL query, and re-generated on today's data and the signatures compared, to show that the data has not changed since the digital signature was originally generated.</p>
</div>
<!-- class="sect3" -->
<a id="CHDGEEBJ"></a><a id="VLDBG1329"></a>
<div class="sect3">
<h4 class="sect3">Privacy &amp; Security</h4>
<p><a id="sthref732"></a><a id="sthref733"></a>The <span class="bold">Privacy &amp; Security</span> area enables you to view:</p>
<ul>
<li>
<p>A summary of privacy and security definitions for each ILM table</p>
</li>
<li>
<p>Virtual Private Database (VPD) policies</p>
</li>
<li>
<p>Security views on tables managed by the ILM Assistant</p>
</li>
<li>
<p>Reports on the access privileges granted to users for tables managed by the ILM Assistant</p>
</li>
</ul>
<p>By default, the Lifecycle Table Summary is shown and VPD policies and user access information are available by selecting the appropriate links.</p>
<a id="VLDBG1330"></a>
<div class="sect4"><a id="sthref734"></a>
<h5 class="sect4">Lifecycle Table Summary</h5>
<p>The <span class="bold">Lifecycle Table Summary</span> provides an overview for each table regarding which features are being used in terms of VPD policies and table grants issued.</p>
</div>
<!-- class="sect4" -->
<a id="VLDBG1331"></a>
<div class="sect4"><a id="sthref735"></a>
<h5 class="sect4">Virtual Private Database (VPD) Policies</h5>
<p>Using standard database privileges, it is possible to limit access to a table to certain users. However, such access allows users to read all information in that table. VPD Policies provide a finer level of control on who can access information. Using a VPD Policy, it is possible to write sophisticated functions, which define exactly which data is visible to a user.</p>
<p>For example, a policy could say that certain users can only view the last 12 months of data, while other users can view all of the data. Another policy could say that the only data visible is in the state where the office is located. Therefore, VPD Policies are an extremely powerful tool in controlling access to information. Only VPD policies that have been defined on tables that are being managed by the ILM Assistant are shown on the <span class="bold">VPD Policies</span> report.</p>
</div>
<!-- class="sect4" -->
<a id="VLDBG1332"></a>
<div class="sect4"><a id="sthref736"></a>
<h5 class="sect4">Table Access by User</h5>
<p>The <span class="bold">Table Access by User</span> report provides a list of all the access privileges granted to users for tables that have been assigned to Lifecycle Definitions.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="CHDCHCFB"></a><a id="VLDBG1333"></a>
<div class="sect3">
<h4 class="sect3">Auditing</h4>
<p><a id="sthref737"></a><a id="sthref738"></a>Some regulations require that an audit trail be maintained of all access and changes to data. In Oracle Database, several types of auditing are available: database and fine-grained. They each create their own audit records, which can be viewed as one consolidated report in the ILM Assistant that can be filtered on several criteria.</p>
<p>Within the auditing area on the ILM Assistant, it is possible to:</p>
<ul>
<li>
<p>View the Current Audit Status</p>
</li>
<li>
<p>Manage Fine-Grained Audit Policies</p>
</li>
<li>
<p>View Audit Records</p>
</li>
</ul>
<a id="VLDBG1334"></a>
<div class="sect4"><a id="sthref739"></a>
<h5 class="sect4">Fine-Grained Auditing Policies</h5>
<p><a id="sthref740"></a>Standard Auditing within the Oracle Database logs all types of access to a table. However, there may be instances when it is desirable to only audit an event when a certain condition is met. For example, the value of the transaction being altered is greater than $10,000. This type of auditing is possible using Fine-Grained Audit policies where an audit condition can be specified and an optional function can be called for more sophisticated processing.</p>
</div>
<!-- class="sect4" -->
<a id="VLDBG1335"></a>
<div class="sect4"><a id="sthref741"></a>
<h5 class="sect4">Viewing Auditing Records</h5>
<p><a id="sthref742"></a>It is possible within the ILM Assistant to view both database and fine-grained audit records for tables mapped to Lifecycle Definitions in the ILM Assistant. An icon represents the type of audit record: database (indicated by a disc) or FGA. Use the Filter condition to filter the audit records that are displayed and click the report heading to sort the data on that column.</p>
<p>By default, the ILM Assistant only displays audit records for the current day. To see audit records for previous days, you must use the filter options to specify a date range of records to display.</p>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<a id="CHDHADBC"></a><a id="VLDBG1336"></a>
<div class="sect3">
<h4 class="sect3">Policy Notes</h4>
<p><a id="sthref743"></a>Policy notes provide textual documentation of your data management policies or anything to document about managing data during its lifetime. Policy notes are informational only; they do not affect the tasks performed by the ILM Assistant. They can be used as a central place to describe your policies, as reminders, and as a way to prove that your policies are documented. They can also be used to document SLA (Service Level Agreements) and to document the compliance rules that you are trying to enforce.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="CHDBJGIA"></a><a id="VLDBG1337"></a>
<div class="sect2">
<h3 class="sect2">Reports</h3>
<p><a id="sthref744"></a><a id="sthref745"></a>The ILM Assistant offers a variety of reports on all aspects of managing the ILM environment, which include the following:</p>
<ul>
<li>
<p>Multitier Storage Costs by Lifecycle or Table</p>
</li>
<li>
<p>Logical Storage Tier Summary</p>
</li>
<li>
<p>Partitions by Table or Storage Tier</p>
</li>
<li>
<p>Lifecycle Retention Summary</p>
</li>
<li>
<p>Data Protection Summary</p>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CACEABBJ"></a><a id="VLDBG1338"></a>
<div class="sect1">
<h2 class="sect1">Implementing an ILM System Manually</h2>
<p><a id="sthref746"></a><a id="sthref747"></a><a href="#CHDEIJFG">Example 5-1</a> illustrates how to manually create storage tiers and partition a table across those storage tiers and then setup a VPD policy on that database to restrict access to the online archive tier data.</p>
<div class="example">
<p class="titleinexample"><a id="CHDEIJFG"></a><a id="VLDBG14077"></a>Example 5-1 Manually implementing an ILM system</p>
<pre>
REM Setup the tablespaces for the data 

REM These tablespaces would be placed on a High Performance Tier 
CREATE SMALLFILE TABLESPACE q1_orders DATAFILE 'q1_orders'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE q2_orders DATAFILE 'q2_orders'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE q3_orders DATAFILE 'q3_orders'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE q4_orders DATAFILE 'q4_orders'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM These tablespaces would be placed on a Low Cost Tier 
CREATE SMALLFILE TABLESPACE "2006_ORDERS" DATAFILE '2006_orders'
SIZE 5M AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE "2005_ORDERS"  DATAFILE '2005_orders'
SIZE 5M AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM These tablespaces would be placed on the Online Archive Tier 
CREATE SMALLFILE TABLESPACE "2004_ORDERS" DATAFILE '2004_orders'
SIZE 5M AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE old_orders DATAFILE 'old_orders'
SIZE 15M AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM Now create the Partitioned Table 
CREATE TABLE allorders (
    prod_id       NUMBER       NOT NULL,
    cust_id       NUMBER       NOT NULL,
    time_id       DATE         NOT NULL,
    channel_id    NUMBER       NOT NULL,
    promo_id      NUMBER       NOT NULL,
    quantity_sold NUMBER(10,2) NOT NULL,
    amount_sold   NUMBER(10,2) NOT NULL)
 --
 -- table wide physical specs
 --
  PCTFREE 5 NOLOGGING   
 --
 -- partitions
 --  
 PARTITION BY RANGE (time_id)
  ( partition allorders_pre_2004 VALUES LESS THAN 
     (TO_DATE('2004-01-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE old_orders,
    partition allorders_2004 VALUES LESS THAN 
     (TO_DATE('2005-01-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE "2004_ORDERS",
    partition allorders_2005 VALUES LESS THAN 
     (TO_DATE('2006-01-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE "2005_ORDERS",
    partition allorders_2006 VALUES LESS THAN 
     (TO_DATE('2007-01-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE "2006_ORDERS",
    partition allorders_q1_2007 VALUES LESS THAN 
     (TO_DATE('2007-04-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE q1_orders,
    partition allorders_q2_2007 VALUES LESS THAN 
     (TO_DATE('2007-07-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE q2_orders,
    partition allorders_q3_2007 VALUES LESS THAN 
     (TO_DATE('2007-10-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE q3_orders,
    partition allorders_q4_2007 VALUES LESS THAN 
     (TO_DATE('2008-01-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE q4_orders);

ALTER TABLE allorders ENABLE ROW MOVEMENT;

REM Here is another example using INTERVAL partitioning 

REM These tablespaces would be placed on a High Performance Tier 
CREATE SMALLFILE TABLESPACE cc_this_month DATAFILE 'cc_this_month'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

CREATE SMALLFILE TABLESPACE cc_prev_month DATAFILE 'cc_prev_month'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM These tablespaces would be placed on a Low Cost Tier 
CREATE SMALLFILE TABLESPACE cc_prev_12mth DATAFILE 'cc_prev_12'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM These tablespaces would be placed on the Online Archive Tier
CREATE SMALLFILE TABLESPACE cc_old_tran DATAFILE 'cc_old_tran'
SIZE 2M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED LOGGING 
EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO ;

REM Credit Card Transactions where new partitions automatically are placed on the high performance tier 
CREATE TABLE cc_tran (
    cc_no       VARCHAR2(16) NOT NULL,
    tran_dt     DATE         NOT NULL,
    entry_dt    DATE         NOT NULL,
    ref_no      NUMBER       NOT NULL,
    description VARCHAR2(30) NOT NULL,
    tran_amt    NUMBER(10,2) NOT NULL)
 --
 -- table wide physical specs
 --
 PCTFREE 5 NOLOGGING   
 --
 -- partitions
 --  
 PARTITION BY RANGE (tran_dt)
 INTERVAL (NUMTOYMINTERVAL(1,'month') ) STORE IN (cc_this_month )
  ( partition very_old_cc_trans VALUES LESS THAN
     (TO_DATE('1999-07-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE cc_old_tran ,
    partition old_cc_trans VALUES LESS THAN
     (TO_DATE('2006-07-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE cc_old_tran ,
    partition last_12_mths VALUES LESS THAN
     (TO_DATE('2007-06-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE cc_prev_12mth,
    partition recent_cc_trans VALUES LESS THAN
    (TO_DATE('2007-07-01 00:00:00'
            ,'SYYYY-MM-DD HH24:MI:SS'
            ,'NLS_CALENDAR=GREGORIAN'
            )) TABLESPACE cc_prev_month,
    partition new_cc_tran VALUES LESS THAN
     (TO_DATE('2007-08-01 00:00:00'
             ,'SYYYY-MM-DD HH24:MI:SS'
             ,'NLS_CALENDAR=GREGORIAN'
             )) TABLESPACE cc_this_month);


REM Create a Security Policy to allow user SH to see all credit card data,
REM PM only sees this years data,
REM and all other uses cannot see the credit card data 

CREATE OR REPLACE FUNCTION ilm_seehist
  (oowner IN VARCHAR2, ojname IN VARCHAR2)
   RETURN VARCHAR2 AS con VARCHAR2 (200);
BEGIN
  IF SYS_CONTEXT('USERENV','CLIENT_INFO') = 'SH'
  THEN -- sees all data
    con:= '1=1';
  ELSIF SYS_CONTEXT('USERENV','CLIENT_INFO') = 'PM'
  THEN -- sees only data for 2007
    con := 'time_id &gt; ''31-Dec-2006'''; 
  ELSE
    -- others nothing
    con:= '1=2';
  END IF;
  RETURN (con);
END ilm_seehist;
/

REM Then the policy is added with the DBMS_RLS package as follows:

BEGIN
  DBMS_RLS.ADD_POLICY ( object_schema=&gt;'SYSTEM'
                      , object_name=&gt;'cc_tran'
                      , policy_name=&gt;'ilm_view_history_data'
                      , function_schema=&gt;'SYSTEM'
                      , policy_function=&gt;'ilm_seehist'
                      , sec_relevant_cols=&gt;'tran_dt'
                      );
END;
/

</pre></div>
<!-- class="example" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF" href="../e41084/toc.htm"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about SQL statements</p>
</li>
<li>
<p><a class="olink ARPLS052" href="../../appdev.112/e40758/d_rls.htm#ARPLS052"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_RLS</code> package</p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1828">
<tr>
<td class="cellalignment1837">
<table class="cellalignment1833">
<tr>
<td class="cellalignment1832"><a href="part_admin005.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1832"><a href="part_warehouse.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2011,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1840">
<table class="cellalignment1831">
<tr>
<td class="cellalignment1832"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1832"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1832"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1832"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1832"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1832"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
