<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Scenarios Using the DGMGRL Command-Line Interface</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1071" />
<meta name="dcterms.created" content="2015-11-24T12:57:37Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Data Guard Broker" />
<meta name="dcterms.identifier" content="E40771-07" />
<meta name="dcterms.isVersionOf" content="DGBKR" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sofo.htm" title="Previous" type="text/html" />
<link rel="Next" href="dgmgrl.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40771.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/20</span> <!-- End Header -->
<div id="DGBKR495" class="chapter"><a id="g1025435"></a> <a id="i1005573"></a>
<h1 class="chapter"><span class="secnum">6</span> Scenarios Using the DGMGRL Command-Line Interface</h1>
<p>This chapter describes the prerequisites for getting started using the Data Guard command-line interface (DGMGRL). It also describes scenarios that demonstrate how to use DGMGRL to create, <a id="sthref653"></a>manage, and <a id="sthref654"></a>monitor a broker configuration.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#i1009537">Prerequisites for Getting Started</a></p>
</li>
<li>
<p><a href="#i1005666">Scenario 1: Creating a Configuration</a></p>
</li>
<li>
<p><a href="#i1005804">Scenario 2: Setting Database Properties</a></p>
</li>
<li>
<p><a href="#i1010364">Scenario 3: Enabling the Configuration and Databases</a></p>
</li>
<li>
<p><a href="#i1010978">Scenario 4: Setting the Configuration Protection Mode</a></p>
</li>
<li>
<p><a href="#BABEIIHD">Scenario 5: Enabling Fast-Start Failover and Starting the Observer</a></p>
</li>
<li>
<p><a href="#i1005869">Scenario 6: Performing Routine Management Tasks</a></p>
</li>
<li>
<p><a href="#i1006660">Scenario 7: Performing a Switchover Operation</a></p>
</li>
<li>
<p><a href="#i1007698">Scenario 8: Performing a Manual Failover Operation</a></p>
</li>
<li>
<p><a href="#BGBBDEBC">Scenario 9: Reinstating a Failed Primary Database</a></p>
</li>
<li>
<p><a href="#BGBJIGJH">Scenario 10: Converting a Physical Standby to a Snapshot Standby</a></p>
</li>
<li>
<p><a href="#i1009142">Scenario 11: Monitoring a Data Guard Configuration</a></p>
</li>
</ul>
<a id="i1009537"></a>
<div id="DGBKR500" class="sect1">
<h2 class="sect1"><span class="secnum">6.1</span> Prerequisites for Getting Started</h2>
<p>One of the <a id="sthref655"></a><a id="sthref656"></a>prerequisites for using DGMGRL is that a primary database and any standby databases must already exist. The <a id="sthref657"></a><a id="sthref658"></a><code dir="ltr">DG_BROKER_START</code> initialization parameter must be set to <code dir="ltr">TRUE</code> for all databases in the configuration. You must use a server parameter file with the broker (see <a href="install.htm#BABFFICD">Section 2.1</a> and <a href="dgmgrl.htm#i91611">Section 7.1.3</a>).</p>
<p>Convert the initialization parameter files (PFILE) on both primary and standby databases into server parameter files (SPFILE), if necessary. Use the following SQL*Plus command:</p>
<pre dir="ltr">
CREATE SPFILE FROM PFILE='<span class="italic">pfilename</span>';
</pre>
<p>If an instance was not started with a server parameter file, then you must shut down the instance and restart it using the server parameter file.</p>
<p>After starting the Oracle instance, set the <code dir="ltr">DG_BROKER_START=TRUE</code> initialization parameter using the SQL <code dir="ltr"><a id="sthref659"></a>ALTER SYSTEM</code> statement. The parameter value will be saved in the server parameter file. The next time you start the Oracle instance, the broker is started automatically, and you do not need to issue the SQL <code dir="ltr">ALTER SYSTEM</code> statement again.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN" href="../e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a> for detailed information about creating server parameter files</div>
<p>The following assumptions are made for the scenarios in this chapter:</p>
<ul>
<li>
<p>TCP/IP is used to connect to primary and standby databases.</p>
</li>
<li>
<p>The <a id="sthref660"></a>standby database has been created from backups of the <a id="sthref661"></a>primary database control files and datafiles as described in the <a class="olink SBYDB00210" href="../../server.112/e41134/create_ps.htm#SBYDB00210"><span class="italic">Oracle Data Guard Concepts and Administration</span></a>.</p>
</li>
<li>
<p>The scenarios in this chapter assume the following broker configuration:</p>
<ul>
<li>
<p>The configuration name is <code dir="ltr">DRSolution</code>.</p>
</li>
<li>
<p>The database unique name (<code dir="ltr">DB_UNIQUE_NAME</code>) of the primary database is <code dir="ltr">North_Sales</code>.</p>
</li>
<li>
<p>The database unique name (<code dir="ltr">DB_UNIQUE_NAME</code>) of the remote standby database is <code dir="ltr">South_Sales</code>.</p>
</li>
<li>
<p>The protection mode is maximum performance mode.</p>
</li>
<li>
<p>There are standby redo log files configured for both the primary and standby database. The transport mode for both databases is <code dir="ltr">ASYNC</code>.</p>
</li>
<li>
<p>The standby database is a physical standby database.</p>
</li>
</ul>
</li>
</ul>
</div>
<!-- class="sect1" -->
<a id="i1005666"></a>
<div id="DGBKR505" class="sect1"><a id="CIAGDCHH"></a>
<h2 class="sect1"><span class="secnum">6.2</span> <a id="sthref662"></a><a id="sthref663"></a>Scenario 1: Creating a Configuration</h2>
<p>This section provides examples that <a id="sthref664"></a><a id="sthref665"></a><a id="sthref666"></a>create a broker configuration named<br />
<code dir="ltr">DRSolution</code> that includes a primary and standby database named <code dir="ltr">North_Sales</code> and <code dir="ltr">South_Sales</code>.</p>
<p>The following steps show how to create a configuration and add one physical standby database.</p>
<dl>
<dd><a id="DGBKR3674"></a><a id="sthref667"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;<a id="sthref668"></a><a id="sthref669"></a>Invoke DGMGRL.</dt>
<dd>
<p><a id="sthref670"></a>To start DGMGRL, enter <code dir="ltr">dgmgrl</code> at the command-line prompt on a system where Oracle Data Guard is installed:</p>
<pre dir="ltr">
$ dgmgrl
</pre>
<p>The DGMGRL prompt is displayed:</p>
<pre dir="ltr">
DGMGRL&gt;
</pre></dd>
<dd><a id="DGBKR3675"></a><a id="sthref671"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;<a id="sthref672"></a><a id="sthref673"></a>Connect to the primary database.</dt>
<dd>
<p>Before you specify any command (other than the <code dir="ltr">HELP,</code> <code dir="ltr">EXIT,</code> or <code dir="ltr">QUIT</code>), you must first connect to the primary database using the DGMGRL <code dir="ltr">CONNECT</code> command.</p>
<p>The account from which you connect to the database (<code dir="ltr">SYS</code> in this example) must have <code dir="ltr"><a id="sthref674"></a><a id="sthref675"></a><a id="sthref676"></a>SYSDBA</code> privileges on the primary and standby databases.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You do not have to include <code dir="ltr">AS SYSDBA</code> on the <code dir="ltr">CONNECT</code> command because <code dir="ltr">SYSDBA</code> is the default setting for this command.</div>
<p>The following examples show two variations of the <code dir="ltr"><a id="sthref677"></a>CONNECT</code> command. <a href="#i1005721">Example 6-1</a> shows how to connect to the default database on the local system, and <a href="#i1005725">Example 6-2</a> includes the Oracle Net Services connect identifier<br />
(<code dir="ltr">North_Sales.example.com</code>) to make a connection to a database located on a remote system. In both examples, you are prompted for a password.</p>
<div id="DGBKR3599" class="example">
<p class="titleinexample"><a id="i1005721"></a>Example 6-1 Connecting to the Primary Database on the Local System</p>
<pre dir="ltr">
DGMGRL&gt; CONNECT sys;
Password: <span class="italic">password</span>
Connected.
</pre></div>
<!-- class="example" -->
<div id="DGBKR3600" class="example">
<p class="titleinexample"><a id="i1005725"></a>Example 6-2 Connecting to the Primary Database on a Remote System</p>
<pre dir="ltr">
DGMGRL&gt; CONNECT sys@North_Sales.example.com;
Password: <span class="italic">password</span>
Connected.
</pre></div>
<!-- class="example" --></dd>
<dd><a id="DGBKR3676"></a><a id="sthref678"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;<a id="sthref679"></a>Create the broker configuration.</dt>
<dd>
<p>To create the broker configuration, you first define the configuration including a profile for the primary database, which in this case is called <code dir="ltr">North_Sales</code>. In a later command, you will add a profile for the standby database, <code dir="ltr">South_Sales</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The names for the primary and standby databases must match their database unique names. Fetch these from their <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter as follows:
<pre dir="ltr">
SQL&gt; SHOW PARAMETER DB_UNIQUE_NAME;
</pre></div>
<p>Use the <code dir="ltr"><a id="sthref680"></a>CREATE CONFIGURATION</code> command to create the <code dir="ltr">DRSolution</code> configuration and define the primary database, <code dir="ltr">North_Sales</code>:</p>
<pre dir="ltr">
DGMGRL&gt; CREATE CONFIGURATION 'DRSolution' AS
&gt;  PRIMARY DATABASE IS 'North_Sales'
&gt;  CONNECT IDENTIFIER IS North_Sales.example.com;
  
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">
Configuration "DRSolution" created with primary database "North_Sales"
</pre>
<p>The name <code dir="ltr">North_Sales</code> is the value of this database's <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter.</p>
</dd>
<dd><a id="DGBKR3677"></a><a id="sthref681"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Show the configuration information.</dt>
<dd>
<p>Use the <code dir="ltr"><a id="sthref682"></a>SHOW CONFIGURATION</code> command to display a brief summary of the configuration:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales - Primary database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
DISABLED
</pre></dd>
<dd><a id="DGBKR3678"></a><a id="sthref683"></a></dd>
<dt class="seghead">Step 5&nbsp;&nbsp;&nbsp;<a id="sthref684"></a>Add a standby database to the configuration.</dt>
<dd>
<p>To add a standby database to the <code dir="ltr">DRSolution</code> configuration, use the <code dir="ltr">ADD DATABASE</code> command to create a broker configuration profile for the standby database.</p>
<p>The following command defines <code dir="ltr">South_Sales</code> as a standby database, which is the standby database associated with the primary database called <code dir="ltr">North_Sales</code>:</p>
<pre dir="ltr">
DGMGRL&gt; ADD DATABASE 'South_Sales' AS
&gt;  CONNECT IDENTIFIER IS South_Sales.example.com;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">
Database "South_Sales" added
</pre>
<p>The name <code dir="ltr">South_Sales</code> is the value of the database's <code dir="ltr">DB_UNIQUE_NAME</code> initialization parameter.</p>
<p>Use the <code dir="ltr"><a id="sthref685"></a>SHOW CONFIGURATION</code> command to verify that the <code dir="ltr">South_Sales</code> database was added to the <code dir="ltr">DRSolution</code> configuration:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
    South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
DISABLED
 
DGMGRL&gt;
</pre></dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="i1005804"></a>
<div id="DGBKR510" class="sect1">
<h2 class="sect1"><span class="secnum">6.3</span> Scenario 2: Setting Database Properties</h2>
<p>After you create the configuration with DGMGRL, you can <a id="sthref686"></a><a id="sthref687"></a>set database <a id="sthref688"></a>properties at any time. For example, the following statements set the <code dir="ltr">LogArchiveFormat</code> and <code dir="ltr">StandbyArchiveLocation</code> database properties for the <code dir="ltr">South_Sales</code> standby database:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'South_Sales' SET PROPERTY 'LogArchiveFormat'='log_%t_%s_%r_%d.arc';
Property "LogArchiveFormat" updated.

DGMGRL&gt; EDIT DATABASE 'South_Sales' SET PROPERTY 'StandbyArchiveLocation'='/archfs/arch/';
Property "StandbyArchiveLocation" updated.
</pre>
<p>Use the <code dir="ltr">SHOW DATABASE VERBOSE</code> command to view all properties and their values for a database. The following example shows the properties for the <code dir="ltr">South_Sales</code> database.</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE VERBOSE 'South_Sales';
 
Database - South_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  OFFLINE
  Transport Lag:   (unknown)
  Apply Lag:       (unknown)
  Real Time Query: OFF
  Instance(s):
    south_sales1
 
  Properties:
    DGConnectIdentifier             = 'South_Sales.example.com'
    ObserverConnectIdentifier       = ''
    LogXptMode                      = 'ASYNC'
    DelayMins                       = '0'
    Binding                         = 'optional'
    MaxFailure                      = '0'
    MaxConnections                  = '1'
    ReopenSecs                      = '300'
    NetTimeout                      = '30'
    RedoCompression                 = 'DISABLE'
    LogShipping                     = 'ON'
    PreferredApplyInstance          = ''
    ApplyInstanceTimeout            = '0'
    ApplyParallel                   = 'AUTO'
    StandbyFileManagement           = 'AUTO'
    ArchiveLagTarget                = '0'
    LogArchiveMaxProcesses          = '5'
    LogArchiveMinSucceedDest        = '1'
    DbFileNameConvert               = 'dbs/t, dbs/bt'
    LogFileNameConvert              = 'dbs/t, dbs/bt'
    FastStartFailoverTarget         = ''
    InconsistentProperties          = '(monitor)'
    InconsistentLogXptProps         = '(monitor)'
    SendQEntries                    = '(monitor)'
    LogXptStatus                    = '(monitor)'
    RecvQEntries                    = '(monitor)'
    SidName                         = 'south_sales1'
    StaticConnectIdentifier         = '(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)
(HOST=south_sales1.example.com)(PORT=2840))
(CONNECT_DATA=(SERVICE_NAME=South_Sales_DGMGRL.example.com)
(INSTANCE_NAME=south_sales1)(SERVER=DEDICATED)))'
    StandbyArchiveLocation          = 'USE_DB_RECOVERY_FILE_DEST'
    AlternateLocation               = ''
    LogArchiveTrace                 = '255'
    LogArchiveFormat                = 'db2r_%d_%t_%s_%R.arc'
    LatestLog                       = '(monitor)'
    TopWaitEvents                   = '(monitor)'
 
Database Status:
DISABLED
</pre>
<p>If broker management of the database is enabled, setting a database property value causes the underlying parameter value to be changed in the corresponding database, and the value for the changed parameter is reflected in the server parameter file. Thus, if the database is shut down and restarted outside of Oracle Enterprise Manager and DGMGRL (such as from the SQL*Plus interface), the database uses the new parameter values from the updated server parameter file when it starts. However, you should not make changes to the redo transport services initialization parameters through SQL statements. Doing so will cause an inconsistency between the database and the broker.</p>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
The database properties are typically displayed in mixed-case (for example, <code dir="ltr">LogArchiveFormat</code>) typeface to help you visually differentiate database properties (from the corresponding initialization parameter, SQL statement, or PL/SQL procedure), which are typically documented in <code dir="ltr">UPPERCASE</code> typeface. However, the commands to manage properties are not case sensitive; you can issue commands in uppercase, lowercase, or mixed-case.</div>
<p>You can change a property if the database is enabled or disabled. However, if the database is disabled when you change a property, the change does not take effect until the database is enabled.</p>
</div>
<!-- class="sect1" -->
<a id="i1010364"></a>
<div id="DGBKR515" class="sect1">
<h2 class="sect1"><span class="secnum">6.4</span> <a id="sthref689"></a><a id="sthref690"></a><a id="sthref691"></a>Scenario 3: Enabling the Configuration and Databases</h2>
<p>So far, the <code dir="ltr">DRSolution</code> <a id="sthref692"></a><a id="sthref693"></a>configuration is disabled, which means it is not under the control of the Data Guard broker. When you finish <a id="sthref694"></a>configuring the databases into a broker configuration and setting any necessary database properties, you must <a id="sthref695"></a><a id="sthref696"></a>enable the configuration to allow the Data Guard broker to manage it.</p>
<p>You can enable:</p>
<ul>
<li>
<p>The entire configuration, including all of its databases</p>
</li>
<li>
<p>A standby database</p>
</li>
</ul>
<p class="subhead1"><a id="i1010387"></a><a id="DGBKR3601"></a><a id="sthref697"></a>Enable the entire configuration.</p>
<p>You can enable the entire configuration, including all of the databases, with the following command:</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref698"></a>ENABLE CONFIGURATION;
Enabled.
</pre>
<p class="subhead1"><a id="DGBKR3602"></a>Show the configuration.</p>
<p>Use the <code dir="ltr">SHOW</code> command to verify that the configuration and its databases were successfully enabled:</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref699"></a>SHOW CONFIGURATION;
</pre>
<p>DGMGRL returns the following information:</p>
<pre dir="ltr">
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
    South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p class="subhead1"><a id="DGBKR3603"></a>Enable the database.</p>
<p>This step is unnecessary except if the standby database was previously disabled with the <code dir="ltr">DISABLE DATABASE</code> command. Normally, enabling the configuration also enables the standby database.</p>
<pre dir="ltr">
DGMGRL&gt; ENABLE DATABASE 'South_Sales';
Enabled.
</pre>
<p class="subhead1"><a id="DGBKR3604"></a>Show the database.</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'South_Sales';

Database - South_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  APPLY-ON
  Transport Lag:   0 seconds
  Apply Lag:       0 seconds
  Real Time Query: OFF
  Instance(s):
    south_sales1
 
Database Status:
SUCCESS
</pre></div>
<!-- class="sect1" -->
<a id="i1010978"></a>
<div id="DGBKR520" class="sect1">
<h2 class="sect1"><span class="secnum">6.5</span> Scenario 4: Setting the Configuration Protection Mode</h2>
<p>You can change the protection mode of the configuration at any time. However, it is best if you do this when there is no activity occurring in the configuration if you are moving to the maximum protection or maximum availability modes.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you change the protection mode from maximum performance mode to maximum protection mode, the broker automatically restarts the primary database. If you wish to avoid restarting the database, first change the protection mode to maximum availability mode and then change the protection mode to maximum protection mode.
<p>A restart of the primary database is not required when changing the protection mode from:</p>
<ul>
<li>
<p>maximum performance to maximum availability</p>
</li>
<li>
<p>maximum availability to maximum protection</p>
</li>
</ul>
</div>
<p>This scenario sets the protection mode of the configuration to the <code dir="ltr">MAXAVAILABILITY</code> mode. Note that this protection mode requires that there be at least one standby database configured to use standby redo log files, with its <code dir="ltr">LogXptMode</code> database property set to <code dir="ltr">SYNC</code>.</p>
<dl>
<dd><a id="DGBKR3679"></a><a id="sthref700"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Configure standby redo log files, if necessary.</dt>
<dd>
<p>Because you will be setting the protection mode to the <code dir="ltr">MAXAVAILABILITY</code> mode, it is important to ensure that sufficient standby redo log files are configured on the standby database.</p>
</dd>
<dd><a id="DGBKR3680"></a><a id="sthref701"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Set the LogXptMode database property appropriately.</dt>
<dd>
<p>Use the <code dir="ltr">EDIT DATABASE (property)</code> command on the standby database to set the redo transport service that corresponds to the protection mode you plan to set. If the protection mode to be set is <code dir="ltr">MAXAVAILABILITY</code>, it is required that the redo transport service of at least one standby database is set to <code dir="ltr">SYNC</code>. For example:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'South_Sales' SET PROPERTY 'LogXptMode'='SYNC';
Property "LogXptMode" updated
</pre>
<p>The broker will not allow this command to succeed unless the standby database is configured with standby redo log files in the configuration.</p>
</dd>
<dd><a id="DGBKR3681"></a><a id="sthref702"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Change the overall protection mode for the configuration.</dt>
<dd>
<p>Use the <code dir="ltr">EDIT</code> <code dir="ltr">CONFIGURATION</code> command to upgrade the broker configuration to the <code dir="ltr">MAXAVAILABILITY</code> protection mode:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MAXAVAILABILITY;
Succeeded.
</pre>
<p>If the configuration is disabled when you enter this command, the actual protection mode change is not applied until you enable the configuration with the <code dir="ltr">ENABLE CONFIGURATION</code> command. The broker will not allow you to enable the configuration if it does not find a standby database in the configuration that can support the requirements of the protection mode.</p>
</dd>
<dd><a id="DGBKR3682"></a><a id="sthref703"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Verify the protection mode has changed.</dt>
<dd>
<p>Use the <code dir="ltr">SHOW CONFIGURATION</code> command to display the current protection mode for the configuration:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  <span class="bold">Protection Mode:</span> <span class="bold">MaxAvailability</span>
  Databases:
    North_Sales  - Primary database
    South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dbresource.htm#i1026456">Section 4.6, "Managing Data Protection Modes"</a></div>
</dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="BABEIIHD"></a>
<div id="DGBKR3430" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.6</span> Scenario 5: Enabling Fast-Start Failover and Starting the Observer</h2>
<p>You can enable fast-start failover from any site, including the observer site, while connected to any database in the broker configuration. Enabling fast-start failover does not trigger a failover. Instead, it allows the observer that is monitoring the configuration to initiate a fast-start failover if conditions warrant a failover.</p>
<p>Fast-start failover can be enabled in configurations operating in either maximum performance or maximum availability protection mode. This section describes the steps to enable fast-start failover and start the observer where the configuration protection mode is set to maximum availability mode.</p>
<dl>
<dd><a id="DGBKR3683"></a><a id="BGBFEAFG"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Ensure standby redo logs are configured on the primary and target standby databases.</dt>
<dd>
<p>Standby redo logs must be configured on the primary and standby databases. You must stop log apply services prior to configuring standby redo logs.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SBYDB00426" href="../../server.112/e41134/create_ps.htm#SBYDB00426"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for instructions on configuring standby redo log files</div>
</dd>
<dd><a id="DGBKR3684"></a><a id="BGBBJAEH"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Ensure the LogXptMode Property is set to SYNC.</dt>
<dd>
<p>The <code dir="ltr">LogXptMode</code> database property must be set to <code dir="ltr">SYNC</code> on the primary and target standby databases.</p>
<p>To set the redo transport service that corresponds to the protection mode you plan to set, use the <code dir="ltr">EDIT DATABASE</code> (property) command on the primary and target standby databases. For example, if the protection mode to be set is <code dir="ltr">MAXAVAILABILITY</code>, you must set the <code dir="ltr">LogXptMode</code> property to <code dir="ltr">SYNC</code> on the primary database and on the target standby database, as shown in the following examples:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'North_Sales' SET PROPERTY 'LogXptMode'='SYNC';
Property "LogXptMode" updated
</pre>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'South_Sales' SET PROPERTY 'LogXptMode'='SYNC';
Property "LogXptMode" updated
</pre>
<p>The broker does not allow these commands to succeed unless the databases are configured with standby redo log files.</p>
</dd>
<dd><a id="DGBKR3685"></a><a id="BGBIEFFF"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Set the F<a id="sthref704"></a><a id="sthref705"></a><a id="sthref706"></a><a id="sthref707"></a>astStartFailoverTarget configuration property.</dt>
<dd>
<p>If you have two or more standby databases, set up the <code dir="ltr">FastStartFailoverTarget</code> configuration property on the primary database to indicate the desired target standby database. The broker reciprocally sets this property for the target standby database to indicate the primary database as its future target standby database when fast-start failover is actually enabled. There is no need for you set this property on the target standby as this is done for you automatically.For example:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'North_Sales' SET PROPERTY FastStartFailoverTarget='South_Sales';
Property "FastStartFailoverTarget" updated
</pre></dd>
<dd><a id="DGBKR3686"></a><a id="BGBIAJCB"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Upgrade the protection mode to <code dir="ltr"><span class="codeinlinebold">MAXAVAILABILITY</span></code>, if necessary.</dt>
<dd>
<p>If it is necessary to upgrade the protection mode, use the following DGMGRL <code dir="ltr">EDIT CONFIGURATION</code> command. For example:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT CONFIGURATION SET PROTECTION MODE AS MAXAVAILABILITY;
</pre></dd>
<dd><a id="DGBKR3687"></a><a id="BGBBBDDD"></a></dd>
<dt class="seghead">Step 5&nbsp;&nbsp;&nbsp;Enable Flashback Database on the primary and target standby databases, if necessary.</dt>
<dd>
<p>If it is not already enabled on the primary and standby databases, enable Flashback Database by issuing the following statements on each database:</p>
<pre dir="ltr">
ALTER SYSTEM SET UNDO_RETENTION=3600 SCOPE=SPFILE;
ALTER SYSTEM SET UNDO_MANAGEMENT='AUTO' SCOPE=SPFILE;
SHUTDOWN IMMEDIATE;
STARTUP MOUNT;
SHOW PARAMETER UNDO;
ALTER SYSTEM SET DB_FLASHBACK_RETENTION_TARGET=4320 SCOPE=BOTH;
ALTER DATABASE ARCHIVELOG;
ALTER SYSTEM SET db_recovery_file_dest_size=&lt;size&gt;;
ALTER SYSTEM SET db_recovery_file_dest=&lt;directory-specification&gt;;
ALTER DATABASE FLASHBACK ON;
ALTER DATABASE OPEN;
</pre>
<p>Ensure the <code dir="ltr">UNDO_RETENTION</code> and <code dir="ltr">DB_FLASHBACK_RETENTION_TARGET</code> initialization parameters are set to sufficiently large values so that reinstatement is still possible after a prolonged outage.</p>
</dd>
<dd><a id="DGBKR3688"></a><a id="BGBBJJJA"></a></dd>
<dt class="seghead">Step 6&nbsp;&nbsp;&nbsp;Start the observer.</dt>
<dd>
<p>Start the observer by logging into the observer computer and running DGMGRL. <a id="sthref708"></a><a id="sthref709"></a>Connect to the configuration as a user who has the <code dir="ltr">SYSDBA</code> privilege and then issue the <code dir="ltr">START OBSERVER</code> command. Note that the command does not return; that is you will not get the DGMGRL prompt after issuing the command.</p>
<pre dir="ltr">
DGMGRL&gt; CONNECT sys@North_Sales.example.com;
Password: <span class="italic">password</span>
Connected.
DGMGRL&gt; START OBSERVER;
Observer started
</pre>
<p>When starting the observer interactively, Oracle recommends that connection credentials not be supplied as command line parameters to the DGMGRL connect command. This practice prevents other users on the system from using a utility (for example, the UNIX ps utility) to display connection credentials. It also prevents clear-text passwords from being visible on the user's terminal.</p>
<p>When starting the observer from a script, Oracle recommends that you use a method that supports 'connect /', so that database connection credentials do not have to be embedded within the script. If you choose to use a client-side Oracle Wallet as a secure external password store (see <a class="olink ASOAG" href="../../network.112/e40393/toc.htm"><span class="italic">Oracle Database Advanced Security Administrator's Guide</span></a>), be sure to add credentials for both the primary and fast-start failover target standby databases. The database connect string that you specify when adding the credentials for each database must match the <code dir="ltr">ObserverConnectIdentifer</code> or <code dir="ltr">DGConnectIdentifier</code> database property.</p>
</dd>
<dd><a id="DGBKR3689"></a><a id="BGBBAIAC"></a></dd>
<dt class="seghead">Step 7&nbsp;&nbsp;&nbsp;Enable fast-start failover.</dt>
<dd>
<p>You can enable fast-start failover while connected to any database system in the broker configuration. For example:</p>
<pre dir="ltr">
DGMGRL&gt; ENABLE FAST_START FAILOVER;
Enabled.
</pre></dd>
<dd><a id="DGBKR3690"></a><a id="BGBGJCID"></a></dd>
<dt class="seghead">Step 8&nbsp;&nbsp;&nbsp;Verify the fast-start failover configuration.</dt>
<dd>
<p>Use the <code dir="ltr">SHOW FAST_START FAILOVER</code> command to display the fast-start failover settings:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW FAST_START FAILOVER;
 
Fast-Start Failover: ENABLED
 Threshold:           30 seconds
 Target:              South_Sales
 Observer:            observer.example.com
 Lag Limit:           30 seconds (not in use)
 Shutdown Primary:    TRUE
 Auto-reinstate:      TRUE
 
Configurable Failover Conditions
 Health Conditions:
   Corrupted Controlfile          YES
   Corrupted Dictionary           YES
   Inaccessible Logfile            NO
   Stuck Archiver                  NO
   Datafile Offline               YES
 
 Oracle Error Conditions:
   (none)
</pre>
<p>The following commands show that the <code dir="ltr">FastStartFailoverTarget</code> property is set up reciprocally once fast-start failover is enabled. The first command, issued for the current primary database <code dir="ltr">North_Sales</code>, shows the value of the <code dir="ltr">FastStartFailoverTarget</code> property to be the current target standby, <code dir="ltr">South_Sales</code>. The second command, issued for the target standby <code dir="ltr">South_Sales</code>, shows the current primary, <code dir="ltr">North_Sales</code>, as the target standby's future target standby should it ever take over as a primary.</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales' FastStartFailoverTarget;
 FastStartFailoverTarget='South_Sales';
 
DGMGRL&gt; SHOW DATABASE 'South_Sales' FastStartFailoverTarget;
 FastStartFailoverTarget='North_Sales';
</pre></dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="i1005869"></a>
<div id="DGBKR525" class="sect1">
<h2 class="sect1"><span class="secnum">6.7</span> Scenario 6: Performing Routine Management Tasks</h2>
<p>There may be situations in which you want to <a id="sthref710"></a><a id="sthref711"></a><a id="sthref712"></a>change the <a id="sthref713"></a>state or properties of the databases in a broker configuration to perform routine maintenance on one or more databases. You might also need to temporarily disable broker management of databases in a configuration.</p>
<a id="i1005875"></a>
<div id="DGBKR530" class="sect2">
<h3 class="sect2"><span class="secnum">6.7.1</span> Changing Properties and States</h3>
<p>As you monitor the configuration, you might need to dynamically modify the states of the databases or their properties. The following sections show how to change the state or properties of the databases in the configuration.</p>
<a id="i1009344"></a>
<div id="DGBKR535" class="sect3">
<h4 class="sect3"><span class="secnum">6.7.1.1</span> <a id="sthref714"></a>Alter a Database Property</h4>
<p>You can modify the values of database properties at any time&mdash;if the database is enabled or disabled.</p>
<p><a href="#i1005905">Example 6-3</a> shows how to use the <code dir="ltr">EDIT DATABASE</code> command to change the <code dir="ltr">LogXptMode</code> database property to the value ASYNC for the <code dir="ltr">North_Sales</code> database.</p>
<div id="DGBKR3605" class="example">
<p class="titleinexample"><a id="i1005905"></a>Example 6-3 Altering a Database Property</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref715"></a>EDIT DATABASE 'North_Sales' SET PROPERTY 'LogXptMode'=ASYNC;
</pre>
<p>DGMGRL returns the following message to indicate that the <code dir="ltr">LogXptMode</code> property was updated successfully in the Data Guard configuration file:</p>
<pre dir="ltr">
Property "LogXptMode" updated 
</pre>
<p>If the configuration is currently disabled, the database does not use the new property value until you enable the broker configuration with the <code dir="ltr">ENABLE CONFIGURATION</code> command.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<div id="DGBKR540" class="sect3"><a id="sthref716"></a>
<h4 class="sect3"><span class="secnum">6.7.1.2</span> <a id="sthref717"></a>Alter the State of a Standby Database</h4>
<p>You might want to temporarily stop Redo Apply on a physical standby. To change the state of the standby database to <code dir="ltr">APPLY-OFF</code>, enter the <code dir="ltr">EDIT DATABASE</code> command as shown in <a href="#i1005927">Example 6-4</a>.</p>
<div id="DGBKR3606" class="example">
<p class="titleinexample"><a id="i1005927"></a>Example 6-4 Altering a Standby Database State</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref718"></a>EDIT DATABASE 'South_Sales' SET STATE='APPLY-OFF';
Succeeded.
</pre>
<p>Redo data is still being received when you put the physical standby database in the <code dir="ltr">APPLY-OFF</code> state.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect3" -->
<div id="DGBKR545" class="sect3"><a id="sthref719"></a>
<h4 class="sect3"><span class="secnum">6.7.1.3</span> <a id="sthref720"></a>Alter the State of a Primary Database</h4>
<p>You might want to stop the transmittal of redo data to the standby database. To change the state of the primary database to accommodate this, use the following command:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE North_Sales SET STATE=TRANSPORT-OFF;
 
Succeeded.
</pre>
<p>To change the state of the primary database back to TRANSPORT-ON, do the following:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE North_Sales SET STATE=TRANSPORT-ON;
 
Succeeded.
</pre></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1005955"></a>
<div id="DGBKR550" class="sect2">
<h3 class="sect2"><span class="secnum">6.7.2</span> Disabling the Configuration and Databases</h3>
<p>When you <a id="sthref721"></a><a id="sthref722"></a>disable the broker configuration or any of its databases, you are disabling the broker's management of those objects and are effectively removing your ability to use DGMGRL to manage and monitor the disabled object. However, disabling the broker's management of a broker configuration does not affect the actual operation of the underlying Data Guard configuration or the databases. For example, the redo transport services and log apply services in the Data Guard configuration continue to function unchanged, but you can no longer manage them.</p>
<div id="DGBKR555" class="sect3"><a id="sthref723"></a>
<h4 class="sect3"><span class="secnum">6.7.2.1</span> Disable a Configuration</h4>
<p>You must use the <code dir="ltr">DISABLE CONFIGURATION</code> command to disable management of the entire broker configuration including the primary database as shown in <a href="#i1005972">Example 6-5</a>.</p>
<div id="DGBKR3607" class="example">
<p class="titleinexample"><a id="i1005972"></a>Example 6-5 Disabling the Configuration and<a id="sthref724"></a> Primary Database</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref725"></a>DISABLE CONFIGURATION;
</pre>
<p>The only way to disable broker management of the primary database is to use the <code dir="ltr">DISABLE CONFIGURATION</code> command; the <code dir="ltr">DISABLE DATABASE</code> command only disables management of a standby database.</p>
</div>
<!-- class="example" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
If you disable management of a configuration while connected to the standby database, you must connect to the primary database to reenable the configuration.</div>
<p>Disabling the broker's management of an object <span class="italic">does not</span> remove its profile from the broker configuration file. You can reenable your ability to use DGMGRL (or Enterprise Manager) to manage the object by entering the appropriate <code dir="ltr">ENABLE</code> <code dir="ltr">CONFIGURATION</code> or <code dir="ltr">ENABLE DATABASE</code> command.</p>
</div>
<!-- class="sect3" -->
<div id="DGBKR560" class="sect3"><a id="sthref726"></a>
<h4 class="sect3"><span class="secnum">6.7.2.2</span> <a id="sthref727"></a>Disable a Standby Database</h4>
<p>You use the <code dir="ltr">DISABLE DATABASE</code> command when you temporarily do not want the broker to manage and monitor a standby database.</p>
<p>You can explicitly disable broker management of a standby database to prevent it from being enabled when the rest of the configuration is enabled. <a href="#BGBEAEDG">Example 6-6</a> shows how to disable the <code dir="ltr">South_Sales</code> standby database.</p>
<div id="DGBKR3608" class="example">
<p class="titleinexample"><a id="BGBEAEDG"></a>Example 6-6 Disabling a Standby Database</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref728"></a>DISABLE DATABASE 'South_Sales';
Disabled.
</pre></div>
<!-- class="example" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot disable a standby database from the configuration if fast-start failover is enabled and the database to be disabled is the target standby database.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
If you disable management of a standby database while connected to that standby database, you must connect to the primary database or another enabled standby database to reenable broker-management of the standby database.</div>
<div class="infoboxnotewarn">
<p class="notep1">Caution:</p>
<p class="warnsp">If you disable broker management of a standby database in the broker configuration, that standby database cannot be used by the broker as a failover target in the event of loss of the primary database.</p>
</div>
<p>When operating under either maximum protection mode or maximum availability mode, the broker prevents you from disabling the last standby database that supports the protection mode.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1006015"></a>
<div id="DGBKR565" class="sect2">
<h3 class="sect2"><span class="secnum">6.7.3</span> Removing the Configuration or a Standby Database</h3>
<p>When you use either the <a id="sthref729"></a><code dir="ltr">REMOVE CONFIGURATION</code> or <code dir="ltr">REMOVE DATABASE</code> command, you effectively delete the configuration or standby database profile from the broker configuration file, removing the ability of the Data Guard broker to manage the configuration or the standby database, respectively.</p>
<p>A remove operation with the <code dir="ltr">PRESERVE DESTINATIONS</code> clause <span class="italic">does not</span> remove or delete the actual Data Guard configuration underneath, nor does it affect the operation of the actual Data Guard configuration and its databases.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
After you use the <code dir="ltr">REMOVE CONFIGURATION</code> or <code dir="ltr">REMOVE DATABASE</code> command, you cannot recover the configuration or database profile that was deleted from the broker configuration file. You must go through the steps in <a href="#CIAGDCHH">Section 6.2</a> as necessary, to create a broker configuration that can be managed with DGMGRL (or the Enterprise Manager).</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot remove a standby database from the configuration if fast-start failover is enabled and the database to be removed is the target standby database.</div>
<dl>
<dd><a id="DGBKR3691"></a><a id="sthref730"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;<a id="sthref731"></a>Remove a standby database from the configuration.</dt>
<dd>
<p>When you use the <code dir="ltr">REMOVE DATABASE</code> command, broker management and monitoring of the database ceases and the database's profile is deleted from the broker configuration file.</p>
<p>Show the configuration before deletion of the <code dir="ltr">South_Sales</code> standby database:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
    South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>Issue the DGMGRL <code dir="ltr">REMOVE DATABASE</code> command to remove the <code dir="ltr">South_Sales</code> database information from the Data Guard configuration file:</p>
<pre dir="ltr">
DGMGRL&gt; REMOVE DATABASE 'South_Sales';
Removed database "South_Sales" from the configuration
</pre>
<p>Show the configuration after deletion of the <code dir="ltr">South_Sales</code> standby database:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>When operating under either maximum protection mode or maximum availability mode, the broker prevents you from deleting the last standby database that supports the protection mode.</p>
</dd>
<dd><a id="DGBKR3692"></a><a id="sthref732"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Remove the broker configuration.</dt>
<dd>
<p>Use the following command to remove the entire configuration from management and monitoring by the broker:</p>
<pre dir="ltr">
DGMGRL&gt; <a id="sthref733"></a>REMOVE CONFIGURATION;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
You cannot remove the configuration if fast-start failover is enabled.</div>
<p>DGMGRL returns the following message to indicate the command successfully removed all of the configuration information from the Data Guard configuration file:</p>
<pre dir="ltr">
Removed configuration
 
DGMGRL&gt; SHOW CONFIGURATION;
Error: ORA-16532: Data Guard broker configuration does not exist
 
Configuration details cannot be determined by DGMGRL
</pre></dd>
</dl>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1006660"></a>
<div id="DGBKR570" class="sect1">
<h2 class="sect1"><span class="secnum">6.8</span> Scenario 7: Performing a Switchover Operation</h2>
<p>You can switch the role of the primary database and a standby database using the <code dir="ltr">SWITCHOVER</code> command. Before you issue the <a id="sthref734"></a><a id="sthref735"></a><a id="sthref736"></a><code dir="ltr">SWITCHOVER</code> command, you must ensure:</p>
<ul>
<li>
<p>The state of the primary and standby databases are <code dir="ltr">TRANSPORT-ON</code> and <code dir="ltr">APPLY-ON</code>, respectively.</p>
</li>
<li>
<p>All participating databases are in good health, without any errors or warnings present.</p>
</li>
<li>
<p>The standby database properties were set on the primary database, so that the primary database can function correctly when transitioning to a standby database (shown in the following examples in boldface type).</p>
</li>
<li>
<p>Standby redo log files on the primary database are set up, and the <code dir="ltr">LogXptMode</code> database property is set to <code dir="ltr">SYNC</code> if the configuration is operating in either maximum availability mode or maximum protection mode.</p>
</li>
<li>
<p>If fast-start failover is enabled, you can perform a switchover only to the standby database that was specified as the target standby database.</p>
</li>
</ul>
<dl>
<dd><a id="DGBKR3693"></a><a id="sthref737"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Check the primary database.</dt>
<dd>
<p>Use the <code dir="ltr">SHOW DATABASE VERBOSE</code> command to check the state, health, and properties of the primary database, as follows:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE VERBOSE 'North_Sales';
 
Database - North_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    north_sales1
 
  Properties:
    DGConnectIdentifier             = 'North_Sales.example.com'
    ObserverConnectIdentifier       = ''
    <span class="bold">LogXptMode                      = 'sync'</span>
    DelayMins                       = '0'
    Binding                         = 'optional'
    MaxFailure                      = '0'
    MaxConnections                  = '1'
    ReopenSecs                      = '300'
    NetTimeout                      = '30'
    RedoCompression                 = 'DISABLE'
    LogShipping                     = 'ON'
PreferredApplyInstance          = ''
    ApplyInstanceTimeout            = '0'
    ApplyParallel                   = 'AUTO'
    StandbyFileManagement           = 'AUTO'
    ArchiveLagTarget                = '0'
    LogArchiveMaxProcesses          = '5'
    LogArchiveMinSucceedDest        = '1'
    <span class="bold">DbFileNameConvert               = 'dbs/bt, dbs/t'</span>
    <span class="bold">LogFileNameConvert              = 'dbs/bt, dbs/t'</span>
    FastStartFailoverTarget         = 'South_Sales'
    InconsistentProperties          = '(monitor)'
    InconsistentLogXptProps         = '(monitor)'
    SendQEntries                    = '(monitor)'
    LogXptStatus                    = '(monitor)'
    RecvQEntries                    = '(monitor)'
    SidName                         = 'north_sales1'
    StaticConnectIdentifier         = '(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)
(HOST=North_Sales.example.com)(PORT=2840))
(CONNECT_DATA=(SERVICE_NAME=North_Sales_DGMGRL.example.com)
(INSTANCE_NAME=north_sales1)(SERVER=DEDICATED)))'
    <span class="bold">StandbyArchiveLocation          = 'USE_DB_RECOVERY_FILE_DEST'</span>
    AlternateLocation               = ''
    LogArchiveTrace                 = '255'
    <span class="bold">LogArchiveFormat                = 'db1r_%d_%t_%s_%R.arc'</span>
    LatestLog                       = '(monitor)'
    TopWaitEvents                   = '(monitor)'
 
Database Status:
SUCCESS
 
DGMGRL&gt;
</pre>
<p>In particular, you should examine the boldface properties and the current status of the primary database. See <a href="dbresource.htm#g1044508">Chapter 4</a> for information about managing databases.</p>
</dd>
<dd><a id="DGBKR3694"></a><a id="sthref738"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Check the standby database that is the target of the switchover.</dt>
<dd>
<p>Use the <code dir="ltr">SHOW DATABASE VERBOSE</code> command to check the state, health, and properties of the standby database that is the target of the switchover. For example:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE VERBOSE 'South_Sales';
 
Database - South_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  ONLINE
  Transport Lag:   0
  Apply Lag:       0
  Real Time Query: OFF
  Instance(s):
    south_sales1
Properties:
    DGConnectIdentifier             = 'South_Sales.example.com'
    ObserverConnectIdentifier       = ''
    LogXptMode                      = 'ASYNC'
    DelayMins                       = '0'
    Binding                         = 'optional'
    MaxFailure                      = '0'
    MaxConnections                  = '1'
    ReopenSecs                      = '300'
    NetTimeout                      = '30'
    RedoCompression                 = 'DISABLE'
    LogShipping                     = 'ON'
    PreferredApplyInstance          = ''
    ApplyInstanceTimeout            = '0'
    ApplyParallel                   = 'AUTO'
    StandbyFileManagement           = 'AUTO'
    ArchiveLagTarget                = '0'
    LogArchiveMaxProcesses          = '5'
    LogArchiveMinSucceedDest        = '1'
    DbFileNameConvert               = 'dbs/t, dbs/bt'
    LogFileNameConvert              = 'dbs/t, dbs/bt'
    FastStartFailoverTarget         = 'North_Sales'
    InconsistentProperties          = '(monitor)'
    InconsistentLogXptProps         = '(monitor)'
    SendQEntries                    = '(monitor)'
    LogXptStatus                    = '(monitor)'
    RecvQEntries                    = '(monitor)'
    SidName                         = 'south_sales1'
    StaticConnectIdentifier         = '(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)
(HOST=south_sales1.example.com)(PORT=2840))
(CONNECT_DATA=(SERVICE_NAME=South_Sales_DGMGRL.example.com)
(INSTANCE_NAME=south_sales1)(SERVER=DEDICATED)))'
    StandbyArchiveLocation          = 'USE_DB_RECOVERY_FILE_DEST'
    AlternateLocation               = ''
    LogArchiveTrace                 = '255'
    LogArchiveFormat                = 'db2r_%d_%t_%s_%R.arc'
    LatestLog                       = '(monitor)'
    TopWaitEvents                   = '(monitor)'
 
Database Status:
SUCCESS
</pre>
<p>In particular, you should examine the current status of the database.</p>
</dd>
<dd><a id="DGBKR3695"></a><a id="sthref739"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Issue the switchover command.</dt>
<dd>
<p>Issue the <code dir="ltr">SWITCHOVER</code> command to swap the roles of the primary and standby databases. The following example shows how the broker automatically shuts down and restarts the old primary database as a part of the switchover. (See the usage notes in <a href="dgmgrl.htm#i91611">Section 7.1.3</a> for information about how to set up the broker environment so that DGMGRL can automatically restart the primary and standby databases for you.)</p>
<pre dir="ltr">
DGMGRL&gt; switchover to 'South_Sales';
Performing switchover NOW, please wait...
New primary database "South_Sales" is opening...
Operation requires shutdown of instance "north_sales1" on database "North_Sales"
Shutting down instance "north_sales1"...
ORA-01109: database not open
 
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance "north_sales1" on database "North_Sales"
Starting instance "north_sales1"...
ORACLE instance started.
Database mounted.
Switchover succeeded, new primary is "South_Sales"
</pre>
<p>After the switchover completes, use the <code dir="ltr">SHOW CONFIGURATION</code> and <code dir="ltr">SHOW DATABASE</code> commands to verify that the switchover operation was successful.</p>
</dd>
<dd><a id="DGBKR3696"></a><a id="sthref740"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Show the configuration.</dt>
<dd>
<p>Issue the <code dir="ltr">SHOW CONFIGURATION</code> command to verify that the switchover was successful.</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
    North_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre></dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="i1007698"></a>
<div id="DGBKR575" class="sect1">
<h2 class="sect1"><span class="secnum">6.9</span> Scenario 8: Performing a Manual Failover Operation</h2>
<p>You invoke a <a id="sthref741"></a><a id="sthref742"></a><a id="sthref743"></a><a id="sthref744"></a>failover operation in response to an emergency situation, usually when the primary database cannot be accessed or is unavailable. See <a href="sofo.htm#BCGIEFCF">Section 5.2</a> before you fail over to decide which standby database should be the target of the failover. The following scenario describes a failover to the remote database called <code dir="ltr">South_Sales</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
If fast-start failover is enabled, you can perform a manual failover only to the standby database that was specified as the target of a fast-start failover and only when the observer is running and currently has connectivity with the standby database.
<p>If you want to perform a manual failover to a standby database that is not the fast-start failover target standby database, you must first disable fast-start failover using the <code dir="ltr">FORCE</code> option on the standby database you want to fail over. See <a href="sofo.htm#BCGJEGAF">Section 5.5.5, "Disabling Fast-Start Failover"</a> for more information about the <code dir="ltr">FORCE</code> option.</p>
</div>
<dl>
<dd><a id="DGBKR3697"></a><a id="sthref745"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Connect to the target standby database.</dt>
<dd>
<p>To perform the failover operation, you must connect to the standby database to which you want to fail over to as a user that has the <code dir="ltr">SYSDBA</code> privilege. For example:</p>
<pre dir="ltr">
DGMGRL&gt; CONNECT sys@South_Sales.example.com;
Password: <span class="italic">password</span>
Connected.
</pre></dd>
<dd><a id="DGBKR3698"></a><a id="sthref746"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Issue the failover command.</dt>
<dd>
<p>Now you can issue the failover command to make the target standby database the new primary database for the configuration.</p>
<pre dir="ltr">
DGMGRL&gt; FAILOVER TO 'South_Sales';
Performing failover NOW, please wait...
Failover succeeded, new primary is "South_Sales"
</pre>
<p>Note that after the failover completes, the original primary database cannot be used as a standby database of the new primary database unless it is reinstated or re-created (as described in <a href="sofo.htm#CHDEHEEF">Section 5.4.3</a>).</p>
</dd>
<dd><a id="DGBKR3699"></a><a id="sthref747"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Show the configuration.</dt>
<dd>
<p>Issue the <code dir="ltr">SHOW CONFIGURATION</code> command to verify the failover.</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
      Warning: ORA-16629: database reports a different protection level from the protection mode
 
    North_Sales - Physical standby database (disabled)
      ORA-16661: the standby database needs to be reinstated
 
Fast-Start Failover: DISABLED
 
Configuration Status:
WARNING
</pre>
<p>Note that in this example, the configuration was operating in maximum availability mode. The protection mode was preserved after the failover. The configuration also has a warning status. The <code dir="ltr">SHOW DATABASE</code> command for the new primary shows that the warning is the result of not having an enabled physical standby database. As a result, the warning status indicates that the protection level of the configuration is not the same as the configured mode.</p>
</dd>
<dd><a id="DGBKR3700"></a><a id="sthref748"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Show the new primary database.</dt>
<dd>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE South_Sales;
Database - South_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    south_sales1
 
  Database Warning(s):
    ORA-16629: database reports a different protection level from the protection mode
 
Database Status:
WARNING
</pre></dd>
<dd><a id="DGBKR3701"></a><a id="sthref749"></a></dd>
<dt class="seghead">Step 5&nbsp;&nbsp;&nbsp;Show the old primary database.</dt>
<dd>
<p>Issue the <code dir="ltr">SHOW DATABASE</code> command to see that the former (failed) primary database was disabled by the broker as a consequence of the failover. It must be reinstated (as described in <a href="sofo.htm#CHDEHEEF">Section 5.4.3</a>).</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales';
Database - North_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  APPLY-ON
  Transport Lag:   (unknown)
  Apply Lag:       (unknown)
  Real Time Query: OFF
  Instance(s):
    north_sales1
 
Database Status:
ORA-16661: the standby database needs to be reinstated
</pre></dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="BGBBDEBC"></a>
<div id="DGBKR3431" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.10</span> Scenario 9: Reinstating a Failed Primary Database</h2>
<p>If your primary database had been configured with Flashback Database, you can easily reinstate the failed primary database as a standby database of the new primary database. The failed primary database will be reinstated as a standby type that matches the old standby database. For example, if you failed over to a physical standby database, the old primary will be reinstated as a physical standby database.</p>
<p>To reinstate the failed primary database, start it to the mounted state. Then run DGMGRL, connect to the new primary database and reinstate the old primary database.</p>
<dl>
<dd><a id="DGBKR3702"></a><a id="sthref750"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Restart the Old Primary Database.</dt>
<dd>
<pre dir="ltr">
% sqlplus sys as sysdba
Enter password: <span class="italic">password</span>

SQL&gt; STARTUP MOUNT;
ORACLE instance started.
 
Total System Global Area  234364928 bytes
Fixed Size                  1296352 bytes
Variable Size             209717280 bytes
Database Buffers           16777216 bytes
Redo Buffers                6574080 bytes
Database mounted.
</pre></dd>
<dd><a id="DGBKR3703"></a><a id="sthref751"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Reinstate the old primary database.</dt>
<dd>
<pre dir="ltr">
% dgmgrl connect sys
Password: <span class="italic">password</span>
Connected.
DGMGRL&gt; REINSTATE DATABASE 'North_Sales';
Reinstating database "North_Sales", please wait...
Operation requires shutdown of instance "north_sales1" on database "North_Sales"
Shutting down instance "north_sales1"...
ORA-01109: database not open
 
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance "north_sales1" on database "North_Sales"
Starting instance "north_sales1"...
ORACLE instance started.
Database mounted.
Continuing to reinstate database "North_Sales" ...
Reinstatement of database "North_Sales" succeeded
</pre>
<p>After the primary has been reinstated, issue the <code dir="ltr">SHOW CONFIGURATION</code> and <code dir="ltr">SHOW DATABASE</code> commands to confirm that the old primary has been successfully reinstated.</p>
</dd>
<dd><a id="DGBKR3704"></a><a id="sthref752"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Show the Configuration and Databases.</dt>
<dd>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION
 
Configuration - DRSolution
 
  Protection Mode: MaxAvailability
  Databases:
    South_Sales  - Primary database
    North_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS

DGMGRL&gt; SHOW DATABASE 'South_Sales';
 
Database - South_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    south_sales1
 
Database Status:
SUCCESS
 
DGMGRL&gt; SHOW DATABASE 'North_Sales'
 
Database - North_Sales
 
  Role:            PHYSICAL STANDBY
  Intended State:  APPLY-ON
  Transport Lag:   0 seconds
  Apply Lag:       0 seconds
  Real Time Query: OFF
  Instance(s):
    north_sales1
 
Database Status:
SUCCESS
</pre></dd>
</dl>
</div>
<!-- class="sect1" -->
<a id="BGBJIGJH"></a>
<div id="DGBKR3432" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">6.11</span> Scenario 10: Converting a Physical Standby to a Snapshot Standby</h2>
<p>If you have a physical standby database that you would like to convert to a snapshot standby database, use the DGMGRL <code dir="ltr">CONVERT DATABASE</code> command. Redo data will continue to be received by the database while it is operating as a snapshot standby database, but it will not be applied until the snapshot standby is converted back into a physical standby database.</p>
<p>A physical standby database must be configured with a fast recovery area to convert it to a snapshot standby database. This is because a guaranteed restore point is created during the conversion process, and guaranteed restore points require a fast recovery area.</p>
<pre dir="ltr">
DGMGRL&gt; convert database 'South_Sales' to snapshot standby;
Converting database "South_Sales" to a Snapshot Standby database, please wait...
Database "South_Sales" converted successfully

DGMGRL&gt; SHOW CONFIGURATION;
 
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
    South_Sales  - Snapshot standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
SUCCESS
</pre>
<p>When you are ready to revert the database back to a physical standby database, use the DGMGRL <code dir="ltr">CONVERT DATABASE</code> command again as follows. Any updates made to the database while it was operating as a snapshot standby database will be discarded. All accumulated redo data will be applied by Redo Apply services after the database is converted back to a physical standby database.</p>
<pre dir="ltr">
DGMGRL&gt; CONVERT DATABASE 'South_Sales' to PHYSICAL STANDBY;
Converting database "South_Sales" to a Physical Standby database, please wait...
Operation requires shutdown of instance "south_sales1" on database "South_Sales"
Shutting down instance "south_sales1"...
Database closed.
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance "south_sales1" on database "South_Sales"
Starting instance "south_sales1"...
ORACLE instance started.
Database mounted.
Continuing to convert database "South_Sales" ...
Operation requires shutdown of instance "south_sales1" on database "South_Sales"
Shutting down instance "south_sales1"...
ORA-01109: database not open
Database dismounted.
ORACLE instance shut down.
Operation requires startup of instance "south_sales1" on database "South_Sales"
Starting instance "south_sales1"...
ORACLE instance started.
Database mounted.
Database "South_Sales" converted successfully
</pre></div>
<!-- class="sect1" -->
<a id="i1009142"></a>
<div id="DGBKR580" class="sect1">
<h2 class="sect1"><span class="secnum">6.12</span> Scenario 11: Monitoring a Data Guard Configuration</h2>
<p>The <a id="sthref753"></a><a id="sthref754"></a><a id="sthref755"></a>scenario in this section demonstrates how to use the <code dir="ltr">SHOW</code> command and monitorable database properties to identify and resolve a failure situation.</p>
<dl>
<dd><a id="DGBKR3705"></a><a id="sthref756"></a></dd>
<dt class="seghead">Step 1&nbsp;&nbsp;&nbsp;Check the configuration status.</dt>
<dd>
<p>The status of the broker configuration is an aggregated status of all databases and instances in the broker configuration. You can check the configuration status first to determine whether or not any further action needs to be taken. If the configuration status is SUCCESS, everything in the broker configuration is working properly. However, if you see a status of WARNING or ERROR, then something is wrong in the configuration.</p>
<p>For example, in the following display, you can see that the primary database has multiple warnings:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW CONFIGURATION;
Configuration - DRSolution
 
  Protection Mode: MaxPerformance
  Databases:
    North_Sales  - Primary database
      Warning: ORA-16809: multiple warnings detected for the database
 
    South_Sales  - Physical standby database
 
Fast-Start Failover: DISABLED
 
Configuration Status:
WARNING
</pre></dd>
<dd><a id="DGBKR3706"></a><a id="sthref757"></a></dd>
<dt class="seghead">Step 2&nbsp;&nbsp;&nbsp;Check the database status.</dt>
<dd>
<p>To identify the warnings on the primary database, show its status using the <code dir="ltr">SHOW DATABASE</code> command:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales';
Database - North_Sales
 
  Role:            PRIMARY
  Intended State:  TRANSPORT-ON
  Instance(s):
    north_sales1
      Warning: ORA-16737: the redo transport service for standby "South_Sales" has an error
      Warning: ORA-16714: the value of property LogArchiveTrace is inconsistent with the database setting
      Warning: ORA-16715: redo transport-related property ReopenSecs of standby
 database "South_Sales" is inconsistent

Database Status:
WARNING
</pre></dd>
<dd><a id="DGBKR3707"></a><a id="sthref758"></a></dd>
<dt class="seghead">Step 3&nbsp;&nbsp;&nbsp;Check the LogXptStatus monitorable database property.</dt>
<dd>
<p>The <code dir="ltr">SHOW DATABASE</code> output in step 2 shows a Warning for error ORA-16737. To identify the exact transport error, use the <code dir="ltr">LogXptStatus</code> monitorable database property:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales' 'LogXptStatus';
LOG TRANSPORT STATUS
PRIMARY_INSTANCE_NAME  STANDBY_DATABASE_NAME  STATUS 
         north_sales1            South_Sales  ORA-12541: TNS:no listener
</pre>
<p>The output shows that the listener for the physical standby database is not running. To fix this error, start the listener for the physical standby database <code dir="ltr">South_Sales</code>.</p>
</dd>
<dd><a id="DGBKR3708"></a><a id="sthref759"></a></dd>
<dt class="seghead">Step 4&nbsp;&nbsp;&nbsp;Check the InconsistentProperties monitorable database property.</dt>
<dd>
<p>The <code dir="ltr">SHOW DATABASE</code> output in step 2 also shows a Warning for error ORA-16714. To identify the exact error, use the <code dir="ltr">InconsistentProperties</code> monitorable database property:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales' 'InconsistentProperties';
INCONSISTENT PROPERTIES
 INSTANCE_NAME  PROPERTY_NAME   MEMORY_VALUE SPFILE_VALUE BROKER_VALUE
 north_sales1   LogArchiveTrace 511          255          255
</pre>
<p>The current database memory value (511) is different from both the server parameter file (SPFILE) value (255) and the Data Guard broker's property value (255). If you decide the database memory value is correct, you can update the Data Guard broker's property value using the following command:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'North_Sales' SET PROPERTY 'LogArchiveTrace'=511;
Property "LogArchiveTrace" updated
</pre>
<p>This command will result in the broker updating the SPFILE value so that the value of <code dir="ltr">LogArchiveTrace</code> is kept consistent.</p>
</dd>
<dd><a id="DGBKR3709"></a><a id="sthref760"></a></dd>
<dt class="seghead">Step 5&nbsp;&nbsp;&nbsp;Check the InconsistentLogXptProps monitorable database property.</dt>
<dd>
<p>Another warning shown in the <code dir="ltr">SHOW DATABASE</code> display in Step 2 is ORA-16715. To identify the inconsistent values for the redo transport database property, <code dir="ltr">ReopenSecs</code>, you can use the <code dir="ltr">InconsistentLogXptProps</code> monitorable database property:</p>
<pre dir="ltr">
DGMGRL&gt; SHOW DATABASE 'North_Sales' 'InconsistentLogXptProps';
INCONSISTENT LOG TRANSPORT PROPERTIES
 INSTANCE_NAME  STANDBY_NAME  PROPERTY_NAME  MEMORY_VALUE  BROKER_VALUE 
   south_sales1   South_Sales     ReopenSecs           600           300
</pre>
<p>The current database memory value (600) is different from the Data Guard broker's property value (300). If you think the broker's property value is correct, you can fix the inconsistency by re-editing the property of the standby database with the same value, as shown in the following example:</p>
<pre dir="ltr">
DGMGRL&gt; EDIT DATABASE 'South_Sales' SET PROPERTY 'ReopenSecs'=300;
Property "ReopenSecs" updated
</pre>
<p>You can also reenable the standby database or reset the state of the primary database to <code dir="ltr">TRANSPORT-ON</code> to fix this inconsistency.</p>
</dd>
</dl>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1477">
<tr>
<td class="cellalignment1484">
<table class="cellalignment1482">
<tr>
<td class="cellalignment1481"><a href="sofo.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1481"><a href="dgmgrl.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1486">
<table class="cellalignment1480">
<tr>
<td class="cellalignment1481"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1481"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1481"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1481"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1481"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1481"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
