<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Managing Broker Configurations</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1071" />
<meta name="dcterms.created" content="2015-11-24T12:57:37Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Data Guard Broker" />
<meta name="dcterms.identifier" content="E40771-07" />
<meta name="dcterms.isVersionOf" content="DGBKR" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="install.htm" title="Previous" type="text/html" />
<link rel="Next" href="dbresource.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e40771.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">10/20</span> <!-- End Header -->
<div id="DGBKR095" class="chapter"><a id="g1036260"></a> <a id="i1009518"></a>
<h1 class="chapter"><span class="secnum">3</span> Managing Broker Configurations</h1>
<p>This chapter discusses the following topics:<a id="sthref177"></a></p>
<ul>
<li>
<p><a href="#i1005606">Configuration Support</a></p>
</li>
<li>
<p><a href="#i1021661">Setting Up the Broker Configuration Files</a></p>
</li>
<li>
<p><a href="#i1005744">Starting the Data Guard Broker</a></p>
</li>
<li>
<p><a href="#i1005769">Management Cycle of a Broker Configuration</a></p>
</li>
<li>
<p><a href="#CFHIEFDI">Enable and Disable Operations</a></p>
</li>
<li>
<p><a href="#i1006002">Configuration Status</a></p>
</li>
</ul>
<a id="i1005606"></a>
<div id="DGBKR100" class="sect1">
<h2 class="sect1"><span class="secnum">3.1</span> <a id="sthref178"></a>Configuration Support</h2>
<p>The broker enables you to logically define a Data Guard configuration, consisting of a primary database and one or more standby databases. <a id="sthref179"></a>With the broker, you define a <a id="sthref180"></a><a id="sthref181"></a><span class="bold">broker configuration</span> that is a <span class="italic">logical</span> grouping of the databases, including redo transport services and log apply services. At the DBA's discretion, the broker controls the logical objects in the configuration, modifies their behavior at runtime, monitors the overall health of the configuration, and reports any health and other operational characteristics up through the Oracle Enterprise Management notification mechanisms if you are using Oracle Enterprise Manager, or through <code dir="ltr">SHOW</code> commands if you are using DGMGRL.</p>
<p>The broker supports Data Guard c<a id="sthref182"></a>onfigurations consisting of a primary database, and up to thirty standby databases that are either local to, or, remote from, the <a id="sthref183"></a>primary database. Any of those databases can be an Oracle Real Application Clusters (Oracle RAC) database.</p>
<p><a id="sthref184"></a>A supported Data Guard configuration contains the following components:</p>
<ul>
<li>
<p>A <a id="sthref185"></a>primary database (Oracle RAC or non-Oracle RAC)</p>
</li>
<li>
<p>From one to thirty physical, snapshot, or logical (Oracle RAC or non-Oracle RAC) st<a id="sthref186"></a>andby databases</p>
</li>
<li>
<p>Physical systems that host the primary and standby databases</p>
</li>
<li>
<p><a id="sthref187"></a>Oracle Net Services <a id="sthref188"></a>network configuration that defines a connection between the databases</p>
</li>
<li>
<p>Standby <a id="sthref189"></a>(archived redo log files) <a id="sthref190"></a>destination parameters and configuration properties</p>
</li>
<li>
<p><a id="sthref191"></a>Redo transport services that transmit the redo data from the primary database to the standby databases</p>
</li>
<li>
<p><a id="sthref192"></a>Log apply services that apply redo data to the standby databases from the archived redo log files or standby redo log files</p>
</li>
</ul>
<p><a id="sthref193"></a><a id="sthref194"></a>The Data Guard log apply services update standby databases with redo data that is transmitted automatically from the primary database by redo transport services. The archived redo log files and standby redo log files contain all of the database changes except for <span class="italic">unrecoverable</span> or <span class="italic">unlogged</span> changes. On physical standby databases, <a id="sthref195"></a>Redo Apply applies the redo data to keep the standby consistent with the primary database. On logical standby databases, <a id="sthref196"></a>SQL Apply applies the redo data to keep the standby consistent with the primary database. On snapshot standby databases, the redo data is received but not applied until the snapshot standby database is converted back to a physical standby database.</p>
<p>The broker's Data Guard monitor (DMON) process configures and maintains the broker configuration as a group of <a id="sthref197"></a><a id="sthref198"></a>objects that you can manage and monitor as a single unit. Thus, when you enter a command that affects multiple databases, the DMON process:</p>
<ul>
<li>
<p>Carries out your request on the primary database</p>
</li>
<li>
<p>Coordinates with the DMON process for each of the other databases, as required for your request</p>
</li>
<li>
<p>Updates the configuration file on the local system</p>
</li>
<li>
<p>Communicates with the DMON process for each of the other databases to update their copies of the configuration file</p>
</li>
</ul>
<p>Through the DMON process, you can configure, monitor, and control the databases and the configuration together as a unit. If you disable the configuration, broker management of all of the databases in the configuration is also disabled. If you later enable the configuration, broker management is enabled for each database in the configuration.</p>
<p><a href="#i1016374">Figure 3-1</a> shows a broker configuration with a primary database and physical standby database.</p>
<p>On the primary database, the figure shows the redo transport services in addition to the following main components: the primary database, DMON, the online redo log files, and the archived redo log files. The figure also shows standby redo log files in outline form on the primary side; the standby redo logs are outlined to indicate they are currently inactive but have been configured in preparation for a switchover to the standby role.The physical standby database includes the following components: a standby database, log apply services, DMON, archived redo log files, and standby redo log files. The online redo log files on the physical standby database are outlined to indicate they are currently inactive but have been configured in preparation for a switchover to the primary role.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SBYDB" href="../e41134/toc.htm"><span class="italic">Oracle Data Guard Concepts and Administration</span></a> for more information about physical, snapshot, and logical standby databases</div>
<div id="DGBKR3518" class="figure">
<p class="titleinfigure"><a id="i1016374"></a>Figure 3-1 Oracle Data Guard Broker Configuration</p>
<img width="654" height="560" src="img/dgbkr009.gif" alt="Description of Figure 3-1 follows" /><br />
<a id="sthref199" href="img_text/dgbkr009.htm">Description of ''Figure 3-1 Oracle Data Guard Broker Configuration''</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect1" -->
<a id="i1021661"></a>
<div id="DGBKR105" class="sect1">
<h2 class="sect1"><span class="secnum">3.2</span> Setting Up the Broker Configuration Files</h2>
<p>Two <a id="sthref200"></a>copies of the configuration file are maintained for each database so as to always have a record of the last known <span class="italic">valid</span> state of the configuration. When the broker is started for the first time, the configuration files are automatically created and named using a default path name and filename that is operating-system specific. You can override this default path name and filename by setting the following initialization parameters for that database:</p>
<pre dir="ltr">
DG_BROKER_CONFIG_FILE1
DG_BROKER_CONFIG_FILE2
</pre>
<p>Note the following restrictions when setting the <code dir="ltr">DG_BROKER_CONFIG_FILE1</code> and <code dir="ltr">DG_BROKER_CONFIG_FILE2</code> initialization parameters:</p>
<ul>
<li>
<p>These parameters can only be set or changed when the Data Guard broker is not running (<code dir="ltr">DG_BROKER_START=FALSE</code>).</p>
</li>
<li>
<p>These parameters must specify a raw device, Oracle ASM file, or cluster file system file that is shared for all Oracle RAC instances.</p>
</li>
</ul>
<p>The Data Guard Broker works with databases that use either Oracle managed or user managed datafiles. These datafiles can reside on raw devices, a file system or an Oracle ASM disk group. The following section contains these topics:</p>
<ul>
<li>
<p><a href="#CFHICBJH">Renaming the Broker Configuration Files</a></p>
</li>
<li>
<p><a href="#CFHHJEEE">Managing Broker Configuration Files in an Oracle RAC Environment</a></p>
</li>
</ul>
<a id="CFHICBJH"></a>
<div id="DGBKR3391" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.2.1</span> Renaming the Broker Configuration Files</h3>
<p>You can change the configuration filenames dynamically by issuing the <code dir="ltr">ALTER SYSTEM</code> SQL statement. However, you cannot alter these parameters when the broker's DMON process is running. To change the names of these configuration files for a given database, perform the following steps:</p>
<ol>
<li>
<p>Disable the broker configuration using the DGMGRL <code dir="ltr">DISABLE</code> command. See <a href="#CFHIEFDI">Section 3.5</a>.</p>
</li>
<li>
<p>Stop the Data Guard broker DMON process using the following SQL statement:</p>
<pre dir="ltr">
SQL&gt; ALTER SYSTEM SET DG_BROKER_START=FALSE;
</pre></li>
<li>
<p>Change the configuration filenames for the database:</p>
<pre dir="ltr">
SQL&gt; ALTER SYSTEM SET DG_BROKER_CONFIG_FILE1=<span class="italic">filespec1</span>;
SQL&gt; ALTER SYSTEM SET DG_BROKER_CONFIG_FILE2=<span class="italic">filespec2</span>;
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
If the broker is managing an Oracle RAC database, the value of <code dir="ltr">DG_BROKER_CONFIG_FILE1</code> and the value of <code dir="ltr">DG_BROKER_CONFIG_FILE2</code> for each of the instances must point to the same set of physical files.</div>
</li>
<li>
<p>The method of moving the files depends upon where they currently reside and where you want to move them to:</p>
<ul>
<li>
<p>If the files reside on an operating file system, use operating system commands to move the files to their new location.</p>
</li>
<li>
<p>If the files reside on raw devices, manually transfer the files to their new location.</p>
</li>
<li>
<p>If the old or new location is an Oracle ASM disk group, use the <code dir="ltr">DBMS_FILE_TRANSFER.COPY_FILE</code> function to transfer the files to their new location.</p>
</li>
</ul>
</li>
<li>
<p>Restart the Data Guard broker DMON process, as follows:</p>
<pre dir="ltr">
SQL&gt; ALTER SYSTEM SET DG_BROKER_START=TRUE;
</pre></li>
<li>
<p>Enable the broker configuration using the DGMGRL <code dir="ltr">ENABLE</code> command or the Enable operation in the Data Guard management pages of the Enterprise Manager.</p>
</li>
</ol>
<div class="infobox-note">
<p class="notep1">Note:</p>
As of Release 11.2, the files can reside on disks having any supported sector size (physical block size) up to and including 4KB sectors. Configuration files that were generated by a release prior to 11.2 are restricted to reside only on disks having the same sector size as was used at the time the files were first created. These files must first be upgraded to Release 11.2 before they can be moved to a location having a different sector size, or are otherwise expected to reside across a mixture of sector sizes in a given broker configuration. See <a href="upgrade_appx.htm#BCEDCCAC">Section B.2</a> for more information.</div>
</div>
<!-- class="sect2" -->
<a id="CFHHJEEE"></a>
<div id="DGBKR3392" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.2.2</span> Managing Broker Configuration Files in an Oracle RAC Environment</h3>
<p>If the broker is managing an<a id="sthref201"></a> Oracle RAC database, the value of <a id="sthref202"></a><a id="sthref203"></a><code dir="ltr">DG_BROKER_CONFIG_FILE1</code> and the value of <code dir="ltr">DG_BROKER_CONFIG_FILE2</code> for each of the instances must point to the same set of physical files. In other words, all instances of the database must reference the same set of configuration files. The configuration files can be deployed using one of the following methods:</p>
<ul>
<li>
<p><a href="#CFHHHAJD">Using Cluster File System (CFS) for Configuration Files</a></p>
</li>
<li>
<p><a href="#CFHEABFJ">Using Oracle ASM Disk Groups for Configuration Files</a></p>
</li>
<li>
<p><a href="#CFHDEBDC">Using Raw Devices for Configuration Files</a></p>
</li>
</ul>
<a id="CFHHHAJD"></a>
<div id="DGBKR3393" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.2.2.1</span> Using Cluster File System (CFS) for Configuration Files</h4>
<p>If cluster file system (CFS) is available, and the configuration files reside there, the <code dir="ltr">DG_BROKER_CONFIG_FILE</code><span class="variable">n</span> parameters on all of the instances must be set to these files including the path to the CFS area. <a href="#CFHBJHIG">Figure 3-2</a> shows the set up for the broker configuration files on <a id="sthref204"></a><a id="sthref205"></a><a id="sthref206"></a>CFS. In this scenario, the parameters and value for all instances would be:</p>
<pre dir="ltr">
DG_BROKER_CONFIG_FILE1=$ORACLE_BASE/admin/<span class="italic">db_unique_name</span>/dr1<span class="italic">db_unique_name</span>.dat
DG_BROKER_CONFIG_FILE2=$ORACLE_BASE/admin/<span class="italic">db_unique_name</span>/dr2<span class="italic">db_unique_name</span>.dat
</pre>
<div id="DGBKR3519" class="figure">
<p class="titleinfigure"><a id="CFHBJHIG"></a>Figure 3-2 Broker Configuration Setup in a CFS Area</p>
<img width="662" height="320" src="img/dgbkr002.gif" alt="Description of Figure 3-2 follows" /><br />
<a id="sthref207" href="img_text/dgbkr002.htm">Description of ''Figure 3-2 Broker Configuration Setup in a CFS Area''</a><br />
<br /></div>
<!-- class="figure" --></div>
<!-- class="sect3" -->
<a id="CFHEABFJ"></a>
<div id="DGBKR3394" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.2.2.2</span> Using Oracle ASM Disk Groups for Configuration Files</h4>
<p>The broker's configuration files can also reside on an Oracle ASM disk group. <a href="#CFHBJBDE">Figure 3-3</a> shows the setup for the broker configuration files on Oracle ASM devices. In this scenario, the parameters and values would be specified, as follows:</p>
<pre dir="ltr">
ALTER SYSTEM SET DG_BROKER_CONFIG_FILE1 = '+DG/DIRECTORY/DR1.DAT' SCOPE=BOTH;
ALTER SYSTEM SET DG_BROKER_CONFIG_FILE2 = '+DG/DIRECTORY/DR2.DAT' SCOPE=BOTH;
</pre>
<div id="DGBKR3520" class="figure">
<p class="titleinfigure"><a id="CFHBJBDE"></a>Figure 3-3 Broker Configuration Setup with Oracle ASM</p>
<img width="554" height="321" src="img/dgbkr001.gif" alt="Description of Figure 3-3 follows" /><br />
<a id="sthref208" href="img_text/dgbkr001.htm">Description of ''Figure 3-3 Broker Configuration Setup with Oracle ASM''</a><br />
<br /></div>
<!-- class="figure" -->
<p>Because the configuration files must be explicitly named by the user, these configuration files are not Oracle Managed Files (OMF).To create the broker's configuration files on an Oracle ASM disk group, set the <code dir="ltr">DG_BROKER_CONFIG_FILE1</code> and <code dir="ltr">DG_BROKER_CONFIG_FILE2</code> initialization parameters to a string value that includes the name of an existing Oracle ASM disk group, an existing directory in that disk group, and the name of the configuration file itself.</p>
</div>
<!-- class="sect3" -->
<a id="CFHDEBDC"></a>
<div id="DGBKR3395" class="sect3"><!-- infolevel="all" infotype="General" -->
<h4 class="sect3"><span class="secnum">3.2.2.3</span> Using Raw Devices for Configuration Files</h4>
<p>If CFS is not available and you are not using Oracle ASM, the files must be on raw devices. In this case, the parameter values on each of the instances must point to the <a id="sthref209"></a><a id="sthref210"></a><a id="sthref211"></a>raw devices. <a href="#i1025678">Figure 3-4</a> shows the set up for the broker configuration files on raw devices. On a UNIX system, you would set this up similar to the following on each node:</p>
<pre dir="ltr">
% ln -s /dev/rdsk/c1t2d3s5 dr1inst1.dat
% ln -s /dev/rdsk/c1t2d3s6 dr2inst2.dat
</pre>
<div id="DGBKR3521" class="figure">
<p class="titleinfigure"><a id="i1025678"></a>Figure 3-4 Broker Configuration Setup with Raw Devices</p>
<img width="576" height="323" src="img/dgbkr010.gif" alt="Description of Figure 3-4 follows" /><br />
<a id="sthref212" href="img_text/dgbkr010.htm">Description of ''Figure 3-4 Broker Configuration Setup with Raw Devices''</a><br />
<br /></div>
<!-- class="figure" -->
<p>If the broker configuration files need to be on <a id="sthref213"></a>raw devices, set up two additional raw devices of 1MB each. Set up the value of the <code dir="ltr">DG_BROKER_CONFIG_FILE1</code> and <code dir="ltr">DG_BROKER_CONFIG_FILE2</code> parameters to point to the raw devices. A 1MB configuration file will accommodate 10 databases with a total of 45 instances between them.</p>
<p>You may need a larger device if the number of instances for this configuration exceeds 45 instances. You will need 15KB for each additional instance.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1005744"></a>
<div id="DGBKR115" class="sect1">
<h2 class="sect1"><span class="secnum">3.3</span> <a id="sthref214"></a>Starting the Data Guard Broker</h2>
<p>After setting up the configuration files, the <code dir="ltr"><a id="sthref215"></a>DG_BROKER_START</code> initialization parameter must be set to <code dir="ltr">TRUE</code> for each database to start the DMON processes.</p>
<p>By default, the <code dir="ltr">DG_BROKER_START</code> initialization parameter is set to <code dir="ltr">FALSE</code>. However, you can set the value in the following ways:</p>
<ul>
<li>
<p>If you are using Oracle Enterprise Manager, it automatically sets the <code dir="ltr">DG_BROKER_START</code> initialization parameter to <code dir="ltr">TRUE</code> for new standby databases that it creates.</p>
</li>
<li>
<p>If you are using DGMGRL, you must explicitly set the <code dir="ltr">DG_BROKER_START</code> initialization parameter to <code dir="ltr">TRUE</code>; otherwise, the broker will not start. You can set the <code dir="ltr">DG_BROKER_START</code> initialization parameter with the following SQL statement:</p>
<pre dir="ltr">
SQL&gt; ALTER SYSTEM SET DG_BROKER_START=TRUE;

System altered.

SQL&gt; SHOW PARAMETER DG_BROKER_START

NAME               TYPE      VALUE
------------------------------------  
dg_broker_start    boolean   TRUE
</pre></li>
</ul>
<p>Whether you use Enterprise Manager or DGMGRL, set the value of the <code dir="ltr">DG_BROKER_START</code> initialization parameter to TRUE in the server parameter file on each primary and standby database. Doing so ensures that Data Guard Broker will start automatically the next time you start any instance of the database.</p>
</div>
<!-- class="sect1" -->
<a id="i1005769"></a>
<div id="DGBKR120" class="sect1">
<h2 class="sect1"><span class="secnum">3.4</span> Management Cycle of a <a id="sthref216"></a>Broker Configuration</h2>
<p>The broker helps you to create a new configuration or manage an existing configuration. <a href="#i1019110">Figure 3-5</a> shows the <a id="sthref217"></a>life cycle of a broker configuration.</p>
<div id="DGBKR3522" class="figure">
<p class="titleinfigure"><a id="i1019110"></a>Figure 3-5 Life Cycle of a Broker Configuration and Its Databases</p>
<img width="275" height="386" src="img/dgbkr005.gif" alt="Description of Figure 3-5 follows" /><br />
<a id="sthref218" href="img_text/dgbkr005.htm">Description of ''Figure 3-5 Life Cycle of a Broker Configuration and Its Databases''</a><br />
<br /></div>
<!-- class="figure" -->
<p class="subhead2"><a id="DGBKR3523"></a>Create the<a id="sthref219"></a> <a id="sthref220"></a><a id="sthref221"></a>Broker Configuration</p>
<p>When using Enterprise Manager, the <a id="sthref222"></a><a id="sthref223"></a>Add Standby Database wizard can either add an existing (Oracle RAC or non-Oracle RAC) standby database into the configuration or create a new (Oracle RAC or non-Oracle RAC) standby database and add it to the configuration. The standby database can be a physical, logical, or snapshot database.</p>
<p>When using DGMGRL, the primary database and a standby database must already exist. You construct the standby database from backups of the primary database control files and datafiles, and then prepare it for recovery.</p>
<p class="subhead2"><a id="DGBKR3524"></a>Enable the Broker Configuration</p>
<p>A Data Guard configuration must be enabled to be managed or monitored by the broker. Conversely, you disable a configuration if you no longer want to manage it with the broker. When you disable a configuration, broker management of all of its databases is also disabled.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
You can enable or disable the configuration using DGMGRL. You cannot disable the configuration using Enterprise Manager. You can enable the configuration using Enterprise Manager in the event that it was previously disabled using DGMGRL.</div>
<p>A broker configuration, when first created using Enterprise Manager, is automatically enabled as soon as the Add Standby Database wizard completes.</p>
<p>A broker configuration, when first created using DGMGRL, is in a disabled condition. This means its constituent databases are not yet under active control of the broker. When you finish <a id="sthref224"></a>configuring the databases into a broker configuration with DGMGRL, you must <a id="sthref225"></a><a id="sthref226"></a>enable the configuration to allow the broker to manage the configuration.</p>
<p>You can enable:</p>
<ul>
<li>
<p>The entire configuration, including all of its databases</p>
</li>
<li>
<p>An individual standby database</p>
</li>
</ul>
<p>You can easily disable a database if a problem occurs such that it cannot function properly in a broker configuration. Note that you cannot disable the primary database. You must disable the entire configuration to disable the primary database.</p>
<p>You may also want to disable a configuration temporarily, and then change some properties in the broker configuration without affecting the actual database properties. The changed properties will take effect when the configuration is enabled again for management by the broker.</p>
<p class="subhead2"><a id="DGBKR3525"></a>Make Role Changes Within the Broker Configuration, As Needed</p>
<p>At any <a id="sthref227"></a><a id="sthref228"></a><a id="sthref229"></a>time, you can issue a single command to change the roles of the databases in the configuration. If some event renders the primary database unusable, you can fail over one of the standby databases to become the new primary database.</p>
<p>If Flashback Database was enabled, then after failover has completed, you can reinstate the former primary database as a standby database for the new primary database.</p>
<p>In addition, planned downtime for maintenance can be reduced because you can quickly switch over production processing from the current primary database to a standby database, and then switch back again after the planned maintenance.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="sofo.htm#i1005572">Chapter 5</a> for more information about role changes</div>
<p class="subhead2"><a id="DGBKR3634"></a>Convert to Snapshot Standby Database</p>
<p>At any time, you can issue a single command to convert a physical standby database to a snapshot standby database. The snapshot standby database is a fully updatable database that receives redo data generated from the primary database, but does not apply it.</p>
<p>Once you are done using the snapshot standby database, you can again issue a single command to convert it to a physical standby database. After the conversion to a physical standby has completed, Redo Apply services will start (assuming the state is <code dir="ltr">APPLY-ON</code>) and apply all of the accumulated redo data.</p>
<p class="subhead2"><a id="DGBKR3526"></a>Make State Changes to the Databases, As Needed</p>
<p>When you enable a configuration for the first time, the broker, by default, starts redo transport services on the primary and starts log apply services on the standby (except for a snapshot standby).</p>
<p>At any time, you can issue a single command through Enterprise Manager or DGMGRL to change the state of the database. For example, you could bring the primary database into a <code dir="ltr">TRANSPORT-OFF</code> state to temporarily stop sending redo data to the standby databases. Then, you could issue another command to resume sending redo data to the standby databases.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dbresource.htm#g1044508">Chapter 4</a> for more information about database state changes</div>
<p class="subhead2"><a id="DGBKR3527"></a>Update Database Properties, As Needed</p>
<p>The broker enables you to set <a id="sthref230"></a><a id="sthref231"></a>database properties, some of which correspond to database initialization parameters. You can change these properties to dynamically control such things as redo transport, standby file management, log apply, and to support the overall configuration protection mode. The broker records the changes in the broker configuration file for each database in the Data Guard configuration and propagates the changes to the related initialization parameters in the server parameter files, if needed.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dbresource.htm#g1044508">Chapter 4</a> and <a href="dbpropref.htm#g1012962">Chapter 8</a> for complete information about database properties</div>
<p class="subhead2"><a id="DGBKR3528"></a>Set Data Protection Modes, As Needed</p>
<p>The broker enables you to set the data protection mode for the configuration. You can configure the <a id="sthref232"></a>protection mode to <a id="sthref233"></a>maximize data protection, <a id="sthref234"></a>maximize availability, or <a id="sthref235"></a>maximize performance.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dbresource.htm#i1026456">Section 4.6</a> for information about managing data protection modes</div>
<p class="subhead2"><a id="DGBKR3529"></a>Monitor the Configuration</p>
<p>You can check the health of the configuration, display and update the properties of the databases, and set Oracle Enterprise Manager events.</p>
<p>Enterprise Manager also provides a dynamic <a id="sthref236"></a>performance page that automatically and dynamically refreshes chart data and status at specified intervals. The performance chart shows a graphical summary of how far behind and how much redo data is being generated and applied.</p>
</div>
<!-- class="sect1" -->
<a id="CFHIEFDI"></a>
<div id="DGBKR125" class="sect1">
<h2 class="sect1"><span class="secnum">3.5</span> <a id="sthref237"></a>Enable and Disable Operations</h2>
<p>A key concept of management with the broker is the notion of enabling and disabling broker management of the <a id="sthref238"></a><a id="sthref239"></a><a id="sthref240"></a><a id="sthref241"></a>databases in a broker configuration. The enable and disable operations are defined for databases that were incorporated into a broker configuration; you cannot perform these broker operations on databases that are not part of the broker configuration. This is because when you enable or disable a database in the broker configuration, you are effectively enabling or disabling the ability of the broker to:</p>
<ul>
<li>
<p>Manage and monitor the specified database</p>
</li>
<li>
<p>Manage the profile information in the broker configuration file for each database</p>
</li>
</ul>
<p>However, disabling a broker configuration does not affect current services and operations in the actual Data Guard configuration. For example, when you disable a broker configuration, redo transport services and log apply services in the Data Guard configuration continue to function unchanged, but you can no longer manage them through the broker interfaces.</p>
<p>In addition, disabling a database <span class="italic">does not</span> remove or delete its profile from the broker configuration file. You can still change the properties of a disabled database and later reenable your ability to manage with the broker using the DGMGRL <code dir="ltr">ENABLE CONFIGURATION</code> or <code dir="ltr">ENABLE DATABASE</code> commands, or the Enable option in the Data Guard management pages of Enterprise Manager.</p>
<div class="infobox-note">
<p class="notep1">Caution:</p>
If you disable broker management of a standby database in the broker configuration, that standby database cannot be used by the broker as a failover target in the event of loss of the primary database.</div>
<p>Disabling broker management of the configuration may be useful to do even though you are removing the broker's ability to monitor and control the databases. For example, it may be advantageous to disable a configuration temporarily in order to change one or more properties in the broker configuration all at the same time. When you change properties in a disabled configuration, it does not affect the actual database properties underneath because the changes are not applied to the running database until you reenable the configuration. For example, you might want to change the overall configuration protection mode and the redo transport services properties on a disabled configuration so that all changes are applied to the configuration at the same time upon the next enable operation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="dbresource.htm#i1026543">Section 4.6.2, "How the Protection Modes Influence Broker Operations"</a></div>
</div>
<!-- class="sect1" -->
<a id="i1006002"></a>
<div id="DGBKR130" class="sect1">
<h2 class="sect1"><span class="secnum">3.6</span> Configuration S<a id="sthref242"></a><a id="sthref243"></a>tatus</h2>
<p>A configuration status reveals the overall <a id="sthref244"></a>health of the configuration. Status of the configuration is acquired from the status of all of its databases.<a id="sthref245"></a><a id="sthref246"></a></p>
<p>The following list describes the possible status modes for a configuration:</p>
<ul>
<li>
<p><a id="sthref247"></a>Success</p>
<p>The configuration, including all of the databases configured in it, is operating as specified by the user without any warnings or errors.</p>
</li>
<li>
<p><a id="sthref248"></a>Warning</p>
<p>One or more of the databases in the configuration are not operating as specified by the user. To obtain more information, use the DGMGRL <code dir="ltr">SHOW DATABASE &lt;db-unique-name&gt;</code> command or the Enterprise Manager display to locate each database and examine its status to reveal the source of the problem.</p>
</li>
<li>
<p><a id="sthref249"></a><a id="sthref250"></a>Error</p>
<p>One or more of the databases in the configuration failed or may no longer be operating as specified by the user. To obtain more information, use the DGMGRL <code dir="ltr">SHOW DATABASE &lt;db-unique-name&gt;</code> command or the Enterprise Manager display to locate each database and examine its status to reveal the source of the problem.</p>
</li>
<li>
<p>Unknown/Disabled</p>
<p>Broker management of the configuration is disabled and the broker is not monitoring the status of the databases in the configuration.</p>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1477">
<tr>
<td class="cellalignment1484">
<table class="cellalignment1482">
<tr>
<td class="cellalignment1481"><a href="install.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1481"><a href="dbresource.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1999, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1486">
<table class="cellalignment1480">
<tr>
<td class="cellalignment1481"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1481"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1481"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1481"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1481"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1481"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
