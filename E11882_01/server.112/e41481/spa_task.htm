<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Creating an Analysis Task</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 740" />
<meta name="dcterms.created" content="2014-06-16T16:24:48Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Real Application Testing User's Guide" />
<meta name="dcterms.identifier" content="E41481-03" />
<meta name="dcterms.isVersionOf" content="RATUG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="spa_intro.htm" title="Previous" type="text/html" />
<link rel="Next" href="spa_pre_change.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e41481.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">7/23</span> <!-- End Header -->
<div id="RATUG175" class="chapter"><a id="BABGCABH"></a>
<h1 class="chapter"><span class="secnum">3</span> Creating an Analysis Task</h1>
<p>Once you have captured a SQL workload that you want to analyze into a SQL tuning set, you can run SQL Performance Analyzer to analyze the effects of a system change on SQL performance. To run SQL Performance Analyzer, you must first create a <a id="sthref26"></a>SQL Performance Analyzer task. A task is a container that encapsulates all of the data about a complete SQL Performance Analyzer analysis. A SQL Performance Analyzer analysis comprises of at least two SQL trials and a comparison. A SQL trial captures the execution performance of a SQL tuning set under specific environmental conditions and can be generated automatically using SQL Performance Analyzer by one of the following methods:</p>
<ul>
<li>
<p>Test executing SQL statements</p>
</li>
<li>
<p>Generating execution plans for SQL statements</p>
</li>
<li>
<p>Referring to execution statistics and plans captured in a SQL tuning set</p>
</li>
</ul>
<p>When creating a SQL Performance Analyzer task, you will need to select a <a id="sthref27"></a>SQL tuning set as its input source. The SQL tuning set will be used as the source for test executing or generating execution plans for SQL trials. Thus, performance differences between trials are caused by environmental differences. For more information, see <a href="spa_intro.htm#CHDGHFGI">"Creating a SQL Performance Analyzer Task"</a>.</p>
<p>This chapter described how to create a SQL Performance Analyzer task and contains the following topics:</p>
<ul>
<li>
<p><a href="#BABDBCDH">Creating an Analysis Task Using Enterprise Manager</a></p>
</li>
<li>
<p><a href="#BABIBFGG">Creating an Analysis Task Using APIs</a></p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
The primary interface for running SQL Performance Analyzer is Oracle Enterprise Manager. If for some reason Oracle Enterprise Manager is unavailable, you can run SQL Performance Analyzer using the <code>DBMS_SQLPA</code> PL/SQL package.</div>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Before running SQL Performance Analyzer, capture the SQL workload to be used in the performance analysis into a SQL tuning set on the production system, then transport it to the test system where the performance analysis will be performed, as described in <a href="spa_intro.htm#CHDFCBDC">"Capturing the SQL Workload"</a>.</div>
<a id="BABDBCDH"></a>
<div id="RATUG176" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">3.1</span> Creating an Analysis Task Using Enterprise Manager</h2>
<p>There are several workflows available in Oracle Enterprise Manager for creating a <a id="sthref28"></a>SQL Performance Analyzer task.</p>
<p class="subhead2"><a id="RATUG315"></a>To create an analysis task using Enterprise Manager:</p>
<ol>
<li>
<p>On the Software and Support page, under Real Application Testing, click <span class="bold">SQL Performance Analyzer</span>.</p>
<p>The SQL Performance Analyzer page appears.</p>
<img width="838" height="351" src="img/spa.gif" alt="Description of spa.gif follows" /><br />
<a id="sthref29" href="img_text/spa.htm">Description of the illustration spa.gif</a><br />
<br /></li>
<li>
<p>Under SQL Performance Analyzer Workflows, select the workflow for creating the desired type of analysis task:</p>
<ul>
<li>
<p>Upgrade from 9<span class="italic">i</span> or 10.1</p>
<p>Use the upgrade from 9<span class="italic">i</span> or 10.1 workflow to test a database upgrade from Oracle9<span class="italic">i</span> Database or Oracle Database 10<span class="italic">g</span> Release 1 to Oracle Database 10<span class="italic">g</span> Release 2 and newer releases, as described in <a href="spa_upgrade.htm#CIAIFDIJ">"Upgrading from Oracle9<span class="italic">i</span> Database and Oracle Database 10<span class="italic">g</span> Release 1"</a>.</p>
</li>
<li>
<p>Upgrade from 10.2 or 11<span class="italic">g</span></p>
<p>Use the upgrade from 10.2 or 11<span class="italic">g</span> workflow to test a database upgrade from Oracle Database 10<span class="italic">g</span> Release 2 or Oracle Database 11<span class="italic">g</span> to a later release, as described in <a href="spa_upgrade.htm#CIAJDJBD">"Upgrading from Oracle Database 10<span class="italic">g</span> Release 2 and Newer Releases"</a>.</p>
</li>
<li>
<p>Parameter Change</p>
<p>Use the parameter change workflow to determine how a database initialization parameter change will affect SQL performance, as described in <a href="#BABDCCDC">"Using the Parameter Change Workflow"</a>.</p>
</li>
<li>
<p>Optimizer Statistics</p>
<p>Use the optimizer statistics workflow to analyze how changes to optimizer statistics will affect SQL performance, as described in <a href="#CHDEGEAH">"Using the Optimizer Statistics Workflow"</a>.</p>
</li>
<li>
<p>Exadata Simulation</p>
<p>Use the Exadata simulation workflow to simulate how using Oracle Exadata will affect SQL performance, as described in <a href="#CIHICAIJ">"Using the Exadata Simulation Workflow"</a>.</p>
</li>
<li>
<p>Guided workflow</p>
<p>Use the guided workflow to compare SQL performance for all other types of system changes, as described in <a href="#BABJDGFH">"Using the Guided Workflow"</a>.</p>
</li>
</ul>
</li>
</ol>
<a id="BABDCCDC"></a>
<div id="RATUG177" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.1.1</span> Using the Parameter Change Workflow</h3>
<p><a id="sthref30"></a>The parameter change workflow enables you to test the performance effect on a SQL workload when you change the value of a single environment initialization parameter. For example, you can compare SQL performance by setting the <code>OPTIMIZER_FEATURES_ENABLE</code> initialization parameter set to 10.2.0.4 and 11.2.0.1.</p>
<p>After you select a SQL tuning set and a comparison metric, SQL Performance Analyzer creates a task and performs a trial with the initialization parameter set to the original value. SQL Performance Analyzer then performs a second trial with the parameter set to the changed value by issuing an <code>ALTER SESSION</code> statement. The impact of the change is thus contained locally to the testing session. Any regression or change in performance is reported in a system-generated SQL Performance Analyzer report.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To create an analysis task for other types of system changes, use the guided workflow instead, as described in <a href="#BABJDGFH">"Using the Guided Workflow"</a>.</div>
<p class="subhead2"><a id="RATUG274"></a>To use the SQL Performance Analyzer parameter change workflow:</p>
<ol>
<li>
<p>On the SQL Performance Analyzer page, under SQL Performance Analyzer Workflows, click <span class="bold">Parameter Change</span>.</p>
<p>The Parameter Change page appears.</p>
<img width="511" height="667" src="img/spa_param_change.gif" alt="Description of spa_param_change.gif follows" /><br />
<a id="sthref31" href="img_text/spa_param_change.htm">Description of the illustration spa_param_change.gif</a><br />
<br /></li>
<li>
<p>In the Task Name field, enter the name of the task.</p>
</li>
<li>
<p>In the SQL Tuning Set field, enter the name of the SQL tuning set that contains the SQL workload to be analyzed.</p>
<p>Alternatively, click the search icon to search for a SQL tuning set using the Search and Select: SQL Tuning Set window.</p>
<p>The selected SQL tuning set now appears in the SQL Tuning Set field.</p>
</li>
<li>
<p>In the Description field, optionally enter a description of the task.</p>
</li>
<li id="CACBGAAI">
<p>In the Creation Method list, determine how the SQL trial is created and what contents are generated by performing one of the following actions:</p>
<ul>
<li>
<p>Select <span class="bold">Execute SQLs</span>.</p>
<p>The SQL trial generates both execution plans and statistics for each SQL statement in the SQL tuning set by actually running the SQL statements.</p>
</li>
<li>
<p>Select <span class="bold">Generate Plans</span>.</p>
<p>The SQL trial invokes the optimizer to create execution plans only without actually running the SQL statements.</p>
</li>
</ul>
</li>
<li id="CFHBFIJH">
<p>In the Per-SQL Time Limit list, determine the time limit for SQL execution during the trial by performing one of the following actions:</p>
<ul>
<li>
<p>Select <span class="bold">5 minutes</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set up to 5 minutes and gather performance data.</p>
</li>
<li>
<p>Select <span class="bold">Unlimited</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set to completion and gather performance data. Collecting execution statistics provides greater accuracy in the performance analysis but takes a longer time. Using this setting is not recommended because the task may be stalled by one SQL statement for a prolonged time period.</p>
</li>
<li>
<p>Select <span class="bold">Customize</span> and enter the specified number of seconds, minutes, or hours.</p>
</li>
</ul>
</li>
<li>
<p>In the Parameter Change section, complete the following steps:</p>
<ol>
<li>
<p>In the Parameter Name field, enter the name of the initialization parameter whose value you want to modify, or click the Search icon to select an initialization parameter using the Search and Select: Initialization Parameters window.</p>
</li>
<li>
<p>In the Base Value field, enter the current value of the initialization parameter.</p>
</li>
<li>
<p>In the Changed Value field, enter the new value of the initialization parameter.</p>
</li>
</ol>
</li>
<li>
<p>In the Comparison Metric list, select the comparison metric to use for the analysis:</p>
<ul>
<li>
<p>If you selected <span class="bold">Generate Plans</span> in Step <a href="#CACBGAAI">5</a>, then select <span class="bold">Optimizer Cost</span>.</p>
</li>
<li>
<p>If you selected <span class="bold">Execute SQLs</span> in Step <a href="#CACBGAAI">5</a>, then select one of the following options:</p>
<ul>
<li>
<p><span class="bold">Elapsed Time</span></p>
</li>
<li>
<p><span class="bold">CPU Time</span></p>
</li>
<li>
<p><span class="bold">User I/O Time</span></p>
</li>
<li>
<p><span class="bold">Buffer Gets</span></p>
</li>
<li>
<p><span class="bold">Physical I/O</span></p>
</li>
<li>
<p><span class="bold">Optimizer Cost</span></p>
</li>
<li>
<p><span class="bold">I/O Interconnect Bytes</span></p>
</li>
</ul>
</li>
</ul>
<p>To perform the comparison analysis by using more than one comparison metric, perform separate comparison analyses by repeating this procedure using different metrics.</p>
</li>
<li>
<p>In the Schedule section:</p>
<ol>
<li>
<p>In the Time Zone list, select your time zone code.</p>
</li>
<li>
<p>Select <span class="bold">Immediately</span> to start the task now, or <span class="bold">Later</span> to schedule the task to start at a time specified using the Date and Time fields.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Submit</span>.</p>
<p>The SQL Performance Analyzer page appears.</p>
<p>In the SQL Performance Analyzer Tasks section, the status of this task is displayed. To refresh the status icon, click <span class="bold">Refresh</span>. After the task completes, the Status field changes to Completed.</p>
<img width="745" height="120" src="img/spa_tasks_param_change.gif" alt="Description of spa_tasks_param_change.gif follows" /><br />
<a id="sthref32" href="img_text/spa_tasks_param_change.htm">Description of the illustration spa_tasks_param_change.gif</a><br />
<br /></li>
<li>
<p>In the SQL Performance Analyzer Tasks section, select the task and click the link in the Name column.</p>
<p>The SQL Performance Analyzer Task page appears.</p>
<img width="764" height="420" src="img/spa_task_param_change.gif" alt="Description of spa_task_param_change.gif follows" /><br />
<a id="sthref33" href="img_text/spa_task_param_change.htm">Description of the illustration spa_task_param_change.gif</a><br />
<br />
<p>This page contains the following sections:</p>
<ul>
<li>
<p>SQL Tuning Set</p>
<p>This section summarizes information about the SQL tuning set, including its name, owner, description, and the number of SQL statements it contains.</p>
</li>
<li>
<p>SQL Trials</p>
<p>This section includes a table that lists the SQL trials used in the SQL Performance Analyzer task.</p>
</li>
<li>
<p>SQL Trial Comparisons</p>
<p>This section contains a table that lists the results of the SQL trial comparisons</p>
</li>
</ul>
</li>
<li>
<p>Click the icon in the Comparison Report column.</p>
<p>The SQL Performance Analyzer Task Result page appears.</p>
</li>
<li>
<p>Review the results of the performance analysis, as described in <a href="spa_analyze.htm#CACHAFHE">"Reviewing the SQL Performance Analyzer Report Using Oracle Enterprise Manager"</a>.</p>
</li>
<li>
<p>In cases when regression are identified, click the icon in the SQL Tune Report column to view a SQL tuning report.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CHDEGEAH"></a>
<div id="RATUG316" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.1.2</span> Using the Optimizer Statistics Workflow</h3>
<p>The <a id="sthref34"></a>optimizer statistics workflow enables you to analyze the effects of optimizer statistics changes on the performance of a SQL workload.</p>
<p>SQL Performance Analyzer tests the effect of new optimizer statistics by enabling pending optimizer statistics in the testing session. The first SQL trial measures the baseline SQL tuning set performance; the second SQL trial uses the pending optimizer statistics. You can then run a comparison report for the two SQL trials.</p>
<p class="subhead2"><a id="RATUG317"></a>To use the optimizer statistics workflow:</p>
<ol>
<li>
<p>On the SQL Performance Analyzer page, under SQL Performance Analyzer Workflows, click <span class="bold">Optimizer Statistics</span>.</p>
<p>The Optimizer Statistics page appears.</p>
<img width="507" height="520" src="img/spa_optimizer_stats.gif" alt="Description of spa_optimizer_stats.gif follows" /><br />
<a id="sthref35" href="img_text/spa_optimizer_stats.htm">Description of the illustration spa_optimizer_stats.gif</a><br />
<br /></li>
<li>
<p>In the Task Name field, enter the name of the task.</p>
</li>
<li>
<p>In the SQL Tuning Set field, enter the name of the SQL tuning set that contains the SQL workload to be analyzed.</p>
<p>Alternatively, click the search icon to search for a SQL tuning set using the Search and Select: SQL Tuning Set window.</p>
<p>The selected SQL tuning set now appears in the SQL Tuning Set field.</p>
</li>
<li>
<p>In the Description field, optionally enter a description of the task.</p>
</li>
<li>
<p>In the Creation Method list, determine how the SQL trial is created and what contents are generated by performing one of the following actions:</p>
<ul>
<li>
<p>Select <span class="bold">Execute SQLs</span>.</p>
<p>The SQL trial generates both execution plans and statistics for each SQL statement in the SQL tuning set by actually running the SQL statements.</p>
</li>
<li>
<p>Select <span class="bold">Generate Plans</span>.</p>
<p>The SQL trial invokes the optimizer to create execution plans only without actually running the SQL statements.</p>
</li>
</ul>
</li>
<li>
<p>In the Per-SQL Time Limit list, determine the time limit for SQL execution during the trial by performing one of the following actions:</p>
<ul>
<li>
<p>Select <span class="bold">5 minutes</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set up to 5 minutes and gather performance data.</p>
</li>
<li>
<p>Select <span class="bold">Unlimited</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set to completion and gather performance data. Collecting execution statistics provides greater accuracy in the performance analysis but takes a longer time. Using this setting is not recommended because the task may be stalled by one SQL statement for a prolonged time period.</p>
</li>
<li>
<p>Select <span class="bold">Customize</span> and enter the specified number of seconds, minutes, or hours.</p>
</li>
</ul>
</li>
<li>
<p>In the Comparison Metric list, select the comparison metric to use for the comparison analysis:</p>
<ul>
<li>
<p><span class="bold">Elapsed Time</span></p>
</li>
<li>
<p><span class="bold">CPU Time</span></p>
</li>
<li>
<p><span class="bold">User I/O Time</span></p>
</li>
<li>
<p><span class="bold">Buffer Gets</span></p>
</li>
<li>
<p><span class="bold">Physical I/O</span></p>
</li>
<li>
<p><span class="bold">Optimizer Cost</span></p>
</li>
<li>
<p><span class="bold">I/O Interconnect Bytes</span></p>
</li>
</ul>
<p>Optimizer Cost is the only comparison metric available if you chose to generate execution plans only in the SQL trials.</p>
<p>To perform the comparison analysis by using more than one comparison metric, perform separate comparison analyses by repeating this procedure with different metrics.</p>
</li>
<li>
<p>Ensure that pending optimizer statistics are collected, and select <span class="bold">Pending optimizer statistics collected</span>.</p>
</li>
<li>
<p>In the Schedule section:</p>
<ol>
<li>
<p>In the Time Zone list, select your time zone code.</p>
</li>
<li>
<p>Select <span class="bold">Immediately</span> to start the task now, or <span class="bold">Later</span> to schedule the task to start at a time specified using the Date and Time fields.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Submit</span>.</p>
<p>The SQL Performance Analyzer page appears.</p>
<p>In the SQL Performance Analyzer Tasks section, the status of this task is displayed. To refresh the status icon, click <span class="bold">Refresh</span>. After the task completes, the Status field changes to Completed.</p>
<img width="725" height="135" src="img/spa_tasks_optimizer.gif" alt="Description of spa_tasks_optimizer.gif follows" /><br />
<a id="sthref36" href="img_text/spa_tasks_optimizer.htm">Description of the illustration spa_tasks_optimizer.gif</a><br />
<br /></li>
<li>
<p>In the SQL Performance Analyzer Tasks section, select the task and click the link in the Name column.</p>
<p>The SQL Performance Analyzer Task page appears.</p>
<img width="782" height="418" src="img/spa_task_optimizer.gif" alt="Description of spa_task_optimizer.gif follows" /><br />
<a id="sthref37" href="img_text/spa_task_optimizer.htm">Description of the illustration spa_task_optimizer.gif</a><br />
<br />
<p>This page contains the following sections:</p>
<ul>
<li>
<p>SQL Tuning Set</p>
<p>This section summarizes information about the SQL tuning set, including its name, owner, description, and the number of SQL statements it contains.</p>
</li>
<li>
<p>SQL Trials</p>
<p>This section includes a table that lists the SQL trials used in the SQL Performance Analyzer task.</p>
</li>
<li>
<p>SQL Trial Comparisons</p>
<p>This section contains a table that lists the results of the SQL trial comparisons</p>
</li>
</ul>
</li>
<li>
<p>Click the icon in the Comparison Report column.</p>
<p>The SQL Performance Analyzer Task Result page appears.</p>
</li>
<li>
<p>Review the results of the performance analysis, as described in <a href="spa_analyze.htm#CACHAFHE">"Reviewing the SQL Performance Analyzer Report Using Oracle Enterprise Manager"</a>.</p>
<p>Any regressions found in performance can be fixed using SQL plan baselines and the SQL Tuning Advisor. If the pending optimizer statistics produce satisfactory performance, you can publish for use.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="CIHICAIJ"></a>
<div id="RATUG293" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.1.3</span> Using the Exadata Simulation Workflow</h3>
<p><a id="sthref38"></a>The Exadata simulation workflow enables you to simulate the effects of an Exadata Storage Server installation on the performance of a SQL workload.</p>
<p>Oracle Exadata provides extremely large I/O bandwidth coupled with a capability to offload SQL processing from the database to storage. This allows Oracle Database to significantly reduce the volume of data sent through the I/O interconnect, while at the same time offloading CPU resources to the Exadata storage cells.</p>
<p>SQL Performance Analyzer can analyze the effectiveness of Exadata SQL offload processing by simulating an Exadata Storage Server installation and measuring the reduction in I/O interconnect usage for the SQL workload.</p>
<p>Running the Exadata simulation does not require any hardware or configuration changes to your system. After you select a SQL tuning set, SQL Performance Analyzer creates a task and performs an initial trial with the Exadata Storage Server simulation disabled. SQL Performance Analyzer then performs a second trial with the Exadata Storage Server simulation enabled. SQL Performance Analyzer then compares the two trials using the I/O Interconnect Bytes comparison metric and generates a SQL Performance Analyzer report, which estimates the amount of data that would not need to be sent from the Exadata storage cells to the database if Oracle Exadata is being used. In both SQL trials, the SQL statements are executed to completion and I/O interconnect bytes measurements are taken as the actual and simulated Exadata values for the first and second trials, respectively. The measured change in I/O interconnect bytes provides a good estimate of how much filtering can be performed in the Exadata storage cells and, in turn, the amount of CPU that normally would be used to process this data, but now can be offloaded from the database.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Using the Exadata simulation will not result in any plan changes. Execution plans do not change in an Exadata Storage Server installation because the simulation focuses on measuring the improvement in I/O interconnect usage. Moreover, I/O interconnect bytes will not increase, except when data compression is used (see next note), because Oracle Exadata will only decrease the amount of data sent to the database.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
Because I/O interconnect bytes is the only metric used to measure the performance change impact of using an Exadata Storage Server installation, it will not work properly if Oracle Exadata is used with data compression. Since Exadata storage cells also decompress data, the I/O interconnect bytes with Oracle Exadata (or the second SQL trial) of a SQL statement may be greater than the I/O interconnect bytes without Oracle Exadata (or the first SQL trial) where the data is compressed. This comparison will be misleading because the SQL statement will be reported as a regression; when in fact, it is not.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
The Exadata simulation workflow is used to simulate an Exadata Storage Server installation on non-Exadata hardware. To test changes on Exadata hardware, use the standard SQL Performance Analyzer workflows.</div>
<div class="infobox-note">
<p class="notep1">Note:</p>
The Exadata simulation is supported for DSS and data warehouse workloads only.</div>
<p class="subhead2"><a id="RATUG294"></a>To use the SQL Performance Analyzer Exadata simulation workflow:</p>
<ol>
<li>
<p>On the SQL Performance Analyzer page, under SQL Performance Analyzer Workflows, click <span class="bold">Exadata Simulation</span>.</p>
<p>The Exadata Simulation page appears.</p>
<img width="510" height="508" src="img/spa_exadata_sim.gif" alt="Description of spa_exadata_sim.gif follows" /><br />
<a id="sthref39" href="img_text/spa_exadata_sim.htm">Description of the illustration spa_exadata_sim.gif</a><br />
<br /></li>
<li>
<p>In the Task Name field, enter the name of the task.</p>
</li>
<li>
<p>In the SQL Tuning Set field, enter the name of the SQL tuning set that contains the SQL workload to be analyzed.</p>
<p>Alternatively, click the search icon to search for a SQL tuning set using the Search and Select: SQL Tuning Set window.</p>
<p>The selected SQL tuning set now appears in the SQL Tuning Set field.</p>
</li>
<li>
<p>In the Description field, optionally enter a description of the task.</p>
</li>
<li>
<p>In the Per-SQL Time Limit list, determine the time limit for SQL execution during the trial by performing one of the following actions:</p>
<ul>
<li>
<p>Select <span class="bold">5 minutes</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set up to 5 minutes and gather performance data.</p>
</li>
<li>
<p>Select <span class="bold">Unlimited</span>.</p>
<p>The execution will run each SQL statement in the SQL tuning set to completion and gather performance data. Collecting execution statistics provides greater accuracy in the performance analysis but takes a longer time. Using this setting is not recommended because the task may be stalled by one SQL statement for a prolonged time period.</p>
</li>
<li>
<p>Select <span class="bold">Customize</span> and enter the specified number of seconds, minutes, or hours.</p>
</li>
</ul>
</li>
<li>
<p>In the Schedule section:</p>
<ol>
<li>
<p>In the Time Zone list, select your time zone code.</p>
</li>
<li>
<p>Select <span class="bold">Immediately</span> to start the task now, or <span class="bold">Later</span> to schedule the task to start at a time specified using the Date and Time fields.</p>
</li>
</ol>
</li>
<li>
<p>Click <span class="bold">Submit</span>.</p>
<p>The SQL Performance Analyzer page appears.</p>
<p>In the SQL Performance Analyzer Tasks section, the status of this task is displayed. To refresh the status icon, click <span class="bold">Refresh</span>. After the task completes, the Status field changes to Completed.</p>
<img width="760" height="119" src="img/spa_tasks_exadata.gif" alt="Description of spa_tasks_exadata.gif follows" /><br />
<a id="sthref40" href="img_text/spa_tasks_exadata.htm">Description of the illustration spa_tasks_exadata.gif</a><br />
<br /></li>
<li>
<p>In the SQL Performance Analyzer Tasks section, select the task and click the link in the Name column.</p>
<p>The SQL Performance Analyzer Task page appears.</p>
<img width="780" height="360" src="img/spa_task_exadata_sim.gif" alt="Description of spa_task_exadata_sim.gif follows" /><br />
<a id="sthref41" href="img_text/spa_task_exadata_sim.htm">Description of the illustration spa_task_exadata_sim.gif</a><br />
<br />
<p>This page contains the following sections:</p>
<ul>
<li>
<p>SQL Tuning Set</p>
<p>This section summarizes information about the SQL tuning set, including its name, owner, description, and the number of SQL statements it contains.</p>
</li>
<li>
<p>SQL Trials</p>
<p>This section includes a table that lists the SQL trials used in the SQL Performance Analyzer task.</p>
</li>
<li>
<p>SQL Trial Comparisons</p>
<p>This section contains a table that lists the results of the SQL trial comparisons</p>
</li>
</ul>
</li>
<li>
<p>Click the icon in the Comparison Report column.</p>
<p>The SQL Performance Analyzer Task Result page appears.</p>
</li>
<li>
<p>Review the results of the performance analysis, as described in <a href="spa_analyze.htm#CACHAFHE">"Reviewing the SQL Performance Analyzer Report Using Oracle Enterprise Manager"</a>.</p>
<p>Any SQL performance improvement with the Exadata simulation between the first and second trials is captured in the report. In general, you can expect a greater impact if the SQL workload contains queries that scan a large number of rows or a small subset of table columns. Conversely, a SQL workload that queries indexed tables or tables with fewer rows will result in a lesser impact from the Exadata simulation.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABJDGFH"></a>
<div id="RATUG178" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.1.4</span> Using the Guided Workflow</h3>
<p><a id="sthref42"></a>The guided workflow enables you to test the performance effect of any types of system changes on a SQL workload, as listed in <a href="rat_intro.htm#CHDDDHBF">"SQL Performance Analyzer"</a>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
To create an analysis task to test database initialization parameter changes, use the simplified parameter change workflow instead, as described in <a href="#BABDCCDC">"Using the Parameter Change Workflow"</a>.</div>
<p class="subhead2"><a id="RATUG275"></a>To use the SQL Performance Analyzer task guided workflow:</p>
<ol>
<li>
<p>On the SQL Performance Analyzer page, under SQL Performance Analyzer Workflows, click <span class="bold">Guided Workflow</span>.</p>
<p>The Guided Workflow page appears.</p>
<p>The guided workflow enables you to test the performance effect on a SQL workload when you perform any type of system changes, as described in <a href="rat_intro.htm#CHDDDHBF">"SQL Performance Analyzer"</a>.</p>
<p>This page lists the required steps in the SQL Performance Analyzer task in sequential order. Each step must be completed in the order displayed before the next step can begin.</p>
<img width="764" height="263" src="img/spa_guided_workflow.gif" alt="Description of spa_guided_workflow.gif follows" /><br />
<a id="sthref43" href="img_text/spa_guided_workflow.htm">Description of the illustration spa_guided_workflow.gif</a><br />
<br /></li>
<li>
<p>On the Guided Workflow page, click the <span class="bold">Execute</span> icon for the Step 1: Create SQL Performance Analyzer Task based on SQL Tuning Set.</p>
<p>The Create SQL Performance Analyzer Task page appears.</p>
<img width="762" height="315" src="img/spa_create_task.gif" alt="Description of spa_create_task.gif follows" /><br />
<a id="sthref44" href="img_text/spa_create_task.htm">Description of the illustration spa_create_task.gif</a><br />
<br /></li>
<li>
<p>In the Name field, enter the name of the task.</p>
</li>
<li>
<p>In the Description field, optionally enter a description of the task.</p>
</li>
<li>
<p>Under SQL Tuning Set, in the Name field, enter the name the SQL tuning set that contains the SQL workload to be analyzed.</p>
<p>Alternatively, click the search icon to select a SQL tuning set from the Search and Select: SQL Tuning Set window.</p>
</li>
<li>
<p>Click <span class="bold">Create</span>.</p>
<p>The Guided Workflow page appears.</p>
<p>The Status icon of this step has changed to a check mark and the <span class="bold">Execute</span> icon for the next step is now enabled.</p>
</li>
<li>
<p>Once the analysis task is created, you can build the pre-change performance data by executing the SQL statements stored in the SQL tuning set, as described in <a href="spa_pre_change.htm#CACFCGDC">Chapter 4, "Creating a Pre-Change SQL Trial"</a>.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABIBFGG"></a>
<div id="RATUG179" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1"><span class="secnum">3.2</span> Creating an Analysis Task Using APIs</h2>
<p>This section describes how to create a <a id="sthref45"></a>SQL Performance Analyzer task by using the <code>DBMS_SQLPA.CREATE_ANALYSIS_TASK</code> function. A task is a database container for SQL Performance Analyzer execution inputs and results.</p>
<div class="infoboxnotealso">
<p class="notep1">Tip:</p>
Before proceeding, capture the SQL workload to be used in the performance analysis into a SQL tuning set on the production system, then transport it to the test system where the performance analysis will be performed, as described in <a href="spa_intro.htm#CHDFCBDC">"Capturing the SQL Workload"</a>.</div>
<p>Call the <a id="sthref46"></a><code>CREATE_ANALYSIS_TASK</code> function to prepare the analysis of a SQL tuning set using the following parameters:</p>
<ul>
<li>
<p>Set <code>task_name</code> to specify an optional name for the SQL Performance Analyzer task.</p>
</li>
<li>
<p>Set <code>sqlset_name</code> to the name of the SQL tuning set.</p>
</li>
<li>
<p>Set <code>sqlset_owner</code> to the owner of the SQL tuning set. The default is the current schema owner.</p>
</li>
<li>
<p>Set <code>basic_filter</code> to the SQL predicate used to filter the SQL from the SQL tuning set.</p>
</li>
<li>
<p>Set <code>order_by</code> to specify the order in which the SQL statements will be executed.</p>
<p>You can use this parameter to ensure that the more important SQL statements will be processed and not skipped if the time limit is reached.</p>
</li>
<li>
<p>Set <code>top_sql</code> to consider only the top number of SQL statements after filtering and ranking.</p>
</li>
</ul>
<p>The following example illustrates a function call:</p>
<pre>
VARIABLE t_name VARCHAR2(100);
EXEC :t_name := DBMS_SQLPA.CREATE_ANALYSIS_TASK(sqlset_name =&gt; 'my_sts', -
       task_name =&gt; 'my_spa_task');
</pre>
<p>Once the analysis task is created, you can build the pre-change performance data by executing the SQL statements stored in the SQL tuning set, as described in <a href="spa_pre_change.htm#CACFCGDC">Chapter 4, "Creating a Pre-Change SQL Trial"</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ARPLS229" href="../../appdev.112/e40758/d_sqlpa.htm#ARPLS229"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> to learn more about the <code>DBMS_SQLPA.CREATE_ANALYSIS_TASK</code> function</p>
</li>
</ul>
</div>
<a id="CIHIFFCH"></a>
<div id="RATUG318" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">3.2.1</span> Running the Exadata Simulation Using APIs</h3>
<p>This section describes how to run the Oracle Exadata simulation using APIs. For information about how SQL Performance Analyzer simulates the effects of an Exadata Storage Server installation on the performance of a SQL workload, see <a href="#CIHICAIJ">"Using the Exadata Simulation Workflow"</a>.</p>
<p>To enable Exadata simulation for an analysis task, call the <a id="sthref47"></a><code>SET_ANALYSIS_TASK_PARAMETER</code> procedure before creating the post-change SQL trial, as shown in the following example:</p>
<pre>
EXEC DBMS_SQLPA.SET_ANALYSIS_TASK_PARAMETER(task_name =&gt; 'my_spa_task', -
       parameter =&gt; 'CELL_SIMULATION_ENABLED', - 
       value =&gt; 'TRUE');
</pre>
<p>This will enable Exadata simulation when you create the post-change SQL trial, which can then be compared to the pre-change SQL trial that was created with Exadata simulation disabled.</p>
<p>Alternatively, you can run the Exadata simulation using the <code>tcellsim.sql</code> script:</p>
<ol>
<li>
<p>At the SQL prompt, enter:</p>
<pre>
@$ORACLE_HOME/rdbms/admin/tcellsim.sql
</pre></li>
<li>
<p>Enter the name and owner of the SQL tuning set to use:</p>
<pre>
Enter value for sts_name: MY_STS
Enter value for sts_owner: IMMCHAN
</pre>
<p>The script then runs the following four steps automatically:</p>
<ul>
<li>
<p>Creates a SQL Performance Analyzer task</p>
</li>
<li>
<p>Test executes SQL statements with Exadata simulation disabled</p>
</li>
<li>
<p>Test executes SQL statements with Exadata simulation enabled</p>
</li>
<li>
<p>Compares performance and generates analysis report</p>
</li>
</ul>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1798">
<tr>
<td class="cellalignment1805">
<table class="cellalignment1803">
<tr>
<td class="cellalignment1802"><a href="spa_intro.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1802"><a href="spa_pre_change.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1807">
<table class="cellalignment1801">
<tr>
<td class="cellalignment1802"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1802"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1802"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1802"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1802"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1802"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
