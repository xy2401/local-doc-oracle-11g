<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Configuring a Database for Performance</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023" />
<meta name="dcterms.created" content="2014-06-30T4:25:5Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Performance Tuning Guide" />
<meta name="dcterms.identifier" content="E41573-04" />
<meta name="dcterms.isVersionOf" content="PFGRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2000, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="part3.htm" title="Previous" type="text/html" />
<link rel="Next" href="autostat.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e41573.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">11/31</span> <!-- End Header -->
<div id="PFGRF013" class="chapter"><a id="g27214"></a> <a id="i16367"></a>
<h1 class="chapter"><span class="secnum">4</span> Configuring a Database for Performance</h1>
<p>This chapter contains an overview of the Oracle methodology for configuring a database for performance. Although performance modifications can be made to Oracle Database on an ongoing basis, significant benefits can be gained by proper initial configuration of the database.</p>
<p>This chapter contains the following sections:</p>
<ul>
<li>
<p><a href="#i20151">Performance Considerations for Initial Instance Configuration</a></p>
</li>
<li>
<p><a href="#i10478">Creating and Maintaining Tables for Optimal Performance</a></p>
</li>
<li>
<p><a href="#i22941">Performance Considerations for Shared Servers</a></p>
</li>
</ul>
<a id="i20151"></a>
<div id="PFGRF94142" class="sect1">
<h2 class="sect1"><span class="secnum">4.1</span> Performance Considerations for Initial Instance Configuration</h2>
<p><a id="sthref170"></a>This section discusses some initial database instance configuration options that have important performance impacts.</p>
<p>If you use the Database Configuration Assistant (DBCA) to create a database, then the supplied seed database includes the necessary basic initialization parameters and meets the performance recommendations that are discussed in this chapter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN12479" href="../../server.112/e25494/create.htm#ADMIN12479"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn how to create a database with the Database Configuration Assistant</p>
</li>
<li>
<p><a class="olink ADMIN002" href="../../server.112/e25494/create.htm#ADMIN002"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn how to create a database with a SQL statement</p>
</li>
</ul>
</div>
<div id="PFGRF94143" class="sect2"><a id="sthref171"></a>
<h3 class="sect2"><span class="secnum">4.1.1</span> Initialization Parameters</h3>
<p><a id="sthref172"></a>A running Oracle database instance is configured using initialization parameters, which are set in the initialization parameter file. These parameters influence the behavior of the running instance, including influencing performance. In general, a very simple initialization file with few relevant settings covers most situations, and the initialization file should not be the first place you expect to do performance tuning, except for the few parameters shown in <a href="#g23964">Table 4-2</a>.</p>
<p><a href="#g23930">Table 4-1</a> describes the parameters necessary in a minimal initialization file. Although these parameters are necessary, they have no performance impact.</p>
<div id="PFGRF94144" class="tblformal">
<p class="titleintable"><a id="sthref173"></a><a id="g23930"></a>Table 4-1 Necessary Initialization Parameters Without Performance Impact</p>
<table class="cellalignment1686" title="Necessary Initialization Parameters Without Performance Impact" summary="This table describes the initialization parameters necessary in a minimal intialization parameter file." dir="ltr">
<thead>
<tr class="cellalignment1680">
<th class="cellalignment1687" id="r1c1-t3">Parameter</th>
<th class="cellalignment1687" id="r1c2-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r2c1-t3" headers="r1c1-t3">
<p><code>DB_NAME</code><a id="sthref174"></a><a id="sthref175"></a></p>
</td>
<td class="cellalignment1688" headers="r2c1-t3 r1c2-t3">
<p>Name of the database. This should match the <code>ORACLE_SID</code> environment variable.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r3c1-t3" headers="r1c1-t3">
<p><code>DB_DOMAIN</code><a id="sthref176"></a><a id="sthref177"></a></p>
</td>
<td class="cellalignment1688" headers="r3c1-t3 r1c2-t3">
<p>Location of the database in Internet dot notation.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r4c1-t3" headers="r1c1-t3">
<p><code>OPEN_CURSORS</code><a id="sthref178"></a><a id="sthref179"></a></p>
</td>
<td class="cellalignment1688" headers="r4c1-t3 r1c2-t3">
<p>Limit on the maximum number of cursors (active SQL statements) for each session. The setting is application-dependent; 500 is recommended.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r5c1-t3" headers="r1c1-t3">
<p><code>CONTROL_FILES</code><a id="sthref180"></a><a id="sthref181"></a></p>
</td>
<td class="cellalignment1688" headers="r5c1-t3 r1c2-t3">
<p>Set to contain at least two files on different disk drives to prevent failures from control file loss.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r6c1-t3" headers="r1c1-t3">
<p><code>DB_FILES</code></p>
</td>
<td class="cellalignment1688" headers="r6c1-t3 r1c2-t3">
<p>Set to the maximum number of files that can assigned to the database.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN002" href="../../server.112/e25494/create.htm#ADMIN002"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn more about these initialization parameters</div>
<p><a href="#g23964">Table 4-2</a> includes the most important parameters to set with performance implications:</p>
<div id="PFGRF94145" class="tblformal">
<p class="titleintable"><a id="sthref182"></a><a id="g23964"></a>Table 4-2 Important Initialization Parameters With Performance Impact</p>
<table class="cellalignment1686" title="Important Initialization Parameters With Performance Impact" summary="This table describes important initialization parameters with performance impact." dir="ltr">
<thead>
<tr class="cellalignment1680">
<th class="cellalignment1687" id="r1c1-t5">Parameter</th>
<th class="cellalignment1687" id="r1c2-t5">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r2c1-t5" headers="r1c1-t5">
<p><code><a id="sthref183"></a>COMPATIBLE</code></p>
</td>
<td class="cellalignment1688" headers="r2c1-t5 r1c2-t5">
<p>Specifies the release with which the Oracle database must maintain compatibility. It lets you take advantage of the maintenance improvements of a new release immediately in your production systems without testing the new functionality in your environment. If your application was designed for a specific release of Oracle Database, and you are actually installing a later release, then you might want to set this parameter to the version of the previous release.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r3c1-t5" headers="r1c1-t5">
<p><code>DB_BLOCK_SIZE<a id="sthref184"></a><a id="sthref185"></a></code></p>
</td>
<td class="cellalignment1688" headers="r3c1-t5 r1c2-t5">
<p>Sets the size of the Oracle database blocks stored in the database files and cached in the SGA. The range of values depends on the operating system, but it is typically 8192 for transaction processing systems and higher values for database warehouse systems.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r4c1-t5" headers="r1c1-t5">
<p><code><a id="sthref186"></a>SGA_TARGET</code></p>
</td>
<td class="cellalignment1688" headers="r4c1-t5 r1c2-t5">
<p>Specifies the total size of all SGA components. If <code>SGA_TARGET</code> is specified, then the buffer cache (<code>DB_CACHE_SIZE</code>), Java pool (<code>JAVA_POOL_SIZE</code>), large pool (<code>LARGE_POOL_SIZE</code>), and shared pool (<code>SHARED_POOL_SIZE</code>) memory pools are automatically sized. See <a href="memory.htm#i58728">"Automatic Shared Memory Management"</a>.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r5c1-t5" headers="r1c1-t5">
<p><code>PGA_AGGREGATE_TARGET</code><a id="sthref187"></a></p>
</td>
<td class="cellalignment1688" headers="r5c1-t5 r1c2-t5">
<p>Specifies the target aggregate PGA memory available to all server processes attached to the instance. See <a href="memory.htm#i49320">"PGA Memory Management"</a>.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r6c1-t5" headers="r1c1-t5">
<p><code>PROCESSES<a id="sthref188"></a><a id="sthref189"></a></code></p>
</td>
<td class="cellalignment1688" headers="r6c1-t5 r1c2-t5">
<p>Sets the maximum number of processes that can be started by that instance. This is the most important primary parameter to set, because many other parameter values are deduced from this.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r7c1-t5" headers="r1c1-t5">
<p><code>SESSIONS<a id="sthref190"></a><a id="sthref191"></a></code></p>
</td>
<td class="cellalignment1688" headers="r7c1-t5 r1c2-t5">
<p>This is set by default from the value of processes. However, if you are using the shared server, then the deduced value is likely to be insufficient.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r8c1-t5" headers="r1c1-t5">
<p><code><a id="sthref192"></a>UNDO_MANAGEMENT</code></p>
</td>
<td class="cellalignment1688" headers="r8c1-t5 r1c2-t5">
<p>Specifies the undo space management mode used by the database. The default is <code>AUTO</code>. If unspecified, the database uses <code>AUTO</code>.</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r9c1-t5" headers="r1c1-t5">
<p><code><a id="sthref193"></a>UNDO_TABLESPACE</code></p>
</td>
<td class="cellalignment1688" headers="r9c1-t5 r1c2-t5">
<p>Specifies the undo tablespace to be used when an instance starts.</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="memory.htm#g77696">Chapter 7, "Configuring and Using Memory"</a></p>
</li>
<li>
<p><a class="olink REFRN001" href="../../server.112/e40402/initparams_part.htm#REFRN001"><span class="italic">Oracle Database Reference</span></a> for information about initialization parameters</p>
</li>
<li>
<p><a class="olink STRMS147" href="../../server.112/e17069/strms_otmon.htm#STRMS147"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about the <code><a id="sthref194"></a><a id="sthref195"></a>STREAMS_POOL_SIZE</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<div id="PFGRF94146" class="sect2"><a id="sthref196"></a>
<h3 class="sect2"><span class="secnum">4.1.2</span> Configuring Undo Space</h3>
<p>The database uses undo space to store data used for read consistency, recovery, and rollback statements. This data exists in one or more undo tablespaces. If you use the Database Configuration Assistant (DBCA) to create a database, then the undo tablespace is created automatically. To manually create an undo tablespace, add the <code><a id="sthref197"></a>UNDO</code> <code>TABLESPACE</code> clause to the <code>CREATE</code> <code>DATABASE</code> statement.</p>
<p>To automate the management of undo data, Oracle Database uses <span class="bold"><a id="sthref198"></a>automatic undo management</span>, which transparently creates and manages undo segments.To enable <a id="sthref199"></a><a id="sthref200"></a>automatic undo management, set the <code><a id="sthref201"></a>UNDO_MANAGEMENT</code> initialization parameter to <code>AUTO</code> (the default setting). If unspecified, then the <code>UNDO_MANAGEMENT</code> initialization parameter uses the <code>AUTO</code> setting. Oracle strongly recommends using automatic undo management because it significantly simplifies database management and eliminates the need for any manual tuning of undo (rollback) segments. Manual undo management using rollback segments is supported for backward compatibility.</p>
<p>The <code>V$UND<a id="sthref202"></a>OSTAT</code> view contains statistics for monitoring and tuning undo space. Using this view, you can better estimate the amount of undo space required for the current workload. Oracle Database also uses this information to help tune undo usage. The <code>V$ROLLSTAT</code> view contains information about the behavior of the undo segments in the undo tablespace.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMQS" href="../e10897/toc.htm"><span class="italic">Oracle Database 2 Day DBA</span></a> and Oracle Enterprise Manager online help to learn about the Undo Management Advisor</p>
</li>
<li>
<p><a class="olink ADMIN013" href="../../server.112/e25494/undo.htm#ADMIN013"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about managing undo space using automatic undo management</p>
</li>
<li>
<p><a class="olink REFRN003" href="../../server.112/e40402/dynviews_part.htm#REFRN003"><span class="italic">Oracle Database Reference</span></a> to learn about the <code>V$ROLLSTAT</code> and <code>V$UNDOSTAT</code> views</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i19558"></a>
<div id="PFGRF94147" class="sect2">
<h3 class="sect2"><span class="secnum">4.1.3</span> Sizing Redo Log Files</h3>
<p><a id="sthref203"></a><a id="sthref204"></a><a id="sthref205"></a>The size of the redo log files can influence performance, because the behavior of the database writer and archiver processes depend on the redo log sizes. Generally, larger redo log files provide better performance. Undersized log files increase checkpoint activity and reduce performance.</p>
<p>Although the size of the redo log files does not affect LGWR performance, it can affect DBWR and checkpoint behavior. Checkpoint frequency is affected by several factors, including log file size and the setting of the <code>FAST_START_MTTR_TARGET</code> initialization parameter. If the <code>FAST_START_MTTR_TARGET</code> parameter is set to limit the instance recovery time, Oracle Database automatically tries to checkpoint as frequently as necessary. Under this condition, the size of the log files should be large enough to avoid additional checkpointing due to under sized log files. The optimal size can be obtained by querying the <code>OPTIMAL_LOGFILE_SIZE</code> column from the <code>V$INSTANCE_RECOVERY</code> view. You can also obtain sizing advice on the <span class="bold">Redo</span> <span class="bold">Log</span> <span class="bold">Groups</span> page of Oracle Enterprise Manager.</p>
<p>It may not always be possible to provide a specific size recommendation for redo log files, but redo log files in the range of 100 MB to a few gigabytes are considered reasonable. Size online redo log files according to the amount of redo your system generates. A rough guide is to switch log files at most once every 20 minutes.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN007" href="../../server.112/e25494/onlineredo.htm#ADMIN007"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about managing the online redo log</div>
</div>
<!-- class="sect2" -->
<a id="i19765"></a>
<div id="PFGRF94148" class="sect2">
<h3 class="sect2"><span class="secnum">4.1.4</span> Creating Subsequent Tablespaces<a id="sthref206"></a><a id="sthref207"></a></h3>
<p>If you use the Database Configuration Assistant (DBCA) to create a database, then the seed database automatically includes the necessary tablespaces. If you choose not to use DBCA, then you must create extra tablespaces after creating the database.</p>
<p>All databases should have several tablespaces in addition to the <code>SYSTEM</code> and <code>SYSAUX</code> tablespaces. These additional tablespaces include:</p>
<ul>
<li>
<p>A <a id="sthref208"></a><a id="sthref209"></a>temporary tablespace, which is used for operations such as sorting</p>
</li>
<li>
<p>An undo tablespace to contain information for read consistency, recovery, and undo statements</p>
</li>
<li>
<p>At least one tablespace for application use (in most cases, applications require several tablespaces)</p>
</li>
</ul>
<p>For extremely large tablespaces with many data files, you can run multiple <code>ALTER</code> <code>TABLESPACE</code> . . . <code>ADD</code> <code>DATAFILE</code> statements in parallel. During tablespace creation, the data files that make up the tablespace are initialized with special empty block images. Temporary files are not initialized.</p>
<p>Oracle Database does this to ensure that it can write all data files in their entirety, but this can obviously be a lengthy process if done serially. Therefore, run multiple <code>CREATE</code> <code>TABLESPACE</code> statements concurrently to speed up tablespace creation. For permanent tables, the choice between local and global extent management on tablespace creation can greatly affect performance. For any permanent tablespace that has moderate to large insert, modify, or delete operations compared to reads, choose local extent management.</p>
<div id="PFGRF94149" class="sect3"><a id="sthref210"></a>
<h4 class="sect3"><span class="secnum">4.1.4.1</span> Creating Permanent Tablespaces - Automatic Segment-Space Management</h4>
<p>For permanent tablespaces, Oracle recommends using <a id="sthref211"></a>automatic segment-space management. Such tablespaces, often referred to as bitmap tablespaces, are locally managed tablespaces with bitmap segment space management.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink CNCPT003" href="../../server.112/e40540/physical.htm#CNCPT003"><span class="italic">Oracle Database Concepts</span></a> for a discussion of free space management</p>
</li>
<li>
<p><a class="olink ADMIN011" href="../../server.112/e25494/tspaces.htm#ADMIN011"><span class="italic">Oracle Database Administrator's Guide</span></a> for more information on creating and using automatic segment-space management for tablespaces</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" -->
<a id="i19596"></a>
<div id="PFGRF94150" class="sect3">
<h4 class="sect3"><span class="secnum">4.1.4.2</span> Creating Temporary Tablespaces</h4>
<p><a id="sthref212"></a><a id="sthref213"></a><a id="sthref214"></a>Properly configuring the temporary tablespace helps optimize disk sort performance. Temporary tablespaces can be dictionary-managed or locally managed. Oracle recommends the use of locally managed temporary tablespaces with a <code>UNIFORM</code> extent size of 1 <code>MB</code>.</p>
<p>You should monitor temporary tablespace activity to check how many extents the database allocates for the temporary segment. If an application extensively uses temporary tables, as in a situation when many users are concurrently using temporary tables, then the extent size could be set smaller, such as 256K, because every usage requires at least one extent. The <code><a id="sthref215"></a>EXTENT</code> <code>MANAGEMENT</code> <code>LOCAL</code> clause is optional for temporary tablespaces because all temporary tablespaces are created with locally managed extents of a uniform size. The default for <code>SIZE</code> is <code>1M</code>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN011" href="../../server.112/e25494/tspaces.htm#ADMIN011"><span class="italic">Oracle Database Administrator's Guide</span></a> for more information on managing temporary tablespaces</p>
</li>
<li>
<p><a class="olink CNCPT003" href="../../server.112/e40540/physical.htm#CNCPT003"><span class="italic">Oracle Database Concepts</span></a> for more information on temporary tablespaces</p>
</li>
<li>
<p><a class="olink SQLRF01403" href="../../server.112/e41084/statements_7003.htm#SQLRF01403"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information on using the <code>CREATE</code> and <code>ALTER</code> <code>TABLESPACE</code> statements with the <code>TEMPORARY</code> clause</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i10478"></a>
<div id="PFGRF94151" class="sect1">
<h2 class="sect1"><span class="secnum">4.2</span> Creating and Maintaining Tables for Optimal Performance</h2>
<p><a id="sthref216"></a>When installing applications, an initial step is to create all necessary tables and indexes. When you create a segment, such as a table, the database allocates space for the data. If subsequent database operations cause the data volume to increase and exceed the space allocated, then Oracle Database extends the segment.</p>
<p>When creating tables and indexes, note the following:</p>
<ul>
<li>
<p>Specify automatic segment-space management for tablespaces</p>
<p>In this way Oracle Database automatically manages segment space for best performance.</p>
</li>
<li>
<p><a id="sthref217"></a>Set storage options carefully</p>
<p>Applications should carefully set storage options for the intended use of the table or index. This includes setting the value for <code>PC<a id="sthref218"></a>TFREE</code>. Note that using automatic segment-space management eliminates the necessity of specifying <code>PCTUSED</code>.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
Use of free lists is not recommended. To use automatic segment-space management, create locally managed tablespaces, with the segment space management clause set to <code>AUTO</code>.</div>
</li>
</ul>
<a id="i16118"></a>
<div id="PFGRF94152" class="sect2">
<h3 class="sect2"><span class="secnum">4.2.1</span> Table Compression</h3>
<p>You can store heap-organized tables in a compressed format that is transparent for any kind of application. Compressed data in a database block is self-contained, which means that all information needed to re-create the uncompressed data in a block is available within the block. A block is also compressed in the buffer cache. Table compression not only reduces the disk storage but also the memory usage, specifically the buffer cache requirements. Performance improvements are accomplished by reducing the amount of necessary I/O operations for accessing a table and by increasing the probability of buffer cache hits.</p>
<p>Oracle Database has an advanced compression option that enables you to boost the performance of any type of application workload&mdash;including data warehousing and OLTP applications&mdash;while reducing the disk storage that is required by the database. You can use the advanced compression feature for all types of data, including structured data, unstructured data, backup data, and network data.</p>
<div id="PFGRF94153" class="sect3"><a id="sthref219"></a>
<h4 class="sect3"><span class="secnum">4.2.1.1</span> Estimating the Compression factor</h4>
<p>Table compression works by eliminating column value repetitions within individual blocks. Duplicate values in all the rows and columns in a block are stored once at the beginning of the block, in what is called a symbol table for that block. All occurrences of such values are replaced with a short reference to the symbol table. The compression is higher in blocks that have more repeated values.</p>
<p>Before compressing large tables you should estimate the expected compression factor. The compression factor is defined as the number of blocks necessary to store the information in an uncompressed form divided by the number of blocks necessary for a compressed storage. The compression factor can be estimated by sampling a small number of representative data blocks of the table to be compressed and comparing the average number of records for each block for the uncompressed and compressed case. Experience shows that approximately 1000 data blocks provides a very accurate estimation of the compression factor. Note that the more blocks you are sampling, the more accurate the result become.</p>
</div>
<!-- class="sect3" -->
<div id="PFGRF94154" class="sect3"><a id="sthref220"></a>
<h4 class="sect3"><span class="secnum">4.2.1.2</span> Tuning to Achieve a Better Compression Ratio</h4>
<p>Oracle Database achieves a good compression factor in many cases with no special tuning. As a DBA or application developer, you can try to tune the compression factor by reorganizing the records when the compression takes place. Tuning can improve the compression factor slightly in some cases and substantially in other cases.</p>
<p>To improve the compression factor you must increase the likelihood of value repetitions within a data block. The achievable compression factor depends on the cardinality of a specific column or column pairs (representing the likelihood of column value repetitions) and on the average row length of those columns. Table compression not only compresses duplicate values of a single column but tries to use multi-column value pairs whenever possible. Without a detailed understanding of the data distribution it is very difficult to predict the most optimal order.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink DWHSG005" href="../../server.112/e25554/parpart.htm#DWHSG005"><span class="italic">Oracle Database Data Warehousing Guide</span></a> for information about table compression and partitions</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<div id="PFGRF94155" class="sect2"><a id="sthref221"></a>
<h3 class="sect2"><span class="secnum">4.2.2</span> Reclaiming Unused Space</h3>
<p>Over time, it is common for segment space to become fragmented or for a segment to acquire a lot of free space as the result of update and delete operations. The resulting sparsely populated objects can suffer performance degradation during queries and DML operations.</p>
<p>Oracle Database provides a Segment Advisor that provides advice on whether an object has space available for reclamation based on the level of space fragmentation within an object.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN014" href="../../server.112/e25494/schema.htm#ADMIN014"><span class="italic">Oracle Database Administrator's Guide</span></a> and <a class="olink ADMQS" href="../e10897/toc.htm"><span class="italic">Oracle Database 2 Day DBA</span></a> to learn about the Segment Advisor</div>
<p>If an object does have space available for reclamation, then you can compact and shrink segments or deallocate unused space at the end of a segment.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink ADMIN01401" href="../../server.112/e25494/schema.htm#ADMIN01401"><span class="italic">Oracle Database Administrator's Guide</span></a> for a discussion of reclaiming unused space</p>
</li>
<li>
<p><a class="olink SQLRF01403" href="../../server.112/e41084/statements_7003.htm#SQLRF01403"><span class="italic">Oracle Database SQL Language Reference</span></a> for details about SQL statements used to shrink segments or deallocate unused space</p>
</li>
</ul>
</div>
</div>
<!-- class="sect2" -->
<a id="i10483"></a>
<div id="PFGRF94156" class="sect2">
<h3 class="sect2"><span class="secnum">4.2.3</span> Indexing Data</h3>
<p><a id="sthref222"></a>The most efficient time to create indexes is after data has been loaded. In this way, space management becomes simpler, and no index maintenance takes place for each row inserted. SQL*Loader automatically uses this technique, but if you are using other methods to do initial data load, then you may need to create indexes manually. Additionally, you can perform index creation in parallel using the <a id="sthref223"></a><a id="sthref224"></a><code>PARALLEL</code> clause of the <code>CREATE</code> <code>INDEX</code> statement. However, SQL*Loader is not able to parallelize index creation, so you must manually create indexes in parallel after loading data.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about SQL*Loader</div>
<div id="PFGRF94157" class="sect3"><a id="sthref225"></a>
<h4 class="sect3"><span class="secnum">4.2.3.1</span> Specifying Memory for Sorting Data</h4>
<p>During index creation on tables that contain data, the data must be sorted. This sorting is done in the fastest possible way, if all available memory is used for sorting. Oracle recommends that you enable automatic sizing of SQL working areas by setting the <code><a id="sthref226"></a><a id="sthref227"></a>PGA_AGGREGATE_TARGET</code> initialization parameter.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="memory.htm#i49320">"PGA Memory Management"</a> for information about PGA memory management</p>
</li>
<li>
<p><a class="olink REFRN10165" href="../../server.112/e40402/initparams193.htm#REFRN10165"><span class="italic">Oracle Database Reference</span></a> for information about the <code>PGA_AGGREGATE_TARGET</code> initialization parameter</p>
</li>
</ul>
</div>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i22941"></a>
<div id="PFGRF021" class="sect1">
<h2 class="sect1"><span class="secnum">4.3</span> Performance Considerations for Shared Servers</h2>
<p>Using shared servers reduces the number of processes and the amount of memory consumed on the database host. Shared servers are beneficial for databases where there are many OLTP users performing intermittent transactions.</p>
<p>Using shared servers rather than dedicated servers is also generally better for systems that have a high connection rate to the database. With shared servers, when a connect request is received, a dispatcher is available to handle concurrent connection requests. With dedicated servers, however, a connection-specific dedicated server is sequentially initialized for each connection request.</p>
<p><a id="sthref228"></a>Performance of certain database features can improve when a shared server architecture is used, and performance of certain database features can degrade slightly when a shared server architecture is used. For example, a session can be prevented from migrating to another shared server while parallel execution is active.</p>
<p>A session can remain nonmigratable even after a request from the client has been processed, because not all the user information has been stored in the <a id="sthref229"></a>UGA. If a server were to process the request from the client, then the part of the user state that was not stored in the UGA would be inaccessible. To avoid this situation, individual shared servers often need to remain bound to a user session.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink ADMIN005" href="../../server.112/e25494/monitoring.htm#ADMIN005"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn how to manage shared servers</p>
</li>
<li>
<p><a class="olink NETAG" href="../../network.112/e41945/toc.htm"><span class="italic">Oracle Database Net Services Administrator's Guide</span></a> to learn how to configure dispatchers for shared servers</p>
</li>
</ul>
</div>
<p>When using some features, you may need to configure more shared servers, because some servers might be bound to sessions for an excessive amount of time.</p>
<p><a id="sthref230"></a><a id="sthref231"></a><a id="sthref232"></a>This section discusses how to reduce contention for processes used by Oracle Database architecture:</p>
<ul>
<li>
<p><a href="#i22552">Identifying Contention Using the Dispatcher-Specific Views</a></p>
</li>
<li>
<p><a href="#i22612">Identifying Contention for Shared Servers</a></p>
</li>
</ul>
<a id="i22552"></a>
<div id="PFGRF94158" class="sect2">
<h3 class="sect2"><span class="secnum">4.3.1</span> Identifying Contention Using the Dispatcher-Specific Views</h3>
<p>The following views provide dispatcher performance statistics:</p>
<ul>
<li>
<p><code>V$DISPATCHER</code>: general information about dispatcher processes</p>
</li>
<li>
<p><code>V$DISPATCHER_RATE</code>: dispatcher processing statistics</p>
</li>
</ul>
<p>The <code>V$DISPATCHER_RATE</code> view contains current, average, and maximum dispatcher statistics for several categories. Statistics with the prefix <code>CUR_</code> are statistics for the current sample. Statistics with the prefix <code>AVG_</code> are the average values for the statistics after the collection period began. Statistics with the prefix <code>MAX_</code> are the maximum values for these categories after statistics collection began.</p>
<p>To assess dispatcher performance, query the <code>V$DISPATCHER_RATE</code> view and compare the current values with the maximums. If your present system throughput provides adequate response time and current values from this view are near the average and less than the maximum, then you likely have an optimally tuned shared server environment.</p>
<p>If the current and average rates are significantly less than the maximums, then consider reducing the number of dispatchers. Conversely, if current and average rates are close to the maximums, then you might need to add more dispatchers. A general rule is to examine <code>V$DISPATCHER_RATE</code> statistics during both light and heavy system use periods. After identifying your shared server load patterns, adjust your parameters accordingly.</p>
<p>If necessary, you can also mimic processing loads by running system stress tests and periodically polling <code>V$DISPATCHER_RATE</code> statistics. Proper interpretation of these statistics varies from platform to platform. Different types of applications also can cause significant variations on the statistical values recorded in <code>V$DISPATCHER_RATE</code>.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink REFRN30063" href="../../server.112/e40402/dynviews_1114.htm#REFRN30063"><span class="italic">Oracle Database Reference</span></a> for detailed information about the <code>V$DISPATCHER</code> and <code>V$DISPATCHER_RATE</code> views</p>
</li>
</ul>
</div>
<a id="i22578"></a>
<div id="PFGRF94159" class="sect3">
<h4 class="sect3"><span class="secnum">4.3.1.1</span> Reducing Contention for Dispatcher Processes</h4>
<p><a id="sthref233"></a>To reduce contention, consider the following:</p>
<ul>
<li>
<p>Adding dispatcher processes</p>
<p>The total number of dispatcher processes is limited by the value of the initialization parameter <code>MAX_DISPATCHERS<a id="sthref234"></a></code>. You might need to increase this value before adding dispatcher processes.</p>
</li>
<li>
<p>Enabling connection pooling</p>
<p>When system load increases and dispatcher throughput is maximized, it is not necessarily a good idea to immediately add more dispatchers. Instead, consider configuring the dispatcher to support more users with connection pooling.</p>
</li>
<li>
<p>Enabling Session Multiplexing</p>
<p>Multiplexing is used by a connection manager process to establish and maintain network sessions from multiple users to individual dispatchers. For example, several user processes can connect to one dispatcher by way of a single connection from a connection manager process. Session multiplexing is beneficial because it maximizes use of the dispatcher process connections. Multiplexing is also useful for multiplexing database link sessions between dispatchers.</p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<ul>
<li>
<p><a class="olink ADMIN005" href="../../server.112/e25494/monitoring.htm#ADMIN005"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn how to configure dispatcher processes</p>
</li>
<li>
<p><a class="olink NETAG012" href="../../network.112/e41945/dispatcher.htm#NETAG012"><span class="italic">Oracle Database Net Services Administrator's Guide</span></a> to learn how to configure connection pooling</p>
</li>
<li>
<p><a class="olink REFRN10049" href="../../server.112/e40402/initparams080.htm#REFRN10049"><span class="italic">Oracle Database Reference</span></a> to learn about the <code>DISPATCHERS</code> and <code>MAX_DISPATCHERS</code> initialization parameters</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i22612"></a>
<div id="PFGRF94160" class="sect2">
<h3 class="sect2"><span class="secnum">4.3.2</span> Identifying Contention for Shared Servers</h3>
<p>Steadily increasing wait times in the requests queue indicate contention for shared servers. To examine wait time data, use the dynamic performance view <code>V$QUEUE</code>. This view contains s<a id="sthref235"></a>tatistics showing request queue activity for shared servers. By default, this view is available only to the user <code>SYS</code> and to other users with <code>SELECT</code> <code>ANY</code> <code>TABLE</code> system privilege, such as <code>SYSTEM</code>. <a href="#g23909">Table 4-3</a> lists the columns showing the wait times for requests and the number of requests in the queue.</p>
<div id="PFGRF94161" class="tblformal">
<p class="titleintable"><a id="sthref236"></a><a id="g23909"></a>Table 4-3 Wait Time and Request Columns in V$QUEUE</p>
<table class="cellalignment1686" title="Wait Time and Request Columns in V$QUEUE" summary="This table describes the columns in the V$QUEUE view for displaying wait time and total number of requests for request queues for shared server." dir="ltr">
<thead>
<tr class="cellalignment1680">
<th class="cellalignment1687" id="r1c1-t20">Column</th>
<th class="cellalignment1687" id="r1c2-t20">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r2c1-t20" headers="r1c1-t20">
<p><code>WAIT</code></p>
</td>
<td class="cellalignment1688" headers="r2c1-t20 r1c2-t20">
<p>Displays the total waiting time, in hundredths of a second, for all requests that have ever been in the queue</p>
</td>
</tr>
<tr class="cellalignment1680">
<td class="cellalignment1688" id="r3c1-t20" headers="r1c1-t20">
<p><code>TOTALQ</code></p>
</td>
<td class="cellalignment1688" headers="r3c1-t20 r1c2-t20">
<p>Displays the total number of requests that have ever been in the queue</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p><a id="sthref237"></a>Monitor these statistics occasionally while your application is running by issuing the following SQL statement:</p>
<pre>
SELECT DECODE(TOTALQ, 0, 'No Requests',
   WAIT/TOTALQ || ' HUNDREDTHS OF SECONDS') "AVERAGE WAIT TIME PER REQUESTS"
  FROM V$QUEUE
 WHERE TYPE = 'COMMON';
</pre>
<p>This query returns the results of a calculation that show the following:</p>
<pre>
AVERAGE WAIT TIME PER REQUEST
-----------------------------
.090909 HUNDREDTHS OF SECONDS
</pre>
<p>From the result, you can tell that a request waits an average of 0.09 hundredths of a second in the queue before processing.</p>
<p>You can also determine how many shared servers are currently running by issuing the following query:</p>
<pre>
SELECT COUNT(*) "Shared Server Processes"
  FROM V$SHARED_SERVER
 WHERE STATUS != 'QUIT';
</pre>
<p>The result of this query could look like the following:</p>
<pre>
Shared Server Processes
-----------------------
10
</pre>
<p>If you detect resource contention with shared servers, then first ensure that this is not a memory contention issue by examining the shared pool and the large pool. If performance remains poor, then you might want to create more resources to reduce shared server process contention. You can do this by modifying the optional server process initialization parameters:</p>
<ul>
<li>
<p><code>MAX_DISPATCHERS</code></p>
</li>
<li>
<p><code>MAX_SHARED_SERVERS</code></p>
</li>
<li>
<p><code>DISPATCHERS</code></p>
</li>
<li>
<p><code>SHARED_SERVERS</code></p>
<div class="infoboxnotealso">
<p class="notep1"><span class="bold">See Also</span>:</p>
<a class="olink ADMIN005" href="../../server.112/e25494/monitoring.htm#ADMIN005"><span class="italic">Oracle Database Administrator's Guide</span></a> to learn how to set the shared server process initialization parameters</div>
</li>
</ul>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1679">
<tr>
<td class="cellalignment1688">
<table class="cellalignment1684">
<tr>
<td class="cellalignment1683"><a href="part3.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1683"><a href="autostat.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2000, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1690">
<table class="cellalignment1682">
<tr>
<td class="cellalignment1683"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1683"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1683"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1683"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1683"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1683"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
