<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Automatic Performance Diagnostics</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1023" />
<meta name="dcterms.created" content="2014-06-30T4:25:5Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Performance Tuning Guide" />
<meta name="dcterms.identifier" content="E41573-04" />
<meta name="dcterms.isVersionOf" content="PFGRF" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2000, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="autostat.htm" title="Previous" type="text/html" />
<link rel="Next" href="memory.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e41573.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/31</span> <!-- End Header -->
<div id="PFGRF026" class="chapter"><a id="g41683"></a> <a id="i26746"></a>
<h1 class="chapter"><span class="secnum">6</span> Automatic Performance Diagnostics</h1>
<p>This chapter describes Oracle Database automatic features for performance diagnosing and tuning.</p>
<p>This chapter contains the following topics:</p>
<ul>
<li>
<p><a href="#i37241">Overview of the Automatic Database Diagnostic Monitor</a></p>
</li>
<li>
<p><a href="#CHDHAEJD">Setting Up ADDM</a></p>
</li>
<li>
<p><a href="#CHDGGFDC">Diagnosing Database Performance Problems with ADDM</a></p>
</li>
<li>
<p><a href="#i23680">Views with ADDM Information</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink TDPPT020" href="../../server.112/e10822/tdppt_auto.htm#TDPPT020"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a> for information about using Oracle Enterprise Manager to diagnose and tune the database with the Automatic Database Diagnostic Monitor</div>
<a id="i37241"></a>
<div id="PFGRF02602" class="sect1">
<h2 class="sect1"><span class="secnum">6.1</span> Overview of the Automatic Database Diagnostic Monitor</h2>
<p><a id="sthref327"></a><a id="sthref328"></a><a id="sthref329"></a>When problems occur with a system, it is important to perform accurate and timely diagnosis of the problem before making any changes to a system. Oftentimes, a database administrator (DBA) simply looks at the symptoms and immediately starts changing the system to fix those symptoms. However, an accurate diagnosis of the actual problem in the initial stage significantly increases the probability of success in resolving the problem.</p>
<p>With Oracle Database, the statistical data needed for accurate diagnosis of a problem is stored in the Automatic Workload Repository (AWR). The <a id="sthref330"></a><a id="sthref331"></a>Automatic Database Diagnostic Monitor (ADDM):</p>
<ul>
<li>
<p>Analyzes the AWR data on a regular basis</p>
</li>
<li>
<p>Diagnoses the root causes of performance problems</p>
</li>
<li>
<p>Provides recommendations for correcting any problems</p>
</li>
<li>
<p>Identifies non-problem areas of the system</p>
</li>
</ul>
<p>Because AWR is a repository of historical performance data, ADDM can analyze performance issues after the event, often saving time and resources in reproducing a problem. For information about the AWR, see <a href="autostat.htm#i27008">"Overview of the Automatic Workload Repository"</a>.</p>
<p>In most cases, ADDM output should be the first place that a DBA looks when notified of a performance problem. ADDM provides the following benefits:</p>
<ul>
<li>
<p>Automatic performance diagnostic report every hour by default</p>
</li>
<li>
<p>Problem diagnosis based on decades of tuning expertise</p>
</li>
<li>
<p>Time-based quantification of problem impacts and recommendation benefits</p>
</li>
<li>
<p>Identification of root cause, not symptoms</p>
</li>
<li>
<p>Recommendations for treating the root causes of problems</p>
</li>
<li>
<p>Identification of non-problem areas of the system</p>
</li>
<li>
<p>Minimal overhead to the system during the diagnostic process</p>
</li>
</ul>
<p>It is important to realize that tuning is an iterative process, and fixing one problem can cause the bottleneck to shift to another part of the system. Even with the benefit of ADDM analysis, it can take multiple tuning cycles to reach acceptable system performance. ADDM benefits apply beyond production systems; on development and test systems, ADDM can provide an early warning of performance issues.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDBFBBG">ADDM Analysis</a></p>
</li>
<li>
<p><a href="#CHDFDCEJ">Using ADDM with Oracle Real Application Clusters</a></p>
</li>
<li>
<p><a href="#CHDBDJFE">ADDM Analysis Results</a></p>
</li>
<li>
<p><a href="#CHDGAEBI">Reviewing ADDM Analysis Results: Example</a></p>
</li>
</ul>
<a id="CHDBFBBG"></a>
<div id="PFGRF94240" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.1.1</span> ADDM Analysis</h3>
<p>An ADDM analysis can be performed on a pair of AWR snapshots and a set of instances from the same database. The pair of AWR snapshots define the time period for analysis, and the set of instances define the target for analysis.</p>
<p>If you are using Oracle Real Application Clusters (Oracle RAC), ADDM has three analysis modes:</p>
<ul>
<li>
<p>Database</p>
<p>In Database mode, ADDM analyzes all instances of the database.</p>
</li>
<li>
<p>Instance</p>
<p>In Instance mode, ADDM analyzes a particular instance of the database.</p>
</li>
<li>
<p>Partial</p>
<p>In Partial mode, ADDM analyzes a subset of all database instances.</p>
</li>
</ul>
<p>If you are not using Oracle RAC, ADDM can only function in Instance mode because there is only one instance of the database.</p>
<p>An ADDM analysis is performed each time an AWR snapshot is taken and the results are saved in the database. The time period analyzed by ADDM is defined by the last two snapshots (the last hour by default). ADDM will always analyze the specified instance in Instance mode. For non-Oracle RAC or single instance environments, the analysis performed in the Instance mode is the same as a database-wide analysis. If you are using Oracle RAC, ADDM will also analyze the entire database in Database mode, as described in <a href="#CHDFDCEJ">"Using ADDM with Oracle Real Application Clusters"</a>. After an ADDM completes its analysis, you can view the results using Oracle Enterprise Manager, or by viewing a report in a SQL*Plus session.</p>
<p>ADDM analysis is performed top down, first identifying symptoms, and then refining them to reach the root causes of performance problems. The goal of the analysis is to reduce a single throughput <a id="sthref332"></a>metric called <code>DB</code> <code>time</code>. <code>DB</code> <code>time</code> is the cumulative time spent by the database in processing user requests. It includes wait time and CPU time of all non-idle user sessions. <code>DB</code> <code>time</code> is displayed in the <code>V$SESS_TIME_MODEL</code> and <code>V$SYS_TIME_MODEL</code> views.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink REFRN30340" href="../../server.112/e40402/dynviews_3015.htm#REFRN30340"><span class="italic">Oracle Database Reference</span></a> for information about the <code>V$SESS_TIME_MODEL</code> and <code>V$SYS_TIME_MODEL</code> views</p>
</li>
<li>
<p><a href="autostat.htm#i37457">"Time Model Statistics"</a> for a discussion of time model statistics and <code>DB</code> <code>time</code></p>
</li>
<li>
<p><a class="olink CNCPT008" href="../../server.112/e40540/process.htm#CNCPT008"><span class="italic">Oracle Database Concepts</span></a> for information about server processes</p>
</li>
</ul>
</div>
<p><a id="sthref333"></a>By reducing <code>DB</code> <code>time</code>, the database is able to support more user requests using the same resources, which increases throughput. The problems reported by ADDM are sorted by the amount of <code>DB</code> <code>time</code> they are responsible for. System areas that are not responsible for a significant portion of <code>DB</code> <code>time</code> are reported as non-problem areas.</p>
<p><a id="sthref334"></a>The types of problems that ADDM considers include the following:</p>
<ul>
<li>
<p>CPU bottlenecks - Is the system CPU bound by Oracle Database or some other application?</p>
</li>
<li>
<p>Undersized Memory Structures - Are the Oracle Database memory structures, such as the SGA, PGA, and buffer cache, adequately sized?</p>
</li>
<li>
<p>I/O capacity issues - Is the I/O subsystem performing as expected?</p>
</li>
<li>
<p>High load SQL statements - Are there any SQL statements which are consuming excessive system resources?</p>
</li>
<li>
<p>High load PL/SQL execution and compilation, and high-load Java usage</p>
</li>
<li>
<p>Oracle RAC specific issues - What are the global cache hot blocks and objects; are there any interconnect latency issues?</p>
</li>
<li>
<p>Sub-optimal use of Oracle Database by the application - Are there problems with poor connection management, excessive parsing, or application level lock contention?</p>
</li>
<li>
<p>Database configuration issues - Is there evidence of incorrect sizing of log files, archiving issues, excessive checkpoints, or sub-optimal parameter settings?</p>
</li>
<li>
<p>Concurrency issues - Are there buffer busy problems?</p>
</li>
<li>
<p>Hot objects and top SQL for various problem areas</p>
</li>
</ul>
<div class="infobox-note">
<p class="notep1">Note:</p>
This is not a comprehensive list of all problem types that ADDM considers in its analysis.</div>
<p>ADDM also documents the non-problem areas of the system. For example, wait event classes that are not significantly impacting the performance of the system are identified and removed from the tuning consideration at an early stage, saving time and effort that would be spent on items that do not impact overall system performance.</p>
</div>
<!-- class="sect2" -->
<a id="CHDFDCEJ"></a>
<div id="PFGRF94241" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.1.2</span> Using ADDM with Oracle Real Application Clusters</h3>
<p>If you are using Oracle RAC, you can run ADDM in Database analysis mode to analyze the throughput performance of all instances of the database. In Database mode, ADDM considers DB time as the sum of the database time for all database instances. Using the Database analysis mode enables you to view all findings that are significant to the entire database in a single report, instead of reviewing a separate report for each instance.</p>
<p>The Database mode report includes findings about database resources (such as I/O and interconnect). The report also aggregates findings from the various instances if they are significant to the entire database. For example, if the CPU load on a single instance is high enough to affect the entire database, the finding will appear in the Database mode analysis, which will point to the particular instance responsible for the problem.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink TDPRC324" href="../../rac.112/e17264/racmon2.htm#TDPRC324"><span class="italic">Oracle Database 2 Day + Real Application Clusters Guide</span></a> for information about using ADDM with Oracle RAC</div>
</div>
<!-- class="sect2" -->
<a id="CHDBDJFE"></a>
<div id="PFGRF94242" class="sect2">
<h3 class="sect2"><span class="secnum">6.1.3</span> ADDM Analysis Results</h3>
<p>In addition to problem diagnostics, ADDM recommends possible solutions. <a id="sthref335"></a>ADDM analysis results are represented as a set of <a id="sthref336"></a>findings. See <a href="#i38382">Example 6-1</a> for an example of ADDM analysis result. Each ADDM finding can belong to one of the following types:</p>
<ul>
<li>
<p>Problem findings describe the root cause of a database performance problem.</p>
</li>
<li>
<p>Symptom findings contain information that often lead to one or more problem findings.</p>
</li>
<li>
<p>Information findings are used for reporting information that are relevant to understanding the performance of the database, but do not constitute a performance problem (such as non-problem areas of the database and the activity of automatic database maintenance).</p>
</li>
<li>
<p>Warning findings contain information about problems that may affect the completeness or accuracy of the ADDM analysis (such as missing data in the AWR).</p>
</li>
</ul>
<p>Each problem finding is quantified by an impact that is an estimate of the portion of <code>DB</code> <code>time</code> caused by the finding's performance issue. A problem finding can be associated with a list of recommendations for reducing the impact of the performance problem. The types of recommendations include<a id="sthref337"></a>:</p>
<ul>
<li>
<p>Hardware changes: adding CPUs or changing the I/O subsystem configuration</p>
</li>
<li>
<p>Database configuration: changing initialization parameter settings</p>
</li>
<li>
<p>Schema changes: hash partitioning a table or index, or using automatic segment-space management (ASSM)</p>
</li>
<li>
<p>Application changes: using the cache option for sequences or using bind variables</p>
</li>
<li>
<p>Using other advisors: running SQL Tuning Advisor on high-load SQL or running the Segment Advisor on hot objects</p>
</li>
</ul>
<p>A list of recommendations can contain various alternatives for solving the same problem; you do not have to apply all the recommendations to solve a specific problem. Each recommendation has a benefit which is an estimate of the portion of <code>DB</code> <code>time</code> that can be saved if the recommendation is implemented. <a id="sthref338"></a>Recommendations are composed of actions and rationales. You must apply all the actions of a recommendation to gain the estimated benefit. The rationales are used for explaining why the set of actions were recommended and to provide additional information to implement the suggested recommendation.</p>
</div>
<!-- class="sect2" -->
<a id="CHDGAEBI"></a>
<div id="PFGRF94243" class="sect2">
<h3 class="sect2"><span class="secnum">6.1.4</span> Reviewing ADDM Analysis Results: Example</h3>
<p><a id="sthref339"></a><a id="sthref340"></a>Consider the following section of an ADDM report in <a href="#i38382">Example 6-1</a>.</p>
<div id="PFGRF94244" class="example">
<p class="titleinexample"><a id="i38382"></a>Example 6-1 Example ADDM Report</p>
<pre>
FINDING 1: 31% impact (7798 seconds) 
------------------------------------ 
SQL statements were not shared due to the usage of literals. This resulted in 
additional hard parses which were consuming significant database time.

RECOMMENDATION 1: Application Analysis, 31% benefit (7798 seconds)
  ACTION: Investigate application logic for possible use of bind variables
    instead of literals. Alternatively, you may set the parameter 
    "cursor_sharing" to "force".
  RATIONALE: SQL statements with PLAN_HASH_VALUE 3106087033 were found to be
    using literals. Look in V$SQL for examples of such SQL statements.
</pre>
<p>In <a href="#i38382">Example 6-1</a>, the finding points to a particular root cause, the usage of literals in SQL statements, which is estimated to have an impact of about 31% of total <code>DB</code> <code>time</code> in the analysis period.</p>
<p>The finding has a recommendation associated with it, composed of one action and one rationale. The action specifies a solution to the problem found and is estimated to have a maximum benefit of up to 31% <code>DB</code> <code>time</code> in the analysis period. Note that the benefit is given as a portion of the total <code>DB</code> <code>time</code> and not as a portion of the finding's impact. The rationale provides additional information on tracking potential SQL statements that were using literals and causing this performance issue. Using the specified plan hash value of SQL statements that could be a problem, a DBA could quickly examine a few sample statements.</p>
<p>When a specific problem has multiple causes, the ADDM may report multiple problem and symptom findings. In this case, the impacts of these multiple findings can contain the same portion of <code>DB</code> <code>time</code>. Because the performance issues of findings can overlap, the sum of the impacts of the findings can exceed 100% of <code>DB</code> <code>time</code>. For example, if a system performs many reads, then ADDM might report a SQL statement responsible for 50% of <code>DB</code> <code>time</code> due to I/O activity as one finding, and an undersized buffer cache responsible for 75% of <code>DB</code> <code>time</code> as another finding.</p>
<p>When multiple recommendations are associated with a problem finding, the recommendations may contain alternatives for solving the problem. In this case, the sum of the recommendations' benefits may be higher than the finding's impact.</p>
<p>When appropriate, an ADDM action may have multiple solutions for you to choose from. In the example, the most effective solution is to use bind variables. However, it is often difficult to modify the application. Changing the value of the <code>CURSOR_SHARING</code> initialization parameter is much easier to implement and can provide significant improvement.</p>
</div>
<!-- class="example" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CHDHAEJD"></a>
<div id="PFGRF94245" class="sect1">
<h2 class="sect1"><span class="secnum">6.2</span> Setting Up ADDM</h2>
<p><a id="sthref341"></a><a id="sthref342"></a>Automatic database diagnostic monitoring is enabled by default and is controlled by the <code><a id="sthref343"></a><a id="sthref344"></a>CONTROL_MANAGEMENT_PACK_ACCESS</code> and the <code><a id="sthref345"></a><a id="sthref346"></a>STATISTICS_LEVEL</code> initialization parameters.</p>
<p>The <code>CONTROL_MANAGEMENT_PACK_ACCESS</code> parameter should be set to <code>DIAGNOSTIC</code> or <code>DIAGNOSTIC+TUNING</code> to enable automatic database diagnostic monitoring. The default setting is <code>DIAGNOSTIC+TUNING</code>. Setting <code>CONTROL_MANAGEMENT_PACK_ACCESS</code> to <code>NONE</code> disables ADDM.</p>
<p>The <code>STATISTICS_LEVEL</code> parameter should be set to the <code>TYPICAL</code> or <code>ALL</code> to enable automatic database diagnostic monitoring. The default setting is <code>TYPICAL</code>. Setting <code>STATISTICS_LEVEL</code> to <code>BASIC</code> disables many Oracle Database features, including ADDM, and is strongly discouraged.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN" href="../e40402/toc.htm"><span class="italic">Oracle Database Reference</span></a> for information about the <code>CONTROL_MANAGEMENT_PACK_ACCESS</code> and <code>STATISTICS_LEVEL</code> initialization parameters</div>
<p>ADDM analysis of I/O performance partially depends on a single argument, <code><a id="sthref347"></a><a id="sthref348"></a>DBIO_EXPECTED</code>, that describes the expected performance of the I/O subsystem. The value of <code>DBIO_EXPECTED</code> is the average time it takes to read a single database block in microseconds. Oracle Database uses the default value of 10 milliseconds, which is an appropriate value for most modern hard drives. If your hardware is significantly different, such as very old hardware or very fast RAM disks, consider using a different value.</p>
<p>To determine the correct setting for <code>DBIO_EXPECTED</code> parameter:</p>
<ol>
<li>
<p>Measure the average read time of a single database block read for your hardware. Note that this measurement is for random I/O, which includes seek time if you use standard hard drives. Typical values for hard drives are between 5000 and 20000 microseconds.</p>
</li>
<li>
<p><a id="sthref349"></a><a id="sthref350"></a>Set the value one time for all subsequent ADDM executions. For example, if the measured value if 8000 microseconds, you should execute the following command as SYS user:</p>
<pre>
EXECUTE DBMS_ADVISOR.SET_DEFAULT_TASK_PARAMETER(
                     'ADDM', 'DBIO_EXPECTED', 8000);
</pre></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CHDGGFDC"></a>
<div id="PFGRF94246" class="sect1">
<h2 class="sect1"><span class="secnum">6.3</span> Diagnosing Database Performance Problems with ADDM</h2>
<p>To diagnose database performance problems, first review the ADDM analysis results that are automatically created each time an AWR snapshot is taken. If a different analysis is required (such as a longer analysis period, using a different <code>DBIO_EXPECTED</code> setting, or changing the analysis mode), you can run ADDM manually as described in this section.</p>
<p>ADDM can analyze any two AWR snapshots (on the same database), as long as both snapshots are still stored in the AWR (have not been purged). ADDM can only analyze instances that are started before the beginning snapshot and remain running until the ending snapshot. Additionally, ADDM will not analyze instances that experience significant errors when generating the AWR snapshots. In such cases, ADDM will analyze the largest subset of instances that did not experience these problems.</p>
<p>The primary interface for diagnostic monitoring is Oracle Enterprise Manager. Whenever possible, you should run ADDM using Oracle Enterprise Manager, as described in <a class="olink TDPPT020" href="../../server.112/e10822/tdppt_auto.htm#TDPPT020"><span class="italic">Oracle Database 2 Day + Performance Tuning Guide</span></a>. If Oracle Enterprise Manager is unavailable, you can run ADDM using the <code><a id="sthref351"></a>DBMS_ADDM</code> package. In order to run the <code>DBMS_ADDM</code> APIs, the user must be granted the <code>ADVISOR</code> privilege.</p>
<p>This section contains the following topics:</p>
<ul>
<li>
<p><a href="#CHDIFEAI">Running ADDM in Database Mode</a></p>
</li>
<li>
<p><a href="#CHDCGJED">Running ADDM in Instance Mode</a></p>
</li>
<li>
<p><a href="#CHDJIBJJ">Running ADDM in Partial Mode</a></p>
</li>
<li>
<p><a href="#CHDBJDIH">Displaying an ADDM Report</a></p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ARPLS232" href="../../appdev.112/e40758/d_addm.htm#ARPLS232"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about the <code>DBMS_ADDM</code> package</div>
<a id="CHDIFEAI"></a>
<div id="PFGRF94247" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.3.1</span> Running ADDM in Database Mode</h3>
<p>For Oracle RAC configurations, you can run ADDM in Database mode to analyze all instances of the databases. For single-instance configurations, you can still run ADDM in Database mode; ADDM will simply behave as if running in Instance mode.</p>
<p>To run ADDM in Database mode, use the <code>DBMS_ADDM</code>.<code>ANALYZE_DB</code> procedure:</p>
<pre>
BEGIN
DBMS_ADDM.ANALYZE_DB (
   task_name           IN OUT VARCHAR2,
   begin_snapshot      IN     NUMBER,
   end_snapshot        IN     NUMBER,
   db_id               IN     NUMBER := NULL);
END;
/
</pre>
<p>The <code>task_name</code> parameter specifies the name of the analysis task that will be created. The <code>begin_snapshot</code> parameter specifies the snapshot number of the beginning snapshot in the analysis period. The <code>end_snapshot</code> parameter specifies the snapshot number of the ending snapshot in the analysis period. The <code>db_id</code> parameter specifies the database identifier of the database that will be analyzed. If unspecified, this parameter defaults to the database identifier of the database to which you are currently connected.</p>
<p>The following example creates an ADDM task in database analysis mode, and executes it to diagnose the performance of the entire database during the time period defined by snapshots 137 and 145:</p>
<pre>
VAR tname VARCHAR2(30);
BEGIN
  :tname := 'ADDM for 7PM to 9PM';
  DBMS_ADDM.ANALYZE_DB(:tname, 137, 145);
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="CHDCGJED"></a>
<div id="PFGRF94248" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.3.2</span> Running ADDM in Instance Mode</h3>
<p>To analyze a particular instance of the database, you can run ADDM in Instance mode. To run ADDM in Instance mode, use the <code>DBMS_ADDM</code>.<code>ANALYZE_INST</code> procedure:</p>
<pre>
BEGIN
DBMS_ADDM.ANALYZE_INST (
   task_name           IN OUT VARCHAR2,
   begin_snapshot      IN     NUMBER,
   end_snapshot        IN     NUMBER,
   instance_number     IN     NUMBER := NULL,
   db_id               IN     NUMBER := NULL);
END;
/
</pre>
<p>The <code>task_name</code> parameter specifies the name of the analysis task that will be created. The <code>begin_snapshot</code> parameter specifies the snapshot number of the beginning snapshot in the analysis period. The <code>end_snapshot</code> parameter specifies the snapshot number of the ending snapshot in the analysis period. The <code>instance_number</code> parameter specifies the instance number of the instance that will be analyzed. If unspecified, this parameter defaults to the instance number of the instance to which you are currently connected. The <code>db_id</code> parameter specifies the database identifier of the database that will be analyzed. If unspecified, this parameter defaults to the database identifier of the database to which you are currently connected.</p>
<p>The following example creates an ADDM task in instance analysis mode, and executes it to diagnose the performance of instance number 1 during the time period defined by snapshots 137 and 145:</p>
<pre>
VAR tname VARCHAR2(30);
BEGIN
  :tname := 'my ADDM for 7PM to 9PM';
  DBMS_ADDM.ANALYZE_INST(:tname, 137, 145, 1);
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="CHDJIBJJ"></a>
<div id="PFGRF94249" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.3.3</span> Running ADDM in Partial Mode</h3>
<p>To analyze a subset of all database instances, you can run ADDM in Partial mode. To run ADDM in Partial mode, use the <code>DBMS_ADDM</code>.<code>ANALYZE_PARTIAL</code> procedure:</p>
<pre>
BEGIN
DBMS_ADDM.ANALYZE_PARTIAL (
   task_name           IN OUT VARCHAR2,
   instance_numbers    IN     VARCHAR2,
   begin_snapshot      IN     NUMBER,
   end_snapshot        IN     NUMBER,
   db_id               IN     NUMBER := NULL);
END;
/
</pre>
<p>The <code>task_name</code> parameter specifies the name of the analysis task that will be created. The <code>instance_numbers</code> parameter specifies a comma-delimited list of instance numbers of instances that will be analyzed. The <code>begin_snapshot</code> parameter specifies the snapshot number of the beginning snapshot in the analysis period. The <code>end_snapshot</code> parameter specifies the snapshot number of the ending snapshot in the analysis period. The <code>db_id</code> parameter specifies the database identifier of the database that will be analyzed. If unspecified, this parameter defaults to the database identifier of the database to which you are currently connected.</p>
<p>The following example creates an ADDM task in partial analysis mode, and executes it to diagnose the performance of instance numbers 1, 2, and 4, during the time period defined by snapshots 137 and 145:</p>
<pre>
VAR tname VARCHAR2(30);
BEGIN
  :tname := 'my ADDM for 7PM to 9PM';
  DBMS_ADDM.ANALYZE_PARTIAL(:tname, '1,2,4', 137, 145);
END;
/
</pre></div>
<!-- class="sect2" -->
<a id="CHDBJDIH"></a>
<div id="PFGRF94250" class="sect2"><!-- infolevel="all" infotype="General" -->
<h3 class="sect2"><span class="secnum">6.3.4</span> Displaying an ADDM Report</h3>
<p>To display a text report of an executed ADDM task, use the <code>DBMS_ADDM</code>.<code>GET_REPORT</code> function:</p>
<pre>
DBMS_ADDM.GET_REPORT (
   task_name           IN VARCHAR2
  RETURN CLOB);
</pre>
<p>The following example displays a text report of the ADDM task specified by its task name using the <code>tname</code> variable:</p>
<pre>
SET LONG 1000000 PAGESIZE 0;
SELECT DBMS_ADDM.GET_REPORT(:tname) FROM DUAL;
</pre>
<p>Note that the return type of a report is a <code>CLOB</code>, formatted to fit line size of 80. For information about reviewing the ADDM analysis results in an ADDM report, see <a href="#CHDBDJFE">"ADDM Analysis Results"</a>.</p>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i23680"></a>
<div id="PFGRF94251" class="sect1">
<h2 class="sect1"><span class="secnum">6.4</span> Views with ADDM Information</h2>
<p>Typically, you should view output and information from ADDM using Oracle Enterprise Manager or ADDM reports.</p>
<p>However, you can display ADDM information through the <code>DBA_ADVISOR</code> views. This group of views includes:</p>
<ul>
<li>
<p><code>DBA_ADVISOR_FINDINGS</code></p>
<p>This view displays all the findings discovered by all advisors. Each finding is displayed with an associated finding ID, name, and type. For tasks with multiple executions, the name of each task execution associated with each finding is also listed.</p>
</li>
<li>
<p><code>DBA_ADDM_FINDINGS</code></p>
<p>This view contains a subset of the findings displayed in the related <code>DBA_ADVISOR_FINDINGS</code> view. This view only displays the ADDM findings discovered by all advisors. Each ADDM finding is displayed with an associated finding ID, name, and type.</p>
</li>
<li>
<p><code>DBA_ADVISOR_FINDING_NAMES</code></p>
<p>List of all finding names registered with the advisor framework.</p>
</li>
<li>
<p><code>DBA_ADVISOR_RECOMMENDATIONS</code></p>
<p>This view displays the results of completed diagnostic tasks with recommendations for the problems identified in each execution. The recommendations should be reviewed in the order of the <code>RANK</code> column, as this relays the magnitude of the problem for the recommendation. The <code>BENEFIT</code> column displays the benefit to the system you can expect after the recommendation is performed. For tasks with multiple executions, the name of each task execution associated with each advisor task is also listed.</p>
</li>
<li>
<p><code>DBA_ADVISOR_TASKS</code></p>
<p>This view provides basic information about existing tasks, such as the task ID, task name, and when the task was created. For tasks with multiple executions, the name and type of the last or current execution associated with each advisor task is also listed.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink REFRN002" href="../../server.112/e40402/statviews_part.htm#REFRN002"><span class="italic">Oracle Database Reference</span></a> for information about static data dictionary views</div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1679">
<tr>
<td class="cellalignment1688">
<table class="cellalignment1684">
<tr>
<td class="cellalignment1683"><a href="autostat.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1683"><a href="memory.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2000, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1690">
<table class="cellalignment1682">
<tr>
<td class="cellalignment1683"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1683"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1683"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1683"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1683"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1683"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
