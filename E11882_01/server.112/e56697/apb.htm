<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Managing the Database</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1058" />
<meta name="dcterms.created" content="2015-06-25T1:51:7Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Database Administrator's Reference" />
<meta name="dcterms.identifier" content="E56697-01" />
<meta name="dcterms.isVersionOf" content="VMSAR" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2008, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="apa.htm" title="Previous" type="text/html" />
<link rel="Next" href="apc.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e56697.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">13/18</span> <!-- End Header -->
<div id="VMSAR596" class="appendix"><a id="g625018"></a> <a id="i624628"></a>
<h1 class="appendix"><span class="secnum">B</span> Managing the Database<a id="sthref583"></a></h1>
<p>Ensuring that Oracle Database 11<span class="italic">g</span> operates successfully can involve tuning the system or modifying parameters. These tasks require a thorough understanding of HP OpenVMS system administration as well as the concepts documented in <a class="olink ADMIN" href="../e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a>.</p>
<p>This appendix contains the following topics:</p>
<ul>
<li>
<p><a href="#BGBIDBFD">Section B.1, "SQL*Plus and Oracle Net Services"</a></p>
</li>
<li>
<p><a href="#i1004946">Section B.2, "Creating Multiple Control Files"</a></p>
</li>
<li>
<p><a href="#i1004947">Section B.3, "Managing Database Files"</a></p>
</li>
<li>
<p><a href="#i1004948">Section B.4, "Database Verification Utility"</a></p>
</li>
<li>
<p><a href="#i1004949">Section B.5, "Important Note on Changes to Data File Formats for HP OpenVMS"</a></p>
</li>
</ul>
<a id="BGBIDBFD"></a>
<div id="VMSAR597" class="sect1">
<h2 class="sect1"><span class="secnum">B.1</span> SQL*Plus and Oracle Net Services</h2>
<p>When you start SQL*Plus, a <a id="sthref584"></a>Bequeath protocol adapter connection is made if no TNS connect descriptor is supplied. Refer to <a href="ch5.htm#g31798">Chapter 5, "Configuring Oracle Net Services"</a> for more information about Bequeath adapter.</p>
</div>
<!-- class="sect1" -->
<a id="i1004946"></a>
<div id="VMSAR598" class="sect1">
<h2 class="sect1"><span class="secnum">B.2</span> Creating Multiple Control Files<a id="sthref585"></a><a id="sthref586"></a></h2>
<p>Three control files are created whenever you create a database. By default, the files are named <code dir="ltr">CONTROL01.CTL</code>, <code dir="ltr">CONTROL02.CTL</code>, and <code dir="ltr">CONTROL03.CTL</code>. They reside in the directory pointed to by the <code dir="ltr">ORA_DB</code> logical name. However, Oracle recommends that you back up the control files and create additional copies. When working with control files, keep in mind the following:</p>
<ul>
<li>
<p>When you add more control files, you must add the new file names and locations to the <code dir="ltr">CONTROL_FILES</code> initialization parameter.</p>
</li>
<li>
<p>By default, the control files reside in the <code dir="ltr">ORA_DB</code> directory.</p>
</li>
<li>
<p>Control files can be moved to any location.</p>
</li>
<li>
<p>To guard against device failure, control files should be placed on separate devices.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN" href="../e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a></div>
</div>
<!-- class="sect1" -->
<a id="i1004947"></a>
<div id="VMSAR599" class="sect1">
<h2 class="sect1"><span class="secnum">B.3</span> Managing Database Files</h2>
<p>During the Oracle Database installation procedure, you can create one database file in the directory referenced by the logical name <code dir="ltr">ORA_DB</code>, typically <code dir="ltr">ORA_ROOT:[ORADATA.</code><span class="italic">dbname</span><code dir="ltr">]SYSTEM01.DBF</code>.</p>
<p>To add <a id="sthref587"></a><a id="sthref588"></a>database files to an existing tablespace, use the SQL statement <code dir="ltr">ALTER TABLESPACE</code><a id="sthref589"></a>. You cannot remove or delete a file. However, you can remove tablespaces other than the <code dir="ltr">SYSTEM</code><a id="sthref590"></a> tablespace.<a id="sthref591"></a></p>
<p>This section discusses the following topics to manage database files:</p>
<ul>
<li>
<p><a href="#BGBEEAAD">Section B.3.1, "Using Commands to Manage Database Files"</a></p>
</li>
<li>
<p><a href="#BGBEFGED">Section B.3.2, "Adding Files"</a></p>
</li>
<li>
<p><a href="#BGBGIDGD">Section B.3.3, "Renaming Files"</a></p>
</li>
<li>
<p><a href="#BGBDJFJF">Section B.3.4, "Moving Tablespace Files"</a></p>
</li>
<li>
<p><a href="#BGBCGFEA">Section B.3.5, "Moving Redo Log Files"</a></p>
</li>
</ul>
<a id="BGBEEAAD"></a>
<div id="VMSAR600" class="sect2">
<h3 class="sect2"><span class="secnum">B.3.1</span> Using <a id="sthref592"></a>Commands to Manage Database Files</h3>
<p>This section discusses commands that you can use to manage database files.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink ADMIN" href="../e25494/toc.htm"><span class="italic">Oracle Database Administrator's Guide</span></a></div>
<p class="subhead2"><a id="VMSAR601"></a>ALTER DATABASE</p>
<p>You can use the <code dir="ltr">ALTER DATABASE</code> command to mount, open, or close a database, to add or drop redo log files, and to archive redo log files. You can also use this command to rename or move tablespace files and redo log files.</p>
<p>You cannot use the <code dir="ltr">ALTER DATABASE BACKUP CONTROLFILE</code> command to back up control files to tape. To back up control files to tape, back up to disk and then copy to tape.</p>
<p class="subhead2"><a id="VMSAR602"></a>DROP TABLESPACE</p>
<p>Before using the <code dir="ltr">DROP TABLESPACE INCLUDING CONTENTS</code> command, take the tablespace offline to ensure that no temporary segments are in use. <a id="sthref593"></a><a id="sthref594"></a></p>
</div>
<!-- class="sect2" -->
<a id="BGBEFGED"></a>
<div id="VMSAR603" class="sect2">
<h3 class="sect2"><span class="secnum">B.3.2</span> Adding Files</h3>
<p>When specifying files to be added to the database, logical names are fully translated to either physical device names or system-level concealed logical names (if defined) and then written to the control file.</p>
</div>
<!-- class="sect2" -->
<a id="BGBGIDGD"></a>
<div id="VMSAR604" class="sect2">
<h3 class="sect2"><span class="secnum">B.3.3</span> Renaming Files</h3>
<p>If the name of the physical device is somehow dissociated from the database file locations, then the database cannot access these files. Use the <code dir="ltr">ALTER DATABASE</code> command to rename the file to its current location. After renaming the files, shut down the database and then back up the control files as in the following example:</p>
<pre dir="ltr">
SQL&gt; ALTER DATABASE RENAME FILE 
2&gt; 'DISK$1:[ORACLE11G.oradata.V10TEST]SYSTEM01.DBF' TO 
3&gt; 'MY$DISK:[ORACLE11G.oradata.V10TEST]SYSTEM01.DBF'
SQL&gt; EXIT
$ BACKUP/LOG/VERIFY/-
DISK$1:[ORACLE11G.oradata.V10TEST]*.CTL -
MY$DISK:[ORACLE11G.oradata.V10TEST]*.CTL
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
The physical device name and the file location must appear exactly as in the control file. Enter the following commands to get the physical device name and the database file locations:
<pre dir="ltr">
$ SQLPLUS/NOLOG 
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; SELECT * FROM <a id="sthref595"></a>V$DBFILE;
SQL&gt; DISCONNECT 
</pre></div>
</div>
<!-- class="sect2" -->
<a id="BGBDJFJF"></a>
<div id="VMSAR605" class="sect2">
<h3 class="sect2"><span class="secnum">B.3.4</span> Moving Tablespace Files</h3>
<p><a id="sthref596"></a><a id="sthref597"></a>To move a tablespace file to a new location:</p>
<ol>
<li>
<p>Identify and write down the exact, fully qualified file name from the data dictionary view, and shut down the database. The physical device name and the file location must appear exactly as in the control file and the data dictionary view, <code dir="ltr">DBA_DATA_FILES</code> or <code dir="ltr">V$LOGFILE</code>.</p>
<pre dir="ltr">
$ SQLPLUS/NOLOG 
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; SELECT * from V$DBFILE; 
SQL&gt; SELECT * from V$LOGFILE; 
SQL&gt; SHUTDOWN 
SQL&gt; EXIT 
</pre></li>
<li>
<p>Back up the tablespace and control files that you want to move.</p>
</li>
<li>
<p>Copy or move the file to a new location.</p>
<p>Use <code dir="ltr">BACKUP/VERIFY/DELETE</code> to move the file.</p>
<pre dir="ltr">
$ BACKUP/IGNORE=NOBACK/DELETE/VERIFY -
<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">filename</span>.<span class="italic">ext</span> -
<span class="italic">new_device</span>:[<span class="italic">new_dir</span>]<span class="italic">new_filename.ext</span>
</pre></li>
<li>
<p>Without opening it, mount the database in Exclusive mode.</p>
<pre dir="ltr">
$ SQLPLUS/NOLOG
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; STARTUP EXCLUSIVE MOUNT <span class="italic">dbname</span>
</pre></li>
<li>
<p>Rename the file in the database using the exact string taken from <code dir="ltr">V$DBFILE</code>.</p>
<pre dir="ltr">
SQL&gt; ALTER DATABASE
   2&gt; RENAME FILE '<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">filename</span>.<span class="italic">ext</span>'
   3&gt; to '<span class="italic">new_device</span>:[<span class="italic">new_dir</span>]<span class="italic">new_filename</span>.<span class="italic">ext</span>';
SQL&gt; ALTER DATABASE <span class="italic">dbname</span> OPEN;
SQL&gt; EXIT
</pre></li>
<li>
<p>Back up the control files.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BGBCGFEA"></a>
<div id="VMSAR606" class="sect2">
<h3 class="sect2"><span class="secnum">B.3.5</span> Moving Redo Log Files</h3>
<p><a id="sthref598"></a>Perform the following steps to move a redo log file to a new location:</p>
<ol>
<li>
<p>Identify the fully qualified file name of the redo log files that you want to move by using one of the following methods:</p>
<ol>
<li>
<p>Start the database.</p>
</li>
<li>
<p>Run the following query:</p>
<pre dir="ltr">
SQL&gt; SELECT * FROM V$LOGFILE;
</pre></li>
</ol>
</li>
<li>
<p>Shut down the database, create a backup of the redo log files in the new location, and mount the database in Exclusive mode (not opened).</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
After the database is shut down, make copies of all database, control, and redo log files as a precaution against any problems that can arise during this procedure.</div>
<pre dir="ltr">
$ SQLPLUS/NOLOG 
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; SHUTDOWN 
SQL&gt; EXIT 
$ BACKUP/IGNORE=NOBACK -
<span class="italic">old_device</span>:[<span class="italic">dir</span>]<span class="italic">filename</span>.<span class="italic">ext</span> -
<span class="italic">new_device</span>:[<span class="italic">new_dir</span>]<span class="italic">new_filename</span>.<span class="italic">ext</span>
$ SQLPLUS/NOLOG
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; STARTUP EXCLUSIVE MOUNT <span class="italic">dbname</span>
</pre>
<div class="infobox-note">
<p class="notep1">Note:</p>
Having the database mounted and closed is essential when working with the redo log files. This prevents any log files from becoming online or marked as current by the <code dir="ltr">LGWR</code>.</div>
</li>
<li>
<p>From SQL*Plus, rename the files in the database using the <code dir="ltr">ALTER DATABASE</code> command. Specify the full file path.</p>
<pre dir="ltr">
SQL&gt; CONNECT / AS SYSDBA 
SQL&gt; ALTER DATABASE RENAME FILE
   2&gt; '<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">old_redofile1</span>.RDO',
   3&gt; '<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">old_redofile2</span>.RDO' to
   4&gt; '<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">new_redofile1</span>.RDO',
   5&gt; '<span class="italic">device</span>:[<span class="italic">dir</span>]<span class="italic">new_redofile2</span>.RDO';
</pre>
<p>The file names specified must be correct and the new files must already exist. If either of these requirements is not met, then the statement fails.</p>
</li>
<li>
<p>Shut down the database by using the following command:</p>
<pre dir="ltr">
SQL&gt; SHUTDOWN
</pre></li>
<li>
<p>Back up the control files for safety.</p>
</li>
<li>
<p>Restart the database using the following commands.</p>
<pre dir="ltr">
SQL&gt; CONNECT / AS SYSDBA
SQL&gt; STARTUP OPEN <span class="italic">dbname</span>
SQL&gt; EXIT
</pre></li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="i1004948"></a>
<div id="VMSAR607" class="sect1">
<h2 class="sect1"><span class="secnum">B.4</span> Database Verification Utility<a id="sthref599"></a><a id="sthref600"></a></h2>
<p>The database verification utility (<code dir="ltr">DBV</code>)<a id="sthref601"></a> is the preferred technique for verifying the integrity of the database. Run this utility with the <code dir="ltr">DBV</code> symbol. Since Oracle Database 11<span class="italic">g</span> release 1, <code dir="ltr">DBV</code> can be used on an open database.</p>
<p>To verify data in an Oracle Database 11<span class="italic">g</span> Release 2 (11.2) database, point to the data files from the Oracle Database 11<span class="italic">g</span> Release 2 (11.2) installation.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SUTIL" href="../e22490/toc.htm"><span class="italic">Oracle Database Utilities</span></a> for information about using SQL*Plus to verify the database</div>
</div>
<!-- class="sect1" -->
<a id="i1004949"></a>
<div id="VMSAR608" class="sect1">
<h2 class="sect1"><span class="secnum">B.5</span> Important Note on Changes to Data File Formats for HP OpenVMS</h2>
<p>In Oracle Database 11<span class="italic">g</span>, the transportable tablespace feature has been extended to enable tablespaces to be transported across different platforms. To make this feature available on HP OpenVMS has necessitated a change in the Oracle file format. Specifically, data files, created while the database is running in 11<span class="italic">g</span> compatibility mode, are created with a new header block. This is called the OSD header (also referred to as block zero) at the beginning of the file. There are several important points to note regarding support for this new feature on HP OpenVMS:</p>
<ul>
<li>
<p>Oracle Database 11<span class="italic">g</span> retains full backward compatibility with 9.2 data files, which on HP OpenVMS prior to 11<span class="italic">g</span> did not contain a block 0. That is, a database can be started in 11<span class="italic">g</span> compatibility mode with a mix of 9.2 and 11<span class="italic">g</span> data files and is fully operable (all updates, writes, read, all operations available on a 11<span class="italic">g</span> data file are available on the 9.2 data file).</p>
</li>
<li>
<p>Data files created while the database is running in the 9.2 compatibility mode will continue to be created without the new header block.</p>
</li>
<li>
<p>The cross-platform transportable tablespace feature can only be used on files which have a block 0. For 11<span class="italic">g</span> data files, this is the case by default. For 9.2 data files, an explicit transformation must be applied to the file to create a new data file, which will contain the required block zero. Oracle Database 11<span class="italic">g</span> recommends the use of the <code dir="ltr">RMAN backup as copy datafile</code> command for the process of creating a new 11<span class="italic">g</span> format data file, that is:</p>
<pre dir="ltr">
RMAN&gt; backup as copy datafile 'tbs_31.f' format '11g_tbs_31.f';
</pre>
<p>This creates a new data file, which is a copy of the original data file but with the new block 0 header and a 11<span class="italic">g</span> format generic file header.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
For more information about the <code dir="ltr">rman backup</code> command, refer to the relevant sections in the Oracle documentation set</div>
</li>
</ul>
</div>
<!-- class="sect1" --></div>
<!-- class="appendix" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1595">
<tr>
<td class="cellalignment1604">
<table class="cellalignment1600">
<tr>
<td class="cellalignment1599"><a href="apa.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment1599"><a href="apc.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2008, 2015,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment1606">
<table class="cellalignment1598">
<tr>
<td class="cellalignment1599"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment1599"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment1599"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment1599"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment1599"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment1599"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
