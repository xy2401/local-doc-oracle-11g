<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Introduction to Automation Objects</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:30Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="codewiz.htm" title="Previous" type="text/html" />
<link rel="Next" href="serobjch.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">12/438</span> <!-- End Header -->
<div id="OOFOL0008" class="chapter"><a id="CEGDACJG"></a>
<h1 class="chapter"><span class="secnum">8</span> Introduction to Automation Objects</h1>
<p><a id="sthref555"></a>This chapter introduces commonly used OO4O Automation Objects.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#BGBDDFHB">Overview of Automation Objects</a></p>
</li>
<li>
<p><a href="#CEGGCAHG">OraSession Object Overview</a></p>
</li>
<li>
<p><a href="#BHCJHIBG">OraServer Object Overview</a></p>
</li>
<li>
<p><a href="#CEGIDJFJ">OraDatabase Object Overview</a></p>
</li>
<li>
<p><a href="#BHCJGACI">OraDynaset Object Overview</a></p>
</li>
<li>
<p><a href="#CEGECJHJ">OraField Object Overview</a></p>
</li>
<li>
<p><a href="#CEGJHFAF">OraParameters Object Overview</a></p>
</li>
<li>
<p><a href="#CEGEJBAI">OraParameter Object Overview</a></p>
</li>
<li>
<p><a href="#CEGDGCAH">OraParamArray Object Overview</a></p>
</li>
<li>
<p><a href="#CEGCFFII">OraSQLStmt Object Overview</a></p>
</li>
</ul>
<a id="BGBDDFHB"></a>
<div id="OOFOL334" class="sect1">
<h2 class="sect1">Overview of Automation Objects</h2>
<p>The OO4O operational hierarchy of the objects expresses has-a and belongs-to relationships.</p>
<p><a href="#CEGIIDGA">Figure 8-1</a> shows the operational hierarchy.</p>
<div id="OOFOL335" class="figure">
<p class="titleinfigure"><a id="CEGIIDGA"></a>Figure 8-1 OO4O Automation Objects</p>
<img width="570" height="417" src="img/o4o00001.gif" alt="hierarchy diagram starting with OraSession" /><br />
<a id="sthref556" href="img_text/o4o00001.htm">Description of "Figure 8-1 OO4O Automation Objects"</a><br />
<br /></div>
<!-- class="figure" -->
<p>The Automation objects diagram illustrates this hierarchy.</p>
</div>
<!-- class="sect1" -->
<a id="CEGGCAHG"></a>
<div id="OOFOL336" class="sect1"><!-- infolevel="all" infotype="General" -->
<h2 class="sect1">OraSession Object Overview</h2>
<p>The <code>OraSession</code> object is returned when an instance of the OO4O Automation Server is created. It mainly serves as an interface for establishing connections to Oracle databases. It also contains methods for starting, committing, and canceling transactions on the connections contained in the <code>OraDatabase</code> objects created. The following Visual Basic example creates an instance of the OO4O Automation Server.</p>
<pre>
'OracleInProcServer.XOraSession is the symbolic name for a 
'globally unique component identifier. 
Set OO4OSession = CreateObject("OracleInProcServer.XOraSession") 
 
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch023.htm#BABFCBJH">OraSession Object</a></p>
</li>
<li>
<p><a href="basfeat.htm#CIHGADBH">"Accessing the Oracle Objects for OLE Automation Server"</a></p>
</li>
<li>
<p><a href="basfeat.htm#CIHIBCDE">"Connecting to Oracle Database"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="BHCJHIBG"></a>
<div id="OOFOL337" class="sect1">
<h2 class="sect1">OraServer Object Overview</h2>
<p>The <code>OraServer</code> object represents a physical connection to an Oracle database instance. It provides a method, <code>OpenDatabase</code>, for creating user sessions, which represents <code>OraDatabase</code> objects. It makes it possible to do "connection multiplexing."</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch022.htm#BABDDGCH">OraServer Object</a></p>
</li>
<li>
<p><a href="basfeat.htm#CIHGADBH">"Accessing the Oracle Objects for OLE Automation Server"</a></p>
</li>
<li>
<p><a href="basfeat.htm#CIHHHIAC">"Using OraServer for Connection Multiplexing"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CEGIDJFJ"></a>
<div id="OOFOL338" class="sect1">
<h2 class="sect1">OraDatabase Object Overview</h2>
<p>The <code>OraDatabase</code> object represents a user connection to an Oracle database instance, and provides methods to execute SQL statements and PL/SQL code. The <code>OraDatabase</code> object is returned by the <code>OpenDatabase</code> method of the <code>OraSession</code> or the <code>OraServer</code> object.</p>
<p>The following example illustrates the use of the <code>OpenDatabase</code> method of the <code>OraSession</code>. <code>OraDatabase</code> objects created by this method contain a distinct physical connection to an Oracle database.</p>
<pre>
'Establish a connection to the <span class="italic">ExampleDb</span> database 
Set hrDBSession = OO4OSession.OpenDatabase("<span class="italic">ExampleDb</span>", "scott/tiger", 0&amp;) 
</pre>
<p>The following example demonstrates how a physical network connection to an Oracle database can be shared by multiple user sessions. Using a single connection that is shared by multiple user sessions results in reduced resource usage in an Oracle Database and can increase scalability.</p>
<pre>
'Create a server connection 
 
Set hrDBServer = CreateObject("OracleInProcServer.XOraServer") 
Set hrDBServer = oo4o.Open("<span class="italic">ExampleDb</span>") 
Set userSession1 = hrDBServer.OpenDatabase("scott/tiger", 0) 
 
'execute queries ... 
Set userSession2= hrDBServer.OpenDatabase("scott/tiger", 0) 
 
'execute queries ... 
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></div>
</div>
<!-- class="sect1" -->
<a id="BHCJGACI"></a>
<div id="OOFOL339" class="sect1">
<h2 class="sect1">OraDynaset Object Overview</h2>
<p>An <code>OraDynaset</code> object represents the result set of a SQL <code>SELECT</code> query or a PL/SQL cursor variable returned from a stored procedure or function. It is essentially a client-side scrollable and updatable cursor that allows for browsing the set of rows generated by the query it executes. It is created by the <code>CreateDynaset</code> or <code>CreateCustomDynaset</code> method of an <code>OraDatabase</code> interface.</p>
<p>The following Visual Basic example executes a query, loops through the result set, and displays values of columns returned.</p>
<pre>
Set employees = OraDatabase.CreateDynaset("select empno, ename from emp", 0&amp;)
 
'While there are more rows 
while not employees.EOF 
 
'Display the values of empno and ename column of the current row 
msgbox employees("empno") &amp; employees("ename") 
 
'Move to the next row 
employees.MoveNext 
wend
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch011.htm#BABJBBAI">OraDynaset Object</a></p>
</li>
<li>
<p><a href="sermthod052.htm#CIHBAFHG">CreateCustomDynaset Method</a></p>
</li>
<li>
<p><a href="sermthod054.htm#CIHFHBEI">CreateDynaset Method</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CEGECJHJ"></a>
<div id="OOFOL340" class="sect1">
<h2 class="sect1">OraField Object Overview</h2>
<p>The <code>OraField</code> object is an abstraction of a column in an <code>OraDynaset</code> object. It contains the value as well as the metadata that describes a column of the current row in the dynaset. In the previous example for the <code>OraDynaset</code> object, the <code>Field</code> interface for <code>empno</code> can be obtained using this additional code:</p>
<pre>
set empno = employees.Fields("empno") 
msgbox "Employee Number: " &amp; empno.Value 
</pre>
<p><code>OraFields</code> is a collection object representing all columns in the current row.</p>
<p><code>OraField</code> objects can represent instances of any data type supported by Oracle Database. This includes all primitive types, such as <code>VARCHAR2</code>, <code>NUMBER</code>, <code>INT</code>, and <code>FLOAT</code>, as well all the object-relational types introduced in Oracle8<span class="italic">i</span>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch012.htm#BABHHJGE">OraField Object</a></p>
</li>
<li>
<p><a href="advfeat.htm#BGBCDAHH">"Support for Oracle Object-Relational and LOB Data Types"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CEGJHFAF"></a>
<div id="OOFOL341" class="sect1">
<h2 class="sect1">OraParameters Object Overview</h2>
<p>The <code>OraParameters</code> object is a collection container for <code>OraParameter</code> objects. An <code>OraParameter</code> object is used to supply data values for placeholders used in the SQL statements or PL/SQL blocks at run time. It can be used to provide input values as well as contain values that are returned from the database. The following sample creates two parameter objects and uses them in an update query.</p>
<pre>
OraDatabase.Parameters.Add "SALARY", 4000, ORAPARM_INPUT 
OraDatabase.Parameters.Add "ENAME", "JONES", ORAPARM_INPUT 
Set updateStmt = OraDatabase.CreateSQL("update emp set sal = :SALARY" &amp; _ 
             "where ename = :ENAME ") 
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="serobjch030.htm#BABBFAHC">OraParameters Collection</a></div>
</div>
<!-- class="sect1" -->
<a id="CEGEJBAI"></a>
<div id="OOFOL342" class="sect1">
<h2 class="sect1">OraParameter Object Overview</h2>
<p><code>OraParameter</code> objects can contain values for all the data types supported by Oracle9<span class="italic">i</span> including object-relational data types. They can be passed as input or output arguments to PL/SQL stored procedures and functions. The values of the <code>OraParameter</code> objects can also represent PL/SQL cursors in the form of <code>OraDynaset</code> objects.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch020.htm#BABDIJAH">OraParameter Object</a></p>
</li>
<li>
<p><a href="basfeat.htm#CIHBJCED">"PL/SQL Support"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CEGDGCAH"></a>
<div id="OOFOL343" class="sect1">
<h2 class="sect1">OraParamArray Object Overview</h2>
<p>An <code>OraParamArray</code> object provides the mechanism for binding and fetching an array of values. It is typically used for performing bulk inserts and updates.</p>
<pre>
'Create a table 
OraDatabase.ExecuteSQL ("create table part_nos(partno number," &amp; _
             "description char(50), primary key(partno))") 
 
'Create two parameter arrays of size 10 to hold values for 
'part numbers (size 22 bytes), and their description (50 bytes long). 
OraDatabase.Parameters.AddTable "PARTNO", ORAPARM_INPUT, ORATYPE_NUMBER, 10, 22 
OraDatabase.Parameters.AddTable "DESCRIPTION", ORAPARM_INPUT, _ 
            ORATYPE_CHAR, 10, 50 
 
'Initialize the arrays 
For I = 0 To 10 
   OraDatabase.Parameters("PARTNO").put_Value = I, I 
   OraDatabase.Parameters("DESCRIPTION ") = "some description", I 
Next I 
 
'Execute the query 
Set OraSqlStmt = OraDatabase.CreateSql("insert into " &amp; _
            "part_nos(partno, description) values(:PARTNO,:DESCRIPTION)", 0&amp;)
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="serobjch019.htm#BABIDCFI">OraParamArray Object</a></div>
</div>
<!-- class="sect1" -->
<a id="CEGCFFII"></a>
<div id="OOFOL344" class="sect1">
<h2 class="sect1">OraSQLStmt Object Overview</h2>
<p>The <code>OraSQLStmt</code> object is typically used for executing non-select SQL queries and PL/SQL blocks. The following line of code executes an update query and displays the number of rows affected.</p>
<pre>
Set updateStmt = OraDatabase.CreateSQL("update emp set sal = 3000" &amp; _ 
                "where ename = 'JONES' ") 
MsgBox updateStmt.RecordCount 
</pre>
<p>The <code>OraSQLStmt</code> object (<code>updateStmt</code>) can be used later to execute the same query with a different value for the <code>:SALARY</code> placeholder. For example:</p>
<pre>
OraDatabase.Parameters("SALARY").value = 200000 
updateStmt.Parameters("ENAME").value = "KING" 
updateStmt.Refresh
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="serobjch024.htm#BABGAHBH">OraSQLStmt Object</a></div>
</div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="codewiz.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="serobjch.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
