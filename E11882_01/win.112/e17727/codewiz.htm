<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Code Wizard for Stored Procedures</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:30Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="quicktour.htm" title="Previous" type="text/html" />
<link rel="Next" href="apiintro.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">11/438</span> <!-- End Header -->
<div id="OOFOL0007" class="chapter"><a id="CHDJAGCH"></a>
<h1 class="chapter"><span class="secnum">7</span> Code Wizard for Stored Procedures<a id="sthref533"></a><a id="sthref534"></a><a id="sthref535"></a></h1>
<p>The Oracle Objects for OLE (OO4O) Code Wizard generates OO4O code that executes Oracle PL/SQL and Java stored procedures.</p>
<p>The wizard generates code into individual Microsoft Visual Basic or Active Server Page and VBScript subroutines from existing Oracle stored procedures and packages. Additionally, the wizard can generate complete implementations of COM Automation objects in the form of VB class files. The generated COM Automation object methods act as client stubs for the execution of stored procedures contained in a given package. All the OO4O code necessary for input/output parameter binding and stored procedure execution is automatically generated.</p>
<p>The wizard can be used as a command-line utility or as a Visual Basic add-in. The wizard automates the entire process of accessing stored procedures using COM interfaces, thereby significantly reducing development time and the likelihood of programming errors.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
The Code Wizard requires Visual Basic 6.</div>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#BABDFAHC">Oracle Objects for OLE Code Wizard Components</a></p>
</li>
<li>
<p><a href="#BABDHHHE">Data Types Supported by the OO4O Code Wizard</a></p>
</li>
<li>
<p><a href="#BABGGAAD">Using the OO4O Code Wizard</a></p>
</li>
<li>
<p><a href="#BABGIDGG">Code Wizard Examples</a></p>
</li>
</ul>
<a id="BABDFAHC"></a>
<div id="OOFOL319" class="sect1">
<h2 class="sect1">Oracle Objects for OLE Code Wizard Components<a id="sthref536"></a><a id="sthref537"></a></h2>
<p>The OO4O Code Wizard includes the following components:</p>
<ul>
<li>
<p>A command line utility, <code>OO4OCodeWiz.exe</code>, that converts PL/SQL and Java stored procedures to OO4O code.</p>
</li>
<li>
<p>A Visual Basic Add-in wizard that guides you through a series of steps to generate OO4O code for PL/SQL and Java stored procedures. The wizard displays Oracle packages and stored procedures from a tree control so that the user can choose which items to generate code.</p>
</li>
</ul>
<p>Both of these components allow users to convert entire stored procedure packages to OO4O code.</p>
</div>
<!-- class="sect1" -->
<a id="BABDHHHE"></a>
<div id="OOFOL320" class="sect1">
<h2 class="sect1">Data Types Supported by the OO4O Code Wizard<a id="sthref538"></a><a id="sthref539"></a></h2>
<p>The code wizard supports all data types, except for PL/SQL tables. When a PL/SQL table is used, an <code>unsupportedType</code> key word is used instead, and the generated code does not compile.</p>
<p>The output code may have to be modified for handling <code>Null</code> values. For example, when a VB variable is initialized to a parameter value, an <code>isNull()</code> check may have to be added if <code>Null</code> values are expected. <code>Null</code> values are correctly handled for VB variables of type <code>Variant</code> and <code>Object</code>.</p>
</div>
<!-- class="sect1" -->
<a id="BABGGAAD"></a>
<div id="OOFOL321" class="sect1">
<h2 class="sect1">Using the OO4O Code Wizard<a id="sthref540"></a><a id="sthref541"></a><a id="sthref542"></a><a id="sthref543"></a></h2>
<p>The OO4O Code Wizard can be used as a command line utility or as a Visual Basic Add-in.</p>
<div id="OOFOL322" class="sect2"><!-- infolevel="all" infotype="General" --><a id="sthref544"></a>
<h3 class="sect2">OO4O Code Wizard Command-Line Utility</h3>
<p>The <code>OO4OCodeWiz.exe</code> is a command-line utility that generates a Visual Basic class, a Visual Basic file, or an Active Server Page/VB Script file from existing PL/SQL or Java stored procedures, as well as packages, within an Oracle database. Call the utility in the following manner:</p>
<pre>
OO4OCodeWiz [-o output_file] <span class="italic">username</span>/<span class="codeinlineitalic">password</span>@<span class="codeinlineitalic">connect_string</span> package
</pre>
<div class="inftblinformal">
<table class="cellalignment2282" title="Code Wizard Command Line parameter list" summary="rows list the variables and placeholders. column 1 lists the name, and column 2 lists what is specifies" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t3">Where</th>
<th class="cellalignment2283" id="r1c2-t3">Specifies the following</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t3" headers="r1c1-t3"><code><span class="codeinlineitalic">username</span></code></td>
<td class="cellalignment2284" headers="r2c1-t3 r1c2-t3">User name to log in to the database</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t3" headers="r1c1-t3"><code><span class="codeinlineitalic">password</span></code></td>
<td class="cellalignment2284" headers="r3c1-t3 r1c2-t3">Password for the user name</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t3" headers="r1c1-t3"><code><span class="codeinlineitalic">connect_string</span></code></td>
<td class="cellalignment2284" headers="r4c1-t3 r1c2-t3">Database connection string</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t3" headers="r1c1-t3"><code><span class="codeinlineitalic">package</span></code></td>
<td class="cellalignment2284" headers="r5c1-t3 r1c2-t3">Package name</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r6c1-t3" headers="r1c1-t3"><code><span class="codeinlineitalic">stored_procedure</span></code></td>
<td class="cellalignment2284" headers="r6c1-t3 r1c2-t3">Stored procedure name (optional)</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="OOFOL323"></a>Example</p>
<pre>
OO4OCodeWiz -o empfile.asp scott/tiger@<span class="italic">Exampledb</span> employee.example 
</pre>
<p class="subhead2"><a id="OOFOL324"></a>Option</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="Code Wizard Command Line Utility Option List" summary="rows list the option. Column 1 lists the name, and column 2 lists what it specifies." dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t4">Option</th>
<th class="cellalignment2283" id="r1c2-t4">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t4" headers="r1c1-t4">-o</td>
<td class="cellalignment2284" headers="r2c1-t4 r1c2-t4">Specifies the output file name (optional)</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="OOFOL325"></a>Files Generated</p>
<p>The code wizard uses the information specified on the command line to determine which type of output file to generate.</p>
<p>If a file name and one of the permitted file extensions are specified, then they are used. In the preceding example, an ASP file is generated in the <code>empfile.asp</code> output. The user can specify the following extensions:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="Code Wizard Files Generated List" summary="rows are extensions. column one is name, column two file generated" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t5">Extension</th>
<th class="cellalignment2283" id="r1c2-t5">File Type Generated</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t5" headers="r1c1-t5"><code>.cls</code></td>
<td class="cellalignment2284" headers="r2c1-t5 r1c2-t5">VB class file</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t5" headers="r1c1-t5"><code>.bas</code></td>
<td class="cellalignment2284" headers="r3c1-t5 r1c2-t5">VB file</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t5" headers="r1c1-t5"><code>.asp</code></td>
<td class="cellalignment2284" headers="r4c1-t5 r1c2-t5">ASP or VB script file</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t5" headers="r1c1-t5"><code>.vbs</code></td>
<td class="cellalignment2284" headers="r5c1-t5 r1c2-t5">ASP or VB script file</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>If no file extension is specified, the following rules indicate what type of file is generated, depending on other command-line specifications.</p>
<ul>
<li>
<p>Package names without a stored procedure name generate a <code>.cls</code> file.</p>
</li>
<li>
<p>Package names with procedure names generate a <code>.bas</code> file.</p>
</li>
</ul>
<p><a href="#CIHEAFEI">Table 7-1</a> and <a href="#CIHCGBGC">Table 7-2</a> provide examples.</p>
<div id="OOFOL326" class="tblformal">
<p class="titleintable"><a id="sthref545"></a><a id="CIHEAFEI"></a>Table 7-1 Package Name Without Stored Procedure Name</p>
<table class="cellalignment2287" title="Package Name Without Stored Procedure Name" summary="rows are what is specified. column one is what filename if any is specified, column 2 is what the command generates, and column three is the type file" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t6">File Specified</th>
<th class="cellalignment2283" id="r1c2-t6">Command</th>
<th class="cellalignment2283" id="r1c3-t6">File Type Generated</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t6" headers="r1c1-t6">
<p>File name with no file extension generates <code><span class="codeinlineitalic">filename.cls</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r2c1-t6 r1c2-t6">
<p><code>OO4OCodeWiz</code> <code>-o</code> <code>empfile</code> <code><span class="codeinlineitalic">scott/tiger@Exampledb</span></code> <code>employee</code></p>
</td>
<td class="cellalignment2284" headers="r2c1-t6 r1c3-t6">
<p><code>empfile.cls</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t6" headers="r1c1-t6">
<p>No file name or extension: generates <code><span class="codeinlineitalic">packagename.cls</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r3c1-t6 r1c2-t6">
<p><code>OO4OCodeWiz</code> <code>scott/tiger@Exampledb</code> <code><span class="codeinlineitalic">employee</span></code></p>
</td>
<td class="cellalignment2284" headers="r3c1-t6 r1c3-t6">
<p><code><span class="codeinlineitalic">employee</span></code><code>.cls</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t6" headers="r1c1-t6">
<p>File name with file extension generates <code><span class="codeinlineitalic">filename.fileexten</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r4c1-t6 r1c2-t6">
<p><code>OO4OCodeWiz</code> <code>-o</code> <code>empfile.asp</code> <code>scott/tiger@Exampledb</code> <code><span class="codeinlineitalic">employee</span></code></p>
</td>
<td class="cellalignment2284" headers="r4c1-t6 r1c3-t6">
<p><code>empfile.asp</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<div id="OOFOL327" class="tblformal">
<p class="titleintable"><a id="sthref546"></a><a id="CIHCGBGC"></a>Table 7-2 Package Name With Stored Procedure Name</p>
<table class="cellalignment2287" title="Package Name With Stored Procedure Name" summary="rows are what is specified. column one is what filename if any is specified, column 2 is what the command generates, and column three is the type file" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t7">File Specified</th>
<th class="cellalignment2283" id="r1c2-t7">Command</th>
<th class="cellalignment2283" id="r1c3-t7">File Type Generated</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t7" headers="r1c1-t7">
<p>File name with no file extension generates <code><span class="codeinlineitalic">filename.bas</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r2c1-t7 r1c2-t7">
<p><code>OO4OCodeWiz</code> <code>-o</code> <code>empfile</code> <code>scott/tiger@Exampledb</code> <code><span class="codeinlineitalic">employee</span></code><code>.example</code></p>
</td>
<td class="cellalignment2284" headers="r2c1-t7 r1c3-t7">
<p><code>empfile.bas</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t7" headers="r1c1-t7">
<p>No file name or extension: generates <code><span class="codeinlineitalic">packagename.bas</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r3c1-t7 r1c2-t7">
<p><code>OO4OCodeWiz</code> <code>scott/tiger@Exampledb</code> <code><span class="codeinlineitalic">employee</span></code><code>.example</code></p>
</td>
<td class="cellalignment2284" headers="r3c1-t7 r1c3-t7">
<p><code><span class="codeinlineitalic">employee</span></code><code>.bas</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t7" headers="r1c1-t7">
<p>File name with file extension generates <code><span class="codeinlineitalic">filename.fileexten</span></code>.</p>
</td>
<td class="cellalignment2284" headers="r4c1-t7 r1c2-t7">
<p><code>OO4OCodeWiz</code> <code>-o</code> <code>empfile.asp</code> <code>scott/tiger@Exampledb</code> <code><span class="codeinlineitalic">employee</span></code><code>.example</code></p>
</td>
<td class="cellalignment2284" headers="r4c1-t7 r1c3-t7">
<p><code>empfile.asp</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="sect2" -->
<div id="OOFOL328" class="sect2"><a id="sthref547"></a>
<h3 class="sect2">OO4O Code Wizard Visual Basic Wizard Add-in<a id="sthref548"></a><a id="sthref549"></a></h3>
<ol>
<li>
<p>Launch the OO4O Code Wizard by selecting Oracle Code Wizard for Stored Procedures in the Add-Ins menu of Microsoft Visual Basic.</p>
<p>The <span class="bold">Connect To Oracle Database</span> dialog box appears:</p>
<img width="316" height="184" src="img/connect.gif" alt="the Connect dialog box" /><br />
<a id="sthref550" href="img_text/connect.htm">Description of the illustration connect.gif</a><br />
<br /></li>
<li>
<p>Enter the user name and password to connect to the database. A connection string is required if the database is not installed on the user's local computer.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>The wizard displays the Oracle packages and stored procedures available to the user in a tree.</p>
<img width="340" height="513" src="img/wizproc.gif" alt="OO4O Code Wizard for Stored Procedures dialog box" /><br />
<a id="sthref551" href="img_text/wizproc.htm">Description of the illustration wizproc.gif</a><br />
<br /></li>
<li>
<p>Select one of the stored procedures or packages displayed.</p>
</li>
<li>
<p>Enter an output file name or click the <span class="bold">Browse...</span> button to navigate to a different directory in which to place the file.</p>
</li>
<li>
<p>Choose the file type from the <span class="bold">Component type</span> list. There are three choices: a VB class module (<code>*.cls</code>), a VB file (<code>*.bas</code>), or other. The <span class="bold">other</span> option generates a VB file (<code>*.bas</code>), but enables you to specify your own file extension.</p>
</li>
<li>
<p>Click <span class="bold">OK</span>.</p>
<p>A dialog box appears indicating that a new OO4O file was created.</p>
</li>
<li>
<p>Click <span class="bold">Yes</span> to create another file, or click <span class="bold">No</span> to return to Visual Basic.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="BABGIDGG"></a>
<div id="OOFOL329" class="sect1">
<h2 class="sect1">Code Wizard Examples<a id="sthref552"></a><a id="sthref553"></a><a id="sthref554"></a></h2>
<p>The <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o\codewiz\samples</code> directory contains sample applications incorporating code generated by the wizard. The following examples show the generated VB code output from Oracle stored procedures using the OO4O code wizard:</p>
<ul>
<li>
<p><a href="#BABJFGJA">Accessing a PL/SQL Stored Function with Visual Basic and Active Server Pages</a></p>
</li>
<li>
<p><a href="#BABBCACH">Accessing a PL/SQL Stored Procedure Using the LOB Type with Visual Basic</a></p>
</li>
<li>
<p><a href="#BABCJCIB">Accessing a PL/SQL Stored Procedure Using the VARRAY Type with Visual Basic</a></p>
</li>
<li>
<p><a href="#BABJCACJ">Accessing a PL/SQL Stored Procedure Using the Oracle OBJECT Type with Visual Basic</a></p>
</li>
</ul>
<a id="BABJFGJA"></a>
<div id="OOFOL330" class="sect2">
<h3 class="sect2">Accessing a PL/SQL Stored Function with Visual Basic and Active Server Pages</h3>
<p>This example shows a PL/SQL stored function, <code>GetEmpSal</code>, and then the Visual Basic (<code>*.cls</code>) file that the code wizard generates for it.</p>
<pre>
FUNCTION GetEmpSal (inEmpno IN NUMBER)
RETURN NUMBER is 
  outEmpsal NUMBER(7,2);
BEGIN 
  SELECT SAL into outEmpsal from EMP WHERE EMPNO = inEmpno;
  RETURN (outEmpsal);
END;
</pre>
<p>The generated code for the <code>GetEmpSal</code> stored function is:</p>
<pre>
Public Function GETEMPSAL(INEMPNO As Variant) As Variant 
OraDatabase.Parameters.Add "INEMPNO", INEMPNO, ORAPARM_INPUT, 2 
OraDatabase.Parameters.Add "result", 0, ORAPARM_OUTPUT 
OraDatabase.Parameters("result").serverType = 2 
OraDatabase.ExecuteSQL ("declare result Number; Begin :result := " &amp; _
              "Employee.GETEMPSAL(:INEMPNO); end;")  
 
OraDatabase.Parameters.Remove "INEMPNO" 
GETEMPSAL = OraDatabase.Parameters("result").Value 
OraDatabase.Parameters.Remove "result" 
End Function 
</pre>
<p>In a VB class, <code>OraDatabase</code> appears as an attribute of the class. This attribute has to be set before any methods of the class can be invoked. For a VB file (<code>*.bas</code>), the generated code for the <code>GetEmpSal</code> stored function is the same as the VB class file, except for the function declaration:</p>
<pre>
Public Function GETEMPSAL(INEMPNO As Variant, ByRef OraDatabase As OraDatabase)
... 
 
End Function 
</pre>
<p>For an ASP file (<code>*.asp</code>), the function declaration also differs for the <code>GetEmpSal</code> stored function as follows, but the body of the code remains the same:</p>
<pre>
Public Function GETEMPSAL(INEMPNO, ByRef OraDatabase) 
... 
End Function 
</pre></div>
<!-- class="sect2" -->
<a id="BABBCACH"></a>
<div id="OOFOL331" class="sect2">
<h3 class="sect2">Accessing a PL/SQL Stored Procedure Using the LOB Type with Visual Basic</h3>
<p>The following example shows how a Visual Basic file accesses a PL/SQL stored procedure with LOBs:</p>
<pre>
PROCEDURE getchapter(chapno in NUMBER, chap out CLOB) is
BEGIN 
SELECT chapters into chap from mybook where chapterno = chapno
   for update;
END;
</pre>
<p>The following shows the generated Visual Basic code for the <code>GETCHAPTER</code> stored procedure:</p>
<pre>
Public Sub GETCHAPTER(CHAPNO As Variant, ByRef CHAP As OraCLOB) 
OraDatabase.Parameters.Add "CHAPNO", CHAPNO, ORAPARM_INPUT, 2 
OraDatabase.Parameters.Add "CHAP", Null, ORAPARM_OUTPUT, 112 
OraDatabase.ExecuteSQL ("Begin MYBOOKPKG.GETCHAPTER(:CHAPNO,:CHAP); end;") 
Set CHAP = OraDatabase.Parameters("CHAP").Value 
OraDatabase.Parameters.Remove "CHAPNO" 
OraDatabase.Parameters.Remove "CHAP" 
End Sub 
</pre></div>
<!-- class="sect2" -->
<a id="BABCJCIB"></a>
<div id="OOFOL332" class="sect2">
<h3 class="sect2">Accessing a PL/SQL Stored Procedure Using the VARRAY Type with Visual Basic</h3>
<p>The following example shows how a PL/SQL stored procedure uses the Oracle collection type <code>VARRAY</code>:</p>
<pre>
PROCEDURE getnames(deptid in NUMBER, name out ENAMELIST) is 
BEGIN 
    SELECT ENAMES into name from department where dept_id = deptid for update; 
END;
 
</pre>
<p>The wizard generates the following Visual Basic code for this stored procedure:</p>
<pre>
Public Sub GETNAMES(DEPTID As Variant, ByRef NAME As OraCollection) 
OraDatabase.Parameters.Add "DEPTID", DEPTID, ORAPARM_INPUT, 2 
OraDatabase.Parameters.Add "NAME", Null, ORAPARM_OUTPUT, 247, "ENAMELIST" 
OraDatabase.ExecuteSQL ("Begin DEPTPKG.GETNAMES(:DEPTID, :NAME); end;") 
Set NAME = OraDatabase.Parameters("NAME").Value 
OraDatabase.Parameters.Remove "DEPTID" 
OraDatabase.Parameters.Remove "NAME" 
End Sub 
</pre></div>
<!-- class="sect2" -->
<a id="BABJCACJ"></a>
<div id="OOFOL333" class="sect2">
<h3 class="sect2">Accessing a PL/SQL Stored Procedure Using the Oracle OBJECT Type with Visual Basic</h3>
<p>The following example shows how a PL/SQL stored procedure uses the Oracle object type:</p>
<pre>
PROCEDURE getaddress(person_name in varchar2, person_address out address) is 
BEGIN 
     SELECT addr into person_address from person_table where name = 
           person_name for update; 
END; 
</pre>
<p>The wizard generates the following Visual Basic code for this stored procedure:</p>
<pre>
Public Sub GETADDRESS(PERSON_NAME As String, ByRef PERSON_ADDRESS As OraObject)
OraDatabase.Parameters.Add "PERSON_NAME", PERSON_NAME, ORAPARM_INPUT, 1 
OraDatabase.Parameters.Add "PERSON_ADDRESS", Null, ORAPARM_OUTPUT, _ 
            108, "ADDRESS" 
OraDatabase.ExecuteSQL ("Begin PERSONPKG.GETADDRESS(:PERSON_NAME," &amp; _  
            ":PERSON_ADDRESS); end;") 
Set PERSON_ADDRESS = OraDatabase.Parameters("PERSON_ADDRESS").Value 
OraDatabase.Parameters.Remove "PERSON_NAME" 
OraDatabase.Parameters.Remove "PERSON_ADDRESS" 
End Sub 
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="chapter" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="quicktour.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="apiintro.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
