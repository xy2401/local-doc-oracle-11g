<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>Add Method</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:32Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod001.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod003.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">48/438</span> <!-- End Header --><a id="CIHJHFAG"></a>
<hr />
<div id="OOFOL426" class="refsect1">
<h1 class="refsect1">Add Method</h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref729"></a>Applies To</p>
<p><a href="serobjch030.htm#BABBFAHC">OraParameters Collection</a></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref730"></a>Description</p>
<p>Adds a parameter to the <code>OraParameters</code> collection.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref731"></a>Usage</p>
<pre>
oraparameters.Add <span class="italic">Name</span>, <span class="italic">Value</span>, <span class="italic">IOType</span>, <span class="italic">ServerType</span>, <span class="italic">ObjectName</span> 
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref732"></a>Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="Add method parameter list" summary="rows are arguments. column 1 i s name and column 2 is description." dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t2">Arguments</th>
<th class="cellalignment2283" id="r1c2-t2">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t2" headers="r1c1-t2"><code><span class="codeinlineitalic">Name</span></code></td>
<td class="cellalignment2284" headers="r2c1-t2 r1c2-t2">The name of the parameter to be added to the parameters collection. This name is issued both for parameter identification and as the placeholder in associated SQL and PL/SQL statements.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t2" headers="r1c1-t2"><code><span class="codeinlineitalic">Value</span></code></td>
<td class="cellalignment2284" headers="r3c1-t2 r1c2-t2">A <code>Variant</code> specifying the initial value of the parameter. The initial value of the parameter is significant; it defines the data type of the parameter.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t2" headers="r1c1-t2"><code><span class="codeinlineitalic">IOType</span></code></td>
<td class="cellalignment2284" headers="r4c1-t2 r1c2-t2">An integer code specifying how the parameter is to be used in SQL statements and PL/SQL blocks.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t2" headers="r1c1-t2"><code><span class="codeinlineitalic">ServerType</span></code></td>
<td class="cellalignment2284" headers="r5c1-t2 r1c2-t2">Specifies Oracle Database type to which this parameter is to be bound. This is required when binding to <code>BLOB</code>, <code>CLOB</code>, <code>BFILE</code>, <code>OBJECT</code>, <code>REF</code>, <code>NESTED</code> <code>TABLE</code>, or <code>VARRAY</code>. For a list of possible values, see the <code>OraParameter</code> <a href="serprop115.htm#CHDDFGIE">"ServerType Property"</a>.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r6c1-t2" headers="r1c1-t2"><code><span class="codeinlineitalic">ObjectName</span></code></td>
<td class="cellalignment2284" headers="r6c1-t2 r1c2-t2">A case-sensitive string containing the name of the <code>Object</code>. This is only required if <code><span class="codeinlineitalic">ServerType</span></code> is <code>ORATYPE_OBJECT</code>, <code>ORATYPE_VARRAY</code>, or <code>ORATYPE_TABLE</code>. <code><span class="codeinlineitalic">ServerType</span></code> is required for <code>ORATYPE_REF</code> when the <code>REF</code> is used in PL/SQL.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="refsubsect" -->
<p class="subhead2"><a id="OOFOL427"></a>IOType Settings</p>
<p>The <code><span class="codeinlineitalic">IOType</span></code> settings are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="IOType Settings" summary="rows are IOType settings. column 1 are names, column 2 values, column 3 descriptions" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t3">Settings</th>
<th class="cellalignment2283" id="r1c2-t3">Values</th>
<th class="cellalignment2283" id="r1c3-t3">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t3" headers="r1c1-t3"><code>ORAPARM_INPUT</code></td>
<td class="cellalignment2284" headers="r2c1-t3 r1c2-t3">1</td>
<td class="cellalignment2284" headers="r2c1-t3 r1c3-t3">Used for input variables only</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t3" headers="r1c1-t3"><code>ORAPARM_OUTPUT</code></td>
<td class="cellalignment2284" headers="r3c1-t3 r1c2-t3">2</td>
<td class="cellalignment2284" headers="r3c1-t3 r1c3-t3">Used for output variables only</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t3" headers="r1c1-t3"><code>ORAPARM_BOTH</code></td>
<td class="cellalignment2284" headers="r4c1-t3 r1c2-t3">3</td>
<td class="cellalignment2284" headers="r4c1-t3 r1c3-t3">Used for variables that are both input and output</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file.</p>
<p>By default, the maximum size of the <code>ORAPARM_OUTPUT</code> variable for <code>ServerType</code> <code>VAR</code>, <code>VARCHAR2</code>, and <code>ORATYPE_RAW_BIN</code> is set to 128 bytes. Use the <code>MinimumSize</code> property to change this value. The minimum size of an <code>ORAPARM_OUTPUT</code> variable for <code>VAR</code> and <code>VARCHAR2</code> must always be greater than the size of the expected data from the database column.</p>
<p>Verify that this value is correct. If you set an incorrect option, such as <code>ORAPARM_BOTH</code> for the <code>IN</code> stored procedure parameter type, this can result in errors. <code>ORAPARM_BOTH</code> is for <code>IN</code> and <code>OUT</code> parameters only. It is not used against one stored procedure that has an <code>IN</code> parameter and another that has an <code>OUT</code> parameter. For this case, use two parameters. Errors caused this way are rare, if there is a parameter-related error, verify that the <code><span class="codeinlineitalic">IOType</span></code> is correct.</p>
<p>The <code><span class="codeinlineitalic">Value</span></code> argument can be an Oracle Database 10<span class="italic">g</span> object, such as an <code>OraBLOB</code>. Note that a copy of the object is made at that point in time and the <code>Value</code> property must be accessed to obtain a new object that refers to the value of the parameter. For example, if <code><span class="codeinlineitalic">IOType</span></code> is <code>ORATYPE_BOTH</code> and an <code>OraBLOB</code> obtained from a dynaset is passed in as the input value, the <code>Parameter</code> <code>Value</code> property needs to be accessed one time after the SQL has been executed to obtain the newly updated output value of the parameter. The object is obtained from the parameter in the same manner as from a dynaset.</p>
<p>The <code>Value</code> property always refers to the latest value of the parameter. The Visual Basic value <code>Null</code> can also be passed as a value. The Visual Basic <code>EMPTY</code> value can be used for <code>BLOB</code> and <code>CLOB</code> data types to mean an empty LOB, and the <code>EMPTY</code> value can be used for <code>OBJECT</code>, <code>VARRAY</code>, and <code>NESTED</code> <code>TABLE</code> data types to mean an object whose attributes are all <code>Null</code>.</p>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref733"></a>Remarks</p>
<p>Use parameters to represent SQL bind variables (as opposed to rebuilding the SQL statement). SQL bind variables are useful because you can change a parameter value without having to parse the query again. Use SQL bind variables only as input variables.</p>
<p>You can also use parameters to represent PL/SQL bind variables. You can use PL/SQL bind variables as both input and output variables.</p>
<p>The <code>ORATYPE_RAW_BIN</code> <code>ServerType</code> value is used when binding to Oracle <code>Raw</code> columns. A byte array is used to <code>Put</code> or <code>Get</code> values. The maximum allowable size of an <code>ORATYPE_RAW_BIN</code> bind buffers is 2000 bytes when bound to a column of a table and 32 KB when bound to a stored procedure. For example code, see the samples in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\OO4O\VB\Raw</code> directory.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref734"></a>Examples</p>
<p>This example demonstrates using the <code>Add</code> and <code>Remove</code> parameter methods, the <code>ServerType</code> parameter property, and the <code>ExecuteSQL</code> database method to call a stored procedure and function (located in <code>ORAEXAMP.SQL</code>). Copy and paste this code into the definition section of a form. Then, press <span class="bold">F5</span>.</p>
<pre>
Sub Form_Load () 
 
'Declare variables 
Dim OraSession As OraSession 
Dim OraDatabase As OraDatabase 
 
'Create the OraSession Object. 
Set OraSession = CreateObject("OracleInProcServer.XOraSession") 
 
'Create the OraDatabase Object. 
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;) 
 
'Add EMPNO as an Input/Output parameter and set its initial value. 
OraDatabase.Parameters.Add "EMPNO", 7369, ORAPARM_INPUT 
OraDatabase.Parameters("EMPNO").ServerType = ORATYPE_NUMBER 
 
'Add ENAME as an Output parameter and set its initial value. 
OraDatabase.Parameters.Add "ENAME", 0, ORAPARM_OUTPUT 
OraDatabase.Parameters("ENAME").ServerType = ORATYPE_VARCHAR2 
 
'Add SAL as an Output parameter and set its initial value. 
OraDatabase.Parameters.Add "SAL", 0, ORAPARM_OUTPUT 
OraDatabase.Parameters("SAL").ServerType = ORATYPE_NUMBER 
 
'Execute the Stored Procedure Employee.GetEmpName to retrieve ENAME. 
' This Stored Procedure can be found in the file ORAEXAMP.SQL. 
OraDatabase.ExecuteSQL ("Begin Employee.GetEmpName (:EMPNO, :ENAME); end;")
'Display the employee number and name. 
 
'Execute the Stored Function Employee.GetSal to retrieve SAL. 
' This Stored Function can be found in the file ORAEXAMP.SQL. 
OraDatabase.ExecuteSQL ("declare SAL number(7,2); Begin" &amp; _
           ":SAL:=Employee.GetEmpSal (:EMPNO); end;") 
 
'Display the employee name, number and salary. 
MsgBox "Employee " &amp; OraDatabase.Parameters("ENAME").value &amp; ", #" &amp; _
          OraDatabase.Parameters("EMPNO").value &amp; ",Salary=" &amp; _
          OraDatabase.Parameters("SAL").value 
 
'Remove the Parameters. 
OraDatabase.Parameters.Remove "EMPNO" 
OraDatabase.Parameters.Remove "ENAME" 
OraDatabase.Parameters.Remove "SAL" 
 
End Sub 
</pre></div>
<!-- class="refsubsect" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch020.htm#BABDIJAH">OraParameter Object</a></p>
</li>
<li>
<p><a href="sermthod151.htm#CIHGDBFG">Remove Method</a></p>
</li>
<li>
<p><a href="serprop115.htm#CHDDFGIE">ServerType Property</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="sermthod001.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="sermthod003.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
