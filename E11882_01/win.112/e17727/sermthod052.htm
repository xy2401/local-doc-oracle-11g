<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>CreateCustomDynaset Method</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:45Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod051.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod053.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">98/438</span> <!-- End Header --><a id="CIHBAFHG"></a>
<hr />
<div id="OOFOL490" class="refsect1">
<h1 class="refsect1">CreateCustomDynaset Method</h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref981"></a>Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref982"></a>Description</p>
<p>Creates a dynaset using custom cache and fetch parameters</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref983"></a>Usage</p>
<pre>
Set oradynaset = oradatabase.CreateCustomDynaset(<span class="italic">sql_statement</span>, <span class="italic">options</span>, <span class="italic">slicesize</span>, <span class="italic">perblock</span>, <span class="italic">blocks</span>, <span class="italic">FetchLimit</span>, <span class="italic">FetchSize</span>, <span class="italic">SnapShotID</span>)
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref984"></a>Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="CreateCustomDynaset method parameter list" summary="Rows are arguments, column 1 names, column 2 descriptions" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t61">Arguments</th>
<th class="cellalignment2283" id="r1c2-t61">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">sql_statement</span></code></td>
<td class="cellalignment2284" headers="r2c1-t61 r1c2-t61">Any valid Oracle SQL <code>SELECT</code> statement.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">slicesize</span></code></td>
<td class="cellalignment2284" headers="r3c1-t61 r1c2-t61">Cache slice size.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">perblock</span></code></td>
<td class="cellalignment2284" headers="r4c1-t61 r1c2-t61">Cache slices for each block.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">blocks</span></code></td>
<td class="cellalignment2284" headers="r5c1-t61 r1c2-t61">Cache maximum number of blocks.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r6c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">FetchLimit</span></code></td>
<td class="cellalignment2284" headers="r6c1-t61 r1c2-t61">Fetch array size.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r7c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">FetchSize</span></code></td>
<td class="cellalignment2284" headers="r7c1-t61 r1c2-t61">Fetch array buffer size.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r8c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">options</span></code></td>
<td class="cellalignment2284" headers="r8c1-t61 r1c2-t61">A bit flag indicating the status of any optional states of the dynaset. You can combine one or more options by adding their respective values. Specifying the constant <code>ORADYN_DEFAULT</code> or the value <code>&amp;H0&amp;</code> gives the following defaults for the dynaset:
<ul>
<li>
<p>Behave like Visual Basic Mode for a database: Field values not explicitly set are set to <code>Null</code>, overriding database column defaults.</p>
</li>
<li>
<p>Perform automatic binding of database parameters.</p>
</li>
<li>
<p>Remove trailing blanks from character string data retrieved from the database.</p>
</li>
<li>
<p>Create an updatable dynaset.</p>
</li>
<li>
<p>Cache data on the client.</p>
</li>
<li>
<p>Force a <code>MoveFirst</code> operation when the dynaset is created.</p>
</li>
<li>
<p>Maintain read-consistency.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r9c1-t61" headers="r1c1-t61"><code><span class="codeinlineitalic">SnapShotID</span></code> [optional]</td>
<td class="cellalignment2284" headers="r9c1-t61 r1c2-t61">The ID of a Snapshot obtained from the <code>SnapShot</code> property of an <code>OraDynaset</code>.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="OOFOL491"></a>Constants</p>
<p>The following table lists constants and values for the options flag.</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="CreateCustomDynaset Constants" summary="Rows are arguments, column 1 names, column 2 descriptions" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t62">Constant</th>
<th class="cellalignment2283" id="r1c2-t62">Value</th>
<th class="cellalignment2283" id="r1c3-t62">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t62" headers="r1c1-t62"><code>ORADYN_DEFAULT</code></td>
<td class="cellalignment2284" headers="r2c1-t62 r1c2-t62"><code>&amp;H0&amp;</code></td>
<td class="cellalignment2284" headers="r2c1-t62 r1c3-t62">Accept the default behavior.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t62" headers="r1c1-t62"><code>ORADYN_NO_AUTOBIND</code></td>
<td class="cellalignment2284" headers="r3c1-t62 r1c2-t62"><code>&amp;H1&amp;</code></td>
<td class="cellalignment2284" headers="r3c1-t62 r1c3-t62">Do not perform automatic binding of database parameters.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t62" headers="r1c1-t62"><code>ORADYN_NO_BLANKSTRIP</code></td>
<td class="cellalignment2284" headers="r4c1-t62 r1c2-t62"><code>&amp;H2&amp;</code></td>
<td class="cellalignment2284" headers="r4c1-t62 r1c3-t62">Do not remove trailing blanks from character string data retrieved from the database.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t62" headers="r1c1-t62"><code>ORADYN_READONLY</code></td>
<td class="cellalignment2284" headers="r5c1-t62 r1c2-t62"><code>&amp;H4&amp;</code></td>
<td class="cellalignment2284" headers="r5c1-t62 r1c3-t62">Force dynaset to be read-only.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r6c1-t62" headers="r1c1-t62"><code>ORADYN_NOCACHE</code></td>
<td class="cellalignment2284" headers="r6c1-t62 r1c2-t62"><code>&amp;H8&amp;</code></td>
<td class="cellalignment2284" headers="r6c1-t62 r1c3-t62">Do not create a local dynaset data cache. Without the local cache, previous rows within a dynaset are unavailable; however, increased performance results during retrieval of data from the database (move operations) and from the rows (field operations). Use this option in applications that make single passes through the rows of a dynaset for increased performance and decreased resource usage.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r7c1-t62" headers="r1c1-t62"><code>ORADYN_ORAMODE</code></td>
<td class="cellalignment2284" headers="r7c1-t62 r1c2-t62"><code>&amp;H10&amp;</code></td>
<td class="cellalignment2284" headers="r7c1-t62 r1c3-t62">Same as Oracle Mode for a database except it affects only the dynaset being created. If database was created in Oracle Mode, the dynaset inherits the property from it (for compatibility).</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r8c1-t62" headers="r1c1-t62"><code>ORADYN_NO_REFETCH</code></td>
<td class="cellalignment2284" headers="r8c1-t62 r1c2-t62"><code>&amp;H20&amp;</code></td>
<td class="cellalignment2284" headers="r8c1-t62 r1c3-t62">Behaves same as <code>ORADB_NO_REFETCH</code> mode for a database except this mode affects only the dynaset being created. If the database was created in <code>ORADB_NO_REFETCH</code> mode, the dynaset inherits the property for compatibility.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r9c1-t62" headers="r1c1-t62"><code>ORADYN_N_MOVEFIRST</code></td>
<td class="cellalignment2284" headers="r9c1-t62 r1c2-t62"><code>&amp;H40&amp;</code></td>
<td class="cellalignment2284" headers="r9c1-t62 r1c3-t62">Does not force a <code>MoveFirst</code> when the dynaset is created. <code>BOF</code> and <code>EOF</code> are both true.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r10c1-t62" headers="r1c1-t62"><code>ORADYN_DIRTY_WRITE</code></td>
<td class="cellalignment2284" headers="r10c1-t62 r1c2-t62"><code>&amp;H80&amp;</code></td>
<td class="cellalignment2284" headers="r10c1-t62 r1c3-t62"><code>Update</code> and <code>Delete</code> methods do not check for read consistency.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file located in:</p>
<p><code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\rdbms\oo4o</code></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref985"></a>Remarks</p>
<p>The SQL statement must be a <code>SELECT</code> statement or an error is returned. Features such as simple views and synonyms can be used freely. You can also use schema references, column aliases, table joins, nested select statements, and remote database references, but in each case you end up with a read-only dynaset.</p>
<p>If you use a complex expression or SQL function on a column, such as <code>"sal + 100"</code> or <code>"abs(sal)"</code> , you get an updatable dynaset, but the column associated with the complex expression is not updatable.</p>
<p>Object names generally are not modifed, but in certain cases, they can be changed. For example, if you use a column alias, you must use the alias to refer to the field by name. If you use spaces in a complex expression, you must refer to the column without the spaces, because the database removes spaces. Note that you can always refer to a field by number, that is, by its ordinal position in the <code>SELECT</code> statement.</p>
<p>Executing the SQL <code>SELECT</code> statement generates a commit operation to the database by default. To avoid this, use the <code>BeginTrans</code> method on the session object before using the <code>CreateDynaset</code> method.</p>
<p>The updatability of the resultant dynaset depends on the Oracle SQL rules of updatability, on the access you have been granted, and on the options flag.</p>
<p class="subhead2"><a id="OOFOL492"></a>Updatability Conditions</p>
<p>For the dynaset to be updatable, three conditions must be met:</p>
<ul>
<li>
<p>A SQL statement must refer to a simple column list or to the entire column list (*).</p>
</li>
<li>
<p>The statement must not set the read-only flag of the options argument.</p>
</li>
<li>
<p>Oracle must permit <code>ROWID</code> references to the selected rows of the query.</p>
</li>
</ul>
<p>Any SQL statement that does not meet these criteria is processed, but the results are not updatable and the <code>Updatable</code> property of the dynaset returns <code>False</code>.</p>
<p>This method automatically moves to the first row of the created dynaset.</p>
<p>You can use SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref986"></a>Examples</p>
<p>This example demonstrates the <code>CreateCustomDynaset</code> method. Copy and paste this code into the definition section of a form, then press <span class="bold">F5</span>.</p>
<pre>
Sub Form_Load ()
 
 'Declare variables
 Dim OraSession As OraSession 
 Dim OraDatabase As OraDatabase 
 Dim OraDynaset As OraDynaset 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object by opening a connection to Oracle.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;) 
 
 'Create the OraDynaset Object using sliceSize as 256,perblock size as 16, no. of 
 'blocks as 20, fetchLimit as 20,FetchSize as 4096
  
 Set OraDynaset = OraDatabase.CreateCustomDynaset("select empno, " &amp; _ 
               "ename from emp", 0&amp;,256,16,20,20,4096)
 
 'Display the first record.
 MsgBox "Employee " &amp; OraDynaset.Fields("empno").value &amp; ", #" &amp; _ 
                OraDynaset.Fields("ename").value
 
End Sub
</pre></div>
<!-- class="refsubsect" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="serprop121.htm#CHDCIJJD">SnapShot Property</a></div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="sermthod051.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="sermthod053.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
