<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>CreateSQL Method</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:49Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod065.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod067.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">112/438</span> <!-- End Header --><a id="BHBDJJIG"></a>
<hr />
<div id="OOFOL512" class="refsect1">
<h1 class="refsect1">CreateSQL Method</h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1067"></a>Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1068"></a>Description</p>
<p>Executes the SQL statement and creates an <code>OraSQLStmt</code> object from the specified SQL statement and options.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1069"></a>Usage</p>
<pre>
Set orasqlstmt = oradatabase.CreateSQL(<span class="italic">sql_statement</span>, <span class="italic">options</span>)
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1070"></a>Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="CreateSQL method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t90">Arguments</th>
<th class="cellalignment2283" id="r1c2-t90">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t90" headers="r1c1-t90"><code><span class="codeinlineitalic">sql_statement</span></code></td>
<td class="cellalignment2284" headers="r2c1-t90 r1c2-t90">Any valid Oracle SQL statement.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t90" headers="r1c1-t90"><code><span class="codeinlineitalic">options</span></code></td>
<td class="cellalignment2284" headers="r3c1-t90 r1c2-t90">A bit flag indicating the status of any optional states of the <code>OraSQLStmt</code> object. You can combine one or more options by adding their respective values.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="subhead2"><a id="OOFOL513"></a>Constants</p>
<p>The options flag values are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="CreateSQL constants" summary="rows are constants. column 1 is name, column 2 value, column 3 description" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t91">Constant</th>
<th class="cellalignment2283" id="r1c2-t91">Value</th>
<th class="cellalignment2283" id="r1c3-t91">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t91" headers="r1c1-t91"><code>ORASQL_NO_AUTOBIND</code></td>
<td class="cellalignment2284" headers="r2c1-t91 r1c2-t91"><code>&amp;H1&amp;</code></td>
<td class="cellalignment2284" headers="r2c1-t91 r1c3-t91">Do not perform automatic binding of database parameters.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t91" headers="r1c1-t91"><code>ORASQL_FAILEXEC</code></td>
<td class="cellalignment2284" headers="r3c1-t91 r1c2-t91"><code>&amp;H2&amp;</code></td>
<td class="cellalignment2284" headers="r3c1-t91 r1c3-t91">Raise error and do not create SQL statement object.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t91" headers="r1c1-t91"><code>ORASQL_NONBLK</code></td>
<td class="cellalignment2284" headers="r4c1-t91 r1c2-t91"><code>&amp;H4&amp;</code></td>
<td class="cellalignment2284" headers="r4c1-t91 r1c3-t91">Execute SQL in a nonblocking state.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1071"></a>Remarks</p>
<p>The SQL statement can be one continuous line with no breaks. If it is necessary to break the line, be sure to use line feeds (ASCII 10). Do not use carriage returns (ASCII 13), because the underlying Oracle Database functions treat carriage returns as null terminators.</p>
<p>You can use PL/SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
<p>Executing the SQL statement generates a commit to the database by default. To avoid this, use the <code>BeginTrans</code> method on the session object before using the <code>CreateSQL</code> method.</p>
<p>When executing PL/SQL blocks or calling stored procedures, you must include a <code>BEGIN</code> and <code>END</code> statement around your call as if you were executing an anonymous PL/SQL block. This is equivalent to the <code>EXECUTE</code> command of SQL*Plus and SQL*DBA.</p>
<p>If the <code>ORASQL_FAILEXEC</code> option is used, an error is raised during <code>SQLstmt</code> object creation failure (on <code>SQLstmt</code> object refresh). The <code>SQLstmt</code> object is not created and cannot be refreshed.</p>
<div class="infobox-note">
<p class="notep1"><span class="bold">Note</span>:</p>
Use the <code>CreateSQL</code> method with care, because any SQL statement or PL/SQL block that is executed might cause errors afterward when you use the <code>Edit</code> method on open dynasets.</div>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1072"></a>Data Type</p>
<p><code>String</code></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1073"></a>Examples</p>
<p>This example demonstrates the use of parameters, the <code>CreateSQL</code> method, the <code>Refresh</code> method, and the SQL property for <code>OraSQLStmt</code> object. Copy and paste this code into the definition section of a form. Then, press <span class="bold">F5</span>.</p>
<pre>
Sub Form_Load ()
 
 'Declare variables 
 Dim OraSession As OraSession 
 Dim OraDatabase As OraDatabase 
 Dim OraSqlStmt As OraSQLStmt 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object by opening a connection to Oracle.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
 OraDatabase.Parameters.Add "EMPNO", 7369, 1
 OraDatabase.Parameters("EMPNO").ServerType = 2  'ORATYPE_NUMBER 
 
 OraDatabase.Parameters.Add "ENAME", 0, 2
 OraDatabase.Parameters("ENAME").ServerType = 1  'ORATYPE_VARCHAR2  
 
 Set OraSqlStmt = OraDatabase.CreateSQL("Begin Employee.GetEmpName" &amp; _ 
          "(:EMPNO, :ENAME); end;", 0&amp;) 
 
 'Notice that the SQL statement is NOT modified.
 MsgBox OraSqlStmt.SQL
 
 'Should display SMITH
 MsgBox OraDatabase.Parameters("ENAME").Value  
 
 'Change the value of the empno parameter.
 OraDatabase.Parameters("EMPNO").Value = 7499
 
 'Refresh the sqlstmt
 OraSqlStmt.Refresh
 
 'Should display ALLEN
 MsgBox OraDatabase.Parameters("ENAME").Value   
 
 'Notice that the SQL statement is NOT modified.
 MsgBox OraSqlStmt.SQL  
 
 'Remove the parameter.
 OraDatabase.Parameters.Remove ("job")
 
 End Sub
</pre></div>
<!-- class="refsubsect" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="basfeat.htm#BGBEAFID">"Asynchronous Processing"</a> for more information about the <code>ORASQL_NONBLK</code> option</p>
</li>
<li>
<p><a href="sermthod024.htm#CIHDADDI">BeginTrans Method</a></p>
</li>
<li>
<p><a href="serobjch024.htm#BABGAHBH">OraSQLStmt Object</a></p>
</li>
<li>
<p><a href="#BHBDJJIG">CreateSQL Method</a></p>
</li>
<li>
<p><a href="sermthod086.htm#CIHEEIEC">ExecuteSQL Method</a></p>
</li>
<li>
<p><a href="sermthod148.htm#CIHJFCGG">Refresh Method</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="sermthod065.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="sermthod067.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
