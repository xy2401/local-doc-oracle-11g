<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>MonitorForFailover Method</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:57Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod127.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod129.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">174/438</span> <!-- End Header --><a id="CIHBAHEJ"></a>
<hr />
<div id="OOFOL591" class="refsect1">
<h1 class="refsect1">MonitorForFailover Method</h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1377"></a>Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1378"></a>Description</p>
<p>Registers the failover notification handler of the application.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1379"></a>Usage</p>
<pre>
OraDatabase.MonitorForFailover <span class="italic">FOSink</span>, <span class="italic">FOCtx</span>
</pre></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1380"></a>Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="cellalignment2282" title="MonitorForFailover method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t165">Arguments</th>
<th class="cellalignment2283" id="r1c2-t165">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t165" headers="r1c1-t165">[<code>in</code>] <code><span class="codeinlineitalic">FOSink</span></code></td>
<td class="cellalignment2284" headers="r2c1-t165 r1c2-t165">An <code>IDispatch</code> interface implementing the <code>OnFailover</code> method which is notified in event of a failover.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t165" headers="r1c1-t165">[<code>in</code>] <code><span class="codeinlineitalic">FOCtx</span></code></td>
<td class="cellalignment2284" headers="r3c1-t165 r1c2-t165">Context-specific information that the application wants passed into the <code>OnFailover</code> method in the event of a failover.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1381"></a>Remarks</p>
<p>To receive failover notifications, a notification handler must be registered with the <code>MonitorForFailover</code> method. The notification handler must be an automation object (a class module in Visual Basic) that implements the <code>OnFailover</code> method.</p>
<p>The syntax of the method is:</p>
<pre>
Public Function OnFailover(Ctx As Variant, fo_type As Variant,fo_event as Variant, fo_OraDB as Variant) 
</pre>
<div class="inftblinformal">
<table class="cellalignment2282" title="MonitorForFailover Method Syntax parameters" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t166">Variants</th>
<th class="cellalignment2283" id="r1c2-t166">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t166" headers="r1c1-t166"><code>[in]</code> <code>Ctx</code></td>
<td class="cellalignment2284" headers="r2c1-t166 r1c2-t166">Passed into the <code>MonitorForFailover</code> method by the application. Context-sensitive information that the application wants passed in event of a failover.</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t166" headers="r1c1-t166"><code>[in]</code> <code>fo_type</code></td>
<td class="cellalignment2284" headers="r3c1-t166 r1c2-t166"><code>Failover</code> type. This is the type of failover that the client has requested. The values are:
<ul>
<li>
<p><code>OO4O_FO_SESSION</code> indicates only session failover requested.</p>
</li>
<li>
<p><code>OO4O_FO_SELECT</code> indicates select failover and session failover requested.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t166" headers="r1c1-t166"><code>[in]</code>
<p><code>fo_event</code></p>
</td>
<td class="cellalignment2284" headers="r4c1-t166 r1c2-t166"><code>Failover</code> event. This indicates the state of the failover. It has several possible values:
<ul>
<li>
<p><code>OO4O_FO_BEGIN</code> indicates that failover has detected a lost connection and failover is starting.</p>
</li>
<li>
<p><code>OO4O_FO_END</code> indicates successful completion of a failover.</p>
</li>
<li>
<p><code>OO4O_FO_ABORT</code> indicates that a failover was unsuccessful, and there is no option of retrying.</p>
</li>
<li>
<p><code>OO4O_FO_ERROR</code> indicates that a failover was unsuccessful, and gives the application the opportunity to handle the error and retry the failover. The application can retry the failover, by programming the <code>OnFailover</code> method to return <code>OO4O_FO_RETRY</code>.</p>
</li>
<li>
<p><code>OO4O_FO_REAUTH</code> indicates that a user handle has been reauthenticated. This applies to the situation where a client has multiple user sessions on a single database connection. During the initial failover, only the active user session is failed over. Other sessions are failed over when the application tries to use them. This is the value passed to the callback during these subsequent failovers.</p>
</li>
</ul>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t166" headers="r1c1-t166"><code>[in]</code> <code>fo_OraDB</code></td>
<td class="cellalignment2284" headers="r5c1-t166 r1c2-t166">The <code>OraDatabase</code> object of the user session that is being failed over. Valid only when the <code>fo_event</code> variant is <code>OO4O_FO_REAUTH</code>.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref1382"></a>Examples</p>
<p class="subhead2"><a id="OOFOL592"></a>Failover Notification Example</p>
<p>See <a href="advfeat.htm#BABHEHBB">Example: Failover Notification</a>.</p>
</div>
<!-- class="refsubsect" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="advfeat.htm#CIHGBCIA">"Application Failover Notifications"</a></div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="sermthod127.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="sermthod129.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
