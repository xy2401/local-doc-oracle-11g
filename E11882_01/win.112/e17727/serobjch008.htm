<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>OraCollection Object</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.2 Build 737" />
<meta name="dcterms.created" content="2013-08-09T14:48:31Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Objects for OLE Developer's Guide" />
<meta name="dcterms.identifier" content="E17727-04" />
<meta name="dcterms.isVersionOf" content="OOFOL" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="serobjch007.htm" title="Previous" type="text/html" />
<link rel="Next" href="serobjch009.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e17727.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">21/438</span> <!-- End Header --><a id="BABGFAAA"></a>
<hr />
<div id="OOFOL370" class="refsect1">
<h1 class="refsect1">OraCollection Object</h1>
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref599"></a>Description</p>
<p>The <code>OraCollection</code> interface represents Oracle collection types, such as variable-length arrays (<code>VARRAY</code>s) and nested tables.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref600"></a>Remarks</p>
<p>A collection is an ordered group of elements, all of the same type. For example, the students in a class or the grades for each student in a class. Each element has a unique subscript, called an index, that determines its position in the collection.</p>
<p>The collection type nested table is viewed as a table stored in the column of database tables. When retrieved, rows of a nested table are given consecutive subscripts that start at <code>1</code>. Individual rows are accessed using an array-like access.</p>
<p>The collection type <code>VARRAY</code> is viewed as an array stored in the column of database tables. To reference an element in a <code>VARRAY</code> data type, standard subscripting syntax can be used. For example, <code>Grade(3)</code> references the third element in the <code>VARRAY</code> data type named <code>Grades</code>.</p>
<p>The <code>OraCollection</code> provides methods for accessing and manipulating an Oracle collection. Implicitly an <code>OraCollection</code> object contains an OLE Automation collection interface for accessing and manipulating (updating and inserting) individual elements of an Oracle collection. Individual elements can be accessed by using a subscript. An <code>OraCollection</code> element index starts at 1.</p>
<p>Element values are retrieved as <code>Variant</code> types. The <code>Variant</code> type of the element depends on the element type of the collection. Element values can be <code>Null</code> and can be set to <code>Null</code>. For elements of type objects and <code>REF</code>s, element values are returned as corresponding OO4O objects for that type. <code>VARRAY</code>s and nested tables do not support the elements of LOBs, <code>VARRAY</code>s, and Nested tables.</p>
<p><a href="#CBHHGCIB">Table 9-1</a> lists the element type and return value of the elements.</p>
<div id="OOFOL371" class="tblformal">
<p class="titleintable"><a id="sthref601"></a><a id="CBHHGCIB"></a>Table 9-1 Element Type and Return Value of Elements</p>
<table class="cellalignment2287" title="Element Type and Return Value of Elements" summary="rows are element type-element value pairs. column 1 is the element type and column 2 is the element value" dir="ltr">
<thead>
<tr class="cellalignment2276">
<th class="cellalignment2283" id="r1c1-t11">Element Type</th>
<th class="cellalignment2283" id="r1c2-t11">Element Value</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r2c1-t11" headers="r1c1-t11">
<p><code>Object</code></p>
</td>
<td class="cellalignment2284" headers="r2c1-t11 r1c2-t11">
<p><code>OraObject</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r3c1-t11" headers="r1c1-t11">
<p><code>REF</code></p>
</td>
<td class="cellalignment2284" headers="r3c1-t11 r1c2-t11">
<p><code>OraRef</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r4c1-t11" headers="r1c1-t11">
<p><code>Date</code></p>
</td>
<td class="cellalignment2284" headers="r4c1-t11 r1c2-t11">
<p><code>String</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r5c1-t11" headers="r1c1-t11">
<p><code>Number</code></p>
</td>
<td class="cellalignment2284" headers="r5c1-t11 r1c2-t11">
<p><code>String</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r6c1-t11" headers="r1c1-t11">
<p><code>CHAR</code>, <code>VARCHAR2</code></p>
</td>
<td class="cellalignment2284" headers="r6c1-t11 r1c2-t11">
<p><code>String</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r7c1-t11" headers="r1c1-t11">
<p><code>Real</code></p>
</td>
<td class="cellalignment2284" headers="r7c1-t11 r1c2-t11">
<p><code>Real</code></p>
</td>
</tr>
<tr class="cellalignment2276">
<td class="cellalignment2284" id="r8c1-t11" headers="r1c1-t11">
<p><code>Integer</code></p>
</td>
<td class="cellalignment2284" headers="r8c1-t11 r1c2-t11">
<p><code>Integer</code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>Element values are converted into a <code>Variant</code> <code>SAFEARRAY</code> format using the <code>SafeArray</code> property. Only elements of primitive types are supported. A <code>Variant</code> <code>SAFEARRAY</code> index starts at <code>0</code>.</p>
<p>The <code>CreateOraObject</code> method on the <code>OraDatabase</code> object returns the <code>OraCollection</code> object. The Oracle collection associated with this <code>OraCollection</code> object is created in the client-side object cache.</p>
<p>For information about creating a dynaset from a collection, see to <a href="advfeat.htm#BABEBHDD">"Creating a Dynaset from an OraCollection Object"</a>.</p>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref602"></a>Properties</p>
<ul>
<li>
<p><a href="serprop004.htm#CEGGCIHB">BOC Property</a></p>
</li>
<li>
<p><a href="serprop041.htm#CEGBFJHG">ElementType Property</a></p>
</li>
<li>
<p><a href="serprop042.htm#CEGFCEJF">EOC Property</a></p>
</li>
<li>
<p><a href="serprop063.htm#CEGDDCCE">IsLocator (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop065.htm#CEGHHJIF">IsNull (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop075.htm#CEGBEJCI">MaxSize (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop110.htm#CEGCGCIF">SafeArray (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop119.htm#CEGCHCAJ">Size (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop128.htm#CEGHBFHG">TableSize (OraCollection) Property</a></p>
</li>
<li>
<p><a href="serprop136.htm#CEGCDJAC">Type (OraCollection) Property</a></p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref603"></a>Methods</p>
<ul>
<li>
<p><a href="sermthod011.htm#BHBIIABE">Append (OraCollection) Method</a></p>
</li>
<li>
<p><a href="sermthod032.htm#BHBIEBJA">Clone (OraCollection) Method</a></p>
</li>
<li>
<p><a href="sermthod055.htm#CIHFEGFI">CreateIterator Method</a></p>
</li>
<li>
<p><a href="sermthod069.htm#BHBJJEDE">Delete (OraCollection) Method</a></p>
</li>
<li>
<p><a href="sermthod071.htm#CIHGBHAC">DeleteIterator Method</a></p>
</li>
<li>
<p><a href="sermthod082.htm#BHBIAHJE">ElementValue Method</a></p>
</li>
<li>
<p><a href="sermthod087.htm#BHBDDGBJ">Exist (OraCollection) Method</a></p>
</li>
<li>
<p><a href="sermthod105.htm#BHBEIGDA">InitIterator Method</a></p>
</li>
<li>
<p><a href="sermthod121.htm#CIHIHHFF">IterNext Method</a></p>
</li>
<li>
<p><a href="sermthod122.htm#CIHCGDEJ">IterPrev Method</a></p>
</li>
<li>
<p><a href="sermthod170.htm#BHBHEEDB">Trim (OraCollection) Method</a></p>
</li>
</ul>
</div>
<!-- class="refsubsect" -->
<div class="refsubsect">
<p class="titleinrefsubsect"><a id="sthref604"></a>Examples</p>
<p>Before running the sample code, make sure that you have the necessary data types and tables in the database. See <a href="appendix.htm#CHDCBCCE">"Schema Objects Used in OraCollection Examples"</a> for schema objects that are used in the <code>OraCollection</code> examples.</p>
<p class="subhead2"><a id="OOFOL372"></a><a id="sthref605"></a>Example: Accessing Collection Elements</p>
<p>The following example illustrates how to access collection elements.</p>
<p><span class="bold">OraDynaset Example</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim EnameList as OraCollection
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb","scott/tiger", 0&amp;) 
 
'create a dynaset object from department
set OraDynaset = OraDatabase.CreateDynaset("select * from department", 0&amp;)
 
'retrieve a Enames column from Department. 
'Here Value property of OraField object returns EnameList OraCollection
set EnameList = OraDynaset.Fields("Enames").Value
 
'access the first element of EnameList
msgbox  EnameList(1)
 
'move to next to row
OraDynaset.MoveNext
 
'access all the elements of EnameList for the second row
For index = 1 To EnameList.Size
        msgbox EnameList(index)
Next Index    
</pre>
<p><span class="bold">OraParameter Example</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim EnameList as OraCollection
 
'Create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'Create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create an  OraParameter object representing EnameList collection bind Variable
OraDatabase.Parameters.Add "ENAMES", Null, ORAPARM_OUTPUT, _
                 ORATYPE_VARRAY,"ENAMELIST"
 
'execute the sql statement which selects ENAMES VARRAY  from the department  table
 
OraDatabase.ExecuteSQL ("BEGIN select enames  into :ENAMES  from department " &amp; _
                   "where  dept_id = 10;  END;")
 
'get the EnameList collection  from OraParameter
set EnameList = OraDatabase.Parameters("ENAMES").Value
 
'access all the elements of EnameList 
For index = 1 To EnameList.Size
        msgbox EnameList(index)
Next Index    
</pre>
<p class="subhead2"><a id="OOFOL373"></a><a id="sthref606"></a>Example: Modifying Collection Elements</p>
<p>The following example illustrates how to modify collection elements.</p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim EnameList as OraCollection
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create a dynaset object from department
set OraDynaset = OraDatabase.CreateDynaset("select * from department", 0&amp;)
 
'retrieve a Enames column from Department. Here Value property of OraField object
'returns EnameList OraCollection
 
set EnameList = OraDynaset.Fields("Enames").Value
 
'lock the row for editing and set the 2nd element of the EnameList to new value
OraDynaset.Edit
EnameList(2) = "Eric"
OraDynaset.Update
</pre>
<p class="subhead2"><a id="OOFOL374"></a><a id="sthref607"></a>Example: Inserting in a Collection</p>
<p>The following example illustrates how to insert elements into an Oracle collection.</p>
<p><span class="bold">OraDynaset Example</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim EnameListNew as OraCollection
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create a new OraCollection object from the database
set EnameListNew = OraDatabase.CreateOraObject("ENAMELIST")
 
'set EnameListNew's element values
EnameListNew(1)  = "Nasser"
EnameListNew(2) =  "Chris"
EnameListNew(3) =  "Gopal"
 
'create a dynaset object from department
set OraDynaset = OraDatabase.CreateDynaset("select * from department", 0&amp;)
 
'start the AddNew operation and insert the EnameListNew collection 
OraDynaset.AddNew
OraDynaset.Fields("dept_id") = 40
OraDynaset.Fields("name") = "DEVELOPMENT"
 
'set the EnameListNew to enames column
OraDynaset.Fields("enames") = EnameListNew
OraDynaset.Update
</pre>
<p><span class="bold">OraParameter Example</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim EnameListNew as OraCollection
 
'Create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'Create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create a new OraCollection object from the database
set EnameListNew = OraDatabase.CreateOraObject("ENAMELIST")
 
'set EnameListNew's element values
EnameListNew(1)  = "Nasser"
EnameListNew(2) =  "Chris"
EnameListNew(3) =  "Gopal"
 
'create an input OraParameter object representing EnameList collection bind 'Variable
 
OraDatabase.Parameters.Add "ENAMES", Null, ORAPARM_INPUT, ORATYPE_VARRAY, _ 
                "ENAMELIST"
 
'set the ENAMES parameter value to EnameListNew
OraDatabase.Parameters("ENAMES").Value  = EnameListNew
 
'execute the insert sql statement 
OraDatabase.ExecuteSQL ("insert into department values (40,'DEVELOPMENT', " &amp; _ 
              ":ENAMES)")
</pre>
<p class="subhead2"><a id="OOFOL375"></a><a id="sthref608"></a>Example: Collection with Object Type Elements</p>
<p>The following example illustrates the use of an Oracle collection having elements of object type.</p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim CourseList as OraCollection
Dim Course as OraObject
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create a dynaset object from division
set OraDynaset = OraDatabase.CreateDynaset("select * from division", 0&amp;)
 
'retrieve a Courses column from Division. 
'Here Value property of OraField object returns CourseList OraCollection
 
set CourseList = OraDynaset.Fields("Courses").Value
'retrieve the element value of the CourseList at index 1. 
'Here element value is returned as Course OraObject
set Course = CourseList(1)
 
'retrieve course_no and title attribute of the Course
msgbox Course.course_no
msgbox Course.title
 
'move to next row
OraDynaset.MoveNext
 
'now CourseList object represents collection value for the second row 
'and course OraObject 'represents the element value at index 1. 
'retrieve course_no and title attribute of the Course.
msgbox Course.course_no
msgbox Course.title
</pre>
<p class="subhead2"><a id="OOFOL376"></a><a id="sthref609"></a>Example: Creating a SAFEARRAY Variant from a Collection</p>
<p>The following example illustrates how to get and set a SAFEARRAY <code>Variant</code> with an Oracle collection.</p>
<p><span class="bold">Creating SAFEARRAY Variant from a Collection</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim EnameList as OraCollection
Dim EnameArray as Variant
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create a dynaset object from department
set OraDynaset = OraDatabase.CreateDynaset("select * from department", 0&amp;)
 
'retrieve a Enames column from Department. 
'Here Value property of OraField objectreturns EnameList OraCollection
set EnameList = OraDynaset.Fields("Enames").Value
 
'get the Variant SAFEARRAY from the collection. 
EnameArray = EnameList.SafeArray
 
'display the individual elements of EnameArray
msgbox EnameArray(0)
msgbox EnameArray(1)
msgbox EnameArray(2)
</pre>
<p><span class="bold">Setting SAFEARRAY Variant to the Collection</span></p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim EnameList as OraCollection
Dim EnameArray() As String
ReDim EnameArray(3)
 
'Create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'Create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'create an Empty uninitialized input OraParameter object 
'represent EnameList collection bind Variable
OraDatabase.Parameters.Add "ENAMES", Empty, ORAPARM_INPUT, _
                            ORATYPE_VARRAY,"ENAMELIST"
 
'get the Empty uninitialized ENAMES parameter value
set EnameList = OraDatabase.Parameters("ENAMES").Value 
 
'initialize the EnameArray
EnameArray(0) = "Nasser"
EnameArray(1) = "Chris"
EnameArray(2) = "Gopal"
 
'set the EnameArray to EnameList's SafeArray
EnameList.SafeArray = EnameArray
 
'execute the insert sql statement 
OraDatabase.ExecuteSQL ("insert into department " &amp; _
                "values (40,'DEVELOPMENT', :ENAMES)")
</pre>
<p class="subhead2"><a id="OOFOL377"></a><a id="CBHIBBBD"></a>Example: Creating a Dynaset from a Collection</p>
<p>The following example illustrates how to create a dynaset from an Oracle collection.</p>
<pre>
Dim OraSession as OraSession
Dim OraDatabase as OraDatabase
Dim OraDynaset as OraDynaset
Dim CourseList as OraCollection
Dim Course as OraObject
Dim CourseListDyn as OraDynaset
 
'create the OraSession Object.
Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
'create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger",  0&amp;)
 
'create a dynaset object from division
set OraDynaset = OraDatabase.CreateDynaset("select * from division", 0&amp;)
 
'retrieve a Courses column from Division. Here Value 
'property of OraField object returns CourseList OraCollection
set CourseList = OraDynaset.Fields("Courses").Value
 
'create a input parameter for CourseList for nested table dynaset
OraDatabase.Parameters.Add "COURSELIST", CourseList, ORAPARM_INPUT, _
                            ORATYPE_TABLE, "COURSELIST"
 
'create a read only dynaset based on the CourseList. 
Set CourseListDyn = OraDatabase.CreateDynaset("select * from THE" &amp; _
          "(select CAST(:COURSELIST AS COURSELIST) from dual)", ORADYN_READONLY)
 
'dynaset can also be created from Oracle8 collection 
'using the following statement, which requires OO4O v8.1.x later
 
Set CourseListDyn = OraDatabase.CreateDynaset("select * from " &amp; _ 
           "TABLE(CAST(:COURSELIST AS COURSELIST))", ORADYN_READONLY)
 
'get the field values of the collection dynaset
msgbox CourseListDyn.Fields("title").Value
msgbox CourseListDyn.Fields("course_no").Value
 
'move the original dynaset to second row
Oradynaset.MoveNext
 
'set the new value of CourseList  collection from the second row of main dynaset
'to the "COURSELIST" parameter
OraDatabase.Parameters("COURSELIST").Value = CourseList
 
'refresh the collection dynaset. Now the collection dynaset values are refreshed
' with new collection value.
CourseListDyn.Refresh
 
'get the field values of the collection dynaset
msgbox CourseListDyn.Fields("title").Value
msgbox CourseListDyn.Fields("course_no").Value
</pre>
<p class="subhead2"><a id="OOFOL378"></a>Example: Collection Iterator</p>
<p>See <a href="sermthod055.htm#CIHFDEDC">"Example: OraCollection Iterator"</a> .</p>
</div>
<!-- class="refsubsect" -->
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serobjch020.htm#BABDIJAH">OraParameter Object</a></p>
</li>
<li>
<p><a href="sermthod060.htm#BHBBEEEF">CreateOraObject (OraDatabase) Method</a></p>
</li>
<li>
<p><a href="advfeat.htm#BGBHIIHH">"Instantiating Oracle LOBs, Objects, and Collections"</a></p>
</li>
<li>
<p><a href="advfeat.htm#BGBCEDFA">"Oracle Collections"</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment2275">
<tr>
<td class="cellalignment2284">
<table class="cellalignment2280">
<tr>
<td class="cellalignment2279"><a href="serobjch007.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment2279"><a href="serobjch009.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2013,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment2286">
<table class="cellalignment2278">
<tr>
<td class="cellalignment2279"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment2279"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment2279"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment2279"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment2279"><a href="../../nav/mindx.htm"><img width="24" height="24" src="../../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment2279"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
